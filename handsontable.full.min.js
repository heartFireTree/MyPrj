/*!
 * Copyright (c) Handsoncode sp. z o.o.
 * 
 * This Handsontable Pro is a commercial software distributed by Handsoncode sp. z o. o., a limited liability
 * company registered under the laws of Poland, with its registered office in Gdynia, Poland, at 96/98 Aleja Zwycięstwa,
 * postal code 81-451, entered into the Entrepreneurs Register of the National Court Register under number 0000538651,
 * share capital: PLN 62,800.00., hereinafter referred to as "HANDSONCODE".
 * 
 * By installing, copying, or otherwise using this software, you agree to be bound by the terms
 * of its General Software License Terms ("Terms") outlined in a file "handsontable-pro-general-terms.pdf"
 * available in the main directory of the software repository.
 * This software is copyrighted and protected by copyright laws and international treaties.
 * 
 * You shall obtain a commercial license for this software at handsontable.com.
 * 
 * YOU EXPRESSLY ACKNOWLEDGE AND AGREE THAT USE OF THE SOFTWARE IS AT YOUR OWN RISK AND THAT THE SOFTWARE
 * IS PROVIDED "AS IS" WITHOUT ANY WARRANTIES OR CONDITIONS WHATSOEVER. HANDSONCODE EXPRESSLY DISCLAIMS ANY WARRANTY,
 * EXPRESS OR IMPLIED, INCLUDING, WITHOUT LIMITATION, THE IMPLIED WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE, OR NON-INFRINGMENT. HANDSONCODE DOES NOT WARRANT THAT THE SOFTWARE AND ITS FUNCTIONALITY,
 * RELIABILITY AND PERFORMANCE WILL MEET YOUR REQUIREMENTS OR THAT THE OPERATION OF THE SOFTWARE WILL BE
 * UNINTERRUPTED OR ERROR FREE.
 * 
 * Version: 1.18.1
 * Release date: 20/03/2018 (built at 20/03/2018 10:43:43)
 */
(function(n,t){typeof exports=="object"&&typeof module=="object"?module.exports=t():typeof define=="function"&&define.amd?define("Handsontable",[],t):typeof exports=="object"?exports.Handsontable=t():n.Handsontable=t()})(typeof self!="undefined"?self:this,function(){return function(n){function t(r){if(i[r])return i[r].exports;var u=i[r]={i:r,l:!1,exports:{}};return n[r].call(u.exports,u,u.exports,t),u.l=!0,u.exports}var i={};return t.m=n,t.c=i,t.d=function(n,i,r){t.o(n,i)||Object.defineProperty(n,i,{configurable:!1,enumerable:!0,get:r})},t.n=function(n){var i=n&&n.__esModule?function(){return n["default"]}:function(){return n};return t.d(i,"a",i),i},t.o=function(n,t){return Object.prototype.hasOwnProperty.call(n,t)},t.p="",t(t.s=476)}([function(n,t){"use strict";function e(n){for(var t=0,i=n.length;t<i;)n[t]=[n[t]],t++}function o(n,t){for(var i=0,r=t.length;i<r;)n.push(t[i]),i++}function s(n){var i=[],u,f,r,t;if(!n||n.length===0||!n[0]||n[0].length===0)return i;for(u=n.length,f=n[0].length,r=0;r<u;r++)for(t=0;t<f;t++)i[t]||(i[t]=[]),i[t][r]=n[r][t];return i}function i(n,t,i,r){var f=-1,u=n,e;for(Array.isArray(n)||(u=Array.from(n)),e=u.length,r&&e&&(i=u[++f]);++f<e;)i=t(i,u[f],f,u);return i}function h(n,t){var r=-1,i=n,u;Array.isArray(n)||(i=Array.from(n));for(var e=i.length,f=[],o=-1;++r<e;)u=i[r],t(u,r,i)&&(f[++o]=u);return f}function c(n,t){var r=-1,i=n,f;Array.isArray(n)||(i=Array.from(n));for(var e=i.length,u=[],o=-1;++r<e;)f=i[r],u[++o]=t(f,r,i);return u}function r(n,t){var r=-1,i=n,u;for(Array.isArray(n)||(i=Array.from(n)),u=i.length;++r<u;)if(t(i[r],r,i)===!1)break;return n}function u(n){return i(n,function(n,t){return n+t},0)}function l(n){return i(n,function(n,t){return n>t?n:t},Array.isArray(n)?n[0]:void 0)}function a(n){return i(n,function(n,t){return n<t?n:t},Array.isArray(n)?n[0]:void 0)}function v(n){return n.length?u(n)/n.length:0}function f(n){return i(n,function(n,t){return n.concat(Array.isArray(t)?f(t):t)},[])}function y(n){var t=[];return r(n,function(n){t.indexOf(n)===-1&&t.push(n)}),t}t.__esModule=!0;t.to2dArray=e;t.extendArray=o;t.pivot=s;t.arrayReduce=i;t.arrayFilter=h;t.arrayMap=c;t.arrayEach=r;t.arraySum=u;t.arrayMax=l;t.arrayMin=a;t.arrayAvg=v;t.arrayFlatten=f;t.arrayUnique=y},function(n,t,i){"use strict";function s(n,t,i){return t in n?Object.defineProperty(n,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[t]=i,n}function e(n){var t;return Array.isArray(n)?t=[]:(t={},r(n,function(n,i){i!=="__children"&&(t[i]=n&&(typeof n=="undefined"?"undefined":u(n))==="object"&&!Array.isArray(n)?e(n):Array.isArray(n)?n.length&&u(n[0])==="object"&&!Array.isArray(n[0])?[e(n[0])]:[]:null)})),t}function l(n,t){return t.prototype.constructor=t,n.prototype=new t,n.prototype.constructor=n,n}function a(n,t){return r(t,function(t,i){n[i]=t}),n}function h(n,t){r(t,function(i,r){t[r]&&u(t[r])==="object"?(n[r]||(n[r]=Array.isArray(t[r])?[]:Object.prototype.toString.call(t[r])==="[object Date]"?t[r]:{}),h(n[r],t[r])):n[r]=t[r]})}function c(n){return(typeof n=="undefined"?"undefined":u(n))==="object"?JSON.parse(JSON.stringify(n)):n}function v(n){var t={};return r(n,function(n,i){t[i]=n}),t}function y(n){n.MIXINS||(n.MIXINS=[]);for(var i=arguments.length,u=Array(i>1?i-1:0),t=1;t<i;t++)u[t-1]=arguments[t];return o.arrayEach(u,function(t){n.MIXINS.push(t.MIXIN_NAME);r(t,function(t,i){if(n.prototype[i]!==void 0)throw new Error("Mixin conflict. Property '"+i+"' already exist and cannot be overwritten.");if(typeof t=="function")n.prototype[i]=t;else{var r=function(n,t){n="_"+n;var i=function(n){return(Array.isArray(n)||f(n))&&(n=c(n)),n};return function(){return this[n]===void 0&&(this[n]=i(t)),this[n]}},u=function(n){return n="_"+n,function(t){this[n]=t}};Object.defineProperty(n.prototype,i,{get:r(i,t),set:u(i),configurable:!0})}})}),n}function p(n,t){return JSON.stringify(n)===JSON.stringify(t)}function f(n){return Object.prototype.toString.call(n)=="[object Object]"}function w(n,t,i,r){r.value=i;r.writable=r.writable!==!1;r.enumerable=r.enumerable!==!1;r.configurable=r.configurable!==!1;Object.defineProperty(n,t,r)}function r(n,t){for(var i in n)if((!n.hasOwnProperty||n.hasOwnProperty&&Object.prototype.hasOwnProperty.call(n,i))&&t(n[i],i,n)===!1)break;return n}function b(n,t){var u=t.split("."),i=n;return r(u,function(n){return i=i[n],i===void 0?(i=void 0,!1):void 0}),i}function k(n){if(!f(n))return 0;var t=function t(n){var i=0;return f(n)?r(n,function(n){i+=t(n)}):i++,i};return t(n)}function d(n){var t,r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"value",i="_"+r,u=(t={_touched:!1},s(t,i,n),s(t,"isTouched",function(){return this._touched}),t);return Object.defineProperty(u,r,{get:function(){return this[i]},set:function(n){this._touched=!0;this[i]=n},enumerable:!0,configurable:!0}),u}function g(n,t){return Object.prototype.hasOwnProperty.call(n,t)}var u,o;t.__esModule=!0;u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n};t.duckSchema=e;t.inherit=l;t.extend=a;t.deepExtend=h;t.deepClone=c;t.clone=v;t.mixin=y;t.isObjectEqual=p;t.isObject=f;t.defineGetter=w;t.objectEach=r;t.getProperty=b;t.deepObjectSize=k;t.createObjectPropListener=d;t.hasOwnProperty=g;o=i(0)},function(n,t,i){"use strict";function ft(n){for(var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0,t=-1,i=null;n!=null;){if(t===r){i=n;break}n.host&&n.nodeType===Node.DOCUMENT_FRAGMENT_NODE?n=n.host:(t++,n=n.parentNode)}return i}function a(n,t,i){while(n!=null&&n!==i){if(n.nodeType===Node.ELEMENT_NODE&&(t.indexOf(n.nodeName)>-1||t.indexOf(n)>-1))return n;n=n.host&&n.nodeType===Node.DOCUMENT_FRAGMENT_NODE?n.host:n.parentNode}return null}function et(n,t,i){for(var r=[],u;n;){if(n=a(n,t,i),!n||i&&!i.contains(n))break;r.push(n);n=n.host&&n.nodeType===Node.DOCUMENT_FRAGMENT_NODE?n.host:n.parentNode}return u=r.length,u?r[u-1]:null}function ot(n,t){var i=n.parentNode,r=[];for(typeof t=="string"?r=Array.prototype.slice.call(document.querySelectorAll(t),0):r.push(t);i!=null;){if(r.indexOf(i)>-1)return!0;i=i.parentNode}return!1}function st(n){function r(n){return n.nodeType===Node.ELEMENT_NODE&&n.nodeName===u.toUpperCase()}for(var u="hot-table",i=!1,t=v(n);t!=null;){if(r(t)){i=!0;break}else if(t.host&&t.nodeType===Node.DOCUMENT_FRAGMENT_NODE){if(i=r(t.host),i)break;t=t.host}t=t.parentNode}return i}function v(n){return typeof Polymer!="undefined"&&typeof wrap=="function"?wrap(n):n}function y(n){return typeof Polymer!="undefined"&&typeof unwrap=="function"?unwrap(n):n}function ht(n){var t=0;if(n.previousSibling)while(n=n.previousSibling)++t;return t}function ct(n,t){var i=document.querySelector(".ht_clone_"+n);return i?i.contains(t):null}function w(n){var t=0,i=[];if(!n||!n.length)return i;while(n[t])i.push(n[t]),t++;return i}function lt(n,t){return e(n,t)}function at(n,t){return o(n,t)}function vt(n,t){return s(n,t)}function b(n,t){var r,i;if(n.nodeType===3)t.removeChild(n);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(n.nodeName)>-1)for(r=n.childNodes,i=r.length-1;i>=0;i--)b(r[i],n)}function k(n){for(var t;t=n.lastChild;)n.removeChild(t)}function yt(n,t){d.test(t)?n.innerHTML=t:nt(n,t)}function nt(n,t){var i=n.firstChild;i&&i.nodeType===3&&i.nextSibling===null?g?i.textContent=t:i.data=t:(k(n),n.appendChild(document.createTextNode(t)))}function c(n){for(var t=n;y(t)!==document.documentElement;){if(t===null)return!1;if(t.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(t.host){if(t.host.impl)return c(t.host.impl);if(t.host)return c(t.host);throw new Error("Lost in Web Components world");}else return!1;else if(t.style.display==="none")return!1;t=t.parentNode}return!0}function pt(n){var i,r,u,t,e;if(t=document.documentElement,f.hasCaptionProblem()&&n.firstChild&&n.firstChild.nodeName==="CAPTION")return e=n.getBoundingClientRect(),{top:e.top+(window.pageYOffset||t.scrollTop)-(t.clientTop||0),left:e.left+(window.pageXOffset||t.scrollLeft)-(t.clientLeft||0)};for(i=n.offsetLeft,r=n.offsetTop,u=n;n=n.offsetParent;){if(n===document.body)break;i+=n.offsetLeft;r+=n.offsetTop;u=n}return u&&u.style.position==="fixed"&&(i+=window.pageXOffset||t.scrollLeft,r+=window.pageYOffset||t.scrollTop),{left:i,top:r}}function tt(){var n=window.scrollY;return n===void 0&&(n=document.documentElement.scrollTop),n}function it(){var n=window.scrollX;return n===void 0&&(n=document.documentElement.scrollLeft),n}function wt(n){return n===window?tt():n.scrollTop}function bt(n){return n===window?it():n.scrollLeft}function kt(n){for(var t=n.parentNode,i=["auto","scroll"],r,e,o,u="",f="",s="",h="";t&&t.style&&document.body!==t;){if((r=t.style.overflow,e=t.style.overflowX,o=t.style.overflowY,r=="scroll"||e=="scroll"||o=="scroll")||window.getComputedStyle&&(u=window.getComputedStyle(t),f=u.getPropertyValue("overflow"),s=u.getPropertyValue("overflow-y"),h=u.getPropertyValue("overflow-x"),f==="scroll"||h==="scroll"||s==="scroll")||t.clientHeight<=t.scrollHeight+1&&(i.indexOf(o)!==-1||i.indexOf(r)!==-1||i.indexOf(f)!==-1||i.indexOf(s)!==-1)||t.clientWidth<=t.scrollWidth+1&&(i.indexOf(e)!==-1||i.indexOf(r)!==-1||i.indexOf(f)!==-1||i.indexOf(h)!==-1))return t;t=t.parentNode}return window}function dt(n){for(var t=n.parentNode,i;t&&t.style&&document.body!==t;){if(t.style.overflow!=="visible"&&t.style.overflow!==""||window.getComputedStyle&&(i=window.getComputedStyle(t),i.getPropertyValue("overflow")!=="visible"&&i.getPropertyValue("overflow")!==""))return t;t=t.parentNode}return window}function gt(n,t){if(n){if(n===window)return t==="width"?window.innerWidth+"px":t==="height"?window.innerHeight+"px":void 0}else return;var r=n.style[t],i;return r!==""&&r!==void 0?r:(i=rt(n),i[t]!==""&&i[t]!==void 0)?i[t]:void 0}function rt(n){return n.currentStyle||document.defaultView.getComputedStyle(n)}function ni(n){return n.offsetWidth}function ti(n){return f.hasCaptionProblem()&&n.firstChild&&n.firstChild.nodeName==="CAPTION"?n.offsetHeight+n.firstChild.offsetHeight:n.offsetHeight}function ii(n){return n.clientHeight||n.innerHeight}function ri(n){return n.clientWidth||n.innerWidth}function ui(n,t,i){window.addEventListener?n.addEventListener(t,i,!1):n.attachEvent("on"+t,i)}function fi(n,t,i){window.removeEventListener?n.removeEventListener(t,i,!1):n.detachEvent("on"+t,i)}function ei(n){var i,t,r;return n.selectionStart?n.selectionStart:document.selection?(n.focus(),i=document.selection.createRange(),i==null)?0:(t=n.createTextRange(),r=t.duplicate(),t.moveToBookmark(i.getBookmark()),r.setEndPoint("EndToStart",t),r.text.length):0}function oi(n){var t,i;return n.selectionEnd?n.selectionEnd:document.selection?(t=document.selection.createRange(),t==null)?0:(i=n.createTextRange(),i.text.indexOf(t.text)+t.text.length):0}function si(){var n="";return window.getSelection?n=window.getSelection().toString():document.selection&&document.selection.type!=="Control"&&(n=document.selection.createRange().text),n}function hi(n,t,i){var u,f,r;if(i===void 0&&(i=t),n.setSelectionRange){n.focus();try{n.setSelectionRange(t,i)}catch(e){u=n.parentNode;f=u.style.display;u.style.display="block";n.setSelectionRange(t,i);u.style.display=f}}else n.createTextRange&&(r=n.createTextRange(),r.collapse(!0),r.moveEnd("character",i),r.moveStart("character",t),r.select())}function ci(){var t=document.createElement("div"),n,r,i;return t.style.height="200px",t.style.width="100%",n=document.createElement("div"),n.style.boxSizing="content-box",n.style.height="150px",n.style.left="0px",n.style.overflow="hidden",n.style.position="absolute",n.style.top="0px",n.style.width="200px",n.style.visibility="hidden",n.appendChild(t),(document.body||document.documentElement).appendChild(n),r=t.offsetWidth,n.style.overflow="scroll",i=t.offsetWidth,r==i&&(i=n.clientWidth),(document.body||document.documentElement).removeChild(n),r-i}function li(){return l===void 0&&(l=ci()),l}function ai(n){return n.offsetWidth!==n.clientWidth}function vi(n){return n.offsetHeight!==n.clientHeight}function yi(n,t,i){r.isIE8()||r.isIE9()?(n.style.top=i,n.style.left=t):r.isSafari()?n.style["-webkit-transform"]="translate3d("+t+","+i+",0)":n.style.transform="translate3d("+t+","+i+",0)"}function pi(n){var t;return n.style.transform&&(t=n.style.transform)!==""?["transform",t]:n.style["-webkit-transform"]&&(t=n.style["-webkit-transform"])!==""?["-webkit-transform",t]:-1}function wi(n){n.style.transform&&n.style.transform!==""?n.style.transform="":n.style["-webkit-transform"]&&n.style["-webkit-transform"]!==""&&(n.style["-webkit-transform"]="")}function ut(n){return n&&(["INPUT","SELECT","TEXTAREA"].indexOf(n.nodeName)>-1||n.contentEditable==="true")}function bi(n){return ut(n)&&n.className.indexOf("handsontableInput")==-1&&n.className.indexOf("copyPaste")==-1}var r,f,p,e,o,s,h,u,d,g,l;t.__esModule=!0;t.HTML_CHARACTERS=undefined;t.getParent=ft;t.closest=a;t.closestDown=et;t.isChildOf=ot;t.isChildOfWebComponentTable=st;t.polymerWrap=v;t.polymerUnwrap=y;t.index=ht;t.overlayContainsElement=ct;t.hasClass=lt;t.addClass=at;t.removeClass=vt;t.removeTextNodes=b;t.empty=k;t.fastInnerHTML=yt;t.fastInnerText=nt;t.isVisible=c;t.offset=pt;t.getWindowScrollTop=tt;t.getWindowScrollLeft=it;t.getScrollTop=wt;t.getScrollLeft=bt;t.getScrollableElement=kt;t.getTrimmingContainer=dt;t.getStyle=gt;t.getComputedStyle=rt;t.outerWidth=ni;t.outerHeight=ti;t.innerHeight=ii;t.innerWidth=ri;t.addEvent=ui;t.removeEvent=fi;t.getCaretPosition=ei;t.getSelectionEndPosition=oi;t.getSelectionText=si;t.setCaretPosition=hi;t.getScrollbarWidth=li;t.hasVerticalScrollbar=ai;t.hasHorizontalScrollbar=vi;t.setOverlayPosition=yi;t.getCssTransform=pi;t.resetCssTransform=wi;t.isInput=ut;t.isOutsideInput=bi;r=i(33);f=i(43);p=!!document.documentElement.classList;p?(h=function(){var n=document.createElement("div");return n.classList.add("test","test2"),n.classList.contains("test2")}(),e=function(n,t){return n.classList===void 0||t===""?!1:n.classList.contains(t)},o=function(n,t){var i=0;if(typeof t=="string"&&(t=t.split(" ")),t=w(t),h)n.classList.add.apply(n.classList,t);else while(t&&t[i])n.classList.add(t[i]),i++},s=function(n,t){var i=0;if(typeof t=="string"&&(t=t.split(" ")),t=w(t),h)n.classList.remove.apply(n.classList,t);else while(t&&t[i])n.classList.remove(t[i]),i++}):(u=function(n){return new RegExp("(\\s|^)"+n+"(\\s|$)")},e=function(n,t){return n.className!==void 0&&u(t).test(n.className)},o=function(n,t){var r=0,i=n.className;if(typeof t=="string"&&(t=t.split(" ")),i==="")i=t.join(" ");else while(t&&t[r])u(t[r]).test(i)||(i+=" "+t[r]),r++;n.className=i},s=function(n,t){var r=0,i=n.className;for(typeof t=="string"&&(t=t.split(" "));t&&t[r];)i=i.replace(u(t[r])," ").trim(),r++;n.className!==i&&(n.className=i)});d=t.HTML_CHARACTERS=/(<(.*)>|&(.*);)/;g=!!document.createTextNode("test").textContent},function(n,t){"use strict";t.__esModule=!0;var i=t.CONTEXT_MENU_ITEMS_NAMESPACE="ContextMenu:items",f=t.CONTEXTMENU_ITEMS_ROW_ABOVE=i+".insertRowAbove",e=t.CONTEXTMENU_ITEMS_ROW_BELOW=i+".insertRowBelow",o=t.CONTEXTMENU_ITEMS_INSERT_LEFT=i+".insertColumnOnTheLeft",s=t.CONTEXTMENU_ITEMS_INSERT_RIGHT=i+".insertColumnOnTheRight",h=t.CONTEXTMENU_ITEMS_REMOVE_ROW=i+".removeRow",c=t.CONTEXTMENU_ITEMS_REMOVE_COLUMN=i+".removeColumn",l=t.CONTEXTMENU_ITEMS_UNDO=i+".undo",a=t.CONTEXTMENU_ITEMS_REDO=i+".redo",v=t.CONTEXTMENU_ITEMS_READ_ONLY=i+".readOnly",y=t.CONTEXTMENU_ITEMS_CLEAR_COLUMN=i+".clearColumn",p=t.CONTEXTMENU_ITEMS_COPY=i+".copy",w=t.CONTEXTMENU_ITEMS_CUT=i+".cut",b=t.CONTEXTMENU_ITEMS_FREEZE_COLUMN=i+".freezeColumn",k=t.CONTEXTMENU_ITEMS_UNFREEZE_COLUMN=i+".unfreezeColumn",d=t.CONTEXTMENU_ITEMS_MERGE_CELLS=i+".mergeCells",g=t.CONTEXTMENU_ITEMS_UNMERGE_CELLS=i+".unmergeCells",nt=t.CONTEXTMENU_ITEMS_ADD_COMMENT=i+".addComment",tt=t.CONTEXTMENU_ITEMS_EDIT_COMMENT=i+".editComment",it=t.CONTEXTMENU_ITEMS_REMOVE_COMMENT=i+".removeComment",rt=t.CONTEXTMENU_ITEMS_READ_ONLY_COMMENT=i+".readOnlyComment",ut=t.CONTEXTMENU_ITEMS_ALIGNMENT=i+".align",ft=t.CONTEXTMENU_ITEMS_ALIGNMENT_LEFT=i+".align.left",et=t.CONTEXTMENU_ITEMS_ALIGNMENT_CENTER=i+".align.center",ot=t.CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT=i+".align.right",st=t.CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY=i+".align.justify",ht=t.CONTEXTMENU_ITEMS_ALIGNMENT_TOP=i+".align.top",ct=t.CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE=i+".align.middle",lt=t.CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM=i+".align.bottom",at=t.CONTEXTMENU_ITEMS_BORDERS=i+".borders",vt=t.CONTEXTMENU_ITEMS_BORDERS_TOP=i+".borders.top",yt=t.CONTEXTMENU_ITEMS_BORDERS_RIGHT=i+".borders.right",pt=t.CONTEXTMENU_ITEMS_BORDERS_BOTTOM=i+".borders.bottom",wt=t.CONTEXTMENU_ITEMS_BORDERS_LEFT=i+".borders.left",bt=t.CONTEXTMENU_ITEMS_REMOVE_BORDERS=i+".borders.remove",kt=t.CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD=i+".nestedHeaders.insertChildRow",dt=t.CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD=i+".nestedHeaders.detachFromParent",gt=t.CONTEXTMENU_ITEMS_HIDE_COLUMN=i+".hideColumn",ni=t.CONTEXTMENU_ITEMS_SHOW_COLUMN=i+".showColumn",ti=t.CONTEXTMENU_ITEMS_HIDE_ROW=i+".hideRow",ii=t.CONTEXTMENU_ITEMS_SHOW_ROW=i+".showRow",u=t.FILTERS_NAMESPACE="Filters:",r=t.FILTERS_CONDITIONS_NAMESPACE=u+"conditions",ri=t.FILTERS_CONDITIONS_NONE=r+".none",ui=t.FILTERS_CONDITIONS_EMPTY=r+".isEmpty",fi=t.FILTERS_CONDITIONS_NOT_EMPTY=r+".isNotEmpty",ei=t.FILTERS_CONDITIONS_EQUAL=r+".isEqualTo",oi=t.FILTERS_CONDITIONS_NOT_EQUAL=r+".isNotEqualTo",si=t.FILTERS_CONDITIONS_BEGINS_WITH=r+".beginsWith",hi=t.FILTERS_CONDITIONS_ENDS_WITH=r+".endsWith",ci=t.FILTERS_CONDITIONS_CONTAINS=r+".contains",li=t.FILTERS_CONDITIONS_NOT_CONTAIN=r+".doesNotContain",ai=t.FILTERS_CONDITIONS_BY_VALUE=r+".byValue",vi=t.FILTERS_CONDITIONS_GREATER_THAN=r+".greaterThan",yi=t.FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL=r+".greaterThanOrEqualTo",pi=t.FILTERS_CONDITIONS_LESS_THAN=r+".lessThan",wi=t.FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL=r+".lessThanOrEqualTo",bi=t.FILTERS_CONDITIONS_BETWEEN=r+".isBetween",ki=t.FILTERS_CONDITIONS_NOT_BETWEEN=r+".isNotBetween",di=t.FILTERS_CONDITIONS_AFTER=r+".after",gi=t.FILTERS_CONDITIONS_BEFORE=r+".before",nr=t.FILTERS_CONDITIONS_TODAY=r+".today",tr=t.FILTERS_CONDITIONS_TOMORROW=r+".tomorrow",ir=t.FILTERS_CONDITIONS_YESTERDAY=r+".yesterday",rr=t.FILTERS_DIVS_FILTER_BY_CONDITION=u+"labels.filterByCondition",ur=t.FILTERS_DIVS_FILTER_BY_VALUE=u+"labels.filterByValue",fr=t.FILTERS_LABELS_CONJUNCTION=u+"labels.conjunction",er=t.FILTERS_LABELS_DISJUNCTION=u+"labels.disjunction",or=t.FILTERS_VALUES_BLANK_CELLS=u+"values.blankCells",sr=t.FILTERS_BUTTONS_SELECT_ALL=u+"buttons.selectAll",hr=t.FILTERS_BUTTONS_CLEAR=u+"buttons.clear",cr=t.FILTERS_BUTTONS_OK=u+"buttons.ok",lr=t.FILTERS_BUTTONS_CANCEL=u+"buttons.cancel",ar=t.FILTERS_BUTTONS_PLACEHOLDER_SEARCH=u+"buttons.placeholder.search",vr=t.FILTERS_BUTTONS_PLACEHOLDER_VALUE=u+"buttons.placeholder.value",yr=t.FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE=u+"buttons.placeholder.secondValue"},function(n,t){"use strict";function r(n){var t=typeof n=="undefined"?"undefined":i(n);return t=="number"?!isNaN(n)&&isFinite(n):t=="string"?n.length?n.length==1?/\d/.test(n):/^\s*[+-]?\s*(?:(?:\d+(?:\.\d+)?(?:e[+-]?\d+)?)|(?:0x[a-f\d]+))\s*$/i.test(n):!1:t=="object"?!!n&&typeof n.valueOf()=="number"&&!(n instanceof Date):!1}function u(n,t,i){var r=-1;for(typeof t=="function"?(i=t,t=n):r=n-1;++r<=t;)if(i(r)===!1)break}function f(n,t,i){var r=n+1;for(typeof t=="function"&&(i=t,t=0);--r>=t;)if(i(r)===!1)break}function e(n,t){return t=parseInt(t.toString().replace("%",""),10),parseInt(n*t/100,10)}t.__esModule=!0;var i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n};t.isNumeric=r;t.rangeEach=u;t.rangeEachReverse=f;t.valueAccordingPercent=e},function(n,t,i){var u=i(17),f=i(50),s=i(39),h=i(38),o=i(40),e="prototype",r=function(n,t,i){var d=n&r.F,y=n&r.G,g=n&r.S,w=n&r.P,nt=n&r.B,a=y?u:g?u[t]||(u[t]={}):(u[t]||{})[e],v=y?f:f[t]||(f[t]={}),b=v[e]||(v[e]={}),l,p,c,k;y&&(i=t);for(l in i)p=!d&&a&&a[l]!==undefined,c=(p?a:i)[l],k=nt&&p?o(c,u):w&&typeof c=="function"?o(Function.call,c):c,a&&h(a,l,c,n&r.U),v[l]!=c&&s(v,l,k),w&&b[l]!=c&&(b[l]=c)};u.core=f;r.F=1;r.G=2;r.S=4;r.P=8;r.B=16;r.W=32;r.U=64;r.R=128;n.exports=r},function(n,t,i){"use strict";function s(n){return n&&n.__esModule?n:{"default":n}}function h(n,t){n=e.toUpperCaseFirst(n);u.default.getSingleton().add("construct",function(){var i=void 0;r.has(this)||r.set(this,{});i=r.get(this);i[n]||(i[n]=new t(this))});u.default.getSingleton().add("afterDestroy",function(){if(r.has(this)){var n=r.get(this);f.objectEach(n,function(n){return n.destroy()});r.delete(this)}})}function c(n,t){if(typeof t!="string")throw Error('Only strings can be passed as "plugin" parameter');var i=e.toUpperCaseFirst(t);if(r.has(n)&&r.get(n)[i])return r.get(n)[i]}function l(n){return r.has(n)?Object.keys(r.get(n)):[]}function a(n,t){var i=null;return r.has(n)&&f.objectEach(r.get(n),function(n,r){n===t&&(i=r)}),i}var r;t.__esModule=!0;t.getPluginName=t.getRegistredPluginNames=t.getPlugin=t.registerPlugin=undefined;var o=i(14),u=s(o),f=i(1),e=i(31);r=new WeakMap;t.registerPlugin=h;t.getPlugin=c;t.getRegistredPluginNames=l;t.getPluginName=a},function(n,t,i){"use strict";function c(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}t.__esModule=!0;var s=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),f=i(1),e=i(0),h=i(53),o=i(6);var r=new WeakMap,u=null,l=function(){function n(t){var i=this;c(this,n);f.defineGetter(this,"hot",t,{writable:!1});f.defineGetter(this,"t",h.getTranslator(t),{writable:!1});r.set(this,{hooks:{}});u=null;this.pluginName=null;this.pluginsInitializedCallbacks=[];this.isPluginsReady=!1;this.enabled=!1;this.initialized=!1;this.hot.addHook("afterPluginsInitialized",function(){return i.onAfterPluginsInitialized()});this.hot.addHook("afterUpdateSettings",function(){return i.onUpdateSettings()});this.hot.addHook("beforeInit",function(){return i.init()})}return s(n,[{key:"init",value:function(){this.pluginName=o.getPluginName(this.hot,this);this.isEnabled&&this.isEnabled()&&this.enablePlugin();u||(u=o.getRegistredPluginNames(this.hot));u.indexOf(this.pluginName)>=0&&u.splice(u.indexOf(this.pluginName),1);u.length||this.hot.runHooks("afterPluginsInitialized");this.initialized=!0}},{key:"enablePlugin",value:function(){this.enabled=!0}},{key:"disablePlugin",value:function(){this.eventManager&&this.eventManager.clear();this.clearHooks();this.enabled=!1}},{key:"addHook",value:function(n,t){r.get(this).hooks[n]=r.get(this).hooks[n]||[];var i=r.get(this).hooks[n];this.hot.addHook(n,t);i.push(t);r.get(this).hooks[n]=i}},{key:"removeHooks",value:function(n){var t=this;e.arrayEach(r.get(this).hooks[n]||[],function(i){t.hot.removeHook(n,i)})}},{key:"clearHooks",value:function(){var t=this,n=r.get(this).hooks;f.objectEach(n,function(n,i){return t.removeHooks(i)});n.length=0}},{key:"callOnPluginsReady",value:function(n){this.isPluginsReady?n():this.pluginsInitializedCallbacks.push(n)}},{key:"onAfterPluginsInitialized",value:function(){e.arrayEach(this.pluginsInitializedCallbacks,function(n){return n()});this.pluginsInitializedCallbacks.length=0;this.isPluginsReady=!0}},{key:"onUpdateSettings",value:function(){this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&this.updatePlugin())}},{key:"updatePlugin",value:function(){}},{key:"destroy",value:function(){var n=this;this.eventManager&&this.eventManager.destroy();this.clearHooks();f.objectEach(this,function(t,i){i!=="hot"&&i!=="t"&&(n[i]=null)});delete this.t;delete this.hot}}]),n}();t.default=l},function(n,t,i){"use strict";function r(n){return n&&n.__esModule?n:{"default":n}}t.__esModule=!0;t.Viewport=t.TableRenderer=t.Table=t.Settings=t.Selection=t.Scroll=t.Overlays=t.Event=t.Core=t.default=t.Border=t.TopLeftCornerOverlay=t.TopOverlay=t.LeftOverlay=t.DebugOverlay=t.RowFilter=t.ColumnFilter=t.CellRange=t.CellCoords=t.ViewportRowsCalculator=t.ViewportColumnsCalculator=undefined;i(84);i(93);i(94);i(95);i(96);i(98);i(100);i(101);i(102);i(103);i(104);i(105);i(106);i(107);i(108);i(109);i(110);i(111);i(112);i(113);i(114);i(115);i(116);i(117);i(118);i(121);i(122);i(123);i(124);i(125);i(126);i(127);i(128);i(130);i(131);i(132);i(133);i(134);i(80);i(135);i(136);i(137);i(138);i(139);i(140);i(141);i(142);i(143);i(144);i(145);i(146);i(147);i(148);i(149);var f=i(189),e=r(f),o=i(190),s=r(o),h=i(61),c=r(h),l=i(150),a=r(l),v=i(191),y=r(v),p=i(192),w=r(p),b=i(499),k=r(b),d=i(501),g=r(d),nt=i(502),tt=r(nt),it=i(503),rt=r(it),ut=i(321),ft=r(ut),et=i(193),u=r(et),ot=i(314),st=r(ot),ht=i(315),ct=r(ht),lt=i(316),at=r(lt),vt=i(504),yt=r(vt),pt=i(317),wt=r(pt),bt=i(318),kt=r(bt),dt=i(319),gt=r(dt),ni=i(320),ti=r(ni);t.ViewportColumnsCalculator=e.default;t.ViewportRowsCalculator=s.default;t.CellCoords=c.default;t.CellRange=a.default;t.ColumnFilter=y.default;t.RowFilter=w.default;t.DebugOverlay=k.default;t.LeftOverlay=g.default;t.TopOverlay=tt.default;t.TopLeftCornerOverlay=rt.default;t.Border=ft.default;t.default=u.default;t.Core=u.default;t.Event=st.default;t.Overlays=ct.default;t.Scroll=at.default;t.Selection=yt.default;t.Settings=wt.default;t.Table=kt.default;t.TableRenderer=gt.default;t.Viewport=ti.default},function(n,t,i){"use strict";function c(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function l(n,t){var c="HOT-TABLE",l=void 0,e=void 0,a=void 0,r=void 0,i=void 0,v=void 0;if(t.isTargetWebComponent=!1,t.realTarget=t.target,v=t.stopImmediatePropagation,t.stopImmediatePropagation=function(){v.apply(this);h.stopImmediatePropagation(this)},!f.isHotTableEnv)return t;for(t=u.polymerWrap(t),i=t.path?t.path.length:0;i--;){if(t.path[i].nodeName===c)l=!0;else if(l&&t.path[i].shadowRoot){r=t.path[i];break}i!==0||r||(r=t.path[i])}return r||(r=t.target),t.isTargetWebComponent=!0,s.isWebComponentSupportedNatively()?t.realTarget=t.srcElement||t.toElement:(o.hasOwnProperty(n,"hot")||n.isHotTableEnv||n.wtTable)&&(o.hasOwnProperty(n,"hot")?e=n.hot?n.hot.view.wt.wtTable.TABLE:null:n.isHotTableEnv?e=n.view.activeWt.wtTable.TABLE.parentNode.parentNode:n.wtTable&&(e=n.wtTable.TABLE.parentNode.parentNode),a=u.closest(t.target,[c],e),t.realTarget=a?e.querySelector(c)||t.target:t.target),Object.defineProperty(t,"target",{get:function(){return u.polymerWrap(r)},enumerable:!0,configurable:!0}),t}function a(){return r}var e,r,f;t.__esModule=!0;e=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}();t.getListenersCounter=a;var u=i(2),o=i(1),s=i(43),h=i(11);r=0;f=function(){function n(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;c(this,n);this.context=t||this;this.context.eventListeners||(this.context.eventListeners=[])}return e(n,[{key:"addEventListener",value:function(n,t,i){function u(n){n=l(e,n);i.call(this,n)}var f=this,e=this.context;return this.context.eventListeners.push({element:n,event:t,callback:i,callbackProxy:u}),window.addEventListener?n.addEventListener(t,u,!1):n.attachEvent("on"+t,u),r++,function(){f.removeEventListener(n,t,i)}}},{key:"removeEventListener",value:function(n,t,i){for(var f=this.context.eventListeners.length,u=void 0;f--;)if(u=this.context.eventListeners[f],u.event==t&&u.element==n){if(i&&i!=u.callback)continue;this.context.eventListeners.splice(f,1);u.element.removeEventListener?u.element.removeEventListener(u.event,u.callbackProxy,!1):u.element.detachEvent("on"+u.event,u.callbackProxy);r--}}},{key:"clearEvents",value:function(){var t,n;if(this.context)for(t=this.context.eventListeners.length;t--;)n=this.context.eventListeners[t],n&&this.removeEventListener(n.element,n.event,n.callback)}},{key:"clear",value:function(){this.clearEvents()}},{key:"destroy",value:function(){this.clearEvents();this.context=null}},{key:"fireEvent",value:function(n,t){var i={bubbles:!0,cancelable:t!=="mousemove",view:window,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:undefined},r;document.createEvent?(r=document.createEvent("MouseEvents"),r.initMouseEvent(t,i.bubbles,i.cancelable,i.view,i.detail,i.screenX,i.screenY,i.clientX,i.clientY,i.ctrlKey,i.altKey,i.shiftKey,i.metaKey,i.button,i.relatedTarget||document.body.parentNode)):r=document.createEventObject();n.dispatchEvent?n.dispatchEvent(r):n.fireEvent("on"+t,r)}}]),n}();t.default=f},function(n,t){"use strict";function r(n,t){if(!i[n])throw Error('Filter condition "'+n+'" does not exist.');var r=i[n],f=r.condition,u=r.descriptor;return u.inputValuesDecorator&&(t=u.inputValuesDecorator(t)),function(n){return f.apply(n.meta.instance,[].concat([n],[t]))}}function u(n){if(!i[n])throw Error('Filter condition "'+n+'" does not exist.');return i[n].descriptor}function f(n,t,r){r.key=n;i[n]={condition:t,descriptor:r}}t.__esModule=!0;t.getCondition=r;t.getConditionDescriptor=u;t.registerCondition=f;var i=t.conditions={}},function(n,t,i){"use strict";function u(n){n.isImmediatePropagationEnabled=!1;n.cancelBubble=!0}function f(n){return n.isImmediatePropagationEnabled===!1}function e(n){typeof n.stopPropagation=="function"?n.stopPropagation():n.cancelBubble=!0}function o(n){return n.pageX?n.pageX:n.clientX+r.getWindowScrollLeft()}function s(n){return n.pageY?n.pageY:n.clientY+r.getWindowScrollTop()}function h(n){return n.button===2}function c(n){return n.button===0}t.__esModule=!0;t.stopImmediatePropagation=u;t.isImmediatePropagationStopped=f;t.stopPropagation=e;t.pageX=o;t.pageY=s;t.isRightClick=h;t.isLeftClick=c;var r=i(2)},function(n){n.exports=function(n){return typeof n=="object"?n!==null:typeof n=="function"}},function(n,t,i){"use strict";function v(n){return n&&n.__esModule?n:{"default":n}}function y(n,t){return Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(t)}}))}function p(n){var t=void 0;switch(typeof n=="undefined"?"undefined":o(n)){case"string":case"number":t=""+n;break;case"object":t=n===null?"":n.toString();break;case"undefined":t="";break;default:t=n.toString()}return t}function w(n){return typeof n!="undefined"}function s(n){return typeof n=="undefined"}function b(n){return n===null||n===""||s(n)}function k(n){return Object.prototype.toString.call(n)==="[object RegExp]"}function d(){}var o,l;t.__esModule=!0;o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n};l=y(["\n          Your license key of Handsontable Pro has expired.‌‌‌‌ \n          Renew your maintenance plan at https://handsontable.com or downgrade to the previous version of the software.\n          "],["\n          Your license key of Handsontable Pro has expired.‌‌‌‌\\x20\n          Renew your maintenance plan at https://handsontable.com or downgrade to the previous version of the software.\n          "]);t.stringify=p;t.isDefined=w;t.isUndefined=s;t.isEmpty=b;t.isRegExp=k;t._injectProductInfo=d;var a=i(23),g=v(a),nt=i(34);var r="length",u=function(n){return parseInt(n,16)},h=function(n){return parseInt(n,10)},e=function(n,t,i){return n.substr(t,i)},f=function(n){return n.codePointAt(0)-65},c=function(n){return(""+n).replace(/\-/g,"")},tt=function(n){return u(e(c(n),u("12"),f("F")))/(u(e(c(n),f("B"),~~![][r]))||9)},it=function(){return typeof location!="undefined"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host)}},function(n,t,i){"use strict";function s(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}t.__esModule=!0;var f=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),u=i(0),o=i(1);var r=["afterCellMetaReset","afterChange","afterChangesObserved","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","afterRender","beforeRenderer","afterRenderer","afterScrollHorizontally","afterScrollVertically","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeRender","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyCol","unmodifyCol","unmodifyRow","modifyColHeader","modifyColWidth","modifyRow","modifyRowHeader","modifyRowHeight","modifyData","modifyRowData","modifyGetCellCoords","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnMove","afterColumnMove","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","modifyColumnHeaderHeight","beforeUndo","afterUndo","beforeRedo","afterRedo","modifyRowHeaderWidth","beforeAutofillInsidePopulate","modifyTransformStart","modifyTransformEnd","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","manualRowHeights","skipLengthCache","afterTrimRow","afterUntrimRow","afterDropdownMenuShow","afterDropdownMenuHide","hiddenRow","hiddenColumn","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten"],e=function(){function n(){s(this,n);this.globalBucket=this.createEmptyBucket()}return f(n,null,[{key:"getSingleton",value:function(){return h}}]),f(n,[{key:"createEmptyBucket",value:function(){var n=Object.create(null);return u.arrayEach(r,function(t){return n[t]=[]}),n}},{key:"getBucket",value:function(){var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;return n?(n.pluginHookBucket||(n.pluginHookBucket=this.createEmptyBucket()),n.pluginHookBucket):this.globalBucket}},{key:"add",value:function(n,t){var e=this,f=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null,i,r;return Array.isArray(t)?u.arrayEach(t,function(t){return e.add(n,t,f)}):(i=this.getBucket(f),typeof i[n]=="undefined"&&(this.register(n),i[n]=[]),t.skip=!1,i[n].indexOf(t)===-1&&(r=!1,t.initialHook&&u.arrayEach(i[n],function(u,f){if(u.initialHook)return i[n][f]=t,r=!0,!1}),r||i[n].push(t))),this}},{key:"once",value:function(n,t){var r=this,i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;Array.isArray(t)?u.arrayEach(t,function(t){return r.once(n,t,i)}):(t.runOnce=!0,this.add(n,t,i))}},{key:"remove",value:function(n,t){var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null,i=this.getBucket(r);return typeof i[n]!="undefined"&&i[n].indexOf(t)>=0?(t.skip=!0,!0):!1}},{key:"has",value:function(n){var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null,t=this.getBucket(i);return!!(t[n]!==void 0&&t[n].length)}},{key:"run",value:function(n,t,i,r,u,f,e,o){var s=this.globalBucket[t],c=-1,y=s?s.length:0,a,v;if(y)while(++c<y)s[c]&&!s[c].skip&&(a=s[c].call(n,i,r,u,f,e,o),a!==void 0&&(i=a),s[c]&&s[c].runOnce&&this.remove(t,s[c]));var h=this.getBucket(n)[t],l=-1,p=h?h.length:0;if(p)while(++l<p)h[l]&&!h[l].skip&&(v=h[l].call(n,i,r,u,f,e,o),v!==void 0&&(i=v),h[l]&&h[l].runOnce&&this.remove(t,h[l],n));return i}},{key:"destroy",value:function(){var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;o.objectEach(this.getBucket(n),function(n,t,i){return i[t].length=0})}},{key:"register",value:function(n){this.isRegistered(n)||r.push(n)}},{key:"deregister",value:function(n){this.isRegistered(n)&&r.splice(r.indexOf(n),1)}},{key:"isRegistered",value:function(n){return r.indexOf(n)>=0}},{key:"getRegistered",value:function(){return r}}]),n}(),h=new e;t.default=e},function(n,t,i){"use strict";function r(n){return n&&n.__esModule?n:{"default":n}}function ft(n){if(typeof n=="function")return n;if(!e(n))throw Error('No registered renderer found under "'+n+'" name');return it(n)}t.__esModule=!0;t.getRegisteredRenderers=t.getRegisteredRendererNames=t.hasRenderer=t.getRenderer=t.registerRenderer=undefined;var o=i(48),s=r(o),h=i(516),c=r(h),l=i(517),a=r(l),v=i(518),y=r(v),p=i(519),w=r(p),b=i(520),k=r(b),d=i(522),g=r(d),nt=i(523),tt=r(nt);var f=s.default("renderers"),u=f.register,it=f.getItem,e=f.hasItem,rt=f.getNames,ut=f.getValues;u("base",c.default);u("autocomplete",a.default);u("checkbox",y.default);u("html",w.default);u("numeric",k.default);u("password",g.default);u("text",tt.default);t.registerRenderer=u;t.getRenderer=ft;t.hasRenderer=e;t.getRegisteredRendererNames=rt;t.getRegisteredRenderers=ut},function(n,t,i){var r=i(90)("wks"),e=i(55),u=i(17).Symbol,f=typeof u=="function",o=n.exports=function(n){return r[n]||(r[n]=f&&u[n]||(f?u:e)("Symbol."+n))};o.store=r},function(n){var t=n.exports=typeof window!="undefined"&&window.Math==Math?window:typeof self!="undefined"&&self.Math==Math?self:Function("return this")();typeof __g=="number"&&(__g=t)},function(n,t,i){"use strict";function f(n){return n==32||n>=48&&n<=57||n>=96&&n<=111||n>=186&&n<=192||n>=219&&n<=222||n>=226||n>=65&&n<=90}function e(n){var t=[r.ARROW_DOWN,r.ARROW_UP,r.ARROW_LEFT,r.ARROW_RIGHT,r.HOME,r.END,r.DELETE,r.BACKSPACE,r.F1,r.F2,r.F3,r.F4,r.F5,r.F6,r.F7,r.F8,r.F9,r.F10,r.F11,r.F12,r.TAB,r.PAGE_DOWN,r.PAGE_UP,r.ENTER,r.ESCAPE,r.SHIFT,r.CAPS_LOCK,r.ALT];return t.indexOf(n)!==-1}function o(n){var t=[];return window.navigator.platform.includes("Mac")?t.push(r.COMMAND_LEFT,r.COMMAND_RIGHT,r.COMMAND_FIREFOX):t.push(r.CONTROL),t.includes(n)}function s(n){return[r.CONTROL,r.COMMAND_LEFT,r.COMMAND_RIGHT,r.COMMAND_FIREFOX].includes(n)}function h(n,t){var f=t.split("|"),i=!1;return u.arrayEach(f,function(t){if(n===r[t])return i=!0,!1}),i}t.__esModule=!0;t.KEY_CODES=undefined;t.isPrintableChar=f;t.isMetaKey=e;t.isCtrlKey=o;t.isCtrlMetaKey=s;t.isKey=h;var u=i(0),r=t.KEY_CODES={MOUSE_LEFT:1,MOUSE_RIGHT:3,MOUSE_MIDDLE:2,BACKSPACE:8,COMMA:188,INSERT:45,DELETE:46,END:35,ENTER:13,ESCAPE:27,CONTROL:17,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,ALT:18,HOME:36,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,SPACE:32,SHIFT:16,CAPS_LOCK:20,TAB:9,ARROW_RIGHT:39,ARROW_LEFT:37,ARROW_UP:38,ARROW_DOWN:40,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,A:65,X:88,C:67,V:86}},function(n,t,i){"use strict";function r(n){return n&&n.__esModule?n:{"default":n}}function h(n){var t={},i=n;this.getConstructor=function(){return n};this.getInstance=function(n){return n.guid in t||(t[n.guid]=new i(n)),t[n.guid]};y.default.getSingleton().add("afterDestroy",function(){t={}})}function c(n,t){var i=void 0;if(typeof n=="function")e.get(n)||u(null,n),i=e.get(n);else if(typeof n=="string")i=o(n);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!i)throw Error('No editor registered under name "'+n+'"');return i.getInstance(t)}function bt(n){if(!s(n))throw Error('No registered editor found under "'+n+'" name');return o(n).getConstructor()}function u(n,t){var i=new h(t);typeof n=="string"&&yt(n,i);e.set(t,i)}t.__esModule=!0;t.getRegisteredEditors=t.getRegisteredEditorNames=t.hasEditor=t.getEditorInstance=t.getEditor=t.registerEditor=undefined;t.RegisteredEditor=h;t._getEditorInstance=c;var l=i(48),a=r(l),v=i(14),y=r(v),p=i(60),w=r(p),b=i(322),k=r(b),d=i(506),g=r(d),nt=i(507),tt=r(nt),it=i(512),rt=r(it),ut=i(323),ft=r(ut),et=i(513),ot=r(et),st=i(514),ht=r(st),ct=i(515),lt=r(ct),at=i(62),vt=r(at);var e=new WeakMap,f=a.default("editors"),yt=f.register,o=f.getItem,s=f.hasItem,pt=f.getNames,wt=f.getValues;u("base",w.default);u("autocomplete",k.default);u("checkbox",g.default);u("date",tt.default);u("dropdown",rt.default);u("handsontable",ft.default);u("numeric",ot.default);u("password",ht.default);u("select",lt.default);u("text",vt.default);t.registerEditor=u;t.getEditor=bt;t.getEditorInstance=c;t.hasEditor=s;t.getRegisteredEditorNames=pt;t.getRegisteredEditors=wt},function(n,t,i){var r=i(12);n.exports=function(n){if(!r(n))throw TypeError(n+" is not an object!");return n}},function(n,t,i){"use strict";t.__esModule=!0;var u=i(0),f=i(1),r={_localHooks:Object.create(null),addLocalHook:function(n,t){this._localHooks[n]||(this._localHooks[n]=[]);this._localHooks[n].push(t)},runLocalHooks:function(n){for(var f=this,i=arguments.length,r=Array(i>1?i-1:0),t=1;t<i;t++)r[t-1]=arguments[t];this._localHooks[n]&&u.arrayEach(this._localHooks[n],function(n){return n.apply(f,r)})},clearLocalHooks:function(){this._localHooks={}}};f.defineGetter(r,"MIXIN_NAME","localHooks",{writable:!1,enumerable:!1});t.default=r},function(n,t,i){var r=i(20),u=i(164),f=i(86),e=Object.defineProperty;t.f=i(25)?Object.defineProperty:function(n,t,i){if(r(n),t=f(t,!0),r(i),u)try{return e(n,t,i)}catch(o){}if("get"in i||"set"in i)throw TypeError("Accessors not supported!");return"value"in i&&(n[t]=i.value),n}},function(n,t,i){(function(n){var t;
//! moment.js
//! version : 2.20.1
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
(function(t,i){n.exports=i()})(this,function(){"use strict";function u(){return pf.apply(null,arguments)}function ih(n){pf=n}function ut(n){return n instanceof Array||Object.prototype.toString.call(n)==="[object Array]"}function yi(n){return n!=null&&Object.prototype.toString.call(n)==="[object Object]"}function rh(n){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(n).length===0;for(var t in n)if(n.hasOwnProperty(t))return!1;return!0}function k(n){return n===void 0}function ti(n){return typeof n=="number"||Object.prototype.toString.call(n)==="[object Number]"}function tr(n){return n instanceof Date||Object.prototype.toString.call(n)==="[object Date]"}function wf(n,t){for(var r=[],i=0;i<n.length;++i)r.push(t(n[i],i));return r}function y(n,t){return Object.prototype.hasOwnProperty.call(n,t)}function bt(n,t){for(var i in t)y(t,i)&&(n[i]=t[i]);return y(t,"toString")&&(n.toString=t.toString),y(t,"valueOf")&&(n.valueOf=t.valueOf),n}function ht(n,t,i,r){return bo(n,t,i,r,!0).utc()}function uh(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function o(n){return n._pf==null&&(n._pf=uh()),n._pf}function ru(n){if(n._isValid==null){var t=o(n),r=bf.call(t.parsedDateParts,function(n){return n!=null}),i=!isNaN(n._d.getTime())&&t.overflow<0&&!t.empty&&!t.invalidMonth&&!t.invalidWeekday&&!t.weekdayMismatch&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated&&(!t.meridiem||t.meridiem&&r);if(n._strict&&(i=i&&t.charsLeftOver===0&&t.unusedTokens.length===0&&t.bigHour===undefined),Object.isFrozen!=null&&Object.isFrozen(n))return i;n._isValid=i}return n._isValid}function ir(n){var t=ht(NaN);return n!=null?bt(o(t),n):o(t).userInvalidated=!0,t}function uu(n,t){var i,r,u;if(k(t._isAMomentObject)||(n._isAMomentObject=t._isAMomentObject),k(t._i)||(n._i=t._i),k(t._f)||(n._f=t._f),k(t._l)||(n._l=t._l),k(t._strict)||(n._strict=t._strict),k(t._tzm)||(n._tzm=t._tzm),k(t._isUTC)||(n._isUTC=t._isUTC),k(t._offset)||(n._offset=t._offset),k(t._pf)||(n._pf=o(t)),k(t._locale)||(n._locale=t._locale),rr.length>0)for(i=0;i<rr.length;i++)r=rr[i],u=t[r],k(u)||(n[r]=u);return n}function pi(n){uu(this,n);this._d=new Date(n._d!=null?n._d.getTime():NaN);this.isValid()||(this._d=new Date(NaN));ur===!1&&(ur=!0,u.updateOffset(this),ur=!1)}function kt(n){return n instanceof pi||n!=null&&n._isAMomentObject!=null}function tt(n){return n<0?Math.ceil(n)||0:Math.floor(n)}function s(n){var t=+n,i=0;return t!==0&&isFinite(t)&&(i=tt(t)),i}function kf(n,t,i){for(var f=Math.min(n.length,t.length),e=Math.abs(n.length-t.length),u=0,r=0;r<f;r++)(i&&n[r]!==t[r]||!i&&s(n[r])!==s(t[r]))&&u++;return u+e}function df(n){u.suppressDeprecationWarnings===!1&&typeof console!="undefined"&&console.warn&&console.warn("Deprecation warning: "+n)}function it(n,t){var i=!0;return bt(function(){var e,r,f,o;if(u.deprecationHandler!=null&&u.deprecationHandler(null,n),i){for(e=[],f=0;f<arguments.length;f++){if(r="",typeof arguments[f]=="object"){r+="\n["+f+"] ";for(o in arguments[0])r+=o+": "+arguments[0][o]+", ";r=r.slice(0,-2)}else r=arguments[f];e.push(r)}df(n+"\nArguments: "+Array.prototype.slice.call(e).join("")+"\n"+(new Error).stack);i=!1}return t.apply(this,arguments)},t)}function gf(n,t){u.deprecationHandler!=null&&u.deprecationHandler(n,t);fu[n]||(df(t),fu[n]=!0)}function ct(n){return n instanceof Function||Object.prototype.toString.call(n)==="[object Function]"}function fh(n){var t;for(var i in n)t=n[i],ct(t)?this[i]=t:this["_"+i]=t;this._config=n;this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function ne(n,t){var r=bt({},n);for(var i in t)y(t,i)&&(yi(n[i])&&yi(t[i])?(r[i]={},bt(r[i],n[i]),bt(r[i],t[i])):t[i]!=null?r[i]=t[i]:delete r[i]);for(i in n)y(n,i)&&!y(t,i)&&yi(n[i])&&(r[i]=bt({},r[i]));return r}function eu(n){n!=null&&this.set(n)}function eh(n,t,i){var r=this._calendar[n]||this._calendar.sameElse;return ct(r)?r.call(t,i):r}function oh(n){var t=this._longDateFormat[n],i=this._longDateFormat[n.toUpperCase()];return t||!i?t:(this._longDateFormat[n]=i.replace(/MMMM|MM|DD|dddd/g,function(n){return n.slice(1)}),this._longDateFormat[n])}function sh(){return this._invalidDate}function hh(n){return this._ordinal.replace("%d",n)}function ch(n,t,i,r){var u=this._relativeTime[i];return ct(u)?u(n,t,i,r):u.replace(/%d/i,n)}function lh(n,t){var i=this._relativeTime[n>0?"future":"past"];return ct(i)?i(t):i.replace(/%s/i,t)}function d(n,t){var i=n.toLowerCase();oi[i]=oi[i+"s"]=oi[t]=n}function rt(n){return typeof n=="string"?oi[n]||oi[n.toLowerCase()]:undefined}function ou(n){var r={},t;for(var i in n)y(n,i)&&(t=rt(i),t&&(r[t]=n[i]));return r}function g(n,t){su[n]=t}function ah(n){var t=[];for(var i in n)t.push({unit:i,priority:su[i]});return t.sort(function(n,t){return n.priority-t.priority}),t}function vt(n,t,i){var r=""+Math.abs(n),u=t-r.length,f=n>=0;return(f?i?"+":"":"-")+Math.pow(10,Math.max(0,u)).toString().substr(1)+r}function e(n,t,i,r){var u=r;typeof r=="string"&&(u=function(){return this[r]()});n&&(si[n]=u);t&&(si[t[0]]=function(){return vt(u.apply(this,arguments),t[1],t[2])});i&&(si[i]=function(){return this.localeData().ordinal(u.apply(this,arguments),n)})}function vh(n){return n.match(/\[[\s\S]/)?n.replace(/^\[|\]$/g,""):n.replace(/\\/g,"")}function yh(n){for(var t=n.match(se),i=0,r=t.length;i<r;i++)t[i]=si[t[i]]?si[t[i]]:vh(t[i]);return function(i){for(var f="",u=0;u<r;u++)f+=ct(t[u])?t[u].call(i,n):t[u];return f}}function er(n,t){return n.isValid()?(t=he(t,n.localeData()),hu[t]=hu[t]||yh(t),hu[t](n)):n.localeData().invalidDate()}function he(n,t){function r(n){return t.longDateFormat(n)||n}var i=5;for(fr.lastIndex=0;i>=0&&fr.test(n);)n=n.replace(fr,r),fr.lastIndex=0,i-=1;return n}function f(n,t,i){au[n]=ct(t)?t:function(n){return n&&i?i:t}}function wh(n,t){return y(au,n)?au[n](t._strict,t._locale):new RegExp(bh(n))}function bh(n){return ii(n.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(n,t,i,r,u){return t||i||r||u}))}function ii(n){return n.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function a(n,t){var i,r=t;for(typeof n=="string"&&(n=[n]),ti(t)&&(r=function(n,i){i[t]=s(n)}),i=0;i<n.length;i++)ar[n[i]]=r}function bi(n,t){a(n,function(n,i,r,u){r._w=r._w||{};t(n,r._w,r,u)})}function kh(n,t,i){t!=null&&y(ar,n)&&ar[n](t,i._a,i,n)}function ki(n){return vr(n)?366:365}function vr(n){return n%4==0&&n%100!=0||n%400==0}function nc(){return vr(this.year())}function hi(n,t){return function(i){return i!=null?(ye(this,n,i),u.updateOffset(this,t),this):yr(this,n)}}function yr(n,t){return n.isValid()?n._d["get"+(n._isUTC?"UTC":"")+t]():NaN}function ye(n,t,i){n.isValid()&&!isNaN(i)&&(t==="FullYear"&&vr(n.year())&&n.month()===1&&n.date()===29?n._d["set"+(n._isUTC?"UTC":"")+t](i,n.month(),pr(i,n.month())):n._d["set"+(n._isUTC?"UTC":"")+t](i))}function tc(n){return(n=rt(n),ct(this[n]))?this[n]():this}function ic(n,t){var r,i;if(typeof n=="object")for(n=ou(n),r=ah(n),i=0;i<r.length;i++)this[r[i].unit](n[r[i].unit]);else if(n=rt(n),ct(this[n]))return this[n](t);return this}function rc(n,t){return(n%t+t)%t}function pr(n,t){if(isNaN(n)||isNaN(t))return NaN;var i=rc(t,12);return n+=(t-i)/12,i===1?vr(n)?29:28:31-i%7%2}function uc(n,t){return n?ut(this._months)?this._months[n.month()]:this._months[(this._months.isFormat||yu).test(t)?"format":"standalone"][n.month()]:ut(this._months)?this._months:this._months.standalone}function fc(n,t){return n?ut(this._monthsShort)?this._monthsShort[n.month()]:this._monthsShort[yu.test(t)?"format":"standalone"][n.month()]:ut(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function ec(n,t,i){var u,r,e,f=n.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],u=0;u<12;++u)e=ht([2e3,u]),this._shortMonthsParse[u]=this.monthsShort(e,"").toLocaleLowerCase(),this._longMonthsParse[u]=this.months(e,"").toLocaleLowerCase();return i?t==="MMM"?(r=p.call(this._shortMonthsParse,f),r!==-1?r:null):(r=p.call(this._longMonthsParse,f),r!==-1?r:null):t==="MMM"?(r=p.call(this._shortMonthsParse,f),r!==-1)?r:(r=p.call(this._longMonthsParse,f),r!==-1?r:null):(r=p.call(this._longMonthsParse,f),r!==-1)?r:(r=p.call(this._shortMonthsParse,f),r!==-1?r:null)}function oc(n,t,i){var r,u,f;if(this._monthsParseExact)return ec.call(this,n,t,i);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),r=0;r<12;r++)if((u=ht([2e3,r]),i&&!this._longMonthsParse[r]&&(this._longMonthsParse[r]=new RegExp("^"+this.months(u,"").replace(".","")+"$","i"),this._shortMonthsParse[r]=new RegExp("^"+this.monthsShort(u,"").replace(".","")+"$","i")),i||this._monthsParse[r]||(f="^"+this.months(u,"")+"|^"+this.monthsShort(u,""),this._monthsParse[r]=new RegExp(f.replace(".",""),"i")),i&&t==="MMMM"&&this._longMonthsParse[r].test(n))||i&&t==="MMM"&&this._shortMonthsParse[r].test(n)||!i&&this._monthsParse[r].test(n))return r}function we(n,t){var i;if(!n.isValid())return n;if(typeof t=="string")if(/^\d+$/.test(t))t=s(t);else if(t=n.localeData().monthsParse(t),!ti(t))return n;return i=Math.min(n.date(),pr(n.year(),t)),n._d["set"+(n._isUTC?"UTC":"")+"Month"](t,i),n}function be(n){return n!=null?(we(this,n),u.updateOffset(this,!0),this):yr(this,"Month")}function sc(){return pr(this.year(),this.month())}function hc(n){return this._monthsParseExact?(y(this,"_monthsRegex")||ge.call(this),n?this._monthsShortStrictRegex:this._monthsShortRegex):(y(this,"_monthsShortRegex")||(this._monthsShortRegex=ke),this._monthsShortStrictRegex&&n?this._monthsShortStrictRegex:this._monthsShortRegex)}function cc(n){return this._monthsParseExact?(y(this,"_monthsRegex")||ge.call(this),n?this._monthsStrictRegex:this._monthsRegex):(y(this,"_monthsRegex")||(this._monthsRegex=de),this._monthsStrictRegex&&n?this._monthsStrictRegex:this._monthsRegex)}function ge(){function f(n,t){return t.length-n.length}for(var i=[],r=[],t=[],u,n=0;n<12;n++)u=ht([2e3,n]),i.push(this.monthsShort(u,"")),r.push(this.months(u,"")),t.push(this.months(u,"")),t.push(this.monthsShort(u,""));for(i.sort(f),r.sort(f),t.sort(f),n=0;n<12;n++)i[n]=ii(i[n]),r[n]=ii(r[n]);for(n=0;n<24;n++)t[n]=ii(t[n]);this._monthsRegex=new RegExp("^("+t.join("|")+")","i");this._monthsShortRegex=this._monthsRegex;this._monthsStrictRegex=new RegExp("^("+r.join("|")+")","i");this._monthsShortStrictRegex=new RegExp("^("+i.join("|")+")","i")}function lc(n,t,i,r,u,f,e){var o=new Date(n,t,i,r,u,f,e);return n<100&&n>=0&&isFinite(o.getFullYear())&&o.setFullYear(n),o}function di(n){var t=new Date(Date.UTC.apply(null,arguments));return n<100&&n>=0&&isFinite(t.getUTCFullYear())&&t.setUTCFullYear(n),t}function wr(n,t,i){var r=7+t-i,u=(7+di(n,0,r).getUTCDay()-t)%7;return-u+r-1}function no(n,t,i,r,u){var s=(7+i-r)%7,h=wr(n,r,u),f=1+7*(t-1)+s+h,e,o;return f<=0?(e=n-1,o=ki(e)+f):f>ki(n)?(e=n+1,o=f-ki(n)):(e=n,o=f),{year:e,dayOfYear:o}}function gi(n,t,i){var e=wr(n.year(),t,i),r=Math.floor((n.dayOfYear()-e-1)/7)+1,f,u;return r<1?(u=n.year()-1,f=r+ui(u,t,i)):r>ui(n.year(),t,i)?(f=r-ui(n.year(),t,i),u=n.year()+1):(u=n.year(),f=r),{week:f,year:u}}function ui(n,t,i){var r=wr(n,t,i),u=wr(n+1,t,i);return(ki(n)-r+u)/7}function ac(n){return gi(n,this._week.dow,this._week.doy).week}function vc(){return this._week.dow}function yc(){return this._week.doy}function pc(n){var t=this.localeData().week(this);return n==null?t:this.add((n-t)*7,"d")}function wc(n){var t=gi(this,1,4).week;return n==null?t:this.add((n-t)*7,"d")}function bc(n,t){return typeof n!="string"?n:isNaN(n)?(n=t.weekdaysParse(n),typeof n=="number")?n:null:parseInt(n,10)}function kc(n,t){return typeof n=="string"?t.weekdaysParse(n)%7||7:isNaN(n)?null:n}function dc(n,t){return n?ut(this._weekdays)?this._weekdays[n.day()]:this._weekdays[this._weekdays.isFormat.test(t)?"format":"standalone"][n.day()]:ut(this._weekdays)?this._weekdays:this._weekdays.standalone}function gc(n){return n?this._weekdaysShort[n.day()]:this._weekdaysShort}function nl(n){return n?this._weekdaysMin[n.day()]:this._weekdaysMin}function tl(n,t,i){var f,r,e,u=n.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],f=0;f<7;++f)e=ht([2e3,1]).day(f),this._minWeekdaysParse[f]=this.weekdaysMin(e,"").toLocaleLowerCase(),this._shortWeekdaysParse[f]=this.weekdaysShort(e,"").toLocaleLowerCase(),this._weekdaysParse[f]=this.weekdays(e,"").toLocaleLowerCase();return i?t==="dddd"?(r=p.call(this._weekdaysParse,u),r!==-1?r:null):t==="ddd"?(r=p.call(this._shortWeekdaysParse,u),r!==-1?r:null):(r=p.call(this._minWeekdaysParse,u),r!==-1?r:null):t==="dddd"?(r=p.call(this._weekdaysParse,u),r!==-1)?r:(r=p.call(this._shortWeekdaysParse,u),r!==-1)?r:(r=p.call(this._minWeekdaysParse,u),r!==-1?r:null):t==="ddd"?(r=p.call(this._shortWeekdaysParse,u),r!==-1)?r:(r=p.call(this._weekdaysParse,u),r!==-1)?r:(r=p.call(this._minWeekdaysParse,u),r!==-1?r:null):(r=p.call(this._minWeekdaysParse,u),r!==-1)?r:(r=p.call(this._weekdaysParse,u),r!==-1)?r:(r=p.call(this._shortWeekdaysParse,u),r!==-1?r:null)}function il(n,t,i){var r,u,f;if(this._weekdaysParseExact)return tl.call(this,n,t,i);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),r=0;r<7;r++)if((u=ht([2e3,1]).day(r),i&&!this._fullWeekdaysParse[r]&&(this._fullWeekdaysParse[r]=new RegExp("^"+this.weekdays(u,"").replace(".",".?")+"$","i"),this._shortWeekdaysParse[r]=new RegExp("^"+this.weekdaysShort(u,"").replace(".",".?")+"$","i"),this._minWeekdaysParse[r]=new RegExp("^"+this.weekdaysMin(u,"").replace(".",".?")+"$","i")),this._weekdaysParse[r]||(f="^"+this.weekdays(u,"")+"|^"+this.weekdaysShort(u,"")+"|^"+this.weekdaysMin(u,""),this._weekdaysParse[r]=new RegExp(f.replace(".",""),"i")),i&&t==="dddd"&&this._fullWeekdaysParse[r].test(n))||i&&t==="ddd"&&this._shortWeekdaysParse[r].test(n)||i&&t==="dd"&&this._minWeekdaysParse[r].test(n)||!i&&this._weekdaysParse[r].test(n))return r}function rl(n){if(!this.isValid())return n!=null?this:NaN;var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return n!=null?(n=bc(n,this.localeData()),this.add(n-t,"d")):t}function ul(n){if(!this.isValid())return n!=null?this:NaN;var t=(this.day()+7-this.localeData()._week.dow)%7;return n==null?t:this.add(n-t,"d")}function fl(n){if(!this.isValid())return n!=null?this:NaN;if(n!=null){var t=kc(n,this.localeData());return this.day(this.day()%7?t:t-7)}return this.day()||7}function el(n){return this._weekdaysParseExact?(y(this,"_weekdaysRegex")||bu.call(this),n?this._weekdaysStrictRegex:this._weekdaysRegex):(y(this,"_weekdaysRegex")||(this._weekdaysRegex=uo),this._weekdaysStrictRegex&&n?this._weekdaysStrictRegex:this._weekdaysRegex)}function ol(n){return this._weekdaysParseExact?(y(this,"_weekdaysRegex")||bu.call(this),n?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(y(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=fo),this._weekdaysShortStrictRegex&&n?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function sl(n){return this._weekdaysParseExact?(y(this,"_weekdaysRegex")||bu.call(this),n?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(y(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=eo),this._weekdaysMinStrictRegex&&n?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function bu(){function u(n,t){return t.length-n.length}for(var e=[],i=[],r=[],t=[],f,o,s,h,n=0;n<7;n++)f=ht([2e3,1]).day(n),o=this.weekdaysMin(f,""),s=this.weekdaysShort(f,""),h=this.weekdays(f,""),e.push(o),i.push(s),r.push(h),t.push(o),t.push(s),t.push(h);for(e.sort(u),i.sort(u),r.sort(u),t.sort(u),n=0;n<7;n++)i[n]=ii(i[n]),r[n]=ii(r[n]),t[n]=ii(t[n]);this._weekdaysRegex=new RegExp("^("+t.join("|")+")","i");this._weekdaysShortRegex=this._weekdaysRegex;this._weekdaysMinRegex=this._weekdaysRegex;this._weekdaysStrictRegex=new RegExp("^("+r.join("|")+")","i");this._weekdaysShortStrictRegex=new RegExp("^("+i.join("|")+")","i");this._weekdaysMinStrictRegex=new RegExp("^("+e.join("|")+")","i")}function ku(){return this.hours()%12||12}function hl(){return this.hours()||24}function oo(n,t){e(n,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)})}function so(n,t){return t._meridiemParse}function cl(n){return(n+"").toLowerCase().charAt(0)==="p"}function ll(n,t,i){return n>11?i?"pm":"PM":i?"am":"AM"}function lo(n){return n?n.toLowerCase().replace("_","-"):n}function vl(n){for(var r=0,i,t,f,u;r<n.length;){for(u=lo(n[r]).split("-"),i=u.length,t=lo(n[r+1]),t=t?t.split("-"):null;i>0;){if(f=du(u.slice(0,i).join("-")),f)return f;if(t&&t.length>=i&&kf(u,t,!0)>=i-1)break;i--}r++}return null}function du(r){var u=null,f;if(!b[r]&&typeof n!="undefined"&&n&&n.exports)try{u=br._abbr;f=t;i(500)("./"+r);ci(u)}catch(e){}return b[r]}function ci(n,t){var i;return n&&(i=k(t)?dt(n):gu(n,t),i&&(br=i)),br._abbr}function gu(n,t){if(t!==null){var i=co;if(t.abbr=n,b[n]!=null)gf("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),i=b[n]._config;else if(t.parentLocale!=null)if(b[t.parentLocale]!=null)i=b[t.parentLocale]._config;else return nr[t.parentLocale]||(nr[t.parentLocale]=[]),nr[t.parentLocale].push({name:n,config:t}),null;return b[n]=new eu(ne(i,t)),nr[n]&&nr[n].forEach(function(n){gu(n.name,n.config)}),ci(n),b[n]}return delete b[n],null}function yl(n,t){if(t!=null){var i,r,u=co;r=du(n);r!=null&&(u=r._config);t=ne(u,t);i=new eu(t);i.parentLocale=b[n];b[n]=i;ci(n)}else b[n]!=null&&(b[n].parentLocale!=null?b[n]=b[n].parentLocale:b[n]!=null&&delete b[n]);return b[n]}function dt(n){var t;if(n&&n._locale&&n._locale._abbr&&(n=n._locale._abbr),!n)return br;if(!ut(n)){if(t=du(n),t)return t;n=[n]}return vl(n)}function pl(){return te(b)}function nf(n){var i,t=n._a;return t&&o(n).overflow===-2&&(i=t[yt]<0||t[yt]>11?yt:t[lt]<1||t[lt]>pr(t[ft],t[yt])?lt:t[w]<0||t[w]>24||t[w]===24&&(t[et]!==0||t[pt]!==0||t[ri]!==0)?w:t[et]<0||t[et]>59?et:t[pt]<0||t[pt]>59?pt:t[ri]<0||t[ri]>999?ri:-1,o(n)._overflowDayOfYear&&(i<ft||i>lt)&&(i=lt),o(n)._overflowWeeks&&i===-1&&(i=dh),o(n)._overflowWeekday&&i===-1&&(i=gh),o(n).overflow=i),n}function li(n,t,i){return n!=null?n:t!=null?t:i}function wl(n){var t=new Date(u.now());return n._useUTC?[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]:[t.getFullYear(),t.getMonth(),t.getDate()]}function tf(n){var t,i,r=[],u,e,f;if(!n._d){for(u=wl(n),n._w&&n._a[lt]==null&&n._a[yt]==null&&bl(n),n._dayOfYear!=null&&(f=li(n._a[ft],u[ft]),(n._dayOfYear>ki(f)||n._dayOfYear===0)&&(o(n)._overflowDayOfYear=!0),i=di(f,0,n._dayOfYear),n._a[yt]=i.getUTCMonth(),n._a[lt]=i.getUTCDate()),t=0;t<3&&n._a[t]==null;++t)n._a[t]=r[t]=u[t];for(;t<7;t++)n._a[t]=r[t]=n._a[t]==null?t===2?1:0:n._a[t];n._a[w]===24&&n._a[et]===0&&n._a[pt]===0&&n._a[ri]===0&&(n._nextDay=!0,n._a[w]=0);n._d=(n._useUTC?di:lc).apply(null,r);e=n._useUTC?n._d.getUTCDay():n._d.getDay();n._tzm!=null&&n._d.setUTCMinutes(n._d.getUTCMinutes()-n._tzm);n._nextDay&&(n._a[w]=24);n._w&&typeof n._w.d!="undefined"&&n._w.d!==e&&(o(n).weekdayMismatch=!0)}}function bl(n){var t,e,u,i,r,f,h,s,c;t=n._w;t.GG!=null||t.W!=null||t.E!=null?(r=1,f=4,e=li(t.GG,n._a[ft],gi(v(),1,4).year),u=li(t.W,1),i=li(t.E,1),(i<1||i>7)&&(s=!0)):(r=n._locale._week.dow,f=n._locale._week.doy,c=gi(v(),r,f),e=li(t.gg,n._a[ft],c.year),u=li(t.w,c.week),t.d!=null?(i=t.d,(i<0||i>6)&&(s=!0)):t.e!=null?(i=t.e+r,(t.e<0||t.e>6)&&(s=!0)):i=r);u<1||u>ui(e,r,f)?o(n)._overflowWeeks=!0:s!=null?o(n)._overflowWeekday=!0:(h=no(e,u,i,r,f),n._a[ft]=h.year,n._dayOfYear=h.dayOfYear)}function ao(n){var t,r,e=n._i,i=kl.exec(e)||dl.exec(e),s,f,u,h;if(i){for(o(n).iso=!0,t=0,r=kr.length;t<r;t++)if(kr[t][1].exec(i[1])){f=kr[t][0];s=kr[t][2]!==!1;break}if(f==null){n._isValid=!1;return}if(i[3]){for(t=0,r=rf.length;t<r;t++)if(rf[t][1].exec(i[3])){u=(i[2]||" ")+rf[t][0];break}if(u==null){n._isValid=!1;return}}if(!s&&u!=null){n._isValid=!1;return}if(i[4])if(gl.exec(i[4]))h="Z";else{n._isValid=!1;return}n._f=f+(u||"")+(h||"");uf(n)}else n._isValid=!1}function ta(n,t,i,r,u,f){var e=[ia(n),pu.indexOf(t),parseInt(i,10),parseInt(r,10),parseInt(u,10)];return f&&e.push(parseInt(f,10)),e}function ia(n){var t=parseInt(n,10);return t<=49?2e3+t:t<=999?1900+t:t}function ra(n){return n.replace(/\([^)]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").trim()}function ua(n,t,i){if(n){var r=wu.indexOf(n),u=new Date(t[0],t[1],t[2]).getDay();if(r!==u)return o(i).weekdayMismatch=!0,i._isValid=!1,!1}return!0}function fa(n,t,i){if(n)return yo[n];if(t)return 0;var r=parseInt(i,10),u=r%100,f=(r-u)/100;return f*60+u}function po(n){var t=vo.exec(ra(n._i)),i;if(t){if(i=ta(t[4],t[3],t[2],t[5],t[6],t[7]),!ua(t[1],i,n))return;n._a=i;n._tzm=fa(t[8],t[9],t[10]);n._d=di.apply(null,n._a);n._d.setUTCMinutes(n._d.getUTCMinutes()-n._tzm);o(n).rfc2822=!0}else n._isValid=!1}function ea(n){var t=na.exec(n._i);if(t!==null){n._d=new Date(+t[1]);return}if(ao(n),n._isValid===!1)delete n._isValid;else return;if(po(n),n._isValid===!1)delete n._isValid;else return;u.createFromInputFallback(n)}function uf(n){if(n._f===u.ISO_8601){ao(n);return}if(n._f===u.RFC_2822){po(n);return}n._a=[];o(n).empty=!0;for(var t=""+n._i,i,r,s,c=t.length,h=0,e=he(n._f,n._locale).match(se)||[],f=0;f<e.length;f++)r=e[f],i=(t.match(wh(r,n))||[])[0],i&&(s=t.substr(0,t.indexOf(i)),s.length>0&&o(n).unusedInput.push(s),t=t.slice(t.indexOf(i)+i.length),h+=i.length),si[r]?(i?o(n).empty=!1:o(n).unusedTokens.push(r),kh(r,i,n)):n._strict&&!i&&o(n).unusedTokens.push(r);o(n).charsLeftOver=c-h;t.length>0&&o(n).unusedInput.push(t);n._a[w]<=12&&o(n).bigHour===!0&&n._a[w]>0&&(o(n).bigHour=undefined);o(n).parsedDateParts=n._a.slice(0);o(n).meridiem=n._meridiem;n._a[w]=oa(n._locale,n._a[w],n._meridiem);tf(n);nf(n)}function oa(n,t,i){var r;return i==null?t:n.meridiemHour!=null?n.meridiemHour(t,i):n.isPM!=null?(r=n.isPM(i),r&&t<12&&(t+=12),r||t!==12||(t=0),t):t}function sa(n){var t,f,u,r,i;if(n._f.length===0){o(n).invalidFormat=!0;n._d=new Date(NaN);return}for(r=0;r<n._f.length;r++)(i=0,t=uu({},n),n._useUTC!=null&&(t._useUTC=n._useUTC),t._f=n._f[r],uf(t),ru(t))&&(i+=o(t).charsLeftOver,i+=o(t).unusedTokens.length*10,o(t).score=i,(u==null||i<u)&&(u=i,f=t));bt(n,f||t)}function ha(n){if(!n._d){var t=ou(n._i);n._a=wf([t.year,t.month,t.day||t.date,t.hour,t.minute,t.second,t.millisecond],function(n){return n&&parseInt(n,10)});tf(n)}}function ca(n){var t=new pi(nf(wo(n)));return t._nextDay&&(t.add(1,"d"),t._nextDay=undefined),t}function wo(n){var t=n._i,i=n._f;return(n._locale=n._locale||dt(n._l),t===null||i===undefined&&t==="")?ir({nullInput:!0}):(typeof t=="string"&&(n._i=t=n._locale.preparse(t)),kt(t))?new pi(nf(t)):(tr(t)?n._d=t:ut(i)?sa(n):i?uf(n):la(n),ru(n)||(n._d=null),n)}function la(n){var t=n._i;k(t)?n._d=new Date(u.now()):tr(t)?n._d=new Date(t.valueOf()):typeof t=="string"?ea(n):ut(t)?(n._a=wf(t.slice(0),function(n){return parseInt(n,10)}),tf(n)):yi(t)?ha(n):ti(t)?n._d=new Date(t):u.createFromInputFallback(n)}function bo(n,t,i,r,u){var f={};return(i===!0||i===!1)&&(r=i,i=undefined),(yi(n)&&rh(n)||ut(n)&&n.length===0)&&(n=undefined),f._isAMomentObject=!0,f._useUTC=f._isUTC=u,f._l=i,f._i=n,f._f=t,f._strict=r,ca(f)}function v(n,t,i,r){return bo(n,t,i,r,!1)}function ns(n,t){var r,i;if(t.length===1&&ut(t[0])&&(t=t[0]),!t.length)return v();for(r=t[0],i=1;i<t.length;++i)(!t[i].isValid()||t[i][n](r))&&(r=t[i]);return r}function aa(){var n=[].slice.call(arguments,0);return ns("isBefore",n)}function va(){var n=[].slice.call(arguments,0);return ns("isAfter",n)}function ya(n){var i,r,t;for(i in n)if(!(p.call(ai,i)!==-1&&(n[i]==null||!isNaN(n[i]))))return!1;for(r=!1,t=0;t<ai.length;++t)if(n[ai[t]]){if(r)return!1;parseFloat(n[ai[t]])!==s(n[ai[t]])&&(r=!0)}return!0}function pa(){return this._isValid}function wa(){return ot(NaN)}function dr(n){var t=ou(n),i=t.year||0,r=t.quarter||0,u=t.month||0,f=t.week||0,e=t.day||0,o=t.hour||0,s=t.minute||0,h=t.second||0,c=t.millisecond||0;this._isValid=ya(t);this._milliseconds=+c+h*1e3+s*6e4+o*36e5;this._days=+e+f*7;this._months=+u+r*3+i*12;this._data={};this._locale=dt();this._bubble()}function ff(n){return n instanceof dr}function ef(n){return n<0?Math.round(-1*n)*-1:Math.round(n)}function is(n,t){e(n,0,0,function(){var n=this.utcOffset(),i="+";return n<0&&(n=-n,i="-"),i+vt(~~(n/60),2)+t+vt(~~n%60,2)})}function of(n,t){var i=(t||"").match(n);if(i===null)return null;var f=i[i.length-1]||[],r=(f+"").match(rs)||["-",0,0],u=+(r[1]*60)+s(r[2]);return u===0?0:r[0]==="+"?u:-u}function sf(n,t){var i,r;return t._isUTC?(i=t.clone(),r=(kt(n)||tr(n)?n.valueOf():v(n).valueOf())-i.valueOf(),i._d.setTime(i._d.valueOf()+r),u.updateOffset(i,!1),i):v(n).local()}function hf(n){return-Math.round(n._d.getTimezoneOffset()/15)*15}function ba(n,t,i){var r=this._offset||0,f;if(!this.isValid())return n!=null?this:NaN;if(n!=null){if(typeof n=="string"){if(n=of(lr,n),n===null)return this}else Math.abs(n)<16&&!i&&(n=n*60);return!this._isUTC&&t&&(f=hf(this)),this._offset=n,this._isUTC=!0,f!=null&&this.add(f,"m"),r!==n&&(!t||this._changeInProgress?hs(this,ot(n-r,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,u.updateOffset(this,!0),this._changeInProgress=null)),this}return this._isUTC?r:hf(this)}function ka(n,t){return n!=null?(typeof n!="string"&&(n=-n),this.utcOffset(n,t),this):-this.utcOffset()}function da(n){return this.utcOffset(0,n)}function ga(n){return this._isUTC&&(this.utcOffset(0,n),this._isUTC=!1,n&&this.subtract(hf(this),"m")),this}function nv(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var n=of(ph,this._i);n!=null?this.utcOffset(n):this.utcOffset(0,!0)}return this}function tv(n){return this.isValid()?(n=n?v(n).utcOffset():0,(this.utcOffset()-n)%60==0):!1}function iv(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function rv(){var n,t;return k(this._isDSTShifted)?(n={},uu(n,this),n=wo(n),n._a?(t=n._isUTC?ht(n._a):v(n._a),this._isDSTShifted=this.isValid()&&kf(n._a,t.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted):this._isDSTShifted}function uv(){return this.isValid()?!this._isUTC:!1}function fv(){return this.isValid()?this._isUTC:!1}function us(){return this.isValid()?this._isUTC&&this._offset===0:!1}function ot(n,t){var i=n,r=null,u,f,e;return ff(n)?i={ms:n._milliseconds,d:n._days,M:n._months}:ti(n)?(i={},t?i[t]=n:i.milliseconds=n):(r=fs.exec(n))?(u=r[1]==="-"?-1:1,i={y:0,d:s(r[lt])*u,h:s(r[w])*u,m:s(r[et])*u,s:s(r[pt])*u,ms:s(ef(r[ri]*1e3))*u}):(r=es.exec(n))?(u=r[1]==="-"?-1:r[1]==="+"?1:1,i={y:fi(r[2],u),M:fi(r[3],u),w:fi(r[4],u),d:fi(r[5],u),h:fi(r[6],u),m:fi(r[7],u),s:fi(r[8],u)}):i==null?i={}:typeof i=="object"&&("from"in i||"to"in i)&&(e=ev(v(i.from),v(i.to)),i={},i.ms=e.milliseconds,i.M=e.months),f=new dr(i),ff(n)&&y(n,"_locale")&&(f._locale=n._locale),f}function fi(n,t){var i=n&&parseFloat(n.replace(",","."));return(isNaN(i)?0:i)*t}function os(n,t){var i={milliseconds:0,months:0};return i.months=t.month()-n.month()+(t.year()-n.year())*12,n.clone().add(i.months,"M").isAfter(t)&&--i.months,i.milliseconds=+t-+n.clone().add(i.months,"M"),i}function ev(n,t){var i;return(n.isValid()&&t.isValid())?(t=sf(t,n),n.isBefore(t)?i=os(n,t):(i=os(t,n),i.milliseconds=-i.milliseconds,i.months=-i.months),i):{milliseconds:0,months:0}}function ss(n,t){return function(i,r){var u,f;return r===null||isNaN(+r)||(gf(t,"moment()."+t+"(period, number) is deprecated. Please use moment()."+t+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),f=i,i=r,r=f),i=typeof i=="string"?+i:i,u=ot(i,r),hs(this,u,n),this}}function hs(n,t,i,r){var o=t._milliseconds,f=ef(t._days),e=ef(t._months);n.isValid()&&(r=r==null?!0:r,e&&we(n,yr(n,"Month")+e*i),f&&ye(n,"Date",yr(n,"Date")+f*i),o&&n._d.setTime(n._d.valueOf()+o*i),r&&u.updateOffset(n,f||e))}function ov(n,t){var i=n.diff(t,"days",!0);return i<-6?"sameElse":i<-1?"lastWeek":i<0?"lastDay":i<1?"sameDay":i<2?"nextDay":i<7?"nextWeek":"sameElse"}function sv(n,t){var r=n||v(),f=sf(r,this).startOf("day"),i=u.calendarFormat(this,f)||"sameElse",e=t&&(ct(t[i])?t[i].call(this,r):t[i]);return this.format(e||this.localeData().calendar(i,this,v(r)))}function hv(){return new pi(this)}function cv(n,t){var i=kt(n)?n:v(n);return(this.isValid()&&i.isValid())?(t=rt(k(t)?"millisecond":t),t==="millisecond"?this.valueOf()>i.valueOf():i.valueOf()<this.clone().startOf(t).valueOf()):!1}function lv(n,t){var i=kt(n)?n:v(n);return(this.isValid()&&i.isValid())?(t=rt(k(t)?"millisecond":t),t==="millisecond"?this.valueOf()<i.valueOf():this.clone().endOf(t).valueOf()<i.valueOf()):!1}function av(n,t,i,r){return r=r||"()",(r[0]==="("?this.isAfter(n,i):!this.isBefore(n,i))&&(r[1]===")"?this.isBefore(t,i):!this.isAfter(t,i))}function vv(n,t){var i=kt(n)?n:v(n),r;return(this.isValid()&&i.isValid())?(t=rt(t||"millisecond"),t==="millisecond"?this.valueOf()===i.valueOf():(r=i.valueOf(),this.clone().startOf(t).valueOf()<=r&&r<=this.clone().endOf(t).valueOf())):!1}function yv(n,t){return this.isSame(n,t)||this.isAfter(n,t)}function pv(n,t){return this.isSame(n,t)||this.isBefore(n,t)}function wv(n,t,i){var r,f,u;if(!this.isValid())return NaN;if(r=sf(n,this),!r.isValid())return NaN;f=(r.utcOffset()-this.utcOffset())*6e4;t=rt(t);switch(t){case"year":u=cf(this,r)/12;break;case"month":u=cf(this,r);break;case"quarter":u=cf(this,r)/3;break;case"second":u=(this-r)/1e3;break;case"minute":u=(this-r)/6e4;break;case"hour":u=(this-r)/36e5;break;case"day":u=(this-r-f)/864e5;break;case"week":u=(this-r-f)/6048e5;break;default:u=this-r}return i?u:tt(u)}function cf(n,t){var r=(t.year()-n.year())*12+(t.month()-n.month()),i=n.clone().add(r,"months"),u,f;return t-i<0?(u=n.clone().add(r-1,"months"),f=(t-i)/(i-u)):(u=n.clone().add(r+1,"months"),f=(t-i)/(u-i)),-(r+f)||0}function bv(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function kv(n){if(!this.isValid())return null;var i=n!==!0,t=i?this.clone().utc():this;return t.year()<0||t.year()>9999?er(t,i?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):ct(Date.prototype.toISOString)?i?this.toDate().toISOString():new Date(this._d.valueOf()).toISOString().replace("Z",er(t,"Z")):er(t,i?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function dv(){var n,t;if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";n="moment";t="";this.isLocal()||(n=this.utcOffset()===0?"moment.utc":"moment.parseZone",t="Z");var i="["+n+'("]',r=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",u=t+'[")]';return this.format(i+r+"-MM-DD[T]HH:mm:ss.SSS"+u)}function gv(n){n||(n=this.isUtc()?u.defaultFormatUtc:u.defaultFormat);var t=er(this,n);return this.localeData().postformat(t)}function ny(n,t){return this.isValid()&&(kt(n)&&n.isValid()||v(n).isValid())?ot({to:this,from:n}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function ty(n){return this.from(v(),n)}function iy(n,t){return this.isValid()&&(kt(n)&&n.isValid()||v(n).isValid())?ot({from:this,to:n}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function ry(n){return this.to(v(),n)}function as(n){var t;return n===undefined?this._locale._abbr:(t=dt(n),t!=null&&(this._locale=t),this)}function vs(){return this._locale}function uy(n){n=rt(n);switch(n){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":case"date":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return n==="week"&&this.weekday(0),n==="isoWeek"&&this.isoWeekday(1),n==="quarter"&&this.month(Math.floor(this.month()/3)*3),this}function fy(n){return(n=rt(n),n===undefined||n==="millisecond")?this:(n==="date"&&(n="day"),this.startOf(n).add(1,n==="isoWeek"?"week":n).subtract(1,"ms"))}function ey(){return this._d.valueOf()-(this._offset||0)*6e4}function oy(){return Math.floor(this.valueOf()/1e3)}function sy(){return new Date(this.valueOf())}function hy(){var n=this;return[n.year(),n.month(),n.date(),n.hour(),n.minute(),n.second(),n.millisecond()]}function cy(){var n=this;return{years:n.year(),months:n.month(),date:n.date(),hours:n.hours(),minutes:n.minutes(),seconds:n.seconds(),milliseconds:n.milliseconds()}}function ly(){return this.isValid()?this.toISOString():null}function ay(){return ru(this)}function vy(){return bt({},o(this))}function yy(){return o(this).overflow}function py(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}function gr(n,t){e(0,[n,n.length],0,t)}function wy(n){return ys.call(this,n,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function by(n){return ys.call(this,n,this.isoWeek(),this.isoWeekday(),1,4)}function ky(){return ui(this.year(),1,4)}function dy(){var n=this.localeData()._week;return ui(this.year(),n.dow,n.doy)}function ys(n,t,i,r,u){var f;return n==null?gi(this,r,u).year:(f=ui(n,r,u),t>f&&(t=f),gy.call(this,n,t,i,r,u))}function gy(n,t,i,r,u){var e=no(n,t,i,r,u),f=di(e.year,0,e.dayOfYear);return this.year(f.getUTCFullYear()),this.month(f.getUTCMonth()),this.date(f.getUTCDate()),this}function np(n){return n==null?Math.ceil((this.month()+1)/3):this.month((n-1)*3+this.month()%3)}function tp(n){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return n==null?t:this.add(n-t,"d")}function ip(n,t){t[ri]=s(("0."+n)*1e3)}function rp(){return this._isUTC?"UTC":""}function up(){return this._isUTC?"Coordinated Universal Time":""}function fp(n){return v(n*1e3)}function ep(){return v.apply(null,arguments).parseZone()}function ks(n){return n}function nu(n,t,i,r){var u=dt(),f=ht().set(r,t);return u[i](f,n)}function ds(n,t,i){if(ti(n)&&(t=n,n=undefined),n=n||"",t!=null)return nu(n,t,i,"month");for(var u=[],r=0;r<12;r++)u[r]=nu(n,r,i,"month");return u}function vf(n,t,i,r){var o,f,u,e;if(typeof n=="boolean"?(ti(t)&&(i=t,t=undefined),t=t||""):(t=n,i=t,n=!1,ti(t)&&(i=t,t=undefined),t=t||""),o=dt(),f=n?o._week.dow:0,i!=null)return nu(t,(i+f)%7,r,"day");for(e=[],u=0;u<7;u++)e[u]=nu(t,(u+f)%7,r,"day");return e}function op(n,t){return ds(n,t,"months")}function sp(n,t){return ds(n,t,"monthsShort")}function hp(n,t,i){return vf(n,t,i,"weekdays")}function cp(n,t,i){return vf(n,t,i,"weekdaysShort")}function lp(n,t,i){return vf(n,t,i,"weekdaysMin")}function ap(){var n=this._data;return this._milliseconds=at(this._milliseconds),this._days=at(this._days),this._months=at(this._months),n.milliseconds=at(n.milliseconds),n.seconds=at(n.seconds),n.minutes=at(n.minutes),n.hours=at(n.hours),n.months=at(n.months),n.years=at(n.years),this}function gs(n,t,i,r){var u=ot(t,i);return n._milliseconds+=r*u._milliseconds,n._days+=r*u._days,n._months+=r*u._months,n._bubble()}function vp(n,t){return gs(this,n,t,1)}function yp(n,t){return gs(this,n,t,-1)}function nh(n){return n<0?Math.floor(n):Math.ceil(n)}function pp(){var r=this._milliseconds,n=this._days,t=this._months,i=this._data,u,f,e,s,o;return r>=0&&n>=0&&t>=0||r<=0&&n<=0&&t<=0||(r+=nh(yf(t)+n)*864e5,n=0,t=0),i.milliseconds=r%1e3,u=tt(r/1e3),i.seconds=u%60,f=tt(u/60),i.minutes=f%60,e=tt(f/60),i.hours=e%24,n+=tt(e/24),o=tt(th(n)),t+=o,n-=nh(yf(o)),s=tt(t/12),t%=12,i.days=n,i.months=t,i.years=s,this}function th(n){return n*4800/146097}function yf(n){return n*146097/4800}function wp(n){if(!this.isValid())return NaN;var t,r,i=this._milliseconds;if(n=rt(n),n==="month"||n==="year")return t=this._days+i/864e5,r=this._months+th(t),n==="month"?r:r/12;t=this._days+Math.round(yf(this._months));switch(n){case"week":return t/7+i/6048e5;case"day":return t+i/864e5;case"hour":return t*24+i/36e5;case"minute":return t*1440+i/6e4;case"second":return t*86400+i/1e3;case"millisecond":return Math.floor(t*864e5)+i;default:throw new Error("Unknown unit "+n);}}function bp(){return this.isValid()?this._milliseconds+this._days*864e5+this._months%12*2592e6+s(this._months/12)*31536e6:NaN}function ni(n){return function(){return this.as(n)}}function fw(){return ot(this)}function ew(n){return n=rt(n),this.isValid()?this[n+"s"]():NaN}function ei(n){return function(){return this.isValid()?this._data[n]:NaN}}function yw(){return tt(this.days()/7)}function pw(n,t,i,r,u){return u.relativeTime(t||1,!!i,n,r)}function ww(n,t,i){var r=ot(n).abs(),u=wt(r.as("s")),e=wt(r.as("m")),o=wt(r.as("h")),s=wt(r.as("d")),h=wt(r.as("M")),c=wt(r.as("y")),f=u<=st.ss&&["s",u]||u<st.s&&["ss",u]||e<=1&&["m"]||e<st.m&&["mm",e]||o<=1&&["h"]||o<st.h&&["hh",o]||s<=1&&["d"]||s<st.d&&["dd",s]||h<=1&&["M"]||h<st.M&&["MM",h]||c<=1&&["y"]||["yy",c];return f[2]=t,f[3]=+n>0,f[4]=i,pw.apply(null,f)}function bw(n){return n===undefined?wt:typeof n=="function"?(wt=n,!0):!1}function kw(n,t){return st[n]===undefined?!1:t===undefined?st[n]:(st[n]=t,n==="s"&&(st.ss=t-1),!0)}function dw(n){if(!this.isValid())return this.localeData().invalidDate();var t=this.localeData(),i=ww(this,!n,t);return n&&(i=t.pastFuture(+this,i)),t.postformat(i)}function vi(n){return(n>0)-(n<0)||+n}function iu(){if(!this.isValid())return this.localeData().invalidDate();var t=tu(this._milliseconds)/1e3,y=tu(this._days),r=tu(this._months),i,s,h;i=tt(t/60);s=tt(i/60);t%=60;i%=60;h=tt(r/12);r%=12;var c=h,l=r,a=y,u=s,f=i,e=t?t.toFixed(3).replace(/\.?0+$/,""):"",n=this.asSeconds();if(!n)return"P0D";var p=n<0?"-":"",v=vi(this._months)!==vi(n)?"-":"",w=vi(this._days)!==vi(n)?"-":"",o=vi(this._milliseconds)!==vi(n)?"-":"";return p+"P"+(c?v+c+"Y":"")+(l?v+l+"M":"")+(a?w+a+"D":"")+(u||f||e?"T":"")+(u?o+u+"H":"")+(f?o+f+"M":"")+(e?o+e+"S":"")}var pf,bf,rr,ur,fu,te,ie,re,ue,fe,ee,oe,oi,su,ar,vu,p,yu,pe,pu,ke,de,to,io,wu,ro,uo,fo,eo,ho,vo,yo,ko,go,ts,ai,rs,fs,es,cs,ls,lf,af,ps,ws,gt,bs,r,c,at,wt,st,tu,h;bf=Array.prototype.some?Array.prototype.some:function(n){for(var i=Object(this),r=i.length>>>0,t=0;t<r;t++)if(t in i&&n.call(this,i[t],t,i))return!0;return!1};rr=u.momentProperties=[];ur=!1;fu={};u.suppressDeprecationWarnings=!1;u.deprecationHandler=null;te=Object.keys?Object.keys:function(n){var t,i=[];for(t in n)y(n,t)&&i.push(t);return i};ie={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};re={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};ue="Invalid date";fe="%d";ee=/\d{1,2}/;oe={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};oi={};su={};var se=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,fr=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,hu={},si={};var ce=/\d/,nt=/\d\d/,le=/\d{3}/,cu=/\d{4}/,or=/[+-]?\d{6}/,l=/\d\d?/,ae=/\d\d\d\d?/,ve=/\d\d\d\d\d\d?/,sr=/\d{1,3}/,lu=/\d{1,4}/,hr=/[+-]?\d{1,6}/,cr=/[+-]?\d+/,ph=/Z|[+-]\d\d:?\d\d/gi,lr=/Z|[+-]\d\d(?::?\d\d)?/gi,wi=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,au={};ar={};var ft=0,yt=1,lt=2,w=3,et=4,pt=5,ri=6,dh=7,gh=8;e("Y",0,0,function(){var n=this.year();return n<=9999?""+n:"+"+n});e(0,["YY",2],0,function(){return this.year()%100});e(0,["YYYY",4],0,"year");e(0,["YYYYY",5],0,"year");e(0,["YYYYYY",6,!0],0,"year");d("year","y");g("year",1);f("Y",cr);f("YY",l,nt);f("YYYY",lu,cu);f("YYYYY",hr,or);f("YYYYYY",hr,or);a(["YYYYY","YYYYYY"],ft);a("YYYY",function(n,t){t[ft]=n.length===2?u.parseTwoDigitYear(n):s(n)});a("YY",function(n,t){t[ft]=u.parseTwoDigitYear(n)});a("Y",function(n,t){t[ft]=parseInt(n,10)});u.parseTwoDigitYear=function(n){return s(n)+(s(n)>68?1900:2e3)};vu=hi("FullYear",!0);p=Array.prototype.indexOf?Array.prototype.indexOf:function(n){for(var t=0;t<this.length;++t)if(this[t]===n)return t;return-1};e("M",["MM",2],"Mo",function(){return this.month()+1});e("MMM",0,0,function(n){return this.localeData().monthsShort(this,n)});e("MMMM",0,0,function(n){return this.localeData().months(this,n)});d("month","M");g("month",8);f("M",l);f("MM",l,nt);f("MMM",function(n,t){return t.monthsShortRegex(n)});f("MMMM",function(n,t){return t.monthsRegex(n)});a(["M","MM"],function(n,t){t[yt]=s(n)-1});a(["MMM","MMMM"],function(n,t,i,r){var u=i._locale.monthsParse(n,r,i._strict);u!=null?t[yt]=u:o(i).invalidMonth=n});yu=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/;pe="January_February_March_April_May_June_July_August_September_October_November_December".split("_");pu="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_");ke=wi;de=wi;e("w",["ww",2],"wo","week");e("W",["WW",2],"Wo","isoWeek");d("week","w");d("isoWeek","W");g("week",5);g("isoWeek",5);f("w",l);f("ww",l,nt);f("W",l);f("WW",l,nt);bi(["w","ww","W","WW"],function(n,t,i,r){t[r.substr(0,1)]=s(n)});to={dow:0,doy:6};e("d",0,"do","day");e("dd",0,0,function(n){return this.localeData().weekdaysMin(this,n)});e("ddd",0,0,function(n){return this.localeData().weekdaysShort(this,n)});e("dddd",0,0,function(n){return this.localeData().weekdays(this,n)});e("e",0,0,"weekday");e("E",0,0,"isoWeekday");d("day","d");d("weekday","e");d("isoWeekday","E");g("day",11);g("weekday",11);g("isoWeekday",11);f("d",l);f("e",l);f("E",l);f("dd",function(n,t){return t.weekdaysMinRegex(n)});f("ddd",function(n,t){return t.weekdaysShortRegex(n)});f("dddd",function(n,t){return t.weekdaysRegex(n)});bi(["dd","ddd","dddd"],function(n,t,i,r){var u=i._locale.weekdaysParse(n,r,i._strict);u!=null?t.d=u:o(i).invalidWeekday=n});bi(["d","e","E"],function(n,t,i,r){t[r]=s(n)});io="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_");wu="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_");ro="Su_Mo_Tu_We_Th_Fr_Sa".split("_");uo=wi;fo=wi;eo=wi;e("H",["HH",2],0,"hour");e("h",["hh",2],0,ku);e("k",["kk",2],0,hl);e("hmm",0,0,function(){return""+ku.apply(this)+vt(this.minutes(),2)});e("hmmss",0,0,function(){return""+ku.apply(this)+vt(this.minutes(),2)+vt(this.seconds(),2)});e("Hmm",0,0,function(){return""+this.hours()+vt(this.minutes(),2)});e("Hmmss",0,0,function(){return""+this.hours()+vt(this.minutes(),2)+vt(this.seconds(),2)});oo("a",!0);oo("A",!1);d("hour","h");g("hour",13);f("a",so);f("A",so);f("H",l);f("h",l);f("k",l);f("HH",l,nt);f("hh",l,nt);f("kk",l,nt);f("hmm",ae);f("hmmss",ve);f("Hmm",ae);f("Hmmss",ve);a(["H","HH"],w);a(["k","kk"],function(n,t){var i=s(n);t[w]=i===24?0:i});a(["a","A"],function(n,t,i){i._isPm=i._locale.isPM(n);i._meridiem=n});a(["h","hh"],function(n,t,i){t[w]=s(n);o(i).bigHour=!0});a("hmm",function(n,t,i){var r=n.length-2;t[w]=s(n.substr(0,r));t[et]=s(n.substr(r));o(i).bigHour=!0});a("hmmss",function(n,t,i){var r=n.length-4,u=n.length-2;t[w]=s(n.substr(0,r));t[et]=s(n.substr(r,2));t[pt]=s(n.substr(u));o(i).bigHour=!0});a("Hmm",function(n,t){var i=n.length-2;t[w]=s(n.substr(0,i));t[et]=s(n.substr(i))});a("Hmmss",function(n,t){var i=n.length-4,r=n.length-2;t[w]=s(n.substr(0,i));t[et]=s(n.substr(i,2));t[pt]=s(n.substr(r))});ho=/[ap]\.?m?\.?/i;var al=hi("Hours",!0),co={calendar:ie,longDateFormat:re,invalidDate:ue,ordinal:fe,dayOfMonthOrdinalParse:ee,relativeTime:oe,months:pe,monthsShort:pu,week:to,weekdays:io,weekdaysMin:ro,weekdaysShort:wu,meridiemParse:ho},b={},nr={},br;var kl=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,dl=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,gl=/Z|[+-]\d\d(?::?\d\d)?/,kr=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/]],rf=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],na=/^\/?Date\((\-?\d+)/i;for(vo=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,yo={UT:0,GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480},u.createFromInputFallback=it("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged and will be removed in an upcoming major release. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(n){n._d=new Date(n._i+(n._useUTC?" UTC":""))}),u.ISO_8601=function(){},u.RFC_2822=function(){},ko=it("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var n=v.apply(null,arguments);return this.isValid()&&n.isValid()?n<this?this:n:ir()}),go=it("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var n=v.apply(null,arguments);return this.isValid()&&n.isValid()?n>this?this:n:ir()}),ts=function(){return Date.now?Date.now():+new Date},ai=["year","quarter","month","week","day","hour","minute","second","millisecond"],is("Z",":"),is("ZZ",""),f("Z",lr),f("ZZ",lr),a(["Z","ZZ"],function(n,t,i){i._useUTC=!0;i._tzm=of(lr,n)}),rs=/([\+\-]|\d\d)/gi,u.updateOffset=function(){},fs=/^(\-|\+)?(?:(\d*)[. ])?(\d+)\:(\d+)(?:\:(\d+)(\.\d*)?)?$/,es=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/,ot.fn=dr.prototype,ot.invalid=wa,cs=ss(1,"add"),ls=ss(-1,"subtract"),u.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",u.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]",lf=it("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(n){return n===undefined?this.localeData():this.locale(n)}),e(0,["gg",2],0,function(){return this.weekYear()%100}),e(0,["GG",2],0,function(){return this.isoWeekYear()%100}),gr("gggg","weekYear"),gr("ggggg","weekYear"),gr("GGGG","isoWeekYear"),gr("GGGGG","isoWeekYear"),d("weekYear","gg"),d("isoWeekYear","GG"),g("weekYear",1),g("isoWeekYear",1),f("G",cr),f("g",cr),f("GG",l,nt),f("gg",l,nt),f("GGGG",lu,cu),f("gggg",lu,cu),f("GGGGG",hr,or),f("ggggg",hr,or),bi(["gggg","ggggg","GGGG","GGGGG"],function(n,t,i,r){t[r.substr(0,2)]=s(n)}),bi(["gg","GG"],function(n,t,i,r){t[r]=u.parseTwoDigitYear(n)}),e("Q",0,"Qo","quarter"),d("quarter","Q"),g("quarter",7),f("Q",ce),a("Q",function(n,t){t[yt]=(s(n)-1)*3}),e("D",["DD",2],"Do","date"),d("date","D"),g("date",9),f("D",l),f("DD",l,nt),f("Do",function(n,t){return n?t._dayOfMonthOrdinalParse||t._ordinalParse:t._dayOfMonthOrdinalParseLenient}),a(["D","DD"],lt),a("Do",function(n,t){t[lt]=s(n.match(l)[0])}),af=hi("Date",!0),e("DDD",["DDDD",3],"DDDo","dayOfYear"),d("dayOfYear","DDD"),g("dayOfYear",4),f("DDD",sr),f("DDDD",le),a(["DDD","DDDD"],function(n,t,i){i._dayOfYear=s(n)}),e("m",["mm",2],0,"minute"),d("minute","m"),g("minute",14),f("m",l),f("mm",l,nt),a(["m","mm"],et),ps=hi("Minutes",!1),e("s",["ss",2],0,"second"),d("second","s"),g("second",15),f("s",l),f("ss",l,nt),a(["s","ss"],pt),ws=hi("Seconds",!1),e("S",0,0,function(){return~~(this.millisecond()/100)}),e(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),e(0,["SSS",3],0,"millisecond"),e(0,["SSSS",4],0,function(){return this.millisecond()*10}),e(0,["SSSSS",5],0,function(){return this.millisecond()*100}),e(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3}),e(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4}),e(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5}),e(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6}),d("millisecond","ms"),g("millisecond",16),f("S",sr,ce),f("SS",sr,nt),f("SSS",sr,le),gt="SSSS";gt.length<=9;gt+="S")f(gt,/\d+/);for(gt="S";gt.length<=9;gt+="S")a(gt,ip);bs=hi("Milliseconds",!1);e("z",0,0,"zoneAbbr");e("zz",0,0,"zoneName");r=pi.prototype;r.add=cs;r.calendar=sv;r.clone=hv;r.diff=wv;r.endOf=fy;r.format=gv;r.from=ny;r.fromNow=ty;r.to=iy;r.toNow=ry;r.get=tc;r.invalidAt=yy;r.isAfter=cv;r.isBefore=lv;r.isBetween=av;r.isSame=vv;r.isSameOrAfter=yv;r.isSameOrBefore=pv;r.isValid=ay;r.lang=lf;r.locale=as;r.localeData=vs;r.max=go;r.min=ko;r.parsingFlags=vy;r.set=ic;r.startOf=uy;r.subtract=ls;r.toArray=hy;r.toObject=cy;r.toDate=sy;r.toISOString=kv;r.inspect=dv;r.toJSON=ly;r.toString=bv;r.unix=oy;r.valueOf=ey;r.creationData=py;r.year=vu;r.isLeapYear=nc;r.weekYear=wy;r.isoWeekYear=by;r.quarter=r.quarters=np;r.month=be;r.daysInMonth=sc;r.week=r.weeks=pc;r.isoWeek=r.isoWeeks=wc;r.weeksInYear=dy;r.isoWeeksInYear=ky;r.date=af;r.day=r.days=rl;r.weekday=ul;r.isoWeekday=fl;r.dayOfYear=tp;r.hour=r.hours=al;r.minute=r.minutes=ps;r.second=r.seconds=ws;r.millisecond=r.milliseconds=bs;r.utcOffset=ba;r.utc=da;r.local=ga;r.parseZone=nv;r.hasAlignedHourOffset=tv;r.isDST=iv;r.isLocal=uv;r.isUtcOffset=fv;r.isUtc=us;r.isUTC=us;r.zoneAbbr=rp;r.zoneName=up;r.dates=it("dates accessor is deprecated. Use date instead.",af);r.months=it("months accessor is deprecated. Use month instead",be);r.years=it("years accessor is deprecated. Use year instead",vu);r.zone=it("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",ka);r.isDSTShifted=it("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",rv);c=eu.prototype;c.calendar=eh;c.longDateFormat=oh;c.invalidDate=sh;c.ordinal=hh;c.preparse=ks;c.postformat=ks;c.relativeTime=ch;c.pastFuture=lh;c.set=fh;c.months=uc;c.monthsShort=fc;c.monthsParse=oc;c.monthsRegex=cc;c.monthsShortRegex=hc;c.week=ac;c.firstDayOfYear=yc;c.firstDayOfWeek=vc;c.weekdays=dc;c.weekdaysMin=nl;c.weekdaysShort=gc;c.weekdaysParse=il;c.weekdaysRegex=el;c.weekdaysShortRegex=ol;c.weekdaysMinRegex=sl;c.isPM=cl;c.meridiem=ll;ci("en",{dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(n){var t=n%10,i=s(n%100/10)===1?"th":t===1?"st":t===2?"nd":t===3?"rd":"th";return n+i}});u.lang=it("moment.lang is deprecated. Use moment.locale instead.",ci);u.langData=it("moment.langData is deprecated. Use moment.localeData instead.",dt);at=Math.abs;var kp=ni("ms"),dp=ni("s"),gp=ni("m"),nw=ni("h"),tw=ni("d"),iw=ni("w"),rw=ni("M"),uw=ni("y");var ow=ei("milliseconds"),sw=ei("seconds"),hw=ei("minutes"),cw=ei("hours"),lw=ei("days"),aw=ei("months"),vw=ei("years");return wt=Math.round,st={ss:44,s:45,m:45,h:22,d:26,M:11},tu=Math.abs,h=dr.prototype,h.isValid=pa,h.abs=ap,h.add=vp,h.subtract=yp,h.as=wp,h.asMilliseconds=kp,h.asSeconds=dp,h.asMinutes=gp,h.asHours=nw,h.asDays=tw,h.asWeeks=iw,h.asMonths=rw,h.asYears=uw,h.valueOf=bp,h._bubble=pp,h.clone=fw,h.get=ew,h.milliseconds=ow,h.seconds=sw,h.minutes=hw,h.hours=cw,h.days=lw,h.weeks=yw,h.months=aw,h.years=vw,h.humanize=dw,h.toISOString=iu,h.toString=iu,h.toJSON=iu,h.locale=as,h.localeData=vs,h.toIsoString=it("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",iu),h.lang=lf,e("X",0,0,"unix"),e("x",0,0,"valueOf"),f("x",cr),f("X",/[+-]?\d+(\.\d{1,3})?/),a("X",function(n,t,i){i._d=new Date(parseFloat(n,10)*1e3)}),a("x",function(n,t,i){i._d=new Date(s(n))}),u.version="2.20.1",ih(v),u.fn=r,u.min=aa,u.max=va,u.now=ts,u.utc=ht,u.unix=fp,u.months=op,u.isDate=tr,u.locale=ci,u.invalid=ir,u.duration=ot,u.isMoment=kt,u.weekdays=hp,u.parseZone=ep,u.localeData=dt,u.isDuration=ff,u.monthsShort=sp,u.weekdaysMin=lp,u.defineLocale=gu,u.updateLocale=yl,u.locales=pl,u.weekdaysShort=cp,u.normalizeUnits=rt,u.relativeTimeRounding=bw,u.relativeTimeThreshold=kw,u.calendarFormat=ov,u.prototype=r,u.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"YYYY-[W]WW",MONTH:"YYYY-MM"},u});window.moment=i(23)}).call(t,i(194)(n))},function(n,t,i){"use strict";function c(n){return r.arrayMap(n,function(n){return{start:n.getTopLeftCorner(),end:n.getBottomRightCorner()}})}function l(n){return u.hasClass(n,"htSeparator")}function a(n){return u.hasClass(n,"htSubmenu")}function v(n){return u.hasClass(n,"htDisabled")}function y(n){return u.hasClass(n,"htSelectionDisabled")}function p(n){var t=n.getSelected();return t?t[0]<0?null:t:null}function f(n,t){return n.indexOf(t)!=-1?n:(n=n.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ",""),n+(" "+t))}function e(n,t){return n.indexOf(t)!=-1?n:(n=n.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ",""),n+(" "+t))}function w(n,t){var i={};return r.arrayEach(n,function(n){for(var u,f=n.from,e=n.to,r=f.row;r<=e.row;r++)for(u=f.col;u<=e.col;u++)i[r]||(i[r]=[]),i[r][u]=t(r,u)}),i}function b(n,t,i,u,f){r.arrayEach(n,function(n){var r=n.from,e=n.to,s,h;if(r.row==e.row&&r.col==e.col)o(r.row,r.col,t,i,u,f);else for(s=r.row;s<=e.row;s++)for(h=r.col;h<=e.col;h++)o(s,h,t,i,u,f)})}function o(n,t,i,r,u,o){var s=u(n,t),h=r;s.className&&(h=i==="vertical"?f(s.className,r):e(s.className,r));o(n,t,"className",h)}function k(n,t){var i=!1;return Array.isArray(n)&&r.arrayEach(n,function(n){return n.forAll(function(n,r){if(t(n,r))return i=!0,!1}),i}),i}function d(n){return'<span class="selected">'+String.fromCharCode(10003)+"<\/span>"+n}function g(n,t){return!n.hidden||!(typeof n.hidden=="function"&&n.hidden.call(t))}function s(n,t){for(var i=n.slice(0),r=0;r<i.length;)if(i[r].name===t)i.shift();else break;return i}function nt(n,t){var i=n.slice(0);return i.reverse(),i=s(i,t),i.reverse(),i}function tt(n){var t=[];return r.arrayEach(n,function(n,i){i>0?t[t.length-1].name!==n.name&&t.push(n):t.push(n)}),t}function it(n){var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:h.KEY,t=n.slice(0);return t=s(t,i),t=nt(t,i),tt(t)}t.__esModule=!0;t.normalizeSelection=c;t.isSeparator=l;t.hasSubMenu=a;t.isDisabled=v;t.isSelectionDisabled=y;t.getValidSelection=p;t.prepareVerticalAlignClass=f;t.prepareHorizontalAlignClass=e;t.getAlignmentClasses=w;t.align=b;t.checkSelectionConsistency=k;t.markLabelAsSelected=d;t.isItemHidden=g;t.filterSeparators=it;var r=i(0),rt=i(4),u=i(2),h=i(156)},function(n,t,i){n.exports=!i(26)(function(){return Object.defineProperty({},"a",{get:function(){return 7}}).a!=7})},function(n){n.exports=function(n){try{return!!n()}catch(t){return!0}}},function(n,t,i){var r=i(88),u=i(47);n.exports=function(n){return r(u(n))}},function(n,t,i){var r=i(68),u=Math.min;n.exports=function(n){return n>0?u(r(n),9007199254740991):0}},function(n,t,i){var r=i(5),u=i(50),f=i(26);n.exports=function(n,t){var i=(u.Object||{})[n]||Object[n],e={};e[n]=t(i);r(r.S+r.F*f(function(){i(1)}),"Object",e)}},function(n,t,i){"use strict";function e(n){return n&&n.__esModule?n:{"default":n}}function y(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var r,o;t.__esModule=!0;var f=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),u=i(2),s=i(1),h=i(0),c=i(9),l=e(c),a=i(193),v=e(a);r={};o=function(){function n(t){y(this,n);s.defineGetter(this,"wot",t,{writable:!1});this.instance=this.wot;this.type="";this.mainTableScrollableElement=null;this.TABLE=this.wot.wtTable.TABLE;this.hider=this.wot.wtTable.hider;this.spreader=this.wot.wtTable.spreader;this.holder=this.wot.wtTable.holder;this.wtRootElement=this.wot.wtTable.wtRootElement;this.trimmingContainer=u.getTrimmingContainer(this.hider.parentNode.parentNode);this.areElementSizesAdjusted=!1;this.updateStateOfRendering()}return f(n,null,[{key:"registerOverlay",value:function(t,i){if(n.CLONE_TYPES.indexOf(t)===-1)throw new Error("Unsupported overlay ("+t+").");r[t]=i}},{key:"createOverlay",value:function(n,t){return new r[n](t)}},{key:"hasOverlay",value:function(n){return r[n]!==void 0}},{key:"isOverlayTypeOf",value:function(n,t){return!n||!r[t]?!1:n instanceof r[t]}},{key:"CLONE_TOP",get:function(){return"top"}},{key:"CLONE_BOTTOM",get:function(){return"bottom"}},{key:"CLONE_LEFT",get:function(){return"left"}},{key:"CLONE_TOP_LEFT_CORNER",get:function(){return"top_left_corner"}},{key:"CLONE_BOTTOM_LEFT_CORNER",get:function(){return"bottom_left_corner"}},{key:"CLONE_DEBUG",get:function(){return"debug"}},{key:"CLONE_TYPES",get:function(){return[n.CLONE_TOP,n.CLONE_BOTTOM,n.CLONE_LEFT,n.CLONE_TOP_LEFT_CORNER,n.CLONE_BOTTOM_LEFT_CORNER,n.CLONE_DEBUG]}}]),f(n,[{key:"updateStateOfRendering",value:function(){var t=this.needFullRender,n;return this.needFullRender=this.shouldBeRendered(),n=t!==this.needFullRender,n&&!this.needFullRender&&this.reset(),n}},{key:"shouldBeRendered",value:function(){return!0}},{key:"updateTrimmingContainer",value:function(){this.trimmingContainer=u.getTrimmingContainer(this.hider.parentNode.parentNode)}},{key:"updateMainScrollableElement",value:function(){this.mainTableScrollableElement=u.getScrollableElement(this.wot.wtTable.TABLE)}},{key:"makeClone",value:function(t){var i,r,f;if(n.CLONE_TYPES.indexOf(t)===-1)throw new Error('Clone type "'+t+'" is not supported.');return i=document.createElement("DIV"),r=document.createElement("TABLE"),i.className="ht_clone_"+t+" handsontable",i.style.position="absolute",i.style.top=0,i.style.left=0,i.style.overflow="hidden",r.className=this.wot.wtTable.TABLE.className,i.appendChild(r),this.type=t,this.wot.wtTable.wtRootElement.parentNode.appendChild(i),f=this.wot.getSetting("preventOverflow"),this.mainTableScrollableElement=f===!0||f==="horizontal"&&this.type===n.CLONE_TOP||f==="vertical"&&this.type===n.CLONE_LEFT?window:u.getScrollableElement(this.wot.wtTable.TABLE),new v.default({cloneSource:this.wot,cloneOverlay:this,table:r})}},{key:"refresh",value:function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:!1,n=this.shouldBeRendered();this.clone&&(this.needFullRender||n)&&this.clone.draw(t);this.needFullRender=n}},{key:"reset",value:function(){if(this.clone){var n=this.clone.wtTable.holder,t=this.clone.wtTable.hider,i=n.style,r=t.style,u=n.parentNode.style;h.arrayEach([i,r,u],function(n){n.width="";n.height=""})}}},{key:"destroy",value:function(){new l.default(this.clone).destroy()}}]),n}();t.default=o},function(n,t,i){"use strict";function e(n){return n[0].toUpperCase()+n.substr(1)}function o(){for(var u,f,t=[],e=arguments.length,i=Array(e),n=0;n<e;n++)i[n]=arguments[n];for(u=i.length;u--;)f=r.stringify(i[u]).toLowerCase(),t.indexOf(f)===-1&&t.push(f);return t.length===1}function s(){function n(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return n()+n()+n()+n()}function h(n){return/^([0-9][0-9]?%$)|(^100%$)/.test(n)}function c(n){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};return(""+n).replace(/(?:\\)?\[([^[\]]+)]/g,function(n,i){return n.charAt(0)==="\\"?n.substr(1,n.length-1):t[i]===void 0?"":t[i]})}function l(n){return n+="",n.replace(u,"")}var r,f,u;t.__esModule=!0;t.toUpperCaseFirst=e;t.equalsIgnoreCase=o;t.randomString=s;t.isPercentValue=h;t.substitute=c;t.stripTags=l;r=i(13);f=i(4);u=/<\/?\w+\/?>|<\w+[\s|/][^>]*>/gi},function(n){var t={}.hasOwnProperty;n.exports=function(n,i){return t.call(n,i)}},function(n,t){"use strict";function e(){return i}function o(){return r}function s(){return u}function h(){return f}function c(n){return n||(n=navigator.userAgent),/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(n)}var i,r,u,f;t.__esModule=!0;t.isIE8=e;t.isIE9=o;t.isSafari=s;t.isChrome=h;t.isMobileBrowser=c;i=!document.createTextNode("test").textContent;r=!!document.documentMode;u=/Safari/.test(navigator.userAgent)&&/Apple Computer/.test(navigator.vendor);f=/Chrome/.test(navigator.userAgent)&&/Google/.test(navigator.vendor)},function(n,t,i){"use strict";function u(n){for(var f,i=arguments.length,u=Array(i>1?i-1:0),t=1;t<i;t++)u[t-1]=arguments[t];return f=r.arrayReduce(n,function(n,t,i){var r=t.replace(/(?:\r?\n\s+)/g,""),f=u[i]?u[i]:"";return n+r+f},""),f.trim()}t.__esModule=!0;t.toSingleLine=u;var r=i(0)},function(n,t,i){"use strict";function f(n){return typeof n=="function"}function r(n){function f(){var h=this,f=arguments,e=Date.now(),o=!1,s;return i.lastCallThrottled=!0,t||(t=e,o=!0),s=u-(e-t),o?(i.lastCallThrottled=!1,n.apply(this,f)):(r&&clearTimeout(r),r=setTimeout(function(){i.lastCallThrottled=!1;n.apply(h,f);t=0;r=void 0},s)),i}var u=arguments.length>1&&arguments[1]!==undefined?arguments[1]:200,t=0,i={lastCallThrottled:!0},r=null;return f}function e(n){function o(){t=i}function u(){return t?(t--,n.apply(this,arguments)):e.apply(this,arguments)}var f=arguments.length>1&&arguments[1]!==undefined?arguments[1]:200,i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:10,e=r(n,f),t=i;return u.clearHits=o,u}function o(n){function u(){var u=this,f=arguments;return t&&clearTimeout(t),t=setTimeout(function(){i=n.apply(u,f)},r),i}var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:200,t=null,i=void 0;return u}function s(){for(var r,f,i=arguments.length,t=Array(i),n=0;n<i;n++)t[n]=arguments[n];return r=t[0],f=t.slice(1),function(){return u.arrayReduce(f,function(n,t){return t(n)},r.apply(this,arguments))}}function h(n){for(var i=arguments.length,r=Array(i>1?i-1:0),t=1;t<i;t++)r[t-1]=arguments[t];return function(){for(var i=arguments.length,u=Array(i),t=0;t<i;t++)u[t]=arguments[t];return n.apply(this,r.concat(u))}}function c(n){function t(r){return function(){for(var f,s,e=arguments.length,o=Array(e),u=0;u<e;u++)o[u]=arguments[u];return f=r.concat(o),s=void 0,f.length>=i?n.apply(this,f):t(f)}}var i=n.length;return t([])}function l(n){function t(r){return function(){for(var f,s,e=arguments.length,o=Array(e),u=0;u<e;u++)o[u]=arguments[u];return f=r.concat(o.reverse()),s=void 0,f.length>=i?n.apply(this,f):t(f)}}var i=n.length;return t([])}t.__esModule=!0;t.isFunction=f;t.throttle=r;t.throttleAfterHits=e;t.debounce=o;t.pipe=s;t.partial=h;t.curry=c;t.curryRight=l;var u=i(0)},function(n,t,i){"use strict";function r(n){return n&&n.__esModule?n:{"default":n}}function g(n){if(typeof n=="function")return n;if(!e(n))throw Error('No registered validator found under "'+n+'" name');return b(n)}t.__esModule=!0;t.getRegisteredValidators=t.getRegisteredValidatorNames=t.hasValidator=t.getValidator=t.registerValidator=undefined;var o=i(48),s=r(o),h=i(524),c=r(h),l=i(525),a=r(l),v=i(526),y=r(v),p=i(527),w=r(p);var u=s.default("validators"),f=u.register,b=u.getItem,e=u.hasItem,k=u.getNames,d=u.getValues;f("autocomplete",c.default);f("date",a.default);f("numeric",y.default);f("time",w.default);t.registerValidator=f;t.getValidator=g;t.hasValidator=e;t.getRegisteredValidatorNames=k;t.getRegisteredValidators=d},function(n,t){"use strict";function r(n){return typeof n=="string"&&n.length>=2&&n.charAt(0)==="="}function i(n){return typeof n=="string"&&n.charAt(0)==="'"&&n.charAt(1)==="="}function u(n){return i(n)?n.substr(1):n}function f(n){var t=/(\\"|"(?:\\"|[^"])*"|(\+))|(\\'|'(?:\\'|[^'])*'|(\+))/g,r=n.match(t)||[],i=-1;return n.toUpperCase().replace(t,function(){return++i,r[i]})}function e(n,t){return function(i){return{row:n==="row"?t:i.row,column:n==="column"?t:i.column}}}t.__esModule=!0;t.isFormulaExpression=r;t.isFormulaExpressionEscaped=i;t.unescapeFormulaExpression=u;t.toUpperCaseFormula=f;t.cellCoordFactory=e},function(n,t,i){var s=i(17),r=i(39),o=i(32),u=i(55)("src"),f="toString",e=Function[f],h=(""+e).split(f);i(50).inspectSource=function(n){return e.call(n)};(n.exports=function(n,t,i,f){var e=typeof i=="function";(e&&(o(i,"name")||r(i,"name",t)),n[t]!==i)&&(e&&(o(i,u)||r(i,u,n[t]?""+n[t]:h.join(String(t)))),n===s?n[t]=i:f?n[t]?n[t]=i:r(n,t,i):(delete n[t],r(n,t,i)))})(Function.prototype,f,function(){return typeof this=="function"&&this[u]||e.call(this)})},function(n,t,i){var r=i(22),u=i(56);n.exports=i(25)?function(n,t,i){return r.f(n,t,u(1,i))}:function(n,t,i){return n[t]=i,n}},function(n,t,i){var r=i(71);n.exports=function(n,t,i){if(r(n),t===undefined)return n;switch(i){case 1:return function(i){return n.call(t,i)};case 2:return function(i,r){return n.call(t,i,r)};case 3:return function(i,r,u){return n.call(t,i,r,u)}}return function(){return n.apply(t,arguments)}}},function(n,t,i){var r=i(47);n.exports=function(n){return Object(r(n))}},function(n,t,i){var r=i(55)("meta"),o=i(12),f=i(32),s=i(22).f,h=0,u=Object.isExtensible||function(){return!0},c=!i(26)(function(){return u(Object.preventExtensions({}))}),e=function(n){s(n,r,{value:{i:"O"+ ++h,w:{}}})},l=function(n,t){if(!o(n))return typeof n=="symbol"?n:(typeof n=="string"?"S":"P")+n;if(!f(n,r)){if(!u(n))return"F";if(!t)return"E";e(n)}return n[r].i},a=function(n,t){if(!f(n,r)){if(!u(n))return!0;if(!t)return!1;e(n)}return n[r].w},v=function(n){return c&&y.NEED&&u(n)&&!f(n,r)&&e(n),n},y=n.exports={KEY:r,NEED:!1,fastKey:l,getWeak:a,onFreeze:v}},function(n,t){"use strict";function c(n){return u.call(window,n)}function l(n){e.call(window,n)}function a(){return"ontouchstart"in window}function v(){var n=document.createElement("div");return!!(n.createShadowRoot&&n.createShadowRoot.toString().match(/\[native code\]/))}function y(){var n=document.createElement("TABLE"),t,i;n.style.borderSpacing=0;n.style.borderWidth=0;n.style.padding=0;t=document.createElement("TBODY");n.appendChild(t);t.appendChild(document.createElement("TR"));t.firstChild.appendChild(document.createElement("TD"));t.firstChild.firstChild.innerHTML="<tr><td>t<br>t<\/td><\/tr>";i=document.createElement("CAPTION");i.innerHTML="c<br>c<br>c<br>c";i.style.padding=0;i.style.margin=0;n.insertBefore(i,t);document.body.appendChild(n);o=n.offsetHeight<2*n.lastChild.offsetHeight;document.body.removeChild(n)}function p(){return o===void 0&&y(),o}function w(n){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};return i?i:i=(typeof Intl=="undefined"?"undefined":s(Intl))==="object"?new Intl.Collator(n,t).compare:typeof String.prototype.localeCompare=="function"?function(n,t){return(""+n).localeCompare(t)}:function(n,t){return n===t?0:n>t?-1:1}}var s,r,o,i;t.__esModule=!0;s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n};t.requestAnimationFrame=c;t.cancelAnimationFrame=l;t.isTouchSupported=a;t.isWebComponentSupportedNatively=v;t.hasCaptionProblem=p;t.getComparisonFunction=w;var h=0,f=["ms","moz","webkit","o"],u=window.requestAnimationFrame,e=window.cancelAnimationFrame;for(r=0;r<f.length&&!u;++r)u=window[f[r]+"RequestAnimationFrame"],e=window[f[r]+"CancelAnimationFrame"]||window[f[r]+"CancelRequestAnimationFrame"];u||(u=function(n){var t=(new Date).getTime(),i=Math.max(0,16-(t-h)),r=window.setTimeout(function(){n(t+i)},i);return h=t+i,r});e||(e=function(n){clearTimeout(n)});i=void 0},function(n,t,i){"use strict";function u(n){return n&&n.__esModule?n:{"default":n}}function f(n,t,i){return t in n?Object.defineProperty(n,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[t]=i,n}function at(){var n={};return g.objectEach(k,function(t,i){n[i]=t()}),n}function vt(n,t){d.indexOf(n)===-1&&(k[n]=t)}var r,e,o,s,h,c,l,a,v,y,p,w,b,d,k;t.__esModule=!0;t.ITEMS=t.UNDO=t.SEPARATOR=t.ROW_BELOW=t.ROW_ABOVE=t.REMOVE_ROW=t.REMOVE_COLUMN=t.REDO=t.READ_ONLY=t.COLUMN_RIGHT=t.COLUMN_LEFT=t.CLEAR_COLUMN=t.ALIGNMENT=undefined;e=i(571);Object.defineProperty(t,"ALIGNMENT",{enumerable:!0,get:function(){return e.KEY}});o=i(572);Object.defineProperty(t,"CLEAR_COLUMN",{enumerable:!0,get:function(){return o.KEY}});s=i(573);Object.defineProperty(t,"COLUMN_LEFT",{enumerable:!0,get:function(){return s.KEY}});h=i(574);Object.defineProperty(t,"COLUMN_RIGHT",{enumerable:!0,get:function(){return h.KEY}});c=i(575);Object.defineProperty(t,"READ_ONLY",{enumerable:!0,get:function(){return c.KEY}});l=i(576);Object.defineProperty(t,"REDO",{enumerable:!0,get:function(){return l.KEY}});a=i(577);Object.defineProperty(t,"REMOVE_COLUMN",{enumerable:!0,get:function(){return a.KEY}});v=i(578);Object.defineProperty(t,"REMOVE_ROW",{enumerable:!0,get:function(){return v.KEY}});y=i(579);Object.defineProperty(t,"ROW_ABOVE",{enumerable:!0,get:function(){return y.KEY}});p=i(580);Object.defineProperty(t,"ROW_BELOW",{enumerable:!0,get:function(){return p.KEY}});w=i(156);Object.defineProperty(t,"SEPARATOR",{enumerable:!0,get:function(){return w.KEY}});b=i(581);Object.defineProperty(t,"UNDO",{enumerable:!0,get:function(){return b.KEY}});t.predefinedItems=at;t.addItem=vt;var g=i(1),nt=u(e),tt=u(o),it=u(s),rt=u(h),ut=u(c),ft=u(l),et=u(a),ot=u(v),st=u(y),ht=u(p),ct=u(w),lt=u(b);d=t.ITEMS=[y.KEY,p.KEY,s.KEY,h.KEY,o.KEY,v.KEY,a.KEY,b.KEY,l.KEY,c.KEY,e.KEY,w.KEY];k=(r={},f(r,w.KEY,ct.default),f(r,y.KEY,st.default),f(r,p.KEY,ht.default),f(r,s.KEY,it.default),f(r,h.KEY,rt.default),f(r,o.KEY,tt.default),f(r,v.KEY,ot.default),f(r,a.KEY,et.default),f(r,b.KEY,lt.default),f(r,l.KEY,ft.default),f(r,c.KEY,ut.default),f(r,e.KEY,nt.default),r)},function(n,t,i){"use strict";function s(n){return n&&n.__esModule?n:{"default":n}}function h(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function c(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function l(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}t.__esModule=!0;var r=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),u=i(66),f=i(0),e=i(472),o=s(e);var a=[1,2,3],v=function(n){function t(n,i){h(this,t);var r=c(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n,i));return r.precedents=[],r.value=null,r.error=null,r.state=t.STATE_UP_TO_DATE,r}return l(t,n),r(t,null,[{key:"STATE_OUT_OFF_DATE",get:function(){return 1}},{key:"STATE_COMPUTING",get:function(){return 2}},{key:"STATE_UP_TO_DATE",get:function(){return 3}}]),r(t,[{key:"setValue",value:function(n){this.value=n}},{key:"getValue",value:function(){return this.value}},{key:"setError",value:function(n){this.error=n}},{key:"getError",value:function(){return this.error}},{key:"hasError",value:function(){return this.error!==null}},{key:"setState",value:function(n){if(a.indexOf(n)===-1)throw Error("Unrecognized state: "+n);this.state=n}},{key:"isState",value:function(n){return this.state===n}},{key:"addPrecedent",value:function(n){if(this.isEqual(n))throw Error(u.ERROR_REF);this.hasPrecedent(n)||this.precedents.push(n)}},{key:"removePrecedent",value:function(n){if(this.isEqual(n))throw Error(u.ERROR_REF);this.precedents=f.arrayFilter(this.precedents,function(t){return!t.isEqual(n)})}},{key:"clearPrecedents",value:function(){this.precedents.length=0}},{key:"getPrecedents",value:function(){return this.precedents}},{key:"hasPrecedents",value:function(){return this.precedents.length>0}},{key:"hasPrecedent",value:function(n){return f.arrayFilter(this.precedents,function(t){return t.isEqual(n)}).length>0}}]),t}(o.default);t.default=v},function(n,t,i){var r=i(165),u=i(91);n.exports=Object.keys||function(n){return r(n,u)}},function(n){n.exports=function(n){if(n==undefined)throw TypeError("Can't call method on  "+n);return n}},function(n,t){"use strict";function r(n){if(Array.isArray(n)){for(var t=0,i=Array(n.length);t<n.length;t++)i[t]=n[t];return i}return Array.from(n)}function u(){function u(t,i){n.set(t,i)}function f(t){return n.get(t)}function e(t){return n.has(t)}function o(){return[].concat(r(n.keys()))}function s(){return[].concat(r(n.values()))}var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"common",n;return i.has(t)||i.set(t,new Map),n=i.get(t),{register:u,getItem:f,hasItem:e,getNames:o,getValues:s}}t.__esModule=!0;t.default=u;var i=t.collection=new Map},function(n){var t={}.toString;n.exports=function(n){return t.call(n).slice(8,-1)}},function(n){var t=n.exports={version:"2.5.3"};typeof __e=="number"&&(__e=t)},function(n,t,i){var r=i(12);n.exports=function(n,t){if(!r(n)||n._t!==t)throw TypeError("Incompatible receiver, "+t+" required!");return n}},function(n,t,i){var r=i(16)("unscopables"),u=Array.prototype;u[r]==undefined&&i(39)(u,r,{});n.exports=function(n){u[r][n]=!0}},function(n,t,i){"use strict";function c(n){return n&&n.__esModule?n:{"default":n}}function l(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function a(n,t){r.set(n,t)}function v(n){var t=void 0;if(!(n instanceof h.default)){if(!r.has(n))throw Error("Record translator was not registered for this object identity");n=r.get(n)}return u.has(n)?t=u.get(n):(t=new f(n),u.set(n,t)),t}var e,f,r,u;t.__esModule=!0;t.RecordTranslator=undefined;e=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}();t.registerIdentity=a;t.getTranslator=v;var s=i(152),h=c(s),o=i(1);f=function(){function n(t){l(this,n);this.hot=t}return e(n,[{key:"toVisualRow",value:function(n){return this.hot.runHooks("unmodifyRow",n)}},{key:"toVisualColumn",value:function(n){return this.hot.runHooks("unmodifyCol",n)}},{key:"toVisual",value:function(n,t){return o.isObject(n)?{row:this.toVisualRow(n.row),column:this.toVisualColumn(n.column)}:[this.toVisualRow(n),this.toVisualColumn(t)]}},{key:"toPhysicalRow",value:function(n){return this.hot.runHooks("modifyRow",n)}},{key:"toPhysicalColumn",value:function(n){return this.hot.runHooks("modifyCol",n)}},{key:"toPhysical",value:function(n,t){return o.isObject(n)?{row:this.toPhysicalRow(n.row),column:this.toPhysicalColumn(n.column)}:[this.toPhysicalRow(n),this.toPhysicalColumn(t)]}}]),n}();t.RecordTranslator=f;r=new WeakMap;u=new WeakMap},function(n,t,i){"use strict";function s(n){if(Array.isArray(n)){for(var t=0,i=Array(n.length);t<n.length;t++)i[t]=n[t];return i}return Array.from(n)}var e,u;t.__esModule=!0;var r=i(0),o=i(1),f=i(4);e="arrayMapper";u={_arrayMap:[],getValueByIndex:function(n){var i=this._arrayMap.length,t=null;return n<i&&(t=this._arrayMap[n]),t},getIndexByValue:function(n){var t=void 0;return(t=this._arrayMap.indexOf(n))===-1?null:t},insertItems:function(n){var i=this,u=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1,e=r.arrayMax(this._arrayMap)+1,t=[];return f.rangeEach(u-1,function(r){t.push(i._arrayMap.splice(n+r,0,e+r))}),t},removeItems:function(n){var u=this,f=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1,t=[],i;return Array.isArray(n)?(i=[].concat(this._arrayMap),n.sort(function(n,t){return t-n}),t=r.arrayReduce(n,function(n,t){return u._arrayMap.splice(t,1),n.concat(i.slice(t,t+1))},[])):t=this._arrayMap.splice(n,f),t},unshiftItems:function(n){function u(n){return r.arrayReduce(i,function(t,i){return n>i&&t++,t},0)}var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1,i=this.removeItems(n,t);this._arrayMap=r.arrayMap(this._arrayMap,function(n){var t=u(n);return t&&(n-=t),n})},shiftItems:function(n){var i=this,t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;this._arrayMap=r.arrayMap(this._arrayMap,function(i){return i>=n&&(i+=t),i});f.rangeEach(t-1,function(t){i._arrayMap.splice(n+t,0,n+t)})},swapIndexes:function(n,t){var i;(i=this._arrayMap).splice.apply(i,[t,0].concat(s(this._arrayMap.splice(n,1))))},clearMap:function(){this._arrayMap.length=0}};o.defineGetter(u,"MIXIN_NAME",e,{writable:!1,enumerable:!1});t.default=u},function(n){var t=0,i=Math.random();n.exports=function(n){return"Symbol(".concat(n===undefined?"":n,")_",(++t+i).toString(36))}},function(n){n.exports=function(n,t){return{enumerable:!(n&1),configurable:!(n&2),writable:!(n&4),value:t}}},function(n){n.exports={}},function(n,t,i){var u=i(22).f,f=i(32),r=i(16)("toStringTag");n.exports=function(n,t,i){n&&!f(n=i?n:n.prototype,r)&&u(n,r,{configurable:!0,value:t})}},function(n,t){t.f={}.propertyIsEnumerable},function(n,t,i){"use strict";function r(n){this.instance=n;this.state=u.VIRGIN;this._opened=!1;this._fullEditMode=!1;this._closeCallback=null;this.init()}t.__esModule=!0;t.EditorState=undefined;var f=i(8),e=i(13),u=t.EditorState={VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"};r.prototype._fireCallbacks=function(n){this._closeCallback&&(this._closeCallback(n),this._closeCallback=null)};r.prototype.init=function(){};r.prototype.getValue=function(){throw Error("Editor getValue() method unimplemented");};r.prototype.setValue=function(){throw Error("Editor setValue() method unimplemented");};r.prototype.open=function(){throw Error("Editor open() method unimplemented");};r.prototype.close=function(){throw Error("Editor close() method unimplemented");};r.prototype.prepare=function(n,t,i,r,f,e){this.TD=r;this.row=n;this.col=t;this.prop=i;this.originalValue=f;this.cellProperties=e;this.state=u.VIRGIN};r.prototype.extend=function(){function t(){n.apply(this,arguments)}function i(n,t){function i(){}return i.prototype=t.prototype,n.prototype=new i,n.prototype.constructor=n,n}var n=this.constructor;return i(t,n)};r.prototype.saveValue=function(n,t){var i=void 0,r=void 0;t?(i=this.instance.getSelectedLast(),i[0]>i[2]&&(r=i[0],i[0]=i[2],i[2]=r),i[1]>i[3]&&(r=i[1],i[1]=i[3],i[3]=r)):i=[this.row,this.col,null,null];this.instance.populateFromArray(i[0],i[1],n,i[2],i[3],"edit")};r.prototype.beginEditing=function(n,t){this.state===u.VIRGIN&&(this.instance.view.scrollViewport(new f.CellCoords(this.row,this.col)),this.instance.view.render(),this.state=u.EDITING,n=typeof n=="string"?n:this.originalValue,this.setValue(e.stringify(n)),this.open(t),this._opened=!0,this.focus(),this.instance.view.render(),this.instance.runHooks("afterBeginEditing",this.row,this.col))};r.prototype.finishEditing=function(n,t,i){var f=this,o,e,r;if(i&&(e=this._closeCallback,this._closeCallback=function(n){e&&e(n);i(n);f.instance.view.render()}),!this.isWaiting()){if(this.state==u.VIRGIN){this.instance._registerTimeout(setTimeout(function(){f._fireCallbacks(!0)},0));return}if(this.state==u.EDITING){if(n){this.cancelChanges();this.instance.view.render();return}r=this.getValue();o=this.instance.getSettings().trimWhitespace?[[typeof r=="string"?String.prototype.trim.call(r||""):r]]:[[r]];this.state=u.WAITING;this.saveValue(o,t);this.instance.getCellValidator(this.cellProperties)?this.instance.addHookOnce("postAfterValidate",function(n){f.state=u.FINISHED;f.discardEditor(n)}):(this.state=u.FINISHED,this.discardEditor(!0))}}};r.prototype.cancelChanges=function(){this.state=u.FINISHED;this.discardEditor()};r.prototype.discardEditor=function(n){this.state===u.FINISHED&&(n===!1&&this.cellProperties.allowInvalid!==!0?(this.instance.selectCell(this.row,this.col),this.focus(),this.state=u.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=u.VIRGIN,this._fireCallbacks(!0)))};r.prototype.enableFullEditMode=function(){this._fullEditMode=!0};r.prototype.isInFullEditMode=function(){return this._fullEditMode};r.prototype.isOpened=function(){return this._opened};r.prototype.isWaiting=function(){return this.state===u.WAITING};r.prototype.checkEditorSection=function(){var t=this.instance.countRows(),n="";return this.row<this.instance.getSettings().fixedRowsTop?n=this.col<this.instance.getSettings().fixedColumnsLeft?"top-left-corner":"top":this.instance.getSettings().fixedRowsBottom&&this.row>=t-this.instance.getSettings().fixedRowsBottom?n=this.col<this.instance.getSettings().fixedColumnsLeft?"bottom-left-corner":"bottom":this.col<this.instance.getSettings().fixedColumnsLeft&&(n="left"),n};t.default=r},function(n,t){"use strict";function u(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var i,r;t.__esModule=!0;i=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}();r=function(){function n(t,i){u(this,n);typeof t!="undefined"&&typeof i!="undefined"?(this.row=t,this.col=i):(this.row=null,this.col=null)}return i(n,[{key:"isValid",value:function(n){return this.row<0||this.col<0?!1:this.row>=n.getSetting("totalRows")||this.col>=n.getSetting("totalColumns")?!1:!0}},{key:"isEqual",value:function(n){return n===this?!0:this.row===n.row&&this.col===n.col}},{key:"isSouthEastOf",value:function(n){return this.row>=n.row&&this.col>=n.col}},{key:"isNorthWestOf",value:function(n){return this.row<=n.row&&this.col<=n.col}},{key:"isSouthWestOf",value:function(n){return this.row>=n.row&&this.col<=n.col}},{key:"isNorthEastOf",value:function(n){return this.row<=n.row&&this.col>=n.col}},{key:"toObject",value:function(){return{row:this.row,col:this.col}}}]),n}();t.default=r},function(n,t,i){"use strict";function o(n){return n&&n.__esModule?n:{"default":n}}var f,s;t.__esModule=!0;var r=i(2),c=i(505),l=o(c),h=i(60),a=o(h),v=i(9),y=o(v),u=i(18),e=i(11);f=a.default.prototype.extend();f.prototype.init=function(){var n=this;this.createElements();this.eventManager=new y.default(this);this.bindEvents();this.autoResize=l.default();this.instance.addHook("afterDestroy",function(){n.destroy()})};f.prototype.getValue=function(){return this.TEXTAREA.value};f.prototype.setValue=function(n){this.TEXTAREA.value=n};s=function(n){var h=this,t=h.getActiveEditor(),i,o;if(i=(n.ctrlKey||n.metaKey)&&!n.altKey,n.target===t.TEXTAREA&&!e.isImmediatePropagationStopped(n)){if(n.keyCode===17||n.keyCode===224||n.keyCode===91||n.keyCode===93){e.stopImmediatePropagation(n);return}switch(n.keyCode){case u.KEY_CODES.ARROW_RIGHT:t.isInFullEditMode()&&((t.isWaiting()||t.allowKeyEventPropagation)&&(t.isWaiting()||!t.allowKeyEventPropagation||t.allowKeyEventPropagation(n.keyCode))||e.stopImmediatePropagation(n));break;case u.KEY_CODES.ARROW_LEFT:t.isInFullEditMode()&&((t.isWaiting()||t.allowKeyEventPropagation)&&(t.isWaiting()||!t.allowKeyEventPropagation||t.allowKeyEventPropagation(n.keyCode))||e.stopImmediatePropagation(n));break;case u.KEY_CODES.ARROW_UP:case u.KEY_CODES.ARROW_DOWN:t.isInFullEditMode()&&((t.isWaiting()||t.allowKeyEventPropagation)&&(t.isWaiting()||!t.allowKeyEventPropagation||t.allowKeyEventPropagation(n.keyCode))||e.stopImmediatePropagation(n));break;case u.KEY_CODES.ENTER:if(o=this.selection.isMultiple(),i&&!o||n.altKey){if(t.isOpened()){var f=r.getCaretPosition(t.TEXTAREA),s=t.getValue(),c=s.slice(0,f)+"\n"+s.slice(f);t.setValue(c);r.setCaretPosition(t.TEXTAREA,f+1)}else t.beginEditing(t.originalValue+"\n");e.stopImmediatePropagation(n)}n.preventDefault();break;case u.KEY_CODES.A:case u.KEY_CODES.X:case u.KEY_CODES.C:case u.KEY_CODES.V:i&&e.stopImmediatePropagation(n);break;case u.KEY_CODES.BACKSPACE:case u.KEY_CODES.DELETE:case u.KEY_CODES.HOME:case u.KEY_CODES.END:e.stopImmediatePropagation(n)}[u.KEY_CODES.ARROW_UP,u.KEY_CODES.ARROW_RIGHT,u.KEY_CODES.ARROW_DOWN,u.KEY_CODES.ARROW_LEFT].indexOf(n.keyCode)===-1&&t.autoResize.resize(String.fromCharCode(n.keyCode))}};f.prototype.open=function(){this.refreshDimensions();this.instance.addHook("beforeKeyDown",s)};f.prototype.close=function(){this.textareaParentStyle.display="none";this.autoResize.unObserve();document.activeElement===this.TEXTAREA&&this.instance.listen();this.instance.removeHook("beforeKeyDown",s)};f.prototype.focus=function(){this.TEXTAREA.focus();r.setCaretPosition(this.TEXTAREA,this.TEXTAREA.value.length)};f.prototype.createElements=function(){this.TEXTAREA=document.createElement("TEXTAREA");r.addClass(this.TEXTAREA,"handsontableInput");this.textareaStyle=this.TEXTAREA.style;this.textareaStyle.width=0;this.textareaStyle.height=0;this.TEXTAREA_PARENT=document.createElement("DIV");r.addClass(this.TEXTAREA_PARENT,"handsontableInputHolder");this.textareaParentStyle=this.TEXTAREA_PARENT.style;this.textareaParentStyle.top=0;this.textareaParentStyle.left=0;this.textareaParentStyle.display="none";this.TEXTAREA_PARENT.appendChild(this.TEXTAREA);this.instance.rootElement.appendChild(this.TEXTAREA_PARENT);var n=this;this.instance._registerTimeout(setTimeout(function(){n.refreshDimensions()},0))};f.prototype.getEditedCell=function(){var t=this.checkEditorSection(),n;switch(t){case"top":n=this.instance.view.wt.wtOverlays.topOverlay.clone.wtTable.getCell({row:this.row,col:this.col});this.textareaParentStyle.zIndex=101;break;case"top-left-corner":n=this.instance.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.getCell({row:this.row,col:this.col});this.textareaParentStyle.zIndex=103;break;case"bottom-left-corner":n=this.instance.view.wt.wtOverlays.bottomLeftCornerOverlay.clone.wtTable.getCell({row:this.row,col:this.col});this.textareaParentStyle.zIndex=103;break;case"left":n=this.instance.view.wt.wtOverlays.leftOverlay.clone.wtTable.getCell({row:this.row,col:this.col});this.textareaParentStyle.zIndex=102;break;case"bottom":n=this.instance.view.wt.wtOverlays.bottomOverlay.clone.wtTable.getCell({row:this.row,col:this.col});this.textareaParentStyle.zIndex=102;break;default:n=this.instance.getCell(this.row,this.col);this.textareaParentStyle.zIndex=""}if(n!=-1&&n!=-2)return n};f.prototype.refreshValue=function(){var n=this.instance.getSourceDataAtCell(this.row,this.prop);this.originalValue=n;this.setValue(n);this.refreshDimensions()};f.prototype.refreshDimensions=function(){if(this.state===h.EditorState.EDITING){if(this.TD=this.getEditedCell(),!this.TD){this.close(!0);return}var i=r.offset(this.TD),u=r.offset(this.instance.rootElement),t=r.getScrollableElement(this.TD),y=this.instance.countRows(),p=i.top===u.top?0:1,f=i.top-u.top-p-(t.scrollTop||0),e=i.left-u.left-1-(t.scrollLeft||0),o=this.instance.getSettings(),ot=this.instance.hasRowHeaders(),w=this.instance.hasColHeaders(),b=this.checkEditorSection(),s=this.TD.style.backgroundColor,n;switch(b){case"top":n=r.getCssTransform(this.instance.view.wt.wtOverlays.topOverlay.clone.wtTable.holder.parentNode);break;case"left":n=r.getCssTransform(this.instance.view.wt.wtOverlays.leftOverlay.clone.wtTable.holder.parentNode);break;case"top-left-corner":n=r.getCssTransform(this.instance.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.holder.parentNode);break;case"bottom-left-corner":n=r.getCssTransform(this.instance.view.wt.wtOverlays.bottomLeftCornerOverlay.clone.wtTable.holder.parentNode);break;case"bottom":n=r.getCssTransform(this.instance.view.wt.wtOverlays.bottomOverlay.clone.wtTable.holder.parentNode)}(w&&this.instance.getSelectedLast()[0]===0||o.fixedRowsBottom&&this.instance.getSelectedLast()[0]===y-o.fixedRowsBottom)&&(f+=1);this.instance.getSelectedLast()[1]===0&&(e+=1);n&&n!=-1?this.textareaParentStyle[n[0]]=n[1]:r.resetCssTransform(this.TEXTAREA_PARENT);this.textareaParentStyle.top=f+"px";this.textareaParentStyle.left=e+"px";var k=this.instance.view.wt.wtViewport.rowsRenderCalculator.startPosition,d=this.instance.view.wt.wtViewport.columnsRenderCalculator.startPosition,g=this.instance.view.wt.wtOverlays.leftOverlay.getScrollPosition(),nt=this.instance.view.wt.wtOverlays.topOverlay.getScrollPosition(),c=r.getScrollbarWidth(),tt=this.TD.offsetTop+k-nt,it=this.TD.offsetLeft+d-g,rt=r.innerWidth(this.TD)-8,ut=r.hasVerticalScrollbar(t)?c:0,ft=r.hasHorizontalScrollbar(t)?c:0,l=this.instance.view.maximumVisibleElementWidth(it)-9-ut,et=this.TD.scrollHeight+1,a=Math.max(this.instance.view.maximumVisibleElementHeight(tt)-ft,23),v=r.getComputedStyle(this.TD);this.TEXTAREA.style.fontSize=v.fontSize;this.TEXTAREA.style.fontFamily=v.fontFamily;this.TEXTAREA.style.backgroundColor="";this.TEXTAREA.style.backgroundColor=s?s:r.getComputedStyle(this.TEXTAREA).backgroundColor;this.autoResize.init(this.TEXTAREA,{minHeight:Math.min(et,a),maxHeight:a,minWidth:Math.min(rt,l),maxWidth:l},!0);this.textareaParentStyle.display="block"}};f.prototype.bindEvents=function(){var n=this;this.eventManager.addEventListener(this.TEXTAREA,"cut",function(n){e.stopPropagation(n)});this.eventManager.addEventListener(this.TEXTAREA,"paste",function(n){e.stopPropagation(n)});this.instance.addHook("afterScrollHorizontally",function(){n.refreshDimensions()});this.instance.addHook("afterScrollVertically",function(){n.refreshDimensions()});this.instance.addHook("afterColumnResize",function(){n.refreshDimensions();n.focus()});this.instance.addHook("afterRowResize",function(){n.refreshDimensions();n.focus()});this.instance.addHook("afterDestroy",function(){n.eventManager.destroy()})};f.prototype.destroy=function(){this.eventManager.destroy()};t.default=f},function(n,t,i){"use strict";function c(n,t){return typeof n=="number"&&typeof t=="number"?n-t:h(n,t)}function f(n,t){return n===""&&(n="("+t+")"),n}function o(n){return r&&(n=new Set(n)),function(t){return r?n.has(t):!!~n.indexOf(t)}}function l(n){return n==null?"":n}function a(n){return n=e?Array.from(new Set(n)):u.arrayUnique(n),n.sort(function(n,t){return typeof n=="number"&&typeof t=="number"?n-t:n===t?0:n>t?1:-1})}function v(n,t,i,r){var e=[],s=n===t,h=void 0;return s||(h=o(t)),u.arrayEach(n,function(n){var u=!1,t;(s||h(n))&&(u=!0);t={checked:u,value:n,visualValue:f(n,i)};r&&r(t);e.push(t)}),e}var r,e;t.__esModule=!0;t.sortComparison=c;t.toVisualValue=f;t.createArrayAssertion=o;t.toEmptyString=l;t.unifyColumnValues=a;t.intersectValues=v;var s=i(43),u=i(0),h=s.getComparisonFunction();r=new Set([1]).has(1);e=r&&typeof Array.from=="function"},function(n,t){"use strict";function r(n){if(!i[n])throw Error('Operation with id "'+n+'" does not exist.');var t=i[n].func;return function(n,i){return t(n,i)}}function u(n){return i[n].name}function f(n,t,r){i[n]={name:t,func:r}}t.__esModule=!0;t.getOperationFunc=r;t.getOperationName=u;t.registerOperation=f;var i=t.operations={}},function(n,t,i){"use strict";function s(n){return n&&n.__esModule?n:{"default":n}}function w(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}t.__esModule=!0;var o=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),r=i(1),l=i(21),a=s(l),v=i(9),y=s(v),p=i(2),u=i(0);var f="built",e="building",h=["click","input","keydown","keypress","keyup","focus","blur","change"],c=function(){function n(t,i){w(this,n);this.hot=t;this.eventManager=new y.default(this);this.options=r.extend(n.DEFAULTS,i);this._element=document.createElement(this.options.wrapIt?"div":this.options.tagName);this.buildState=!1}return o(n,null,[{key:"DEFAULTS",get:function(){return r.clone({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}}]),o(n,[{key:"setValue",value:function(n){this.options.value=n;this.update()}},{key:"getValue",value:function(){return this.options.value}},{key:"isBuilt",value:function(){return this.buildState===f}},{key:"build",value:function(){var n=this,i=function(t,i){n.eventManager.addEventListener(t,i,function(t){return n.runLocalHooks(i,t,n)})},t;this.buildState||(this.buildState=e);this.options.className&&p.addClass(this._element,this.options.className);this.options.children.length?u.arrayEach(this.options.children,function(t){return n._element.appendChild(t.element)}):this.options.wrapIt?(t=document.createElement(this.options.tagName),r.objectEach(this.options,function(n,i){t[i]!==void 0&&i!=="className"&&i!=="tagName"&&i!=="children"&&(t[i]=n)}),this._element.appendChild(t),u.arrayEach(h,function(n){return i(t,n)})):u.arrayEach(h,function(t){return i(n._element,t)})}},{key:"update",value:function(){}},{key:"reset",value:function(){this.options.value="";this.update()}},{key:"show",value:function(){this.element.style.display=""}},{key:"hide",value:function(){this.element.style.display="none"}},{key:"focus",value:function(){}},{key:"destroy",value:function(){this.eventManager.destroy();this.eventManager=null;this.hot=null;this._element.parentNode&&this._element.parentNode.removeChild(this._element);this._element=null}},{key:"element",get:function(){return this.buildState===e?this._element:this.buildState===f?(this.update(),this._element):(this.buildState=e,this.build(),this.buildState=f,this._element)}}]),n}();r.mixin(c,a.default);t.default=c},function(n,t){(function(i,r){n.exports=r()})(typeof self!="undefined"?self:this,function(){return function(n){function t(r){if(i[r])return i[r].exports;var u=i[r]={i:r,l:!1,exports:{}};return n[r].call(u.exports,u,u.exports,t),u.l=!0,u.exports}var i={};return t.m=n,t.c=i,t.d=function(n,i,r){t.o(n,i)||Object.defineProperty(n,i,{configurable:!1,enumerable:!0,get:r})},t.n=function(n){var i=n&&n.__esModule?function(){return n["default"]}:function(){return n};return t.d(i,"a",i),i},t.o=function(n,t){return Object.prototype.hasOwnProperty.call(n,t)},t.p="",t(t.s=16)}([function(n,t){t.nil=new Error("#NULL!");t.div0=new Error("#DIV/0!");t.value=new Error("#VALUE!");t.ref=new Error("#REF!");t.name=new Error("#NAME?");t.num=new Error("#NUM!");t.na=new Error("#N/A");t.error=new Error("#ERROR!");t.data=new Error("#GETTING_DATA")},function(n,t,i){var r=i(0),u;t.flattenShallow=function(n){return!n||!n.reduce?n:n.reduce(function(n,t){var i=Array.isArray(n),r=Array.isArray(t);return i&&r?n.concat(t):i?(n.push(t),n):r?[n].concat(t):[n,t]})};t.isFlat=function(n){if(!n)return!1;for(var t=0;t<n.length;++t)if(Array.isArray(n[t]))return!1;return!0};t.flatten=function(){for(var n=t.argsToArray.apply(null,arguments);!t.isFlat(n);)n=t.flattenShallow(n);return n};t.argsToArray=function(n){var i=[];return t.arrayEach(n,function(n){i.push(n)}),i};t.numbers=function(){var n=this.flatten.apply(null,arguments);return n.filter(function(n){return typeof n=="number"})};t.cleanFloat=function(n){var t=1e14;return Math.round(n*t)/t};t.parseBool=function(n){if(typeof n=="boolean"||n instanceof Error)return n;if(typeof n=="number")return n!==0;if(typeof n=="string"){var t=n.toUpperCase();if(t==="TRUE")return!0;if(t==="FALSE")return!1}return n instanceof Date&&!isNaN(n)?!0:r.value};t.parseNumber=function(n){return n===undefined||n===""?r.value:isNaN(n)?r.value:parseFloat(n)};t.parseNumberArray=function(n){var i,u;if(!n||(i=n.length)===0)return r.value;while(i--){if(u=t.parseNumber(n[i]),u===r.value)return u;n[i]=u}return n};t.parseMatrix=function(n){var f,u,i;if(!n||(f=n.length)===0)return r.value;for(i=0;i<n.length;i++)if(u=t.parseNumberArray(n[i]),n[i]=u,u instanceof Error)return u;return n};u=new Date(1900,0,1);t.parseDate=function(n){if(!isNaN(n)){if(n instanceof Date)return new Date(n);var t=parseInt(n,10);return t<0?r.num:t<=60?new Date(u.getTime()+(t-1)*864e5):new Date(u.getTime()+(t-2)*864e5)}return typeof n=="string"&&(n=new Date(n),!isNaN(n))?n:r.value};t.parseDateArray=function(n){for(var i=n.length,t;i--;){if(t=this.parseDate(n[i]),t===r.value)return t;n[i]=t}return n};t.anyIsError=function(){for(var n=arguments.length;n--;)if(arguments[n]instanceof Error)return!0;return!1};t.arrayValuesToNumbers=function(n){for(var i=n.length,t,r;i--;)if(t=n[i],typeof t!="number"){if(t===!0){n[i]=1;continue}if(t===!1){n[i]=0;continue}typeof t=="string"&&(r=this.parseNumber(t),n[i]=r instanceof Error?0:r)}return n};t.rest=function(n,t){return(t=t||1,!n||typeof n.slice!="function")?n:n.slice(t)};t.initial=function(n,t){return(t=t||1,!n||typeof n.slice!="function")?n:n.slice(0,n.length-t)};t.arrayEach=function(n,t){for(var i=-1,r=n.length;++i<r;)if(t(n[i],i,n)===!1)break;return n};t.transpose=function(n){return n?n[0].map(function(t,i){return n.map(function(n){return n[i]})}):r.value}},function(n,t){"use strict";function a(n){var t=void 0;return n=(n+"").replace(/#|!|\?/g,""),r[n]&&(t=r[n]),t?t:null}function v(n){var t=!1;for(var i in r)if(Object.prototype.hasOwnProperty.call(r,i)&&r[i]===n){t=!0;break}return t}var i;t.__esModule=!0;t["default"]=a;t.isValidStrict=v;var u=t.ERROR="ERROR",f=t.ERROR_DIV_ZERO="DIV/0",e=t.ERROR_NAME="NAME",o=t.ERROR_NOT_AVAILABLE="N/A",s=t.ERROR_NULL="NULL",h=t.ERROR_NUM="NUM",c=t.ERROR_REF="REF",l=t.ERROR_VALUE="VALUE",r=(i={},i[u]="#ERROR!",i[f]="#DIV/0!",i[e]="#NAME?",i[o]="#N/A",i[s]="#NULL!",i[h]="#NUM!",i[c]="#REF!",i[l]="#VALUE!",i)},function(n,t){"use strict";function i(n){var t=void 0;return typeof n=="number"?t=n:typeof n=="string"&&(t=n.indexOf(".")>-1?parseFloat(n):parseInt(n,10)),t}function r(n){return-1*i(n)}t.__esModule=!0;t.toNumber=i;t.invertNumber=r},function(n,t,i){var utils=i(1),r=i(0),u=i(5),e=i(7),f;t.ABS=function(n){if(n=utils.parseNumber(n),n instanceof Error)return n;return Math.abs(n)};t.ACOS=function(n){if(n=utils.parseNumber(n),n instanceof Error)return n;var t=Math.acos(n);return isNaN(t)&&(t=r.num),t};t.ACOSH=function(n){if(n=utils.parseNumber(n),n instanceof Error)return n;var t=Math.log(n+Math.sqrt(n*n-1));return isNaN(t)&&(t=r.num),t};t.ACOT=function(n){if(n=utils.parseNumber(n),n instanceof Error)return n;return Math.atan(1/n)};t.ACOTH=function(n){if(n=utils.parseNumber(n),n instanceof Error)return n;var t=.5*Math.log((n+1)/(n-1));return isNaN(t)&&(t=r.num),t};t.AGGREGATE=function(n,i,f,e){if(n=utils.parseNumber(n),i=utils.parseNumber(n),utils.anyIsError(n,i))return r.value;switch(n){case 1:return u.AVERAGE(f);case 2:return u.COUNT(f);case 3:return u.COUNTA(f);case 4:return u.MAX(f);case 5:return u.MIN(f);case 6:return t.PRODUCT(f);case 7:return u.STDEV.S(f);case 8:return u.STDEV.P(f);case 9:return t.SUM(f);case 10:return u.VAR.S(f);case 11:return u.VAR.P(f);case 12:return u.MEDIAN(f);case 13:return u.MODE.SNGL(f);case 14:return u.LARGE(f,e);case 15:return u.SMALL(f,e);case 16:return u.PERCENTILE.INC(f,e);case 17:return u.QUARTILE.INC(f,e);case 18:return u.PERCENTILE.EXC(f,e);case 19:return u.QUARTILE.EXC(f,e)}};t.ARABIC=function(n){if(!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(n))return r.value;var t=0;return n.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,function(n){t+={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1}[n]}),t};t.ASIN=function(n){if(n=utils.parseNumber(n),n instanceof Error)return n;var t=Math.asin(n);return isNaN(t)&&(t=r.num),t};t.ASINH=function(n){return(n=utils.parseNumber(n),n instanceof Error)?n:Math.log(n+Math.sqrt(n*n+1))};t.ATAN=function(n){return(n=utils.parseNumber(n),n instanceof Error)?n:Math.atan(n)};t.ATAN2=function(n,t){return(n=utils.parseNumber(n),t=utils.parseNumber(t),utils.anyIsError(n,t))?r.value:Math.atan2(n,t)};t.ATANH=function(n){if(n=utils.parseNumber(n),n instanceof Error)return n;var t=Math.log((1+n)/(1-n))/2;return isNaN(t)&&(t=r.num),t};t.BASE=function(n,t,i){if(i=i||0,n=utils.parseNumber(n),t=utils.parseNumber(t),i=utils.parseNumber(i),utils.anyIsError(n,t,i))return r.value;i=i===undefined?0:i;var u=n.toString(t);return new Array(Math.max(i+1-u.length,0)).join("0")+u};t.CEILING=function(n,i,u){if(i=i===undefined?1:Math.abs(i),u=u||0,n=utils.parseNumber(n),i=utils.parseNumber(i),u=utils.parseNumber(u),utils.anyIsError(n,i,u))return r.value;if(i===0)return 0;var f=-Math.floor(Math.log(i)/Math.log(10));return n>=0?t.ROUND(Math.ceil(n/i)*i,f):u===0?-t.ROUND(Math.floor(Math.abs(n)/i)*i,f):-t.ROUND(Math.ceil(Math.abs(n)/i)*i,f)};t.CEILING.MATH=t.CEILING;t.CEILING.PRECISE=t.CEILING;t.COMBIN=function(n,i){return(n=utils.parseNumber(n),i=utils.parseNumber(i),utils.anyIsError(n,i))?r.value:t.FACT(n)/(t.FACT(i)*t.FACT(n-i))};t.COMBINA=function(n,i){return(n=utils.parseNumber(n),i=utils.parseNumber(i),utils.anyIsError(n,i))?r.value:n===0&&i===0?1:t.COMBIN(n+i-1,n-1)};t.COS=function(n){return(n=utils.parseNumber(n),n instanceof Error)?n:Math.cos(n)};t.COSH=function(n){return(n=utils.parseNumber(n),n instanceof Error)?n:(Math.exp(n)+Math.exp(-n))/2};t.COT=function(n){return(n=utils.parseNumber(n),n instanceof Error)?n:1/Math.tan(n)};t.COTH=function(n){if(n=utils.parseNumber(n),n instanceof Error)return n;var t=Math.exp(2*n);return(t+1)/(t-1)};t.CSC=function(n){return(n=utils.parseNumber(n),n instanceof Error)?n:1/Math.sin(n)};t.CSCH=function(n){return(n=utils.parseNumber(n),n instanceof Error)?n:2/(Math.exp(n)-Math.exp(-n))};t.DECIMAL=function(n,t){return arguments.length<1?r.value:parseInt(n,t)};t.DEGREES=function(n){return(n=utils.parseNumber(n),n instanceof Error)?n:n*180/Math.PI};t.EVEN=function(n){return(n=utils.parseNumber(n),n instanceof Error)?n:t.CEILING(n,-2,-1)};t.EXP=function(n){return arguments.length<1?r.na:typeof n!="number"||arguments.length>1?r.error:Math.exp(n)};f=[];t.FACT=function(n){if(n=utils.parseNumber(n),n instanceof Error)return n;var i=Math.floor(n);return i===0||i===1?1:f[i]>0?f[i]:(f[i]=t.FACT(i-1)*i,f[i])};t.FACTDOUBLE=function(n){if(n=utils.parseNumber(n),n instanceof Error)return n;var i=Math.floor(n);return i<=0?1:i*t.FACTDOUBLE(i-2)};t.FLOOR=function(n,i){if(n=utils.parseNumber(n),i=utils.parseNumber(i),utils.anyIsError(n,i))return r.value;if(i===0)return 0;if(!(n>0&&i>0)&&!(n<0&&i<0))return r.num;i=Math.abs(i);var u=-Math.floor(Math.log(i)/Math.log(10));return n>=0?t.ROUND(Math.floor(n/i)*i,u):-t.ROUND(Math.ceil(Math.abs(n)/i),u)};t.FLOOR.MATH=function(n,i,u){if(i=i===undefined?1:i,u=u===undefined?0:u,n=utils.parseNumber(n),i=utils.parseNumber(i),u=utils.parseNumber(u),utils.anyIsError(n,i,u))return r.value;if(i===0)return 0;i=i?Math.abs(i):1;var f=-Math.floor(Math.log(i)/Math.log(10));return n>=0?t.ROUND(Math.floor(n/i)*i,f):u===0||u===undefined?-t.ROUND(Math.ceil(Math.abs(n)/i)*i,f):-t.ROUND(Math.floor(Math.abs(n)/i)*i,f)};t.FLOOR.PRECISE=t.FLOOR.MATH;t.GCD=function(){var i=utils.parseNumberArray(utils.flatten(arguments)),r,u,t;if(i instanceof Error)return i;var e=i.length,f=i[0],n=f<0?-f:f;for(r=1;r<e;r++){for(u=i[r],t=u<0?-u:u;n&&t;)n>t?n%=t:t%=n;n+=t}return n};t.INT=function(n){return(n=utils.parseNumber(n),n instanceof Error)?n:Math.floor(n)};t.ISO={CEILING:t.CEILING};t.LCM=function(){var t=utils.parseNumberArray(utils.flatten(arguments)),n,u,i,r,f;if(t instanceof Error)return t;for(f=1;(i=t.pop())!==undefined;)while(i>1){if(i%2){for(n=3,u=Math.floor(Math.sqrt(i));n<=u&&i%n;n+=2);r=n<=u?n:i}else r=2;for(i/=r,f*=r,n=t.length;n;t[--n]%r==0&&(t[n]/=r)==1&&t.splice(n,1));}return f};t.LN=function(n){return(n=utils.parseNumber(n),n instanceof Error)?n:Math.log(n)};t.LN10=function(){return Math.log(10)};t.LN2=function(){return Math.log(2)};t.LOG10E=function(){return Math.LOG10E};t.LOG2E=function(){return Math.LOG2E};t.LOG=function(n,t){return(n=utils.parseNumber(n),t=utils.parseNumber(t),utils.anyIsError(n,t))?r.value:(t=t===undefined?10:t,Math.log(n)/Math.log(t))};t.LOG10=function(n){return(n=utils.parseNumber(n),n instanceof Error)?n:Math.log(n)/Math.log(10)};t.MOD=function(n,t){if(n=utils.parseNumber(n),t=utils.parseNumber(t),utils.anyIsError(n,t))return r.value;if(t===0)return r.div0;var i=Math.abs(n%t);return t>0?i:-i};t.MROUND=function(n,t){return(n=utils.parseNumber(n),t=utils.parseNumber(t),utils.anyIsError(n,t))?r.value:n*t<0?r.num:Math.round(n/t)*t};t.MULTINOMIAL=function(){var n=utils.parseNumberArray(utils.flatten(arguments)),r,u,i;if(n instanceof Error)return n;for(r=0,u=1,i=0;i<n.length;i++)r+=n[i],u*=t.FACT(n[i]);return t.FACT(r)/u};t.ODD=function(n){if(n=utils.parseNumber(n),n instanceof Error)return n;var t=Math.ceil(Math.abs(n));return t=t&1?t:t+1,n>0?t:-t};t.PI=function(){return Math.PI};t.E=function(){return Math.E};t.POWER=function(n,t){if(n=utils.parseNumber(n),t=utils.parseNumber(t),utils.anyIsError(n,t))return r.value;var i=Math.pow(n,t);return isNaN(i)?r.num:i};t.PRODUCT=function(){var n=utils.parseNumberArray(utils.flatten(arguments)),i,t;if(n instanceof Error)return n;for(i=1,t=0;t<n.length;t++)i*=n[t];return i};t.QUOTIENT=function(n,t){return(n=utils.parseNumber(n),t=utils.parseNumber(t),utils.anyIsError(n,t))?r.value:parseInt(n/t,10)};t.RADIANS=function(n){return(n=utils.parseNumber(n),n instanceof Error)?n:n*Math.PI/180};t.RAND=function(){return Math.random()};t.RANDBETWEEN=function(n,t){return(n=utils.parseNumber(n),t=utils.parseNumber(t),utils.anyIsError(n,t))?r.value:n+Math.ceil((t-n+1)*Math.random())-1};t.ROMAN=function(n){if(n=utils.parseNumber(n),n instanceof Error)return n;for(var i=String(n).split(""),u=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"],t="",r=3;r--;)t=(u[+i.pop()+r*10]||"")+t;return new Array(+i.join("")+1).join("M")+t};t.ROUND=function(n,t){return(n=utils.parseNumber(n),t=utils.parseNumber(t),utils.anyIsError(n,t))?r.value:Math.round(n*Math.pow(10,t))/Math.pow(10,t)};t.ROUNDDOWN=function(n,t){if(n=utils.parseNumber(n),t=utils.parseNumber(t),utils.anyIsError(n,t))return r.value;var i=n>0?1:-1;return i*Math.floor(Math.abs(n)*Math.pow(10,t))/Math.pow(10,t)};t.ROUNDUP=function(n,t){if(n=utils.parseNumber(n),t=utils.parseNumber(t),utils.anyIsError(n,t))return r.value;var i=n>0?1:-1;return i*Math.ceil(Math.abs(n)*Math.pow(10,t))/Math.pow(10,t)};t.SEC=function(n){return(n=utils.parseNumber(n),n instanceof Error)?n:1/Math.cos(n)};t.SECH=function(n){return(n=utils.parseNumber(n),n instanceof Error)?n:2/(Math.exp(n)+Math.exp(-n))};t.SERIESSUM=function(n,t,i,u){var e,f;if(n=utils.parseNumber(n),t=utils.parseNumber(t),i=utils.parseNumber(i),u=utils.parseNumberArray(u),utils.anyIsError(n,t,i,u))return r.value;for(e=u[0]*Math.pow(n,t),f=1;f<u.length;f++)e+=u[f]*Math.pow(n,t+f*i);return e};t.SIGN=function(n){return(n=utils.parseNumber(n),n instanceof Error)?n:n<0?-1:n===0?0:1};t.SIN=function(n){return(n=utils.parseNumber(n),n instanceof Error)?n:Math.sin(n)};t.SINH=function(n){return(n=utils.parseNumber(n),n instanceof Error)?n:(Math.exp(n)-Math.exp(-n))/2};t.SQRT=function(n){return(n=utils.parseNumber(n),n instanceof Error)?n:n<0?r.num:Math.sqrt(n)};t.SQRTPI=function(n){return(n=utils.parseNumber(n),n instanceof Error)?n:Math.sqrt(n*Math.PI)};t.SQRT1_2=function(){return 1/Math.sqrt(2)};t.SQRT2=function(){return Math.sqrt(2)};t.SUBTOTAL=function(n,i){if(n=utils.parseNumber(n),n instanceof Error)return n;switch(n){case 1:return u.AVERAGE(i);case 2:return u.COUNT(i);case 3:return u.COUNTA(i);case 4:return u.MAX(i);case 5:return u.MIN(i);case 6:return t.PRODUCT(i);case 7:return u.STDEV.S(i);case 8:return u.STDEV.P(i);case 9:return t.SUM(i);case 10:return u.VAR.S(i);case 11:return u.VAR.P(i);case 101:return u.AVERAGE(i);case 102:return u.COUNT(i);case 103:return u.COUNTA(i);case 104:return u.MAX(i);case 105:return u.MIN(i);case 106:return t.PRODUCT(i);case 107:return u.STDEV.S(i);case 108:return u.STDEV.P(i);case 109:return t.SUM(i);case 110:return u.VAR.S(i);case 111:return u.VAR.P(i)}};t.ADD=function(n,t){return arguments.length!==2?r.na:(n=utils.parseNumber(n),t=utils.parseNumber(t),utils.anyIsError(n,t))?r.value:n+t};t.MINUS=function(n,t){return arguments.length!==2?r.na:(n=utils.parseNumber(n),t=utils.parseNumber(t),utils.anyIsError(n,t))?r.value:n-t};t.DIVIDE=function(n,t){return arguments.length!==2?r.na:(n=utils.parseNumber(n),t=utils.parseNumber(t),utils.anyIsError(n,t))?r.value:t===0?r.div0:n/t};t.MULTIPLY=function(n,t){return arguments.length!==2?r.na:(n=utils.parseNumber(n),t=utils.parseNumber(t),utils.anyIsError(n,t))?r.value:n*t};t.GTE=function(n,t){return arguments.length!==2?r.na:(n=utils.parseNumber(n),t=utils.parseNumber(t),utils.anyIsError(n,t))?r.error:n>=t};t.LT=function(n,t){return arguments.length!==2?r.na:(n=utils.parseNumber(n),t=utils.parseNumber(t),utils.anyIsError(n,t))?r.error:n<t};t.LTE=function(n,t){return arguments.length!==2?r.na:(n=utils.parseNumber(n),t=utils.parseNumber(t),utils.anyIsError(n,t))?r.error:n<=t};t.EQ=function(n,t){return arguments.length!==2?r.na:n===t};t.NE=function(n,t){return arguments.length!==2?r.na:n!==t};t.POW=function(n,i){return arguments.length!==2?r.na:(n=utils.parseNumber(n),i=utils.parseNumber(i),utils.anyIsError(n,i))?r.error:t.POWER(n,i)};t.SUM=function(){var n=0;return utils.arrayEach(utils.argsToArray(arguments),function(i){if(typeof i=="number")n+=i;else if(typeof i=="string"){var r=parseFloat(i);isNaN(r)||(n+=r)}else Array.isArray(i)&&(n+=t.SUM.apply(null,i))}),n};t.SUMIF=function(range,criteria){var result,i;if(range=utils.parseNumberArray(utils.flatten(range)),range instanceof Error)return range;for(result=0,i=0;i<range.length;i++)result+=eval(range[i]+criteria)?range[i]:0;return result};t.SUMIFS=function(){var args=utils.argsToArray(arguments),range=utils.parseNumberArray(utils.flatten(args.shift())),i,el,condition,c;if(range instanceof Error)return range;var criteria=args,n_range_elements=range.length,n_criterias=criteria.length,result=0;for(i=0;i<n_range_elements;i++){for(el=range[i],condition="",c=0;c<n_criterias;c++)condition+=el+criteria[c],c!==n_criterias-1&&(condition+="&&");eval(condition)&&(result+=el)}return result};t.SUMPRODUCT=function(){var s,u,i,n,f,e,t,o;if(!arguments||arguments.length===0)return r.value;for(s=arguments.length+1,u=0,t=0;t<arguments[0].length;t++)if(arguments[0][t]instanceof Array)for(o=0;o<arguments[0][t].length;o++){for(i=1,n=1;n<s;n++){if(e=utils.parseNumber(arguments[n-1][t][o]),e instanceof Error)return e;i*=e}u+=i}else{for(i=1,n=1;n<s;n++){if(f=utils.parseNumber(arguments[n-1][t]),f instanceof Error)return f;i*=f}u+=i}return u};t.SUMSQ=function(){var n=utils.parseNumberArray(utils.flatten(arguments)),i,r,t;if(n instanceof Error)return n;for(i=0,r=n.length,t=0;t<r;t++)i+=e.ISNUMBER(n[t])?n[t]*n[t]:0;return i};t.SUMX2MY2=function(n,t){var u,i;if(n=utils.parseNumberArray(utils.flatten(n)),t=utils.parseNumberArray(utils.flatten(t)),utils.anyIsError(n,t))return r.value;for(u=0,i=0;i<n.length;i++)u+=n[i]*n[i]-t[i]*t[i];return u};t.SUMX2PY2=function(n,t){var u,i;if(n=utils.parseNumberArray(utils.flatten(n)),t=utils.parseNumberArray(utils.flatten(t)),utils.anyIsError(n,t))return r.value;for(u=0,n=utils.parseNumberArray(utils.flatten(n)),t=utils.parseNumberArray(utils.flatten(t)),i=0;i<n.length;i++)u+=n[i]*n[i]+t[i]*t[i];return u};t.SUMXMY2=function(n,t){var u,i;if(n=utils.parseNumberArray(utils.flatten(n)),t=utils.parseNumberArray(utils.flatten(t)),utils.anyIsError(n,t))return r.value;for(u=0,n=utils.flatten(n),t=utils.flatten(t),i=0;i<n.length;i++)u+=Math.pow(n[i]-t[i],2);return u};t.TAN=function(n){return(n=utils.parseNumber(n),n instanceof Error)?n:Math.tan(n)};t.TANH=function(n){if(n=utils.parseNumber(n),n instanceof Error)return n;var t=Math.exp(2*n);return(t-1)/(t+1)};t.TRUNC=function(n,t){if(t=t===undefined?0:t,n=utils.parseNumber(n),t=utils.parseNumber(t),utils.anyIsError(n,t))return r.value;var i=n>0?1:-1;return i*Math.floor(Math.abs(n)*Math.pow(10,t))/Math.pow(10,t)}},function(n,t,i){var u=i(4),e=i(6),r=i(11).jStat,utils=i(1),error=i(0),f=i(12),o=2.5066282746310002;t.AVEDEV=function(){var n=utils.parseNumberArray(utils.flatten(arguments));return n instanceof Error?n:r.sum(r(n).subtract(r.mean(n)).abs()[0])/n.length};t.AVERAGE=function(){for(var i=utils.numbers(utils.flatten(arguments)),f=i.length,r=0,u=0,n,t=0;t<f;t++)r+=i[t],u+=1;return n=r/u,isNaN(n)&&(n=error.num),n};t.AVERAGEA=function(){for(var n,u=utils.flatten(arguments),e=u.length,i=0,f=0,t,r=0;r<e;r++)n=u[r],typeof n=="number"&&(i+=n),n===!0&&i++,n!==null&&f++;return t=i/f,isNaN(t)&&(t=error.num),t};t.AVERAGEIF=function(range,criteria,average_range){var average_count,result,i;if(arguments.length<=1)return error.na;if(average_range=average_range||range,range=utils.flatten(range),average_range=utils.parseNumberArray(utils.flatten(average_range)),average_range instanceof Error)return average_range;for(average_count=0,result=0,i=0;i<range.length;i++)eval(range[i]+criteria)&&(result+=average_range[i],average_count++);return result/average_count};t.AVERAGEIFS=function(){for(var condition,j,average,args=utils.argsToArray(arguments),criteria=(args.length-1)/2,range=utils.flatten(args[0]),count=0,result=0,i=0;i<range.length;i++){for(condition="",j=0;j<criteria;j++)condition+=args[2*j+1][i]+args[2*j+2],j!==criteria-1&&(condition+="&&");eval(condition)&&(result+=range[i],count++)}return average=result/count,isNaN(average)?0:average};t.BETA={};t.BETA.DIST=function(n,t,i,u,f,e){return arguments.length<4?error.value:(f=f===undefined?0:f,e=e===undefined?1:e,n=utils.parseNumber(n),t=utils.parseNumber(t),i=utils.parseNumber(i),f=utils.parseNumber(f),e=utils.parseNumber(e),utils.anyIsError(n,t,i,f,e))?error.value:(n=(n-f)/(e-f),u?r.beta.cdf(n,t,i):r.beta.pdf(n,t,i))};t.BETA.INV=function(n,t,i,u,f){return(u=u===undefined?0:u,f=f===undefined?1:f,n=utils.parseNumber(n),t=utils.parseNumber(t),i=utils.parseNumber(i),u=utils.parseNumber(u),f=utils.parseNumber(f),utils.anyIsError(n,t,i,u,f))?error.value:r.beta.inv(n,t,i)*(f-u)+u};t.BINOM={};t.BINOM.DIST=function(n,t,i,u){return(n=utils.parseNumber(n),t=utils.parseNumber(t),i=utils.parseNumber(i),u=utils.parseNumber(u),utils.anyIsError(n,t,i,u))?error.value:u?r.binomial.cdf(n,t,i):r.binomial.pdf(n,t,i)};t.BINOM.DIST.RANGE=function(n,t,i,r){var e,f;if(r=r===undefined?i:r,n=utils.parseNumber(n),t=utils.parseNumber(t),i=utils.parseNumber(i),r=utils.parseNumber(r),utils.anyIsError(n,t,i,r))return error.value;for(e=0,f=i;f<=r;f++)e+=u.COMBIN(n,f)*Math.pow(t,f)*Math.pow(1-t,n-f);return e};t.BINOM.INV=function(n,t,i){if(n=utils.parseNumber(n),t=utils.parseNumber(t),i=utils.parseNumber(i),utils.anyIsError(n,t,i))return error.value;for(var u=0;u<=n;){if(r.binomial.cdf(u,n,t)>=i)return u;u++}};t.CHISQ={};t.CHISQ.DIST=function(n,t,i){return(n=utils.parseNumber(n),t=utils.parseNumber(t),utils.anyIsError(n,t))?error.value:i?r.chisquare.cdf(n,t):r.chisquare.pdf(n,t)};t.CHISQ.DIST.RT=function(n,t){return!n|!t?error.na:n<1||t>Math.pow(10,10)?error.num:typeof n!="number"||typeof t!="number"?error.value:1-r.chisquare.cdf(n,t)};t.CHISQ.INV=function(n,t){return(n=utils.parseNumber(n),t=utils.parseNumber(t),utils.anyIsError(n,t))?error.value:r.chisquare.inv(n,t)};t.CHISQ.INV.RT=function(n,t){return!n|!t?error.na:n<0||n>1||t<1||t>Math.pow(10,10)?error.num:typeof n!="number"||typeof t!="number"?error.value:r.chisquare.inv(1-n,t)};t.CHISQ.TEST=function(n,t){function c(n,t){var i=Math.exp(-.5*n),r,u,f;for(t%2==1&&(i=i*Math.sqrt(2*n/h)),r=t;r>=2;)i=i*n/r,r=r-2;for(u=i,f=t;u>1e-10*i;)f=f+2,u=u*n/f,i=i+u;return 1-i}var u,f,i,r;if(arguments.length!==2)return error.na;if(!(n instanceof Array)||!(t instanceof Array)||n.length!==t.length||n[0]&&t[0]&&n[0].length!==t[0].length)return error.value;for(u=n.length,i=0;i<u;i++)n[i]instanceof Array||(f=n[i],n[i]=[],n[i].push(f)),t[i]instanceof Array||(f=t[i],t[i]=[],t[i].push(f));var e=n[0].length,s=e===1?u-1:(u-1)*(e-1),o=0,h=Math.PI;for(i=0;i<u;i++)for(r=0;r<e;r++)o+=Math.pow(n[i][r]-t[i][r],2)/t[i][r];return Math.round(c(o,s)*1e6)/1e6};t.COLUMN=function(n,t){return arguments.length!==2?error.na:t<0?error.num:!(n instanceof Array)||typeof t!="number"?error.value:n.length===0?undefined:r.col(n,t)};t.COLUMNS=function(n){return arguments.length!==1?error.na:(n instanceof Array)?n.length===0?0:r.cols(n):error.value};t.CONFIDENCE={};t.CONFIDENCE.NORM=function(n,t,i){return(n=utils.parseNumber(n),t=utils.parseNumber(t),i=utils.parseNumber(i),utils.anyIsError(n,t,i))?error.value:r.normalci(1,n,t,i)[1]-1};t.CONFIDENCE.T=function(n,t,i){return(n=utils.parseNumber(n),t=utils.parseNumber(t),i=utils.parseNumber(i),utils.anyIsError(n,t,i))?error.value:r.tci(1,n,t,i)[1]-1};t.CORREL=function(n,t){return(n=utils.parseNumberArray(utils.flatten(n)),t=utils.parseNumberArray(utils.flatten(t)),utils.anyIsError(n,t))?error.value:r.corrcoeff(n,t)};t.COUNT=function(){return utils.numbers(utils.flatten(arguments)).length};t.COUNTA=function(){var n=utils.flatten(arguments);return n.length-t.COUNTBLANK(n)};t.COUNTIN=function(n,t){var r=0,i;for(n=utils.flatten(n),i=0;i<n.length;i++)n[i]===t&&r++;return r};t.COUNTBLANK=function(){for(var i=utils.flatten(arguments),r=0,n,t=0;t<i.length;t++)n=i[t],(n===null||n==="")&&r++;return r};t.COUNTIF=function(range,criteria){var matches,i;for(range=utils.flatten(range),/[<>=!]/.test(criteria)||(criteria='=="'+criteria+'"'),matches=0,i=0;i<range.length;i++)typeof range[i]!="string"?eval(range[i]+criteria)&&matches++:eval('"'+range[i]+'"'+criteria)&&matches++;return matches};t.COUNTIFS=function(){for(var range,criteria,j,result,args=utils.argsToArray(arguments),results=new Array(utils.flatten(args[0]).length),i=0;i<results.length;i++)results[i]=!0;for(i=0;i<args.length;i+=2)for(range=utils.flatten(args[i]),criteria=args[i+1],/[<>=!]/.test(criteria)||(criteria='=="'+criteria+'"'),j=0;j<range.length;j++)results[j]=typeof range[j]!="string"?results[j]&&eval(range[j]+criteria):results[j]&&eval('"'+range[j]+'"'+criteria);for(result=0,i=0;i<results.length;i++)results[i]&&result++;return result};t.COUNTUNIQUE=function(){return f.UNIQUE.apply(null,utils.flatten(arguments)).length};t.COVARIANCE={};t.COVARIANCE.P=function(n,t){var i;if(n=utils.parseNumberArray(utils.flatten(n)),t=utils.parseNumberArray(utils.flatten(t)),utils.anyIsError(n,t))return error.value;var e=r.mean(n),o=r.mean(t),u=0,f=n.length;for(i=0;i<f;i++)u+=(n[i]-e)*(t[i]-o);return u/f};t.COVARIANCE.S=function(n,t){return(n=utils.parseNumberArray(utils.flatten(n)),t=utils.parseNumberArray(utils.flatten(t)),utils.anyIsError(n,t))?error.value:r.covariance(n,t)};t.DEVSQ=function(){var n=utils.parseNumberArray(utils.flatten(arguments)),u,i,t;if(n instanceof Error)return n;for(u=r.mean(n),i=0,t=0;t<n.length;t++)i+=Math.pow(n[t]-u,2);return i};t.EXPON={};t.EXPON.DIST=function(n,t,i){return(n=utils.parseNumber(n),t=utils.parseNumber(t),utils.anyIsError(n,t))?error.value:i?r.exponential.cdf(n,t):r.exponential.pdf(n,t)};t.F={};t.F.DIST=function(n,t,i,u){return(n=utils.parseNumber(n),t=utils.parseNumber(t),i=utils.parseNumber(i),utils.anyIsError(n,t,i))?error.value:u?r.centralF.cdf(n,t,i):r.centralF.pdf(n,t,i)};t.F.DIST.RT=function(n,t,i){return arguments.length!==3?error.na:n<0||t<1||i<1?error.num:typeof n!="number"||typeof t!="number"||typeof i!="number"?error.value:1-r.centralF.cdf(n,t,i)};t.F.INV=function(n,t,i){return(n=utils.parseNumber(n),t=utils.parseNumber(t),i=utils.parseNumber(i),utils.anyIsError(n,t,i))?error.value:n<=0||n>1?error.num:r.centralF.inv(n,t,i)};t.F.INV.RT=function(n,t,i){return arguments.length!==3?error.na:n<0||n>1||t<1||t>Math.pow(10,10)||i<1||i>Math.pow(10,10)?error.num:typeof n!="number"||typeof t!="number"||typeof i!="number"?error.value:r.centralF.inv(1-n,t,i)};t.F.TEST=function(n,t){if(!n||!t||!(n instanceof Array)||!(t instanceof Array))return error.na;if(n.length<2||t.length<2)return error.div0;var i=function(n,t){for(var r=0,i=0;i<n.length;i++)r+=Math.pow(n[i]-t,2);return r},r=u.SUM(n)/n.length,f=u.SUM(t)/t.length,e=i(n,r)/(n.length-1),o=i(t,f)/(t.length-1);return e/o};t.FISHER=function(n){return(n=utils.parseNumber(n),n instanceof Error)?n:Math.log((1+n)/(1-n))/2};t.FISHERINV=function(n){if(n=utils.parseNumber(n),n instanceof Error)return n;var t=Math.exp(2*n);return(t-1)/(t+1)};t.FORECAST=function(n,t,i){var u,e,c;if(n=utils.parseNumber(n),t=utils.parseNumberArray(utils.flatten(t)),i=utils.parseNumberArray(utils.flatten(i)),utils.anyIsError(n,t,i))return error.value;var f=r.mean(i),o=r.mean(t),l=i.length,s=0,h=0;for(u=0;u<l;u++)s+=(i[u]-f)*(t[u]-o),h+=Math.pow(i[u]-f,2);return e=s/h,c=o-e*f,c+e*n};t.FREQUENCY=function(n,t){var i,r;if(n=utils.parseNumberArray(utils.flatten(n)),t=utils.parseNumberArray(utils.flatten(t)),utils.anyIsError(n,t))return error.value;var e=n.length,u=t.length,f=[];for(i=0;i<=u;i++)for(f[i]=0,r=0;r<e;r++)i===0?n[r]<=t[0]&&(f[0]+=1):i<u?n[r]>t[i-1]&&n[r]<=t[i]&&(f[i]+=1):i===u&&n[r]>t[u-1]&&(f[u]+=1);return f};t.GAMMA=function(n){return(n=utils.parseNumber(n),n instanceof Error)?n:n===0?error.num:parseInt(n,10)===n&&n<0?error.num:r.gammafn(n)};t.GAMMA.DIST=function(n,t,i,u){return arguments.length!==4?error.na:n<0||t<=0||i<=0?error.value:typeof n!="number"||typeof t!="number"||typeof i!="number"?error.value:u?r.gamma.cdf(n,t,i,!0):r.gamma.pdf(n,t,i,!1)};t.GAMMA.INV=function(n,t,i){return arguments.length!==3?error.na:n<0||n>1||t<=0||i<=0?error.num:typeof n!="number"||typeof t!="number"||typeof i!="number"?error.value:r.gamma.inv(n,t,i)};t.GAMMALN=function(n){return(n=utils.parseNumber(n),n instanceof Error)?n:r.gammaln(n)};t.GAMMALN.PRECISE=function(n){return arguments.length!==1?error.na:n<=0?error.num:typeof n!="number"?error.value:r.gammaln(n)};t.GAUSS=function(n){return(n=utils.parseNumber(n),n instanceof Error)?n:r.normal.cdf(n,0,1)-.5};t.GEOMEAN=function(){var n=utils.parseNumberArray(utils.flatten(arguments));return n instanceof Error?n:r.geomean(n)};t.GROWTH=function(n,t,i,r){var u,o,a,l,v,y;if(n=utils.parseNumberArray(n),n instanceof Error)return n;if(t===undefined)for(t=[],u=1;u<=n.length;u++)t.push(u);if(i===undefined)for(i=[],u=1;u<=n.length;u++)i.push(u);if(t=utils.parseNumberArray(t),i=utils.parseNumberArray(i),utils.anyIsError(t,i))return error.value;r===undefined&&(r=!0);var e=n.length,f=0,s=0,h=0,c=0;for(u=0;u<e;u++)o=t[u],a=Math.log(n[u]),f+=o,s+=a,h+=o*a,c+=o*o;for(f/=e,s/=e,h/=e,c/=e,r?(l=(h-f*s)/(c-f*f),v=s-l*f):(l=h/c,v=0),y=[],u=0;u<i.length;u++)y.push(Math.exp(v+l*i[u]));return y};t.HARMEAN=function(){var n=utils.parseNumberArray(utils.flatten(arguments)),i,r,t;if(n instanceof Error)return n;for(i=n.length,r=0,t=0;t<i;t++)r+=1/n[t];return i/r};t.HYPGEOM={};t.HYPGEOM.DIST=function(n,t,i,r,f){function e(n,t,i,r){return u.COMBIN(i,n)*u.COMBIN(r-i,t-n)/u.COMBIN(r,t)}function o(n,t,i,r){for(var f=0,u=0;u<=n;u++)f+=e(u,t,i,r);return f}return(n=utils.parseNumber(n),t=utils.parseNumber(t),i=utils.parseNumber(i),r=utils.parseNumber(r),utils.anyIsError(n,t,i,r))?error.value:f?o(n,t,i,r):e(n,t,i,r)};t.INTERCEPT=function(n,i){return(n=utils.parseNumberArray(n),i=utils.parseNumberArray(i),utils.anyIsError(n,i))?error.value:n.length!==i.length?error.na:t.FORECAST(0,n,i)};t.KURT=function(){var t=utils.parseNumberArray(utils.flatten(arguments)),u;if(t instanceof Error)return t;var f=r.mean(t),n=t.length,i=0;for(u=0;u<n;u++)i+=Math.pow(t[u]-f,4);return i=i/Math.pow(r.stdev(t,!0),4),n*(n+1)/((n-1)*(n-2)*(n-3))*i-3*(n-1)*(n-1)/((n-2)*(n-3))};t.LARGE=function(n,t){return(n=utils.parseNumberArray(utils.flatten(n)),t=utils.parseNumber(t),utils.anyIsError(n,t))?n:n.sort(function(n,t){return t-n})[t-1]};t.LINEST=function(n,t){var i,f,h;if(n=utils.parseNumberArray(utils.flatten(n)),t=utils.parseNumberArray(utils.flatten(t)),utils.anyIsError(n,t))return error.value;var e=r.mean(n),u=r.mean(t),c=t.length,o=0,s=0;for(i=0;i<c;i++)o+=(t[i]-u)*(n[i]-e),s+=Math.pow(t[i]-u,2);return f=o/s,h=e-f*u,[f,h]};t.LOGEST=function(n,i){var u,r;if(n=utils.parseNumberArray(utils.flatten(n)),i=utils.parseNumberArray(utils.flatten(i)),utils.anyIsError(n,i))return error.value;for(u=0;u<n.length;u++)n[u]=Math.log(n[u]);return r=t.LINEST(n,i),r[0]=Math.round(Math.exp(r[0])*1e6)/1e6,r[1]=Math.round(Math.exp(r[1])*1e6)/1e6,r};t.LOGNORM={};t.LOGNORM.DIST=function(n,t,i,u){return(n=utils.parseNumber(n),t=utils.parseNumber(t),i=utils.parseNumber(i),utils.anyIsError(n,t,i))?error.value:u?r.lognormal.cdf(n,t,i):r.lognormal.pdf(n,t,i)};t.LOGNORM.INV=function(n,t,i){return(n=utils.parseNumber(n),t=utils.parseNumber(t),i=utils.parseNumber(i),utils.anyIsError(n,t,i))?error.value:r.lognormal.inv(n,t,i)};t.MAX=function(){var n=utils.numbers(utils.flatten(arguments));return n.length===0?0:Math.max.apply(Math,n)};t.MAXA=function(){var n=utils.arrayValuesToNumbers(utils.flatten(arguments));return n.length===0?0:Math.max.apply(Math,n)};t.MEDIAN=function(){var t=utils.arrayValuesToNumbers(utils.flatten(arguments)),n=r.median(t);return isNaN(n)&&(n=error.num),n};t.MIN=function(){var n=utils.numbers(utils.flatten(arguments));return n.length===0?0:Math.min.apply(Math,n)};t.MINA=function(){var n=utils.arrayValuesToNumbers(utils.flatten(arguments));return n.length===0?0:Math.min.apply(Math,n)};t.MODE={};t.MODE.MULT=function(){var i=utils.parseNumberArray(utils.flatten(arguments)),u;if(i instanceof Error)return i;var e=i.length,t={},r=[],f=0,n;for(u=0;u<e;u++)n=i[u],t[n]=t[n]?t[n]+1:1,t[n]>f&&(f=t[n],r=[]),t[n]===f&&(r[r.length]=n);return r};t.MODE.SNGL=function(){var n=utils.parseNumberArray(utils.flatten(arguments));return n instanceof Error?n:t.MODE.MULT(n).sort(function(n,t){return n-t})[0]};t.NEGBINOM={};t.NEGBINOM.DIST=function(n,t,i,u){return(n=utils.parseNumber(n),t=utils.parseNumber(t),i=utils.parseNumber(i),utils.anyIsError(n,t,i))?error.value:u?r.negbin.cdf(n,t,i):r.negbin.pdf(n,t,i)};t.NORM={};t.NORM.DIST=function(n,t,i,u){return(n=utils.parseNumber(n),t=utils.parseNumber(t),i=utils.parseNumber(i),utils.anyIsError(n,t,i))?error.value:i<=0?error.num:u?r.normal.cdf(n,t,i):r.normal.pdf(n,t,i)};t.NORM.INV=function(n,t,i){return(n=utils.parseNumber(n),t=utils.parseNumber(t),i=utils.parseNumber(i),utils.anyIsError(n,t,i))?error.value:r.normal.inv(n,t,i)};t.NORM.S={};t.NORM.S.DIST=function(n,t){return(n=utils.parseNumber(n),n instanceof Error)?error.value:t?r.normal.cdf(n,0,1):r.normal.pdf(n,0,1)};t.NORM.S.INV=function(n){return(n=utils.parseNumber(n),n instanceof Error)?error.value:r.normal.inv(n,0,1)};t.PEARSON=function(n,t){var i;if(t=utils.parseNumberArray(utils.flatten(t)),n=utils.parseNumberArray(utils.flatten(n)),utils.anyIsError(t,n))return error.value;var u=r.mean(n),f=r.mean(t),h=n.length,e=0,o=0,s=0;for(i=0;i<h;i++)e+=(n[i]-u)*(t[i]-f),o+=Math.pow(n[i]-u,2),s+=Math.pow(t[i]-f,2);return e/Math.sqrt(o*s)};t.PERCENTILE={};t.PERCENTILE.EXC=function(n,t){var u,r,i;return(n=utils.parseNumberArray(utils.flatten(n)),t=utils.parseNumber(t),utils.anyIsError(n,t))?error.value:(n=n.sort(function(n,t){return n-t}),u=n.length,t<1/(u+1)||t>1-1/(u+1))?error.num:(r=t*(u+1)-1,i=Math.floor(r),utils.cleanFloat(r===i?n[r]:n[i]+(r-i)*(n[i+1]-n[i])))};t.PERCENTILE.INC=function(n,t){if(n=utils.parseNumberArray(utils.flatten(n)),t=utils.parseNumber(t),utils.anyIsError(n,t))return error.value;n=n.sort(function(n,t){return n-t});var u=n.length,r=t*(u-1),i=Math.floor(r);return utils.cleanFloat(r===i?n[r]:n[i]+(r-i)*(n[i+1]-n[i]))};t.PERCENTRANK={};t.PERCENTRANK.EXC=function(n,t,i){if(i=i===undefined?3:i,n=utils.parseNumberArray(utils.flatten(n)),t=utils.parseNumber(t),i=utils.parseNumber(i),utils.anyIsError(n,t,i))return error.value;n=n.sort(function(n,t){return n-t});for(var u=f.UNIQUE.apply(null,n),s=n.length,h=u.length,c=Math.pow(10,i),e=0,o=!1,r=0;!o&&r<h;)t===u[r]?(e=(n.indexOf(u[r])+1)/(s+1),o=!0):t>=u[r]&&(t<u[r+1]||r===h-1)&&(e=(n.indexOf(u[r])+1+(t-u[r])/(u[r+1]-u[r]))/(s+1),o=!0),r++;return Math.floor(e*c)/c};t.PERCENTRANK.INC=function(n,t,i){if(i=i===undefined?3:i,n=utils.parseNumberArray(utils.flatten(n)),t=utils.parseNumber(t),i=utils.parseNumber(i),utils.anyIsError(n,t,i))return error.value;n=n.sort(function(n,t){return n-t});for(var u=f.UNIQUE.apply(null,n),s=n.length,h=u.length,c=Math.pow(10,i),e=0,o=!1,r=0;!o&&r<h;)t===u[r]?(e=n.indexOf(u[r])/(s-1),o=!0):t>=u[r]&&(t<u[r+1]||r===h-1)&&(e=(n.indexOf(u[r])+(t-u[r])/(u[r+1]-u[r]))/(s-1),o=!0),r++;return Math.floor(e*c)/c};t.PERMUT=function(n,t){return(n=utils.parseNumber(n),t=utils.parseNumber(t),utils.anyIsError(n,t))?error.value:u.FACT(n)/u.FACT(n-t)};t.PERMUTATIONA=function(n,t){return(n=utils.parseNumber(n),t=utils.parseNumber(t),utils.anyIsError(n,t))?error.value:Math.pow(n,t)};t.PHI=function(n){return(n=utils.parseNumber(n),n instanceof Error)?error.value:Math.exp(-.5*n*n)/o};t.POISSON={};t.POISSON.DIST=function(n,t,i){return(n=utils.parseNumber(n),t=utils.parseNumber(t),utils.anyIsError(n,t))?error.value:i?r.poisson.cdf(n,t):r.poisson.pdf(n,t)};t.PROB=function(n,t,i,r){var u;if(i===undefined)return 0;if(r=r===undefined?i:r,n=utils.parseNumberArray(utils.flatten(n)),t=utils.parseNumberArray(utils.flatten(t)),i=utils.parseNumber(i),r=utils.parseNumber(r),utils.anyIsError(n,t,i,r))return error.value;if(i===r)return n.indexOf(i)>=0?t[n.indexOf(i)]:0;var f=n.sort(function(n,t){return n-t}),o=f.length,e=0;for(u=0;u<o;u++)f[u]>=i&&f[u]<=r&&(e+=t[n.indexOf(f[u])]);return e};t.QUARTILE={};t.QUARTILE.EXC=function(n,i){if(n=utils.parseNumberArray(utils.flatten(n)),i=utils.parseNumber(i),utils.anyIsError(n,i))return error.value;switch(i){case 1:return t.PERCENTILE.EXC(n,.25);case 2:return t.PERCENTILE.EXC(n,.5);case 3:return t.PERCENTILE.EXC(n,.75);default:return error.num}};t.QUARTILE.INC=function(n,i){if(n=utils.parseNumberArray(utils.flatten(n)),i=utils.parseNumber(i),utils.anyIsError(n,i))return error.value;switch(i){case 1:return t.PERCENTILE.INC(n,.25);case 2:return t.PERCENTILE.INC(n,.5);case 3:return t.PERCENTILE.INC(n,.75);default:return error.num}};t.RANK={};t.RANK.AVG=function(n,t,i){var f,e,r,u;if(n=utils.parseNumber(n),t=utils.parseNumberArray(utils.flatten(t)),utils.anyIsError(n,t))return error.value;for(t=utils.flatten(t),i=i||!1,f=i?function(n,t){return n-t}:function(n,t){return t-n},t=t.sort(f),e=t.length,r=0,u=0;u<e;u++)t[u]===n&&r++;return r>1?(2*t.indexOf(n)+r+1)/2:t.indexOf(n)+1};t.RANK.EQ=function(n,t,i){if(n=utils.parseNumber(n),t=utils.parseNumberArray(utils.flatten(t)),utils.anyIsError(n,t))return error.value;i=i||!1;var r=i?function(n,t){return n-t}:function(n,t){return t-n};return t=t.sort(r),t.indexOf(n)+1};t.ROW=function(n,t){return arguments.length!==2?error.na:t<0?error.num:!(n instanceof Array)||typeof t!="number"?error.value:n.length===0?undefined:r.row(n,t)};t.ROWS=function(n){return arguments.length!==1?error.na:(n instanceof Array)?n.length===0?0:r.rows(n):error.value};t.RSQ=function(n,i){return(n=utils.parseNumberArray(utils.flatten(n)),i=utils.parseNumberArray(utils.flatten(i)),utils.anyIsError(n,i))?error.value:Math.pow(t.PEARSON(n,i),2)};t.SKEW=function(){var n=utils.parseNumberArray(utils.flatten(arguments)),i;if(n instanceof Error)return n;var f=r.mean(n),t=n.length,u=0;for(i=0;i<t;i++)u+=Math.pow(n[i]-f,3);return t*u/((t-1)*(t-2)*Math.pow(r.stdev(n,!0),3))};t.SKEW.P=function(){var n=utils.parseNumberArray(utils.flatten(arguments)),t;if(n instanceof Error)return n;var e=r.mean(n),f=n.length,i=0,u=0;for(t=0;t<f;t++)u+=Math.pow(n[t]-e,3),i+=Math.pow(n[t]-e,2);return u=u/f,i=i/f,u/Math.pow(i,3/2)};t.SLOPE=function(n,t){var i;if(n=utils.parseNumberArray(utils.flatten(n)),t=utils.parseNumberArray(utils.flatten(t)),utils.anyIsError(n,t))return error.value;var u=r.mean(t),o=r.mean(n),s=t.length,f=0,e=0;for(i=0;i<s;i++)f+=(t[i]-u)*(n[i]-o),e+=Math.pow(t[i]-u,2);return f/e};t.SMALL=function(n,t){return(n=utils.parseNumberArray(utils.flatten(n)),t=utils.parseNumber(t),utils.anyIsError(n,t))?n:n.sort(function(n,t){return n-t})[t-1]};t.STANDARDIZE=function(n,t,i){return(n=utils.parseNumber(n),t=utils.parseNumber(t),i=utils.parseNumber(i),utils.anyIsError(n,t,i))?error.value:(n-t)/i};t.STDEV={};t.STDEV.P=function(){var i=t.VAR.P.apply(this,arguments),n=Math.sqrt(i);return isNaN(n)&&(n=error.num),n};t.STDEV.S=function(){var n=t.VAR.S.apply(this,arguments);return Math.sqrt(n)};t.STDEVA=function(){var n=t.VARA.apply(this,arguments);return Math.sqrt(n)};t.STDEVPA=function(){var i=t.VARPA.apply(this,arguments),n=Math.sqrt(i);return isNaN(n)&&(n=error.num),n};t.STEYX=function(n,t){var i;if(n=utils.parseNumberArray(utils.flatten(n)),t=utils.parseNumberArray(utils.flatten(t)),utils.anyIsError(n,t))return error.value;var f=r.mean(t),e=r.mean(n),o=t.length,s=0,u=0,h=0;for(i=0;i<o;i++)s+=Math.pow(n[i]-e,2),u+=(t[i]-f)*(n[i]-e),h+=Math.pow(t[i]-f,2);return Math.sqrt((s-u*u/h)/(o-2))};t.TRANSPOSE=function(n){return n?r.transpose(n):error.na};t.T=e.T;t.T.DIST=function(n,t,i){return(n=utils.parseNumber(n),t=utils.parseNumber(t),utils.anyIsError(n,t))?error.value:i?r.studentt.cdf(n,t):r.studentt.pdf(n,t)};t.T.DIST["2T"]=function(n,t){return arguments.length!==2?error.na:n<0||t<1?error.num:typeof n!="number"||typeof t!="number"?error.value:(1-r.studentt.cdf(n,t))*2};t.T.DIST.RT=function(n,t){return arguments.length!==2?error.na:n<0||t<1?error.num:typeof n!="number"||typeof t!="number"?error.value:1-r.studentt.cdf(n,t)};t.T.INV=function(n,t){return(n=utils.parseNumber(n),t=utils.parseNumber(t),utils.anyIsError(n,t))?error.value:r.studentt.inv(n,t)};t.T.INV["2T"]=function(n,t){return(n=utils.parseNumber(n),t=utils.parseNumber(t),n<=0||n>1||t<1)?error.num:utils.anyIsError(n,t)?error.value:Math.abs(r.studentt.inv(n/2,t))};t.T.TEST=function(n,i){var h;if(n=utils.parseNumberArray(utils.flatten(n)),i=utils.parseNumberArray(utils.flatten(i)),utils.anyIsError(n,i))return error.value;for(var o=r.mean(n),s=r.mean(i),f=0,e=0,u=0;u<n.length;u++)f+=Math.pow(n[u]-o,2);for(u=0;u<i.length;u++)e+=Math.pow(i[u]-s,2);return f=f/(n.length-1),e=e/(i.length-1),h=Math.abs(o-s)/Math.sqrt(f/n.length+e/i.length),t.T.DIST["2T"](h,n.length+i.length-2)};t.TREND=function(n,i,r){if(n=utils.parseNumberArray(utils.flatten(n)),i=utils.parseNumberArray(utils.flatten(i)),r=utils.parseNumberArray(utils.flatten(r)),utils.anyIsError(n,i,r))return error.value;var u=t.LINEST(n,i),e=u[0],o=u[1],f=[];return r.forEach(function(n){f.push(e*n+o)}),f};t.TRIMMEAN=function(n,t){if(n=utils.parseNumberArray(utils.flatten(n)),t=utils.parseNumber(t),utils.anyIsError(n,t))return error.value;var i=u.FLOOR(n.length*t,2)/2;return r.mean(utils.initial(utils.rest(n.sort(function(n,t){return n-t}),i),i))};t.VAR={};t.VAR.P=function(){for(var i=utils.numbers(utils.flatten(arguments)),u=i.length,f=0,e=t.AVERAGE(i),n,r=0;r<u;r++)f+=Math.pow(i[r]-e,2);return n=f/u,isNaN(n)&&(n=error.num),n};t.VAR.S=function(){for(var n=utils.numbers(utils.flatten(arguments)),r=n.length,u=0,f=t.AVERAGE(n),i=0;i<r;i++)u+=Math.pow(n[i]-f,2);return u/(r-1)};t.VARA=function(){for(var n,i=utils.flatten(arguments),o=i.length,f=0,e=0,r=t.AVERAGEA(i),u=0;u<o;u++)n=i[u],f+=typeof n=="number"?Math.pow(n-r,2):n===!0?Math.pow(1-r,2):Math.pow(0-r,2),n!==null&&e++;return f/(e-1)};t.VARPA=function(){for(var n,r=utils.flatten(arguments),s=r.length,e=0,o=0,u=t.AVERAGEA(r),i,f=0;f<s;f++)n=r[f],e+=typeof n=="number"?Math.pow(n-u,2):n===!0?Math.pow(1-u,2):Math.pow(0-u,2),n!==null&&o++;return i=e/o,isNaN(i)&&(i=error.num),i};t.WEIBULL={};t.WEIBULL.DIST=function(n,t,i,r){return(n=utils.parseNumber(n),t=utils.parseNumber(t),i=utils.parseNumber(i),utils.anyIsError(n,t,i))?error.value:r?1-Math.exp(-Math.pow(n/i,t)):Math.pow(n,t-1)*Math.exp(-Math.pow(n/i,t))*t/Math.pow(i,t)};t.Z={};t.Z.TEST=function(n,i,r){if(n=utils.parseNumberArray(utils.flatten(n)),i=utils.parseNumber(i),utils.anyIsError(n,i))return error.value;r=r||t.STDEV.S(n);var u=n.length;return 1-t.NORM.S.DIST((t.AVERAGE(n)-i)/(r/Math.sqrt(u)),!0)}},function(n,t,i){var u=i(1),r=i(0),f=i(9);t.ASC=function(){throw new Error("ASC is not implemented");};t.BAHTTEXT=function(){throw new Error("BAHTTEXT is not implemented");};t.CHAR=function(n){return(n=u.parseNumber(n),n instanceof Error)?n:String.fromCharCode(n)};t.CLEAN=function(n){n=n||"";return n.replace(/[\0-\x1F]/g,"")};t.CODE=function(n){n=n||"";var t=n.charCodeAt(0);return isNaN(t)&&(t=r.na),t};t.CONCATENATE=function(){for(var n=u.flatten(arguments),i=0,t;(i=n.indexOf(!0))>-1;)n[i]="TRUE";for(t=0;(t=n.indexOf(!1))>-1;)n[t]="FALSE";return n.join("")};t.DBCS=function(){throw new Error("DBCS is not implemented");};t.DOLLAR=function(n,t){if(t=t===undefined?2:t,n=u.parseNumber(n),t=u.parseNumber(t),u.anyIsError(n,t))return r.value;var i="";return t<=0?(n=Math.round(n*Math.pow(10,t))/Math.pow(10,t),i="($0,0)"):t>0&&(i="($0,0."+new Array(t+1).join("0")+")"),f(n).format(i)};t.EXACT=function(n,t){return arguments.length!==2?r.na:n===t};t.FIND=function(n,t,i){return arguments.length<2?r.na:(i=i===undefined?0:i,t?t.indexOf(n,i-1)+1:null)};t.FIXED=function(n,t,i){if(t=t===undefined?2:t,i=i===undefined?!1:i,n=u.parseNumber(n),t=u.parseNumber(t),u.anyIsError(n,t))return r.value;var e=i?"0":"0,0";return t<=0?n=Math.round(n*Math.pow(10,t))/Math.pow(10,t):t>0&&(e+="."+new Array(t+1).join("0")),f(n).format(e)};t.HTML2TEXT=function(n){var t="";return n&&(n instanceof Array?n.forEach(function(n){t!==""&&(t+="\n");t+=n.replace(/<(?:.|\n)*?>/gm,"")}):t=n.replace(/<(?:.|\n)*?>/gm,"")),t};t.LEFT=function(n,t){return(t=t===undefined?1:t,t=u.parseNumber(t),t instanceof Error||typeof n!="string")?r.value:n?n.substring(0,t):null};t.LEN=function(n){return arguments.length===0?r.error:typeof n=="string"?n?n.length:0:n.length?n.length:r.value};t.LOWER=function(n){return typeof n!="string"?r.value:n?n.toLowerCase():n};t.MID=function(n,t,i){if(t=u.parseNumber(t),i=u.parseNumber(i),u.anyIsError(t,i)||typeof n!="string")return i;var r=t-1,f=r+i;return n.substring(r,f)};t.NUMBERVALUE=function(n,t,i){return t=typeof t=="undefined"?".":t,i=typeof i=="undefined"?",":i,Number(n.replace(t,".").replace(i,""))};t.PRONETIC=function(){throw new Error("PRONETIC is not implemented");};t.PROPER=function(n){return n===undefined||n.length===0?r.value:(n===!0&&(n="TRUE"),n===!1&&(n="FALSE"),isNaN(n)&&typeof n=="number")?r.value:(typeof n=="number"&&(n=""+n),n.replace(/\w\S*/g,function(n){return n.charAt(0).toUpperCase()+n.substr(1).toLowerCase()}))};t.REGEXEXTRACT=function(n,t){if(arguments.length<2)return r.na;var i=n.match(new RegExp(t));return i?i[i.length>1?i.length-1:0]:null};t.REGEXMATCH=function(n,t,i){if(arguments.length<2)return r.na;var u=n.match(new RegExp(t));return i?u:!!u};t.REGEXREPLACE=function(n,t,i){return arguments.length<3?r.na:n.replace(new RegExp(t),i)};t.REPLACE=function(n,t,i,f){return(t=u.parseNumber(t),i=u.parseNumber(i),u.anyIsError(t,i)||typeof n!="string"||typeof f!="string")?r.value:n.substr(0,t-1)+f+n.substr(t-1+i)};t.REPT=function(n,t){return(t=u.parseNumber(t),t instanceof Error)?t:new Array(t+1).join(n)};t.RIGHT=function(n,t){return(t=t===undefined?1:t,t=u.parseNumber(t),t instanceof Error)?t:n?n.substring(n.length-t):r.na};t.SEARCH=function(n,t,i){var u;return typeof n!="string"||typeof t!="string"?r.value:(i=i===undefined?0:i,u=t.toLowerCase().indexOf(n.toLowerCase(),i-1)+1,u===0?r.value:u)};t.SPLIT=function(n,t){return n.split(t)};t.SUBSTITUTE=function(n,t,i,u){if(arguments.length<2)return r.na;if(n&&t&&i){if(u===undefined)return n.replace(new RegExp(t,"g"),i);for(var f=0,e=0;n.indexOf(t,f)>0;)if(f=n.indexOf(t,f+1),e++,e===u)return n.substring(0,f)+i+n.substring(f+t.length)}else return n};t.T=function(n){return typeof n=="string"?n:""};t.TEXT=function(n,t){return(n=u.parseNumber(n),u.anyIsError(n))?r.na:f(n).format(t)};t.TRIM=function(n){return typeof n!="string"?r.value:n.replace(/ +/g," ").trim()};t.UNICHAR=t.CHAR;t.UNICODE=t.CODE;t.UPPER=function(n){return typeof n!="string"?r.value:n.toUpperCase()};t.VALUE=function(n){if(typeof n!="string")return r.value;var t=f().unformat(n);return t===void 0?0:t}},function(n,t,i){var r=i(0);t.CELL=function(){throw new Error("CELL is not implemented");};t.ERROR={};t.ERROR.TYPE=function(n){switch(n){case r.nil:return 1;case r.div0:return 2;case r.value:return 3;case r.ref:return 4;case r.name:return 5;case r.num:return 6;case r.na:return 7;case r.data:return 8}return r.na};t.INFO=function(){throw new Error("INFO is not implemented");};t.ISBLANK=function(n){return n===null};t.ISBINARY=function(n){return/^[01]{1,10}$/.test(n)};t.ISERR=function(n){return[r.value,r.ref,r.div0,r.num,r.name,r.nil].indexOf(n)>=0||typeof n=="number"&&(isNaN(n)||!isFinite(n))};t.ISERROR=function(n){return t.ISERR(n)||n===r.na};t.ISEVEN=function(n){return Math.floor(Math.abs(n))&1?!1:!0};t.ISFORMULA=function(){throw new Error("ISFORMULA is not implemented");};t.ISLOGICAL=function(n){return n===!0||n===!1};t.ISNA=function(n){return n===r.na};t.ISNONTEXT=function(n){return typeof n!="string"};t.ISNUMBER=function(n){return typeof n=="number"&&!isNaN(n)&&isFinite(n)};t.ISODD=function(n){return Math.floor(Math.abs(n))&1?!0:!1};t.ISREF=function(){throw new Error("ISREF is not implemented");};t.ISTEXT=function(n){return typeof n=="string"};t.N=function(n){return this.ISNUMBER(n)?n:n instanceof Date?n.getTime():n===!0?1:n===!1?0:this.ISERROR(n)?n:0};t.NA=function(){return r.na};t.SHEET=function(){throw new Error("SHEET is not implemented");};t.SHEETS=function(){throw new Error("SHEETS is not implemented");};t.TYPE=function(n){return this.ISNUMBER(n)?1:this.ISTEXT(n)?2:this.ISLOGICAL(n)?4:this.ISERROR(n)?16:Array.isArray(n)?64:void 0}},function(n,t,i){function h(n){return new Date(n,1,29).getMonth()===1}function e(n,t){return Math.ceil((t-n)/864e5)}function o(n){var t=n>-22038912e5?2:1;return(n-s)/864e5+t}var u=i(0),r=i(1),s=new Date(1900,0,1),c=[undefined,0,1,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,1,2,3,4,5,6,0],l=[[],[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],[],[],[],[],[],[],[],[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]],f=[[],[6,0],[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],undefined,undefined,undefined,[0,0],[1,1],[2,2],[3,3],[4,4],[5,5],[6,6]];t.DATE=function(n,t,i){return n=r.parseNumber(n),t=r.parseNumber(t),i=r.parseNumber(i),r.anyIsError(n,t,i)?u.value:n<0||t<0||i<0?u.num:new Date(n,t-1,i)};t.DATEVALUE=function(n){if(typeof n!="string")return u.value;var t=Date.parse(n);return isNaN(t)?u.value:t<=-22038912e5?(t-s)/864e5+1:(t-s)/864e5+2};t.DAY=function(n){var t=r.parseDate(n);return t instanceof Error?t:t.getDate()};t.DAYS=function(n,t){return(n=r.parseDate(n),t=r.parseDate(t),n instanceof Error)?n:t instanceof Error?t:o(n)-o(t)};t.DAYS360=function(n,t,i){var o,f,e,u,s,h;return(i=r.parseBool(i),n=r.parseDate(n),t=r.parseDate(t),n instanceof Error)?n:t instanceof Error?t:i instanceof Error?i:(o=n.getMonth(),f=t.getMonth(),i?(e=n.getDate()===31?30:n.getDate(),u=t.getDate()===31?30:t.getDate()):(s=new Date(n.getFullYear(),o+1,0).getDate(),h=new Date(t.getFullYear(),f+1,0).getDate(),e=n.getDate()===s?30:n.getDate(),t.getDate()===h?e<30?(f++,u=1):u=30:u=t.getDate()),360*(t.getFullYear()-n.getFullYear())+30*(f-o)+(u-e))};t.EDATE=function(n,t){return(n=r.parseDate(n),n instanceof Error)?n:isNaN(t)?u.value:(t=parseInt(t,10),n.setMonth(n.getMonth()+t),o(n))};t.EOMONTH=function(n,t){return(n=r.parseDate(n),n instanceof Error)?n:isNaN(t)?u.value:(t=parseInt(t,10),o(new Date(n.getFullYear(),n.getMonth()+t+1,0)))};t.HOUR=function(n){return(n=r.parseDate(n),n instanceof Error)?n:n.getHours()};t.INTERVAL=function(n){var t,i,r,f,e,o;return typeof n!="number"&&typeof n!="string"?u.value:(n=parseInt(n,10),t=Math.floor(n/94608e4),n=n%94608e4,i=Math.floor(n/2592e3),n=n%2592e3,r=Math.floor(n/86400),n=n%86400,f=Math.floor(n/3600),n=n%3600,e=Math.floor(n/60),n=n%60,o=n,t=t>0?t+"Y":"",i=i>0?i+"M":"",r=r>0?r+"D":"",f=f>0?f+"H":"",e=e>0?e+"M":"",o=o>0?o+"S":"","P"+t+i+r+"T"+f+e+o)};t.ISOWEEKNUM=function(n){if(n=r.parseDate(n),n instanceof Error)return n;n.setHours(0,0,0);n.setDate(n.getDate()+4-(n.getDay()||7));var t=new Date(n.getFullYear(),0,1);return Math.ceil(((n-t)/864e5+1)/7)};t.MINUTE=function(n){return(n=r.parseDate(n),n instanceof Error)?n:n.getMinutes()};t.MONTH=function(n){return(n=r.parseDate(n),n instanceof Error)?n:n.getMonth()+1};t.NETWORKDAYS=function(n,t,i){return this.NETWORKDAYS.INTL(n,t,1,i)};t.NETWORKDAYS.INTL=function(n,t,i,e){var o,h,v,c,l,a;if(n=r.parseDate(n),n instanceof Error)return n;if(t=r.parseDate(t),t instanceof Error)return t;if(i=i===undefined?f[1]:f[i],!(i instanceof Array))return u.value;for(e===undefined?e=[]:e instanceof Array||(e=[e]),o=0;o<e.length;o++){if(h=r.parseDate(e[o]),h instanceof Error)return h;e[o]=h}var y=(t-n)/864e5+1,p=y,s=n;for(o=0;o<y;o++){for(v=(new Date).getTimezoneOffset()>0?s.getUTCDay():s.getDay(),c=!1,(v===i[0]||v===i[1])&&(c=!0),l=0;l<e.length;l++)if(a=e[l],a.getDate()===s.getDate()&&a.getMonth()===s.getMonth()&&a.getFullYear()===s.getFullYear()){c=!0;break}c&&p--;s.setDate(s.getDate()+1)}return p};t.NOW=function(){return new Date};t.SECOND=function(n){return(n=r.parseDate(n),n instanceof Error)?n:n.getSeconds()};t.TIME=function(n,t,i){return(n=r.parseNumber(n),t=r.parseNumber(t),i=r.parseNumber(i),r.anyIsError(n,t,i))?u.value:n<0||t<0||i<0?u.num:(3600*n+60*t+i)/86400};t.TIMEVALUE=function(n){return(n=r.parseDate(n),n instanceof Error)?n:(3600*n.getHours()+60*n.getMinutes()+n.getSeconds())/86400};t.TODAY=function(){return new Date};t.WEEKDAY=function(n,t){if(n=r.parseDate(n),n instanceof Error)return n;t===undefined&&(t=1);var i=n.getDay();return l[t][i]};t.WEEKNUM=function(n,t){if(n=r.parseDate(n),n instanceof Error)return n;if(t===undefined&&(t=1),t===21)return this.ISOWEEKNUM(n);var u=c[t],i=new Date(n.getFullYear(),0,1),f=i.getDay()<u?1:0;return i-=Math.abs(i.getDay()-u)*864e5,Math.floor((n-i)/6048e5+1)+f};t.WORKDAY=function(n,t,i){return this.WORKDAY.INTL(n,t,1,i)};t.WORKDAY.INTL=function(n,t,i,e){var o,s,h,a,c,l;if(n=r.parseDate(n),n instanceof Error)return n;if(t=r.parseNumber(t),t instanceof Error)return t;if(t<0)return u.num;if(i=i===undefined?f[1]:f[i],!(i instanceof Array))return u.value;for(e===undefined?e=[]:e instanceof Array||(e=[e]),o=0;o<e.length;o++){if(s=r.parseDate(e[o]),s instanceof Error)return s;e[o]=s}for(h=0;h<t;)if(n.setDate(n.getDate()+1),a=n.getDay(),a!==i[0]&&a!==i[1]){for(c=0;c<e.length;c++)if(l=e[c],l.getDate()===n.getDate()&&l.getMonth()===n.getMonth()&&l.getFullYear()===n.getFullYear()){h--;break}h++}return n};t.YEAR=function(n){return(n=r.parseDate(n),n instanceof Error)?n:n.getFullYear()};t.YEARFRAC=function(n,t,i){var v,a;if(n=r.parseDate(n),n instanceof Error)return n;if(t=r.parseDate(t),t instanceof Error)return t;i=i||0;var u=n.getDate(),l=n.getMonth()+1,f=n.getFullYear(),o=t.getDate(),c=t.getMonth()+1,s=t.getFullYear();switch(i){case 0:return u===31&&o===31?(u=30,o=30):u===31?u=30:u===30&&o===31&&(o=30),(o+c*30+s*360-(u+l*30+f*360))/360;case 1:if(v=function(n,t){var u=n.getFullYear(),f=new Date(u,2,1),i,r;return h(u)&&n<f&&t>=f?!0:(i=t.getFullYear(),r=new Date(i,2,1),h(i)&&t>=r&&n<r)},a=365,f===s||f+1===s&&(l>c||l===c&&u>=o))return(f===s&&h(f)||v(n,t)||c===1&&o===29)&&(a=366),e(n,t)/a;var y=s-f+1,p=(new Date(s+1,0,1)-new Date(f,0,1))/864e5,w=p/y;return e(n,t)/w;case 2:return e(n,t)/360;case 3:return e(n,t)/365;case 4:return(o+c*30+s*360-(u+l*30+f*360))/360}}},function(n,t,i){(function(r){var f,u;
/*!
 * numbro.js
 * version : 1.11.1
 * author : Företagsplatsen AB
 * license : MIT
 * http://www.foretagsplatsen.se
 */
(function(){"use strict";function g(n){this._value=n}function ut(n){return n===0?1:Math.floor(Math.log(Math.abs(n))/Math.LN10)+1}function l(n){for(var i="",t=0;t<n;t++)i+="0";return i}function ht(n,t){var e,u,f,r,o,s,h,i;return i=n.toString(),e=i.split("e")[0],r=i.split("e")[1],u=e.split(".")[0],f=e.split(".")[1]||"",+r>0?i=u+f+l(r-f.length):(o=+u<0?"-0":"0",t>0&&(o+="."),h=l(-1*r-1),s=(h+Math.abs(u)+f).substr(0,t),i=o+s),+r>0&&t>0&&(i+="."+l(t)),i}function v(n,t,i,r){var e=Math.pow(10,t),f,u;return n.toString().indexOf("e")>-1?(u=ht(n,t),u.charAt(0)==="-"&&+u>=0&&(u=u.substr(1))):u=(i(n+"e+"+t)/e).toFixed(t),r&&(f=new RegExp("0{1,"+r+"}$"),u=u.replace(f,"")),u}function ct(n,t,i){var r=t.replace(/\{[^\{\}]*\}/g,"");return r.indexOf("$")>-1?nt(n,o[s].currency.symbol,t,i):r.indexOf("%")>-1?vt(n,t,i):r.indexOf(":")>-1?yt(n,t):tt(n._value,t,i)}function lt(n,t){var u=t,e,h,c,l,r=!1,i,f;if(t.indexOf(":")>-1)n._value=pt(t);else if(t===a)n._value=0;else{for(o[s].delimiters.decimal!=="."&&(t=t.replace(/\./g,"").replace(o[s].delimiters.decimal,".")),e=new RegExp("[^a-zA-Z]"+o[s].abbreviations.thousand+"(?:\\)|(\\"+o[s].currency.symbol+")?(?:\\))?)?$"),h=new RegExp("[^a-zA-Z]"+o[s].abbreviations.million+"(?:\\)|(\\"+o[s].currency.symbol+")?(?:\\))?)?$"),c=new RegExp("[^a-zA-Z]"+o[s].abbreviations.billion+"(?:\\)|(\\"+o[s].currency.symbol+")?(?:\\))?)?$"),l=new RegExp("[^a-zA-Z]"+o[s].abbreviations.trillion+"(?:\\)|(\\"+o[s].currency.symbol+")?(?:\\))?)?$"),i=1;i<b.length&&!r;++i)t.indexOf(b[i])>-1?r=Math.pow(1024,i):t.indexOf(k[i])>-1&&(r=Math.pow(1e3,i));f=t.replace(/[^0-9\.]+/g,"");f===""?n._value=NaN:(n._value=(r?r:1)*(u.match(e)?Math.pow(10,3):1)*(u.match(h)?Math.pow(10,6):1)*(u.match(c)?Math.pow(10,9):1)*(u.match(l)?Math.pow(10,12):1)*(t.indexOf("%")>-1?.01:1)*((t.split("-").length+Math.min(t.split("(").length-1,t.split(")").length-1))%2?1:-1)*Number(f),n._value=r?Math.ceil(n._value):n._value)}return n._value}function nt(n,t,i,r){var f=i,c=f.indexOf("$"),a=f.indexOf("("),y=f.indexOf("+"),v=f.indexOf("-"),e="",l="",h,u;if(f.indexOf("$")===-1?o[s].currency.position==="infix"?(l=t,o[s].currency.spaceSeparated&&(l=" "+l+" ")):o[s].currency.spaceSeparated&&(e=" "):f.indexOf(" $")>-1?(e=" ",f=f.replace(" $","")):f.indexOf("$ ")>-1?(e=" ",f=f.replace("$ ","")):f=f.replace("$",""),u=tt(n._value,f,r,l),i.indexOf("$")===-1)switch(o[s].currency.position){case"postfix":u.indexOf(")")>-1?(u=u.split(""),u.splice(-1,0,e+t),u=u.join("")):u=u+e+t;break;case"infix":break;case"prefix":u.indexOf("(")>-1||u.indexOf("-")>-1?(u=u.split(""),h=Math.max(a,v)+1,u.splice(h,0,t+e),u=u.join("")):u=t+e+u;break;default:throw Error('Currency position should be among ["prefix", "infix", "postfix"]');}else c<=1?u.indexOf("(")>-1||u.indexOf("+")>-1||u.indexOf("-")>-1?(u=u.split(""),h=1,(c<a||c<y||c<v)&&(h=0),u.splice(h,0,t+e),u=u.join("")):u=t+e+u:u.indexOf(")")>-1?(u=u.split(""),u.splice(-1,0,e+t),u=u.join("")):u=u+e+t;return u}function at(n,t,i,r){return nt(n,t,i,r)}function vt(n,t,i){var u="",r,f=n._value*100;return t.indexOf(" %")>-1?(u=" ",t=t.replace(" %","")):t=t.replace("%",""),r=tt(f,t,i),r.indexOf(")")>-1?(r=r.split(""),r.splice(-1,0,u+"%"),r=r.join("")):r=r+u+"%",r}function yt(n){var i=Math.floor(n._value/3600),t=Math.floor((n._value-i*3600)/60),r=Math.round(n._value-i*3600-t*60);return i+":"+(t<10?"0"+t:t)+":"+(r<10?"0"+r:r)}function pt(n){var i=n.split(":"),t=0;return i.length===3?(t=t+Number(i[0])*3600,t=t+Number(i[1])*60,t=t+Number(i[2])):i.length===2&&(t=t+Number(i[0])*60,t=t+Number(i[1])),Number(t)}function y(n,t,i){var u=t[0],r,f,o,e=Math.abs(n);if(e>=i){for(r=1;r<t.length;++r)if(f=Math.pow(i,r),o=Math.pow(i,r+1),e>=f&&e<o){u=t[r];n=n/f;break}u===t[0]&&(n=n/Math.pow(i,t.length-1),u=t[t.length-1])}return{value:n,suffix:u}}function tt(n,t,i,r){var k=!1,gt=!1,ni=!1,f="",ht=!1,ct=!1,lt=!1,at=!1,nt=!1,d="",g,vt,tt="",c=Math.abs(n),ft,yt,rt,ti,u,p,e,pt,wt,ii,h="",bt=!1,w=!1,ri,ui,fi="",kt,et,ot,st,dt,b,ei;if(n===0&&a!==null)return a;if(!isFinite(n))return""+n;if(t.indexOf("{")===0){if(ot=t.indexOf("}"),ot===-1)throw Error('Format should also contain a "}"');pt=t.slice(1,ot);t=t.slice(ot+1)}else pt="";if(t.indexOf("}")===t.length-1&&t.length){if(st=t.indexOf("{"),st===-1)throw Error('Format should also contain a "{"');wt=t.slice(st+1,-1);t=t.slice(0,st+1)}else wt="";for(dt=t.indexOf(".")===-1?t.match(/([0-9]+).*/):t.match(/([0-9]+)\..*/),kt=dt===null?-1:dt[1].length,t.indexOf("-")!==-1&&(bt=!0),t.indexOf("(")>-1?(k=!0,t=t.slice(1,-1)):t.indexOf("+")>-1&&(gt=!0,t=t.replace(/\+/g,"")),t.indexOf("a")>-1&&(p=t.split(".")[0].match(/[0-9]+/g)||["0"],p=parseInt(p[0],10),ht=t.indexOf("aK")>=0,ct=t.indexOf("aM")>=0,lt=t.indexOf("aB")>=0,at=t.indexOf("aT")>=0,nt=ht||ct||lt||at,t.indexOf(" a")>-1?(f=" ",t=t.replace(" a","")):t=t.replace("a",""),ft=ut(n),rt=ft%3,rt=rt===0?3:rt,p&&c!==0&&(ti=3*~~((Math.min(p,ft)-rt)/3),c=c/Math.pow(10,ti)),ft!==p&&(c>=Math.pow(10,12)&&!nt||at?(f=f+o[s].abbreviations.trillion,n=n/Math.pow(10,12)):c<Math.pow(10,12)&&c>=Math.pow(10,9)&&!nt||lt?(f=f+o[s].abbreviations.billion,n=n/Math.pow(10,9)):c<Math.pow(10,9)&&c>=Math.pow(10,6)&&!nt||ct?(f=f+o[s].abbreviations.million,n=n/Math.pow(10,6)):(c<Math.pow(10,6)&&c>=Math.pow(10,3)&&!nt||ht)&&(f=f+o[s].abbreviations.thousand,n=n/Math.pow(10,3))),yt=ut(n),p&&yt<p&&t.indexOf(".")===-1&&(t+="[.]",t+=l(p-yt))),et=0;et<it.length;++et)if(g=it[et],t.indexOf(g.marker)>-1){t.indexOf(" "+g.marker)>-1&&(d=" ");t=t.replace(d+g.marker,"");vt=y(n,g.suffixes,g.scale);n=vt.value;d=d+vt.suffix;break}return t.indexOf("o")>-1&&(t.indexOf(" o")>-1?(tt=" ",t=t.replace(" o","")):t=t.replace("o",""),o[s].ordinal&&(tt=tt+o[s].ordinal(n))),t.indexOf("[.]")>-1&&(ni=!0,t=t.replace("[.]",".")),e=t.split(".")[1],ii=t.indexOf(","),e?(b=[],e.indexOf("*")!==-1?(h=n.toString(),b=h.split("."),b.length>1&&(h=v(n,b[1].length,i))):e.indexOf("[")>-1?(e=e.replace("]",""),e=e.split("["),h=v(n,e[0].length+e[1].length,i,e[1].length)):h=v(n,e.length,i),b=h.split("."),u=b[0],b.length>1&&b[1].length?(ei=r?f+r:o[s].delimiters.decimal,h=ei+b[1]):h="",ni&&Number(h.slice(1))===0&&(h="")):u=v(n,0,i),u.indexOf("-")>-1&&(u=u.slice(1),w=!0),u.length<kt&&(u=l(kt-u.length)+u),ii>-1&&(u=u.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+o[s].delimiters.thousands)),t.indexOf(".")===0&&(u=""),ri=t.indexOf("("),ui=t.indexOf("-"),fi=ri<ui?(k&&w?"(":"")+(bt&&w||!k&&w?"-":""):(bt&&w||!k&&w?"-":"")+(k&&w?"(":""),pt+fi+(!w&&gt&&n!==0?"+":"")+u+h+(tt?tt:"")+(f&&!r?f:"")+(d?d:"")+(k&&w?")":"")+wt}function ft(n,t){o[n]=t}function p(n){s=n;var t=o[n].defaults;t&&t.format&&e.defaultFormat(t.format);t&&t.currencyFormat&&e.defaultCurrencyFormat(t.currencyFormat)}function wt(){return typeof r!="undefined"&&r.browser===undefined&&r.title&&(r.title.indexOf("node")!==-1||r.title.indexOf("meteor-tool")>0||r.title==="grunt"||r.title==="gulp")&&!0}function et(n){var t=n.toString().split(".");return t.length<2?1:Math.pow(10,t[1].length)}function w(){var n=Array.prototype.slice.call(arguments);return n.reduce(function(n,t){var i=et(n),r=et(t);return i>r?i:r},-Infinity)}var e,b=["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],k=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],h={general:{scale:1024,suffixes:k,marker:"bd"},binary:{scale:1024,suffixes:b,marker:"b"},decimal:{scale:1e3,suffixes:k,marker:"d"}},it=[h.general,h.binary,h.decimal],o={},c=o,s="en-US",a=null,rt="0,0",d="0$",ot=typeof n!="undefined"&&n.exports,st={delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(n){var t=n%10;return~~(n%100/10)==1?"th":t===1?"st":t===2?"nd":t===3?"rd":"th"},currency:{symbol:"$",position:"prefix"},defaults:{currencyFormat:",0000 a"},formats:{fourDigits:"0000 a",fullWithTwoDecimals:"$ ,0.00",fullWithTwoDecimalsNoCurrency:",0.00"}};e=function(n){return n=e.isNumbro(n)?n.value():typeof n=="string"||typeof n=="number"?e.fn.unformat(n):NaN,new g(Number(n))};e.version="1.11.1";e.isNumbro=function(n){return n instanceof g};e.setLanguage=function(n,t){console.warn("`setLanguage` is deprecated since version 1.6.0. Use `setCulture` instead");var i=n,u=n.split("-")[0],r=null;c[i]||(Object.keys(c).forEach(function(n){r||n.split("-")[0]!==u||(r=n)}),i=r||t||"en-US");p(i)};e.setCulture=function(n,t){var i=n,u=n.split("-")[1],r=null;o[i]||(u&&Object.keys(o).forEach(function(n){r||n.split("-")[1]!==u||(r=n)}),i=r||t||"en-US");p(i)};e.language=function(n,t){if(console.warn("`language` is deprecated since version 1.6.0. Use `culture` instead"),!n)return s;if(n&&!t){if(!c[n])throw new Error("Unknown language : "+n);p(n)}return(t||!c[n])&&ft(n,t),e};e.culture=function(n,t){if(!n)return s;if(n&&!t){if(!o[n])throw new Error("Unknown culture : "+n);p(n)}return(t||!o[n])&&ft(n,t),e};e.languageData=function(n){if(console.warn("`languageData` is deprecated since version 1.6.0. Use `cultureData` instead"),!n)return c[s];if(!c[n])throw new Error("Unknown language : "+n);return c[n]};e.cultureData=function(n){if(!n)return o[s];if(!o[n])throw new Error("Unknown culture : "+n);return o[n]};e.culture("en-US",st);e.languages=function(){return console.warn("`languages` is deprecated since version 1.6.0. Use `cultures` instead"),c};e.cultures=function(){return o};e.zeroFormat=function(n){a=typeof n=="string"?n:null};e.defaultFormat=function(n){rt=typeof n=="string"?n:"0.0"};e.defaultCurrencyFormat=function(n){d=typeof n=="string"?n:"0$"};e.validate=function(n,t){var s,h,c,i,f,o,u,r;if(typeof n!="string"&&(n+="",console.warn&&console.warn("Numbro.js: Value is not string. It has been co-erced to: ",n)),n=n.trim(),n=n.replace(/^[+-]?/,""),!!n.match(/^\d+$/))return!0;if(n==="")return!1;try{u=e.cultureData(t)}catch(l){u=e.cultureData(e.culture())}return(c=u.currency.symbol,f=u.abbreviations,s=u.delimiters.decimal,h=u.delimiters.thousands==="."?"\\.":u.delimiters.thousands,r=n.match(/^[^\d\.\,]+/),r!==null&&(n=n.substr(1),r[0]!==c))?!1:(r=n.match(/[^\d]+$/),r!==null&&(n=n.slice(0,-1),r[0]!==f.thousand&&r[0]!==f.million&&r[0]!==f.billion&&r[0]!==f.trillion))?!1:(o=new RegExp(h+"{2}"),!n.match(/[^\d.,]/g))?(i=n.split(s),i.length>2?!1:i.length<2?!!i[0].match(/^\d+.*\d$/)&&!i[0].match(o):i[0]===""?!i[0].match(o)&&!!i[1].match(/^\d+$/):i[0].length===1?!!i[0].match(/^\d+$/)&&!i[0].match(o)&&!!i[1].match(/^\d+$/):!!i[0].match(/^\d+.*\d$/)&&!i[0].match(o)&&!!i[1].match(/^\d+$/)):!1};e.loadLanguagesInNode=function(){console.warn("`loadLanguagesInNode` is deprecated since version 1.6.0. Use `loadCulturesInNode` instead");e.loadCulturesInNode()};e.loadCulturesInNode=function(){var t=i(27);for(var n in t)n&&e.culture(n,t[n])};"function"!=typeof Array.prototype.reduce&&(Array.prototype.reduce=function(n,t){if(null===this||"undefined"==typeof this)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!=typeof n)throw new TypeError(n+" is not a function");var i,r,f=this.length>>>0,u=!1;for(1<arguments.length&&(r=t,u=!0),i=0;f>i;++i)this.hasOwnProperty(i)&&(u?r=n(r,this[i],i,this):(r=this[i],u=!0));if(!u)throw new TypeError("Reduce of empty array with no initial value");return r});e.fn=g.prototype={clone:function(){return e(this)},format:function(n,t){return ct(this,n?n:rt,t!==undefined?t:Math.round)},formatCurrency:function(n,t){return nt(this,o[s].currency.symbol,n?n:d,t!==undefined?t:Math.round)},formatForeignCurrency:function(n,t,i){return at(this,n,t?t:d,i!==undefined?i:Math.round)},unformat:function(n){if(typeof n=="number")return n;if(typeof n=="string"){var t=lt(this,n);return isNaN(t)?undefined:t}return undefined},binaryByteUnits:function(){return y(this._value,h.binary.suffixes,h.binary.scale).suffix},byteUnits:function(){return y(this._value,h.general.suffixes,h.general.scale).suffix},decimalByteUnits:function(){return y(this._value,h.decimal.suffixes,h.decimal.scale).suffix},value:function(){return this._value},valueOf:function(){return this._value},set:function(n){return this._value=Number(n),this},add:function(n){function i(n,i){return n+t*i}var t=w.call(null,this._value,n);return this._value=[this._value,n].reduce(i,0)/t,this},subtract:function(n){function i(n,i){return n-t*i}var t=w.call(null,this._value,n);return this._value=[n].reduce(i,this._value*t)/t,this},multiply:function(n){function t(n,t){var i=w(n,t),r=n*i;return r*=t*i,r/(i*i)}return this._value=[this._value,n].reduce(t,1),this},divide:function(n){function t(n,t){var i=w(n,t);return n*i/(t*i)}return this._value=[this._value,n].reduce(t),this},difference:function(n){return Math.abs(e(this._value).subtract(n).value())}};wt()&&e.loadCulturesInNode();ot?n.exports=e:(typeof ender=="undefined"&&(this.numbro=e),!0&&!(f=[],u=function(){return e}.apply(t,f),u!==undefined&&(n.exports=u)))}).call(typeof window=="undefined"?this:window)}).call(t,i(10))},function(n){function h(){throw new Error("setTimeout has not been defined");}function c(){throw new Error("clearTimeout has not been defined");}function l(n){if(i===setTimeout)return setTimeout(n,0);if((i===h||!i)&&setTimeout)return i=setTimeout,setTimeout(n,0);try{return i(n,0)}catch(t){try{return i.call(null,n,0)}catch(t){return i.call(this,n,0)}}}function y(n){if(r===clearTimeout)return clearTimeout(n);if((r===c||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(n);try{return r(n)}catch(t){try{return r.call(null,n)}catch(t){return r.call(this,n)}}}function p(){o&&e&&(o=!1,e.length?u=e.concat(u):s=-1,u.length&&a())}function a(){var t,n;if(!o){for(t=l(p),o=!0,n=u.length;n;){for(e=u,u=[];++s<n;)e&&e[s].run();s=-1;n=u.length}e=null;o=!1;y(t)}}function v(n,t){this.fun=n;this.array=t}function f(){}var t=n.exports={},i,r;(function(){try{i=typeof setTimeout=="function"?setTimeout:h}catch(n){i=h}try{r=typeof clearTimeout=="function"?clearTimeout:c}catch(n){r=c}})();var u=[],o=!1,e,s=-1;t.nextTick=function(n){var i=new Array(arguments.length-1),t;if(arguments.length>1)for(t=1;t<arguments.length;t++)i[t-1]=arguments[t];u.push(new v(n,i));u.length!==1||o||l(a)};v.prototype.run=function(){this.fun.apply(null,this.array)};t.title="browser";t.browser=!0;t.env={};t.argv=[];t.version="";t.versions={};t.on=f;t.addListener=f;t.once=f;t.off=f;t.removeListener=f;t.removeAllListeners=f;t.emit=f;t.prependListener=f;t.prependOnceListener=f;t.listeners=function(){return[]};t.binding=function(){throw new Error("process.binding is not supported");};t.cwd=function(){return"/"};t.chdir=function(){throw new Error("process.chdir is not supported");};t.umask=function(){return 0}},function(n){(function(t,i){n.exports=i()})(this,function(){var n=function(n,t){function c(t,i){var r=t>i?t:i;return n.pow(10,17-~~(n.log(r>0?r:-r)*n.LOG10E))}function o(n){return h.call(n)==="[object Function]"}function f(n){return typeof n=="number"&&n===n}function v(n){return a.apply([],n)}function r(){return new r._init(arguments)}function l(){return 0}function y(){return 1}function p(n,t){return n===t?1:0}var a=Array.prototype.concat,s=Array.prototype.slice,h=Object.prototype.toString,e=Array.isArray||function(n){return h.call(n)==="[object Array]"},u;return r.fn=r.prototype,r._init=function(n){var t;if(e(n[0]))if(e(n[0][0])){for(o(n[1])&&(n[0]=r.map(n[0],n[1])),t=0;t<n[0].length;t++)this[t]=n[0][t];this.length=n[0].length}else this[0]=o(n[1])?r.map(n[0],n[1]):n[0],this.length=1;else if(f(n[0]))this[0]=r.seq.apply(null,n),this.length=1;else{if(n[0]instanceof r)return r(n[0].toArray());this[0]=[];this.length=1}return this},r._init.prototype=r.prototype,r._init.constructor=r,r.utils={calcRdx:c,isArray:e,isFunction:o,isNumber:f,toVector:v},r.extend=function(n){var t,i;if(arguments.length===1){for(t in n)r[t]=n[t];return this}for(i=1;i<arguments.length;i++)for(t in arguments[i])n[t]=arguments[i][t];return n},r.rows=function(n){return n.length||1},r.cols=function(n){return n[0].length||1},r.dimensions=function(n){return{rows:r.rows(n),cols:r.cols(n)}},r.row=function(n,t){return e(t)?t.map(function(t){return r.row(n,t)}):n[t]},r.rowa=function(n,t){return r.row(n,t)},r.col=function(n,t){var u,f,i;if(e(t))return u=r.arange(n.length).map(function(){return new Array(t.length)}),t.forEach(function(t,i){r.arange(n.length).forEach(function(r){u[r][i]=n[r][t]})}),u;for(f=new Array(n.length),i=0;i<n.length;i++)f[i]=[n[i][t]];return f},r.cola=function(n,t){return r.col(n,t).map(function(n){return n[0]})},r.diag=function(n){for(var i=r.rows(n),u=new Array(i),t=0;t<i;t++)u[t]=[n[t][t]];return u},r.antidiag=function(n){for(var t=r.rows(n)-1,u=new Array(t),i=0;t>=0;t--,i++)u[i]=[n[i][t]];return u},r.transpose=function(n){var i=[],u,f,o,t,r;for(e(n[0])||(n=[n]),f=n.length,o=n[0].length,r=0;r<o;r++){for(u=new Array(f),t=0;t<f;t++)u[t]=n[t][r];i.push(u)}return i.length===1?i[0]:i},r.map=function(n,t,i){var r,o,s,u,f;for(e(n[0])||(n=[n]),o=n.length,s=n[0].length,u=i?n:new Array(o),r=0;r<o;r++)for(u[r]||(u[r]=new Array(s)),f=0;f<s;f++)u[r][f]=t(n[r][f],r,f);return u.length===1?u[0]:u},r.cumreduce=function(n,t,i){var r,s,o,u,f;for(e(n[0])||(n=[n]),s=n.length,o=n[0].length,u=i?n:new Array(s),r=0;r<s;r++)for(u[r]||(u[r]=new Array(o)),o>0&&(u[r][0]=n[r][0]),f=1;f<o;f++)u[r][f]=t(u[r][f-1],n[r][f]);return u.length===1?u[0]:u},r.alter=function(n,t){return r.map(n,t,!0)},r.create=function(n,t,i){var f=new Array(n),u,r;for(o(t)&&(i=t,t=n),r=0;r<n;r++)for(f[r]=new Array(t),u=0;u<t;u++)f[r][u]=i(r,u);return f},r.zeros=function(n,t){return f(t)||(t=n),r.create(n,t,l)},r.ones=function(n,t){return f(t)||(t=n),r.create(n,t,y)},r.rand=function(t,i){return f(i)||(i=t),r.create(t,i,n.random)},r.identity=function(n,t){return f(t)||(t=n),r.create(n,t,p)},r.symmetric=function(n){var r=n.length,t,i;if(n.length!==n[0].length)return!1;for(t=0;t<r;t++)for(i=0;i<r;i++)if(n[i][t]!==n[t][i])return!1;return!0},r.clear=function(n){return r.alter(n,l)},r.seq=function(n,t,i,r){o(r)||(r=!1);for(var s=[],u=c(n,t),h=(t*u-n*u)/((i-1)*u),e=n,f=0;e<=t&&f<i;f++,e=(n*u+h*u*f)/u)s.push(r?r(e,f):e);return s},r.arange=function(n,r,u){var f=[];if(u=u||1,r===t&&(r=n,n=0),n===r||u===0)return[];if(n<r&&u<0)return[];if(n>r&&u>0)return[];if(u>0)for(i=n;i<r;i+=u)f.push(i);else for(i=n;i>r;i+=u)f.push(i);return f},r.slice=function(){function n(n,i,u,f){var e,o=[],s=n.length;if(i===t&&u===t&&f===t)return r.copy(n);if(i=i||0,u=u||n.length,i=i>=0?i:s+i,u=u>=0?u:s+u,f=f||1,i===u||f===0)return[];if(i<u&&f<0)return[];if(i>u&&f>0)return[];if(f>0)for(e=i;e<u;e+=f)o.push(n[e]);else for(e=i;e>u;e+=f)o.push(n[e]);return o}function i(t,i){var o,u,s,e;if(i=i||{},f(i.row))return f(i.col)?t[i.row][i.col]:(o=r.rowa(t,i.row),u=i.col||{},n(o,u.start,u.end,u.step));if(f(i.col))return s=r.cola(t,i.col),e=i.row||{},n(s,e.start,e.end,e.step);var e=i.row||{},u=i.col||{},h=n(t,e.start,e.end,e.step);return h.map(function(t){return n(t,u.start,u.end,u.step)})}return i}(),r.sliceAssign=function(i,u,e){var h,c,s,o;return f(u.row)?f(u.col)?i[u.row][u.col]=e:(u.col=u.col||{},u.col.start=u.col.start||0,u.col.end=u.col.end||i[0].length,u.col.step=u.col.step||1,o=r.arange(u.col.start,n.min(i.length,u.col.end),u.col.step),h=u.row,o.forEach(function(n,t){i[h][n]=e[t]}),i):f(u.col)?(u.row=u.row||{},u.row.start=u.row.start||0,u.row.end=u.row.end||i.length,u.row.step=u.row.step||1,s=r.arange(u.row.start,n.min(i[0].length,u.row.end),u.row.step),c=u.col,s.forEach(function(n,t){i[n][c]=e[t]}),i):(e[0].length===t&&(e=[e]),u.row.start=u.row.start||0,u.row.end=u.row.end||i.length,u.row.step=u.row.step||1,u.col.start=u.col.start||0,u.col.end=u.col.end||i[0].length,u.col.step=u.col.step||1,s=r.arange(u.row.start,n.min(i.length,u.row.end),u.row.step),o=r.arange(u.col.start,n.min(i[0].length,u.col.end),u.col.step),s.forEach(function(n,t){o.forEach(function(r,u){i[n][r]=e[t][u]})}),i)},r.diagonal=function(n){var t=r.zeros(n.length,n.length);return n.forEach(function(n,i){t[i][i]=n}),t},r.copy=function(n){return n.map(function(n){return f(n)?n:n.map(function(n){return n})})},u=r.prototype,u.length=0,u.push=Array.prototype.push,u.sort=Array.prototype.sort,u.splice=Array.prototype.splice,u.slice=Array.prototype.slice,u.toArray=function(){return this.length>1?s.call(this):s.call(this)[0]},u.map=function(n,t){return r(r.map(this,n,t))},u.cumreduce=function(n,t){return r(r.cumreduce(this,n,t))},u.alter=function(n){return r.alter(this,n),this},function(n){for(var t=0;t<n.length;t++)(function(n){u[n]=function(t){var f=this,i;return t?(setTimeout(function(){t.call(f,u[n].call(f))}),this):(i=r[n](this),e(i)?r(i):i)}})(n[t])}("transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),function(n){for(var t=0;t<n.length;t++)(function(n){u[n]=function(t,i){var f=this;return i?(setTimeout(function(){i.call(f,u[n].call(f,t))}),this):r(r[n](this,t))}})(n[t])}("row col".split(" ")),function(n){for(var t=0;t<n.length;t++)(function(n){u[n]=new Function("return jStat(jStat."+n+".apply(null, arguments));")})(n[t])}("create zeros ones rand identity".split(" ")),r}(Math);return function(n,t){function r(n,t){return n-t}function f(n,i,r){return t.max(i,t.min(n,r))}var u=n.utils.isFunction,i;n.sum=function(n){for(var t=0,i=n.length;--i>=0;)t+=n[i];return t};n.sumsqrd=function(n){for(var i=0,t=n.length;--t>=0;)i+=n[t]*n[t];return i};n.sumsqerr=function(t){for(var f=n.mean(t),r=0,u=t.length,i;--u>=0;)i=t[u]-f,r+=i*i;return r};n.sumrow=function(n){for(var t=0,i=n.length;--i>=0;)t+=n[i];return t};n.product=function(n){for(var t=1,i=n.length;--i>=0;)t*=n[i];return t};n.min=function(n){for(var t=n[0],i=0;++i<n.length;)n[i]<t&&(t=n[i]);return t};n.max=function(n){for(var t=n[0],i=0;++i<n.length;)n[i]>t&&(t=n[i]);return t};n.unique=function(n){for(var i={},r=[],t=0;t<n.length;t++)i[n[t]]||(i[n[t]]=!0,r.push(n[t]));return r};n.mean=function(t){return n.sum(t)/t.length};n.meansqerr=function(t){return n.sumsqerr(t)/t.length};n.geomean=function(i){return t.pow(n.product(i),1/i.length)};n.median=function(n){var t=n.length,i=n.slice().sort(r);return(t&1)?i[t/2|0]:(i[t/2-1]+i[t/2])/2};n.cumsum=function(t){return n.cumreduce(t,function(n,t){return n+t})};n.cumprod=function(t){return n.cumreduce(t,function(n,t){return n*t})};n.diff=function(n){for(var i=[],r=n.length,t=1;t<r;t++)i.push(n[t]-n[t-1]);return i};n.rank=function(n){for(var i,u,s,f=n.length,e=n.slice().sort(r),o=new Array(f),t=0;t<f;t++)i=e.indexOf(n[t]),u=e.lastIndexOf(n[t]),s=i===u?i:(i+u)/2,o[t]=s+1;return o};n.mode=function(n){for(var s=n.length,u=n.slice().sort(r),i=1,e=0,o=0,f=[],t=0;t<s;t++)u[t]===u[t+1]?i++:(i>e?(f=[u[t]],e=i,o=0):i===e&&(f.push(u[t]),o++),i=1);return o===0?f[0]:f};n.range=function(t){return n.max(t)-n.min(t)};n.variance=function(t,i){return n.sumsqerr(t)/(t.length-(i?1:0))};n.pooledvariance=function(t){var i=t.reduce(function(t,i){return t+n.sumsqerr(i)},0),r=t.reduce(function(n,t){return n+t.length},0);return i/(r-t.length)};n.deviation=function(t){for(var f=n.mean(t),r=t.length,u=new Array(r),i=0;i<r;i++)u[i]=t[i]-f;return u};n.stdev=function(i,r){return t.sqrt(n.variance(i,r))};n.pooledstdev=function(i){return t.sqrt(n.pooledvariance(i))};n.meandev=function(i){for(var f=n.mean(i),u=[],r=i.length-1;r>=0;r--)u.push(t.abs(i[r]-f));return n.mean(u)};n.meddev=function(i){for(var f=n.median(i),u=[],r=i.length-1;r>=0;r--)u.push(t.abs(i[r]-f));return n.median(u)};n.coeffvar=function(t){return n.stdev(t)/n.mean(t)};n.quartiles=function(n){var i=n.length,u=n.slice().sort(r);return[u[t.round(i/4)-1],u[t.round(i/2)-1],u[t.round(i*3/4)-1]]};n.quantiles=function(n,i,u,e){var a=n.slice().sort(r),v=[i.length],y=n.length,h,p,c,s,l,o;for(typeof u=="undefined"&&(u=3/8),typeof e=="undefined"&&(e=3/8),o=0;o<i.length;o++)h=i[o],p=u+h*(1-u-e),c=y*h+p,s=t.floor(f(c,1,y-1)),l=f(c-s,0,1),v[o]=(1-l)*a[s-1]+l*a[s];return v};n.percentile=function(n,t){var i=n.slice().sort(r),f=t*(i.length-1),u=parseInt(f),e=f-u;return u+1<i.length?i[u]*(1-e)+i[u+1]*e:i[u]};n.percentileOfScore=function(n,t,i){var e=0,o=n.length,u=!1,f,r;for(i==="strict"&&(u=!0),r=0;r<o;r++)f=n[r],(u&&f<t||!u&&f<=t)&&e++;return e/o};n.histogram=function(i,r){for(var e=n.min(i),f=r||4,o=(n.max(i)-e)/f,s=i.length,r=[],u=0;u<f;u++)r[u]=0;for(u=0;u<s;u++)r[t.min(t.floor((i[u]-e)/o),f-1)]+=1;return r};n.covariance=function(t,i){for(var e=n.mean(t),o=n.mean(i),u=t.length,f=new Array(u),r=0;r<u;r++)f[r]=(t[r]-e)*(i[r]-o);return n.sum(f)/(u-1)};n.corrcoeff=function(t,i){return n.covariance(t,i)/n.stdev(t,1)/n.stdev(i,1)};n.spearmancoeff=function(t,i){return t=n.rank(t),i=n.rank(i),n.corrcoeff(t,i)};n.stanMoment=function(i,r){for(var e=n.mean(i),o=n.stdev(i),s=i.length,f=0,u=0;u<s;u++)f+=t.pow((i[u]-e)/o,r);return f/i.length};n.skewness=function(t){return n.stanMoment(t,3)};n.kurtosis=function(t){return n.stanMoment(t,4)-3};i=n.prototype,function(t){for(var r=0;r<t.length;r++)(function(t){i[t]=function(r,f){var s=[],o=0,e=this;if(u(r)&&(f=r,r=!1),f)return setTimeout(function(){f.call(e,i[t].call(e,r))}),this;if(this.length>1){for(e=r===!0?this:this.transpose();o<e.length;o++)s[o]=n[t](e[o]);return s}return n[t](this[0],r)}})(t[r])}("cumsum cumprod".split(" ")),function(t){for(var r=0;r<t.length;r++)(function(t){i[t]=function(r,f){var s=[],o=0,e=this;if(u(r)&&(f=r,r=!1),f)return setTimeout(function(){f.call(e,i[t].call(e,r))}),this;if(this.length>1){for(t!=="sumrow"&&(e=r===!0?this:this.transpose());o<e.length;o++)s[o]=n[t](e[o]);return r===!0?n[t](n.utils.toVector(s)):s}return n[t](this[0],r)}})(t[r])}("sum sumsqrd sumsqerr sumrow product min max unique mean meansqerr geomean median diff rank mode range variance deviation stdev meandev meddev coeffvar quartiles histogram skewness kurtosis".split(" ")),function(t){for(var r=0;r<t.length;r++)(function(t){i[t]=function(){var h=[],e=0,r=this,f=Array.prototype.slice.call(arguments),c,o,s;if(u(f[f.length-1]))return o=f[f.length-1],c=f.slice(0,f.length-1),setTimeout(function(){o.call(r,i[t].apply(r,c))}),this;if(o=undefined,s=function(i){return n[t].apply(r,[i].concat(f))},this.length>1){for(r=r.transpose();e<r.length;e++)h[e]=s(r[e]);return h}return s(this[0])}})(t[r])}("quantiles percentileOfScore".split(" "))}(n,Math),function(n,t){n.gammaln=function(n){var r=0,o=[76.180091729471457,-86.505320329416776,24.014098240830911,-1.231739572450155,.001208650973866179,-5395239384953e-18],f=1.0000000001900149,u,e,i;for(i=(e=u=n)+5.5,i-=(u+.5)*t.log(i);r<6;r++)f+=o[r]/++e;return t.log(2.5066282746310007*f/u)-i};n.gammafn=function(n){var l=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.96620279041326,-31451.272968848367,-36144.413418691176,66456.143820240541],a=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.7716715723109,22538.11842098015,4755.8462775278813,-134659.95986496931,-115132.25967555351],e=!1,c=0,o=0,s=0,i=n,h,f,r,u;if(i<=0)if(r=i%1+36e-17,r)e=((i&1)?-1:1)*t.PI/t.sin(t.PI*r),i=1-i;else return Infinity;for(f=i,h=i<1?i++:(i-=c=(i|0)-1)-1,u=0;u<8;++u)s=(s+l[u])*h,o=o*h+a[u];if(r=s/o+1,f<i)r/=f;else if(f>i)for(u=0;u<c;++u)r*=i,i++;return e&&(r=e/r),r};n.gammap=function(t,i){return n.lowRegGamma(t,i)*n.gammafn(t)};n.lowRegGamma=function(i,r){var c=n.gammaln(i),v=i,o=1/i,y=o,e=r+1-i,s=1/1e-30,u=1/e,l=u,f=1,a=-~(t.log(i>=1?i:1/i)*8.5+i*.4+17),h;if(r<0||i<=0)return NaN;if(r<i+1){for(;f<=a;f++)o+=y*=r/++v;return o*t.exp(-r+i*t.log(r)-c)}for(;f<=a;f++)h=-f*(f-i),e+=2,u=h*u+e,s=e+h/s,u=1/u,l*=u*s;return 1-l*t.exp(-r+i*t.log(r)-c)};n.factorialln=function(t){return t<0?NaN:n.gammaln(t+1)};n.factorial=function(t){return t<0?NaN:n.gammafn(t+1)};n.combination=function(i,r){return i>170||r>170?t.exp(n.combinationln(i,r)):n.factorial(i)/n.factorial(r)/n.factorial(i-r)};n.combinationln=function(t,i){return n.factorialln(t)-n.factorialln(i)-n.factorialln(t-i)};n.permutation=function(t,i){return n.factorial(t)/n.factorial(t-i)};n.betafn=function(i,r){return i<=0||r<=0?undefined:i+r>170?t.exp(n.betaln(i,r)):n.gammafn(i)*n.gammafn(r)/n.gammafn(i+r)};n.betaln=function(t,i){return n.gammaln(t)+n.gammaln(i)-n.gammaln(t+i)};n.betacf=function(n,i,r){var f=1e-30,o=1,a=i+r,v=i+1,y=i-1,e=1,u=1-a*n/v,h,s,l,c;for(t.abs(u)<f&&(u=f),u=1/u,c=u;o<=100;o++)if(h=2*o,s=o*(r-o)*n/((y+h)*(i+h)),u=1+s*u,t.abs(u)<f&&(u=f),e=1+s/e,t.abs(e)<f&&(e=f),u=1/u,c*=u*e,s=-(i+o)*(a+o)*n/((i+h)*(v+h)),u=1+s*u,t.abs(u)<f&&(u=f),e=1+s/e,t.abs(e)<f&&(e=f),u=1/u,l=u*e,c*=l,t.abs(l-1)<3e-7)break;return c};n.gammapinv=function(i,r){var h=0,e=r-1,c=n.gammaln(r),u,l,f,o,a,s,v;if(i>=1)return t.max(100,r+100*t.sqrt(r));if(i<=0)return 0;for(r>1?(s=t.log(e),v=t.exp(e*(s-1)-c),a=i<.5?i:1-i,f=t.sqrt(-2*t.log(a)),u=(2.30753+f*.27061)/(1+f*(.99229+f*.04481))-f,i<.5&&(u=-u),u=t.max(.001,r*t.pow(1-1/(9*r)-u/(3*t.sqrt(r)),3))):(f=1-r*(.253+r*.12),u=i<f?t.pow(i/f,1/r):1-t.log(1-(i-f)/(1-f)));h<12;h++){if(u<=0)return 0;if(l=n.lowRegGamma(r,u)-i,f=r>1?v*t.exp(-(u-e)+e*(t.log(u)-s)):t.exp(-u+e*t.log(u)-c),o=l/f,u-=f=o/(1-.5*t.min(1,o*((r-1)/u-1))),u<=0&&(u=.5*(u+f)),t.abs(f)<1e-8*u)break}return u};n.erf=function(n){var r=[-1.3026537197817094,.64196979235649021,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,15626441722e-18,-85238095915e-18,6529054439e-18,5059343495e-18,-991364156e-18,-227365122e-18,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18],u=r.length-1,h=!1,i=0,f=0,e,o,c,s;for(n<0&&(n=-n,h=!0),e=2/(2+n),o=4*e-2;u>0;u--)c=i,i=o*i-f+r[u],f=c;return s=e*t.exp(-n*n+.5*(r[0]+o*i)-f),h?s-1:1-s};n.erfc=function(t){return 1-n.erf(t)};n.erfcinv=function(i){var o=0,r,f,u,e;if(i>=2)return-100;if(i<=0)return 100;for(e=i<1?i:2-i,u=t.sqrt(-2*t.log(e/2)),r=-.70711*((2.30753+u*.27061)/(1+u*(.99229+u*.04481))-u);o<2;o++)f=n.erfc(r)-e,r+=f/(1.1283791670955126*t.exp(-r*r)-r*f);return i<1?r:-r};n.ibetainv=function(i,r,u){var a=r-1,v=u-1,c=0,y,p,w,e,s,b,f,l,h,o,k;if(i<=0)return 0;if(i>=1)return 1;for(r>=1&&u>=1?(w=i<.5?i:1-i,e=t.sqrt(-2*t.log(w)),f=(2.30753+e*.27061)/(1+e*(.99229+e*.04481))-e,i<.5&&(f=-f),l=(f*f-3)/6,h=2/(1/(2*r-1)+1/(2*u-1)),o=f*t.sqrt(l+h)/h-(1/(2*u-1)-1/(2*r-1))*(l+5/6-2/(3*h)),f=r/(r+u*t.exp(2*o))):(y=t.log(r/(r+u)),p=t.log(u/(r+u)),e=t.exp(r*y)/r,s=t.exp(u*p)/u,o=e+s,f=i<e/o?t.pow(r*o*i,1/r):1-t.pow(u*o*(1-i),1/u)),k=-n.gammaln(r)-n.gammaln(u)+n.gammaln(r+u);c<10;c++){if(f===0||f===1)return f;if(b=n.ibeta(f,r,u)-i,e=t.exp(a*t.log(f)+v*t.log(1-f)+k),s=b/e,f-=e=s/(1-.5*t.min(1,s*(a/f-v/(1-f)))),f<=0&&(f=.5*(f+e)),f>=1&&(f=.5*(f+e+1)),t.abs(e)<1e-8*f&&c>0)break}return f};n.ibeta=function(i,r,u){var f=i===0||i===1?0:t.exp(n.gammaln(r+u)-n.gammaln(r)-n.gammaln(u)+r*t.log(i)+u*t.log(1-i));return i<0||i>1?!1:i<(r+1)/(r+u+2)?f*n.betacf(i,r,u)/r:1-f*n.betacf(1-i,u,r)/u};n.randn=function(i,r){var u,f,e,o,s;if(r||(r=i),i)return n.create(i,r,function(){return n.randn()});do u=t.random(),f=1.7156*(t.random()-.5),e=u-.449871,o=t.abs(f)+.386595,s=e*e+o*(.196*o-.25472*e);while(s>.27597&&(s>.27846||f*f>-4*t.log(u)*u*u));return f/u};n.randg=function(i,r,u){var c=i,o,l,e,f,s,h;if(u||(u=r),i||(i=1),r)return h=n.zeros(r,u),h.alter(function(){return n.randg(i)}),h;i<1&&(i+=1);o=i-1/3;l=1/t.sqrt(9*o);do{do s=n.randn(),f=1+l*s;while(f<=0);f=f*f*f;e=t.random()}while(e>1-.331*t.pow(s,4)&&t.log(e)>.5*s*s+o*(1-f+t.log(f)));if(i==c)return o*f;do e=t.random();while(e===0);return t.pow(e,1/c)*o*f},function(t){for(var i=0;i<t.length;i++)(function(t){n.fn[t]=function(){return n(n.map(this,function(i){return n[t](i)}))}})(t[i])}("gammaln gammafn factorial factorialln".split(" ")),function(t){for(var i=0;i<t.length;i++)(function(t){n.fn[t]=function(){return n(n[t].apply(null,arguments))}})(t[i])}("randn".split(" "))}(n,Math),function(n,t){function r(n){return n/t.abs(n)}function i(i,r,u){var b=12,k=-30,d=8,g=[.98156063424671924,.90411725637047491,.76990267419430469,.58731795428661748,.36783149899818018,.12523340851146891],ft=[.047175336386511828,.10693932599531843,.16007832854334622,.20316742672306593,.23349253653835481,.24914704581340277],s=i*.5,f,v,y,e,o,w;if(s>=d)return 1;f=2*n.normal.cdf(s,0,1,1,0)-1;f=f>=t.exp(-50/u)?t.pow(f,u):0;v=i>3?2:3;var h=s,nt=(d-s)/v,c=h+nt,tt=0,it=u-1;for(y=1;y<=v;y++){var p=0,et=.5*(c+h),rt=.5*(c-h);for(e=1;e<=b;e++){6<e?(o=b-e+1,w=g[o-1]):(o=e,w=-g[o-1]);var ot=rt*w,l=et+ot,ut=l*l;if(ut>60)break;var st=2*n.normal.cdf(l,0,1,1,0),ht=2*n.normal.cdf(l,i,1,1,0),a=st*.5-ht*.5;a>=t.exp(k/it)&&(a=ft[o-1]*t.exp(-(.5*ut))*t.pow(a,it),p+=a)}p*=2*rt*u/t.sqrt(2*t.PI);tt+=p;h=c;c+=nt}return(f+=tt,f<=t.exp(k/r))?0:(f=t.pow(f,r),f>=1)?1:f}function u(n,i,r){var o=120,s=.5-.5*n,u=t.sqrt(t.log(1/(s*s))),f=u+((((u*-453642210148e-16+-.204231210125)*u+-.342242088547)*u+-1)*u+.322232421088)/((((u*.0038560700634+.10353775285)*u+.531103462366)*u+.588581570495)*u+.099348462606),e;return r<o&&(f+=(f*f*f+f)/r/4),e=.8832-.2368*f,r<o&&(e+=-1.214/r+1.208*f/r),f*(e*t.log(i-1)+1.4142)}(function(t){for(var i=0;i<t.length;i++)(function(t){n[t]=function(n,t,i){return(this instanceof arguments.callee)?(this._a=n,this._b=t,this._c=i,this):new arguments.callee(n,t,i)};n.fn[t]=function(i,r,u){var f=n[t](i,r,u);return f.data=this,f};n[t].prototype.sample=function(i){var r=this._a,u=this._b,f=this._c;return i?n.alter(i,function(){return n[t].sample(r,u,f)}):n[t].sample(r,u,f)},function(i){for(var r=0;r<i.length;r++)(function(i){n[t].prototype[i]=function(r){var u=this._a,f=this._b,e=this._c;return(r||r===0||(r=this.data),typeof r!="number")?n.fn.map.call(r,function(r){return n[t][i](r,u,f,e)}):n[t][i](r,u,f,e)}})(i[r])}("pdf cdf inv".split(" ")),function(i){for(var r=0;r<i.length;r++)(function(i){n[t].prototype[i]=function(){return n[t][i](this._a,this._b,this._c)}})(i[r])}("mean median mode variance".split(" "))})(t[i])})("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy laplace lognormal noncentralt normal pareto studentt weibull uniform binomial negbin hypgeom poisson triangular tukey arcsine".split(" "));n.extend(n.beta,{pdf:function(i,r,u){return i>1||i<0?0:r==1&&u==1?1:r<512&&u<512?t.pow(i,r-1)*t.pow(1-i,u-1)/n.betafn(r,u):t.exp((r-1)*t.log(i)+(u-1)*t.log(1-i)-n.betaln(r,u))},cdf:function(t,i,r){return t>1||t<0?(t>1)*1:n.ibeta(t,i,r)},inv:function(t,i,r){return n.ibetainv(t,i,r)},mean:function(n,t){return n/(n+t)},median:function(t,i){return n.ibetainv(.5,t,i)},mode:function(n,t){return(n-1)/(n+t-2)},sample:function(t,i){var r=n.randg(t);return r/(r+n.randg(i))},variance:function(n,i){return n*i/(t.pow(n+i,2)*(n+i+1))}});n.extend(n.centralF,{pdf:function(i,r,u){var f,e,o;return i<0?0:r<=2?i===0&&r<2?Infinity:i===0&&r===2?1:1/n.betafn(r/2,u/2)*t.pow(r/u,r/2)*t.pow(i,r/2-1)*t.pow(1+r/u*i,-(r+u)/2):(f=r*i/(u+i*r),e=u/(u+i*r),o=r*e/2,o*n.binomial.pdf((r-2)/2,(r+u-2)/2,f))},cdf:function(t,i,r){return t<0?0:n.ibeta(i*t/(i*t+r),i/2,r/2)},inv:function(t,i,r){return r/(i*(1/n.ibetainv(t,i/2,r/2)-1))},mean:function(n,t){return t>2?t/(t-2):undefined},mode:function(n,t){return n>2?t*(n-2)/(n*(t+2)):undefined},sample:function(t,i){var r=n.randg(t/2)*2,u=n.randg(i/2)*2;return r/t/(u/i)},variance:function(n,t){return t<=4?undefined:2*t*t*(n+t-2)/(n*(t-2)*(t-2)*(t-4))}});n.extend(n.cauchy,{pdf:function(n,i,r){return r<0?0:r/(t.pow(n-i,2)+t.pow(r,2))/t.PI},cdf:function(n,i,r){return t.atan((n-i)/r)/t.PI+.5},inv:function(n,i,r){return i+r*t.tan(t.PI*(n-.5))},median:function(n){return n},mode:function(n){return n},sample:function(i,r){return n.randn()*t.sqrt(1/(2*n.randg(.5)))*r+i}});n.extend(n.chisquare,{pdf:function(i,r){return i<0?0:i===0&&r===2?.5:t.exp((r/2-1)*t.log(i)-i/2-r/2*t.log(2)-n.gammaln(r/2))},cdf:function(t,i){return t<0?0:n.lowRegGamma(i/2,t/2)},inv:function(t,i){return 2*n.gammapinv(t,.5*i)},mean:function(n){return n},median:function(n){return n*t.pow(1-2/(9*n),3)},mode:function(n){return n-2>0?n-2:0},sample:function(t){return n.randg(t/2)*2},variance:function(n){return 2*n}});n.extend(n.exponential,{pdf:function(n,i){return n<0?0:i*t.exp(-i*n)},cdf:function(n,i){return n<0?0:1-t.exp(-i*n)},inv:function(n,i){return-t.log(1-n)/i},mean:function(n){return 1/n},median:function(n){return 1/n*t.log(2)},mode:function(){return 0},sample:function(n){return-1/n*t.log(t.random())},variance:function(n){return t.pow(n,-2)}});n.extend(n.gamma,{pdf:function(i,r,u){return i<0?0:i===0&&r===1?1/u:t.exp((r-1)*t.log(i)-i/u-n.gammaln(r)-r*t.log(u))},cdf:function(t,i,r){return t<0?0:n.lowRegGamma(i,t/r)},inv:function(t,i,r){return n.gammapinv(t,i)*r},mean:function(n,t){return n*t},mode:function(n,t){return n>1?(n-1)*t:undefined},sample:function(t,i){return n.randg(t)*i},variance:function(n,t){return n*t*t}});n.extend(n.invgamma,{pdf:function(i,r,u){return i<=0?0:t.exp(-(r+1)*t.log(i)-u/i-n.gammaln(r)+r*t.log(u))},cdf:function(t,i,r){return t<=0?0:1-n.lowRegGamma(i,r/t)},inv:function(t,i,r){return r/n.gammapinv(1-t,i)},mean:function(n,t){return n>1?t/(n-1):undefined},mode:function(n,t){return t/(n+1)},sample:function(t,i){return i/n.randg(t)},variance:function(n,t){return n<=2?undefined:t*t/((n-1)*(n-1)*(n-2))}});n.extend(n.kumaraswamy,{pdf:function(n,i,r){return n===0&&i===1?r:n===1&&r===1?i:t.exp(t.log(i)+t.log(r)+(i-1)*t.log(n)+(r-1)*t.log(1-t.pow(n,i)))},cdf:function(n,i,r){return n<0?0:n>1?1:1-t.pow(1-t.pow(n,i),r)},inv:function(n,i,r){return t.pow(1-t.pow(1-n,1/r),1/i)},mean:function(t,i){return i*n.gammafn(1+1/t)*n.gammafn(i)/n.gammafn(1+1/t+i)},median:function(n,i){return t.pow(1-t.pow(2,-1/i),1/n)},mode:function(n,i){return(n>=1&&i>=1&&n!==1&&i!==1)?t.pow((n-1)/(n*i-1),1/n):undefined},variance:function(){throw new Error("variance not yet implemented");}});n.extend(n.lognormal,{pdf:function(n,i,r){return n<=0?0:t.exp(-t.log(n)-.5*t.log(2*t.PI)-t.log(r)-t.pow(t.log(n)-i,2)/(2*r*r))},cdf:function(i,r,u){return i<0?0:.5+.5*n.erf((t.log(i)-r)/t.sqrt(2*u*u))},inv:function(i,r,u){return t.exp(-1.4142135623730952*u*n.erfcinv(2*i)+r)},mean:function(n,i){return t.exp(n+i*i/2)},median:function(n){return t.exp(n)},mode:function(n,i){return t.exp(n-i*i)},sample:function(i,r){return t.exp(n.randn()*r+i)},variance:function(n,i){return(t.exp(i*i)-1)*t.exp(2*n+i*i)}});n.extend(n.noncentralt,{pdf:function(i,r,u){var f=1e-14;return t.abs(u)<f?n.studentt.pdf(i,r):t.abs(i)<f?t.exp(n.gammaln((r+1)/2)-u*u/2-.5*t.log(t.PI*r)-n.gammaln(r/2)):r/i*(n.noncentralt.cdf(i*t.sqrt(1+2/r),r+2,u)-n.noncentralt.cdf(i,r,u))},cdf:function(i,r,u){var o=1e-14,s;if(t.abs(u)<o)return n.studentt.cdf(i,r);s=!1;i<0&&(s=!0,u=-u);for(var h=n.normal.cdf(-u,0,1),e=o+1,c=e,l=i*i/(i*i+r),f=0,a=t.exp(-u*u/2),v=t.exp(-u*u/2-.5*t.log(2)-n.gammaln(3/2))*u;f<200||c>o||e>o;)c=e,f>0&&(a*=u*u/(2*f),v*=u*u/(2*(f+1/2))),e=a*n.beta.cdf(l,f+.5,r/2)+v*n.beta.cdf(l,f+1,r/2),h+=.5*e,f++;return s?1-h:h}});n.extend(n.normal,{pdf:function(n,i,r){return t.exp(-.5*t.log(2*t.PI)-t.log(r)-t.pow(n-i,2)/(2*r*r))},cdf:function(i,r,u){return.5*(1+n.erf((i-r)/t.sqrt(2*u*u)))},inv:function(t,i,r){return-1.4142135623730952*r*n.erfcinv(2*t)+i},mean:function(n){return n},median:function(n){return n},mode:function(n){return n},sample:function(t,i){return n.randn()*i+t},variance:function(n,t){return t*t}});n.extend(n.pareto,{pdf:function(n,i,r){return n<i?0:r*t.pow(i,r)/t.pow(n,r+1)},cdf:function(n,i,r){return n<i?0:1-t.pow(i/n,r)},inv:function(n,i,r){return i/t.pow(1-n,1/r)},mean:function(n,i){return i<=1?undefined:i*t.pow(n,i)/(i-1)},median:function(n,i){return n*i*t.SQRT2},mode:function(n){return n},variance:function(n,i){return i<=2?undefined:n*n*i/(t.pow(i-1,2)*(i-2))}});n.extend(n.studentt,{pdf:function(i,r){return r=r>1e100?1e100:r,1/(t.sqrt(r)*n.betafn(.5,r/2))*t.pow(1+i*i/r,-((r+1)/2))},cdf:function(i,r){var u=r/2;return n.ibeta((i+t.sqrt(i*i+r))/(2*t.sqrt(i*i+r)),u,u)},inv:function(i,r){var u=n.ibetainv(2*t.min(i,1-i),.5*r,.5);return u=t.sqrt(r*(1-u)/u),i>.5?u:-u},mean:function(n){return n>1?0:undefined},median:function(){return 0},mode:function(){return 0},sample:function(i){return n.randn()*t.sqrt(i/(2*n.randg(i/2)))},variance:function(n){return n>2?n/(n-2):n>1?Infinity:undefined}});n.extend(n.weibull,{pdf:function(n,i,r){return n<0||i<0||r<0?0:r/i*t.pow(n/i,r-1)*t.exp(-t.pow(n/i,r))},cdf:function(n,i,r){return n<0?0:1-t.exp(-t.pow(n/i,r))},inv:function(n,i,r){return i*t.pow(-t.log(1-n),1/r)},mean:function(t,i){return t*n.gammafn(1+1/i)},median:function(n,i){return n*t.pow(t.log(2),1/i)},mode:function(n,i){return i<=1?0:n*t.pow((i-1)/i,1/i)},sample:function(n,i){return n*t.pow(-t.log(t.random()),1/i)},variance:function(i,r){return i*i*n.gammafn(1+2/r)-t.pow(n.weibull.mean(i,r),2)}});n.extend(n.uniform,{pdf:function(n,t,i){return n<t||n>i?0:1/(i-t)},cdf:function(n,t,i){return n<t?0:n<i?(n-t)/(i-t):1},inv:function(n,t,i){return t+n*(i-t)},mean:function(n,t){return.5*(n+t)},median:function(t,i){return n.mean(t,i)},mode:function(){throw new Error("mode is not yet implemented");},sample:function(n,i){return n/2+i/2+(i/2-n/2)*(2*t.random()-1)},variance:function(n,i){return t.pow(i-n,2)/12}});n.extend(n.binomial,{pdf:function(i,r,u){return u===0||u===1?r*u===i?1:0:n.combination(r,i)*t.pow(u,i)*t.pow(1-u,r-i)},cdf:function(t,i,r){var f=[],u=0;if(t<0)return 0;if(t<i){for(;u<=t;u++)f[u]=n.binomial.pdf(u,i,r);return n.sum(f)}return 1}});n.extend(n.negbin,{pdf:function(i,r,u){return i!==i>>>0?!1:i<0?0:n.combination(i+r-1,r-1)*t.pow(1-u,i)*t.pow(u,r)},cdf:function(t,i,r){var f=0,u=0;if(t<0)return 0;for(;u<=t;u++)f+=n.negbin.pdf(u,i,r);return f}});n.extend(n.hypgeom,{pdf:function(i,r,u,f){var s,e,o;if(i!==i|0)return!1;if(i<0||i<u-(r-f)||i>f||i>u)return 0;if(u*2>r)return f*2>r?n.hypgeom.pdf(r-u-f+i,r,r-u,r-f):n.hypgeom.pdf(f-i,r,r-u,f);if(f*2>r)return n.hypgeom.pdf(u-i,r,u,r-f);if(u<f)return n.hypgeom.pdf(i,r,f,u);for(s=1,e=0,o=0;o<i;o++){while(s>1&&e<f)s*=1-u/(r-e),e++;s*=(f-o)*(u-o)/((o+1)*(r-u-f+o+1))}for(;e<f;e++)s*=1-u/(r-e);return t.min(1,t.max(0,s))},cdf:function(i,r,u,f){var e,c;if(i<0||i<u-(r-f))return 0;if(i>=f||i>=u)return 1;if(u*2>r)return f*2>r?n.hypgeom.cdf(r-u-f+i,r,r-u,r-f):1-n.hypgeom.cdf(f-i-1,r,r-u,f);if(f*2>r)return 1-n.hypgeom.cdf(u-i-1,r,u,r-f);if(u<f)return n.hypgeom.cdf(i,r,f,u);var s=1,h=1,o=0;for(e=0;e<i;e++){while(s>1&&o<f)c=1-u/(r-o),h*=c,s*=c,o++;h*=(f-e)*(u-e)/((e+1)*(r-u-f+e+1));s+=h}for(;o<f;o++)s*=1-u/(r-o);return t.min(1,t.max(0,s))}});n.extend(n.poisson,{pdf:function(i,r){return r<0||i%1!=0||i<0?0:t.pow(r,i)*t.exp(-r)/n.factorial(i)},cdf:function(t,i){var u=[],r=0;if(t<0)return 0;for(;r<=t;r++)u.push(n.poisson.pdf(r,i));return n.sum(u)},mean:function(n){return n},variance:function(n){return n},sample:function(n){var i=1,r=0,u=t.exp(-n);do r++,i*=t.random();while(i>u);return r-1}});n.extend(n.triangular,{pdf:function(n,t,i,r){return i<=t||r<t||r>i?NaN:n<t||n>i?0:n<r?2*(n-t)/((i-t)*(r-t)):n===r?2/(i-t):2*(i-n)/((i-t)*(i-r))},cdf:function(n,i,r,u){return r<=i||u<i||u>r?NaN:n<=i?0:n>=r?1:n<=u?t.pow(n-i,2)/((r-i)*(u-i)):1-t.pow(r-n,2)/((r-i)*(r-u))},inv:function(n,i,r,u){return r<=i||u<i||u>r?NaN:n<=(u-i)/(r-i)?i+(r-i)*t.sqrt(n*((u-i)/(r-i))):i+(r-i)*(1-t.sqrt((1-n)*(1-(u-i)/(r-i))))},mean:function(n,t,i){return(n+t+i)/3},median:function(n,i,r){return r<=(n+i)/2?i-t.sqrt((i-n)*(i-r))/t.sqrt(2):r>(n+i)/2?n+t.sqrt((i-n)*(r-n))/t.sqrt(2):void 0},mode:function(n,t,i){return i},sample:function(n,i,r){var u=t.random();return u<(r-n)/(i-n)?n+t.sqrt(u*(i-n)*(r-n)):i-t.sqrt((1-u)*(i-n)*(i-r))},variance:function(n,t,i){return(n*n+t*t+i*i-n*t-n*i-t*i)/18}});n.extend(n.arcsine,{pdf:function(n,i,r){return r<=i?NaN:n<=i||n>=r?0:2/t.PI*t.pow(t.pow(r-i,2)-t.pow(2*n-i-r,2),-.5)},cdf:function(n,i,r){return n<i?0:n<r?2/t.PI*t.asin(t.sqrt((n-i)/(r-i))):1},inv:function(n,i,r){return i+(.5-.5*t.cos(t.PI*n))*(r-i)},mean:function(n,t){return t<=n?NaN:(n+t)/2},median:function(n,t){return t<=n?NaN:(n+t)/2},mode:function(){throw new Error("mode is not yet implemented");},sample:function(i,r){return(i+r)/2+(r-i)/2*t.sin(2*t.PI*n.uniform.sample(0,1))},variance:function(n,i){return i<=n?NaN:t.pow(i-n,2)/8}});n.extend(n.laplace,{pdf:function(n,i,r){return r<=0?0:t.exp(-t.abs(n-i)/r)/(2*r)},cdf:function(n,i,r){return r<=0?0:n<i?.5*t.exp((n-i)/r):1-.5*t.exp(-(n-i)/r)},mean:function(n){return n},median:function(n){return n},mode:function(n){return n},variance:function(n,t){return 2*t*t},sample:function(n,i){var u=t.random()-.5;return n-i*r(u)*t.log(1-2*t.abs(u))}});n.extend(n.tukey,{cdf:function(r,u,f){var p=1,w=u,b=8,g=1e-14,c=[.98940093499164994,.9445750230732326,.86563120238783176,.755404408355003,.61787624440264377,.45801677765722737,.28160355077925892,.095012509837637441],ft=[.027152459411754096,.062253523938647894,.095158511682492786,.12462897125553388,.14959598881657674,.16915651939500254,.18260341504492358,.1894506104550685],l,a,v,s,h,o,y,it,rt,ut;if(r<=0)return 0;if(f<2||p<1||w<2)return NaN;if(!Number.isFinite(r))return 1;if(f>25e3)return i(r,p,w);var k=f*.5,d=k*t.log(f)-f*t.log(2)-n.gammaln(k),nt=k-1,tt=f*.25,e;for(e=f<=100?1:f<=800?.5:f<=5e3?.25:.125,d+=t.log(e),l=0,a=1;a<=50;a++){for(v=0,s=(2*a-1)*e,h=1;h<=16;h++)b<h?(o=h-b-1,y=d+nt*t.log(s+c[o]*e)-(c[o]*e+s)*tt):(o=h-1,y=d+nt*t.log(s-c[o]*e)+(c[o]*e-s)*tt),y>=-30&&(it=b<h?r*t.sqrt((c[o]*e+s)*.5):r*t.sqrt((-(c[o]*e)+s)*.5),rt=i(it,p,w),ut=rt*ft[o]*t.exp(y),v+=ut);if(a*e>=1&&v<=g)break;l+=v}if(v>g)throw new Error("tukey.cdf failed to converge");return l>1&&(l=1),l},inv:function(i,r,f){var a=r,e,c,o,s,h,l,v;if(f<2||!1||a<2)return NaN;if(i<0||i>1)return NaN;if(i===0)return 0;if(i===1)return Infinity;for(e=u(i,a,f),c=n.tukey.cdf(e,r,f)-i,o=c>0?t.max(0,e-1):e+1,s=n.tukey.cdf(o,r,f)-i,l=1;l<50;l++)if(h=o-s*(o-e)/(s-c),c=s,e=o,h<0&&(h=0,s=-i),s=n.tukey.cdf(h,r,f)-i,o=h,v=t.abs(o-e),v<.0001)return h;throw new Error("tukey.inv failed to converge");}})}(n,Math),function(n,t){function u(t){return e(t)||t instanceof n}var f=Array.prototype.push,e=n.utils.isArray;n.extend({add:function(t,i){return u(i)?(u(i[0])||(i=[i]),n.map(t,function(n,t,r){return n+i[t][r]})):n.map(t,function(n){return n+i})},subtract:function(t,i){return u(i)?(u(i[0])||(i=[i]),n.map(t,function(n,t,r){return n-i[t][r]||0})):n.map(t,function(n){return n-i})},divide:function(t,i){return u(i)?(u(i[0])||(i=[i]),n.multiply(t,n.inv(i))):n.map(t,function(n){return n/i})},multiply:function(t,i){var f,e,l,h,o,c,s,r;if(t.length===undefined&&i.length===undefined)return t*i;if(o=t.length,c=t[0].length,s=n.zeros(o,l=u(i)?i[0].length:c),r=0,u(i)){for(;r<l;r++)for(f=0;f<o;f++){for(h=0,e=0;e<c;e++)h+=t[f][e]*i[e][r];s[f][r]=h}return o===1&&r===1?s[0][0]:s}return n.map(t,function(n){return n*i})},outer:function(t,i){return n.multiply(t.map(function(n){return[n]}),[i])},dot:function(t,i){u(t[0])||(t=[t]);u(i[0])||(i=[i]);for(var o=t[0].length===1&&t.length!==1?n.transpose(t):t,h=i[0].length===1&&i.length!==1?n.transpose(i):i,f=[],r=0,c=o.length,l=o[0].length,s,e;r<c;r++){for(f[r]=[],s=0,e=0;e<l;e++)s+=o[r][e]*h[r][e];f[r]=s}return f.length===1?f[0]:f},pow:function(i,r){return n.map(i,function(n){return t.pow(n,r)})},exp:function(i){return n.map(i,function(n){return t.exp(n)})},log:function(i){return n.map(i,function(n){return t.log(n)})},abs:function(i){return n.map(i,function(n){return t.abs(n)})},norm:function(n,i){var f=0,r=0;for(isNaN(i)&&(i=2),u(n[0])&&(n=n[0]);r<n.length;r++)f+=t.pow(t.abs(n[r]),i);return t.pow(f,1/i)},angle:function(i,r){return t.acos(n.dot(i,r)/(n.norm(i)*n.norm(r)))},aug:function(n,t){for(var r=[],i=0;i<n.length;i++)r.push(n[i].slice());for(i=0;i<r.length;i++)f.apply(r[i],t[i]);return r},inv:function(t){for(var e=t.length,u=t[0].length,s=n.identity(e,u),o=n.gauss_jordan(t,s),f=[],i=0,r;i<e;i++)for(f[i]=[],r=u;r<o[0].length;r++)f[i][r-u]=o[i][r];return f},det:function(n){var i=n.length,o=i*2,r=new Array(o),h=i-1,c=o-1,u=h-i+1,f=c,t=0,s=0,e;if(i===2)return n[0][0]*n[1][1]-n[0][1]*n[1][0];for(;t<o;t++)r[t]=1;for(t=0;t<i;t++){for(e=0;e<i;e++)r[u<0?u+i:u]*=n[t][e],r[f<i?f+i:f]*=n[t][e],u++,f--;u=--h-i+1;f=--c}for(t=0;t<i;t++)s+=r[t];for(;t<o;t++)s-=r[t];return s},gauss_elimination:function(i,r){var u=0,e=0,o=i.length,y=i[0].length,a=1,s=0,c=[],h,l,v,f;for(i=n.aug(i,r),h=i[0].length,u=0;u<o;u++){for(l=i[u][u],e=u,f=u+1;f<y;f++)l<t.abs(i[f][u])&&(l=i[f][u],e=f);if(e!=u)for(f=0;f<h;f++)v=i[u][f],i[u][f]=i[e][f],i[e][f]=v;for(e=u+1;e<o;e++)for(a=i[e][u]/i[u][u],f=u;f<h;f++)i[e][f]=i[e][f]-a*i[u][f]}for(u=o-1;u>=0;u--){for(s=0,e=u+1;e<=o-1;e++)s=s+c[e]*i[u][e];c[u]=(i[u][h-1]-s)/i[u][u]}return c},gauss_jordan:function(i,r){for(var c,a,e,o,f=n.aug(i,r),h=f.length,l=f[0].length,s=0,u=0;u<h;u++){for(c=u,e=u+1;e<h;e++)t.abs(f[e][u])>t.abs(f[c][u])&&(c=e);for(a=f[u],f[u]=f[c],f[c]=a,e=u+1;e<h;e++)for(s=f[e][u]/f[u][u],o=u;o<l;o++)f[e][o]-=f[u][o]*s}for(u=h-1;u>=0;u--){for(s=f[u][u],e=0;e<u;e++)for(o=l-1;o>u-1;o--)f[e][o]-=f[u][o]*f[e][u]/s;for(f[u][u]/=s,o=h;o<l;o++)f[u][o]/=s}return f},triaUpSolve:function(t,i){var u=t[0].length,r=n.zeros(1,u)[0],f,e=!1;return(i[0].length!=undefined&&(i=i.map(function(n){return n[0]}),e=!0),n.arange(u-1,-1,-1).forEach(function(e){f=n.arange(e+1,u).map(function(n){return r[n]*t[e][n]});r[e]=(i[e]-n.sum(f))/t[e][e]}),e)?r.map(function(n){return[n]}):r},triaLowSolve:function(t,i){var u=t[0].length,r=n.zeros(1,u)[0],f,e=!1;return(i[0].length!=undefined&&(i=i.map(function(n){return n[0]}),e=!0),n.arange(u).forEach(function(u){f=n.arange(u).map(function(n){return t[u][n]*r[n]});r[u]=(i[u]-n.sum(f))/t[u][u]}),e)?r.map(function(n){return[n]}):r},lu:function(t){var u=t.length,f=n.identity(u),r=n.zeros(t.length,t[0].length),e;return n.arange(u).forEach(function(n){r[0][n]=t[0][n]}),n.arange(1,u).forEach(function(o){n.arange(o).forEach(function(i){e=n.arange(i).map(function(n){return f[o][n]*r[n][i]});f[o][i]=(t[o][i]-n.sum(e))/r[i][i]});n.arange(o,u).forEach(function(u){e=n.arange(o).map(function(n){return f[o][n]*r[n][u]});r[o][u]=t[i][u]-n.sum(e)})}),[f,r]},cholesky:function(i){var f=i.length,r=n.zeros(i.length,i[0].length),u;return n.arange(f).forEach(function(e){u=n.arange(e).map(function(n){return t.pow(r[e][n],2)});r[e][e]=t.sqrt(i[e][e]-n.sum(u));n.arange(e+1,f).forEach(function(t){u=n.arange(e).map(function(n){return r[e][n]*r[t][n]});r[t][e]=(i[e][t]-n.sum(u))/r[e][e]})}),r},gauss_jacobi:function(i,r,u,f){for(var e=0,o=0,p=i.length,h=[],c=[],s=[],a,v,y,l;e<p;e++)for(h[e]=[],c[e]=[],s[e]=[],o=0;o<p;o++)e>o?(h[e][o]=i[e][o],c[e][o]=s[e][o]=0):e<o?(c[e][o]=i[e][o],h[e][o]=s[e][o]=0):(s[e][o]=i[e][o],h[e][o]=c[e][o]=0);for(y=n.multiply(n.multiply(n.inv(s),n.add(h,c)),-1),v=n.multiply(n.inv(s),r),a=u,l=n.add(n.multiply(y,u),v),e=2;t.abs(n.norm(n.subtract(l,a)))>f;)a=l,l=n.add(n.multiply(y,a),v),e++;return l},gauss_seidel:function(i,r,u,f){for(var e=0,p=i.length,s=[],c=[],h=[],o,a,v,y,l;e<p;e++)for(s[e]=[],c[e]=[],h[e]=[],o=0;o<p;o++)e>o?(s[e][o]=i[e][o],c[e][o]=h[e][o]=0):e<o?(c[e][o]=i[e][o],s[e][o]=h[e][o]=0):(h[e][o]=i[e][o],s[e][o]=c[e][o]=0);for(y=n.multiply(n.multiply(n.inv(n.add(h,s)),c),-1),v=n.multiply(n.inv(n.add(h,s)),r),a=u,l=n.add(n.multiply(y,u),v),e=2;t.abs(n.norm(n.subtract(l,a)))>f;)a=l,l=n.add(n.multiply(y,a),v),e=e+1;return l},SOR:function(i,r,u,f,e){for(var o=0,w=i.length,c=[],l=[],h=[],s,v,y,p,a;o<w;o++)for(c[o]=[],l[o]=[],h[o]=[],s=0;s<w;s++)o>s?(c[o][s]=i[o][s],l[o][s]=h[o][s]=0):o<s?(l[o][s]=i[o][s],c[o][s]=h[o][s]=0):(h[o][s]=i[o][s],c[o][s]=l[o][s]=0);for(p=n.multiply(n.inv(n.add(h,n.multiply(c,e))),n.subtract(n.multiply(h,1-e),n.multiply(l,e))),y=n.multiply(n.multiply(n.inv(n.add(h,n.multiply(c,e))),r),e),v=u,a=n.add(n.multiply(p,u),y),o=2;t.abs(n.norm(n.subtract(a,v)))>f;)v=a,a=n.add(n.multiply(p,v),y),o++;return a},householder:function(i){for(var s=i.length,l=i[0].length,r=0,f=[],h=[],u,c,e,o,a;r<s-1;r++){for(u=0,o=r+1;o<l;o++)u+=i[o][r]*i[o][r];for(a=i[r+1][r]>0?-1:1,u=a*t.sqrt(u),c=t.sqrt((u*u-i[r+1][r]*u)/2),f=n.zeros(s,1),f[r+1][0]=(i[r+1][r]-u)/(2*c),e=r+2;e<s;e++)f[e][0]=i[e][r]/(2*c);h=n.subtract(n.identity(s,l),n.multiply(n.multiply(f,n.transpose(f)),2));i=n.multiply(h,n.multiply(i,h))}return i},QR:function(){function f(t){var i=t.length,e=n.norm(t,2),r=n.zeros(1,i)[0];r[0]=1;var u=n.add(n.multiply(n.multiply(r,e),-1),t),o=n.norm(u,2),f=n.divide(u,o);return n.subtract(n.identity(i),n.multiply(n.outer(f,f),2))}function e(f){var h=f.length,c=f[0].length,o,e,s;for(f=n.copy(f),r=n.zeros(c,c),e=0;e<c;e++){for(r[e][e]=t.sqrt(i(u(h).map(function(n){return f[n][e]*f[n][e]}))),o=0;o<h;o++)f[o][e]=f[o][e]/r[e][e];for(s=e+1;s<c;s++)for(r[e][s]=i(u(h).map(function(n){return f[n][e]*f[n][s]})),o=0;o<h;o++)f[o][s]=f[o][s]-f[o][e]*r[e][s]}return[f,r]}var i=n.sum,u=n.arange;return e}(),lstsq:function(){function t(t){t=n.copy(t);var r=t.length,i=n.identity(r);return n.arange(r-1,-1,-1).forEach(function(r){n.sliceAssign(i,{row:r},n.divide(n.slice(i,{row:r}),t[r][r]));n.sliceAssign(t,{row:r},n.divide(n.slice(t,{row:r}),t[r][r]));n.arange(r).forEach(function(u){var f=n.multiply(t[u][r],-1),s=n.slice(t,{row:u}),h=n.multiply(n.slice(t,{row:r}),f),e,o;n.sliceAssign(t,{row:u},n.add(s,h));e=n.slice(i,{row:u});o=n.multiply(n.slice(i,{row:r}),f);n.sliceAssign(i,{row:u},n.add(e,o))})}),i}function i(i,r){var e=!1,u;r[0].length===undefined&&(r=r.map(function(n){return[n]}),e=!0);var o=n.QR(i),h=o[0],c=o[1],s=i[0].length,l=n.slice(h,{col:{end:s}}),a=n.slice(c,{row:{end:s}}),v=t(a),f=n.transpose(l);return(f[0].length===undefined&&(f=[f]),u=n.multiply(n.multiply(v,f),r),u.length===undefined&&(u=[[u]]),e)?u.map(function(n){return n[0]}):u}return i}(),jacobi:function(i){for(var c=1,p=0,o=i.length,l=n.identity(o,o),v=[],y,u,f,e,a,h,s,r;c===1;){for(p++,a=i[0][1],f=0,e=1,r=0;r<o;r++)for(u=0;u<o;u++)r!=u&&a<t.abs(i[r][u])&&(a=t.abs(i[r][u]),f=r,e=u);for(h=i[f][f]===i[e][e]?i[f][e]>0?t.PI/4:-t.PI/4:t.atan(2*i[f][e]/(i[f][f]-i[e][e]))/2,s=n.identity(o,o),s[f][f]=t.cos(h),s[f][e]=-t.sin(h),s[e][f]=t.sin(h),s[e][e]=t.cos(h),l=n.multiply(l,s),y=n.multiply(n.multiply(n.inv(s),i),s),i=y,c=0,r=1;r<o;r++)for(u=1;u<o;u++)r!=u&&t.abs(i[r][u])>.001&&(c=1)}for(r=0;r<o;r++)v.push(i[r][r]);return[l,v]},rungekutta:function(n,t,i,r,u,f){var e,o,s,h,c;if(f===2)while(r<=i)e=t*n(r,u),o=t*n(r+t,u+e),s=u+(e+o)/2,u=s,r=r+t;if(f===4)while(r<=i)e=t*n(r,u),o=t*n(r+t/2,u+e/2),h=t*n(r+t/2,u+o/2),c=t*n(r+t,u+h),s=u+(e+2*o+2*h+c)/6,u=s,r=r+t;return u},romberg:function(n,i,r,u){for(var l=0,a=(r-i)/2,v=[],h=[],e=[],o,c,f,y,s;l<u/2;){for(s=n(i),f=i,y=0;f<=r;f=f+a,y++)v[y]=f;for(o=v.length,f=1;f<o-1;f++)s+=(f%2!=0?4:2)*n(v[f]);s=a/3*(s+n(r));e[l]=s;a/=2;l++}for(c=e.length,o=1;c!==1;){for(f=0;f<c-1;f++)h[f]=(t.pow(4,o)*e[f+1]-e[f])/(t.pow(4,o)-1);c=h.length;e=h;h=[];o++}return e},richardson:function(n,i,r,u){function c(n,t){for(var i=0,u=n.length,r;i<u;i++)n[i]===t&&(r=i);return r}for(var p=n.length,y=t.abs(r-n[c(n,r)+1]),v=0,f=[],o=[],l,a,s,h,e;u>=y;)l=c(n,r+u),a=c(n,r),f[v]=(i[l]-2*i[a]+i[2*a-l])/(u*u),u/=2,v++;for(h=f.length,s=1;h!=1;){for(e=0;e<h-1;e++)o[e]=(t.pow(4,s)*f[e+1]-f[e])/(t.pow(4,s)-1);h=o.length;f=o;o=[];s++}return f},simpson:function(n,t,i,r){for(var o=(i-t)/r,s=n(t),e=[],u=t,h=0,f=1,c;u<=i;u=u+o,h++)e[h]=u;for(c=e.length;f<c-1;f++)s+=(f%2!=0?4:2)*n(e[f]);return o/3*(s+n(i))},hermite:function(n,t,i,r){for(var o=n.length,h=0,u=0,e=[],s=[],c=[],l=[],f;u<o;u++){for(e[u]=1,f=0;f<o;f++)u!=f&&(e[u]*=(r-n[f])/(n[u]-n[f]));for(s[u]=0,f=0;f<o;f++)u!=f&&(s[u]+=1/(n[u]-n[f]));c[u]=(1-2*(r-n[u])*s[u])*e[u]*e[u];l[u]=(r-n[u])*e[u]*e[u];h+=c[u]*t[u]+l[u]*i[u]}return h},lagrange:function(n,t,i){for(var e=0,u=0,r,f,o=n.length;u<o;u++){for(f=t[u],r=0;r<o;r++)u!=r&&(f*=(i-n[r])/(n[u]-n[r]));e+=f}return e},cubic_spline:function(t,i,r){for(var s=t.length,u=0,f,h=[],c=[],l=[],o=[],e=[],a=[],v=[];u<s-1;u++)e[u]=t[u+1]-t[u];for(l[0]=0,u=1;u<s-1;u++)l[u]=3/e[u]*(i[u+1]-i[u])-3/e[u-1]*(i[u]-i[u-1]);for(u=1;u<s-1;u++)h[u]=[],c[u]=[],h[u][u-1]=e[u-1],h[u][u]=2*(e[u-1]+e[u]),h[u][u+1]=e[u],c[u][0]=l[u];for(o=n.multiply(n.inv(h),c),f=0;f<s-1;f++)a[f]=(i[f+1]-i[f])/e[f]-e[f]*(o[f+1][0]+2*o[f][0])/3,v[f]=(o[f+1][0]-o[f][0])/(3*e[f]);for(f=0;f<s;f++)if(t[f]>r)break;return f-=1,i[f]+(r-t[f])*a[f]+n.sq(r-t[f])*o[f]+(r-t[f])*n.sq(r-t[f])*v[f]},gauss_quadrature:function(){throw new Error("gauss_quadrature not yet implemented");},PCA:function(t){for(var o=t.length,s=t[0].length,i=0,r,v,y=[],u=[],h=[],p=[],c=[],l=[],f=[],a=[],w=[],e=[],i=0;i<o;i++)y[i]=n.sum(t[i])/s;for(i=0;i<s;i++)for(f[i]=[],r=0;r<o;r++)f[i][r]=t[r][i]-y[r];for(f=n.transpose(f),i=0;i<o;i++)for(a[i]=[],r=0;r<o;r++)a[i][r]=n.dot([f[i]],[f[r]])/(s-1);for(h=n.jacobi(a),w=h[0],u=h[1],e=n.transpose(w),i=0;i<u.length;i++)for(r=i;r<u.length;r++)u[i]<u[r]&&(v=u[i],u[i]=u[r],u[r]=v,p=e[i],e[i]=e[r],e[r]=p);for(l=n.transpose(f),i=0;i<o;i++)for(c[i]=[],r=0;r<l.length;r++)c[i][r]=n.dot([e[i]],[l[r]]);return[t,u,e,c]}}),function(t){for(var i=0;i<t.length;i++)(function(t){n.fn[t]=function(i,r){var u=this;return r?(setTimeout(function(){r.call(u,n.fn[t].call(u,i))},15),this):typeof n[t](this,i)=="number"?n[t](this,i):n(n[t](this,i))}})(t[i])}("add divide multiply subtract dot pow exp log abs norm angle".split(" "))}(n,Math),function(n,t){function u(n,i,r,u){if(n>1||r>1||n<=0||r<=0)throw new Error("Proportions should be greater than 0 and less than 1");var f=(n*i+r*u)/(i+u),e=t.sqrt(f*(1-f)*(1/i+1/u));return(n-r)/e}var i=[].slice,r=n.utils.isNumber,f=n.utils.isArray;n.extend({zscore:function(){var t=i.call(arguments);return r(t[1])?(t[0]-t[1])/t[2]:(t[0]-n.mean(t[1]))/n.stdev(t[1],t[2])},ztest:function(){var r=i.call(arguments),u;return f(r[1])?(u=n.zscore(r[0],r[1],r[3]),r[2]===1?n.normal.cdf(-t.abs(u),0,1):n.normal.cdf(-t.abs(u),0,1)*2):r.length>2?(u=n.zscore(r[0],r[1],r[2]),r[3]===1?n.normal.cdf(-t.abs(u),0,1):n.normal.cdf(-t.abs(u),0,1)*2):(u=r[0],r[1]===1?n.normal.cdf(-t.abs(u),0,1):n.normal.cdf(-t.abs(u),0,1)*2)}});n.extend(n.fn,{zscore:function(n,t){return(n-this.mean())/this.stdev(t)},ztest:function(i,r,u){var f=t.abs(this.zscore(i,u));return r===1?n.normal.cdf(-f,0,1):n.normal.cdf(-f,0,1)*2}});n.extend({tscore:function(){var r=i.call(arguments);return r.length===4?(r[0]-r[1])/(r[2]/t.sqrt(r[3])):(r[0]-n.mean(r[1]))/(n.stdev(r[1],!0)/t.sqrt(r[1].length))},ttest:function(){var u=i.call(arguments),f;return u.length===5?(f=t.abs(n.tscore(u[0],u[1],u[2],u[3])),u[4]===1?n.studentt.cdf(-f,u[3]-1):n.studentt.cdf(-f,u[3]-1)*2):r(u[1])?(f=t.abs(u[0]),u[2]==1?n.studentt.cdf(-f,u[1]-1):n.studentt.cdf(-f,u[1]-1)*2):(f=t.abs(n.tscore(u[0],u[1])),u[2]==1?n.studentt.cdf(-f,u[1].length-1):n.studentt.cdf(-f,u[1].length-1)*2)}});n.extend(n.fn,{tscore:function(n){return(n-this.mean())/(this.stdev(!0)/t.sqrt(this.cols()))},ttest:function(i,r){return r===1?1-n.studentt.cdf(t.abs(this.tscore(i)),this.cols()-1):n.studentt.cdf(-t.abs(this.tscore(i)),this.cols()-1)*2}});n.extend({anovafscore:function(){var u=i.call(arguments),f,e,c,l,h,o,s,r;if(u.length===1){for(h=new Array(u[0].length),r=0;r<u[0].length;r++)h[r]=u[0][r];u=h}if(u.length===2)return n.variance(u[0])/n.variance(u[1]);for(e=[],r=0;r<u.length;r++)e=e.concat(u[r]);for(c=n.mean(e),f=0,r=0;r<u.length;r++)f=f+u[r].length*t.pow(n.mean(u[r])-c,2);for(f/=u.length-1,o=0,r=0;r<u.length;r++)for(l=n.mean(u[r]),s=0;s<u[r].length;s++)o+=t.pow(u[r][s]-l,2);return o/=e.length-u.length,f/o},anovaftest:function(){var t=i.call(arguments),e,o,u,f;if(r(t[0]))return 1-n.centralF.cdf(t[0],t[1],t[2]);for(anovafscore=n.anovafscore(t),e=t.length-1,u=0,f=0;f<t.length;f++)u=u+t[f].length;return o=u-e-1,1-n.centralF.cdf(anovafscore,e,o)},ftest:function(t,i,r){return 1-n.centralF.cdf(t,i,r)}});n.extend(n.fn,{anovafscore:function(){return n.anovafscore(this.toArray())},anovaftes:function(){for(var t=0,i=0;i<this.length;i++)t=t+this[i].length;return n.ftest(this.anovafscore(),this.length-1,t-this.length)}});n.extend({qscore:function(){var u=i.call(arguments),f,e,o,s,h;return r(u[0])?(f=u[0],e=u[1],o=u[2],s=u[3],h=u[4]):(f=n.mean(u[0]),e=n.mean(u[1]),o=u[0].length,s=u[1].length,h=u[2]),t.abs(f-e)/(h*t.sqrt((1/o+1/s)/2))},qtest:function(){var t=i.call(arguments),r,f,u;return t.length===3?(r=t[0],t=t.slice(1)):t.length===7?(r=n.qscore(t[0],t[1],t[2],t[3],t[4]),t=t.slice(5)):(r=n.qscore(t[0],t[1],t[2]),t=t.slice(3)),f=t[0],u=t[1],1-n.tukey.cdf(r,u,f-u)},tukeyhsd:function(t){for(var r,e,o=n.pooledstdev(t),u=t.map(function(t){return n.mean(t)}),s=t.reduce(function(n,t){return n+t.length},0),f=[],i=0;i<t.length;++i)for(r=i+1;r<t.length;++r)e=n.qtest(u[i],u[r],t[i].length,t[r].length,o,s,t.length),f.push([[i,r],e]);return f}});n.extend({normalci:function(){var r=i.call(arguments),u=new Array(2),f;return f=r.length===4?t.abs(n.normal.inv(r[1]/2,0,1)*r[2]/t.sqrt(r[3])):t.abs(n.normal.inv(r[1]/2,0,1)*n.stdev(r[2])/t.sqrt(r[2].length)),u[0]=r[0]-f,u[1]=r[0]+f,u},tci:function(){var r=i.call(arguments),u=new Array(2),f;return f=r.length===4?t.abs(n.studentt.inv(r[1]/2,r[3]-1)*r[2]/t.sqrt(r[3])):t.abs(n.studentt.inv(r[1]/2,r[2].length-1)*n.stdev(r[2],!0)/t.sqrt(r[2].length)),u[0]=r[0]-f,u[1]=r[0]+f,u},significant:function(n,t){return n<t}});n.extend(n.fn,{normalci:function(t,i){return n.normalci(t,i,this.toArray())},tci:function(t,i){return n.tci(t,i,this.toArray())}});n.extend(n.fn,{oneSidedDifferenceOfProportions:function(t,i,r,f){var e=u(t,i,r,f);return n.ztest(e,1)},twoSidedDifferenceOfProportions:function(t,i,r,f){var e=u(t,i,r,f);return n.ztest(e,2)}})}(n,Math),n.models=function(){function i(n,i){return t(n,i)}function i(i){var r=i[0].length;return n.arange(r).map(function(u){var f=n.arange(r).filter(function(n){return n!==u});return t(n.col(i,u).map(function(n){return n[0]}),n.col(i,f))})}function t(t,i){var f=t.length,e=i[0].length-1,l=f-e-1,o=n.lstsq(i,t),r=n.multiply(i,o.map(function(n){return[n]})).map(function(n){return n[0]}),a=n.subtract(t,r),s=n.mean(t),u=n.sum(r.map(function(n){return Math.pow(n-s,2)})),h=n.sum(t.map(function(n,t){return Math.pow(n-r[t],2)})),c=u+h,v=u/c;return{exog:i,endog:t,nobs:f,df_model:e,df_resid:l,coef:o,predict:r,resid:a,ybar:s,SST:c,SSE:u,SSR:h,R2:v}}function r(t){var e=i(t.exog),u=Math.sqrt(t.SSR/t.df_resid),r=e.map(function(n){var t=n.SST,i=n.R2;return u/Math.sqrt(t*(1-i))}),f=t.coef.map(function(n,t){return(+n)/r[t]}),o=f.map(function(i){var r=n.studentt.cdf(i,t.df_resid);return(r>.5?1-r:r)*2}),s=n.studentt.inv(.975,t.df_resid),h=t.coef.map(function(n,t){var i=s*r[t];return[n-i,n+i]});return{se:r,t:f,p:o,sigmaHat:u,interval95:h}}function u(t){var i=t.R2/t.df_model/((1-t.R2)/t.df_resid),r=function(t,i,r){return n.beta.cdf(t/(r/i+t),i/2,r/2)},u=1-r(i,t.df_model,t.df_resid);return{F_statistic:i,pvalue:u}}function f(n,i){var f=t(n,i),e=r(f),o=u(f),s=1-(1-f.R2)*((f.nobs-1)/f.df_resid);return f.t=e,f.f=o,f.adjust_R2=s,f}return{ols:f}}(),n.jStat=n,n})},function(n,t,i){var r=i(1),u=i(9),f=i(0);t.UNIQUE=function(){for(var t,u,i,n=[],r=0;r<arguments.length;++r){for(t=!1,u=arguments[r],i=0;i<n.length;++i)if(t=n[i]===u,t)break;t||n.push(u)}return n};t.FLATTEN=r.flatten;t.ARGS2ARRAY=function(){return Array.prototype.slice.call(arguments,0)};t.REFERENCE=function(n,t){var e,r,u,i,o,s;if(!arguments.length)return f.error;try{for(e=t.split("."),r=n,u=0;u<e.length;++u)i=e[u],i[i.length-1]==="]"?(o=i.indexOf("["),s=i.substring(o+1,i.length-1),r=r[i.substring(0,o)][s]):r=r[i];return r}catch(f){}};t.JOIN=function(n,t){return n.join(t)};t.NUMBERS=function(){var n=r.flatten(arguments);return n.filter(function(n){return typeof n=="number"})};t.NUMERAL=function(n,t){return u(n).format(t)}},function(n,t,i){function o(n){return/^[01]{1,10}$/.test(n)}var r=i(0),s=i(11).jStat,f=i(6),u=i(1),e=i(28);t.BESSELI=function(n,t){return(n=u.parseNumber(n),t=u.parseNumber(t),u.anyIsError(n,t))?r.value:e.besseli(n,t)};t.BESSELJ=function(n,t){return(n=u.parseNumber(n),t=u.parseNumber(t),u.anyIsError(n,t))?r.value:e.besselj(n,t)};t.BESSELK=function(n,t){return(n=u.parseNumber(n),t=u.parseNumber(t),u.anyIsError(n,t))?r.value:e.besselk(n,t)};t.BESSELY=function(n,t){return(n=u.parseNumber(n),t=u.parseNumber(t),u.anyIsError(n,t))?r.value:e.bessely(n,t)};t.BIN2DEC=function(n){if(!o(n))return r.num;var i=parseInt(n,2),t=n.toString();return t.length===10&&t.substring(0,1)==="1"?parseInt(t.substring(1),2)-512:i};t.BIN2HEX=function(n,t){var u,i;return o(n)?(u=n.toString(),u.length===10&&u.substring(0,1)==="1")?(0xfffffffe00+parseInt(u.substring(1),2)).toString(16):(i=parseInt(n,2).toString(16),t===undefined?i:isNaN(t)?r.value:t<0?r.num:(t=Math.floor(t),t>=i.length?f.REPT("0",t-i.length)+i:r.num)):r.num};t.BIN2OCT=function(n,t){var u,i;return o(n)?(u=n.toString(),u.length===10&&u.substring(0,1)==="1")?(1073741312+parseInt(u.substring(1),2)).toString(8):(i=parseInt(n,2).toString(8),t===undefined?i:isNaN(t)?r.value:t<0?r.num:(t=Math.floor(t),t>=i.length?f.REPT("0",t-i.length)+i:r.num)):r.num};t.BITAND=function(n,t){return(n=u.parseNumber(n),t=u.parseNumber(t),u.anyIsError(n,t))?r.value:n<0||t<0?r.num:Math.floor(n)!==n||Math.floor(t)!==t?r.num:n>0xffffffffffff||t>0xffffffffffff?r.num:n&t};t.BITLSHIFT=function(n,t){return(n=u.parseNumber(n),t=u.parseNumber(t),u.anyIsError(n,t))?r.value:n<0?r.num:Math.floor(n)!==n?r.num:n>0xffffffffffff?r.num:Math.abs(t)>53?r.num:t>=0?n<<t:n>>-t};t.BITOR=function(n,t){return(n=u.parseNumber(n),t=u.parseNumber(t),u.anyIsError(n,t))?r.value:n<0||t<0?r.num:Math.floor(n)!==n||Math.floor(t)!==t?r.num:n>0xffffffffffff||t>0xffffffffffff?r.num:n|t};t.BITRSHIFT=function(n,t){return(n=u.parseNumber(n),t=u.parseNumber(t),u.anyIsError(n,t))?r.value:n<0?r.num:Math.floor(n)!==n?r.num:n>0xffffffffffff?r.num:Math.abs(t)>53?r.num:t>=0?n>>t:n<<-t};t.BITXOR=function(n,t){return(n=u.parseNumber(n),t=u.parseNumber(t),u.anyIsError(n,t))?r.value:n<0||t<0?r.num:Math.floor(n)!==n||Math.floor(t)!==t?r.num:n>0xffffffffffff||t>0xffffffffffff?r.num:n^t};t.COMPLEX=function(n,t,i){if(n=u.parseNumber(n),t=u.parseNumber(t),u.anyIsError(n,t))return n;if(i=i===undefined?"i":i,i!=="i"&&i!=="j")return r.value;if(n===0&&t===0)return 0;if(n===0)return t===1?i:t.toString()+i;if(t===0)return n.toString();var f=t>0?"+":"";return n.toString()+f+(t===1?i:t.toString()+i)};t.CONVERT=function(n,t,i){var e,k,y,s,d,p,h;if(n=u.parseNumber(n),n instanceof Error)return n;var f=[["a.u. of action","?",null,"action",!1,!1,105457168181818e-48],["a.u. of charge","e",null,"electric_charge",!1,!1,160217653141414e-33],["a.u. of energy","Eh",null,"energy",!1,!1,435974417757576e-32],["a.u. of length","a?",null,"length",!1,!1,529177210818182e-25],["a.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["a.u. of time","?/Eh",null,"time",!1,!1,241888432650516e-31],["admiralty knot","admkn",null,"speed",!1,!0,.514773333],["ampere","A",null,"electric_current",!0,!1,1],["ampere per meter","A/m",null,"magnetic_field_intensity",!0,!1,1],["ångström","Å",["ang"],"length",!1,!0,1e-10],["are","ar",null,"area",!1,!0,100],["astronomical unit","ua",null,"length",!1,!1,149597870691667e-25],["bar","bar",null,"pressure",!1,!1,1e5],["barn","b",null,"area",!1,!1,1e-28],["becquerel","Bq",null,"radioactivity",!0,!1,1],["bit","bit",["b"],"information",!1,!0,1],["btu","BTU",["btu"],"energy",!1,!0,1055.05585262],["byte","byte",null,"information",!1,!0,8],["candela","cd",null,"luminous_intensity",!0,!1,1],["candela per square metre","cd/m?",null,"luminance",!0,!1,1],["coulomb","C",null,"electric_charge",!0,!1,1],["cubic ångström","ang3",["ang^3"],"volume",!1,!0,1e-30],["cubic foot","ft3",["ft^3"],"volume",!1,!0,.028316846592],["cubic inch","in3",["in^3"],"volume",!1,!0,16387064e-12],["cubic light-year","ly3",["ly^3"],"volume",!1,!0,846786664623715e-61],["cubic metre","m?",null,"volume",!0,!0,1],["cubic mile","mi3",["mi^3"],"volume",!1,!0,4168181825.44058],["cubic nautical mile","Nmi3",["Nmi^3"],"volume",!1,!0,6352182208],["cubic Pica","Pica3",["Picapt3","Pica^3","Picapt^3"],"volume",!1,!0,758660370370369e-22],["cubic yard","yd3",["yd^3"],"volume",!1,!0,.764554857984],["cup","cup",null,"volume",!1,!0,.0002365882365],["dalton","Da",["u"],"mass",!1,!1,166053886282828e-41],["day","d",["day"],"time",!1,!0,86400],["degree","°",null,"angle",!1,!1,.0174532925199433],["degrees Rankine","Rank",null,"temperature",!1,!0,.555555555555556],["dyne","dyn",["dy"],"force",!1,!0,1e-5],["electronvolt","eV",["ev"],"energy",!1,!0,1.60217656514141],["ell","ell",null,"length",!1,!0,1.143],["erg","erg",["e"],"energy",!1,!0,1e-7],["farad","F",null,"electric_capacitance",!0,!1,1],["fluid ounce","oz",null,"volume",!1,!0,295735295625e-16],["foot","ft",null,"length",!1,!0,.3048],["foot-pound","flb",null,"energy",!1,!0,1.3558179483314],["gal","Gal",null,"acceleration",!1,!1,.01],["gallon","gal",null,"volume",!1,!0,.003785411784],["gauss","G",["ga"],"magnetic_flux_density",!1,!0,1],["grain","grain",null,"mass",!1,!0,647989e-10],["gram","g",null,"mass",!1,!0,.001],["gray","Gy",null,"absorbed_dose",!0,!1,1],["gross registered ton","GRT",["regton"],"volume",!1,!0,2.8316846592],["hectare","ha",null,"area",!1,!0,1e4],["henry","H",null,"inductance",!0,!1,1],["hertz","Hz",null,"frequency",!0,!1,1],["horsepower","HP",["h"],"power",!1,!0,745.69987158227],["horsepower-hour","HPh",["hh","hph"],"energy",!1,!0,2684519.538],["hour","h",["hr"],"time",!1,!0,3600],["imperial gallon (U.K.)","uk_gal",null,"volume",!1,!0,.00454609],["imperial hundredweight","lcwt",["uk_cwt","hweight"],"mass",!1,!0,50.802345],["imperial quart (U.K)","uk_qt",null,"volume",!1,!0,.0011365225],["imperial ton","brton",["uk_ton","LTON"],"mass",!1,!0,1016.046909],["inch","in",null,"length",!1,!0,.0254],["international acre","uk_acre",null,"area",!1,!0,4046.8564224],["IT calorie","cal",null,"energy",!1,!0,4.1868],["joule","J",null,"energy",!0,!0,1],["katal","kat",null,"catalytic_activity",!0,!1,1],["kelvin","K",["kel"],"temperature",!0,!0,1],["kilogram","kg",null,"mass",!0,!0,1],["knot","kn",null,"speed",!1,!0,.514444444444444],["light-year","ly",null,"length",!1,!0,9460730472580800],["litre","L",["l","lt"],"volume",!1,!0,.001],["lumen","lm",null,"luminous_flux",!0,!1,1],["lux","lx",null,"illuminance",!0,!1,1],["maxwell","Mx",null,"magnetic_flux",!1,!1,1e-18],["measurement ton","MTON",null,"volume",!1,!0,1.13267386368],["meter per hour","m/h",["m/hr"],"speed",!1,!0,.00027777777777778],["meter per second","m/s",["m/sec"],"speed",!0,!0,1],["meter per second squared","m?s??",null,"acceleration",!0,!1,1],["parsec","pc",["parsec"],"length",!1,!0,30856775814671900],["meter squared per second","m?/s",null,"kinematic_viscosity",!0,!1,1],["metre","m",null,"length",!0,!0,1],["miles per hour","mph",null,"speed",!1,!0,.44704],["millimetre of mercury","mmHg",null,"pressure",!1,!1,133.322],["minute","?",null,"angle",!1,!1,.000290888208665722],["minute","min",["mn"],"time",!1,!0,60],["modern teaspoon","tspm",null,"volume",!1,!0,5e-6],["mole","mol",null,"amount_of_substance",!0,!1,1],["morgen","Morgen",null,"area",!1,!0,2500],["n.u. of action","?",null,"action",!1,!1,105457168181818e-48],["n.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["n.u. of speed","c?",null,"speed",!1,!1,299792458],["n.u. of time","?/(me?c??)",null,"time",!1,!1,128808866778687e-35],["nautical mile","M",["Nmi"],"length",!1,!0,1852],["newton","N",null,"force",!0,!0,1],["œrsted","Oe ",null,"magnetic_field_intensity",!1,!1,79.5774715459477],["ohm","Ω",null,"electric_resistance",!0,!1,1],["ounce mass","ozm",null,"mass",!1,!0,.028349523125],["pascal","Pa",null,"pressure",!0,!1,1],["pascal second","Pa?s",null,"dynamic_viscosity",!0,!1,1],["pferdestärke","PS",null,"power",!1,!0,735.49875],["phot","ph",null,"illuminance",!1,!1,.0001],["pica (1/6 inch)","pica",null,"length",!1,!0,.00035277777777778],["pica (1/72 inch)","Pica",["Picapt"],"length",!1,!0,.00423333333333333],["poise","P",null,"dynamic_viscosity",!1,!1,.1],["pond","pond",null,"force",!1,!0,.00980665],["pound force","lbf",null,"force",!1,!0,4.4482216152605],["pound mass","lbm",null,"mass",!1,!0,.45359237],["quart","qt",null,"volume",!1,!0,.000946352946],["radian","rad",null,"angle",!0,!1,1],["second","?",null,"angle",!1,!1,484813681109536e-20],["second","s",["sec"],"time",!0,!0,1],["short hundredweight","cwt",["shweight"],"mass",!1,!0,45.359237],["siemens","S",null,"electrical_conductance",!0,!1,1],["sievert","Sv",null,"equivalent_dose",!0,!1,1],["slug","sg",null,"mass",!1,!0,14.59390294],["square ångström","ang2",["ang^2"],"area",!1,!0,1e-20],["square foot","ft2",["ft^2"],"area",!1,!0,.09290304],["square inch","in2",["in^2"],"area",!1,!0,.00064516],["square light-year","ly2",["ly^2"],"area",!1,!0,895054210748189e17],["square meter","m?",null,"area",!0,!0,1],["square mile","mi2",["mi^2"],"area",!1,!0,2589988.110336],["square nautical mile","Nmi2",["Nmi^2"],"area",!1,!0,3429904],["square Pica","Pica2",["Picapt2","Pica^2","Picapt^2"],"area",!1,!0,1792111111111e-17],["square yard","yd2",["yd^2"],"area",!1,!0,.83612736],["statute mile","mi",null,"length",!1,!0,1609.344],["steradian","sr",null,"solid_angle",!0,!1,1],["stilb","sb",null,"luminance",!1,!1,.0001],["stokes","St",null,"kinematic_viscosity",!1,!1,.0001],["stone","stone",null,"mass",!1,!0,6.35029318],["tablespoon","tbs",null,"volume",!1,!0,147868e-10],["teaspoon","tsp",null,"volume",!1,!0,492892e-11],["tesla","T",null,"magnetic_flux_density",!0,!0,1],["thermodynamic calorie","c",null,"energy",!1,!0,4.184],["ton","ton",null,"mass",!1,!0,907.18474],["tonne","t",null,"mass",!1,!1,1e3],["U.K. pint","uk_pt",null,"volume",!1,!0,.00056826125],["U.S. bushel","bushel",null,"volume",!1,!0,.03523907],["U.S. oil barrel","barrel",null,"volume",!1,!0,.158987295],["U.S. pint","pt",["us_pt"],"volume",!1,!0,.000473176473],["U.S. survey mile","survey_mi",null,"length",!1,!0,1609.347219],["U.S. survey/statute acre","us_acre",null,"area",!1,!0,4046.87261],["volt","V",null,"voltage",!0,!1,1],["watt","W",null,"power",!0,!0,1],["watt-hour","Wh",["wh"],"energy",!1,!0,3600],["weber","Wb",null,"magnetic_flux",!0,!1,1],["yard","yd",null,"length",!1,!0,.9144],["year","yr",null,"time",!1,!0,31557600]],g={Yi:["yobi",80,1208925819614629174706176,"Yi","yotta"],Zi:["zebi",70,1180591620717411303424,"Zi","zetta"],Ei:["exbi",60,1152921504606846976,"Ei","exa"],Pi:["pebi",50,0x4000000000000,"Pi","peta"],Ti:["tebi",40,1099511627776,"Ti","tera"],Gi:["gibi",30,1073741824,"Gi","giga"],Mi:["mebi",20,1048576,"Mi","mega"],ki:["kibi",10,1024,"ki","kilo"]},nt={Y:["yotta",1e24,"Y"],Z:["zetta",1e21,"Z"],E:["exa",1e18,"E"],P:["peta",1e15,"P"],T:["tera",1e12,"T"],G:["giga",1e9,"G"],M:["mega",1e6,"M"],k:["kilo",1e3,"k"],h:["hecto",100,"h"],e:["dekao",10,"e"],d:["deci",.1,"d"],c:["centi",.01,"c"],m:["milli",.001,"m"],u:["micro",1e-6,"u"],n:["nano",1e-9,"n"],p:["pico",1e-12,"p"],f:["femto",1e-15,"f"],a:["atto",1e-18,"a"],z:["zepto",1e-21,"z"],y:["yocto",1e-24,"y"]},c=null,l=null,a=t,v=i,w=1,b=1,o;for(e=0;e<f.length;e++)o=f[e][2]===null?[]:f[e][2],(f[e][1]===a||o.indexOf(a)>=0)&&(c=f[e]),(f[e][1]===v||o.indexOf(v)>=0)&&(l=f[e]);if(c===null)for(k=g[t.substring(0,2)],y=nt[t.substring(0,1)],t.substring(0,2)==="da"&&(y=["dekao",10,"da"]),k?(w=k[2],a=t.substring(2)):y&&(w=y[1],a=t.substring(y[2].length)),s=0;s<f.length;s++)o=f[s][2]===null?[]:f[s][2],(f[s][1]===a||o.indexOf(a)>=0)&&(c=f[s]);if(l===null)for(d=g[i.substring(0,2)],p=nt[i.substring(0,1)],i.substring(0,2)==="da"&&(p=["dekao",10,"da"]),d?(b=d[2],v=i.substring(2)):p&&(b=p[1],v=i.substring(p[2].length)),h=0;h<f.length;h++)o=f[h][2]===null?[]:f[h][2],(f[h][1]===v||o.indexOf(v)>=0)&&(l=f[h]);return c===null||l===null?r.na:c[3]!==l[3]?r.na:n*c[6]*w/(l[6]*b)};t.DEC2BIN=function(n,t){if(n=u.parseNumber(n),n instanceof Error)return n;if(!/^-?[0-9]{1,3}$/.test(n)||n<-512||n>511)return r.num;if(n<0)return"1"+f.REPT("0",9-(512+n).toString(2).length)+(512+n).toString(2);var i=parseInt(n,10).toString(2);return typeof t=="undefined"?i:isNaN(t)?r.value:t<0?r.num:(t=Math.floor(t),t>=i.length?f.REPT("0",t-i.length)+i:r.num)};t.DEC2HEX=function(n,t){if(n=u.parseNumber(n),n instanceof Error)return n;if(!/^-?[0-9]{1,12}$/.test(n)||n<-549755813888||n>549755813887)return r.num;if(n<0)return(1099511627776+n).toString(16);var i=parseInt(n,10).toString(16);return typeof t=="undefined"?i:isNaN(t)?r.value:t<0?r.num:(t=Math.floor(t),t>=i.length?f.REPT("0",t-i.length)+i:r.num)};t.DEC2OCT=function(n,t){if(n=u.parseNumber(n),n instanceof Error)return n;if(!/^-?[0-9]{1,9}$/.test(n)||n<-536870912||n>536870911)return r.num;if(n<0)return(1073741824+n).toString(8);var i=parseInt(n,10).toString(8);return typeof t=="undefined"?i:isNaN(t)?r.value:t<0?r.num:(t=Math.floor(t),t>=i.length?f.REPT("0",t-i.length)+i:r.num)};t.DELTA=function(n,t){return(t=t===undefined?0:t,n=u.parseNumber(n),t=u.parseNumber(t),u.anyIsError(n,t))?r.value:n===t?1:0};t.ERF=function(n,t){return(t=t===undefined?0:t,n=u.parseNumber(n),t=u.parseNumber(t),u.anyIsError(n,t))?r.value:s.erf(n)};t.ERF.PRECISE=function(){throw new Error("ERF.PRECISE is not implemented");};t.ERFC=function(n){return isNaN(n)?r.value:s.erfc(n)};t.ERFC.PRECISE=function(){throw new Error("ERFC.PRECISE is not implemented");};t.GESTEP=function(n,t){return(t=t||0,n=u.parseNumber(n),u.anyIsError(t,n))?n:n>=t?1:0};t.HEX2BIN=function(n,t){var e,i,u;return/^[0-9A-Fa-f]{1,10}$/.test(n)?(e=n.length===10&&n.substring(0,1).toLowerCase()==="f"?!0:!1,i=e?parseInt(n,16)-1099511627776:parseInt(n,16),i<-512||i>511)?r.num:e?"1"+f.REPT("0",9-(512+i).toString(2).length)+(512+i).toString(2):(u=i.toString(2),t===undefined?u:isNaN(t)?r.value:t<0?r.num:(t=Math.floor(t),t>=u.length?f.REPT("0",t-u.length)+u:r.num)):r.num};t.HEX2DEC=function(n){if(!/^[0-9A-Fa-f]{1,10}$/.test(n))return r.num;var t=parseInt(n,16);return t>=549755813888?t-1099511627776:t};t.HEX2OCT=function(n,t){var i,u;return/^[0-9A-Fa-f]{1,10}$/.test(n)?(i=parseInt(n,16),i>536870911&&i<0xffe0000000)?r.num:i>=0xffe0000000?(i-0xffc0000000).toString(8):(u=i.toString(8),t===undefined?u:isNaN(t)?r.value:t<0?r.num:(t=Math.floor(t),t>=u.length?f.REPT("0",t-u.length)+u:r.num)):r.num};t.IMABS=function(n){var i=t.IMREAL(n),f=t.IMAGINARY(n);return u.anyIsError(i,f)?r.value:Math.sqrt(Math.pow(i,2)+Math.pow(f,2))};t.IMAGINARY=function(n){var t,i,u,f;return n===undefined||n===!0||n===!1?r.value:n===0||n==="0"?0:["i","j"].indexOf(n)>=0?1:(n=n.replace("+i","+1i").replace("-i","-1i").replace("+j","+1j").replace("-j","-1j"),t=n.indexOf("+"),i=n.indexOf("-"),t===0&&(t=n.indexOf("+",1)),i===0&&(i=n.indexOf("-",1)),u=n.substring(n.length-1,n.length),f=u==="i"||u==="j",t>=0||i>=0?f?t>=0?isNaN(n.substring(0,t))||isNaN(n.substring(t+1,n.length-1))?r.num:Number(n.substring(t+1,n.length-1)):isNaN(n.substring(0,i))||isNaN(n.substring(i+1,n.length-1))?r.num:-Number(n.substring(i+1,n.length-1)):r.num:f?isNaN(n.substring(0,n.length-1))?r.num:n.substring(0,n.length-1):isNaN(n)?r.num:0)};t.IMARGUMENT=function(n){var i=t.IMREAL(n),f=t.IMAGINARY(n);return u.anyIsError(i,f)?r.value:i===0&&f===0?r.div0:i===0&&f>0?Math.PI/2:i===0&&f<0?-Math.PI/2:f===0&&i>0?0:f===0&&i<0?-Math.PI:i>0?Math.atan(f/i):i<0&&f>=0?Math.atan(f/i)+Math.PI:Math.atan(f/i)-Math.PI};t.IMCONJUGATE=function(n){var e=t.IMREAL(n),f=t.IMAGINARY(n),i;return u.anyIsError(e,f)?r.value:(i=n.substring(n.length-1),i=i==="i"||i==="j"?i:"i",f!==0?t.COMPLEX(e,-f,i):n)};t.IMCOS=function(n){var e=t.IMREAL(n),f=t.IMAGINARY(n),i;return u.anyIsError(e,f)?r.value:(i=n.substring(n.length-1),i=i==="i"||i==="j"?i:"i",t.COMPLEX(Math.cos(e)*(Math.exp(f)+Math.exp(-f))/2,-Math.sin(e)*(Math.exp(f)-Math.exp(-f))/2,i))};t.IMCOSH=function(n){var f=t.IMREAL(n),e=t.IMAGINARY(n),i;return u.anyIsError(f,e)?r.value:(i=n.substring(n.length-1),i=i==="i"||i==="j"?i:"i",t.COMPLEX(Math.cos(e)*(Math.exp(f)+Math.exp(-f))/2,Math.sin(e)*(Math.exp(f)-Math.exp(-f))/2,i))};t.IMCOT=function(n){var i=t.IMREAL(n),f=t.IMAGINARY(n);return u.anyIsError(i,f)?r.value:t.IMDIV(t.IMCOS(n),t.IMSIN(n))};t.IMDIV=function(n,i){var o=t.IMREAL(n),s=t.IMAGINARY(n),f=t.IMREAL(i),e=t.IMAGINARY(i),c;if(u.anyIsError(o,s,f,e))return r.value;var l=n.substring(n.length-1),a=i.substring(i.length-1),h="i";return(l==="j"?h="j":a==="j"&&(h="j"),f===0&&e===0)?r.num:(c=f*f+e*e,t.COMPLEX((o*f+s*e)/c,(s*f-o*e)/c,h))};t.IMEXP=function(n){var o=t.IMREAL(n),f=t.IMAGINARY(n),i,e;return u.anyIsError(o,f)?r.value:(i=n.substring(n.length-1),i=i==="i"||i==="j"?i:"i",e=Math.exp(o),t.COMPLEX(e*Math.cos(f),e*Math.sin(f),i))};t.IMLN=function(n){var f=t.IMREAL(n),e=t.IMAGINARY(n),i;return u.anyIsError(f,e)?r.value:(i=n.substring(n.length-1),i=i==="i"||i==="j"?i:"i",t.COMPLEX(Math.log(Math.sqrt(f*f+e*e)),Math.atan(e/f),i))};t.IMLOG10=function(n){var f=t.IMREAL(n),e=t.IMAGINARY(n),i;return u.anyIsError(f,e)?r.value:(i=n.substring(n.length-1),i=i==="i"||i==="j"?i:"i",t.COMPLEX(Math.log(Math.sqrt(f*f+e*e))/Math.log(10),Math.atan(e/f)/Math.log(10),i))};t.IMLOG2=function(n){var f=t.IMREAL(n),e=t.IMAGINARY(n),i;return u.anyIsError(f,e)?r.value:(i=n.substring(n.length-1),i=i==="i"||i==="j"?i:"i",t.COMPLEX(Math.log(Math.sqrt(f*f+e*e))/Math.log(2),Math.atan(e/f)/Math.log(2),i))};t.IMPOWER=function(n,i){var s,h,f,e,o;return(i=u.parseNumber(i),s=t.IMREAL(n),h=t.IMAGINARY(n),u.anyIsError(i,s,h))?r.value:(f=n.substring(n.length-1),f=f==="i"||f==="j"?f:"i",e=Math.pow(t.IMABS(n),i),o=t.IMARGUMENT(n),t.COMPLEX(e*Math.cos(i*o),e*Math.sin(i*o),f))};t.IMPRODUCT=function(){var i=arguments[0],n;if(!arguments.length)return r.value;for(n=1;n<arguments.length;n++){var f=t.IMREAL(i),e=t.IMAGINARY(i),o=t.IMREAL(arguments[n]),s=t.IMAGINARY(arguments[n]);if(u.anyIsError(f,e,o,s))return r.value;i=t.COMPLEX(f*o-e*s,f*s+e*o)}return i};t.IMREAL=function(n){var t,i,u,f;return n===undefined||n===!0||n===!1?r.value:n===0||n==="0"?0:["i","+i","1i","+1i","-i","-1i","j","+j","1j","+1j","-j","-1j"].indexOf(n)>=0?0:(t=n.indexOf("+"),i=n.indexOf("-"),t===0&&(t=n.indexOf("+",1)),i===0&&(i=n.indexOf("-",1)),u=n.substring(n.length-1,n.length),f=u==="i"||u==="j",t>=0||i>=0?f?t>=0?isNaN(n.substring(0,t))||isNaN(n.substring(t+1,n.length-1))?r.num:Number(n.substring(0,t)):isNaN(n.substring(0,i))||isNaN(n.substring(i+1,n.length-1))?r.num:Number(n.substring(0,i)):r.num:f?isNaN(n.substring(0,n.length-1))?r.num:0:isNaN(n)?r.num:n)};t.IMSEC=function(n){if(n===!0||n===!1)return r.value;var i=t.IMREAL(n),f=t.IMAGINARY(n);return u.anyIsError(i,f)?r.value:t.IMDIV("1",t.IMCOS(n))};t.IMSECH=function(n){var i=t.IMREAL(n),f=t.IMAGINARY(n);return u.anyIsError(i,f)?r.value:t.IMDIV("1",t.IMCOSH(n))};t.IMSIN=function(n){var e=t.IMREAL(n),f=t.IMAGINARY(n),i;return u.anyIsError(e,f)?r.value:(i=n.substring(n.length-1),i=i==="i"||i==="j"?i:"i",t.COMPLEX(Math.sin(e)*(Math.exp(f)+Math.exp(-f))/2,Math.cos(e)*(Math.exp(f)-Math.exp(-f))/2,i))};t.IMSINH=function(n){var f=t.IMREAL(n),e=t.IMAGINARY(n),i;return u.anyIsError(f,e)?r.value:(i=n.substring(n.length-1),i=i==="i"||i==="j"?i:"i",t.COMPLEX(Math.cos(e)*(Math.exp(f)-Math.exp(-f))/2,Math.sin(e)*(Math.exp(f)+Math.exp(-f))/2,i))};t.IMSQRT=function(n){var o=t.IMREAL(n),s=t.IMAGINARY(n),i,f,e;return u.anyIsError(o,s)?r.value:(i=n.substring(n.length-1),i=i==="i"||i==="j"?i:"i",f=Math.sqrt(t.IMABS(n)),e=t.IMARGUMENT(n),t.COMPLEX(f*Math.cos(e/2),f*Math.sin(e/2),i))};t.IMCSC=function(n){if(n===!0||n===!1)return r.value;var i=t.IMREAL(n),f=t.IMAGINARY(n);return u.anyIsError(i,f)?r.num:t.IMDIV("1",t.IMSIN(n))};t.IMCSCH=function(n){if(n===!0||n===!1)return r.value;var i=t.IMREAL(n),f=t.IMAGINARY(n);return u.anyIsError(i,f)?r.num:t.IMDIV("1",t.IMSINH(n))};t.IMSUB=function(n,t){var f=this.IMREAL(n),e=this.IMAGINARY(n),o=this.IMREAL(t),s=this.IMAGINARY(t);if(u.anyIsError(f,e,o,s))return r.value;var h=n.substring(n.length-1),c=t.substring(t.length-1),i="i";return h==="j"?i="j":c==="j"&&(i="j"),this.COMPLEX(f-o,e-s,i)};t.IMSUM=function(){var n,t,i;if(!arguments.length)return r.value;for(n=u.flatten(arguments),t=n[0],i=1;i<n.length;i++){var f=this.IMREAL(t),e=this.IMAGINARY(t),o=this.IMREAL(n[i]),s=this.IMAGINARY(n[i]);if(u.anyIsError(f,e,o,s))return r.value;t=this.COMPLEX(f+o,e+s)}return t};t.IMTAN=function(n){if(n===!0||n===!1)return r.value;var i=t.IMREAL(n),f=t.IMAGINARY(n);return u.anyIsError(i,f)?r.value:this.IMDIV(this.IMSIN(n),this.IMCOS(n))};t.OCT2BIN=function(n,t){var e,i,u;return/^[0-7]{1,10}$/.test(n)?(e=n.length===10&&n.substring(0,1)==="7"?!0:!1,i=e?parseInt(n,8)-1073741824:parseInt(n,8),i<-512||i>511)?r.num:e?"1"+f.REPT("0",9-(512+i).toString(2).length)+(512+i).toString(2):(u=i.toString(2),typeof t=="undefined"?u:isNaN(t)?r.value:t<0?r.num:(t=Math.floor(t),t>=u.length?f.REPT("0",t-u.length)+u:r.num)):r.num};t.OCT2DEC=function(n){if(!/^[0-7]{1,10}$/.test(n))return r.num;var t=parseInt(n,8);return t>=536870912?t-1073741824:t};t.OCT2HEX=function(n,t){var u,i;return/^[0-7]{1,10}$/.test(n)?(u=parseInt(n,8),u>=536870912)?"ff"+(u+3221225472).toString(16):(i=u.toString(16),t===undefined?i:isNaN(t)?r.value:t<0?r.num:(t=Math.floor(t),t>=i.length?f.REPT("0",t-i.length)+i:r.num)):r.num}},function(n,t){"use strict";t.__esModule=!0;t["default"]=["ABS","ACCRINT","ACOS","ACOSH","ACOT","ACOTH","ADD","AGGREGATE","AND","ARABIC","ARGS2ARRAY","ASIN","ASINH","ATAN","ATAN2","ATANH","AVEDEV","AVERAGE","AVERAGEA","AVERAGEIF","AVERAGEIFS","BASE","BESSELI","BESSELJ","BESSELK","BESSELY","BETA.DIST","BETA.INV","BETADIST","BETAINV","BIN2DEC","BIN2HEX","BIN2OCT","BINOM.DIST","BINOM.DIST.RANGE","BINOM.INV","BINOMDIST","BITAND","BITLSHIFT","BITOR","BITRSHIFT","BITXOR","CEILING","CEILINGMATH","CEILINGPRECISE","CHAR","CHISQ.DIST","CHISQ.DIST.RT","CHISQ.INV","CHISQ.INV.RT","CHOOSE","CHOOSE","CLEAN","CODE","COLUMN","COLUMNS","COMBIN","COMBINA","COMPLEX","CONCATENATE","CONFIDENCE","CONFIDENCE.NORM","CONFIDENCE.T","CONVERT","CORREL","COS","COSH","COT","COTH","COUNT","COUNTA","COUNTBLANK","COUNTIF","COUNTIFS","COUNTIN","COUNTUNIQUE","COVARIANCE.P","COVARIANCE.S","CSC","CSCH","CUMIPMT","CUMPRINC","DATE","DATEVALUE","DAY","DAYS","DAYS360","DB","DDB","DEC2BIN","DEC2HEX","DEC2OCT","DECIMAL","DEGREES","DELTA","DEVSQ","DIVIDE","DOLLAR","DOLLARDE","DOLLARFR","E","EDATE","EFFECT","EOMONTH","EQ","ERF","ERFC","EVEN","EXACT","EXP","EXPON.DIST","EXPONDIST","F.DIST","F.DIST.RT","F.INV","F.INV.RT","FACT","FACTDOUBLE","FALSE","FDIST","FDISTRT","FIND","FINV","FINVRT","FISHER","FISHERINV","FIXED","FLATTEN","FLOOR","FORECAST","FREQUENCY","FV","FVSCHEDULE","GAMMA","GAMMA.DIST","GAMMA.INV","GAMMADIST","GAMMAINV","GAMMALN","GAMMALN.PRECISE","GAUSS","GCD","GEOMEAN","GESTEP","GROWTH","GTE","HARMEAN","HEX2BIN","HEX2DEC","HEX2OCT","HOUR","HTML2TEXT","HYPGEOM.DIST","HYPGEOMDIST","IF","IMABS","IMAGINARY","IMARGUMENT","IMCONJUGATE","IMCOS","IMCOSH","IMCOT","IMCSC","IMCSCH","IMDIV","IMEXP","IMLN","IMLOG10","IMLOG2","IMPOWER","IMPRODUCT","IMREAL","IMSEC","IMSECH","IMSIN","IMSINH","IMSQRT","IMSUB","IMSUM","IMTAN","INT","INTERCEPT","INTERVAL","IPMT","IRR","ISBINARY","ISBLANK","ISEVEN","ISLOGICAL","ISNONTEXT","ISNUMBER","ISODD","ISODD","ISOWEEKNUM","ISPMT","ISTEXT","JOIN","KURT","LARGE","LCM","LEFT","LEN","LINEST","LN","LOG","LOG10","LOGEST","LOGNORM.DIST","LOGNORM.INV","LOGNORMDIST","LOGNORMINV","LOWER","LT","LTE","MATCH","MAX","MAXA","MEDIAN","MID","MIN","MINA","MINUS","MINUTE","MIRR","MOD","MODE.MULT","MODE.SNGL","MODEMULT","MODESNGL","MONTH","MROUND","MULTINOMIAL","MULTIPLY","NE","NEGBINOM.DIST","NEGBINOMDIST","NETWORKDAYS","NOMINAL","NORM.DIST","NORM.INV","NORM.S.DIST","NORM.S.INV","NORMDIST","NORMINV","NORMSDIST","NORMSINV","NOT","NOW","NPER","NPV","NUMBERS","NUMERAL","OCT2BIN","OCT2DEC","OCT2HEX","ODD","OR","PDURATION","PEARSON","PERCENTILEEXC","PERCENTILEINC","PERCENTRANKEXC","PERCENTRANKINC","PERMUT","PERMUTATIONA","PHI","PI","PMT","POISSON.DIST","POISSONDIST","POW","POWER","PPMT","PROB","PRODUCT","PROPER","PV","QUARTILE.EXC","QUARTILE.INC","QUARTILEEXC","QUARTILEINC","QUOTIENT","RADIANS","RAND","RANDBETWEEN","RANK.AVG","RANK.EQ","RANKAVG","RANKEQ","RATE","REFERENCE","REGEXEXTRACT","REGEXMATCH","REGEXREPLACE","REPLACE","REPT","RIGHT","ROMAN","ROUND","ROUNDDOWN","ROUNDUP","ROW","ROWS","RRI","RSQ","SEARCH","SEC","SECH","SECOND","SERIESSUM","SIGN","SIN","SINH","SKEW","SKEW.P","SKEWP","SLN","SLOPE","SMALL","SPLIT","SPLIT","SQRT","SQRTPI","STANDARDIZE","STDEV.P","STDEV.S","STDEVA","STDEVP","STDEVPA","STDEVS","STEYX","SUBSTITUTE","SUBTOTAL","SUM","SUMIF","SUMIFS","SUMPRODUCT","SUMSQ","SUMX2MY2","SUMX2PY2","SUMXMY2","SWITCH","SYD","T","T.DIST","T.DIST.2T","T.DIST.RT","T.INV","T.INV.2T","TAN","TANH","TBILLEQ","TBILLPRICE","TBILLYIELD","TDIST","TDIST2T","TDISTRT","TEXT","TIME","TIMEVALUE","TINV","TINV2T","TODAY","TRANSPOSE","TREND","TRIM","TRIMMEAN","TRUE","TRUNC","UNICHAR","UNICODE","UNIQUE","UPPER","VALUE","VAR.P","VAR.S","VARA","VARP","VARPA","VARS","WEEKDAY","WEEKNUM","WEIBULL.DIST","WEIBULLDIST","WORKDAY","XIRR","XNPV","XOR","YEAR","YEARFRAC"]},function(n,t){"use strict";function f(n){var t=parseInt(n,10);return isNaN(t)?-1:Math.max(t-1,-1)}function e(n){var t="";return n>=0&&(t=""+(n+1)),t}function o(n){var u=0,t,f;if(typeof n=="string")for(n=n.toUpperCase(),t=0,f=n.length-1;t<n.length;t+=1,f-=1)u+=Math.pow(i,f)*(r.indexOf(n[t])+1);return--u,u}function s(n){for(var t="";n>=0;)t=String.fromCharCode(n%i+97)+t,n=Math.floor(n/i)-1;return t.toUpperCase()}function h(n){if(typeof n!="string"||!u.test(n))return[];var t=n.toUpperCase().match(u),e=t[1],i=t[2],s=t[3],r=t[4];return[{index:f(r),label:r,isAbsolute:s==="$"},{index:o(i),label:i,isAbsolute:e==="$"}]}function c(n,t){var i=(n.isAbsolute?"$":"")+e(n.index),r=(t.isAbsolute?"$":"")+s(t.index);return r+i}var r,i,u;t.__esModule=!0;t.rowLabelToIndex=f;t.rowIndexToLabel=e;t.columnLabelToIndex=o;t.columnIndexToLabel=s;t.extractLabel=h;t.toLabel=c;r="ABCDEFGHIJKLMNOPQRSTUVWXYZ";i=r.length;u=/^([$])?([A-Za-z]+)([$])?([0-9]+)$/},function(n,t,i){"use strict";function f(n){return n&&n.__esModule?n:{"default":n}}t.__esModule=!0;t.rowLabelToIndex=t.rowIndexToLabel=t.columnLabelToIndex=t.columnIndexToLabel=t.toLabel=t.extractLabel=t.error=t.Parser=t.ERROR_VALUE=t.ERROR_REF=t.ERROR_NUM=t.ERROR_NULL=t.ERROR_NOT_AVAILABLE=t.ERROR_NAME=t.ERROR_DIV_ZERO=t.ERROR=t.SUPPORTED_FORMULAS=undefined;var e=i(17),o=f(e),s=i(14),h=f(s),r=i(2),c=f(r),u=i(15);t.SUPPORTED_FORMULAS=h["default"];t.ERROR=r.ERROR;t.ERROR_DIV_ZERO=r.ERROR_DIV_ZERO;t.ERROR_NAME=r.ERROR_NAME;t.ERROR_NOT_AVAILABLE=r.ERROR_NOT_AVAILABLE;t.ERROR_NULL=r.ERROR_NULL;t.ERROR_NUM=r.ERROR_NUM;t.ERROR_REF=r.ERROR_REF;t.ERROR_VALUE=r.ERROR_VALUE;t.Parser=o["default"];t.error=c["default"];t.extractLabel=u.extractLabel;t.toLabel=u.toLabel;t.columnIndexToLabel=u.columnIndexToLabel;t.columnLabelToIndex=u.columnLabelToIndex;t.rowIndexToLabel=u.rowIndexToLabel;t.rowLabelToIndex=u.rowLabelToIndex},function(n,t,i){"use strict";function e(n){return n&&n.__esModule?n:{"default":n}}function p(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function w(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function b(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var h;t.__esModule=!0;var c=i(18),l=e(c),a=i(19),o=e(a),v=i(41),y=i(43),s=i(3),r=i(2),f=e(r),u=i(15);h=function(n){function t(){p(this,t);var i=w(this,n.call(this));return i.parser=new v.Parser,i.parser.yy={toNumber:s.toNumber,trimEdges:y.trimEdges,invertNumber:s.invertNumber,throwError:function(n){return i._throwError(n)},callVariable:function(n){return i._callVariable(n)},evaluateByOperator:o["default"],callFunction:function(n,t){return i._callFunction(n,t)},cellValue:function(n){return i._callCellValue(n)},rangeValue:function(n,t){return i._callRangeValue(n,t)}},i.variables=Object.create(null),i.functions=Object.create(null),i.setVariable("TRUE",!0).setVariable("FALSE",!1).setVariable("NULL",null),i}return b(t,n),t.prototype.parse=function(n){var t=null,i=null,u;try{t=n===""?"":this.parser.parse(n)}catch(e){u=f["default"](e.message);i=u?u:f["default"](r.ERROR)}return t instanceof Error&&(i=f["default"](t.message)||f["default"](r.ERROR),t=null),{error:i,result:t}},t.prototype.setVariable=function(n,t){return this.variables[n]=t,this},t.prototype.getVariable=function(n){return this.variables[n]},t.prototype._callVariable=function(n){var t=this.getVariable(n);if(this.emit("callVariable",n,function(n){n!==void 0&&(t=n)}),t===void 0)throw Error(r.ERROR_NAME);return t},t.prototype.setFunction=function(n,t){return this.functions[n]=t,this},t.prototype.getFunction=function(n){return this.functions[n]},t.prototype._callFunction=function(n){var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[],r=this.getFunction(n),t=void 0;return r&&(t=r(i)),this.emit("callFunction",n,i,function(n){n!==void 0&&(t=n)}),t===void 0?o["default"](n,i):t},t.prototype._callCellValue=function(n){n=n.toUpperCase();var t=u.extractLabel(n),r=t[0],f=t[1],i=void 0;return this.emit("callCellValue",{label:n,row:r,column:f},function(n){i=n}),i},t.prototype._callRangeValue=function(n,t){var h;n=n.toUpperCase();t=t.toUpperCase();var c=u.extractLabel(n),f=c[0],e=c[1],l=u.extractLabel(t),o=l[0],s=l[1],i={},r={};return f.index<=o.index?(i.row=f,r.row=o):(i.row=o,r.row=f),e.index<=s.index?(i.column=e,r.column=s):(i.column=s,r.column=e),i.label=u.toLabel(i.row,i.column),r.label=u.toLabel(r.row,r.column),h=[],this.emit("callRangeValue",i,r,function(){var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];h=n}),h},t.prototype._throwError=function(n){if(r.isValidStrict(n))throw Error(n);throw Error(r.ERROR);},t}(l["default"]);t["default"]=h},function(n){function t(){}t.prototype={on:function(n,t,i){var r=this.e||(this.e={});return(r[n]||(r[n]=[])).push({fn:t,ctx:i}),this},once:function(n,t,i){function r(){u.off(n,r);t.apply(i,arguments)}var u=this;r._=t;return this.on(n,r,i)},emit:function(n){var r=[].slice.call(arguments,1),i=((this.e||(this.e={}))[n]||[]).slice(),t=0,u=i.length;for(t;t<u;t++)i[t].fn.apply(i[t].ctx,r);return this},off:function(n,t){var u=this.e||(this.e={}),r=u[n],f=[],i,e;if(r&&t)for(i=0,e=r.length;i<e;i++)r[i].fn!==t&&r[i].fn._!==t&&f.push(r[i]);return f.length?u[n]=f:delete u[n],this}};n.exports=t},function(n,t,i){"use strict";function u(n){return n&&n.__esModule?n:{"default":n}}function at(n){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];if(n=n.toUpperCase(),!f[n])throw Error(lt.ERROR_NAME);return f[n].apply(f,t)}function r(n,t){Array.isArray(n)||(n=[n.toUpperCase()]);n.forEach(function(n){f[n]=t.isFactory?t(n):t})}var f;t.__esModule=!0;t["default"]=at;t.registerOperation=r;var d=i(20),e=u(d),g=i(21),o=u(g),nt=i(22),s=u(nt),tt=i(23),h=u(tt),it=i(24),c=u(it),rt=i(33),l=u(rt),ut=i(34),a=u(ut),ft=i(35),v=u(ft),et=i(36),y=u(et),ot=i(37),p=u(ot),st=i(38),w=u(st),ht=i(39),b=u(ht),ct=i(40),k=u(ct),lt=i(2);f=Object.create(null);r(e["default"].SYMBOL,e["default"]);r(o["default"].SYMBOL,o["default"]);r(s["default"].SYMBOL,s["default"]);r(h["default"].SYMBOL,h["default"]);r(k["default"].SYMBOL,k["default"]);r(c["default"].SYMBOL,c["default"]);r(l["default"].SYMBOL,l["default"]);r(a["default"].SYMBOL,a["default"]);r(v["default"].SYMBOL,v["default"]);r(y["default"].SYMBOL,y["default"]);r(w["default"].SYMBOL,w["default"]);r(b["default"].SYMBOL,b["default"]);r(p["default"].SYMBOL,p["default"])},function(n,t,i){"use strict";function u(n){for(var u,i=arguments.length,e=Array(i>1?i-1:0),t=1;t<i;t++)e[t-1]=arguments[t];if(u=e.reduce(function(n,t){return n+r.toNumber(t)},r.toNumber(n)),isNaN(u))throw Error(f.ERROR_VALUE);return u}t.__esModule=!0;t.SYMBOL=undefined;t["default"]=u;var r=i(3),f=i(2),e=t.SYMBOL="+";u.SYMBOL=e},function(n,t){"use strict";function i(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];return i.reduce(function(n,t){return n+t.toString()},"")}t.__esModule=!0;t["default"]=i;var r=t.SYMBOL="&";i.SYMBOL=r},function(n,t,i){"use strict";function f(n){for(var i,f=arguments.length,e=Array(f>1?f-1:0),t=1;t<f;t++)e[t-1]=arguments[t];if(i=e.reduce(function(n,t){return n/r.toNumber(t)},r.toNumber(n)),i===Infinity)throw Error(u.ERROR_DIV_ZERO);if(isNaN(i))throw Error(u.ERROR_VALUE);return i}t.__esModule=!0;t.SYMBOL=undefined;t["default"]=f;var r=i(3),u=i(2),e=t.SYMBOL="/";f.SYMBOL=e},function(n,t){"use strict";function i(n,t){return n===t}t.__esModule=!0;t["default"]=i;var r=t.SYMBOL="=";i.SYMBOL=r},function(n,t,i){"use strict";function c(n){return n&&n.__esModule?n:{"default":n}}function l(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t["default"]=n,t}function u(n){return function(){n=n.toUpperCase();var i=n.split("."),u=!1,f=void 0;if(i.length===1)r[i[0]]&&(u=!0,f=r[i[0]].apply(r,arguments));else{for(var o=i.length,e=0,t=r;e<o;)if(t=t[i[e]],e++,!t){t=null;break}t&&(u=!0,f=t.apply(undefined,arguments))}if(!u)throw Error(h.ERROR_NAME);return f}}var f;t.__esModule=!0;t.SYMBOL=undefined;t["default"]=u;var e=i(25),r=l(e),o=i(14),s=c(o),h=i(2);f=t.SYMBOL=s["default"];u.isFactory=!0;u.SYMBOL=f},function(n,t,i){var f=[i(26),i(29),i(13),i(30),i(4),i(6),i(8),i(31),i(7),i(32),i(5),i(12)],e,u,r;for(e in f){u=f[e];for(r in u)t[r]=t[r]||u[r]}},function(n,t,i){function u(n,t){if(t)for(var i in t)n[i]=t[i];return n}var f=i(4),r=i(5),e=i(13),o=i(8);t.BETADIST=r.BETA.DIST;t.BETAINV=r.BETA.INV;t.BINOMDIST=r.BINOM.DIST;t.CEILING=t.ISOCEILING=u(f.CEILING.MATH,f.CEILING);t.CEILINGMATH=f.CEILING.MATH;t.CEILINGPRECISE=f.CEILING.PRECISE;t.CHIDIST=r.CHISQ.DIST;t.CHIDISTRT=r.CHISQ.DIST.RT;t.CHIINV=r.CHISQ.INV;t.CHIINVRT=r.CHISQ.INV.RT;t.CHITEST=r.CHISQ.TEST;t.CONFIDENCE=u(r.CONFIDENCE.NORM,r.CONFIDENCE);t.COVAR=r.COVARIANCE.P;t.COVARIANCEP=r.COVARIANCE.P;t.COVARIANCES=r.COVARIANCE.S;t.CRITBINOM=r.BINOM.INV;t.EXPONDIST=r.EXPON.DIST;t.ERFCPRECISE=e.ERFC.PRECISE;t.ERFPRECISE=e.ERF.PRECISE;t.FDIST=r.F.DIST;t.FDISTRT=r.F.DIST.RT;t.FINVRT=r.F.INV.RT;t.FINV=r.F.INV;t.FLOOR=u(f.FLOOR.MATH,f.FLOOR);t.FLOORMATH=f.FLOOR.MATH;t.FLOORPRECISE=f.FLOOR.PRECISE;t.FTEST=r.F.TEST;t.GAMMADIST=r.GAMMA.DIST;t.GAMMAINV=r.GAMMA.INV;t.GAMMALNPRECISE=r.GAMMALN.PRECISE;t.HYPGEOMDIST=r.HYPGEOM.DIST;t.LOGINV=r.LOGNORM.INV;t.LOGNORMINV=r.LOGNORM.INV;t.LOGNORMDIST=r.LOGNORM.DIST;t.MODE=u(r.MODE.SNGL,r.MODE);t.MODEMULT=r.MODE.MULT;t.MODESNGL=r.MODE.SNGL;t.NEGBINOMDIST=r.NEGBINOM.DIST;t.NETWORKDAYSINTL=o.NETWORKDAYS.INTL;t.NORMDIST=r.NORM.DIST;t.NORMINV=r.NORM.INV;t.NORMSDIST=r.NORM.S.DIST;t.NORMSINV=r.NORM.S.INV;t.PERCENTILE=u(r.PERCENTILE.EXC,r.PERCENTILE);t.PERCENTILEEXC=r.PERCENTILE.EXC;t.PERCENTILEINC=r.PERCENTILE.INC;t.PERCENTRANK=u(r.PERCENTRANK.INC,r.PERCENTRANK);t.PERCENTRANKEXC=r.PERCENTRANK.EXC;t.PERCENTRANKINC=r.PERCENTRANK.INC;t.POISSON=u(r.POISSON.DIST,r.POISSON);t.POISSONDIST=r.POISSON.DIST;t.QUARTILE=u(r.QUARTILE.INC,r.QUARTILE);t.QUARTILEEXC=r.QUARTILE.EXC;t.QUARTILEINC=r.QUARTILE.INC;t.RANK=u(r.RANK.EQ,r.RANK);t.RANKAVG=r.RANK.AVG;t.RANKEQ=r.RANK.EQ;t.SKEWP=r.SKEW.P;t.STDEV=u(r.STDEV.S,r.STDEV);t.STDEVP=r.STDEV.P;t.STDEVS=r.STDEV.S;t.TDIST=r.T.DIST;t.TDISTRT=r.T.DIST.RT;t.TINV=r.T.INV;t.TTEST=r.T.TEST;t.VAR=u(r.VAR.S,r.VAR);t.VARP=r.VAR.P;t.VARS=r.VAR.S;t.WEIBULL=u(r.WEIBULL.DIST,r.WEIBULL);t.WEIBULLDIST=r.WEIBULL.DIST;t.WORKDAYINTL=o.WORKDAY.INTL;t.ZTEST=r.Z.TEST},function(){},function(n,t){function r(n,t){return n.reduce(function(n,i){return t*n+i},0)}function e(n,t,i,r,u){var e,o,f;if(u||(u=-1),e=2/n,t===0)return i;if(t===1)return r;for(f=1;f!=t;++f)o=r*f*e+u*i,i=r,r=o;return r}function o(n,t,i,r,u){return function(f,o){if(o===0)return n(f);if(o===1)return t(f);if(o<0)throw i+": Order ("+o+") must be nonnegative";if(r==1&&f===0)throw i+": Undefined when x == 0";if(r==2&&f<=0)throw i+": Undefined when x <= 0";var s=n(f),h=t(f);return e(f,o,s,h,u)}}var i=Math,u=function(){function t(t){var l,e,c,u=t*t,a=i.abs(t)-.785398164;return i.abs(t)<8?(e=r(f,u),c=r(o,u),l=e/c):(u=64/u,e=r(s,u),c=r(h,u),l=i.sqrt(n/i.abs(t))*(i.cos(a)*e-i.sin(a)*c*8/i.abs(t))),l}function u(t){var f,e,o,u=t*t,s=i.abs(t)-2.356194491;return Math.abs(t)<8?(e=t*r(c,u),o=r(l,u),f=e/o):(u=64/u,e=r(a,u),o=r(v,u),f=i.sqrt(n/i.abs(t))*(i.cos(s)*e-i.sin(s)*o*8/i.abs(t)),t<0&&(f=-f)),f}var f=[57568490574,-13362590354,651619640.7,-11214424.18,77392.33017,-184.9052456].reverse(),o=[57568490411,1029532985,9494680.718,59272.64853,267.8532712,1].reverse(),s=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),h=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934935152e-16].reverse(),n=.636619772,c=[72362614232,-7895059235,242396853.1,-2972611.439,15704.4826,-30.16036606].reverse(),l=[144725228442,2300535178,18583304.74,99447.43394,376.9991397,1].reverse(),a=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),v=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse();return function(n,r){if(r=Math.round(r),r===0)return t(i.abs(n));if(r===1)return u(i.abs(n));if(r<0)throw"BESSELJ: Order ("+r+") must be nonnegative";if(i.abs(n)===0)return 0;var o,h,y=2/i.abs(n),a,l,s,c,f,v;if(i.abs(n)>r)o=e(n,r,t(i.abs(n)),u(i.abs(n)),-1);else{for(a=2*i.floor((r+i.floor(i.sqrt(40*r)))/2),l=0,c=o=s=0,f=1,h=a;h>0;h--)v=h*y*f-c,c=f,f=v,i.abs(f)>1e10&&(f*=1e-10,c*=1e-10,o*=1e-10,s*=1e-10),l&&(s+=f),l=!l,h==r&&(o=c);s=2*s-f;o/=s}return n<0&&r%2?-o:o}}(),s=function(){function h(o){var a,c,l,h=o*o,v=o-.785398164;return o<8?(c=r(t,h),l=r(f,h),a=c/l+n*u(o,0)*i.log(o)):(h=64/h,c=r(e,h),l=r(s,h),a=i.sqrt(n/o)*(i.sin(v)*c+i.cos(v)*l*8/o)),a}function y(t){var s,e,o,f=t*t,h=t-2.356194491;return t<8?(e=t*r(c,f),o=r(l,f),s=e/o+n*(u(t,1)*i.log(t)-1/t)):(f=64/f,e=r(a,f),o=r(v,f),s=i.sqrt(n/t)*(i.sin(h)*e+i.cos(h)*o*8/t)),s}var t=[-2957821389,7062834065,-512359803.6,10879881.29,-86327.92757,228.4622733].reverse(),f=[40076544269,745249964.8,7189466.438,47447.2647,226.1030244,1].reverse(),e=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),s=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934945152e-16].reverse(),n=.636619772,c=[-4900604943e3,127527439e4,-51534381390,734926455.1,-4237922.726,8511.937935].reverse(),l=[249958057e5,424441966400,3733650367,22459040.02,102042.605,354.9632885,1].reverse(),a=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),v=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse();return o(h,y,"BESSELY",1,-1)}(),f=function(){function u(u){return u<=3.75?r(n,u*u/(3.75*3.75)):i.exp(i.abs(u))/i.sqrt(i.abs(u))*r(t,3.75/i.abs(u))}function o(n){return n<3.75?n*r(f,n*n/(3.75*3.75)):(n<0?-1:1)*i.exp(i.abs(n))/i.sqrt(i.abs(n))*r(e,3.75/i.abs(n))}var n=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse(),t=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse(),f=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,.00032411].reverse(),e=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse();return function s(n,t){if(t=Math.round(t),t===0)return u(n);if(t==1)return o(n);if(t<0)throw"BESSELI Order ("+t+") must be nonnegative";if(i.abs(n)===0)return 0;var f,e,a=2/i.abs(n),c,h,r,l;for(c=2*i.round((t+i.round(i.sqrt(40*t)))/2),h=f=0,r=1,e=c;e>0;e--)l=e*a*r+h,h=r,r=l,i.abs(r)>1e10&&(r*=1e-10,h*=1e-10,f*=1e-10),e==t&&(f=h);return f*=s(n,0)/r,n<0&&t%2?-f:f}}(),h=function(){function u(u){return u<=2?-i.log(u/2)*f(u,0)+r(n,u*u/4):i.exp(-u)/i.sqrt(u)*r(t,2/u)}function h(n){return n<=2?i.log(n/2)*f(n,1)+1/n*r(e,n*n/4):i.exp(-n)/i.sqrt(n)*r(s,2/n)}var n=[-.57721566,.4227842,.23069756,.0348859,.00262698,.0001075,74e-7].reverse(),t=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,.00053208].reverse(),e=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-4686e-8].reverse(),s=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-.00068245].reverse();return o(u,h,"BESSELK",2,1)}();!0&&(t.besselj=u,t.bessely=s,t.besseli=f,t.besselk=h)},function(n,t,i){function o(n){var t=[];return r.arrayEach(n,function(n){n&&t.push(n)}),t}function f(database,criterias){for(var maxCriteriaLength,k,l,currentCriteriaResult,hasMatchingCriteria,j,criteria,criteriaField,p,result,n,matches={},i=1;i<database[0].length;++i)matches[i]=!0;for(maxCriteriaLength=criterias[0].length,i=1;i<criterias.length;++i)criterias[i].length>maxCriteriaLength&&(maxCriteriaLength=criterias[i].length);for(k=1;k<database.length;++k)for(l=1;l<database[k].length;++l){for(currentCriteriaResult=!1,hasMatchingCriteria=!1,j=0;j<criterias.length;++j)if((criteria=criterias[j],!(criteria.length<maxCriteriaLength))&&(criteriaField=criteria[0],database[k][0]===criteriaField))for(hasMatchingCriteria=!0,p=1;p<criteria.length;++p)currentCriteriaResult=currentCriteriaResult||eval(database[k][l]+criteria[p]);hasMatchingCriteria&&(matches[l]=matches[l]&&currentCriteriaResult)}for(result=[],n=0;n<database[0].length;++n)matches[n]&&result.push(n-1);return result}var u=i(0),e=i(5),s=i(4),r=i(1);t.FINDFIELD=function(n,t){var i=null;return(r.arrayEach(n,function(n,r){if(n[0]===t)return i=r,!1}),i==null)?u.value:i};t.DAVERAGE=function(n,i,e){var o,s,c,h;return isNaN(i)&&typeof i!="string"?u.value:(o=f(n,e),s=[],typeof i=="string"?(c=t.FINDFIELD(n,i),s=r.rest(n[c])):s=r.rest(n[i]),h=0,r.arrayEach(o,function(n){h+=s[n]}),o.length===0?u.div0:h/o.length)};t.DCOUNT=function(n,i,o){var c,s,l,h;return isNaN(i)&&typeof i!="string"?u.value:(c=f(n,o),s=[],typeof i=="string"?(l=t.FINDFIELD(n,i),s=r.rest(n[l])):s=r.rest(n[i]),h=[],r.arrayEach(c,function(n){h.push(s[n])}),e.COUNT(h))};t.DCOUNTA=function(n,i,o){var c,s,l,h;return isNaN(i)&&typeof i!="string"?u.value:(c=f(n,o),s=[],typeof i=="string"?(l=t.FINDFIELD(n,i),s=r.rest(n[l])):s=r.rest(n[i]),h=[],r.arrayEach(c,function(n){h.push(s[n])}),e.COUNTA(h))};t.DGET=function(n,i,e){var o,s,h;return isNaN(i)&&typeof i!="string"?u.value:(o=f(n,e),s=[],typeof i=="string"?(h=t.FINDFIELD(n,i),s=r.rest(n[h])):s=r.rest(n[i]),o.length===0)?u.value:o.length>1?u.num:s[o[0]]};t.DMAX=function(n,i,e){var h,o,c,s;return isNaN(i)&&typeof i!="string"?u.value:(h=f(n,e),o=[],typeof i=="string"?(c=t.FINDFIELD(n,i),o=r.rest(n[c])):o=r.rest(n[i]),s=o[h[0]],r.arrayEach(h,function(n){s<o[n]&&(s=o[n])}),s)};t.DMIN=function(n,i,e){var h,o,c,s;return isNaN(i)&&typeof i!="string"?u.value:(h=f(n,e),o=[],typeof i=="string"?(c=t.FINDFIELD(n,i),o=r.rest(n[c])):o=r.rest(n[i]),s=o[h[0]],r.arrayEach(h,function(n){s>o[n]&&(s=o[n])}),s)};t.DPRODUCT=function(n,i,e){var l,h,a,s,c;return isNaN(i)&&typeof i!="string"?u.value:(l=f(n,e),h=[],typeof i=="string"?(a=t.FINDFIELD(n,i),h=r.rest(n[a])):h=r.rest(n[i]),s=[],r.arrayEach(l,function(n){s.push(h[n])}),s=o(s),c=1,r.arrayEach(s,function(n){c*=n}),c)};t.DSTDEV=function(n,i,s){var l,c,a,h;return isNaN(i)&&typeof i!="string"?u.value:(l=f(n,s),c=[],typeof i=="string"?(a=t.FINDFIELD(n,i),c=r.rest(n[a])):c=r.rest(n[i]),h=[],r.arrayEach(l,function(n){h.push(c[n])}),h=o(h),e.STDEV.S(h))};t.DSTDEVP=function(n,i,s){var l,c,a,h;return isNaN(i)&&typeof i!="string"?u.value:(l=f(n,s),c=[],typeof i=="string"?(a=t.FINDFIELD(n,i),c=r.rest(n[a])):c=r.rest(n[i]),h=[],r.arrayEach(l,function(n){h.push(c[n])}),h=o(h),e.STDEV.P(h))};t.DSUM=function(n,i,e){var c,o,l,h;return isNaN(i)&&typeof i!="string"?u.value:(c=f(n,e),o=[],typeof i=="string"?(l=t.FINDFIELD(n,i),o=r.rest(n[l])):o=r.rest(n[i]),h=[],r.arrayEach(c,function(n){h.push(o[n])}),s.SUM(h))};t.DVAR=function(n,i,o){var c,s,l,h;return isNaN(i)&&typeof i!="string"?u.value:(c=f(n,o),s=[],typeof i=="string"?(l=t.FINDFIELD(n,i),s=r.rest(n[l])):s=r.rest(n[i]),h=[],r.arrayEach(c,function(n){h.push(s[n])}),e.VAR.S(h))};t.DVARP=function(n,i,o){var c,s,l,h;return isNaN(i)&&typeof i!="string"?u.value:(c=f(n,o),s=[],typeof i=="string"?(l=t.FINDFIELD(n,i),s=r.rest(n[l])):s=r.rest(n[i]),h=[],r.arrayEach(c,function(n){h.push(s[n])}),e.VAR.P(h))}},function(n,t,i){var r=i(0),u=i(1),f=i(7);t.AND=function(){for(var t=u.flatten(arguments),i=!0,n=0;n<t.length;n++)t[n]||(i=!1);return i};t.CHOOSE=function(){if(arguments.length<2)return r.na;var n=arguments[0];return n<1||n>254?r.value:arguments.length<n+1?r.value:arguments[n]};t.FALSE=function(){return!1};t.IF=function(n,t,i){return n?t:i};t.IFERROR=function(n,t){return f.ISERROR(n)?t:n};t.IFNA=function(n,t){return n===r.na?t:n};t.NOT=function(n){return!n};t.OR=function(){for(var t=u.flatten(arguments),i=!1,n=0;n<t.length;n++)t[n]&&(i=!0);return i};t.TRUE=function(){return!0};t.XOR=function(){for(var t=u.flatten(arguments),i=0,n=0;n<t.length;n++)t[n]&&i++;return Math.floor(Math.abs(i))&1?!0:!1};t.SWITCH=function(){var t,n;if(arguments.length>0){var e=arguments[0],i=arguments.length-1,u=Math.floor(i/2),f=!1,o=i%2!=0,s=i%2==0?null:arguments[arguments.length-1];if(u)for(n=0;n<u;n++)if(e===arguments[n*2+1]){t=arguments[n*2+2];f=!0;break}f||(t=o?s:r.na)}else t=r.value;return t}},function(n,t,i){function e(n){return n&&n.getTime&&!isNaN(n.getTime())}function o(n){return n instanceof Date?n:new Date(n)}var u=i(0),f=i(8),r=i(1);t.ACCRINT=function(n,t,i,r,s,h,c){return(n=o(n),t=o(t),i=o(i),!e(n)||!e(t)||!e(i))?u.value:r<=0||s<=0?u.num:[1,2,4].indexOf(h)===-1?u.num:[0,1,2,3,4].indexOf(c)===-1?u.num:i<=n?u.num:(s=s||0,c=c||0,s*r*f.YEARFRAC(n,i,c))};t.ACCRINTM=function(){throw new Error("ACCRINTM is not implemented");};t.AMORDEGRC=function(){throw new Error("AMORDEGRC is not implemented");};t.AMORLINC=function(){throw new Error("AMORLINC is not implemented");};t.COUPDAYBS=function(){throw new Error("COUPDAYBS is not implemented");};t.COUPDAYS=function(){throw new Error("COUPDAYS is not implemented");};t.COUPDAYSNC=function(){throw new Error("COUPDAYSNC is not implemented");};t.COUPNCD=function(){throw new Error("COUPNCD is not implemented");};t.COUPNUM=function(){throw new Error("COUPNUM is not implemented");};t.COUPPCD=function(){throw new Error("COUPPCD is not implemented");};t.CUMIPMT=function(n,i,f,e,o,s){var c,l,h;if(n=r.parseNumber(n),i=r.parseNumber(i),f=r.parseNumber(f),r.anyIsError(n,i,f))return u.value;if(n<=0||i<=0||f<=0||e<1||o<1||e>o||s!==0&&s!==1)return u.num;for(c=t.PMT(n,i,f,0,s),l=0,e===1&&s===0&&(l=-f,e++),h=e;h<=o;h++)l+=s===1?t.FV(n,h-2,c,f,1)-c:t.FV(n,h-1,c,f,0);return l*n};t.CUMPRINC=function(n,i,f,e,o,s){var h,l,c;if(n=r.parseNumber(n),i=r.parseNumber(i),f=r.parseNumber(f),r.anyIsError(n,i,f))return u.value;if(n<=0||i<=0||f<=0||e<1||o<1||e>o||s!==0&&s!==1)return u.num;for(h=t.PMT(n,i,f,0,s),l=0,e===1&&(l=s===0?h+f*n:h,e++),c=e;c<=o;c++)l+=s>0?h-(t.FV(n,c-2,h,f,1)-h)*n:h-t.FV(n,c-1,h,f,0)*n;return l};t.DB=function(n,t,i,f,e){var c;if(e=e===undefined?12:e,n=r.parseNumber(n),t=r.parseNumber(t),i=r.parseNumber(i),f=r.parseNumber(f),e=r.parseNumber(e),r.anyIsError(n,t,i,f,e))return u.value;if(n<0||t<0||i<0||f<0||[1,2,3,4,5,6,7,8,9,10,11,12].indexOf(e)===-1||f>i)return u.num;if(t>=n)return 0;var o=(1-Math.pow(t/n,1/i)).toFixed(3),l=n*o*e/12,s=l,h=0,a=f===i?i-1:f;for(c=2;c<=a;c++)h=(n-s)*o,s+=h;return f===1?l:f===i?(n-s)*o:h};t.DDB=function(n,t,i,f,e){var o,s,h;if(e=e===undefined?2:e,n=r.parseNumber(n),t=r.parseNumber(t),i=r.parseNumber(i),f=r.parseNumber(f),e=r.parseNumber(e),r.anyIsError(n,t,i,f,e))return u.value;if(n<0||t<0||i<0||f<0||e<=0||f>i)return u.num;if(t>=n)return 0;for(o=0,s=0,h=1;h<=f;h++)s=Math.min((n-o)*(e/i),n-t-o),o+=s;return s};t.DISC=function(){throw new Error("DISC is not implemented");};t.DOLLARDE=function(n,t){var i,f;return(n=r.parseNumber(n),t=r.parseNumber(t),r.anyIsError(n,t))?u.value:t<0?u.num:t>=0&&t<1?u.div0:(t=parseInt(t,10),i=parseInt(n,10),i+=n%1*Math.pow(10,Math.ceil(Math.log(t)/Math.LN10))/t,f=Math.pow(10,Math.ceil(Math.log(t)/Math.LN2)+1),Math.round(i*f)/f)};t.DOLLARFR=function(n,t){if(n=r.parseNumber(n),t=r.parseNumber(t),r.anyIsError(n,t))return u.value;if(t<0)return u.num;if(t>=0&&t<1)return u.div0;t=parseInt(t,10);var i=parseInt(n,10);return i+n%1*Math.pow(10,-Math.ceil(Math.log(t)/Math.LN10))*t};t.DURATION=function(){throw new Error("DURATION is not implemented");};t.EFFECT=function(n,t){return(n=r.parseNumber(n),t=r.parseNumber(t),r.anyIsError(n,t))?u.value:n<=0||t<1?u.num:(t=parseInt(t,10),Math.pow(1+n/t,t)-1)};t.FV=function(n,t,i,f,e){var s,o;return(f=f||0,e=e||0,n=r.parseNumber(n),t=r.parseNumber(t),i=r.parseNumber(i),f=r.parseNumber(f),e=r.parseNumber(e),r.anyIsError(n,t,i,f,e))?u.value:(n===0?s=f+i*t:(o=Math.pow(1+n,t),s=e===1?f*o+i*(1+n)*(o-1)/n:f*o+i*(o-1)/n),-s)};t.FVSCHEDULE=function(n,t){var e,f,i;if(n=r.parseNumber(n),t=r.parseNumberArray(r.flatten(t)),r.anyIsError(n,t))return u.value;for(e=t.length,f=n,i=0;i<e;i++)f*=1+t[i];return f};t.INTRATE=function(){throw new Error("INTRATE is not implemented");};t.IPMT=function(n,i,f,e,o,s){if(o=o||0,s=s||0,n=r.parseNumber(n),i=r.parseNumber(i),f=r.parseNumber(f),e=r.parseNumber(e),o=r.parseNumber(o),s=r.parseNumber(s),r.anyIsError(n,i,f,e,o,s))return u.value;var h=t.PMT(n,f,e,o,s),c;return c=i===1?s===1?0:-e:s===1?t.FV(n,i-2,h,e,1)-h:t.FV(n,i-1,h,e,0),c*n};t.IRR=function(n,t){var i;if(t=t||0,n=r.parseNumberArray(r.flatten(n)),t=r.parseNumber(t),r.anyIsError(n,t))return u.value;var y=function(n,t,i){for(var f=i+1,u=n[0],r=1;r<n.length;r++)u+=n[r]/Math.pow(f,(t[r]-t[0])/365);return u},p=function(n,t,i){for(var u,e=i+1,f=0,r=1;r<n.length;r++)u=(t[r]-t[0])/365,f-=u*n[r]/Math.pow(e,u+1);return f},e=[],h=!1,c=!1;for(i=0;i<n.length;i++)e[i]=i===0?0:e[i-1]+365,n[i]>0&&(h=!0),n[i]<0&&(c=!0);if(!h||!c)return u.num;t=t===undefined?.1:t;var f=t,l=1e-10,o,a,s,v=!0;do s=y(n,e,f),o=f-s/p(n,e,f),a=Math.abs(o-f),f=o,v=a>l&&Math.abs(s)>l;while(v);return f};t.ISPMT=function(n,t,i,f){return(n=r.parseNumber(n),t=r.parseNumber(t),i=r.parseNumber(i),f=r.parseNumber(f),r.anyIsError(n,t,i,f))?u.value:f*n*(t/i-1)};t.MDURATION=function(){throw new Error("MDURATION is not implemented");};t.MIRR=function(n,i,f){var e,c,l;if(n=r.parseNumberArray(r.flatten(n)),i=r.parseNumber(i),f=r.parseNumber(f),r.anyIsError(n,i,f))return u.value;var o=n.length,s=[],h=[];for(e=0;e<o;e++)n[e]<0?s.push(n[e]):h.push(n[e]);return c=-t.NPV(f,h)*Math.pow(1+f,o-1),l=t.NPV(i,s)*(1+i),Math.pow(c/l,1/(o-1))-1};t.NOMINAL=function(n,t){return(n=r.parseNumber(n),t=r.parseNumber(t),r.anyIsError(n,t))?u.value:n<=0||t<1?u.num:(t=parseInt(t,10),(Math.pow(n+1,1/t)-1)*t)};t.NPER=function(n,t,i,f,e){if(e=e===undefined?0:e,f=f===undefined?0:f,n=r.parseNumber(n),t=r.parseNumber(t),i=r.parseNumber(i),f=r.parseNumber(f),e=r.parseNumber(e),r.anyIsError(n,t,i,f,e))return u.value;var o=t*(1+n*e)-f*n,s=i*n+t*(1+n*e);return Math.log(o/s)/Math.log(1+n)};t.NPV=function(){var n=r.parseNumberArray(r.flatten(arguments)),u,i,t;if(n instanceof Error)return n;for(u=n[0],i=0,t=1;t<n.length;t++)i+=n[t]/Math.pow(1+u,t);return i};t.ODDFPRICE=function(){throw new Error("ODDFPRICE is not implemented");};t.ODDFYIELD=function(){throw new Error("ODDFYIELD is not implemented");};t.ODDLPRICE=function(){throw new Error("ODDLPRICE is not implemented");};t.ODDLYIELD=function(){throw new Error("ODDLYIELD is not implemented");};t.PDURATION=function(n,t,i){return(n=r.parseNumber(n),t=r.parseNumber(t),i=r.parseNumber(i),r.anyIsError(n,t,i))?u.value:n<=0?u.num:(Math.log(i)-Math.log(t))/Math.log(1+n)};t.PMT=function(n,t,i,f,e){var s,o;return(f=f||0,e=e||0,n=r.parseNumber(n),t=r.parseNumber(t),i=r.parseNumber(i),f=r.parseNumber(f),e=r.parseNumber(e),r.anyIsError(n,t,i,f,e))?u.value:(n===0?s=(i+f)/t:(o=Math.pow(1+n,t),s=e===1?(f*n/(o-1)+i*n/(1-1/o))/(1+n):f*n/(o-1)+i*n/(1-1/o)),-s)};t.PPMT=function(n,i,f,e,o,s){return(o=o||0,s=s||0,n=r.parseNumber(n),f=r.parseNumber(f),e=r.parseNumber(e),o=r.parseNumber(o),s=r.parseNumber(s),r.anyIsError(n,f,e,o,s))?u.value:t.PMT(n,f,e,o,s)-t.IPMT(n,i,f,e,o,s)};t.PRICE=function(){throw new Error("PRICE is not implemented");};t.PRICEDISC=function(){throw new Error("PRICEDISC is not implemented");};t.PRICEMAT=function(){throw new Error("PRICEMAT is not implemented");};t.PV=function(n,t,i,f,e){return(f=f||0,e=e||0,n=r.parseNumber(n),t=r.parseNumber(t),i=r.parseNumber(i),f=r.parseNumber(f),e=r.parseNumber(e),r.anyIsError(n,t,i,f,e))?u.value:n===0?-i*t-f:((1-Math.pow(1+n,t))/n*i*(1+n*e)-f)/Math.pow(1+n,t)};t.RATE=function(n,t,i,f,e,o){if(o=o===undefined?.01:o,f=f===undefined?0:f,e=e===undefined?0:e,n=r.parseNumber(n),t=r.parseNumber(t),i=r.parseNumber(i),f=r.parseNumber(f),e=r.parseNumber(e),o=r.parseNumber(o),r.anyIsError(n,t,i,f,e,o))return u.value;var y=1e-10,l,a,c,p,v=0,h=0,w=0,s=o;for(Math.abs(s)<y?l=i*(1+n*s)+t*(1+s*e)*n+f:(h=Math.exp(n*Math.log(1+s)),l=i*h+t*(1/s+e)*(h-1)+f),a=i+t*n+f,c=i*h+t*(1/s+e)*(h-1)+f,w=p=0,v=s;Math.abs(a-c)>y&&w<50;)s=(c*p-a*v)/(c-a),p=v,v=s,Math.abs(s)<y?l=i*(1+n*s)+t*(1+s*e)*n+f:(h=Math.exp(n*Math.log(1+s)),l=i*h+t*(1/s+e)*(h-1)+f),a=c,c=l,++w;return s};t.RECEIVED=function(){throw new Error("RECEIVED is not implemented");};t.RRI=function(n,t,i){return(n=r.parseNumber(n),t=r.parseNumber(t),i=r.parseNumber(i),r.anyIsError(n,t,i))?u.value:n===0||t===0?u.num:Math.pow(i/t,1/n)-1};t.SLN=function(n,t,i){return(n=r.parseNumber(n),t=r.parseNumber(t),i=r.parseNumber(i),r.anyIsError(n,t,i))?u.value:i===0?u.num:(n-t)/i};t.SYD=function(n,t,i,f){return(n=r.parseNumber(n),t=r.parseNumber(t),i=r.parseNumber(i),f=r.parseNumber(f),r.anyIsError(n,t,i,f))?u.value:i===0?u.num:f<1||f>i?u.num:(f=parseInt(f,10),(n-t)*(i-f+1)*2/(i*(i+1)))};t.TBILLEQ=function(n,t,i){return(n=r.parseDate(n),t=r.parseDate(t),i=r.parseNumber(i),r.anyIsError(n,t,i))?u.value:i<=0?u.num:n>t?u.num:t-n>31536e6?u.num:365*i/(360-i*f.DAYS360(n,t,!1))};t.TBILLPRICE=function(n,t,i){return(n=r.parseDate(n),t=r.parseDate(t),i=r.parseNumber(i),r.anyIsError(n,t,i))?u.value:i<=0?u.num:n>t?u.num:t-n>31536e6?u.num:100*(1-i*f.DAYS360(n,t,!1)/360)};t.TBILLYIELD=function(n,t,i){return(n=r.parseDate(n),t=r.parseDate(t),i=r.parseNumber(i),r.anyIsError(n,t,i))?u.value:i<=0?u.num:n>t?u.num:t-n>31536e6?u.num:(100-i)*360/(i*f.DAYS360(n,t,!1))};t.VDB=function(){throw new Error("VDB is not implemented");};t.XNPV=function(n,t,i){var o,e;if(n=r.parseNumber(n),t=r.parseNumberArray(r.flatten(t)),i=r.parseDateArray(r.flatten(i)),r.anyIsError(n,t,i))return u.value;for(o=0,e=0;e<t.length;e++)o+=t[e]/Math.pow(1+n,f.DAYS(i[e],i[0])/365);return o};t.YIELD=function(){throw new Error("YIELD is not implemented");};t.YIELDDISC=function(){throw new Error("YIELDDISC is not implemented");};t.YIELDMAT=function(){throw new Error("YIELDMAT is not implemented");}},function(n,t,i){var r=i(0),u=i(1);t.MATCH=function(n,t,i){var e,f,u;if(!n&&!t||(arguments.length===2&&(i=1),!(t instanceof Array))||i!==-1&&i!==0&&i!==1)return r.na;for(u=0;u<t.length;u++)if(i===1){if(t[u]===n)return u+1;t[u]<n&&(f?t[u]>f&&(e=u+1,f=t[u]):(e=u+1,f=t[u]))}else if(i===0){if(typeof n=="string"){if(n=n.replace(/\?/g,"."),t[u].toLowerCase().match(n.toLowerCase()))return u+1}else if(t[u]===n)return u+1}else if(i===-1){if(t[u]===n)return u+1;t[u]>n&&(f?t[u]<f&&(e=u+1,f=t[u]):(e=u+1,f=t[u]))}return e?e:r.na};t.VLOOKUP=function(n,t,i,u){var e,f;if(!n||!t||!i)return r.na;for(u=u||!1,e=0;e<t.length;e++)if(f=t[e],!u&&f[0]===n||f[0]===n||u&&typeof f[0]=="string"&&f[0].toLowerCase().indexOf(n.toLowerCase())!==-1)return i<f.length+1?f[i-1]:r.ref;return r.na};t.HLOOKUP=function(n,t,i,f){var s,o,e;if(!n||!t||!i)return r.na;for(f=f||!1,s=u.transpose(t),o=0;o<s.length;o++)if(e=s[o],!f&&e[0]===n||e[0]===n||f&&typeof e[0]=="string"&&e[0].toLowerCase().indexOf(n.toLowerCase())!==-1)return i<e.length+1?e[i-1]:r.ref;return r.na}},function(n,t){"use strict";function i(n,t){return n>t}t.__esModule=!0;t["default"]=i;var r=t.SYMBOL=">";i.SYMBOL=r},function(n,t){"use strict";function i(n,t){return n>=t}t.__esModule=!0;t["default"]=i;var r=t.SYMBOL=">=";i.SYMBOL=r},function(n,t){"use strict";function i(n,t){return n<t}t.__esModule=!0;t["default"]=i;var r=t.SYMBOL="<";i.SYMBOL=r},function(n,t){"use strict";function i(n,t){return n<=t}t.__esModule=!0;t["default"]=i;var r=t.SYMBOL="<=";i.SYMBOL=r},function(n,t,i){"use strict";function u(n){for(var u,i=arguments.length,e=Array(i>1?i-1:0),t=1;t<i;t++)e[t-1]=arguments[t];if(u=e.reduce(function(n,t){return n-r.toNumber(t)},r.toNumber(n)),isNaN(u))throw Error(f.ERROR_VALUE);return u}t.__esModule=!0;t.SYMBOL=undefined;t["default"]=u;var r=i(3),f=i(2),e=t.SYMBOL="-";u.SYMBOL=e},function(n,t,i){"use strict";function u(n){for(var u,i=arguments.length,e=Array(i>1?i-1:0),t=1;t<i;t++)e[t-1]=arguments[t];if(u=e.reduce(function(n,t){return n*r.toNumber(t)},r.toNumber(n)),isNaN(u))throw Error(f.ERROR_VALUE);return u}t.__esModule=!0;t.SYMBOL=undefined;t["default"]=u;var r=i(3),f=i(2),e=t.SYMBOL="*";u.SYMBOL=e},function(n,t){"use strict";function i(n,t){return n!==t}t.__esModule=!0;t["default"]=i;var r=t.SYMBOL="<>";i.SYMBOL=r},function(n,t,i){"use strict";function u(n,t){var i=Math.pow(r.toNumber(n),r.toNumber(t));if(isNaN(i))throw Error(f.ERROR_VALUE);return i}t.__esModule=!0;t.SYMBOL=undefined;t["default"]=u;var r=i(3),f=i(2),e=t.SYMBOL="^";u.SYMBOL=e},function(n,t,i){(function(n,r){var u=function(){function ot(){this.yy={}}var n=function(n,t,i,r){for(i=i||{},r=n.length;r--;i[n[r]]=t);return i},r=[1,5],u=[1,8],f=[1,6],e=[1,7],o=[1,9],s=[1,14],h=[1,15],c=[1,16],l=[1,12],a=[1,13],i=[1,17],v=[1,19],tt=[1,20],b=[1,21],d=[1,22],g=[1,23],nt=[1,24],k=[1,25],p=[1,26],w=[1,27],y=[1,28],t=[5,9,10,11,13,14,15,16,17,18,19,20,29,30],st=[5,9,10,11,13,14,15,16,17,18,19,20,29,30,32],ft=[5,9,10,11,13,14,15,16,17,18,19,20,29,30,34],rt=[5,10,11,13,14,15,16,17,29,30],it=[5,10,13,14,15,16,29,30],ht=[5,10,11,13,14,15,16,17,18,19,29,30],ut=[13,29,30],et={trace:function(){},yy:{},symbols_:{error:2,expressions:3,expression:4,EOF:5,variableSequence:6,number:7,STRING:8,"&":9,"=":10,"+":11,"(":12,")":13,"<":14,">":15,NOT:16,"-":17,"*":18,"/":19,"^":20,FUNCTION:21,expseq:22,cell:23,ABSOLUTE_CELL:24,RELATIVE_CELL:25,MIXED_CELL:26,":":27,ARRAY:28,";":29,",":30,VARIABLE:31,DECIMAL:32,NUMBER:33,"%":34,ERROR:35,$accept:0,$end:1},terminals_:{5:"EOF",8:"STRING",9:"&",10:"=",11:"+",12:"(",13:")",14:"<",15:">",16:"NOT",17:"-",18:"*",19:"/",20:"^",21:"FUNCTION",24:"ABSOLUTE_CELL",25:"RELATIVE_CELL",26:"MIXED_CELL",27:":",28:"ARRAY",29:";",30:",",31:"VARIABLE",32:"DECIMAL",33:"NUMBER",34:"%",35:"ERROR"},productions_:[0,[3,2],[4,1],[4,1],[4,1],[4,3],[4,3],[4,3],[4,3],[4,4],[4,4],[4,4],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,2],[4,2],[4,3],[4,4],[4,1],[4,1],[4,2],[23,1],[23,1],[23,1],[23,3],[23,3],[23,3],[23,3],[23,3],[23,3],[23,3],[23,3],[23,3],[22,1],[22,1],[22,3],[22,3],[6,1],[6,3],[7,1],[7,3],[7,2],[2,1]],performAction:function(yytext,yyleng,yylineno,yy,yystate,$$){var $0=$$.length-1,n1,result,arr;switch(yystate){case 1:return $$[$0-1];case 2:this.$=yy.callVariable($$[$0][0]);break;case 3:this.$=yy.toNumber($$[$0]);break;case 4:this.$=yy.trimEdges($$[$0]);break;case 5:this.$=yy.evaluateByOperator("&",[$$[$0-2],$$[$0]]);break;case 6:this.$=yy.evaluateByOperator("=",[$$[$0-2],$$[$0]]);break;case 7:this.$=yy.evaluateByOperator("+",[$$[$0-2],$$[$0]]);break;case 8:this.$=$$[$0-1];break;case 9:this.$=yy.evaluateByOperator("<=",[$$[$0-3],$$[$0]]);break;case 10:this.$=yy.evaluateByOperator(">=",[$$[$0-3],$$[$0]]);break;case 11:this.$=yy.evaluateByOperator("<>",[$$[$0-3],$$[$0]]);break;case 12:this.$=yy.evaluateByOperator("NOT",[$$[$0-2],$$[$0]]);break;case 13:this.$=yy.evaluateByOperator(">",[$$[$0-2],$$[$0]]);break;case 14:this.$=yy.evaluateByOperator("<",[$$[$0-2],$$[$0]]);break;case 15:this.$=yy.evaluateByOperator("-",[$$[$0-2],$$[$0]]);break;case 16:this.$=yy.evaluateByOperator("*",[$$[$0-2],$$[$0]]);break;case 17:this.$=yy.evaluateByOperator("/",[$$[$0-2],$$[$0]]);break;case 18:this.$=yy.evaluateByOperator("^",[$$[$0-2],$$[$0]]);break;case 19:n1=yy.invertNumber($$[$0]);this.$=n1;isNaN(this.$)&&(this.$=0);break;case 20:n1=yy.toNumber($$[$0]);this.$=n1;isNaN(this.$)&&(this.$=0);break;case 21:this.$=yy.callFunction($$[$0-2]);break;case 22:this.$=yy.callFunction($$[$0-3],$$[$0-1]);break;case 26:case 27:case 28:this.$=yy.cellValue($$[$0]);break;case 29:case 30:case 31:case 32:case 33:case 34:case 35:case 36:case 37:this.$=yy.rangeValue($$[$0-2],$$[$0]);break;case 38:case 42:this.$=[$$[$0]];break;case 39:result=[];arr=eval("["+yytext+"]");arr.forEach(function(n){result.push(n)});this.$=result;break;case 40:case 41:$$[$0-2].push($$[$0]);this.$=$$[$0-2];break;case 43:this.$=Array.isArray($$[$0-2])?$$[$0-2]:[$$[$0-2]];this.$.push($$[$0]);break;case 44:this.$=$$[$0];break;case 45:this.$=($$[$0-2]+"."+$$[$0])*1;break;case 46:this.$=$$[$0-1]*.01;break;case 47:this.$=yy.throwError($$[$0])}},table:[{2:11,3:1,4:2,6:3,7:4,8:r,11:u,12:f,17:e,21:o,23:10,24:s,25:h,26:c,31:l,33:a,35:i},{1:[3]},{5:[1,18],9:v,10:tt,11:b,14:d,15:g,16:nt,17:k,18:p,19:w,20:y},n(t,[2,2],{32:[1,29]}),n(t,[2,3],{34:[1,30]}),n(t,[2,4]),{2:11,4:31,6:3,7:4,8:r,11:u,12:f,17:e,21:o,23:10,24:s,25:h,26:c,31:l,33:a,35:i},{2:11,4:32,6:3,7:4,8:r,11:u,12:f,17:e,21:o,23:10,24:s,25:h,26:c,31:l,33:a,35:i},{2:11,4:33,6:3,7:4,8:r,11:u,12:f,17:e,21:o,23:10,24:s,25:h,26:c,31:l,33:a,35:i},{12:[1,34]},n(t,[2,23]),n(t,[2,24],{2:35,35:i}),n(st,[2,42]),n(ft,[2,44],{32:[1,36]}),n(t,[2,26],{27:[1,37]}),n(t,[2,27],{27:[1,38]}),n(t,[2,28],{27:[1,39]}),n([5,9,10,11,13,14,15,16,17,18,19,20,29,30,35],[2,47]),{1:[2,1]},{2:11,4:40,6:3,7:4,8:r,11:u,12:f,17:e,21:o,23:10,24:s,25:h,26:c,31:l,33:a,35:i},{2:11,4:41,6:3,7:4,8:r,11:u,12:f,17:e,21:o,23:10,24:s,25:h,26:c,31:l,33:a,35:i},{2:11,4:42,6:3,7:4,8:r,11:u,12:f,17:e,21:o,23:10,24:s,25:h,26:c,31:l,33:a,35:i},{2:11,4:45,6:3,7:4,8:r,10:[1,43],11:u,12:f,15:[1,44],17:e,21:o,23:10,24:s,25:h,26:c,31:l,33:a,35:i},{2:11,4:47,6:3,7:4,8:r,10:[1,46],11:u,12:f,17:e,21:o,23:10,24:s,25:h,26:c,31:l,33:a,35:i},{2:11,4:48,6:3,7:4,8:r,11:u,12:f,17:e,21:o,23:10,24:s,25:h,26:c,31:l,33:a,35:i},{2:11,4:49,6:3,7:4,8:r,11:u,12:f,17:e,21:o,23:10,24:s,25:h,26:c,31:l,33:a,35:i},{2:11,4:50,6:3,7:4,8:r,11:u,12:f,17:e,21:o,23:10,24:s,25:h,26:c,31:l,33:a,35:i},{2:11,4:51,6:3,7:4,8:r,11:u,12:f,17:e,21:o,23:10,24:s,25:h,26:c,31:l,33:a,35:i},{2:11,4:52,6:3,7:4,8:r,11:u,12:f,17:e,21:o,23:10,24:s,25:h,26:c,31:l,33:a,35:i},{31:[1,53]},n(ft,[2,46]),{9:v,10:tt,11:b,13:[1,54],14:d,15:g,16:nt,17:k,18:p,19:w,20:y},n(rt,[2,19],{9:v,18:p,19:w,20:y}),n(rt,[2,20],{9:v,18:p,19:w,20:y}),{2:11,4:57,6:3,7:4,8:r,11:u,12:f,13:[1,55],17:e,21:o,22:56,23:10,24:s,25:h,26:c,28:[1,58],31:l,33:a,35:i},n(t,[2,25]),{33:[1,59]},{24:[1,60],25:[1,61],26:[1,62]},{24:[1,63],25:[1,64],26:[1,65]},{24:[1,66],25:[1,67],26:[1,68]},n(t,[2,5]),n([5,10,13,29,30],[2,6],{9:v,11:b,14:d,15:g,16:nt,17:k,18:p,19:w,20:y}),n(rt,[2,7],{9:v,18:p,19:w,20:y}),{2:11,4:69,6:3,7:4,8:r,11:u,12:f,17:e,21:o,23:10,24:s,25:h,26:c,31:l,33:a,35:i},{2:11,4:70,6:3,7:4,8:r,11:u,12:f,17:e,21:o,23:10,24:s,25:h,26:c,31:l,33:a,35:i},n(it,[2,14],{9:v,11:b,17:k,18:p,19:w,20:y}),{2:11,4:71,6:3,7:4,8:r,11:u,12:f,17:e,21:o,23:10,24:s,25:h,26:c,31:l,33:a,35:i},n(it,[2,13],{9:v,11:b,17:k,18:p,19:w,20:y}),n([5,10,13,16,29,30],[2,12],{9:v,11:b,14:d,15:g,17:k,18:p,19:w,20:y}),n(rt,[2,15],{9:v,18:p,19:w,20:y}),n(ht,[2,16],{9:v,20:y}),n(ht,[2,17],{9:v,20:y}),n([5,10,11,13,14,15,16,17,18,19,20,29,30],[2,18],{9:v}),n(st,[2,43]),n(t,[2,8]),n(t,[2,21]),{13:[1,72],29:[1,73],30:[1,74]},n(ut,[2,38],{9:v,10:tt,11:b,14:d,15:g,16:nt,17:k,18:p,19:w,20:y}),n(ut,[2,39]),n(ft,[2,45]),n(t,[2,29]),n(t,[2,30]),n(t,[2,31]),n(t,[2,32]),n(t,[2,33]),n(t,[2,34]),n(t,[2,35]),n(t,[2,36]),n(t,[2,37]),n(it,[2,9],{9:v,11:b,17:k,18:p,19:w,20:y}),n(it,[2,11],{9:v,11:b,17:k,18:p,19:w,20:y}),n(it,[2,10],{9:v,11:b,17:k,18:p,19:w,20:y}),n(t,[2,22]),{2:11,4:75,6:3,7:4,8:r,11:u,12:f,17:e,21:o,23:10,24:s,25:h,26:c,31:l,33:a,35:i},{2:11,4:76,6:3,7:4,8:r,11:u,12:f,17:e,21:o,23:10,24:s,25:h,26:c,31:l,33:a,35:i},n(ut,[2,40],{9:v,10:tt,11:b,14:d,15:g,16:nt,17:k,18:p,19:w,20:y}),n(ut,[2,41],{9:v,10:tt,11:b,14:d,15:g,16:nt,17:k,18:p,19:w,20:y})],defaultActions:{18:[2,1]},parseError:function(n,t){if(t.recoverable)this.trace(n);else{function i(n,t){this.message=n;this.hash=t}i.prototype=Error;throw new i(n,t);}},parse:function(n){function lt(n){u.length=u.length-2*n;o.length=o.length-n;i.length=i.length-n}var ht=this,u=[0],o=[null],i=[],h=this.table,it="",y=0,rt=0,p=0,w=2,b=1,ct=i.slice.call(arguments,1),t=Object.create(this.lexer),c={yy:{}},g,k,et,ut,r,a,e,f,ft,l,nt,s,ot,tt,d,v;for(g in this.yy)Object.prototype.hasOwnProperty.call(this.yy,g)&&(c.yy[g]=this.yy[g]);for(t.setInput(n,c.yy),c.yy.lexer=t,c.yy.parser=this,typeof t.yylloc=="undefined"&&(t.yylloc={}),k=t.yylloc,i.push(k),et=t.options&&t.options.ranges,this.parseError=typeof c.yy.parseError=="function"?c.yy.parseError:Object.getPrototypeOf(this).parseError,ut=function(){var n;return n=t.lex()||b,typeof n!="number"&&(n=ht.symbols_[n]||n),n},l={};;){if(e=u[u.length-1],this.defaultActions[e]?f=this.defaultActions[e]:((r===null||typeof r=="undefined")&&(r=ut()),f=h[e]&&h[e][r]),typeof f=="undefined"||!f.length||!f[0]){v="";function st(n){for(var t=u.length-1,i=0;;){if(w.toString()in h[n])return i;if(n===0||t<2)return!1;t-=2;n=u[t];++i}}if(p)a!==b&&(d=st(e));else{d=st(e);tt=[];for(nt in h[e])this.terminals_[nt]&&nt>w&&tt.push("'"+this.terminals_[nt]+"'");v=t.showPosition?"Parse error on line "+(y+1)+":\n"+t.showPosition()+"\nExpecting "+tt.join(", ")+", got '"+(this.terminals_[r]||r)+"'":"Parse error on line "+(y+1)+": Unexpected "+(r==b?"end of input":"'"+(this.terminals_[r]||r)+"'");this.parseError(v,{text:t.match,token:this.terminals_[r]||r,line:t.yylineno,loc:k,expected:tt,recoverable:d!==!1})}if(p==3){if(r===b||a===b)throw new Error(v||"Parsing halted while starting to recover from another error.");rt=t.yyleng;it=t.yytext;y=t.yylineno;k=t.yylloc;r=ut()}if(d===!1)throw new Error(v||"Parsing halted. No suitable error recovery rule available.");lt(d);a=r==w?null:r;r=w;e=u[u.length-1];f=h[e]&&h[e][w];p=3}if(f[0]instanceof Array&&f.length>1)throw new Error("Parse Error: multiple actions possible at state: "+e+", token: "+r);switch(f[0]){case 1:u.push(r);o.push(t.yytext);i.push(t.yylloc);u.push(f[1]);r=null;a?(r=a,a=null):(rt=t.yyleng,it=t.yytext,y=t.yylineno,k=t.yylloc,p>0&&p--);break;case 2:if(s=this.productions_[f[1]][1],l.$=o[o.length-s],l._$={first_line:i[i.length-(s||1)].first_line,last_line:i[i.length-1].last_line,first_column:i[i.length-(s||1)].first_column,last_column:i[i.length-1].last_column},et&&(l._$.range=[i[i.length-(s||1)].range[0],i[i.length-1].range[1]]),ft=this.performAction.apply(l,[it,rt,y,c.yy,f[1],o,i].concat(ct)),typeof ft!="undefined")return ft;s&&(u=u.slice(0,-2*s),o=o.slice(0,-1*s),i=i.slice(0,-1*s));u.push(this.productions_[f[1]][0]);o.push(l.$);i.push(l._$);ot=h[u[u.length-2]][u[u.length-1]];u.push(ot);break;case 3:return!0}}return!0}},ct=function(){return{EOF:1,parseError:function(n,t){if(this.yy.parser)this.yy.parser.parseError(n,t);else throw new Error(n);},setInput:function(n,t){return this.yy=t||this.yy||{},this._input=n,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var n=this._input[0],t;return this.yytext+=n,this.yyleng++,this.offset++,this.match+=n,this.matched+=n,t=n.match(/(?:\r\n?|\n).*/g),t?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),n},unput:function(n){var i=n.length,t=n.split(/(?:\r\n?|\n)/g),r,u;return this._input=n+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-i),this.offset-=i,r=this.match.split(/(?:\r\n?|\n)/g),this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),t.length-1&&(this.yylineno-=t.length-1),u=this.yylloc.range,this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:t?(t.length===r.length?this.yylloc.first_column:0)+r[r.length-t.length].length-t[0].length:this.yylloc.first_column-i},this.options.ranges&&(this.yylloc.range=[u[0],u[0]+this.yyleng-i]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){if(this.options.backtrack_lexer)this._backtrack=!0;else return this.parseError("Lexical error on line "+(this.yylineno+1)+". You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\n"+this.showPosition(),{text:"",token:null,line:this.yylineno});return this},less:function(n){this.unput(this.match.slice(n))},pastInput:function(){var n=this.matched.substr(0,this.matched.length-this.match.length);return(n.length>20?"...":"")+n.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var n=this.match;return n.length<20&&(n+=this._input.substr(0,20-n.length)),(n.substr(0,20)+(n.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var n=this.pastInput(),t=new Array(n.length+1).join("-");return n+this.upcomingInput()+"\n"+t+"^"},test_match:function(n,t){var u,i,r,f;if(this.options.backtrack_lexer&&(r={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(r.yylloc.range=this.yylloc.range.slice(0))),i=n[0].match(/(?:\r\n?|\n).*/g),i&&(this.yylineno+=i.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:i?i[i.length-1].length-i[i.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+n[0].length},this.yytext+=n[0],this.match+=n[0],this.matches=n,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(n[0].length),this.matched+=n[0],u=this.performAction.call(this,this.yy,this,t,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),u)return u;if(this._backtrack){for(f in r)this[f]=r[f];return!1}return!1},next:function(){var n,t,r,f,u,i;if(this.done)return this.EOF;for(this._input||(this.done=!0),this._more||(this.yytext="",this.match=""),u=this._currentRules(),i=0;i<u.length;i++)if(r=this._input.match(this.rules[u[i]]),r&&(!t||r[0].length>t[0].length))if(t=r,f=i,this.options.backtrack_lexer){if(n=this.test_match(r,u[i]),n!==!1)return n;if(this._backtrack){t=!1;continue}else return!1}else if(!this.options.flex)break;return t?(n=this.test_match(t,u[f]),n!==!1)?n:!1:this._input===""?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var n=this.next();return n?n:this.lex()},begin:function(n){this.conditionStack.push(n)},popState:function(){var n=this.conditionStack.length-1;return n>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(n){return n=this.conditionStack.length-1-Math.abs(n||0),n>=0?this.conditionStack[n]:"INITIAL"},pushState:function(n){this.begin(n)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(n,t,i,r){var u=r;switch(i){case 1:return 8;case 2:return 8;case 3:return 21;case 4:return 35;case 5:return 24;case 6:return 26;case 7:return 26;case 8:return 25;case 9:return 21;case 10:return 31;case 11:return 31;case 12:return 33;case 13:return 28;case 14:return 9;case 15:return" ";case 16:return 32;case 17:return 27;case 18:return 29;case 19:return 30;case 20:return 18;case 21:return 19;case 22:return 17;case 23:return 11;case 24:return 20;case 25:return 12;case 26:return 13;case 27:return 15;case 28:return 14;case 29:return 16;case 30:return'"';case 31:return"'";case 32:return"!";case 33:return 10;case 34:return 34;case 35:return"#";case 36:return 5}},rules:[/^(?:\s+)/,/^(?:"(\\["]|[^"])*")/,/^(?:'(\\[']|[^'])*')/,/^(?:[A-Za-z]{1,}[A-Za-z_0-9\.]+(?=[(]))/,/^(?:#[A-Z0-9\/]+(!|\?)?)/,/^(?:\$[A-Za-z]+\$[0-9]+)/,/^(?:\$[A-Za-z]+[0-9]+)/,/^(?:[A-Za-z]+\$[0-9]+)/,/^(?:[A-Za-z]+[0-9]+)/,/^(?:[A-Za-z\.]+(?=[(]))/,/^(?:[A-Za-z]{1,}[A-Za-z_0-9]+)/,/^(?:[A-Za-z_]+)/,/^(?:[0-9]+)/,/^(?:\[(.*)?\])/,/^(?:&)/,/^(?: )/,/^(?:[.])/,/^(?::)/,/^(?:;)/,/^(?:,)/,/^(?:\*)/,/^(?:\/)/,/^(?:-)/,/^(?:\+)/,/^(?:\^)/,/^(?:\()/,/^(?:\))/,/^(?:>)/,/^(?:<)/,/^(?:NOT\b)/,/^(?:")/,/^(?:')/,/^(?:!)/,/^(?:=)/,/^(?:%)/,/^(?:[#])/,/^(?:$)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36],inclusive:!0}}}}();return et.lexer=ct,ot.prototype=et,et.Parser=ot,new ot}();!0&&(t.parser=u,t.Parser=u.Parser,t.parse=function(){return u.parse.apply(u,arguments)},typeof n!="undefined"&&i.c[i.s]===n&&t.main(r.argv.slice(1)))}).call(t,i(42)(n),i(10))},function(n){n.exports=function(n){return n.webpackPolyfill||(n.deprecate=function(){},n.paths=[],n.children||(n.children=[]),Object.defineProperty(n,"loaded",{enumerable:!0,get:function(){return n.l}}),Object.defineProperty(n,"id",{enumerable:!0,get:function(){return n.i}}),n.webpackPolyfill=1),n}},function(n,t){"use strict";function i(n){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;return n.substring(t,n.length-t)}t.__esModule=!0;t.trimEdges=i}])})},function(n,t,i){"use strict";function a(n){return n&&n.__esModule?n:{"default":n}}function v(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}t.__esModule=!0;var u=function(){function n(n,t){var r=[],u=!0,f=!1,e=undefined,i,o;try{for(i=n[Symbol.iterator]();!(u=(o=i.next()).done);u=!0)if(r.push(o.value),t&&r.length===t)break}catch(s){f=!0;e=s}finally{try{!u&&i["return"]&&i["return"]()}finally{if(f)throw e;}}return r}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return n(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance");}}(),o=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),r=i(66),f=i(0),s=i(1),h=i(21),c=a(h),l=i(37);var y=/^\$?[A-Z]+\$?\d+$/,p=/\$?[A-Z]+\$?\d+/,w=/(?:[^0-9A-Z$: ]|^)\s*(\$?[A-Z]+\$?\d+)\s*(?![0-9A-Z_: ])/g,b=/\$?[A-Z]+\$?\d+\s*:\s*\$?[A-Z]+\$?\d+/g,k=/((?:[^0-9A-Z$: ]|^)\s*(\$?[A-Z]+\$?\d+)\s*(?![0-9A-Z_: ]))|(\$?[A-Z]+\$?\d+\s*:\s*\$?[A-Z]+\$?\d+)/g,e=function(){function n(t){v(this,n);this.expression="";this.cells=[];this.customModifier=null;typeof t=="string"&&this.setExpression(t)}return o(n,[{key:"setExpression",value:function(n){return this.cells.length=0,this.expression=l.toUpperCaseFormula(n),this._extractCells(),this._extractCellsRange(),this}},{key:"useCustomModifier",value:function(n){this.customModifier=n}},{key:"translate",value:function(n){var t=this,i=n.row,r=n.column,u=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};return f.arrayEach(this.cells,function(n){i!=null&&t._translateCell(n,"row",i,u.row);r!=null&&t._translateCell(n,"column",r,u.column)}),this}},{key:"toString",value:function(){var t=this,n=this.expression.replace(k,function(n,i,u){var s=n.indexOf(":")===-1,h=n,e=n,o=null,f;return s&&(e=y.test(i)?i:u),f=t._searchCell(e),f&&(o=f.refError?r.error(r.ERROR_REF):f.toLabel(),h=s?n.replace(e,o):o),h});return n.startsWith("=")||(n="="+n),n}},{key:"_translateCell",value:function(n,t,i,r){var h=n.start,c=n.end,l=h[t].index,a=c[t].index,e=i,o=i,f=!1,v,s;this.customModifier?(v=this.customModifier(n,t,i,r),s=u(v,3),e=s[0],o=s[1],f=s[2]):(h[t].isAbsolute&&(e=0),c[t].isAbsolute&&(o=0));e&&!f&&(l+e<0&&(f=!0),h[t].index=Math.max(l+e,0));o&&!f&&(a+o<0&&(f=!0),c[t].index=Math.max(a+o,0));f&&(n.refError=!0)}},{key:"_extractCells",value:function(){var n=this,t=this.expression.match(w);t&&f.arrayEach(t,function(t){if(t=t.match(p),t){var o=r.extractLabel(t[0]),i=u(o,2),f=i[0],e=i[1];n.cells.push(n._createCell({row:f,column:e},{row:f,column:e},t[0]))}})}},{key:"_extractCellsRange",value:function(){var n=this,t=this.expression.match(b);t&&f.arrayEach(t,function(t){var o=t.split(":"),i=u(o,2),s=i[0],h=i[1],c=r.extractLabel(s),f=u(c,2),l=f[0],a=f[1],v=r.extractLabel(h),e=u(v,2),y=e[0],p=e[1],w={row:l,column:a},b={row:y,column:p};n.cells.push(n._createCell(w,b,t))})}},{key:"_searchCell",value:function(n){var t=f.arrayFilter(this.cells,function(t){return t.origLabel===n}),i=u(t,1),r=i[0];return r||null}},{key:"_createCell",value:function(n,t,i){return{start:n,end:t,origLabel:i,type:i.indexOf(":")===-1?"cell":"range",refError:!1,toLabel:function(){var n=r.toLabel(this.start.row,this.start.column);return this.type==="range"&&(n+=":"+r.toLabel(this.end.row,this.end.column)),n}}}}]),n}();s.mixin(e,c.default);t.default=e},function(n){var t=Math.ceil,i=Math.floor;n.exports=function(n){return isNaN(n=+n)?0:(n>0?i:t)(n)}},function(n,t,i){var r=i(68),u=Math.max,f=Math.min;n.exports=function(n,t){return n=r(n),n<0?u(n+t,0):f(n,t)}},function(n,t,i){var r=i(38);n.exports=function(n,t,i){for(var u in t)r(n,u,t[u],i);return n}},function(n){n.exports=function(n){if(typeof n!="function")throw TypeError(n+" is not a function!");return n}},function(n){n.exports=function(n,t,i,r){if(!(n instanceof t)||r!==undefined&&r in n)throw TypeError(i+": incorrect invocation!");return n}},function(n,t,i){var f=i(40),e=i(168),o=i(169),s=i(20),h=i(28),c=i(170),r={},u={},t=n.exports=function(n,t,i,l,a){var w=a?function(){return n}:c(n),b=f(i,l,t?2:1),y=0,d,p,k,v;if(typeof w!="function")throw TypeError(n+" is not iterable!");if(o(w)){for(d=h(n.length);d>y;y++)if(v=t?b(s(p=n[y])[0],p[1]):b(n[y]),v===r||v===u)return v}else for(k=w.call(n);!(p=k.next()).done;)if(v=e(k,b,p.value,t),v===r||v===u)return v};t.BREAK=r;t.RETURN=u},function(n){n.exports=!1},function(n,t,i){"use strict";var e=i(17),r=i(5),o=i(38),s=i(70),h=i(42),c=i(73),l=i(72),u=i(12),f=i(26),a=i(92),v=i(58),y=i(479);n.exports=function(n,t,i,p,w,b){var tt=e[n],k=tt,g=w?"set":"add",d=k&&k.prototype,rt={},nt=function(n){var t=d[n];o(d,n,n=="delete"?function(n){return b&&!u(n)?!1:t.call(this,n===0?0:n)}:n=="has"?function(n){return b&&!u(n)?!1:t.call(this,n===0?0:n)}:n=="get"?function(n){return b&&!u(n)?undefined:t.call(this,n===0?0:n)}:n=="add"?function(n){return t.call(this,n===0?0:n),this}:function(n,i){return t.call(this,n===0?0:n,i),this})};if(typeof k=="function"&&(b||d.forEach&&!f(function(){(new k).entries().next()}))){var it=new k,ft=it[g](b?{}:-0,1)!=it,et=f(function(){it.has(1)}),ot=a(function(n){new k(n)}),ut=!b&&f(function(){for(var t=new k,n=5;n--;)t[g](n,n);return!t.has(-0)});ot||(k=t(function(t,i){l(t,k,n);var r=y(new tt,t,k);return i!=undefined&&c(i,w,r[g],r),r}),k.prototype=d,d.constructor=k);(et||ut)&&(nt("delete"),nt("has"),w&&nt("get"));(ut||ft)&&nt(g);b&&d.clear&&delete d.clear}else k=p.getConstructor(t,n,w,g),s(k.prototype,i),h.NEED=!0;return v(k,n),rt[n]=k,r(r.G+r.W+r.F*(k!=tt),rt),b||p.setStrong(k,n,w),k}},function(n,t,i){var u=i(59),f=i(56),e=i(27),o=i(86),s=i(32),h=i(164),r=Object.getOwnPropertyDescriptor;t.f=i(25)?r:function(n,t){if(n=e(n),t=o(t,!0),h)try{return r(n,t)}catch(i){}if(s(n,t))return f(!u.f.call(n,t),n[t])}},function(n,t,i){var r=i(40),u=i(88),f=i(41),e=i(28),o=i(480);n.exports=function(n,t){var s=n==1,l=n==2,a=n==3,i=n==4,h=n==6,v=n==5||h,c=t||o;return function(t,o,y){for(var g=f(t),b=u(g),tt=r(o,y,3),nt=e(b.length),p=0,k=s?c(t,nt):l?c(t,0):undefined,w,d;nt>p;p++)if((v||p in b)&&(w=b[p],d=tt(w,p,g),n))if(s)k[p]=d;else if(d)switch(n){case 3:return!0;case 5:return w;case 6:return p;case 2:k.push(w)}else if(i)return!1;return h?-1:a||i?i:k}}},function(n,t){t.f=Object.getOwnPropertySymbols},function(n,t,i){"use strict";var r=i(39),u=i(38),f=i(26),e=i(47),o=i(16);n.exports=function(n,t,i){var s=o(n),h=i(e,s,""[n]),l=h[0],c=h[1];f(function(){var t={};return t[s]=function(){return 7},""[n](t)!=7})&&(u(String.prototype,n,l),r(RegExp.prototype,s,t==2?function(n,t){return c.call(n,this,t)}:function(n){return c.call(n,this)}))}},function(n,t,i){"use strict";var u=i(52),r=i(174),f=i(57),e=i(27);n.exports=i(172)(Array,"Array",function(n,t){this._t=e(n);this._i=0;this._k=t},function(){var t=this._t,i=this._k,n=this._i++;return!t||n>=t.length?(this._t=undefined,r(1)):i=="keys"?r(0,n):i=="values"?r(0,t[n]):r(0,[n,t[n]])},"values");f.Arguments=f.Array;u("keys");u("values");u("entries")},function(n,t,i){"use strict";function f(n){for(var t=n+1,i="",r=void 0;t>0;)r=(t-1)%u,i=String.fromCharCode(65+r)+i,t=parseInt((t-r)/u,10);return i}function s(n){var i=0,t,r;if(n)for(t=0,r=n.length-1;t<n.length;t+=1,r-=1)i+=Math.pow(u,r)*(e.indexOf(n[t])+1);return--i,i}function h(){for(var u=arguments.length>0&&arguments[0]!==undefined?arguments[0]:100,e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:4,r=[],t,i,n=0;n<u;n++){for(i=[],t=0;t<e;t++)i.push(f(t)+(n+1));r.push(i)}return r}function c(){for(var u=arguments.length>0&&arguments[0]!==undefined?arguments[0]:100,e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:4,r=[],n,i,t=0;t<u;t++){for(i={},n=0;n<e;n++)i["prop"+n]=f(n)+(t+1);r.push(i)}return r}function l(n,t){for(var r,u=[],i=void 0,f=0;f<n;f++){for(i=[],r=0;r<t;r++)i.push("");u.push(i)}return u}function a(n){for(var t,f,r=[],e=0,i=0,u=n.length;i<u;i++)for(t=0,f=n[i].length;t<f;t++)t==e&&(r.push([]),e++),r[t].push(n[i][t]);return r}function v(n,t){return t=typeof t=="undefined"?!0:t,function(i,u){return function f(i){if(i){if(r.hasOwnProperty(i,n)&&i[n]!==void 0)return i[n];if(r.hasOwnProperty(i,"type")&&i.type){var u;if(typeof i.type!="string")throw new Error("Cell type must be a string ");if(u=o.getCellType(i.type),r.hasOwnProperty(u,n))return u[n];if(t)return}}else return;return f(Object.getPrototypeOf(i))}(typeof i=="number"?this.getCellMeta(i,u):i)}}t.__esModule=!0;t.spreadsheetColumnLabel=f;t.spreadsheetColumnIndex=s;t.createSpreadsheetData=h;t.createSpreadsheetObjectData=c;t.createEmptySpreadsheetData=l;t.translateRowsToColumns=a;t.cellMethodLookupFactory=v;var o=i(151),r=i(1),e="ABCDEFGHIJKLMNOPQRSTUVWXYZ",u=e.length},function(n,t,i){"use strict";function o(n){return n&&n.__esModule?n:{"default":n}}function h(n,t){var i=n;return r.isObject(n)&&(t=n,i=t.languageCode),g(i,t),p(i,r.deepClone(t)),r.deepClone(t)}function k(n){return c(n)?r.deepClone(s(n)):null}function c(n){return w(n)}function d(){return f.default}function g(n,t){n!==e&&l.extendNotExistingKeys(t,s(e))}function nt(){return b()}t.__esModule=!0;t.DEFAULT_LANGUAGE_CODE=t.getLanguagesDictionaries=t.getDefaultLanguageDictionary=t.hasLanguageDictionary=t.getLanguageDictionary=t.registerLanguageDictionary=undefined;var r=i(1),l=i(452),a=i(48),v=o(a),y=i(543),f=o(y);var e=f.default.languageCode,u=v.default("languagesDictionaries"),p=u.register,s=u.getItem,w=u.hasItem,b=u.getValues;t.registerLanguageDictionary=h;t.getLanguageDictionary=k;t.hasLanguageDictionary=c;t.getDefaultLanguageDictionary=d;t.getLanguagesDictionaries=nt;t.DEFAULT_LANGUAGE_CODE=e;h(f.default)},function(n,t,i){"use strict";function e(n){return n&&n.__esModule?n:{"default":n}}function a(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var r;t.__esModule=!0;var o=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),u=i(0),f=i(1),s=i(21),h=e(s),c=i(640),l=e(c);r=function(){function n(t){a(this,n);this.hot=t;this.elements=[];this.hidden=!1}return o(n,[{key:"reset",value:function(){u.arrayEach(this.elements,function(n){return n.reset()})}},{key:"hide",value:function(){this.hidden=!0}},{key:"show",value:function(){this.hidden=!1}},{key:"isHidden",value:function(){return this.hidden}},{key:"destroy",value:function(){this.clearLocalHooks();u.arrayEach(this.elements,function(n){return n.destroy()});this.elements=null;this.hot=null}}]),n}();f.mixin(r,h.default);f.mixin(r,l.default);t.default=r},function(n,t,i){"use strict";var r=i(163),f=i(51),u="Map";n.exports=i(75)(u,function(n){return function(){return n(this,arguments.length>0?arguments[0]:undefined)}},{get:function(n){var t=r.getEntry(f(this,u),n);return t&&t.v},set:function(n,t){return r.def(f(this,u),n===0?0:n,t)}},r,!0)},function(n,t,i){var u=i(12),r=i(17).document,f=u(r)&&u(r.createElement);n.exports=function(n){return f?r.createElement(n):{}}},function(n,t,i){var r=i(12);n.exports=function(n,t){if(!r(n))return n;var i,u;if(t&&typeof(i=n.toString)=="function"&&!r(u=i.call(n))||typeof(i=n.valueOf)=="function"&&!r(u=i.call(n))||!t&&typeof(i=n.toString)=="function"&&!r(u=i.call(n)))return u;throw TypeError("Can't convert object to primitive value");}},function(n,t,i){var o=i(20),s=i(477),e=i(91),h=i(89)("IE_PROTO"),u=function(){},f="prototype",r=function(){var t=i(85)("iframe"),u=e.length,o="<",s=">",n;for(t.style.display="none",i(167).appendChild(t),t.src="javascript:",n=t.contentWindow.document,n.open(),n.write(o+"script"+s+"document.F=Object"+o+"/script"+s),n.close(),r=n.F;u--;)delete r[f][e[u]];return r()};n.exports=Object.create||function(n,t){var i;return n!==null?(u[f]=o(n),i=new u,u[f]=null,i[h]=n):i=r(),t===undefined?i:s(i,t)}},function(n,t,i){var r=i(49);n.exports=Object("z").propertyIsEnumerable(0)?Object:function(n){return r(n)=="String"?n.split(""):Object(n)}},function(n,t,i){var r=i(90)("keys"),u=i(55);n.exports=function(n){return r[n]||(r[n]=u(n))}},function(n,t,i){var r=i(17),u="__core-js_shared__",f=r[u]||(r[u]={});n.exports=function(n){return f[n]||(f[n]={})}},function(n){n.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(n,t,i){var r=i(16)("iterator"),f=!1,u;try{u=[7][r]();u["return"]=function(){f=!0};Array.from(u,function(){throw 2;})}catch(e){}n.exports=function(n,t){var u,i,e;if(!t&&!f)return!1;u=!1;try{i=[7];e=i[r]();e.next=function(){return{done:u=!0}};i[r]=function(){return e};n(i)}catch(o){}return u}},function(n,t,i){"use strict";var r=i(163),f=i(51),u="Set";n.exports=i(75)(u,function(n){return function(){return n(this,arguments.length>0?arguments[0]:undefined)}},{add:function(n){return r.def(f(this,u),n=n===0?0:n,n)}},r)},function(n,t,i){"use strict";var v=i(77)(0),y=i(38),e=i(42),p=i(178),r=i(179),o=i(12),w=i(26),s=i(51),u="WeakMap",b=e.getWeak,k=Object.isExtensible,d=r.ufstore,h={},f,c=function(n){return function(){return n(this,arguments.length>0?arguments[0]:undefined)}},l={get:function(n){if(o(n)){var t=b(n);return t===!0?d(s(this,u)).get(n):t?t[this._i]:undefined}},set:function(n,t){return r.def(s(this,u),n,t)}},a=n.exports=i(75)(u,c,l,r,!0,!0);w(function(){return(new a).set((Object.freeze||Object)(h),7).get(h)!=7})&&(f=r.getConstructor(c,u),p(f.prototype,l),e.NEED=!0,v(["delete","has","get","set"],function(n){var t=a.prototype,i=t[n];y(t,n,function(t,r){if(o(t)&&!k(t)){this._f||(this._f=new f);var u=this._f[n](t,r);return n=="set"?this:u}return i.call(this,t,r)})}))},function(n,t,i){"use strict";var r=i(179),f=i(51),u="WeakSet";i(75)(u,function(n){return function(){return n(this,arguments.length>0?arguments[0]:undefined)}},{add:function(n){return r.def(f(this,u),n,!0)}},r,!1,!0)},function(n,t,i){"use strict";var d=i(74),f=i(17),o=i(40),st=i(171),r=i(5),ht=i(12),ct=i(71),lt=i(72),g=i(73),at=i(482),nt=i(97).set,tt=i(484)(),it=i(180),p=i(485),vt=i(486),e="Promise",rt=f.TypeError,a=f.process,u=f[e],h=st(a)=="process",v=function(){},y,ut,ft,w,c=ut=it.f,l=!!function(){try{var n=u.resolve(1),t=(n.constructor={})[i(16)("species")]=function(n){n(v,v)};return(h||typeof PromiseRejectionEvent=="function")&&n.then(v)instanceof t}catch(r){}}(),et=function(n){var t;return ht(n)&&typeof(t=n.then)=="function"?t:!1},b=function(n,t){if(!n._n){n._n=!0;var i=n._c;tt(function(){for(var r=n._v,u=n._s==1,f=0,e=function(t){var o=u?t.ok:t.fail,s=t.resolve,f=t.reject,e=t.domain,i,h;try{o?(u||(n._h==2&&pt(n),n._h=1),o===!0?i=r:(e&&e.enter(),i=o(r),e&&e.exit()),i===t.promise?f(rt("Promise-chain cycle")):(h=et(i))?h.call(i,s,f):s(i)):f(r)}catch(c){f(c)}};i.length>f;)e(i[f++]);n._c=[];n._n=!1;t&&!n._h&&yt(n)})}},yt=function(n){nt.call(f,function(){var t=n._v,u=ot(n),i,e,r;if(u&&(i=p(function(){h?a.emit("unhandledRejection",t,n):(e=f.onunhandledrejection)?e({promise:n,reason:t}):(r=f.console)&&r.error&&r.error("Unhandled promise rejection",t)}),n._h=h||ot(n)?2:1),n._a=undefined,u&&i.e)throw i.v;})},ot=function(n){return n._h!==1&&(n._a||n._c).length===0},pt=function(n){nt.call(f,function(){var t;h?a.emit("rejectionHandled",n):(t=f.onrejectionhandled)&&t({promise:n,reason:n._v})})},s=function(n){var t=this;t._d||(t._d=!0,t=t._w||t,t._v=n,t._s=2,t._a||(t._a=t._c.slice()),b(t,!0))},k=function(n){var t=this,i;if(!t._d){t._d=!0;t=t._w||t;try{if(t===n)throw rt("Promise can't be resolved itself");(i=et(n))?tt(function(){var r={_w:t,_d:!1};try{i.call(n,o(k,r,1),o(s,r,1))}catch(u){s.call(r,u)}}):(t._v=n,t._s=1,b(t,!1))}catch(r){s.call({_w:t,_d:!1},r)}}};l||(u=function(n){lt(this,u,e,"_h");ct(n);y.call(this);try{n(o(k,this,1),o(s,this,1))}catch(t){s.call(this,t)}},y=function(){this._c=[];this._a=undefined;this._s=0;this._d=!1;this._v=undefined;this._h=0;this._n=!1},y.prototype=i(70)(u.prototype,{then:function(n,t){var i=c(at(this,u));return i.ok=typeof n=="function"?n:!0,i.fail=typeof t=="function"&&t,i.domain=h?a.domain:undefined,this._c.push(i),this._a&&this._a.push(i),this._s&&b(this,!1),i.promise},"catch":function(n){return this.then(undefined,n)}}),ft=function(){var n=new y;this.promise=n;this.resolve=o(k,n,1);this.reject=o(s,n,1)},it.f=c=function(n){return n===u||n===w?new ft(n):ut(n)});r(r.G+r.W+r.F*!l,{Promise:u});i(58)(u,e);i(175)(e);w=i(50)[e];r(r.S+r.F*!l,e,{reject:function(n){var t=c(this),i=t.reject;return i(n),t.promise}});r(r.S+r.F*(d||!l),e,{resolve:function(n){return vt(d&&this===w?u:this,n)}});r(r.S+r.F*!(l&&i(92)(function(n){u.all(n)["catch"](v)})),e,{all:function(n){var i=this,t=c(i),r=t.resolve,u=t.reject,f=p(function(){var t=[],e=0,f=1;g(n,!1,function(n){var s=e++,o=!1;t.push(undefined);f++;i.resolve(n).then(function(n){o||(o=!0,t[s]=n,--f||r(t))},u)});--f||r(t)});return f.e&&u(f.v),t.promise},race:function(n){var i=this,t=c(i),r=t.reject,u=p(function(){g(n,!1,function(n){i.resolve(n).then(t.resolve,r)})});return u.e&&r(u.v),t.promise}})},function(n,t,i){var o=i(40),g=i(483),y=i(167),p=i(85),r=i(17),w=r.process,s=r.setImmediate,h=r.clearImmediate,b=r.MessageChannel,c=r.Dispatch,l=0,f={},k="onreadystatechange",u,a,v,e=function(){var n=+this,t;f.hasOwnProperty(n)&&(t=f[n],delete f[n],t())},d=function(n){e.call(n.data)};s&&h||(s=function(n){for(var t=[],i=1;arguments.length>i;)t.push(arguments[i++]);return f[++l]=function(){g(typeof n=="function"?n:Function(n),t)},u(l),l},h=function(n){delete f[n]},i(49)(w)=="process"?u=function(n){w.nextTick(o(e,n,1))}:c&&c.now?u=function(n){c.now(o(e,n,1))}:b?(a=new b,v=a.port2,a.port1.onmessage=d,u=o(v.postMessage,v,1)):r.addEventListener&&typeof postMessage=="function"&&!r.importScripts?(u=function(n){r.postMessage(n+"","*")},r.addEventListener("message",d,!1)):u=k in p("script")?function(n){y.appendChild(p("script"))[k]=function(){y.removeChild(this);e.call(n)}}:function(n){setTimeout(o(e,n,1),0)});n.exports={set:s,clear:h}},function(n,t,i){"use strict";var w=i(17),r=i(32),nt=i(25),e=i(5),yt=i(38),oi=i(42).KEY,pt=i(26),tt=i(90),it=i(58),si=i(55),a=i(16),hi=i(181),ci=i(487),li=i(488),ai=i(177),rt=i(20),vi=i(12),b=i(27),ut=i(86),ft=i(56),v=i(87),wt=i(182),bt=i(76),kt=i(22),yi=i(46),dt=bt.f,c=kt.f,gt=wt.f,u=w.Symbol,k=w.JSON,d=k&&k.stringify,h="prototype",f=a("_hidden"),ni=a("toPrimitive"),pi={}.propertyIsEnumerable,y=tt("symbol-registry"),s=tt("symbols"),p=tt("op-symbols"),o=Object[h],l=typeof u=="function",et=w.QObject,ot=!et||!et[h]||!et[h].findChild,st=nt&&pt(function(){return v(c({},"a",{get:function(){return c(this,"a",{value:7}).a}})).a!=7})?function(n,t,i){var r=dt(o,t);r&&delete o[t];c(n,t,i);r&&n!==o&&c(o,t,r)}:c,ti=function(n){var t=s[n]=v(u[h]);return t._k=n,t},ht=l&&typeof u.iterator=="symbol"?function(n){return typeof n=="symbol"}:function(n){return n instanceof u},g=function(n,t,i){return(n===o&&g(p,t,i),rt(n),t=ut(t,!0),rt(i),r(s,t))?(i.enumerable?(r(n,f)&&n[f][t]&&(n[f][t]=!1),i=v(i,{enumerable:ft(0,!1)})):(r(n,f)||c(n,f,ft(1,{})),n[f][t]=!0),st(n,t,i)):c(n,t,i)},ii=function(n,t){rt(n);for(var i=li(t=b(t)),r=0,f=i.length,u;f>r;)g(n,u=i[r++],t[u]);return n},wi=function(n,t){return t===undefined?v(n):ii(v(n),t)},ri=function(n){var t=pi.call(this,n=ut(n,!0));return this===o&&r(s,n)&&!r(p,n)?!1:t||!r(this,n)||!r(s,n)||r(this,f)&&this[f][n]?t:!0},ui=function(n,t){if(n=b(n),t=ut(t,!0),n!==o||!r(s,t)||r(p,t)){var i=dt(n,t);return!i||!r(s,t)||r(n,f)&&n[f][t]||(i.enumerable=!0),i}},fi=function(n){for(var i=gt(b(n)),u=[],e=0,t;i.length>e;)r(s,t=i[e++])||t==f||t==oi||u.push(t);return u},ei=function(n){for(var i=n===o,u=gt(i?p:b(n)),f=[],e=0,t;u.length>e;)r(s,t=u[e++])&&(i?r(o,t):!0)&&f.push(s[t]);return f},ct,lt,at,vt;for(l||(u=function(){if(this instanceof u)throw TypeError("Symbol is not a constructor!");var n=si(arguments.length>0?arguments[0]:undefined),t=function(i){this===o&&t.call(p,i);r(this,f)&&r(this[f],n)&&(this[f][n]=!1);st(this,n,ft(1,i))};return nt&&ot&&st(o,n,{configurable:!0,set:t}),ti(n)},yt(u[h],"toString",function(){return this._k}),bt.f=ui,kt.f=g,i(99).f=wt.f=fi,i(59).f=ri,i(78).f=ei,nt&&!i(74)&&yt(o,"propertyIsEnumerable",ri,!0),hi.f=function(n){return ti(a(n))}),e(e.G+e.W+e.F*!l,{Symbol:u}),ct="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),lt=0;ct.length>lt;)a(ct[lt++]);for(at=yi(a.store),vt=0;at.length>vt;)ci(at[vt++]);e(e.S+e.F*!l,"Symbol",{"for":function(n){return r(y,n+="")?y[n]:y[n]=u(n)},keyFor:function(n){if(!ht(n))throw TypeError(n+" is not a symbol!");for(var t in y)if(y[t]===n)return t},useSetter:function(){ot=!0},useSimple:function(){ot=!1}});e(e.S+e.F*!l,"Object",{create:wi,defineProperty:g,defineProperties:ii,getOwnPropertyDescriptor:ui,getOwnPropertyNames:fi,getOwnPropertySymbols:ei});k&&e(e.S+e.F*(!l||pt(function(){var n=u();return d([n])!="[null]"||d({a:n})!="{}"||d(Object(n))!="{}"})),"JSON",{stringify:function(n){for(var i=[n],u=1,t,r;arguments.length>u;)i.push(arguments[u++]);if(r=t=i[1],(vi(t)||n!==undefined)&&!ht(n))return ai(t)||(t=function(n,t){return typeof r=="function"&&(t=r.call(this,n,t)),ht(t)?void 0:t}),i[1]=t,d.apply(k,i)}});u[h][ni]||i(39)(u[h],ni,u[h].valueOf);it(u,"Symbol");it(Math,"Math",!0);it(w.JSON,"JSON",!0)},function(n,t,i){var r=i(165),u=i(91).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(n){return r(n,u)}},function(n,t,i){var r=i(12),u=i(42).onFreeze;i(29)("freeze",function(n){return function(t){return n&&r(t)?n(u(t)):t}})},function(n,t,i){var r=i(12),u=i(42).onFreeze;i(29)("seal",function(n){return function(t){return n&&r(t)?n(u(t)):t}})},function(n,t,i){var r=i(12),u=i(42).onFreeze;i(29)("preventExtensions",function(n){return function(t){return n&&r(t)?n(u(t)):t}})},function(n,t,i){var r=i(12);i(29)("isFrozen",function(n){return function(t){return r(t)?n?n(t):!1:!0}})},function(n,t,i){var r=i(12);i(29)("isSealed",function(n){return function(t){return r(t)?n?n(t):!1:!0}})},function(n,t,i){var r=i(12);i(29)("isExtensible",function(n){return function(t){return r(t)?n?n(t):!0:!1}})},function(n,t,i){var r=i(27),u=i(76).f;i(29)("getOwnPropertyDescriptor",function(){return function(n,t){return u(r(n),t)}})},function(n,t,i){var r=i(41),u=i(173);i(29)("getPrototypeOf",function(){return function(n){return u(r(n))}})},function(n,t,i){var r=i(41),u=i(46);i(29)("keys",function(){return function(n){return u(r(n))}})},function(n,t,i){i(29)("getOwnPropertyNames",function(){return i(182).f})},function(n,t,i){var r=i(5);r(r.S+r.F,"Object",{assign:i(178)})},function(n,t,i){var r=i(5);r(r.S,"Object",{is:i(489)})},function(n,t,i){var r=i(5);r(r.S,"Object",{setPrototypeOf:i(176).set})},function(n,t,i){var f=i(22).f,r=Function.prototype,e=/^\s*function ([^ (]*)/,u="name";u in r||i(25)&&f(r,u,{configurable:!0,get:function(){try{return(""+this).match(e)[1]}catch(n){return""}}})},function(n,t,i){var r=i(5),u=i(27),f=i(28);r(r.S,"String",{raw:function(n){for(var r=u(n.raw),e=f(r.length),o=arguments.length,i=[],t=0;e>t;)i.push(String(r[t++])),t<o&&i.push(String(arguments[t]));return i.join("")}})},function(n,t,i){var r=i(5),e=i(69),u=String.fromCharCode,f=String.fromCodePoint;r(r.S+r.F*(!!f&&f.length!=1),"String",{fromCodePoint:function(){for(var t=[],r=arguments.length,i=0,n;r>i;){if(n=+arguments[i++],e(n,1114111)!==n)throw RangeError(n+" is not a valid code point");t.push(n<65536?u(n):u(((n-=65536)>>10)+55296,n%1024+56320))}return t.join("")}})},function(n,t,i){"use strict";var r=i(5),u=i(490)(!1);r(r.P,"String",{codePointAt:function(n){return u(this,n)}})},function(n,t,i){var r=i(5);r(r.P,"String",{repeat:i(183)})},function(n,t,i){"use strict";var r=i(5),e=i(28),o=i(119),u="startsWith",f=""[u];r(r.P+r.F*i(120)(u),"String",{startsWith:function(n){var t=o(this,n,u),i=e(Math.min(arguments.length>1?arguments[1]:undefined,t.length)),r=String(n);return f?f.call(t,r,i):t.slice(i,i+r.length)===r}})},function(n,t,i){var r=i(184),u=i(47);n.exports=function(n,t,i){if(r(t))throw TypeError("String#"+i+" doesn't accept regex!");return String(u(n))}},function(n,t,i){var r=i(16)("match");n.exports=function(n){var t=/./;try{"/./"[n](t)}catch(i){try{return t[r]=!1,!"/./"[n](t)}catch(u){}}return!0}},function(n,t,i){"use strict";var r=i(5),f=i(28),o=i(119),u="endsWith",e=""[u];r(r.P+r.F*i(120)(u),"String",{endsWith:function(n){var t=o(this,n,u),s=arguments.length>1?arguments[1]:undefined,h=f(t.length),i=s===undefined?h:Math.min(f(s),h),r=String(n);return e?e.call(t,r,i):t.slice(i-r.length,i)===r}})},function(n,t,i){"use strict";var r=i(5),f=i(119),u="includes";r(r.P+r.F*i(120)(u),"String",{includes:function(n){return!!~f(this,n,u).indexOf(n,arguments.length>1?arguments[1]:undefined)}})},function(n,t,i){i(25)&&/./g.flags!="g"&&i(22).f(RegExp.prototype,"flags",{configurable:!0,get:i(491)})},function(n,t,i){i(79)("match",1,function(n,t,i){return[function(i){"use strict";var r=n(this),u=i==undefined?undefined:i[t];return u!==undefined?u.call(i,r):new RegExp(i)[t](String(r))},i]})},function(n,t,i){i(79)("replace",2,function(n,t,i){return[function(r,u){"use strict";var f=n(this),e=r==undefined?undefined:r[t];return e!==undefined?e.call(r,f,u):i.call(String(f),r,u)},i]})},function(n,t,i){i(79)("split",2,function(n,t,r){"use strict";var h=i(184),o=r,c=[].push,f="split",u="length",s="lastIndex",e;return"abbc"[f](/(b)*/)[1]=="c"||"test"[f](/(?:)/,-1)[u]!=4||"ab"[f](/(?:ab)*/)[u]!=2||"."[f](/(.?)(.?)/)[u]!=4||"."[f](/()()/)[u]>1||""[f](/.?/)[u]?(e=/()??/.exec("")[1]===undefined,r=function(n,t){var f=String(this);if(n===undefined&&t===0)return[];if(!h(n))return o.call(f,n,t);var r=[],w=(n.ignoreCase?"i":"")+(n.multiline?"m":"")+(n.unicode?"u":"")+(n.sticky?"y":""),l=0,y=t===undefined?4294967295:t>>>0,a=new RegExp(n.source,w+"g"),b,i,p,k,v;for(e||(b=new RegExp("^"+a.source+"$(?!\\s)",w));i=a.exec(f);){if(p=i.index+i[0][u],p>l&&(r.push(f.slice(l,i.index)),!e&&i[u]>1&&i[0].replace(b,function(){for(v=1;v<arguments[u]-2;v++)arguments[v]===undefined&&(i[v]=undefined)}),i[u]>1&&i.index<f[u]&&c.apply(r,i.slice(1)),k=i[0][u],l=p,r[u]>=y))break;a[s]===i.index&&a[s]++}return l===f[u]?(k||!a.test(""))&&r.push(""):r.push(f.slice(l)),r[u]>y?r.slice(0,y):r}):"0"[f](undefined,0)[u]&&(r=function(n,t){return n===undefined&&t===0?[]:o.call(this,n,t)}),[function(i,u){var f=n(this),e=i==undefined?undefined:i[t];return e!==undefined?e.call(i,f,u):r.call(String(f),i,u)},r]})},function(n,t,i){i(79)("search",1,function(n,t,i){return[function(i){"use strict";var r=n(this),u=i==undefined?undefined:i[t];return u!==undefined?u.call(i,r):new RegExp(i)[t](String(r))},i]})},function(n,t,i){"use strict";var f=i(40),r=i(5),e=i(41),o=i(168),s=i(169),h=i(28),u=i(129),c=i(170);r(r.S+r.F*!i(92)(function(n){Array.from(n)}),"Array",{from:function(n){var r=e(n),a=typeof this=="function"?this:Array,k=arguments.length,l=k>1?arguments[1]:undefined,v=l!==undefined,t=0,y=c(r),p,i,w,b;if(v&&(l=f(l,k>2?arguments[2]:undefined,2)),y==undefined||a==Array&&s(y))for(p=h(r.length),i=new a(p);p>t;t++)u(i,t,v?l(r[t],t):r[t]);else for(b=y.call(r),i=new a;!(w=b.next()).done;t++)u(i,t,v?o(b,l,[w.value,t],!0):w.value);return i.length=t,i}})},function(n,t,i){"use strict";var r=i(22),u=i(56);n.exports=function(n,t,i){t in n?r.f(n,t,u(0,i)):n[t]=i}},function(n,t,i){"use strict";var r=i(5),u=i(129);r(r.S+r.F*i(26)(function(){function n(){}return!(Array.of.call(n)instanceof n)}),"Array",{of:function(){for(var n=0,t=arguments.length,i=new(typeof this=="function"?this:Array)(t);t>n;)u(i,n,arguments[n++]);return i.length=t,i}})},function(n,t,i){var r=i(5);r(r.P,"Array",{copyWithin:i(492)});i(52)("copyWithin")},function(n,t,i){"use strict";var r=i(5),e=i(77)(5),u="find",f=!0;u in[]&&Array(1)[u](function(){f=!1});r(r.P+r.F*f,"Array",{find:function(n){return e(this,n,arguments.length>1?arguments[1]:undefined)}});i(52)(u)},function(n,t,i){"use strict";var r=i(5),e=i(77)(6),u="findIndex",f=!0;u in[]&&Array(1)[u](function(){f=!1});r(r.P+r.F*f,"Array",{findIndex:function(n){return e(this,n,arguments.length>1?arguments[1]:undefined)}});i(52)(u)},function(n,t,i){var r=i(5);r(r.P,"Array",{fill:i(493)});i(52)("fill")},function(n,t,i){var r=i(5),u=i(17).isFinite;r(r.S,"Number",{isFinite:function(n){return typeof n=="number"&&u(n)}})},function(n,t,i){var r=i(5);r(r.S,"Number",{isInteger:i(185)})},function(n,t,i){var r=i(5),u=i(185),f=Math.abs;r(r.S,"Number",{isSafeInteger:function(n){return u(n)&&f(n)<=9007199254740991}})},function(n,t,i){var r=i(5);r(r.S,"Number",{isNaN:function(n){return n!=n}})},function(n,t,i){var r=i(5);r(r.S,"Number",{EPSILON:Math.pow(2,-52)})},function(n,t,i){var r=i(5);r(r.S,"Number",{MIN_SAFE_INTEGER:-9007199254740991})},function(n,t,i){var r=i(5);r(r.S,"Number",{MAX_SAFE_INTEGER:9007199254740991})},function(n,t,i){"use strict";var r=i(5),u=i(166)(!0);r(r.P,"Array",{includes:function(n){return u(this,n,arguments.length>1?arguments[1]:undefined)}});i(52)("includes")},function(n,t,i){var r=i(5),u=i(186)(!1);r(r.S,"Object",{values:function(n){return u(n)}})},function(n,t,i){var r=i(5),u=i(186)(!0);r(r.S,"Object",{entries:function(n){return u(n)}})},function(n,t,i){var r=i(5),u=i(494),f=i(27),e=i(76),o=i(129);r(r.S,"Object",{getOwnPropertyDescriptors:function(n){for(var i=f(n),l=e.f,r=u(i),s={},h=0,c,t;r.length>h;)t=l(i,c=r[h++]),t!==undefined&&o(s,c,t);return s}})},function(n,t,i){"use strict";var r=i(5),u=i(187),f=i(188);r(r.P+r.F*/Version\/10\.\d+(\.\d+)? Safari\//.test(f),"String",{padStart:function(n){return u(this,n,arguments.length>1?arguments[1]:undefined,!0)}})},function(n,t,i){"use strict";var r=i(5),u=i(187),f=i(188);r(r.P+r.F*/Version\/10\.\d+(\.\d+)? Safari\//.test(f),"String",{padEnd:function(n){return u(this,n,arguments.length>1?arguments[1]:undefined,!1)}})},function(n,t,i){var r=i(5),u=i(97);r(r.G+r.B,{setImmediate:u.set,clearImmediate:u.clear})},function(n,t,i){for(var o=i(80),b=i(46),k=i(38),d=i(17),s=i(39),h=i(57),c=i(16),l=c("iterator"),a=c("toStringTag"),v=h.Array,y={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},p=b(y),e=0;e<p.length;e++){var u=p[e],g=y[u],w=d[u],r=w&&w.prototype,f;if(r&&(r[l]||s(r,l,v),r[a]||s(r,a,u),h[u]=v,g))for(f in o)r[f]||k(r,f,o[f],!0)}},function(n,t,i){"use strict";function o(n){return n&&n.__esModule?n:{"default":n}}function s(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var u;t.__esModule=!0;var f=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),e=i(61),r=o(e);u=function(){function n(t){var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:t,r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:t;s(this,n);this.highlight=t;this.from=i;this.to=r}return f(n,[{key:"setHighlight",value:function(n){return this.highlight=n,this}},{key:"setFrom",value:function(n){return this.from=n,this}},{key:"setTo",value:function(n){return this.to=n,this}},{key:"isValid",value:function(n){return this.from.isValid(n)&&this.to.isValid(n)}},{key:"isSingle",value:function(){return this.from.row===this.to.row&&this.from.col===this.to.col}},{key:"getHeight",value:function(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}},{key:"getWidth",value:function(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}},{key:"includes",value:function(n){var t=n.row,i=n.col,r=this.getTopLeftCorner(),u=this.getBottomRightCorner();return r.row<=t&&u.row>=t&&r.col<=i&&u.col>=i}},{key:"includesRange",value:function(n){return this.includes(n.getTopLeftCorner())&&this.includes(n.getBottomRightCorner())}},{key:"isEqual",value:function(n){return Math.min(this.from.row,this.to.row)===Math.min(n.from.row,n.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(n.from.row,n.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(n.from.col,n.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(n.from.col,n.to.col)}},{key:"overlaps",value:function(n){return n.isSouthEastOf(this.getTopLeftCorner())&&n.isNorthWestOf(this.getBottomRightCorner())}},{key:"isSouthEastOf",value:function(n){return this.getTopLeftCorner().isSouthEastOf(n)||this.getBottomRightCorner().isSouthEastOf(n)}},{key:"isNorthWestOf",value:function(n){return this.getTopLeftCorner().isNorthWestOf(n)||this.getBottomRightCorner().isNorthWestOf(n)}},{key:"isOverlappingHorizontally",value:function(n){return this.getTopRightCorner().col>=n.getTopLeftCorner().col&&this.getTopRightCorner().col<=n.getTopRightCorner().col||this.getTopLeftCorner().col<=n.getTopRightCorner().col&&this.getTopLeftCorner().col>=n.getTopLeftCorner().col}},{key:"isOverlappingVertically",value:function(n){return this.getBottomRightCorner().row>=n.getTopRightCorner().row&&this.getBottomRightCorner().row<=n.getBottomRightCorner().row||this.getTopRightCorner().row<=n.getBottomRightCorner().row&&this.getTopRightCorner().row>=n.getTopRightCorner().row}},{key:"expand",value:function(n){var t=this.getTopLeftCorner(),i=this.getBottomRightCorner();return n.row<t.row||n.col<t.col||n.row>i.row||n.col>i.col?(this.from=new r.default(Math.min(t.row,n.row),Math.min(t.col,n.col)),this.to=new r.default(Math.max(i.row,n.row),Math.max(i.col,n.col)),!0):!1}},{key:"expandByRange",value:function(n){if(this.includesRange(n)||!this.overlaps(n))return!1;var t=this.getTopLeftCorner(),i=this.getBottomRightCorner(),e=this.getDirection(),u=n.getTopLeftCorner(),f=n.getBottomRightCorner(),o=Math.min(t.row,u.row),s=Math.min(t.col,u.col),h=Math.max(i.row,f.row),c=Math.max(i.col,f.col),l=new r.default(o,s),a=new r.default(h,c);return this.from=l,this.to=a,this.setDirection(e),this.highlight.row===this.getBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally(),!0}},{key:"getDirection",value:function(){return this.from.isNorthWestOf(this.to)?"NW-SE":this.from.isNorthEastOf(this.to)?"NE-SW":this.from.isSouthEastOf(this.to)?"SE-NW":this.from.isSouthWestOf(this.to)?"SW-NE":void 0}},{key:"getVerticalDirection",value:function(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}},{key:"getHorizontalDirection",value:function(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}},{key:"setDirection",value:function(n){var t,i,r,u;switch(n){case"NW-SE":t=[this.getTopLeftCorner(),this.getBottomRightCorner()];this.from=t[0];this.to=t[1];break;case"NE-SW":i=[this.getTopRightCorner(),this.getBottomLeftCorner()];this.from=i[0];this.to=i[1];break;case"SE-NW":r=[this.getBottomRightCorner(),this.getTopLeftCorner()];this.from=r[0];this.to=r[1];break;case"SW-NE":u=[this.getBottomLeftCorner(),this.getTopRightCorner()];this.from=u[0];this.to=u[1]}}},{key:"flipDirectionVertically",value:function(){var n=this.getDirection();switch(n){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE")}}},{key:"flipDirectionHorizontally",value:function(){var n=this.getDirection();switch(n){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW")}}},{key:"getTopLeftCorner",value:function(){return new r.default(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"getBottomRightCorner",value:function(){return new r.default(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getTopRightCorner",value:function(){return new r.default(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getBottomLeftCorner",value:function(){return new r.default(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"isCorner",value:function(n,t){return t&&t.includes(n)&&(this.getTopLeftCorner().isEqual(new r.default(t.from.row,t.from.col))||this.getTopRightCorner().isEqual(new r.default(t.from.row,t.to.col))||this.getBottomLeftCorner().isEqual(new r.default(t.to.row,t.from.col))||this.getBottomRightCorner().isEqual(new r.default(t.to.row,t.to.col)))?!0:n.isEqual(this.getTopLeftCorner())||n.isEqual(this.getTopRightCorner())||n.isEqual(this.getBottomLeftCorner())||n.isEqual(this.getBottomRightCorner())}},{key:"getOppositeCorner",value:function(n,t){if(!(n instanceof r.default))return!1;if(t&&t.includes(n)){if(this.getTopLeftCorner().isEqual(new r.default(t.from.row,t.from.col)))return this.getBottomRightCorner();if(this.getTopRightCorner().isEqual(new r.default(t.from.row,t.to.col)))return this.getBottomLeftCorner();if(this.getBottomLeftCorner().isEqual(new r.default(t.to.row,t.from.col)))return this.getTopRightCorner();if(this.getBottomRightCorner().isEqual(new r.default(t.to.row,t.to.col)))return this.getTopLeftCorner()}return n.isEqual(this.getBottomRightCorner())?this.getTopLeftCorner():n.isEqual(this.getTopLeftCorner())?this.getBottomRightCorner():n.isEqual(this.getTopRightCorner())?this.getBottomLeftCorner():n.isEqual(this.getBottomLeftCorner())?this.getTopRightCorner():void 0}},{key:"getBordersSharedWith",value:function(n){if(!this.includesRange(n))return[];var i={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},r={top:Math.min(n.from.row,n.to.row),bottom:Math.max(n.from.row,n.to.row),left:Math.min(n.from.col,n.to.col),right:Math.max(n.from.col,n.to.col)},t=[];return i.top==r.top&&t.push("top"),i.right==r.right&&t.push("right"),i.bottom==r.bottom&&t.push("bottom"),i.left==r.left&&t.push("left"),t}},{key:"getInner",value:function(){for(var n,i=this.getTopLeftCorner(),u=this.getBottomRightCorner(),f=[],t=i.row;t<=u.row;t++)for(n=i.col;n<=u.col;n++)this.from.row===t&&this.from.col===n||this.to.row===t&&this.to.col===n||f.push(new r.default(t,n));return f}},{key:"getAll",value:function(){for(var n,t=this.getTopLeftCorner(),i=this.getBottomRightCorner(),f=[],u=t.row;u<=i.row;u++)for(n=t.col;n<=i.col;n++)t.row===u&&t.col===n?f.push(t):i.row===u&&i.col===n?f.push(i):f.push(new r.default(u,n));return f}},{key:"forAll",value:function(n){for(var t,f,r=this.getTopLeftCorner(),u=this.getBottomRightCorner(),i=r.row;i<=u.row;i++)for(t=r.col;t<=u.col;t++)if(f=n(i,t),f===!1)return}},{key:"toObject",value:function(){return{from:this.from.toObject(),to:this.to.toObject()}}}]),n}();t.default=u},function(n,t,i){"use strict";function r(n){return n&&n.__esModule?n:{"default":n}}function vt(n){if(!e(n))throw Error('You declared cell type "'+n+'" as a string that is not mapped to a known object.\n                 Cell type must be an object or a string mapped to an object registered by "Handsontable.cellTypes.registerCellType" method');return ct(n)}function u(n,t){var i=t.editor,r=t.renderer,u=t.validator;i&&h.registerEditor(n,i);r&&c.registerRenderer(n,r);u&&l.registerValidator(n,u);ht(n,t)}t.__esModule=!0;t.getRegisteredCellTypes=t.getRegisteredCellTypeNames=t.hasCellType=t.getCellType=t.registerCellType=undefined;var o=i(48),s=r(o),h=i(19),c=i(15),l=i(36),a=i(528),v=r(a),y=i(529),p=r(y),w=i(530),b=r(w),k=i(531),d=r(k),g=i(532),nt=r(g),tt=i(533),it=r(tt),rt=i(534),ut=r(rt),ft=i(535),et=r(ft),ot=i(536),st=r(ot);var f=s.default("cellTypes"),ht=f.register,ct=f.getItem,e=f.hasItem,lt=f.getNames,at=f.getValues;u("autocomplete",v.default);u("checkbox",p.default);u("date",b.default);u("dropdown",d.default);u("handsontable",nt.default);u("numeric",it.default);u("password",ut.default);u("text",et.default);u("time",st.default);t.registerCellType=u;t.getCellType=vt;t.hasCellType=e;t.getRegisteredCellTypeNames=lt;t.getRegisteredCellTypes=at},function(n,t,i){"use strict";function v(n){return n&&n.__esModule?n:{"default":n}}function ui(n,t){return Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(t)}}))}function a(n){if(Array.isArray(n)){for(var t=0,i=Array(n.length);t<n.length;t++)i[t]=n[t];return i}return Array.from(n)}function fi(n,t){function pi(n){var t=d.normalizeLanguageCode(n);ii.hasLanguageDictionary(t)?(i.runHooks("beforeLanguageChange",t),vt.prototype.language=t,i.runHooks("afterLanguageChange",t)):d.warnUserAboutLanguageRegistration(n)}function oi(){var n=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue:function(){this.validatorsInQueue++;n=!1},removeValidatorFormQueue:function(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1;this.checkIfQueueIsEmpty()},onQueueEmpty:function(){},checkIfQueueIsEmpty:function(){if(this.validatorsInQueue==0&&n==!1){n=!0;this.onQueueEmpty(this.valid)}}}}function wi(n){var t=n.replace(",",".");return isNaN(parseFloat(t))===!1?parseFloat(t):n}function si(n,t,r){function w(){var u;n.length&&(u=i.runHooks("beforeChange",n,t||"edit"),e.isFunction(u)?console.warn("Your beforeChange callback returns a function. It's not supported since Handsontable 0.12.1 (and the returned function will not be executed)."):u===!1&&n.splice(0,n.length));r()}var f=new oi,a=function(n){return n.length>0&&/^-?[\d\s]*(\.|,)?\d*$/.test(n)},u;for(f.onQueueEmpty=w,u=n.length-1;u>=0;u--)if(n[u]===null)n.splice(u,1);else{var c=h(n[u],4),v=c[0],y=c[1],l=c[3],p=rt.propToCol(y),o=i.getCellMeta(v,p);o.type==="numeric"&&typeof l=="string"&&a(l)&&(n[u][3]=wi(l));i.getCellValidator(o)&&(f.addValidatorToQueue(),i.validateCell(n[u][3],o,function(t,r){return function(u){if(typeof u!="boolean")throw new Error("Validation error: result is not boolean");if(u===!1&&r.allowInvalid===!1){n.splice(t,1);r.valid=!0;var e=i.getCell(r.visualRow,r.visualCol);s.removeClass(e,i.getSettings().invalidCellClassName);--t}f.removeValidatorFormQueue()}}(u,o),t))}f.checkIfQueueIsEmpty()}function hi(n,t){var r=n.length-1,f,e,u;if(!(r<0)){for(;r>=0;r--){if(f=!1,n[r]===null){n.splice(r,1);continue}if(n[r][2]!=null||n[r][3]!=null){if(v.settings.allowInsertRow)while(n[r][0]>i.countRows()-1)if(e=rt.createRow(void 0,void 0,t),e===0){f=!0;break}if(!f){if(i.dataType==="array"&&(!v.settings.columns||v.settings.columns.length===0)&&v.settings.allowInsertColumn)while(rt.propToCol(n[r][1])>i.countCols()-1)rt.createCol(void 0,void 0,t);rt.set(n[r][0],n[r][1],n[r][3])}}}i.forceFullRender=!0;ui.adjustRowsAndCols();i.runHooks("beforeChangeRender",n,t);kt.lockEditor();i._refreshBorders(null);kt.unlockEditor();i.view.wt.wtOverlays.adjustElementsSize();i.runHooks("afterChange",n,t||"edit");u=i.getActiveEditor();u&&o.isDefined(u.refreshValue)&&u.refreshValue()}}function ci(n,t,i){return(typeof n=="undefined"?"undefined":f(n))==="object"?n:[[n,t,i]]}function fi(n){var t,u,i;if(r.hasOwnProperty(n,"type")){u={};f(n.type)==="object"?t=n.type:typeof n.type=="string"&&(t=ni.getCellType(n.type));for(i in t)r.hasOwnProperty(t,i)&&!r.hasOwnProperty(n,i)&&(u[i]=t[i]);return u}}function bi(){throw new Error("This method cannot be called because this Handsontable instance has been destroyed");}var ft=this,vi=arguments.length>2&&arguments[2]!==undefined?arguments[2]:!1,v,rt,pt,ui,kt,ei=!1,i=this,vt=function(){},yi=new g.default(i),dt,ot,li,ai;r.extend(vt.prototype,gt.default.prototype);r.extend(vt.prototype,t);r.extend(vt.prototype,fi(t));d.applyLanguageSetting(vt.prototype,t.language);w.hasValidParameter(vi)&&w.registerAsRootInstance(this);nt.startObserving();this.rootElement=n;this.isHotTableEnv=s.isChildOfWebComponentTable(this.rootElement);g.default.isHotTableEnv=this.isHotTableEnv;this.container=document.createElement("div");this.renderCall=!1;n.insertBefore(this.container,n.firstChild);!0&&w.isRootInstance(this)&&o._injectProductInfo(t.licenseKey,n);this.guid="ht_"+at.randomString();dt=bt.getTranslator(i);pt=new wt.default(i);this.rootElement.id&&this.rootElement.id.substring(0,3)!=="ht_"||(this.rootElement.id=this.guid);v={cellSettings:[],columnSettings:[],columnsSettingConflicts:["data","width","language"],settings:new vt,selRange:null,isPopulated:null,scrollable:null,firstRun:!0};ot=new ri.Selection(v.settings,{countCols:function(){return i.countCols()},countRows:function(){return i.countRows()},propToCol:function(n){return rt.propToCol(n)},isEditorOpened:function(){return i.getActiveEditor()?i.getActiveEditor().isOpened():!1}});this.selection=ot;this.selection.addLocalHook("beforeSetRangeStart",function(n){ft.runHooks("beforeSetRangeStart",n)});this.selection.addLocalHook("beforeSetRangeStartOnly",function(n){ft.runHooks("beforeSetRangeStartOnly",n)});this.selection.addLocalHook("beforeSetRangeEnd",function(n){ft.runHooks("beforeSetRangeEnd",n);n.row<0&&(n.row=ft.view.wt.wtTable.getFirstVisibleRow());n.col<0&&(n.col=ft.view.wt.wtTable.getFirstVisibleColumn())});this.selection.addLocalHook("afterSetRangeEnd",function(n){var t=r.createObjectPropListener(!1),c=ft.selection.getSelectedRange(),l=c.current(),u=l.from,f=l.to,a=c.size()-1,o,h,e;ft.runHooks("afterSelection",u.row,u.col,f.row,f.col,t,a);ft.runHooks("afterSelectionByProp",u.row,i.colToProp(u.col),f.row,i.colToProp(f.col),t,a);o=!1;h=!0;(ft.selection.selectedHeader.cols||ft.selection.selectedHeader.rows)&&(o=!0);(n.row<0||n.col<0)&&(h=!1);e=!0;ei&&(e=!1);t.isTouched()&&(e=!t.value);e!==!1&&!o&&h&&(ft.selection.selectedRange.current().from&&!ft.selection.isMultiple()?ft.view.scrollViewport(ft.selection.selectedRange.current().from):ft.view.scrollViewport(n));ft.selection.selectedHeader.rows&&ft.selection.selectedHeader.cols?s.addClass(ft.rootElement,["ht__selection--rows","ht__selection--columns"]):ft.selection.selectedHeader.rows?(s.removeClass(ft.rootElement,"ht__selection--columns"),s.addClass(ft.rootElement,"ht__selection--rows")):ft.selection.selectedHeader.cols?(s.removeClass(ft.rootElement,"ht__selection--rows"),s.addClass(ft.rootElement,"ht__selection--columns")):s.removeClass(ft.rootElement,["ht__selection--rows","ht__selection--columns"]);ft._refreshBorders(null)});this.selection.addLocalHook("afterSelectionFinished",function(n){var u=n.length-1,f=n[u],t=f.from,r=f.to;ft.runHooks("afterSelectionEnd",t.row,t.col,r.row,r.col,u);ft.runHooks("afterSelectionEndByProp",t.row,i.colToProp(t.col),r.row,i.colToProp(r.col),u)});this.selection.addLocalHook("afterIsMultipleSelection",function(n){var t=ft.runHooks("afterIsMultipleSelection",n.value);n.value&&(n.value=t)});this.selection.addLocalHook("beforeModifyTransformStart",function(n){ft.runHooks("modifyTransformStart",n)});this.selection.addLocalHook("afterModifyTransformStart",function(n,t,i){ft.runHooks("afterModifyTransformStart",n,t,i)});this.selection.addLocalHook("beforeModifyTransformEnd",function(n){ft.runHooks("modifyTransformEnd",n)});this.selection.addLocalHook("afterModifyTransformEnd",function(n,t,i){ft.runHooks("afterModifyTransformEnd",n,t,i)});this.selection.addLocalHook("afterDeselect",function(){kt.destroyEditor();ft._refreshBorders();s.removeClass(ft.rootElement,["ht__selection--rows","ht__selection--columns"]);ft.runHooks("afterDeselect")});this.selection.addLocalHook("insertRowRequire",function(n){ft.alter("insert_row",n,1,"auto")});this.selection.addLocalHook("insertColRequire",function(n){ft.alter("insert_col",n,1,"auto")});ui={alter:function(n,t,r,u,f){function k(n,t,i,r){var f=function(){var n=void 0;return r==="array"?n=[]:r==="object"&&(n={}),n},u=c.arrayMap(new Array(i),function(){return f()});u.unshift(t,0);n.splice.apply(n,a(u))}var e,l,y,s,d,p,w,b;r=r||1;l=function(n){var t;return n.length===0?[]:(t=[].concat(a(n)),t.sort(function(n,t){var u=h(n,1),i=u[0],f=h(t,1),r=f[0];return i===r?0:i>r?1:-1}),c.arrayReduce(t,function(n,t){var r=h(t,2),i=r[0],u=r[1],f=n[n.length-1],e=h(f,2),c=e[0],l=e[1],o=c+l,s;return i<=o?(s=Math.max(u-(o-i),0),f[1]+=s):n.push([i,u]),n},[t[0]]))};switch(n){case"insert_row":if(y=i.countSourceRows(),i.getSettings().maxRows===y)return;t=o.isDefined(t)?t:y;e=rt.createRow(t,r,u);k(v.cellSettings,t,r,"array");e&&(ot.isSelected()&&ot.selectedRange.current().from.row>=t?(ot.selectedRange.current().from.row+=e,ot.transformEnd(e,0)):i._refreshBorders());break;case"insert_col":for(e=rt.createCol(t,r,u),s=0,d=i.countSourceRows();s<d;s++)v.cellSettings[s]&&k(v.cellSettings[s],t,r);e&&(Array.isArray(i.getSettings().colHeaders)&&(p=[t,0],p.length+=e,Array.prototype.splice.apply(i.getSettings().colHeaders,p)),ot.isSelected()&&ot.selectedRange.current().from.col>=t?(ot.selectedRange.current().from.col+=e,ot.transformEnd(0,e)):i._refreshBorders());break;case"remove_row":w=function(n){var t=0;c.arrayEach(n,function(n){var l=h(n,2),r=l[0],f=l[1],e=o.isEmpty(r)?i.countRows()-1:Math.max(r-t,0),a,c,s;Number.isInteger(r)&&(r=Math.max(r-t,0));rt.removeRow(r,f,u);v.cellSettings.splice(e,f);a=i.countRows();c=i.getSettings().fixedRowsTop;c>=e+1&&(i.getSettings().fixedRowsTop-=Math.min(f,c-e));s=i.getSettings().fixedRowsBottom;s&&e>=a-s&&(i.getSettings().fixedRowsBottom-=Math.min(f,s));t+=f})};Array.isArray(t)?w(l(t)):w([[t,r]]);ui.adjustRowsAndCols();i._refreshBorders();break;case"remove_col":b=function(n){var t=0;c.arrayEach(n,function(n){var a=h(n,2),r=a[0],f=a[1],c=o.isEmpty(r)?i.countCols()-1:Math.max(r-t,0),s=dt.toPhysicalColumn(c),e,y,l;for(Number.isInteger(r)&&(r=Math.max(r-t,0)),rt.removeCol(r,f,u),e=0,y=i.countSourceRows();e<y;e++)v.cellSettings[e]&&v.cellSettings[e].splice(s,f);l=i.getSettings().fixedColumnsLeft;l>=c+1&&(i.getSettings().fixedColumnsLeft-=Math.min(f,l-c));Array.isArray(i.getSettings().colHeaders)&&(typeof s=="undefined"&&(s=-1),i.getSettings().colHeaders.splice(s,f));t+=f})};Array.isArray(t)?b(l(t)):b([[t,r]]);ui.adjustRowsAndCols();i._refreshBorders();break;default:throw new Error('There is no such action "'+n+'"');}f||ui.adjustRowsAndCols()},adjustRowsAndCols:function(){var f,e,o,u,n,t,r;if(v.settings.minRows&&(f=i.countRows(),f<v.settings.minRows))for(e=0,o=v.settings.minRows;e<o-f;e++)rt.createRow(i.countRows(),1,"auto");if(v.settings.minSpareRows&&(u=i.countEmptyRows(!0),u<v.settings.minSpareRows))for(;u<v.settings.minSpareRows&&i.countSourceRows()<v.settings.maxRows;u++)rt.createRow(i.countRows(),1,"auto");if(n=void 0,(v.settings.minCols||v.settings.minSpareCols)&&(n=i.countEmptyCols(!0)),v.settings.minCols&&!v.settings.columns&&i.countCols()<v.settings.minCols)for(;i.countCols()<v.settings.minCols;n++)rt.createCol(i.countCols(),1,"auto");if(v.settings.minSpareCols&&!v.settings.columns&&i.dataType==="array"&&n<v.settings.minSpareCols)for(;n<v.settings.minSpareCols&&i.countCols()<v.settings.maxCols;n++)rt.createCol(i.countCols(),1,"auto");t=i.countRows();r=i.countCols();(t===0||r===0)&&ot.deselect();ot.isSelected()&&c.arrayEach(ot.selectedRange,function(n){var s=!1,u=n.from.row,f=n.from.col,e=n.to.row,o=n.to.col;u>t-1?(u=t-1,s=!0,e>u&&(e=u)):e>t-1&&(e=t-1,s=!0,u>e&&(u=e));f>r-1?(f=r-1,s=!0,o>f&&(o=f)):o>r-1&&(o=r-1,s=!0,f>o&&(f=o));s&&i.selectCell(u,f,e,o)});i.view&&i.view.wt.wtOverlays.adjustElementsSize()},populateFromArray:function(n,t,u,e,s,h,c){var y,b,w,k,ht=[],l={},it,rt,ct,lt,ii,at,vt,yt,pt,ut,ni,ti;if(b=t.length,b===0)return!1;ii={row:u===null?null:u.row,col:u===null?null:u.col};switch(s){case"shift_down":for(it=u?u.col-n.col+1:0,rt=u?u.row-n.row+1:0,t=p.translateRowsToColumns(t),w=0,k=t.length,ct=Math.max(k,it);w<ct;w++)if(w<k){for(y=0,b=t[w].length;y<rt-b;y++)t[w].push(t[w][y%b]);t[w].unshift(n.col+w,n.row,0);(at=i).spliceCol.apply(at,a(t[w]))}else t[w%k][0]=n.col+w,(vt=i).spliceCol.apply(vt,a(t[w%k]));break;case"shift_right":for(it=u?u.col-n.col+1:0,rt=u?u.row-n.row+1:0,y=0,b=t.length,lt=Math.max(b,rt);y<lt;y++)if(y<b){for(w=0,k=t[y].length;w<it-k;w++)t[y].push(t[y][w%k]);t[y].unshift(n.row+y,n.col,0);(yt=i).spliceRow.apply(yt,a(t[y]))}else t[y%b][0]=n.row+y,(pt=i).spliceRow.apply(pt,a(t[y%b]));break;case"overwrite":default:l.row=n.row;l.col=n.col;var ri={row:u&&n?u.row-n.row+1:1,col:u&&n?u.col-n.col+1:1},wt=0,ft=0,nt=!0,tt=void 0,bt=function(n){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null,i=t[n%t.length];return r!==null?i[r%i.length]:i},kt=t.length,et=u?u.row-n.row+1:0;for(b=u?et:Math.max(kt,et),y=0;y<b;y++){if(u&&l.row>u.row&&et>kt||!v.settings.allowInsertRow&&l.row>i.countRows()-1||l.row>=v.settings.maxRows)break;var ot=y-wt,dt=bt(ot).length,st=u?u.col-n.col+1:0;if(k=u?st:Math.max(dt,st),l.col=n.col,tt=i.getCellMeta(l.row,l.col),(e==="CopyPaste.paste"||e==="Autofill.autofill")&&tt.skipRowOnPaste){wt++;l.row++;b++;continue}for(ft=0,w=0;w<k;w++){if(u&&l.col>u.col&&st>dt||!v.settings.allowInsertColumn&&l.col>i.countCols()-1||l.col>=v.settings.maxCols)break;if(tt=i.getCellMeta(l.row,l.col),(e==="CopyPaste.paste"||e==="Autofill.fill")&&tt.skipColumnOnPaste){ft++;l.col++;k++;continue}if(tt.readOnly){l.col++;continue}var gt=w-ft,d=bt(ot,gt),g=i.getDataAtCell(l.row,l.col),ui={row:ot,col:gt};e==="Autofill.fill"&&(ut=i.runHooks("beforeAutofillInsidePopulate",ui,h,t,c,{},ri),ut&&(d=o.isUndefined(ut.value)?d:ut.value));d!==null&&(typeof d=="undefined"?"undefined":f(d))==="object"?g===null||(typeof g=="undefined"?"undefined":f(g))!=="object"?nt=!1:(ni=r.duckSchema(g[0]||g),ti=r.duckSchema(d[0]||d),r.isObjectEqual(ni,ti)?d=r.deepClone(d):nt=!1):g!==null&&(typeof g=="undefined"?"undefined":f(g))==="object"&&(nt=!1);nt&&ht.push([l.row,l.col,d]);nt=!0;l.col++}l.row++}i.setDataAtCell(ht,null,null,e||"populateFromArray")}}};this.init=function(){pt.setData(v.settings.data);i.runHooks("beforeInit");it.isMobileBrowser()&&s.addClass(i.rootElement,"mobile");this.updateSettings(v.settings,!0);this.view=new yt.default(this);kt=et.default.getInstance(i,v,ot,rt);this.forceFullRender=!0;i.runHooks("init");this.view.render();f(v.firstRun)==="object"&&(i.runHooks("afterChange",v.firstRun[0],v.firstRun[1]),v.firstRun=!1);i.runHooks("afterInit")};this.validateCell=function(n,t,r,u){function s(n){var o=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!0;if(!o||t.hidden===!0){r(n);return}var f=t.visualCol,e=t.visualRow,u=i.getCell(e,f,!0);u&&u.nodeName!="TH"&&i.view.wt.wtSettings.settings.cellRenderer(e,f,u);r(n)}var f=i.getCellValidator(t);o.isRegExp(f)&&(f=function(n){return function(t,i){i(n.test(t))}}(f));e.isFunction(f)?(n=i.runHooks("beforeValidate",n,t.visualRow,t.prop,u),i._registerTimeout(setTimeout(function(){f.call(t,n,function(r){r=i.runHooks("afterValidate",r,n,t.visualRow,t.prop,u);t.valid=r;s(r);i.runHooks("postAfterValidate",r,n,t.visualRow,t.prop,u)})},0))):i._registerTimeout(setTimeout(function(){t.valid=!0;s(t.valid,!1)},0))};this.setDataAtCell=function(n,t,r,u){for(var o=ci(n,t,r),s=[],c,e=0,h=o.length;e<h;e++){if(f(o[e])!=="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof o[e][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");c=rt.colToProp(o[e][1]);s.push([o[e][0],c,pt.getAtCell(dt.toPhysicalRow(o[e][0]),o[e][1]),o[e][2]])}u||(typeof n=="undefined"?"undefined":f(n))!=="object"||(u=t);i.runHooks("afterSetDataAtCell",s,u);si(s,u,function(){hi(s,u)})};this.setDataAtRowProp=function(n,t,r,u){for(var o=ci(n,t,r),s=[],e=0,h=o.length;e<h;e++)s.push([o[e][0],o[e][1],pt.getAtCell(dt.toPhysicalRow(o[e][0]),o[e][1]),o[e][2]]);u||(typeof n=="undefined"?"undefined":f(n))!=="object"||(u=t);i.runHooks("afterSetDataAtRowProp",s,u);si(s,u,function(){hi(s,u)})};this.listen=function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:!0,n;t&&(n=!document.activeElement||document.activeElement&&document.activeElement.nodeName===void 0,document.activeElement&&document.activeElement!==document.body&&!n?document.activeElement.blur():n&&document.body.focus());i&&!i.isListening()&&(b=i.guid,i.runHooks("afterListen"))};this.unlisten=function(){this.isListening()&&(b=null,i.runHooks("afterUnlisten"))};this.isListening=function(){return b===i.guid};this.destroyEditor=function(n){i._refreshBorders(n)};this.populateFromArray=function(n,t,i,r,e,o,s,h,c){var l;if(!((typeof i=="undefined"?"undefined":f(i))==="object"&&f(i[0])==="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");return l=typeof r=="number"?new u.CellCoords(r,e):null,ui.populateFromArray(new u.CellCoords(n,t),i,l,o,s,h,c)};this.spliceCol=function(){var n;return(n=rt).spliceCol.apply(n,arguments)};this.spliceRow=function(){var n;return(n=rt).spliceRow.apply(n,arguments)};this.getSelected=function(){if(ot.isSelected())return c.arrayMap(ot.getSelectedRange(),function(n){var t=n.from,i=n.to;return[t.row,t.col,i.row,i.col]})};this.getSelectedLast=function(){var n=this.getSelected(),t=void 0;return n&&n.length>0&&(t=n[n.length-1]),t};this.getSelectedRange=function(){if(ot.isSelected())return Array.from(ot.getSelectedRange())};this.getSelectedRangeLast=function(){var n=this.getSelectedRange(),t=void 0;return n&&n.length>0&&(t=n[n.length-1]),t};this.emptySelectedCells=function(){var t=this,n;ot.isSelected()&&(n=[],c.arrayEach(ot.getSelectedRange(),function(i){var r=i.getTopLeftCorner(),u=i.getBottomRightCorner();y.rangeEach(r.row,u.row,function(i){y.rangeEach(r.col,u.col,function(r){t.getCellMeta(i,r).readOnly||n.push([i,r,""])})})}),n.length>0&&this.setDataAtCell(n))};this.render=function(){i.view&&(i.renderCall=!0,i.forceFullRender=!0,kt.lockEditor(),i._refreshBorders(null),kt.unlockEditor())};this.loadData=function(n){function l(){v.cellSettings.length=0}var o,c;if(i.dataType=Array.isArray(v.settings.dataSchema)?"array":e.isFunction(v.settings.dataSchema)?"function":"object",rt&&rt.destroy(),rt=new ut.default(i,v,vt),(typeof n=="undefined"?"undefined":f(n))==="object"&&n!==null)n.push&&n.splice||(n=[n]);else if(n===null){n=[];for(var t,u=0,s=0,h=rt.getSchema(),u=0,s=v.settings.startRows;u<s;u++)if((i.dataType==="object"||i.dataType==="function")&&v.settings.dataSchema)t=r.deepClone(h),n.push(t);else if(i.dataType==="array")t=r.deepClone(h[0]),n.push(t);else{for(t=[],o=0,c=v.settings.startCols;o<c;o++)t.push(null);n.push(t)}}else throw new Error("loadData only accepts array of objects or array of arrays ("+(typeof n=="undefined"?"undefined":f(n))+" given)");v.isPopulated=!1;vt.prototype.data=n;Array.isArray(n[0])&&(i.dataType="array");rt.dataSource=n;pt.data=n;pt.dataType=i.dataType;pt.colToProp=rt.colToProp.bind(rt);pt.propToCol=rt.propToCol.bind(rt);l();ui.adjustRowsAndCols();i.runHooks("afterLoadData",v.firstRun);v.firstRun?v.firstRun=[null,"loadData"]:(i.runHooks("afterChange",null,"loadData"),i.render());v.isPopulated=!0};this.getData=function(n,t,i,r){return o.isUndefined(n)?rt.getAll():rt.getRange(new u.CellCoords(n,t),new u.CellCoords(i,r),rt.DESTINATION_RENDERER)};this.getCopyableText=function(n,t,i,r){return rt.getCopyableText(new u.CellCoords(n,t),new u.CellCoords(i,r))};this.getCopyableData=function(n,t){return rt.getCopyable(n,rt.colToProp(t))};this.getSchema=function(){return rt.getSchema()};this.updateSettings=function(n,t){var nt=!1,u=void 0,c=void 0,b=void 0,h,d,a,tt,g,y,f,it,p,w;if(o.isDefined(n.rows))throw new Error('"rows" setting is no longer supported. do you mean startRows, minRows or maxRows?');if(o.isDefined(n.cols))throw new Error('"cols" setting is no longer supported. do you mean startCols, minCols or maxCols?');for(u in n)if(u==="data")continue;else if(u==="language"){pi(n.language);continue}else l.default.getSingleton().getRegistered().indexOf(u)>-1?(e.isFunction(n[u])||Array.isArray(n[u]))&&(n[u].initialHook=!0,i.addHook(u,n[u])):!t&&r.hasOwnProperty(n,u)&&(vt.prototype[u]=n[u]);if(n.data===void 0&&v.settings.data===void 0?i.loadData(null):n.data!==void 0?i.loadData(n.data):n.columns!==void 0&&rt.createMap(),b=i.countCols(),h=n.columns||vt.prototype.columns,h&&e.isFunction(h)&&(b=i.countSourceCols(),nt=!0),(n.cell!==void 0||n.cells!==void 0||n.columns!==void 0)&&(v.cellSettings.length=0),b>0)for(d=void 0,a=void 0,u=0,c=0;u<b;u++)(!nt||h(u))&&(v.columnSettings[c]=k.columnFactory(vt,v.columnsSettingConflicts),d=v.columnSettings[c].prototype,h&&(a=nt?h(u):h[c],a&&(r.extend(d,a),r.extend(d,fi(a)))),c++);if(o.isDefined(n.cell))for(tt in n.cell)r.hasOwnProperty(n.cell,tt)&&(g=n.cell[tt],i.setCellMetaObject(g.row,g.col,g));i.runHooks("afterCellMetaReset");o.isDefined(n.className)&&(vt.prototype.className&&s.removeClass(i.rootElement,vt.prototype.className),n.className&&s.addClass(i.rootElement,n.className));y=i.rootElement.style.height;y!==""&&(y=parseInt(i.rootElement.style.height,10));f=n.height;e.isFunction(f)&&(f=f());t&&(it=i.rootElement.getAttribute("style"),it&&i.rootElement.setAttribute("data-initialstyle",i.rootElement.getAttribute("style")));f===null?(p=i.rootElement.getAttribute("data-initialstyle"),p&&(p.indexOf("height")>-1||p.indexOf("overflow")>-1)?i.rootElement.setAttribute("style",p):(i.rootElement.style.height="",i.rootElement.style.overflow="")):f!==void 0&&(i.rootElement.style.height=f+"px",i.rootElement.style.overflow="hidden");typeof n.width!="undefined"&&(w=n.width,e.isFunction(w)&&(w=w()),i.rootElement.style.width=w+"px");t||(rt.clearLengthCache(),i.view&&i.view.wt.wtViewport.resetHasOversizedColumnHeadersMarked(),i.runHooks("afterUpdateSettings",n));ui.adjustRowsAndCols();i.view&&!v.firstRun&&(i.forceFullRender=!0,kt.lockEditor(),i._refreshBorders(null),kt.unlockEditor());!t&&i.view&&(y===""||f===""||f===void 0)&&y!==f&&i.view.wt.wtOverlays.updateMainScrollableElements()};this.getValue=function(){var n=i.getSelectedLast();if(vt.prototype.getValue){if(e.isFunction(vt.prototype.getValue))return vt.prototype.getValue.call(i);if(n)return i.getData()[n[0][0]][vt.prototype.getValue]}else if(n)return i.getDataAtCell(n[0],n[1])};this.getSettings=function(){return v.settings};this.clear=function(){ot.selectAll();this.emptySelectedCells()};this.alter=function(n,t,i,r,u){ui.alter(n,t,i,r,u)};this.getCell=function(n,t,r){return i.view.getCellAtCoords(new u.CellCoords(n,t),r)};this.getCoords=function(n){return this.view.wt.wtTable.getCoords.call(this.view.wt.wtTable,n)};this.colToProp=function(n){return rt.colToProp(n)};this.propToCol=function(n){return rt.propToCol(n)};this.toVisualRow=function(n){return dt.toVisualRow(n)};this.toVisualColumn=function(n){return dt.toVisualColumn(n)};this.toPhysicalRow=function(n){return dt.toPhysicalRow(n)};this.toPhysicalColumn=function(n){return dt.toPhysicalColumn(n)};this.getDataAtCell=function(n,t){return rt.get(n,rt.colToProp(t))};this.getDataAtRowProp=function(n,t){return rt.get(n,t)};this.getDataAtCol=function(n){var t=[];return t.concat.apply(t,a(rt.getRange(new u.CellCoords(0,n),new u.CellCoords(v.settings.data.length-1,n),rt.DESTINATION_RENDERER)))};this.getDataAtProp=function(n){var t=[],i;return i=rt.getRange(new u.CellCoords(0,rt.propToCol(n)),new u.CellCoords(v.settings.data.length-1,rt.propToCol(n)),rt.DESTINATION_RENDERER),t.concat.apply(t,a(i))};this.getSourceData=function(n,t,i,r){return n===void 0?pt.getData():pt.getByRange(new u.CellCoords(n,t),new u.CellCoords(i,r))};this.getSourceDataArray=function(n,t,i,r){return n===void 0?pt.getData(!0):pt.getByRange(new u.CellCoords(n,t),new u.CellCoords(i,r),!0)};this.getSourceDataAtCol=function(n){return pt.getAtColumn(n)};this.getSourceDataAtRow=function(n){return pt.getAtRow(n)};this.getSourceDataAtCell=function(n,t){return pt.getAtCell(n,t)};this.getDataAtRow=function(n){var t=rt.getRange(new u.CellCoords(n,0),new u.CellCoords(n,this.countCols()-1),rt.DESTINATION_RENDERER);return t[0]||[]};this.getDataType=function(n,t,i,r){var o=this,f=null,u=null,e;return n===void 0&&(n=0,i=this.countRows(),t=0,r=this.countCols()),i===void 0&&(i=n),r===void 0&&(r=t),e="mixed",y.rangeEach(Math.min(n,i),Math.max(n,i),function(n){var i=!0;return y.rangeEach(Math.min(t,r),Math.max(t,r),function(t){var r=o.getCellMeta(n,t);return u=r.type,f?i=f===u:f=u,i}),e=i?u:"mixed",i}),e};this.removeCellMeta=function(n,t,r){var s=dt.toPhysical(n,t),f=h(s,2),e=f[0],o=f[1],u=v.cellSettings[e][o][r],c=i.runHooks("beforeRemoveCellMeta",n,t,r,u);c!==!1&&(delete v.cellSettings[e][o][r],i.runHooks("afterRemoveCellMeta",n,t,r,u));u=null};this.spliceCellsMeta=function(n,t){for(var u,r=arguments.length,f=Array(r>2?r-2:0),i=2;i<r;i++)f[i-2]=arguments[i];(u=v.cellSettings).splice.apply(u,[n,t].concat(f))};this.setCellMetaObject=function(n,t,i){var u,e;if((typeof i=="undefined"?"undefined":f(i))==="object")for(u in i)r.hasOwnProperty(i,u)&&(e=i[u],this.setCellMeta(n,t,u,e))};this.setCellMeta=function(n,t,r,u){var s=dt.toPhysical(n,t),o=h(s,2),e=o[0],f=o[1];v.columnSettings[f]||(v.columnSettings[f]=k.columnFactory(vt,v.columnsSettingConflicts));v.cellSettings[e]||(v.cellSettings[e]=[]);v.cellSettings[e][f]||(v.cellSettings[e][f]=new v.columnSettings[f]);v.cellSettings[e][f][r]=u;i.runHooks("afterSetCellMeta",n,t,r,u)};this.getCellsMeta=function(){return c.arrayFlatten(v.cellSettings)};this.getCellMeta=function(n,t){var s=rt.colToProp(t),u=void 0,l=dt.toPhysical(n,t),c=h(l,2),f=c[0],e=c[1],o;return f===null&&(f=n),v.columnSettings[e]||(v.columnSettings[e]=k.columnFactory(vt,v.columnsSettingConflicts)),v.cellSettings[f]||(v.cellSettings[f]=[]),v.cellSettings[f][e]||(v.cellSettings[f][e]=new v.columnSettings[e]),u=v.cellSettings[f][e],u.row=f,u.col=e,u.visualRow=n,u.visualCol=t,u.prop=s,u.instance=i,i.runHooks("beforeGetCellMeta",n,t,u),r.extend(u,fi(u)),u.cells&&(o=u.cells.call(u,f,e,s),o&&(r.extend(u,o),r.extend(u,fi(o)))),i.runHooks("afterGetCellMeta",n,t,u),u};this.getCellMetaAtRow=function(n){return v.cellSettings[n]};this.isColumnModificationAllowed=function(){return!(i.dataType==="object"||i.getSettings().columns)};li=p.cellMethodLookupFactory("renderer");this.getCellRenderer=function(n,t){return ct.getRenderer(li.call(this,n,t))};this.getCellEditor=p.cellMethodLookupFactory("editor");ai=p.cellMethodLookupFactory("validator");this.getCellValidator=function(n,t){var i=ai.call(this,n,t);return typeof i=="string"&&(i=lt.getValidator(i)),i};this.validateCells=function(n){this._validateCells(n)};this.validateRows=function(n,t){if(!Array.isArray(n))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(t,n)};this.validateColumns=function(n,t){if(!Array.isArray(n))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(t,undefined,n)};this._validateCells=function(n,t,r){var e=new oi,u,f;for(n&&(e.onQueueEmpty=n),u=i.countRows()-1;u>=0;){if(t!==undefined&&t.indexOf(u)===-1){u--;continue}for(f=i.countCols()-1;f>=0;){if(r!==undefined&&r.indexOf(f)===-1){f--;continue}e.addValidatorToQueue();i.validateCell(i.getDataAtCell(u,f),i.getCellMeta(u,f),function(n){if(typeof n!="boolean")throw new Error("Validation error: result is not boolean");n===!1&&(e.valid=!1);e.removeValidatorFormQueue()},"validateCells");f--}u--}e.checkIfQueueIsEmpty()};this.getRowHeader=function(n){var t=v.settings.rowHeaders;return n!==void 0&&(n=i.runHooks("modifyRowHeader",n)),n===void 0?(t=[],y.rangeEach(i.countRows()-1,function(n){t.push(i.getRowHeader(n))})):Array.isArray(t)&&t[n]!==void 0?t=t[n]:e.isFunction(t)?t=t(n):t&&typeof t!="string"&&typeof t!="number"&&(t=n+1),t};this.hasRowHeaders=function(){return!!v.settings.rowHeaders};this.hasColHeaders=function(){if(v.settings.colHeaders!==void 0&&v.settings.colHeaders!==null)return!!v.settings.colHeaders;for(var n=0,t=i.countCols();n<t;n++)if(i.getColHeader(n))return!0;return!1};this.getColHeader=function(n){var c=v.settings.columns&&e.isFunction(v.settings.columns),t=v.settings.colHeaders,f,o,r,s,h,u;if(n=i.runHooks("modifyColHeader",n),n===void 0){for(f=[],o=c?i.countSourceCols():i.countCols(),r=0;r<o;r++)f.push(i.getColHeader(r));t=f}else s=function(n){for(var r=[],u=i.countSourceCols(),t=0;t<u;t++)e.isFunction(i.getSettings().columns)&&i.getSettings().columns(t)&&r.push(t);return r[n]},h=n,n=i.runHooks("modifyCol",n),u=s(n),v.settings.columns&&e.isFunction(v.settings.columns)&&v.settings.columns(u)&&v.settings.columns(u).title?t=v.settings.columns(u).title:v.settings.columns&&v.settings.columns[n]&&v.settings.columns[n].title?t=v.settings.columns[n].title:Array.isArray(v.settings.colHeaders)&&v.settings.colHeaders[n]!==void 0?t=v.settings.colHeaders[n]:e.isFunction(v.settings.colHeaders)?t=v.settings.colHeaders(n):v.settings.colHeaders&&typeof v.settings.colHeaders!="string"&&typeof v.settings.colHeaders!="number"&&(t=p.spreadsheetColumnLabel(h));return t};this._getColWidthFromSettings=function(n){var r=i.getCellMeta(0,n),t=r.width;if((t===void 0||t===v.settings.width)&&(t=r.colWidths),t!==void 0&&t!==null){switch(typeof t=="undefined"?"undefined":f(t)){case"object":t=t[n];break;case"function":t=t(n)}typeof t=="string"&&(t=parseInt(t,10))}return t};this.getColWidth=function(n){var t=i._getColWidthFromSettings(n);return t=i.runHooks("modifyColWidth",t,n),t===void 0&&(t=u.ViewportColumnsCalculator.DEFAULT_WIDTH),t};this._getRowHeightFromSettings=function(n){var t=v.settings.rowHeights;if(t!==void 0&&t!==null){switch(typeof t=="undefined"?"undefined":f(t)){case"object":t=t[n];break;case"function":t=t(n)}typeof t=="string"&&(t=parseInt(t,10))}return t};this.getRowHeight=function(n){var t=i._getRowHeightFromSettings(n);return i.runHooks("modifyRowHeight",t,n)};this.countSourceRows=function(){var n=i.runHooks("modifySourceLength");return n||(i.getSourceData()?i.getSourceData().length:0)};this.countSourceCols=function(){var n=i.getSourceData()&&i.getSourceData()[0]?i.getSourceData()[0]:[];return r.isObject(n)?r.deepObjectSize(n):n.length||0};this.countRows=function(){return rt.getLength()};this.countCols=function(){var o=this.getSettings().maxCols,u=!1,n=0,f,r,t;if(i.dataType==="array"&&(u=v.settings.data&&v.settings.data[0]&&v.settings.data[0].length),u&&(n=v.settings.data[0].length),v.settings.columns)if(f=e.isFunction(v.settings.columns),f)if(i.dataType==="array"){for(r=0,t=0;t<n;t++)v.settings.columns(t)&&r++;n=r}else(i.dataType==="object"||i.dataType==="function")&&(n=rt.colToPropCache.length);else n=v.settings.columns.length;else(i.dataType==="object"||i.dataType==="function")&&(n=rt.colToPropCache.length);return Math.min(o,n)};this.rowOffset=function(){return i.view.wt.wtTable.getFirstRenderedRow()};this.colOffset=function(){return i.view.wt.wtTable.getFirstRenderedColumn()};this.countRenderedRows=function(){return i.view.wt.drawn?i.view.wt.wtTable.getRenderedRowsCount():-1};this.countVisibleRows=function(){return i.view.wt.drawn?i.view.wt.wtTable.getVisibleRowsCount():-1};this.countRenderedCols=function(){return i.view.wt.drawn?i.view.wt.wtTable.getRenderedColumnsCount():-1};this.countVisibleCols=function(){return i.view.wt.drawn?i.view.wt.wtTable.getVisibleColumnsCount():-1};this.countEmptyRows=function(n){for(var t=i.countRows()-1,r=0,u;t>=0;){if(u=i.runHooks("modifyRow",t),i.isEmptyRow(u))r++;else if(n)break;t--}return r};this.countEmptyCols=function(n){if(i.countRows()<1)return 0;for(var t=i.countCols()-1,r=0;t>=0;){if(i.isEmptyCol(t))r++;else if(n)break;t--}return r};this.isEmptyRow=function(n){return v.settings.isEmptyRow.call(i,n)};this.isEmptyCol=function(n){return v.settings.isEmptyCol.call(i,n)};this.selectCell=function(n,t,i,r){var u=arguments.length>4&&arguments[4]!==undefined?arguments[4]:!0,f=arguments.length>5&&arguments[5]!==undefined?arguments[5]:!0;return o.isUndefined(n)||o.isUndefined(t)?!1:this.selectCells([[n,t,i,r]],u,f)};this.selectCells=function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[[]],r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!0,u=arguments.length>2&&arguments[2]!==undefined?arguments[2]:!0,n;return r===!1&&(ei=!0),n=ot.selectCells(t),n&&u&&i.listen(),ei=!1,n};this.selectCellByProp=function(n,t,i,r){var u=arguments.length>4&&arguments[4]!==undefined?arguments[4]:!0,f=arguments.length>5&&arguments[5]!==undefined?arguments[5]:!0;return console.warn(st.toSingleLine(tt)),this.selectCells([[n,t,i,r]],u,f)};this.selectColumns=function(n){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:n;return ot.selectColumns(n,t)};this.selectRows=function(n){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:n;return ot.selectRows(n,t)};this.deselectCell=function(){ot.deselect()};this.scrollViewportTo=function(n,t){var u=arguments.length>2&&arguments[2]!==undefined?arguments[2]:!1,f=arguments.length>3&&arguments[3]!==undefined?arguments[3]:!1,r;return n!==void 0&&(n<0||n>=i.countRows())?!1:t!==void 0&&(t<0||t>=i.countCols())?!1:(r=!1,n!==void 0&&t!==void 0&&(i.view.wt.wtOverlays.topOverlay.scrollTo(n,u),i.view.wt.wtOverlays.leftOverlay.scrollTo(t,f),r=!0),typeof n=="number"&&typeof t!="number"&&(i.view.wt.wtOverlays.topOverlay.scrollTo(n,u),r=!0),typeof t=="number"&&typeof n!="number"&&(i.view.wt.wtOverlays.leftOverlay.scrollTo(t,f),r=!0),r)};this.destroy=function(){var t,n;i._clearTimeouts();i.view&&i.view.destroy();pt&&pt.destroy();pt=null;nt.stopObserving();!0&&w.isRootInstance(i)&&(t=document.querySelector("#hot-display-license-info"),t&&t.parentNode.removeChild(t));s.empty(i.rootElement);yi.destroy();kt&&kt.destroy();i.runHooks("afterDestroy");l.default.getSingleton().destroy(i);for(n in i)r.hasOwnProperty(i,n)&&(e.isFunction(i[n])?i[n]=bi:n!=="guid"&&(i[n]=null));rt&&rt.destroy();rt=null;v=null;ui=null;ot=null;kt=null;i=null;vt=null};this.getActiveEditor=function(){return kt.getActiveEditor()};this.getPlugin=function(n){return ht.getPlugin(this,n)};this.getInstance=function(){return i};this.addHook=function(n,t){l.default.getSingleton().add(n,t,i)};this.hasHook=function(n){return l.default.getSingleton().has(n,i)};this.addHookOnce=function(n,t){l.default.getSingleton().once(n,t,i)};this.removeHook=function(n,t){l.default.getSingleton().remove(n,t,i)};this.runHooks=function(n,t,r,u,f,e,o){return l.default.getSingleton().run(i,n,t,r,u,f,e,o)};this.getTranslatedPhrase=function(n,t){return ti.getTranslatedPhrase(v.settings.language,n,t)};this.timeouts=[];this._registerTimeout=function(n){this.timeouts.push(n)};this._clearTimeouts=function(){for(var n=0,t=this.timeouts.length;n<t;n++)clearTimeout(this.timeouts[n])};this._refreshBorders=function(n){kt.destroyEditor(n);i.view.render();ot.isSelected()&&kt.prepareEditor()};l.default.getSingleton().run(i,"construct")}var b;t.__esModule=!0;var f=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},h=function(){function n(n,t){var r=[],u=!0,f=!1,e=undefined,i,o;try{for(i=n[Symbol.iterator]();!(u=(o=i.next()).done);u=!0)if(r.push(o.value),t&&r.length===t)break}catch(s){f=!0;e=s}finally{try{!u&&i["return"]&&i["return"]()}finally{if(f)throw e;}}return r}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return n(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance");}}(),tt=ui(["Deprecation warning: This method is going to be removed in the next release. \n      If you want to select a cell using props, please use the `selectCell` method."],["Deprecation warning: This method is going to be removed in the next release.\\x20\n      If you want to select a cell using props, please use the \\`selectCell\\` method."]);t.default=fi;var s=i(2),k=i(153),e=i(35),o=i(13),it=i(33),rt=i(537),ut=v(rt),ft=i(540),et=v(ft),ot=i(9),g=v(ot),r=i(1),c=i(0),st=i(34),ht=i(6),ct=i(15),lt=i(36),at=i(31),y=i(4),vt=i(541),yt=v(vt),pt=i(542),wt=v(pt),p=i(81),bt=i(53),w=i(449),u=i(8),kt=i(14),l=v(kt),dt=i(450),gt=v(dt),ni=i(151),ti=i(451),ii=i(82),d=i(452),nt=i(453),ri=i(546);b=null},function(n,t,i){"use strict";function u(n,t){function i(){}r.inherit(i,n);for(var u=0,f=t.length;u<f;u++)i.prototype[t[u]]=void 0;return i}t.__esModule=!0;t.columnFactory=u;var r=i(1)},function(n,t,i){"use strict";function u(n){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:h,i,c;if(r!==h&&r!==y)throw new Error("The second argument is used internally only and cannot be overwritten.");var a=Array.isArray(n),f=r===h,t=e;return a&&(i=n[0],n.length===0?t=o:f&&i instanceof p.CellRange?t=s:f&&Array.isArray(i)?t=u(i,y):n.length>=2&&n.length<=4&&(c=!n.some(function(n,t){return!b[t].includes(typeof n=="undefined"?"undefined":l(n))}),c&&(t=v))),t}function c(n){var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{},r=i.keepDirection,u=r===undefined?!1:r,t=i.propToCol;if(!w.includes(n))throw new Error("Unsupported selection ranges schema type was provided.");return function(i){var o=n===s,h=o?i.from.row:i[0],f=o?i.from.col:i[1],e=o?i.to.row:i[2],r=o?i.to.col:i[3];if(typeof t=="function"&&(typeof f=="string"&&(f=t(f)),typeof r=="string"&&(r=t(r))),a.isUndefined(e)&&(e=h),a.isUndefined(r)&&(r=f),!u){var c=h,l=f,v=e,y=r;h=Math.min(c,v);f=Math.min(l,y);e=Math.max(c,v);r=Math.max(l,y)}return[h,f,e,r]}}function k(n){var i=u(n),s,t,h,l;return i===e||i===o?[]:(s=c(i),t=new Set,r.arrayEach(n,function(n){var e=s(n),i=f(e,4),u=i[1],o=i[3],h=o-u+1;r.arrayEach(Array.from(new Array(h),function(n,t){return u+t}),function(n){t.has(n)||t.add(n)})}),h=Array.from(t).sort(function(n,t){return n-t}),l=r.arrayReduce(h,function(n,t,i,r){return i!==0&&t===r[i-1]+1?n[n.length-1][1]++:n.push([t,1]),n},[]),l)}function d(n){var i=u(n),s,t,h,l;return i===e||i===o?[]:(s=c(i),t=new Set,r.arrayEach(n,function(n){var e=s(n),i=f(e,3),u=i[0],o=i[2],h=o-u+1;r.arrayEach(Array.from(new Array(h),function(n,t){return u+t}),function(n){t.has(n)||t.add(n)})}),h=Array.from(t).sort(function(n,t){return n-t}),l=r.arrayReduce(h,function(n,t,i,r){return i!==0&&t===r[i-1]+1?n[n.length-1][1]++:n.push([t,1]),n},[]),l)}function g(n){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:Infinity;return typeof n=="number"&&n>=0&&n<t}var f,l;t.__esModule=!0;t.SELECTION_TYPES=t.SELECTION_TYPE_OBJECT=t.SELECTION_TYPE_ARRAY=t.SELECTION_TYPE_EMPTY=t.SELECTION_TYPE_UNRECOGNIZED=undefined;f=function(){function n(n,t){var r=[],u=!0,f=!1,e=undefined,i,o;try{for(i=n[Symbol.iterator]();!(u=(o=i.next()).done);u=!0)if(r.push(o.value),t&&r.length===t)break}catch(s){f=!0;e=s}finally{try{!u&&i["return"]&&i["return"]()}finally{if(f)throw e;}}return r}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return n(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance");}}();l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n};t.detectSelectionType=u;t.normalizeSelectionFactory=c;t.transformSelectionToColumnDistance=k;t.transformSelectionToRowDistance=d;t.isValidCoord=g;var p=i(8),r=i(0),a=i(13),e=t.SELECTION_TYPE_UNRECOGNIZED=0,o=t.SELECTION_TYPE_EMPTY=1,v=t.SELECTION_TYPE_ARRAY=2,s=t.SELECTION_TYPE_OBJECT=3,w=t.SELECTION_TYPES=[s,v],b=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],h=Symbol("root"),y=Symbol("child")},function(n,t,i){"use strict";function o(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var f;t.__esModule=!0;var e=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),u=i(2),r=i(0);f=function(){function n(t){o(this,n);this.hot=t;this.container=null;this.injected=!1;this.rows=[];this.columns=[];this.samples=null;this.settings={useHeaders:!0}}return e(n,[{key:"addRow",value:function(n,t){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));var i={row:n};this.rows.push(i);this.samples=t;this.table=this.createTable(this.hot.table.className);this.table.colGroup.appendChild(this.createColGroupsCol());this.table.tr.appendChild(this.createRow(n));this.container.container.appendChild(this.table.fragment);i.table=this.table.table}},{key:"addColumnHeadersRow",value:function(n){if(this.hot.getColHeader(0)!=null){var t={row:-1};this.rows.push(t);this.container=this.createContainer(this.hot.rootElement.className);this.samples=n;this.table=this.createTable(this.hot.table.className);this.table.colGroup.appendChild(this.createColGroupsCol());this.table.tHead.appendChild(this.createColumnHeadersRow());this.container.container.appendChild(this.table.fragment);t.table=this.table.table}}},{key:"addColumn",value:function(n,t){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));var i={col:n};this.columns.push(i);this.samples=t;this.table=this.createTable(this.hot.table.className);this.getSetting("useHeaders")&&this.hot.getColHeader(n)!==null&&this.hot.view.appendColHeader(n,this.table.th);this.table.tBody.appendChild(this.createCol(n));this.container.container.appendChild(this.table.fragment);i.table=this.table.table}},{key:"getHeights",value:function(n){this.injected||this.injectTable();r.arrayEach(this.rows,function(t){n(t.row,u.outerHeight(t.table)-1)})}},{key:"getWidths",value:function(n){this.injected||this.injectTable();r.arrayEach(this.columns,function(t){n(t.col,u.outerWidth(t.table))})}},{key:"setSettings",value:function(n){this.settings=n}},{key:"setSetting",value:function(n,t){this.settings||(this.settings={});this.settings[n]=t}},{key:"getSettings",value:function(){return this.settings}},{key:"getSetting",value:function(n){return this.settings?this.settings[n]:null}},{key:"createColGroupsCol",value:function(){var t=this,i=document,n=i.createDocumentFragment();return this.hot.hasRowHeaders()&&n.appendChild(this.createColElement(-1)),this.samples.forEach(function(i){r.arrayEach(i.strings,function(i){n.appendChild(t.createColElement(i.col))})}),n}},{key:"createRow",value:function(n){var t=this,i=document,u=i.createDocumentFragment(),f=i.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(n,f),u.appendChild(f)),this.samples.forEach(function(f){r.arrayEach(f.strings,function(r){var f=r.col,e=t.hot.getCellMeta(n,f),s,o;e.col=f;e.row=n;s=t.hot.getCellRenderer(e);o=i.createElement("td");s(t.hot,o,n,f,t.hot.colToProp(f),r.value,e);u.appendChild(o)})}),u}},{key:"createColumnHeadersRow",value:function(){var u=this,n=document,t=n.createDocumentFragment(),i;return this.hot.hasRowHeaders()&&(i=n.createElement("th"),this.hot.view.appendColHeader(-1,i),t.appendChild(i)),this.samples.forEach(function(i){r.arrayEach(i.strings,function(i){var f=i.col,r=n.createElement("th");u.hot.view.appendColHeader(f,r);t.appendChild(r)})}),t}},{key:"createCol",value:function(n){var t=this,i=document,u=i.createDocumentFragment();return this.samples.forEach(function(f){r.arrayEach(f.strings,function(r){var e=r.row,f=t.hot.getCellMeta(e,n);f.col=n;f.row=e;var h=t.hot.getCellRenderer(f),o=i.createElement("td"),s=i.createElement("tr");h(t.hot,o,e,n,t.hot.colToProp(n),r.value,f);s.appendChild(o);u.appendChild(s)})}),u}},{key:"clean",value:function(){this.rows.length=0;this.rows[-1]=void 0;this.columns.length=0;this.samples&&this.samples.clear();this.samples=null;this.removeTable()}},{key:"injectTable",value:function(){var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;this.injected||((n||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}},{key:"removeTable",value:function(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}},{key:"createColElement",value:function(n){var i=document,t=i.createElement("col");return t.style.width=this.hot.view.wt.wtTable.getStretchedColumnWidth(n)+"px",t}},{key:"createTable",value:function(){var h=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"",t=document,e=t.createDocumentFragment(),n=t.createElement("table"),r=t.createElement("thead"),f=t.createElement("tbody"),o=t.createElement("colgroup"),i=t.createElement("tr"),s=t.createElement("th");return this.isVertical()&&n.appendChild(o),this.isHorizontal()&&(i.appendChild(s),r.appendChild(i),n.style.tableLayout="auto",n.style.width="auto"),n.appendChild(r),this.isVertical()&&f.appendChild(i),n.appendChild(f),u.addClass(n,h),e.appendChild(n),{fragment:e,table:n,tHead:r,tBody:f,colGroup:o,tr:i,th:s}}},{key:"createContainer",value:function(){var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"",i=document,r=i.createDocumentFragment(),t=i.createElement("div");return n="htGhostTable htAutoSize "+n.trim(),u.addClass(t,n),r.appendChild(t),{fragment:r,container:t}}},{key:"isVertical",value:function(){return!!(this.rows.length&&!this.columns.length)}},{key:"isHorizontal",value:function(){return!!(this.columns.length&&!this.rows.length)}}]),n}();t.default=f},function(n,t){"use strict";function r(){return{name:i}}t.__esModule=!0;t.default=r;var i=t.KEY="---------"},function(n,t,i){"use strict";function o(n){return n&&n.__esModule?n:{"default":n}}function it(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var h;t.__esModule=!0;var a=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),v=i(152),y=o(v),r=i(2),s=i(0),p=i(582),w=o(p),b=i(9),k=o(b),c=i(1),d=i(13),l=i(35),u=i(24),f=i(18),g=i(21),nt=o(g),e=i(44),tt=i(11);h=function(){function n(t,i){it(this,n);this.hot=t;this.options=i||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1};this.eventManager=new k.default(this);this.container=this.createContainer(this.options.name);this.hotMenu=null;this.hotSubMenus={};this.parentMenu=this.options.parent||null;this.menuItems=null;this.origOutsideClickDeselects=null;this.keyEvent=!1;this.offset={above:0,below:0,left:0,right:0};this._afterScrollCallback=null;this.registerEvents()}return a(n,[{key:"registerEvents",value:function(){var n=this;this.eventManager.addEventListener(document.documentElement,"mousedown",function(t){return n.onDocumentMouseDown(t)})}},{key:"setMenuItems",value:function(n){this.menuItems=n}},{key:"setOffset",value:function(n){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;this.offset[n]=t}},{key:"isSubMenu",value:function(){return this.parentMenu!==null}},{key:"open",value:function(){var n=this,i,t,r;this.container.removeAttribute("style");this.container.style.display="block";i=l.debounce(function(t){return n.openSubMenu(t)},300);t=s.arrayFilter(this.menuItems,function(t){return u.isItemHidden(t,n.hot)});t=u.filterSeparators(t,e.SEPARATOR);r={data:t,colHeaders:!1,colWidths:[215],autoRowSize:!1,readOnly:!0,copyPaste:!1,columns:[{data:"name",renderer:function(t,i,r,u,f,e){return n.menuItemRenderer(t,i,r,u,f,e)}}],renderAllRows:!0,fragmentSelection:"cell",disableVisualSelection:"area",beforeKeyDown:function(t){return n.onBeforeKeyDown(t)},afterOnCellMouseOver:function(t,r){n.isAllSubMenusClosed()?i(r.row):n.openSubMenu(r.row)},rowHeights:function(n){return t[n].name===e.SEPARATOR?1:23}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects;this.hot.getSettings().outsideClickDeselects=!1;this.hotMenu=new y.default(this.container,r);this.hotMenu.addHook("afterInit",function(){return n.onAfterInit()});this.hotMenu.addHook("afterSelection",function(){return n.onAfterSelection.apply(n,arguments)});this.hotMenu.init();this.hotMenu.listen();this.blockMainTableCallbacks();this.runLocalHooks("afterOpen")}},{key:"close",value:function(){var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:!1;this.isOpened()&&(n&&this.parentMenu?this.parentMenu.close():(this.closeAllSubMenus(),this.container.style.display="none",this.releaseMainTableCallbacks(),this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.parentMenu&&this.parentMenu.hotMenu.listen()))}},{key:"openSubMenu",value:function(t){var r,f,i;return this.hotMenu?(r=this.hotMenu.getCell(t,0),this.closeAllSubMenus(),!r||!u.hasSubMenu(r))?!1:(f=this.hotMenu.getSourceDataAtRow(t),i=new n(this.hot,{parent:this,name:f.name,className:this.options.className,keepInViewport:!0}),i.setMenuItems(f.submenu.items),i.open(),i.setPosition(r.getBoundingClientRect()),this.hotSubMenus[f.key]=i,i):!1}},{key:"closeSubMenu",value:function(n){var t=this.hotMenu.getSourceDataAtRow(n),i=this.hotSubMenus[t.key];i&&(i.destroy(),delete this.hotSubMenus[t.key])}},{key:"closeAllSubMenus",value:function(){var n=this;s.arrayEach(this.hotMenu.getData(),function(t,i){return n.closeSubMenu(i)})}},{key:"isAllSubMenusClosed",value:function(){return Object.keys(this.hotSubMenus).length===0}},{key:"destroy",value:function(){this.clearLocalHooks();this.close();this.parentMenu=null;this.eventManager.destroy()}},{key:"isOpened",value:function(){return this.hotMenu!==null}},{key:"executeCommand",value:function(n){var t;if(this.isOpened()&&this.hotMenu.getSelectedLast()&&(t=this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]),this.runLocalHooks("select",t,n),t.isCommand!==!1&&t.name!==e.SEPARATOR)){var i=this.hot.getSelectedRange(),r=i?u.normalizeSelection(i):[],f=!0;(t.disabled===!0||typeof t.disabled=="function"&&t.disabled.call(this.hot)===!0||t.submenu)&&(f=!1);this.runLocalHooks("executeCommand",t.key,r,n);this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",t.key,r,n);f&&this.close(!0)}}},{key:"setPosition",value:function(n){var t=new w.default(n);this.options.keepInViewport?(t.fitsBelow(this.container)?this.setPositionBelowCursor(t):t.fitsAbove(this.container)?this.setPositionAboveCursor(t):this.setPositionBelowCursor(t),t.fitsOnRight(this.container)?this.setPositionOnRightOfCursor(t):this.setPositionOnLeftOfCursor(t)):(this.setPositionBelowCursor(t),this.setPositionOnRightOfCursor(t))}},{key:"setPositionAboveCursor",value:function(n){var t=this.offset.above+n.top-this.container.offsetHeight;this.isSubMenu()&&(t=n.top+n.cellHeight-this.container.offsetHeight+3);this.container.style.top=t+"px"}},{key:"setPositionBelowCursor",value:function(n){var t=this.offset.below+n.top;this.isSubMenu()&&(t=n.top-1);this.container.style.top=t+"px"}},{key:"setPositionOnRightOfCursor",value:function(n){var t=void 0;t=this.isSubMenu()?1+n.left+n.cellWidth:this.offset.right+1+n.left;this.container.style.left=t+"px"}},{key:"setPositionOnLeftOfCursor",value:function(n){var t=this.offset.left+n.left-this.container.offsetWidth+r.getScrollbarWidth()+4;this.container.style.left=t+"px"}},{key:"selectFirstCell",value:function(){var n=this.hotMenu.getCell(0,0);u.isSeparator(n)||u.isDisabled(n)||u.isSelectionDisabled(n)?this.selectNextCell(0,0):this.hotMenu.selectCell(0,0)}},{key:"selectLastCell",value:function(){var n=this.hotMenu.countRows()-1,t=this.hotMenu.getCell(n,0);u.isSeparator(t)||u.isDisabled(t)||u.isSelectionDisabled(t)?this.selectPrevCell(n,0):this.hotMenu.selectCell(n,0)}},{key:"selectNextCell",value:function(n,t){var i=n+1,r=i<this.hotMenu.countRows()?this.hotMenu.getCell(i,t):null;r&&(u.isSeparator(r)||u.isDisabled(r)||u.isSelectionDisabled(r)?this.selectNextCell(i,t):this.hotMenu.selectCell(i,t))}},{key:"selectPrevCell",value:function(n,t){var i=n-1,r=i>=0?this.hotMenu.getCell(i,t):null;r&&(u.isSeparator(r)||u.isDisabled(r)||u.isSelectionDisabled(r)?this.selectPrevCell(i,t):this.hotMenu.selectCell(i,t))}},{key:"menuItemRenderer",value:function(n,t,i,u,f,o){var a=this,s=n.getSourceDataAtRow(i),h=document.createElement("div"),v=function(n){return c.hasOwnProperty(n,"submenu")},y=function(n){return new RegExp(e.SEPARATOR,"i").test(n.name)},p=function(n){return n.disabled===!0||typeof n.disabled=="function"&&n.disabled.call(a.hot)===!0},l=function(n){return n.disableSelection};typeof o=="function"&&(o=o.call(this.hot));r.empty(t);r.addClass(h,"htItemWrapper");t.appendChild(h);y(s)?r.addClass(t,"htSeparator"):typeof s.renderer=="function"?(r.addClass(t,"htCustomMenuRenderer"),t.appendChild(s.renderer(n,h,i,u,f,o))):r.fastInnerHTML(h,o);p(s)?(r.addClass(t,"htDisabled"),this.eventManager.addEventListener(t,"mouseenter",function(){return n.deselectCell()})):l(s)?(r.addClass(t,"htSelectionDisabled"),this.eventManager.addEventListener(t,"mouseenter",function(){return n.deselectCell()})):v(s)?(r.addClass(t,"htSubmenu"),l(s)?this.eventManager.addEventListener(t,"mouseenter",function(){return n.deselectCell()}):this.eventManager.addEventListener(t,"mouseenter",function(){return n.selectCell(i,u,void 0,void 0,!1,!1)})):(r.removeClass(t,"htSubmenu"),r.removeClass(t,"htDisabled"),l(s)?this.eventManager.addEventListener(t,"mouseenter",function(){return n.deselectCell()}):this.eventManager.addEventListener(t,"mouseenter",function(){return n.selectCell(i,u,void 0,void 0,!1,!1)}))}},{key:"createContainer",value:function(){var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null,t=void 0;return n?(l.isFunction(n)&&(n=n.call(this.hot),n=n===null||d.isUndefined(n)?"":n.toString()),n=n.replace(/[^A-z0-9]/g,"_"),n=this.options.className+"Sub_"+n,t=document.querySelector("."+this.options.className+"."+n)):t=document.querySelector("."+this.options.className),t||(t=document.createElement("div"),r.addClass(t,"htMenu "+this.options.className),n&&r.addClass(t,n),document.getElementsByTagName("body")[0].appendChild(t)),t}},{key:"blockMainTableCallbacks",value:function(){this._afterScrollCallback=function(){};this.hot.addHook("afterScrollVertically",this._afterScrollCallback);this.hot.addHook("afterScrollHorizontally",this._afterScrollCallback)}},{key:"releaseMainTableCallbacks",value:function(){this._afterScrollCallback&&(this.hot.removeHook("afterScrollVertically",this._afterScrollCallback),this.hot.removeHook("afterScrollHorizontally",this._afterScrollCallback),this._afterScrollCallback=null)}},{key:"onBeforeKeyDown",value:function(n){var t=this.hotMenu.getSelectedLast(),i=!1,r;this.keyEvent=!0;switch(n.keyCode){case f.KEY_CODES.ESCAPE:this.close();i=!0;break;case f.KEY_CODES.ENTER:t&&(this.hotMenu.getSourceDataAtRow(t[0]).submenu?i=!0:(this.executeCommand(n),this.close(!0)));break;case f.KEY_CODES.ARROW_DOWN:t?this.selectNextCell(t[0],t[1]):this.selectFirstCell();i=!0;break;case f.KEY_CODES.ARROW_UP:t?this.selectPrevCell(t[0],t[1]):this.selectLastCell();i=!0;break;case f.KEY_CODES.ARROW_RIGHT:t&&(r=this.openSubMenu(t[0]),r&&r.selectFirstCell());i=!0;break;case f.KEY_CODES.ARROW_LEFT:t&&this.isSubMenu()&&(this.close(),this.parentMenu&&this.parentMenu.hotMenu.listen(),i=!0)}i&&(n.preventDefault(),tt.stopImmediatePropagation(n));this.keyEvent=!1}},{key:"onAfterInit",value:function(){var i=this.hotMenu.getSettings().data,t=this.hotMenu.view.wt.wtTable.hider.style,n=this.hotMenu.view.wt.wtTable.holder.style,r=parseInt(t.width,10),u=s.arrayReduce(i,function(n,t){return n+(t.name===e.SEPARATOR?1:26)},0);n.width=r+22+"px";n.height=u+4+"px";t.height=n.height}},{key:"onAfterSelection",value:function(n,t,i,r,u){this.keyEvent===!1&&(u.value=!0)}},{key:"onDocumentMouseDown",value:function(n){this.isOpened()&&(this.container&&r.isChildOf(n.target,this.container)&&this.executeCommand(n),this.options.standalone&&this.hotMenu&&!r.isChildOf(n.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!r.isChildOf(n.target,".htMenu")&&r.isChildOf(n.target,document)&&this.close(!0))}}]),n}();c.mixin(h,nt.default);t.default=h},function(n,t,i){"use strict";function f(n,t){return Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(t)}}))}function a(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var e;t.__esModule=!0;var o=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),s=f(["The merged cell declared with {row: ",", col: ",", rowspan: \n    ",", colspan: ","} contains negative values, which is not supported. It \n    will not be added to the collection."],["The merged cell declared with {row: ",", col: ",", rowspan: \n    ",", colspan: ","} contains negative values, which is not supported. It \n    will not be added to the collection."]),h=f(["The merged cell declared at [",", ","] is positioned (or positioned partially) \n       outside of the table range. It was not added to the table, please fix your setup."],["The merged cell declared at [",", ","] is positioned (or positioned partially) \n       outside of the table range. It was not added to the table, please fix your setup."]),c=f(["The merged cell declared at [",", ",'] has both "rowspan" \n     and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.'],["The merged cell declared at [",", ",'] has both "rowspan" \n     and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.']),l=f(["The merged cell declared at [",", ",'] has "rowspan" or "colspan" declared as \n      "0", which is not supported. It cannot be added to the collection.'],["The merged cell declared at [",", ",'] has "rowspan" or "colspan" declared as \n      "0", which is not supported. It cannot be added to the collection.']),r=i(8),u=i(34);e=function(){function n(t,i,r,u){a(this,n);this.row=t;this.col=i;this.rowspan=r;this.colspan=u;this.removed=!1}return o(n,[{key:"normalize",value:function(n){var t=n.countRows(),i=n.countCols();this.row<0?this.row=0:this.row>t-1&&(this.row=t-1);this.col<0?this.col=0:this.col>i-1&&(this.col=i-1);this.row+this.rowspan>t-1&&(this.rowspan=t-this.row);this.col+this.colspan>i-1&&(this.colspan=i-this.col)}},{key:"includes",value:function(n,t){return this.row<=n&&this.col<=t&&this.row+this.rowspan-1>=n&&this.col+this.colspan-1>=t}},{key:"includesHorizontally",value:function(n){return this.col<=n&&this.col+this.colspan-1>=n}},{key:"includesVertically",value:function(n){return this.row<=n&&this.row+this.rowspan-1>=n}},{key:"shift",value:function(n,t){var r=n[0]||n[1],c=t+Math.abs(n[0]||n[1])-1,e=n[0]?"colspan":"rowspan",s=n[0]?"col":"row",u=Math.min(t,c),o=Math.max(t,c),i=this[s],f=this[s]+this[e]-1,h,l,a;if(i>=t&&(this[s]+=r),r>0)t<=f&&t>i&&(this[e]+=r);else if(r<0){if(u<=i&&o>=f)return this.removed=!0,!1;i>=u&&i<=o?(h=o-i+1,l=Math.abs(r)-h,this[s]-=l,this[e]-=h):i<=u&&f>=o?this[e]+=r:i<=u&&f>=u&&f<o&&(a=f-u+1,this[e]-=a)}return!0}},{key:"isFarther",value:function(n,t){return n?t==="down"?n.row+n.rowspan-1<this.row+this.rowspan-1:t==="up"?n.row>this.row:t==="right"?n.col+n.colspan-1<this.col+this.colspan-1:t==="left"?n.col>this.col:null:!0}},{key:"getLastRow",value:function(){return this.row+this.rowspan-1}},{key:"getLastColumn",value:function(){return this.col+this.colspan-1}},{key:"getRange",value:function(){return new r.CellRange(new r.CellCoords(this.row,this.col),new r.CellCoords(this.row,this.col),new r.CellCoords(this.getLastRow(),this.getLastColumn()))}}],[{key:"NEGATIVE_VALUES_WARNING",value:function(n){return u.toSingleLine(s,n.row,n.col,n.rowspan,n.colspan)}},{key:"IS_OUT_OF_BOUNDS_WARNING",value:function(n){return u.toSingleLine(h,n.row,n.col)}},{key:"IS_SINGLE_CELL",value:function(n){return u.toSingleLine(c,n.row,n.col)}},{key:"ZERO_SPAN_WARNING",value:function(n){return u.toSingleLine(l,n.row,n.col)}},{key:"containsNegativeValues",value:function(n){return n.row<0||n.col<0||n.rowspan<0||n.colspan<0}},{key:"isSingleCell",value:function(n){return n.colspan===1&&n.rowspan===1}},{key:"containsZeroSpan",value:function(n){return n.colspan===0||n.rowspan===0}},{key:"isOutOfBounds",value:function(n,t,i){return n.row<0||n.col<0||n.row>=t||n.row+n.rowspan-1>=t||n.col>=i||n.col+n.colspan-1>=i}}]),n}();t.default=e},function(n,t,i){"use strict";function l(n,t,i){return t in n?Object.defineProperty(n,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[t]=i,n}function kt(n){var t=[];return et[n]||(n=ft),st.arrayEach(et[n],function(n){var i=void 0;i=n===r.SEPARATOR?{name:r.SEPARATOR}:ot.clone(ht.getConditionDescriptor(n));t.push(i)}),t}var u;t.__esModule=!0;t.TYPES=t.TYPE_DATE=t.TYPE_TEXT=t.TYPE_NUMERIC=t.OPERATION_OR_THEN_VARIABLE=t.OPERATION_OR=t.OPERATION_AND=t.CONDITION_FALSE=t.CONDITION_TRUE=t.CONDITION_BY_VALUE=t.CONDITION_YESTERDAY=t.CONDITION_TODAY=t.CONDITION_TOMORROW=t.CONDITION_DATE_AFTER=t.CONDITION_DATE_BEFORE=t.CONDITION_NOT_CONTAINS=t.CONDITION_CONTAINS=t.CONDITION_ENDS_WITH=t.CONDITION_BEGINS_WITH=t.CONDITION_NOT_BETWEEN=t.CONDITION_BETWEEN=t.CONDITION_LESS_THAN_OR_EQUAL=t.CONDITION_LESS_THAN=t.CONDITION_GREATER_THAN_OR_EQUAL=t.CONDITION_GREATER_THAN=t.CONDITION_NOT_EQUAL=t.CONDITION_EQUAL=t.CONDITION_NOT_EMPTY=t.CONDITION_EMPTY=t.CONDITION_NONE=undefined;t.default=kt;var ot=i(1),st=i(0),r=i(44),ht=i(10),f=i(641),e=i(462),o=i(642),s=i(463),h=i(643),a=i(644),v=i(645),y=i(646),p=i(647),c=i(464),w=i(648),b=i(649),k=i(650),d=i(467),g=i(651),nt=i(466),tt=i(465),it=i(652),rt=i(653),ut=i(654),ct=i(655),lt=i(656),at=i(657),vt=i(160),yt=i(468),pt=i(469);t.CONDITION_NONE=f.CONDITION_NAME;t.CONDITION_EMPTY=e.CONDITION_NAME;t.CONDITION_NOT_EMPTY=o.CONDITION_NAME;t.CONDITION_EQUAL=s.CONDITION_NAME;t.CONDITION_NOT_EQUAL=h.CONDITION_NAME;t.CONDITION_GREATER_THAN=a.CONDITION_NAME;t.CONDITION_GREATER_THAN_OR_EQUAL=v.CONDITION_NAME;t.CONDITION_LESS_THAN=y.CONDITION_NAME;t.CONDITION_LESS_THAN_OR_EQUAL=p.CONDITION_NAME;t.CONDITION_BETWEEN=c.CONDITION_NAME;t.CONDITION_NOT_BETWEEN=w.CONDITION_NAME;t.CONDITION_BEGINS_WITH=b.CONDITION_NAME;t.CONDITION_ENDS_WITH=k.CONDITION_NAME;t.CONDITION_CONTAINS=d.CONDITION_NAME;t.CONDITION_NOT_CONTAINS=g.CONDITION_NAME;t.CONDITION_DATE_BEFORE=nt.CONDITION_NAME;t.CONDITION_DATE_AFTER=tt.CONDITION_NAME;t.CONDITION_TOMORROW=it.CONDITION_NAME;t.CONDITION_TODAY=rt.CONDITION_NAME;t.CONDITION_YESTERDAY=ut.CONDITION_NAME;t.CONDITION_BY_VALUE=ct.CONDITION_NAME;t.CONDITION_TRUE=lt.CONDITION_NAME;t.CONDITION_FALSE=at.CONDITION_NAME;t.OPERATION_AND=vt.OPERATION_ID;t.OPERATION_OR=yt.OPERATION_ID;t.OPERATION_OR_THEN_VARIABLE=pt.OPERATION_ID;var wt=t.TYPE_NUMERIC="numeric",ft=t.TYPE_TEXT="text",bt=t.TYPE_DATE="date",et=t.TYPES=(u={},l(u,wt,[f.CONDITION_NAME,r.SEPARATOR,e.CONDITION_NAME,o.CONDITION_NAME,r.SEPARATOR,s.CONDITION_NAME,h.CONDITION_NAME,r.SEPARATOR,a.CONDITION_NAME,v.CONDITION_NAME,y.CONDITION_NAME,p.CONDITION_NAME,c.CONDITION_NAME,w.CONDITION_NAME]),l(u,ft,[f.CONDITION_NAME,r.SEPARATOR,e.CONDITION_NAME,o.CONDITION_NAME,r.SEPARATOR,s.CONDITION_NAME,h.CONDITION_NAME,r.SEPARATOR,b.CONDITION_NAME,k.CONDITION_NAME,r.SEPARATOR,d.CONDITION_NAME,g.CONDITION_NAME]),l(u,bt,[f.CONDITION_NAME,r.SEPARATOR,e.CONDITION_NAME,o.CONDITION_NAME,r.SEPARATOR,s.CONDITION_NAME,h.CONDITION_NAME,r.SEPARATOR,nt.CONDITION_NAME,tt.CONDITION_NAME,c.CONDITION_NAME,r.SEPARATOR,it.CONDITION_NAME,rt.CONDITION_NAME,ut.CONDITION_NAME]),u)},function(n,t,i){"use strict";function h(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function f(n,t){return n.every(function(n){return n.func(t)})}var r,u;t.__esModule=!0;t.SHORT_NAME_FOR_COMPONENT=t.OPERATION_ID=undefined;t.operationResult=f;var e=i(3),o=h(e),s=i(64);r=t.OPERATION_ID="conjunction";u=t.SHORT_NAME_FOR_COMPONENT=o.FILTERS_LABELS_CONJUNCTION;s.registerOperation(r,u,f)},function(n,t,i){"use strict";function y(n){return n&&n.__esModule?n:{"default":n}}function p(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function w(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function b(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function k(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var r,o;t.__esModule=!0;var s=function h(n,t,i){var r,u,f;return n===null&&(n=Function.prototype),r=Object.getOwnPropertyDescriptor(n,t),r===undefined?(u=Object.getPrototypeOf(n),u===null?undefined:h(u,t,i)):"value"in r?r.value:(f=r.get,f===undefined)?undefined:f.call(i)},u=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),f=i(2),e=i(1),c=i(3),l=p(c),a=i(65),v=y(a);r=new WeakMap;o=function(n){function t(n,i){w(this,t);var u=b(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n,e.extend(t.DEFAULTS,i)));return r.set(u,{}),u.registerHooks(),u}return k(t,n),u(t,null,[{key:"DEFAULTS",get:function(){return e.clone({placeholder:"",type:"text",tagName:"input"})}}]),u(t,[{key:"registerHooks",value:function(){var n=this;this.addLocalHook("click",function(t){return n.onClick(t)});this.addLocalHook("keyup",function(t){return n.onKeyup(t)})}},{key:"build",value:function(){s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"build",this).call(this);var i=r.get(this),n=document.createElement("div");i.input=this._element.firstChild;f.addClass(this._element,"htUIInput");f.addClass(n,"htUIInputIcon");this._element.appendChild(n);this.update()}},{key:"update",value:function(){if(this.isBuilt()){var n=r.get(this).input;n.type=this.options.type;n.placeholder=this.hot.getTranslatedPhrase(this.options.placeholder);n.value=typeof this.options.value=="string"&&this.options.value.startsWith(l.FILTERS_NAMESPACE)?this.hot.getTranslatedPhrase(this.options.value):this.options.value}}},{key:"focus",value:function(){this.isBuilt()&&r.get(this).input.focus()}},{key:"onClick",value:function(){}},{key:"onKeyup",value:function(n){this.options.value=n.target.value}}]),t}(v.default);t.default=o},function(n,t){"use strict";function r(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}t.__esModule=!0;var i=function i(n,t){r(this,i);this.hot=t;this.plugin=n};t.default=i},function(n,t,i){"use strict";var h=i(22).f,c=i(87),l=i(70),a=i(40),v=i(72),y=i(73),p=i(172),f=i(174),w=i(175),o=i(25),s=i(42).fastKey,r=i(51),u=o?"_s":"size",e=function(n,t){var r=s(t),i;if(r!=="F")return n._i[r];for(i=n._f;i;i=i.n)if(i.k==t)return i};n.exports={getConstructor:function(n,t,i,f){var s=n(function(n,r){v(n,s,t,"_i");n._t=t;n._i=c(null);n._f=undefined;n._l=undefined;n[u]=0;r!=undefined&&y(r,i,n[f],n)});return l(s.prototype,{clear:function(){for(var i=r(this,t),f=i._i,n=i._f;n;n=n.n)n.r=!0,n.p&&(n.p=n.p.n=undefined),delete f[n.i];i._f=i._l=undefined;i[u]=0},"delete":function(n){var f=r(this,t),i=e(f,n),o,s;return i&&(o=i.n,s=i.p,delete f._i[i.i],i.r=!0,s&&(s.n=o),o&&(o.p=s),f._f==i&&(f._f=o),f._l==i&&(f._l=s),f[u]--),!!i},forEach:function(n){r(this,t);for(var u=a(n,arguments.length>1?arguments[1]:undefined,3),i;i=i?i.n:this._f;)for(u(i.v,i.k,this);i&&i.r;)i=i.p},has:function(n){return!!e(r(this,t),n)}}),o&&h(s.prototype,"size",{get:function(){return r(this,t)[u]}}),s},def:function(n,t,i){var r=e(n,t),f,o;return r?r.v=i:(n._l=r={i:o=s(t,!0),k:t,v:i,p:f=n._l,n:undefined,r:!1},n._f||(n._f=r),f&&(f.n=r),n[u]++,o!=="F"&&(n._i[o]=r)),n},getEntry:e,setStrong:function(n,t,i){p(n,t,function(n,i){this._t=r(n,t);this._k=i;this._l=undefined},function(){for(var t=this,i=t._k,n=t._l;n&&n.r;)n=n.p;return!t._t||!(t._l=n=n?n.n:t._t._f)?(t._t=undefined,f(1)):i=="keys"?f(0,n.k):i=="values"?f(0,n.v):f(0,[n.k,n.v])},i?"entries":"values",!i,!0);w(t)}}},function(n,t,i){n.exports=!i(25)&&!i(26)(function(){return Object.defineProperty(i(85)("div"),"a",{get:function(){return 7}}).a!=7})},function(n,t,i){var r=i(32),u=i(27),f=i(166)(!1),e=i(89)("IE_PROTO");n.exports=function(n,t){var s=u(n),h=0,o=[];for(var i in s)i!=e&&r(s,i)&&o.push(i);while(t.length>h)r(s,i=t[h++])&&(~f(o,i)||o.push(i));return o}},function(n,t,i){var r=i(27),u=i(28),f=i(69);n.exports=function(n){return function(t,i,e){var s=r(t),h=u(s.length),o=f(e,h),c;if(n&&i!=i){while(h>o)if(c=s[o++],c!=c)return!0}else for(;h>o;o++)if((n||o in s)&&s[o]===i)return n||o||0;return!n&&-1}}},function(n,t,i){var r=i(17).document;n.exports=r&&r.documentElement},function(n,t,i){var r=i(20);n.exports=function(n,t,i,u){try{return u?t(r(i)[0],i[1]):t(i)}catch(e){var f=n["return"];f!==undefined&&r(f.call(n));throw e;}}},function(n,t,i){var r=i(57),u=i(16)("iterator"),f=Array.prototype;n.exports=function(n){return n!==undefined&&(r.Array===n||f[u]===n)}},function(n,t,i){var r=i(171),u=i(16)("iterator"),f=i(57);n.exports=i(50).getIteratorMethod=function(n){if(n!=undefined)return n[u]||n["@@iterator"]||f[r(n)]}},function(n,t,i){var r=i(49),u=i(16)("toStringTag"),f=r(function(){return arguments}())=="Arguments",e=function(n,t){try{return n[t]}catch(i){}};n.exports=function(n){var t,i,o;return n===undefined?"Undefined":n===null?"Null":typeof(i=e(t=Object(n),u))=="string"?i:f?r(t):(o=r(t))=="Object"&&typeof t.callee=="function"?"Arguments":o}},function(n,t,i){"use strict";var o=i(74),e=i(5),a=i(38),s=i(39),v=i(32),h=i(57),y=i(478),p=i(58),w=i(173),r=i(16)("iterator"),u=!([].keys&&"next"in[].keys()),b="@@iterator",c="keys",f="values",l=function(){return this};n.exports=function(n,t,i,k,d,g,nt){y(i,t,k);var et=function(n){if(!u&&n in tt)return tt[n];switch(n){case c:return function(){return new i(this,n)};case f:return function(){return new i(this,n)}}return function(){return new i(this,n)}},ct=t+" Iterator",st=d==f,ht=!1,tt=n.prototype,it=tt[r]||tt[b]||d&&tt[d],rt=!u&&it||et(d),at=d?st?et("entries"):rt:undefined,lt=t=="Array"?tt.entries||it:it,ft,ot,ut;if(lt&&(ut=w(lt.call(new n)),ut!==Object.prototype&&ut.next&&(p(ut,ct,!0),o||v(ut,r)||s(ut,r,l))),st&&it&&it.name!==f&&(ht=!0,rt=function(){return it.call(this)}),(!o||nt)&&(u||ht||!tt[r])&&s(tt,r,rt),h[t]=rt,h[ct]=l,d)if(ft={values:st?rt:et(f),keys:g?rt:et(c),entries:at},nt)for(ot in ft)ot in tt||a(tt,ot,ft[ot]);else e(e.P+e.F*(u||ht),t,ft);return ft}},function(n,t,i){var u=i(32),f=i(41),r=i(89)("IE_PROTO"),e=Object.prototype;n.exports=Object.getPrototypeOf||function(n){return(n=f(n),u(n,r))?n[r]:typeof n.constructor=="function"&&n instanceof n.constructor?n.constructor.prototype:n instanceof Object?e:null}},function(n){n.exports=function(n,t){return{value:t,done:!!n}}},function(n,t,i){"use strict";var u=i(17),f=i(22),e=i(25),r=i(16)("species");n.exports=function(n){var t=u[n];e&&t&&!t[r]&&f.f(t,r,{configurable:!0,get:function(){return this}})}},function(n,t,i){var u=i(12),f=i(20),r=function(n,t){if(f(n),!u(t)&&t!==null)throw TypeError(t+": can't set as prototype!");};n.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(n,t,u){try{u=i(40)(Function.call,i(76).f(Object.prototype,"__proto__").set,2);u(n,[]);t=!(n instanceof Array)}catch(f){t=!0}return function(n,i){return r(n,i),t?n.__proto__=i:u(n,i),n}}({},!1):undefined),check:r}},function(n,t,i){var r=i(49);n.exports=Array.isArray||function(n){return r(n)=="Array"}},function(n,t,i){"use strict";var u=i(46),f=i(78),e=i(59),o=i(41),s=i(88),r=Object.assign;n.exports=!r||i(26)(function(){var n={},t={},i=Symbol(),u="abcdefghijklmnopqrst";return n[i]=7,u.split("").forEach(function(n){t[n]=n}),r({},n)[i]!=7||Object.keys(r({},t)).join("")!=u})?function(n){for(var r=o(n),v=arguments.length,h=1,c=f.f,y=e.f;v>h;)for(var t=s(arguments[h++]),l=c?u(t).concat(c(t)):u(t),p=l.length,a=0,i;p>a;)y.call(t,i=l[a++])&&(r[i]=t[i]);return r}:r},function(n,t,i){"use strict";var l=i(70),u=i(42).getWeak,a=i(20),e=i(12),v=i(72),y=i(73),o=i(77),s=i(32),h=i(51),p=o(5),w=o(6),b=0,r=function(n){return n._l||(n._l=new c)},c=function(){this.a=[]},f=function(n,t){return p(n.a,function(n){return n[0]===t})};c.prototype={get:function(n){var t=f(this,n);if(t)return t[1]},has:function(n){return!!f(this,n)},set:function(n,t){var i=f(this,n);i?i[1]=t:this.a.push([n,t])},"delete":function(n){var t=w(this.a,function(t){return t[0]===n});return~t&&this.a.splice(t,1),!!~t}};n.exports={getConstructor:function(n,t,i,f){var o=n(function(n,r){v(n,o,t,"_i");n._t=t;n._i=b++;n._l=undefined;r!=undefined&&y(r,i,n[f],n)});return l(o.prototype,{"delete":function(n){if(!e(n))return!1;var i=u(n);return i===!0?r(h(this,t))["delete"](n):i&&s(i,this._i)&&delete i[this._i]},has:function(n){if(!e(n))return!1;var i=u(n);return i===!0?r(h(this,t)).has(n):i&&s(i,this._i)}}),o},def:function(n,t,i){var f=u(a(t),!0);return f===!0?r(n).set(t,i):f[n._i]=i,n},ufstore:r}},function(n,t,i){"use strict";function u(n){var t,i;this.promise=new n(function(n,r){if(t!==undefined||i!==undefined)throw TypeError("Bad Promise constructor");t=n;i=r});this.resolve=r(t);this.reject=r(i)}var r=i(71);n.exports.f=function(n){return new u(n)}},function(n,t,i){t.f=i(16)},function(n,t,i){var f=i(27),r=i(99).f,e={}.toString,u=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],o=function(n){try{return r(n)}catch(t){return u.slice()}};n.exports.f=function(n){return u&&e.call(n)=="[object Window]"?o(n):r(f(n))}},function(n,t,i){"use strict";var r=i(68),u=i(47);n.exports=function(n){var i=String(u(this)),f="",t=r(n);if(t<0||t==Infinity)throw RangeError("Count can't be negative");for(;t>0;(t>>>=1)&&(i+=i))t&1&&(f+=i);return f}},function(n,t,i){var r=i(12),u=i(49),f=i(16)("match");n.exports=function(n){var t;return r(n)&&((t=n[f])!==undefined?!!t:u(n)=="RegExp")}},function(n,t,i){var r=i(12),u=Math.floor;n.exports=function(n){return!r(n)&&isFinite(n)&&u(n)===n}},function(n,t,i){var r=i(46),u=i(27),f=i(59).f;n.exports=function(n){return function(t){for(var i=u(t),o=r(i),c=o.length,s=0,h=[],e;c>s;)f.call(i,e=o[s++])&&h.push(n?[e,i[e]]:i[e]);return h}}},function(n,t,i){var r=i(28),u=i(183),f=i(47);n.exports=function(n,t,i,e){var s=String(f(n)),l=s.length,c=i===undefined?" ":String(i),a=r(t),h,o;return a<=l||c==""?s:(h=a-l,o=u.call(c,Math.ceil(h/c.length)),o.length>h&&(o=o.slice(0,h)),e?o+s:s+o)}},function(n,t,i){var u=i(17),r=u.navigator;n.exports=r&&r.userAgent||""},function(n,t){"use strict";function f(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var r,i,u;t.__esModule=!0;r=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}();i=new WeakMap;u=function(){function n(t,r,u,e,o,s,h){var c=arguments.length>7&&arguments[7]!==undefined?arguments[7]:function(n){return n};f(this,n);i.set(this,{viewportWidth:t,scrollOffset:r,totalColumns:u,columnWidthFn:e,overrideFn:o,onlyFullyVisible:s,stretchingColumnWidthFn:c});this.count=0;this.startColumn=null;this.endColumn=null;this.startPosition=null;this.stretchAllRatio=0;this.stretchLastWidth=0;this.stretch=h;this.totalTargetWidth=0;this.needVerifyLastColumnWidth=!0;this.stretchAllColumnsWidth=[];this.calculate()}return r(n,null,[{key:"DEFAULT_WIDTH",get:function(){return 50}}]),r(n,[{key:"calculate",value:function(){for(var v,h,t=0,c=!0,e=[],o=void 0,r=i.get(this),s=r.onlyFullyVisible,l=r.overrideFn,u=r.scrollOffset,a=r.totalColumns,f=r.viewportWidth,n=0;n<a;n++)if(o=this._getColumnWidth(n),t<=u&&!s&&(this.startColumn=n),v=u>0?f+1:f,t>=u&&t+o<=u+v&&(this.startColumn==null&&(this.startColumn=n),this.endColumn=n),e.push(t),t+=o,s||(this.endColumn=n),t>=u+f){c=!1;break}if(this.endColumn===a-1&&c)for(this.startColumn=this.endColumn;this.startColumn>0;)if(h=e[this.endColumn]+o-e[this.startColumn-1],(h<=f||!s)&&this.startColumn--,h>f)break;this.startColumn!==null&&l&&l(this);this.startPosition=e[this.startColumn];this.startPosition==void 0&&(this.startPosition=null);this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}},{key:"refreshStretching",value:function(n){var t,c,u,f,e,o;if(this.stretch!=="none"){this.totalTargetWidth=n;var s=i.get(this),h=s.totalColumns,r=0;for(t=0;t<h;t++)c=this._getColumnWidth(t),u=s.stretchingColumnWidthFn(void 0,t),typeof u=="number"?n-=u:r+=c;f=n-r;this.stretch==="all"&&f>0?(this.stretchAllRatio=n/r,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0):this.stretch==="last"&&n!==Infinity&&(e=this._getColumnWidth(h-1),o=f+e,this.stretchLastWidth=o>=0?o:e)}}},{key:"getStretchedColumnWidth",value:function(n,t){var i=null;return this.stretch==="all"&&this.stretchAllRatio!==0?i=this._getStretchedAllColumnWidth(n,t):this.stretch==="last"&&this.stretchLastWidth!==0&&(i=this._getStretchedLastColumnWidth(n)),i}},{key:"_getStretchedAllColumnWidth",value:function(n,t){var f=0,o=i.get(this),s=o.totalColumns,e,r,u;if(this.stretchAllColumnsWidth[n]||(e=Math.round(t*this.stretchAllRatio),r=o.stretchingColumnWidthFn(e,n),this.stretchAllColumnsWidth[n]=r===void 0?e:isNaN(r)?this._getColumnWidth(n):r),this.stretchAllColumnsWidth.length===s&&this.needVerifyLastColumnWidth){for(this.needVerifyLastColumnWidth=!1,u=0;u<this.stretchAllColumnsWidth.length;u++)f+=this.stretchAllColumnsWidth[u];f!==this.totalTargetWidth&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=this.totalTargetWidth-f)}return this.stretchAllColumnsWidth[n]}},{key:"_getStretchedLastColumnWidth",value:function(n){var t=i.get(this),r=t.totalColumns;return n===r-1?this.stretchLastWidth:null}},{key:"_getColumnWidth",value:function(t){var r=i.get(this).columnWidthFn(t);return r===void 0&&(r=n.DEFAULT_WIDTH),r}}]),n}();t.default=u},function(n,t){"use strict";function f(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var i,r,u;t.__esModule=!0;i=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}();r=new WeakMap;u=function(){function n(t,i,u,e,o,s,h){f(this,n);r.set(this,{viewportHeight:t,scrollOffset:i,totalRows:u,rowHeightFn:e,overrideFn:o,onlyFullyVisible:s,horizontalScrollbarHeight:h});this.count=0;this.startRow=null;this.endRow=null;this.startPosition=null;this.calculate()}return i(n,null,[{key:"DEFAULT_HEIGHT",get:function(){return 23}}]),i(n,[{key:"calculate",value:function(){for(var l,u=0,a=!0,e=[],t=r.get(this),c=t.onlyFullyVisible,v=t.overrideFn,p=t.rowHeightFn,o=t.scrollOffset,y=t.totalRows,s=t.viewportHeight,h=t.horizontalScrollbarHeight||0,f=void 0,i=0;i<y;i++)if(f=p(i),f===undefined&&(f=n.DEFAULT_HEIGHT),u<=o&&!c&&(this.startRow=i),u>=o&&u+f<=o+s-h&&(this.startRow===null&&(this.startRow=i),this.endRow=i),e.push(u),u+=f,c||(this.endRow=i),u>=o+s-h){a=!1;break}if(this.endRow===y-1&&a)for(this.startRow=this.endRow;this.startRow>0;)if(l=e[this.endRow]+f-e[this.startRow-1],(l<=s-h||!c)&&this.startRow--,l>=s-h)break;this.startRow!==null&&v&&v(this);this.startPosition=e[this.startRow];this.startPosition==void 0&&(this.startPosition=null);this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}]),n}();t.default=u},function(n,t){"use strict";function u(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var i,r;t.__esModule=!0;i=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}();r=function(){function n(t,i,r){u(this,n);this.offset=t;this.total=i;this.countTH=r}return i(n,[{key:"offsetted",value:function(n){return n+this.offset}},{key:"unOffsetted",value:function(n){return n-this.offset}},{key:"renderedToSource",value:function(n){return this.offsetted(n)}},{key:"sourceToRendered",value:function(n){return this.unOffsetted(n)}},{key:"offsettedTH",value:function(n){return n-this.countTH}},{key:"unOffsettedTH",value:function(n){return n+this.countTH}},{key:"visibleRowHeadedColumnToSourceColumn",value:function(n){return this.renderedToSource(this.offsettedTH(n))}},{key:"sourceColumnToVisibleRowHeadedColumn",value:function(n){return this.unOffsettedTH(this.sourceToRendered(n))}}]),n}();t.default=r},function(n,t){"use strict";function u(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var i,r;t.__esModule=!0;i=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}();r=function(){function n(t,i,r){u(this,n);this.offset=t;this.total=i;this.countTH=r}return i(n,[{key:"offsetted",value:function(n){return n+this.offset}},{key:"unOffsetted",value:function(n){return n-this.offset}},{key:"renderedToSource",value:function(n){return this.offsetted(n)}},{key:"sourceToRendered",value:function(n){return this.unOffsetted(n)}},{key:"offsettedTH",value:function(n){return n-this.countTH}},{key:"unOffsettedTH",value:function(n){return n+this.countTH}},{key:"visibleColHeadedRowToSourceRow",value:function(n){return this.renderedToSource(this.offsettedTH(n))}},{key:"sourceRowToVisibleColHeadedRow",value:function(n){return this.unOffsettedTH(this.sourceToRendered(n))}}]),n}();t.default=r},function(n,t,i){"use strict";function r(n){return n&&n.__esModule?n:{"default":n}}function nt(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var h;t.__esModule=!0;var c=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),u=i(2),l=i(1),f=i(31),a=i(314),e=r(a),v=i(315),y=r(v),p=i(316),o=r(p),w=i(317),b=r(w),k=i(318),s=r(k),d=i(320),g=r(d);h=function(){function n(t){var r,i,h;if(nt(this,n),r=[],this.guid="wt_"+f.randomString(),t.cloneSource?(this.cloneSource=t.cloneSource,this.cloneOverlay=t.cloneOverlay,this.wtSettings=t.cloneSource.wtSettings,this.wtTable=new s.default(this,t.table,t.wtRootElement),this.wtScroll=new o.default(this),this.wtViewport=t.cloneSource.wtViewport,this.wtEvent=new e.default(this),this.selections=this.cloneSource.selections):(this.wtSettings=new b.default(this,t),this.wtTable=new s.default(this,t.table),this.wtScroll=new o.default(this),this.wtViewport=new g.default(this),this.wtEvent=new e.default(this),this.selections=this.getSetting("selections"),this.wtOverlays=new y.default(this),this.exportSettingsAsClassNames()),this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(i=0,h=this.wtTable.THEAD.childNodes[0].childNodes.length;i<h;i++)r.push(this.wtTable.THEAD.childNodes[0].childNodes[i].innerHTML);this.getSetting("columnHeaders").length||this.update("columnHeaders",[function(n,t){u.fastInnerText(t,r[n])}])}this.drawn=!1;this.drawInterrupted=!1}return c(n,[{key:"draw",value:function(){var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:!1;return this.drawInterrupted=!1,n||u.isVisible(this.wtTable.TABLE)?this.wtTable.draw(n):this.drawInterrupted=!0,this}},{key:"getCell",value:function(n){var f=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!1;if(!f)return this.wtTable.getCell(n);var t=this.wtSettings.getSetting("totalRows"),r=this.wtSettings.getSetting("fixedRowsTop"),u=this.wtSettings.getSetting("fixedRowsBottom"),i=this.wtSettings.getSetting("fixedColumnsLeft");if(n.row<r&&n.col<i)return this.wtOverlays.topLeftCornerOverlay.clone.wtTable.getCell(n);if(n.row<r)return this.wtOverlays.topOverlay.clone.wtTable.getCell(n);if(n.col<i&&n.row>=t-u){if(this.wtOverlays.bottomLeftCornerOverlay&&this.wtOverlays.bottomLeftCornerOverlay.clone)return this.wtOverlays.bottomLeftCornerOverlay.clone.wtTable.getCell(n)}else{if(n.col<i)return this.wtOverlays.leftOverlay.clone.wtTable.getCell(n);if(n.row<t&&n.row>t-u&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(n)}return this.wtTable.getCell(n)}},{key:"update",value:function(n,t){return this.wtSettings.update(n,t)}},{key:"scrollVertical",value:function(n){return this.wtOverlays.topOverlay.scrollTo(n),this.getSetting("onScrollVertically"),this}},{key:"scrollHorizontal",value:function(n){return this.wtOverlays.leftOverlay.scrollTo(n),this.getSetting("onScrollHorizontally"),this}},{key:"scrollViewport",value:function(n){return this.wtScroll.scrollViewport(n),this}},{key:"getViewport",value:function(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}},{key:"getOverlayName",value:function(){return this.cloneOverlay?this.cloneOverlay.type:"master"}},{key:"isOverlayName",value:function(n){return this.cloneOverlay?this.cloneOverlay.type===n:!1}},{key:"exportSettingsAsClassNames",value:function(){var i=this,n=[],t=[];l.objectEach({rowHeaders:["array"],columnHeaders:["array"]},function(r,u){r.indexOf("array")>-1&&i.getSetting(u).length&&t.push("ht"+f.toUpperCaseFirst(u));n.push("ht"+f.toUpperCaseFirst(u))});u.removeClass(this.wtTable.wtRootElement.parentNode,n);u.addClass(this.wtTable.wtRootElement.parentNode,t)}},{key:"getSetting",value:function(n,t,i,r,u){return this.wtSettings.getSetting(n,t,i,r,u)}},{key:"hasSetting",value:function(n){return this.wtSettings.has(n)}},{key:"destroy",value:function(){this.wtOverlays.destroy();this.wtEvent.destroy()}}]),n}();t.default=h},function(n){n.exports=function(n){return n.webpackPolyfill||(n.deprecate=function(){},n.paths=[],n.children||(n.children=[]),Object.defineProperty(n,"loaded",{enumerable:!0,get:function(){return n.l}}),Object.defineProperty(n,"id",{enumerable:!0,get:function(){return n.i}}),n.webpackPolyfill=1),n}},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(n,t,i){"use strict";function h(n){return n&&n.__esModule?n:{"default":n}}function u(n){var t=this,i=new s.default(n),u,o;this.instance=n;u=[null,null];this.dblClickTimeout=[null,null];var h=function(n){var o=document.activeElement,s=f.partial(r.getParent,n.realTarget),e=n.realTarget,i;e!==o&&s(0)!==o&&s(1)!==o&&(i=t.parentCell(e),r.hasClass(e,"corner")?t.instance.getSetting("onCellCornerMouseDown",n,e):i.TD&&t.instance.hasSetting("onCellMouseDown")&&t.instance.getSetting("onCellMouseDown",n,i.coords,i.TD,t.instance),n.button!==2&&i.TD&&(u[0]=i.TD,clearTimeout(t.dblClickTimeout[0]),t.dblClickTimeout[0]=setTimeout(function(){u[0]=null},1e3)))},c=function(){t.instance.touchMoving=!0},a,v=function(n){var r=this;i.addEventListener(this,"touchmove",c);t.checkIfTouchMove=setTimeout(function(){t.instance.touchMoving===!0&&(t.instance.touchMoving=void 0,i.removeEventListener("touchmove",c,!1));h(n)},30)},y=function(n){var u,i,f;t.instance.hasSetting("onCellMouseOver")&&(u=t.instance.wtTable.TABLE,i=r.closestDown(n.realTarget,["TD","TH"],u),f=t.instance.cloneSource||t.instance,i&&i!==f.lastMouseOver&&r.isChildOf(i,u)&&(f.lastMouseOver=i,t.instance.getSetting("onCellMouseOver",n,t.instance.wtTable.getCoords(i),i,t.instance)))},p=function(n){var u=void 0,i=void 0,f=void 0;t.instance.hasSetting("onCellMouseOut")&&(u=t.instance.wtTable.TABLE,i=r.closestDown(n.realTarget,["TD","TH"],u),f=r.closestDown(n.relatedTarget,["TD","TH"],u),i&&i!==f&&r.isChildOf(i,u)&&t.instance.getSetting("onCellMouseOut",n,t.instance.wtTable.getCoords(i),i,t.instance))},l=function(n){if(n.button!==2){var i=t.parentCell(n.realTarget);i.TD===u[0]&&i.TD===u[1]?(r.hasClass(n.realTarget,"corner")?t.instance.getSetting("onCellCornerDblClick",n,i.coords,i.TD,t.instance):t.instance.getSetting("onCellDblClick",n,i.coords,i.TD,t.instance),u[0]=null,u[1]=null):i.TD===u[0]?(t.instance.getSetting("onCellMouseUp",n,i.coords,i.TD,t.instance),u[1]=i.TD,clearTimeout(t.dblClickTimeout[1]),t.dblClickTimeout[1]=setTimeout(function(){u[1]=null},500)):i.TD&&t.instance.hasSetting("onCellMouseUp")&&t.instance.getSetting("onCellMouseUp",n,i.coords,i.TD,t.instance)}},w=function(n){clearTimeout(a);n.preventDefault();l(n)};i.addEventListener(this.instance.wtTable.holder,"mousedown",h);i.addEventListener(this.instance.wtTable.TABLE,"mouseover",y);i.addEventListener(this.instance.wtTable.TABLE,"mouseout",p);i.addEventListener(this.instance.wtTable.holder,"mouseup",l);this.instance.wtTable.holder.parentNode.parentNode&&e.isMobileBrowser()&&!t.instance.wtTable.isWorkingOnClone()&&(o="."+this.instance.wtTable.holder.parentNode.className.split(" ").join("."),i.addEventListener(this.instance.wtTable.holder,"touchstart",function(n){t.instance.touchApplied=!0;r.isChildOf(n.target,o)&&v.call(n.target,n)}),i.addEventListener(this.instance.wtTable.holder,"touchend",function(n){t.instance.touchApplied=!1;r.isChildOf(n.target,o)&&w.call(n.target,n)}),t.instance.momentumScrolling||(t.instance.momentumScrolling={}),i.addEventListener(this.instance.wtTable.holder,"scroll",function(){clearTimeout(t.instance.momentumScrolling._timeout);t.instance.momentumScrolling.ongoing||t.instance.getSetting("onBeforeTouchScroll");t.instance.momentumScrolling.ongoing=!0;t.instance.momentumScrolling._timeout=setTimeout(function(){t.instance.touchApplied||(t.instance.momentumScrolling.ongoing=!1,t.instance.getSetting("onAfterMomentumScroll"))},200)}));i.addEventListener(window,"resize",function(){t.instance.getSetting("stretchH")!=="none"&&t.instance.draw()});this.destroy=function(){clearTimeout(this.dblClickTimeout[0]);clearTimeout(this.dblClickTimeout[1]);i.destroy()}}t.__esModule=!0;var r=i(2),f=i(35),e=i(33),o=i(9),s=h(o);u.prototype.parentCell=function(n){var t={},u=this.instance.wtTable.TABLE,i=r.closestDown(n,["TD","TH"],u);return i?(t.coords=this.instance.wtTable.getCoords(i),t.TD=i):r.hasClass(n,"wtBorder")&&r.hasClass(n,"current")?(t.coords=this.instance.selections.getCell().cellRange.highlight,t.TD=this.instance.wtTable.getCell(t.coords)):r.hasClass(n,"wtBorder")&&r.hasClass(n,"area")&&this.instance.selections.createOrGetArea().cellRange&&(t.coords=this.instance.selections.createOrGetArea().cellRange.to,t.TD=this.instance.wtTable.getCell(t.coords)),t};t.default=u},function(n,t,i){"use strict";function f(n){return n&&n.__esModule?n:{"default":n}}function v(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var e;t.__esModule=!0;var o=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),u=i(2),s=i(0),h=i(18),y=i(33),c=i(9),l=f(c),a=i(30),r=f(a);e=function(){function n(t){v(this,n);this.wot=t;this.instance=this.wot;this.eventManager=new l.default(this.wot);this.wot.update("scrollbarWidth",u.getScrollbarWidth());this.wot.update("scrollbarHeight",u.getScrollbarWidth());this.scrollableElement=u.getScrollableElement(this.wot.wtTable.TABLE);this.prepareOverlays();this.destroyed=!1;this.keyPressed=!1;this.spreaderLastSize={width:null,height:null};this.overlayScrollPositions={master:{top:0,left:0},top:{top:null,left:0},bottom:{top:null,left:0},left:{top:0,left:null}};this.pendingScrollCallbacks={master:{top:0,left:0},top:{left:0},bottom:{left:0},left:{top:0}};this.verticalScrolling=!1;this.horizontalScrolling=!1;this.delegatedScrollCallback=!1;this.registeredListeners=[];this.registerListeners()}return o(n,[{key:"prepareOverlays",value:function(){var n=!1;return this.topOverlay?n=this.topOverlay.updateStateOfRendering()||n:this.topOverlay=r.default.createOverlay(r.default.CLONE_TOP,this.wot),r.default.hasOverlay(r.default.CLONE_BOTTOM)||(this.bottomOverlay={needFullRender:!1,updateStateOfRendering:function(){return!1}}),r.default.hasOverlay(r.default.CLONE_BOTTOM_LEFT_CORNER)||(this.bottomLeftCornerOverlay={needFullRender:!1,updateStateOfRendering:function(){return!1}}),this.bottomOverlay?n=this.bottomOverlay.updateStateOfRendering()||n:this.bottomOverlay=r.default.createOverlay(r.default.CLONE_BOTTOM,this.wot),this.leftOverlay?n=this.leftOverlay.updateStateOfRendering()||n:this.leftOverlay=r.default.createOverlay(r.default.CLONE_LEFT,this.wot),this.topOverlay.needFullRender&&this.leftOverlay.needFullRender&&(this.topLeftCornerOverlay?n=this.topLeftCornerOverlay.updateStateOfRendering()||n:this.topLeftCornerOverlay=r.default.createOverlay(r.default.CLONE_TOP_LEFT_CORNER,this.wot)),this.bottomOverlay.needFullRender&&this.leftOverlay.needFullRender&&(this.bottomLeftCornerOverlay?n=this.bottomLeftCornerOverlay.updateStateOfRendering()||n:this.bottomLeftCornerOverlay=r.default.createOverlay(r.default.CLONE_BOTTOM_LEFT_CORNER,this.wot)),this.wot.getSetting("debug")&&!this.debug&&(this.debug=r.default.createOverlay(r.default.CLONE_DEBUG,this.wot)),n}},{key:"refreshAll",value:function(){if(this.wot.drawn){if(!this.wot.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0);this.verticalScrolling&&this.leftOverlay.onScroll();this.horizontalScrolling&&this.topOverlay.onScroll();this.verticalScrolling=!1;this.horizontalScrolling=!1}}},{key:"registerListeners",value:function(){var n=this,r=this.topOverlay.mainTableScrollableElement,u=this.leftOverlay.mainTableScrollableElement,t=[],i;for(t.push([document.documentElement,"keydown",function(t){return n.onKeyDown(t)}]),t.push([document.documentElement,"keyup",function(){return n.onKeyUp()}]),t.push([document,"visibilitychange",function(){return n.onKeyUp()}]),t.push([r,"scroll",function(t){return n.onTableScroll(t)}]),r!==u&&t.push([u,"scroll",function(t){return n.onTableScroll(t)}]),this.topOverlay.needFullRender&&(t.push([this.topOverlay.clone.wtTable.holder,"scroll",function(t){return n.onTableScroll(t)}]),t.push([this.topOverlay.clone.wtTable.holder,"wheel",function(t){return n.onTableScroll(t)}])),this.bottomOverlay.needFullRender&&(t.push([this.bottomOverlay.clone.wtTable.holder,"scroll",function(t){return n.onTableScroll(t)}]),t.push([this.bottomOverlay.clone.wtTable.holder,"wheel",function(t){return n.onTableScroll(t)}])),this.leftOverlay.needFullRender&&(t.push([this.leftOverlay.clone.wtTable.holder,"scroll",function(t){return n.onTableScroll(t)}]),t.push([this.leftOverlay.clone.wtTable.holder,"wheel",function(t){return n.onTableScroll(t)}])),this.topLeftCornerOverlay&&this.topLeftCornerOverlay.needFullRender&&t.push([this.topLeftCornerOverlay.clone.wtTable.holder,"wheel",function(t){return n.onTableScroll(t)}]),this.bottomLeftCornerOverlay&&this.bottomLeftCornerOverlay.needFullRender&&t.push([this.bottomLeftCornerOverlay.clone.wtTable.holder,"wheel",function(t){return n.onTableScroll(t)}]),this.topOverlay.trimmingContainer!==window&&this.leftOverlay.trimmingContainer!==window&&t.push([window,"wheel",function(t){var i=void 0,r=t.wheelDeltaY||t.deltaY,u=t.wheelDeltaX||t.deltaX;n.topOverlay.clone.wtTable.holder.contains(t.realTarget)?i="top":n.bottomOverlay.clone&&n.bottomOverlay.clone.wtTable.holder.contains(t.realTarget)?i="bottom":n.leftOverlay.clone.wtTable.holder.contains(t.realTarget)?i="left":n.topLeftCornerOverlay&&n.topLeftCornerOverlay.clone&&n.topLeftCornerOverlay.clone.wtTable.holder.contains(t.realTarget)?i="topLeft":n.bottomLeftCornerOverlay&&n.bottomLeftCornerOverlay.clone&&n.bottomLeftCornerOverlay.clone.wtTable.holder.contains(t.realTarget)&&(i="bottomLeft");(i=="top"&&r!==0||i=="left"&&u!==0||i=="bottom"&&r!==0||(i==="topLeft"||i==="bottomLeft")&&(r!==0||u!==0))&&t.preventDefault()}]);t.length;)i=t.pop(),this.eventManager.addEventListener(i[0],i[1],i[2]),this.registeredListeners.push(i)}},{key:"deregisterListeners",value:function(){while(this.registeredListeners.length){var n=this.registeredListeners.pop();this.eventManager.removeEventListener(n[0],n[1],n[2])}}},{key:"onTableScroll",value:function(n){var t=this.leftOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,r=n.target;(!this.keyPressed||(i===window||r===window||n.target.contains(i))&&(t===window||r===window||n.target.contains(t)))&&(n.type==="scroll"?this.syncScrollPositions(n):this.translateMouseWheelToScroll(n))}},{key:"onKeyDown",value:function(n){this.keyPressed=h.isKey(n.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}},{key:"onKeyUp",value:function(){this.keyPressed=!1}},{key:"translateMouseWheelToScroll",value:function(n){var s=this.topOverlay.clone.wtTable.holder,h=this.bottomOverlay.clone?this.bottomOverlay.clone.wtTable.holder:null,c=this.leftOverlay.clone.wtTable.holder,l=this.topLeftCornerOverlay&&this.topLeftCornerOverlay.clone?this.topLeftCornerOverlay.clone.wtTable.holder:null,a=this.bottomLeftCornerOverlay&&this.bottomLeftCornerOverlay.clone?this.bottomLeftCornerOverlay.clone.wtTable.holder:null,u=-.2,f=n.wheelDeltaY||-1*n.deltaY,e=n.wheelDeltaX||-1*n.deltaX,t=null,r={type:"wheel"},i=n.target,o=null;for(n.deltaMode===1&&(f*=120,e*=120);i!=document&&i!=null;){if(i.className.indexOf("wtHolder")>-1){t=i;break}i=i.parentNode}return r.target=t,t===l||t===a?(this.syncScrollPositions(r,u*e,"x"),this.syncScrollPositions(r,u*f,"y")):(t===s||t===h?o=f:t===c&&(o=e),this.syncScrollPositions(r,u*o)),!1}},{key:"syncScrollPositions",value:function(n){var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null,a=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;if(!this.destroyed){if(arguments.length===0){this.syncScrollWithMaster();return}var c=this.leftOverlay.mainTableScrollableElement,f=this.topOverlay.mainTableScrollableElement,r=n.target,t=0,e=!1,o=void 0,l=void 0,v=void 0,y=void 0,s=void 0,h=!1,p=this.wot.getSetting("preventOverflow");this.topOverlay.needFullRender&&(o=this.topOverlay.clone.wtTable.holder);this.bottomOverlay.needFullRender&&(s=this.bottomOverlay.clone.wtTable.holder);this.leftOverlay.needFullRender&&(l=this.leftOverlay.clone.wtTable.holder);this.leftOverlay.needFullRender&&this.topOverlay.needFullRender&&(v=this.topLeftCornerOverlay.clone.wtTable.holder);this.leftOverlay.needFullRender&&this.bottomOverlay.needFullRender&&(y=this.bottomLeftCornerOverlay.clone.wtTable.holder);r===document&&(r=window);r===c||r===f?(t=p?u.getScrollLeft(this.scrollableElement):u.getScrollLeft(r),this.horizontalScrolling=this.overlayScrollPositions.master.left!==t,this.overlayScrollPositions.master.left=t,e=!0,this.pendingScrollCallbacks.master.left>0?this.pendingScrollCallbacks.master.left--:(o&&o.scrollLeft!==t&&(i==null&&this.pendingScrollCallbacks.top.left++,o.scrollLeft=t,h=c!==window),s&&s.scrollLeft!==t&&(i==null&&this.pendingScrollCallbacks.bottom.left++,s.scrollLeft=t,h=c!==window)),t=u.getScrollTop(r),this.verticalScrolling=this.overlayScrollPositions.master.top!==t,this.overlayScrollPositions.master.top=t,e=!0,this.pendingScrollCallbacks.master.top>0?this.pendingScrollCallbacks.master.top--:l&&l.scrollTop!==t&&(i==null&&this.pendingScrollCallbacks.left.top++,l.scrollTop=t,h=f!==window)):r===s?(t=u.getScrollLeft(r),this.overlayScrollPositions.bottom.left=t,e=!0,this.pendingScrollCallbacks.bottom.left>0?this.pendingScrollCallbacks.bottom.left--:(i==null&&this.pendingScrollCallbacks.master.left++,c.scrollLeft=t,o&&o.scrollLeft!==t&&(i==null&&this.pendingScrollCallbacks.top.left++,o.scrollLeft=t,h=f!==window)),i!==null&&(e=!0,f.scrollTop+=i)):r===o?(t=u.getScrollLeft(r),this.overlayScrollPositions.top.left=t,e=!0,this.pendingScrollCallbacks.top.left>0?this.pendingScrollCallbacks.top.left--:(i==null&&this.pendingScrollCallbacks.master.left++,c.scrollLeft=t),i!==null&&(e=!0,f.scrollTop+=i),s&&s.scrollLeft!==t&&(i==null&&this.pendingScrollCallbacks.bottom.left++,s.scrollLeft=t,h=f!==window)):r===l?(t=u.getScrollTop(r),this.overlayScrollPositions.left.top!==t&&(this.overlayScrollPositions.left.top=t,e=!0,this.pendingScrollCallbacks.left.top>0?this.pendingScrollCallbacks.left.top--:(i==null&&this.pendingScrollCallbacks.master.top++,f.scrollTop=t)),i!==null&&(e=!0,f.scrollLeft+=i)):(r===v||r===y)&&i!==null&&(e=!0,a==="x"?f.scrollLeft+=i:a==="y"&&(f.scrollTop+=i));!this.keyPressed&&e&&n.type==="scroll"&&(this.delegatedScrollCallback?this.delegatedScrollCallback=!1:this.refreshAll(),h&&(this.delegatedScrollCallback=!0))}}},{key:"syncScrollWithMaster",value:function(){var n=this.topOverlay.mainTableScrollableElement,t=n.scrollLeft,i=n.scrollTop;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=t);this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=t);this.leftOverlay.needFullRender&&(this.leftOverlay.clone.wtTable.holder.scrollTop=i)}},{key:"updateMainScrollableElements",value:function(){this.deregisterListeners();this.leftOverlay.updateMainScrollableElement();this.topOverlay.updateMainScrollableElement();this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();this.scrollableElement=u.getScrollableElement(this.wot.wtTable.TABLE);this.registerListeners()}},{key:"destroy",value:function(){this.eventManager.destroy();this.topOverlay.destroy();this.bottomOverlay.clone&&this.bottomOverlay.destroy();this.leftOverlay.destroy();this.topLeftCornerOverlay&&this.topLeftCornerOverlay.destroy();this.bottomLeftCornerOverlay&&this.bottomLeftCornerOverlay.clone&&this.bottomLeftCornerOverlay.destroy();this.debug&&this.debug.destroy();this.destroyed=!0}},{key:"refresh",value:function(){var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:!1;if(this.topOverlay.areElementSizesAdjusted&&this.leftOverlay.areElementSizesAdjusted){var t=this.wot.wtTable.wtRootElement.parentNode||this.wot.wtTable.wtRootElement,i=t.clientWidth,r=t.clientHeight;(i!==this.spreaderLastSize.width||r!==this.spreaderLastSize.height)&&(this.spreaderLastSize.width=i,this.spreaderLastSize.height=r,this.adjustElementsSize())}this.bottomOverlay.clone&&this.bottomOverlay.refresh(n);this.leftOverlay.refresh(n);this.topOverlay.refresh(n);this.topLeftCornerOverlay&&this.topLeftCornerOverlay.refresh(n);this.bottomLeftCornerOverlay&&this.bottomLeftCornerOverlay.clone&&this.bottomLeftCornerOverlay.refresh(n);this.debug&&this.debug.refresh(n)}},{key:"adjustElementsSize",value:function(){var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:!1,i=this.wot.getSetting("totalColumns"),r=this.wot.getSetting("totalRows"),u=this.wot.wtViewport.getRowHeaderWidth(),f=this.wot.wtViewport.getColumnHeaderHeight(),t=this.wot.wtTable.hider.style;t.width=u+this.leftOverlay.sumCellSizes(0,i)+"px";t.height=f+this.topOverlay.sumCellSizes(0,r)+1+"px";this.topOverlay.adjustElementsSize(n);this.leftOverlay.adjustElementsSize(n);this.bottomOverlay.clone&&this.bottomOverlay.adjustElementsSize(n)}},{key:"applyToDOM",value:function(){this.topOverlay.areElementSizesAdjusted&&this.leftOverlay.areElementSizesAdjusted||this.adjustElementsSize();this.topOverlay.applyToDOM();this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM();this.leftOverlay.applyToDOM()}},{key:"getParentOverlay",value:function(n){if(!n)return null;var i=[this.topOverlay,this.leftOverlay,this.bottomOverlay,this.topLeftCornerOverlay,this.bottomLeftCornerOverlay],t=null;return s.arrayEach(i,function(i){i&&i.clone&&i.clone.wtTable.TABLE.contains(n)&&(t=i.clone)}),t}}]),n}();t.default=e},function(n,t,i){"use strict";function o(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var f;t.__esModule=!0;var e=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),r=i(2),u=i(4);f=function(){function n(t){o(this,n);this.wot=t;this.instance=t}return e(n,[{key:"scrollViewport",value:function(n){if(this.wot.drawn){var t=this._getVariables(),i=t.topOverlay,r=t.leftOverlay,u=t.totalRows,f=t.totalColumns,e=t.fixedRowsTop,o=t.fixedRowsBottom,s=t.fixedColumnsLeft;if(n.row<0||n.row>Math.max(u-1,0))throw new Error("row "+n.row+" does not exist");if(n.col<0||n.col>Math.max(f-1,0))throw new Error("column "+n.col+" does not exist");n.row>=e&&n.row<this.getFirstVisibleRow()?i.scrollTo(n.row):n.row>this.getLastVisibleRow()&&n.row<u-o&&i.scrollTo(n.row,!0);n.col>=s&&n.col<this.getFirstVisibleColumn()?r.scrollTo(n.col):n.col>this.getLastVisibleColumn()&&r.scrollTo(n.col,!0)}}},{key:"getFirstVisibleRow",value:function(){var n=this._getVariables(),i=n.topOverlay,f=n.wtTable,c=n.wtViewport,l=n.totalRows,a=n.fixedRowsTop,e=f.getFirstVisibleRow(),t;if(i.mainTableScrollableElement===window){var o=r.offset(f.wtRootElement),s=r.innerHeight(f.hider),v=r.innerHeight(window),h=r.getScrollTop(window);o.top+s-v<=h&&(t=c.getColumnHeaderHeight(),t+=i.sumCellSizes(0,a),u.rangeEachReverse(l,1,function(n){return t+=i.sumCellSizes(n-1,n),o.top+s-t<=h?(e=n,!1):void 0}))}return e}},{key:"getLastVisibleRow",value:function(){var n=this._getVariables(),i=n.topOverlay,f=n.wtTable,h=n.wtViewport,c=n.totalRows,e=f.getLastVisibleRow(),t;if(i.mainTableScrollableElement===window){var o=r.offset(f.wtRootElement),l=r.innerHeight(window),s=r.getScrollTop(window);o.top>s&&(t=h.getColumnHeaderHeight(),u.rangeEach(1,c,function(n){return t+=i.sumCellSizes(n-1,n),o.top+t-s>=l?(e=n-2,!1):void 0}))}return e}},{key:"getFirstVisibleColumn",value:function(){var n=this._getVariables(),f=n.leftOverlay,t=n.wtTable,c=n.wtViewport,l=n.totalColumns,v=n.fixedColumnsLeft,e=t.getFirstVisibleColumn(),i;if(f.mainTableScrollableElement===window){var o=r.offset(t.wtRootElement),s=r.innerWidth(t.hider),a=r.innerWidth(window),h=r.getScrollLeft(window);o.left+s-a<=h&&(i=c.getRowHeaderWidth(),u.rangeEachReverse(l,1,function(n){return i+=f.sumCellSizes(n-1,n),o.left+s-i<=h?(e=n,!1):void 0}))}return e}},{key:"getLastVisibleColumn",value:function(){var n=this._getVariables(),i=n.leftOverlay,f=n.wtTable,h=n.wtViewport,c=n.totalColumns,e=f.getLastVisibleColumn(),t;if(i.mainTableScrollableElement===window){var o=r.offset(f.wtRootElement),l=r.innerWidth(window),s=r.getScrollLeft(window);o.left>s&&(t=h.getRowHeaderWidth(),u.rangeEach(1,c,function(n){return t+=i.sumCellSizes(n-1,n),o.left+t-s>=l?(e=n-2,!1):void 0}))}return e}},{key:"_getVariables",value:function(){var n=this.wot,t=n.wtOverlays.topOverlay,i=n.wtOverlays.leftOverlay,r=n.wtTable,u=n.wtViewport,f=n.getSetting("totalRows"),e=n.getSetting("totalColumns"),o=n.getSetting("fixedRowsTop"),s=n.getSetting("fixedRowsBottom"),h=n.getSetting("fixedColumnsLeft");return{topOverlay:t,leftOverlay:i,wtTable:r,wtViewport:u,totalRows:f,totalColumns:e,fixedRowsTop:o,fixedRowsBottom:s,fixedColumnsLeft:h}}}]),n}();t.default=f},function(n,t,i){"use strict";function o(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var u;t.__esModule=!0;var f=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),e=i(2),r=i(1);u=function(){function n(t,i){var f=this,u;o(this,n);this.wot=t;this.instance=t;this.defaults={table:void 0,debug:!1,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow:function(){return!1},data:void 0,freezeOverlays:!1,fixedColumnsLeft:0,fixedRowsTop:0,fixedRowsBottom:0,minSpareRows:0,rowHeaders:function(){return[]},columnHeaders:function(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:function(n,t,i){var r=f.getSetting("data",n,t);e.fastInnerText(i,r===void 0||r===null?"":r)},columnWidth:function(){},rowHeight:function(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeDrawBorders:null,onScrollVertically:null,onScrollHorizontally:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:function(n){return n},onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,scrollbarWidth:10,scrollbarHeight:10,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null};this.settings={};for(u in this.defaults)if(r.hasOwnProperty(this.defaults,u))if(i[u]!==void 0)this.settings[u]=i[u];else if(this.defaults[u]===void 0)throw new Error('A required setting "'+u+'" was not provided');else this.settings[u]=this.defaults[u]}return f(n,[{key:"update",value:function(n,t){if(t===void 0)for(var i in n)r.hasOwnProperty(n,i)&&(this.settings[i]=n[i]);else this.settings[n]=t;return this.wot}},{key:"getSetting",value:function(n,t,i,r,u){return typeof this.settings[n]=="function"?this.settings[n](t,i,r,u):t!==void 0&&Array.isArray(this.settings[n])?this.settings[n][t]:this.settings[n]}},{key:"has",value:function(n){return!!this.settings[n]}}]),n}();t.default=u},function(n,t,i){"use strict";function f(n){return n&&n.__esModule?n:{"default":n}}function nt(n){if(Array.isArray(n)){for(var t=0,i=Array(n.length);t<n.length;t++)i[t]=n[t];return i}return Array.from(n)}function tt(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var e;t.__esModule=!0;var o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},s=function(){function n(n,t){var r=[],u=!0,f=!1,e=undefined,i,o;try{for(i=n[Symbol.iterator]();!(u=(o=i.next()).done);u=!0)if(r.push(o.value),t&&r.length===t)break}catch(s){f=!0;e=s}finally{try{!u&&i["return"]&&i["return"]()}finally{if(f)throw e;}}return r}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return n(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance");}}(),h=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),u=i(2),c=i(35),l=i(61),a=f(l),v=i(150),it=f(v),y=i(191),p=f(y),w=i(192),b=f(w),k=i(319),d=f(k),g=i(30),r=f(g);e=function(){function n(t,i){var f=this,r;tt(this,n);this.wot=t;this.instance=this.wot;this.TABLE=i;this.TBODY=null;this.THEAD=null;this.COLGROUP=null;this.tableOffset=0;this.holderOffset=0;u.removeTextNodes(this.TABLE);this.spreader=this.createSpreader(this.TABLE);this.hider=this.createHider(this.spreader);this.holder=this.createHolder(this.hider);this.wtRootElement=this.holder.parentNode;this.alignOverlaysWithTrimmingContainer();this.fixTableDomTree();this.colgroupChildrenLength=this.COLGROUP.childNodes.length;this.theadChildrenLength=this.THEAD.firstChild?this.THEAD.firstChild.childNodes.length:0;this.tbodyChildrenLength=this.TBODY.childNodes.length;this.rowFilter=null;this.columnFilter=null;this.correctHeaderWidth=!1;r=this.wot.wtSettings.settings.rowHeaderWidth;this.wot.wtSettings.settings.rowHeaderWidth=function(){return f._modifyRowHeaderWidth(r)}}return h(n,[{key:"fixTableDomTree",value:function(){this.TBODY=this.TABLE.querySelector("tbody");this.TBODY||(this.TBODY=document.createElement("tbody"),this.TABLE.appendChild(this.TBODY));this.THEAD=this.TABLE.querySelector("thead");this.THEAD||(this.THEAD=document.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY));this.COLGROUP=this.TABLE.querySelector("colgroup");this.COLGROUP||(this.COLGROUP=document.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD));this.wot.getSetting("columnHeaders").length&&!this.THEAD.childNodes.length&&this.THEAD.appendChild(document.createElement("TR"))}},{key:"createSpreader",value:function(n){var i=n.parentNode,t=void 0;return i&&i.nodeType===1&&u.hasClass(i,"wtHolder")||(t=document.createElement("div"),t.className="wtSpreader",i&&i.insertBefore(t,n),t.appendChild(n)),t.style.position="relative",t}},{key:"createHider",value:function(n){var t=n.parentNode,i=void 0;return t&&t.nodeType===1&&u.hasClass(t,"wtHolder")||(i=document.createElement("div"),i.className="wtHider",t&&t.insertBefore(i,n),i.appendChild(n)),i}},{key:"createHolder",value:function(n){var i=n.parentNode,t=void 0;return i&&i.nodeType===1&&u.hasClass(i,"wtHolder")||(t=document.createElement("div"),t.style.position="relative",t.className="wtHolder",i&&i.insertBefore(t,n),this.isWorkingOnClone()||(t.parentNode.className+="ht_master handsontable"),t.appendChild(n)),t}},{key:"alignOverlaysWithTrimmingContainer",value:function(){var n=u.getTrimmingContainer(this.wtRootElement),t;this.isWorkingOnClone()||(this.holder.parentNode.style.position="relative",n===window?(t=this.wot.getSetting("preventOverflow"),t||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible")):(this.holder.style.width=u.getStyle(n,"width"),this.holder.style.height=u.getStyle(n,"height"),this.holder.style.overflow=""))}},{key:"isWorkingOnClone",value:function(){return!!this.wot.cloneSource}},{key:"draw",value:function(n){var o=this.wot,t=o.wtOverlays,i=o.wtViewport,s=this.instance.getSetting("totalRows"),h=this.wot.getSetting("rowHeaders").length,v=this.wot.getSetting("columnHeaders").length,c=!1,l,a,f,e;return this.isWorkingOnClone()||(this.holderOffset=u.offset(this.holder),n=i.createRenderCalculators(n),h&&!this.wot.getSetting("fixedColumnsLeft")&&(l=t.leftOverlay.getScrollPosition(),a=this.correctHeaderWidth,this.correctHeaderWidth=l>0,a!==this.correctHeaderWidth&&(n=!1))),this.isWorkingOnClone()||(c=t.prepareOverlays()),n?(this.isWorkingOnClone()||i.createVisibleCalculators(),t&&t.refresh(!0)):(this.tableOffset=this.isWorkingOnClone()?this.wot.cloneSource.wtTable.tableOffset:u.offset(this.TABLE),f=void 0,f=r.default.isOverlayTypeOf(this.wot.cloneOverlay,r.default.CLONE_DEBUG)||r.default.isOverlayTypeOf(this.wot.cloneOverlay,r.default.CLONE_TOP)||r.default.isOverlayTypeOf(this.wot.cloneOverlay,r.default.CLONE_TOP_LEFT_CORNER)?0:r.default.isOverlayTypeOf(this.instance.cloneOverlay,r.default.CLONE_BOTTOM)||r.default.isOverlayTypeOf(this.instance.cloneOverlay,r.default.CLONE_BOTTOM_LEFT_CORNER)?Math.max(s-this.wot.getSetting("fixedRowsBottom"),0):i.rowsRenderCalculator.startRow,e=void 0,e=r.default.isOverlayTypeOf(this.wot.cloneOverlay,r.default.CLONE_DEBUG)||r.default.isOverlayTypeOf(this.wot.cloneOverlay,r.default.CLONE_LEFT)||r.default.isOverlayTypeOf(this.wot.cloneOverlay,r.default.CLONE_TOP_LEFT_CORNER)||r.default.isOverlayTypeOf(this.wot.cloneOverlay,r.default.CLONE_BOTTOM_LEFT_CORNER)?0:i.columnsRenderCalculator.startColumn,this.rowFilter=new b.default(f,s,v),this.columnFilter=new p.default(e,this.wot.getSetting("totalColumns"),h),this.alignOverlaysWithTrimmingContainer(),this._doDraw()),this.refreshSelections(n),this.isWorkingOnClone()||(t.topOverlay.resetFixedPosition(),t.bottomOverlay.clone&&t.bottomOverlay.resetFixedPosition(),t.leftOverlay.resetFixedPosition(),t.topLeftCornerOverlay&&t.topLeftCornerOverlay.resetFixedPosition(),t.bottomLeftCornerOverlay&&t.bottomLeftCornerOverlay.clone&&t.bottomLeftCornerOverlay.resetFixedPosition()),c&&t.syncScrollWithMaster(),this.wot.drawn=!0,this}},{key:"_doDraw",value:function(){var n=new d.default(this);n.render()}},{key:"removeClassFromCells",value:function(n){for(var i=this.TABLE.querySelectorAll("."+n),t=0,r=i.length;t<r;t++)u.removeClass(i[t],n)}},{key:"refreshSelections",value:function(n){var i,o,t,r,u,v,f,e;if(this.wot.selections){if(i=Array.from(this.wot.selections),o=i.length,n){for(t=[],r=0;r<o;r++){var s=i[r].settings,h=s.highlightHeaderClassName,c=s.highlightRowClassName,l=s.highlightColumnClassName,a=i[r].classNames,y=a.length;for(u=0;u<y;u++)t.includes(a[u])||t.push(a[u]);h&&!t.includes(h)&&t.push(h);c&&!t.includes(c)&&t.push(c);l&&!t.includes(l)&&t.push(l)}for(v=t.length,f=0;f<v;f++)this.removeClassFromCells(t[f])}for(e=0;e<o;e++)i[e].draw(this.wot,n)}}},{key:"getCell",value:function(n){var t=n.row,i=n.col,r=this.wot.getSetting("onModifyGetCellCoords",t,i),u,f;return(r&&Array.isArray(r)&&(u=s(r,2),t=u[0],i=u[1]),this.isRowBeforeRenderedRows(t))?-1:this.isRowAfterRenderedRows(t)?-2:(f=this.TBODY.childNodes[this.rowFilter.sourceToRendered(t)],f?f.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(i)]:void 0)}},{key:"getColumnHeader",value:function(n){var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0,t=this.THEAD.childNodes[i];if(t)return t.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(n)]}},{key:"getRowHeader",value:function(n){if(this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0)===0)return null;var t=this.TBODY.childNodes[this.rowFilter.sourceToRendered(n)];if(t)return t.childNodes[0]}},{key:"getCoords",value:function(n){if(n.nodeName!=="TD"&&n.nodeName!=="TH"&&(n=u.closest(n,["TD","TH"])),n===null)return null;var e=n.parentNode,f=e.parentNode,t=u.index(e),i=n.cellIndex;return u.overlayContainsElement(r.default.CLONE_TOP_LEFT_CORNER,n)||u.overlayContainsElement(r.default.CLONE_TOP,n)?f.nodeName==="THEAD"&&(t-=f.childNodes.length):t=f===this.THEAD?this.rowFilter.visibleColHeadedRowToSourceRow(t):this.rowFilter.renderedToSource(t),i=u.overlayContainsElement(r.default.CLONE_TOP_LEFT_CORNER,n)||u.overlayContainsElement(r.default.CLONE_LEFT,n)?this.columnFilter.offsettedTH(i):this.columnFilter.visibleRowHeadedColumnToSourceColumn(i),new a.default(t,i)}},{key:"getTrForRow",value:function(n){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(n)]}},{key:"getFirstRenderedRow",value:function(){return this.wot.wtViewport.rowsRenderCalculator.startRow}},{key:"getFirstVisibleRow",value:function(){return this.wot.wtViewport.rowsVisibleCalculator.startRow}},{key:"getFirstRenderedColumn",value:function(){return this.wot.wtViewport.columnsRenderCalculator.startColumn}},{key:"getFirstVisibleColumn",value:function(){return this.wot.wtViewport.columnsVisibleCalculator.startColumn}},{key:"getLastRenderedRow",value:function(){return this.wot.wtViewport.rowsRenderCalculator.endRow}},{key:"getLastVisibleRow",value:function(){return this.wot.wtViewport.rowsVisibleCalculator.endRow}},{key:"getLastRenderedColumn",value:function(){return this.wot.wtViewport.columnsRenderCalculator.endColumn}},{key:"getLastVisibleColumn",value:function(){return this.wot.wtViewport.columnsVisibleCalculator.endColumn}},{key:"isRowBeforeRenderedRows",value:function(n){return this.rowFilter&&this.rowFilter.sourceToRendered(n)<0&&n>=0}},{key:"isRowAfterViewport",value:function(n){return this.rowFilter&&this.rowFilter.sourceToRendered(n)>this.getLastVisibleRow()}},{key:"isRowAfterRenderedRows",value:function(n){return this.rowFilter&&this.rowFilter.sourceToRendered(n)>this.getLastRenderedRow()}},{key:"isColumnBeforeViewport",value:function(n){return this.columnFilter&&this.columnFilter.sourceToRendered(n)<0&&n>=0}},{key:"isColumnAfterViewport",value:function(n){return this.columnFilter&&this.columnFilter.sourceToRendered(n)>this.getLastVisibleColumn()}},{key:"isLastRowFullyVisible",value:function(){return this.getLastVisibleRow()===this.getLastRenderedRow()}},{key:"isLastColumnFullyVisible",value:function(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}},{key:"getRenderedColumnsCount",value:function(){var n=this.wot.wtViewport.columnsRenderCalculator.count,t=this.wot.getSetting("totalColumns");if(this.wot.isOverlayName(r.default.CLONE_DEBUG))n=t;else if(this.wot.isOverlayName(r.default.CLONE_LEFT)||this.wot.isOverlayName(r.default.CLONE_TOP_LEFT_CORNER)||this.wot.isOverlayName(r.default.CLONE_BOTTOM_LEFT_CORNER))return Math.min(this.wot.getSetting("fixedColumnsLeft"),t);return n}},{key:"getRenderedRowsCount",value:function(){var n=this.wot.wtViewport.rowsRenderCalculator.count,t=this.wot.getSetting("totalRows");return this.wot.isOverlayName(r.default.CLONE_DEBUG)?n=t:this.wot.isOverlayName(r.default.CLONE_TOP)||this.wot.isOverlayName(r.default.CLONE_TOP_LEFT_CORNER)?n=Math.min(this.wot.getSetting("fixedRowsTop"),t):(this.wot.isOverlayName(r.default.CLONE_BOTTOM)||this.wot.isOverlayName(r.default.CLONE_BOTTOM_LEFT_CORNER))&&(n=Math.min(this.wot.getSetting("fixedRowsBottom"),t)),n}},{key:"getVisibleRowsCount",value:function(){return this.wot.wtViewport.rowsVisibleCalculator.count}},{key:"allRowsInViewport",value:function(){return this.wot.getSetting("totalRows")==this.getVisibleRowsCount()}},{key:"getRowHeight",value:function(n){var t=this.wot.wtSettings.settings.rowHeight(n),i=this.wot.wtViewport.oversizedRows[n];return i!==void 0&&(t=t===void 0?i:Math.max(t,i)),t}},{key:"getColumnHeaderHeight",value:function(n){var t=this.wot.wtSettings.settings.defaultRowHeight,i=this.wot.wtViewport.oversizedColumnHeaders[n];return i!==void 0&&(t=t?Math.max(t,i):i),t}},{key:"getVisibleColumnsCount",value:function(){return this.wot.wtViewport.columnsVisibleCalculator.count}},{key:"allColumnsInViewport",value:function(){return this.wot.getSetting("totalColumns")==this.getVisibleColumnsCount()}},{key:"getColumnWidth",value:function(n){var t=this.wot.wtSettings.settings.columnWidth;return typeof t=="function"?t=t(n):(typeof t=="undefined"?"undefined":o(t))==="object"&&(t=t[n]),t||this.wot.wtSettings.settings.defaultColumnWidth}},{key:"getStretchedColumnWidth",value:function(n){var r=this.getColumnWidth(n),t=r==null?this.instance.wtSettings.settings.defaultColumnWidth:r,u=this.wot.wtViewport.columnsRenderCalculator,i;return u&&(i=u.getStretchedColumnWidth(n,t),i&&(t=i)),t}},{key:"_modifyRowHeaderWidth",value:function(n){var t=c.isFunction(n)?n():null;return Array.isArray(t)?(t=[].concat(nt(t)),t[t.length-1]=this._correctRowHeaderWidth(t[t.length-1])):t=this._correctRowHeaderWidth(t),t}},{key:"_correctRowHeaderWidth",value:function(n){return typeof n!="number"&&(n=this.wot.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&n++,n}}]),n}();t.default=e},function(n,t,i){"use strict";function h(n){return n&&n.__esModule?n:{"default":n}}function c(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function l(n,t){var i=document.createElement("TH");return t.insertBefore(i,n),t.removeChild(n),i}function a(n,t){var i=document.createElement("TD");return t.insertBefore(i,n),t.removeChild(n),i}var f,e;t.__esModule=!0;var o=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),r=i(2),s=i(30),u=h(s);f=!1;e=function(){function n(t){c(this,n);this.wtTable=t;this.wot=t.instance;this.instance=t.instance;this.rowFilter=t.rowFilter;this.columnFilter=t.columnFilter;this.TABLE=t.TABLE;this.THEAD=t.THEAD;this.TBODY=t.TBODY;this.COLGROUP=t.COLGROUP;this.rowHeaders=[];this.rowHeaderCount=0;this.columnHeaders=[];this.columnHeaderCount=0;this.fixedRowsTop=0;this.fixedRowsBottom=0}return o(n,[{key:"render",value:function(){var e,s,a,t,i,f,v,y;if(this.wtTable.isWorkingOnClone()||(e={},this.wot.getSetting("beforeDraw",!0,e),e.skipRender!==!0)){this.rowHeaders=this.wot.getSetting("rowHeaders");this.rowHeaderCount=this.rowHeaders.length;this.fixedRowsTop=this.wot.getSetting("fixedRowsTop");this.fixedRowsBottom=this.wot.getSetting("fixedRowsBottom");this.columnHeaders=this.wot.getSetting("columnHeaders");this.columnHeaderCount=this.columnHeaders.length;var o=this.wtTable.getRenderedColumnsCount(),h=this.wtTable.getRenderedRowsCount(),p=this.wot.getSetting("totalColumns"),w=this.wot.getSetting("totalRows"),c=void 0,l=!1;if((u.default.isOverlayTypeOf(this.wot.cloneOverlay,u.default.CLONE_BOTTOM)||u.default.isOverlayTypeOf(this.wot.cloneOverlay,u.default.CLONE_BOTTOM_LEFT_CORNER))&&(this.columnHeaders=[],this.columnHeaderCount=0),p>=0&&(this.adjustAvailableNodes(),l=!0,this.renderColumnHeaders(),this.renderRows(w,h,o),this.wtTable.isWorkingOnClone()||(c=this.wot.wtViewport.getWorkspaceWidth(),this.wot.wtViewport.containerWidth=null),this.adjustColumnWidths(o),this.markOversizedColumnHeaders(),this.adjustColumnHeaderHeights()),l||this.adjustAvailableNodes(),this.removeRedundantRows(h),(!this.wtTable.isWorkingOnClone()||this.wot.isOverlayName(u.default.CLONE_BOTTOM))&&this.markOversizedRows(),this.wtTable.isWorkingOnClone())this.wot.isOverlayName(u.default.CLONE_BOTTOM)&&this.wot.cloneSource.wtOverlays.adjustElementsSize();else{if(this.wot.wtViewport.createVisibleCalculators(),this.wot.wtOverlays.refresh(!1),this.wot.wtOverlays.applyToDOM(),s=r.outerWidth(this.wtTable.hider),a=r.outerWidth(this.wtTable.TABLE),s!==0&&a!==s&&this.adjustColumnWidths(o),c!==this.wot.wtViewport.getWorkspaceWidth()){this.wot.wtViewport.containerWidth=null;var b=this.wtTable.getFirstRenderedColumn(),k=this.wtTable.getLastRenderedColumn(),d=this.wot.getSetting("defaultColumnWidth"),n=this.wot.getSetting("rowHeaderWidth");if(n=this.instance.getSetting("onModifyRowHeaderWidth",n),n!=null)for(t=0;t<this.rowHeaderCount;t++)i=Array.isArray(n)?n[t]:n,i=i==null?d:i,this.COLGROUP.childNodes[t].style.width=i+"px";for(f=b;f<k;f++)v=this.wtTable.getStretchedColumnWidth(f),y=this.columnFilter.sourceToRendered(f),this.COLGROUP.childNodes[y+this.rowHeaderCount].style.width=v+"px"}this.wot.getSetting("onDraw",!0)}}}},{key:"removeRedundantRows",value:function(n){while(this.wtTable.tbodyChildrenLength>n)this.TBODY.removeChild(this.TBODY.lastChild),this.wtTable.tbodyChildrenLength--}},{key:"renderRows",value:function(n,t,i){for(var h=void 0,r=void 0,o=0,e=this.rowFilter.renderedToSource(o),c=this.wtTable.isWorkingOnClone(),s;e<n&&e>=0;){if(!f&&o>1e3&&(f=!0,console.warn('Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.')),t!==void 0&&o===t)break;r=this.getOrCreateTrForRow(o,r);this.renderRowHeaders(e,r);this.adjustColumns(r,i+this.rowHeaderCount);h=this.renderCells(e,r,i);(!c||this.wot.isOverlayName(u.default.CLONE_BOTTOM))&&this.resetOversizedRow(e);r.firstChild&&(s=this.wot.wtTable.getRowHeight(e),s?(s--,r.firstChild.style.height=s+"px"):r.firstChild.style.height="");o++;e=this.rowFilter.renderedToSource(o)}}},{key:"resetOversizedRow",value:function(n){this.wot.getSetting("externalRowCalculator")||this.wot.wtViewport.oversizedRows&&this.wot.wtViewport.oversizedRows[n]&&(this.wot.wtViewport.oversizedRows[n]=void 0)}},{key:"markOversizedRows",value:function(){if(!this.wot.getSetting("externalRowCalculator")){var n=this.instance.wtTable.TBODY.childNodes.length,o=n*this.instance.wtSettings.settings.defaultRowHeight,s=r.innerHeight(this.instance.wtTable.TBODY)-1,u=void 0,t=void 0,i=void 0,f=void 0,e=void 0,h=this.instance.getSetting("totalRows");if(o!==s||this.instance.getSetting("fixedRowsBottom"))while(n)n--,i=this.instance.wtTable.rowFilter.renderedToSource(n),u=this.instance.wtTable.getRowHeight(i),f=this.instance.wtTable.getTrForRow(i),e=f.querySelector("th"),t=e?r.innerHeight(e):r.innerHeight(f)-1,(!u&&this.instance.wtSettings.settings.defaultRowHeight<t||u<t)&&(this.instance.wtViewport.oversizedRows[i]=++t)}}},{key:"markOversizedColumnHeaders",value:function(){var i=this.wot.getOverlayName(),r,t,n;if(this.columnHeaderCount&&!this.wot.wtViewport.hasOversizedColumnHeadersMarked[i]&&!this.wtTable.isWorkingOnClone()){for(r=this.wtTable.getRenderedColumnsCount(),t=0;t<this.columnHeaderCount;t++)for(n=-1*this.rowHeaderCount;n<r;n++)this.markIfOversizedColumnHeader(n);this.wot.wtViewport.hasOversizedColumnHeadersMarked[i]=!0}}},{key:"adjustColumnHeaderHeights",value:function(){for(var r=this.wot.getSetting("columnHeaders"),t=this.wot.wtTable.THEAD.childNodes,i=this.wot.wtViewport.oversizedColumnHeaders,n=0,u=r.length;n<u;n++)if(i[n]){if(!t[n]||t[n].childNodes.length===0)return;t[n].childNodes[0].style.height=i[n]+"px"}}},{key:"markIfOversizedColumnHeader",value:function(n){for(var o=this.wot.wtTable.columnFilter.renderedToSource(n),t=this.columnHeaderCount,s=this.wot.wtSettings.settings.defaultRowHeight,f=void 0,e=void 0,u=void 0,i=this.wot.getSetting("columnHeaderHeight")||[];t;)(t--,f=this.wot.wtTable.getColumnHeaderHeight(t),e=this.wot.wtTable.getColumnHeader(o,t),e)&&(u=r.innerHeight(e),(!f&&s<u||f<u)&&(this.wot.wtViewport.oversizedColumnHeaders[t]=u),Array.isArray(i)?i[t]!=null&&(this.wot.wtViewport.oversizedColumnHeaders[t]=i[t]):isNaN(i)||(this.wot.wtViewport.oversizedColumnHeaders[t]=i),this.wot.wtViewport.oversizedColumnHeaders[t]<(i[t]||i)&&(this.wot.wtViewport.oversizedColumnHeaders[t]=i[t]||i))}},{key:"renderCells",value:function(n,t,i){for(var u=void 0,e=void 0,f=0;f<i;f++)e=this.columnFilter.renderedToSource(f),u=f===0?t.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]:u.nextSibling,u.nodeName=="TH"&&(u=a(u,t)),r.hasClass(u,"hide")||(u.className=""),u.removeAttribute("style"),this.wot.wtSettings.settings.cellRenderer(n,e,u);return u}},{key:"adjustColumnWidths",value:function(n){var e=0,h=this.wot.cloneSource?this.wot.cloneSource:this.wot,o=h.wtTable.holder,c=this.wot.getSetting("defaultColumnWidth"),t=this.wot.getSetting("rowHeaderWidth"),i,u,f,s;if(o.offsetHeight<o.scrollHeight&&(e=r.getScrollbarWidth()),this.wot.wtViewport.columnsRenderCalculator.refreshStretching(this.wot.wtViewport.getViewportWidth()-e),t=this.instance.getSetting("onModifyRowHeaderWidth",t),t!=null)for(i=0;i<this.rowHeaderCount;i++)u=Array.isArray(t)?t[i]:t,u=u==null?c:u,this.COLGROUP.childNodes[i].style.width=u+"px";for(f=0;f<n;f++)s=this.wtTable.getStretchedColumnWidth(this.columnFilter.renderedToSource(f)),this.COLGROUP.childNodes[f+this.rowHeaderCount].style.width=s+"px"}},{key:"appendToTbody",value:function(n){this.TBODY.appendChild(n);this.wtTable.tbodyChildrenLength++}},{key:"getOrCreateTrForRow",value:function(n,t){var i=void 0;return n>=this.wtTable.tbodyChildrenLength?(i=this.createRow(),this.appendToTbody(i)):i=n===0?this.TBODY.firstChild:t.nextSibling,i.className&&i.removeAttribute("class"),i}},{key:"createRow",value:function(){for(var n=document.createElement("TR"),t=0;t<this.rowHeaderCount;t++)n.appendChild(document.createElement("TH"));return n}},{key:"renderRowHeader",value:function(n,t,i){i.className="";i.removeAttribute("style");this.rowHeaders[t](n,i,t)}},{key:"renderRowHeaders",value:function(n,t){for(var i=t.firstChild,r=0;r<this.rowHeaderCount;r++)i?i.nodeName=="TD"&&(i=l(i,t)):(i=document.createElement("TH"),t.appendChild(i)),this.renderRowHeader(n,r,i),i=i.nextSibling}},{key:"adjustAvailableNodes",value:function(){this.adjustColGroups();this.adjustThead()}},{key:"renderColumnHeaders",value:function(){var i,n,r,t,u;if(this.columnHeaderCount)for(i=this.wtTable.getRenderedColumnsCount(),n=0;n<this.columnHeaderCount;n++)for(r=this.getTrForColumnHeaders(n),t=-1*this.rowHeaderCount;t<i;t++)u=this.columnFilter.renderedToSource(t),this.renderColumnHeader(n,u,r.childNodes[t+this.rowHeaderCount])}},{key:"adjustColGroups",value:function(){for(var n=this.wtTable.getRenderedColumnsCount();this.wtTable.colgroupChildrenLength<n+this.rowHeaderCount;)this.COLGROUP.appendChild(document.createElement("COL")),this.wtTable.colgroupChildrenLength++;while(this.wtTable.colgroupChildrenLength>n+this.rowHeaderCount)this.COLGROUP.removeChild(this.COLGROUP.lastChild),this.wtTable.colgroupChildrenLength--;this.rowHeaderCount&&r.addClass(this.COLGROUP.childNodes[0],"rowHeader")}},{key:"adjustThead",value:function(){var f=this.wtTable.getRenderedColumnsCount(),n=this.THEAD.firstChild,t,e,i,u;if(this.columnHeaders.length){for(t=0,e=this.columnHeaders.length;t<e;t++){for(n=this.THEAD.childNodes[t],n||(n=document.createElement("TR"),this.THEAD.appendChild(n)),this.theadChildrenLength=n.childNodes.length;this.theadChildrenLength<f+this.rowHeaderCount;)n.appendChild(document.createElement("TH")),this.theadChildrenLength++;while(this.theadChildrenLength>f+this.rowHeaderCount)n.removeChild(n.lastChild),this.theadChildrenLength--}if(i=this.THEAD.childNodes.length,i>this.columnHeaders.length)for(u=this.columnHeaders.length;u<i;u++)this.THEAD.removeChild(this.THEAD.lastChild)}else n&&r.empty(n)}},{key:"getTrForColumnHeaders",value:function(n){return this.THEAD.childNodes[n]}},{key:"renderColumnHeader",value:function(n,t,i){return i.className="",i.removeAttribute("style"),this.columnHeaders[n](t,i,n)}},{key:"adjustColumns",value:function(n,t){for(var i=n.childNodes.length,r;i<t;)r=document.createElement("TD"),n.appendChild(r),i++;while(i>t)n.removeChild(n.lastChild),i--}},{key:"removeRedundantColumns",value:function(n){while(this.wtTable.tbodyChildrenLength>n)this.TBODY.removeChild(this.TBODY.lastChild),this.wtTable.tbodyChildrenLength--}}]),n}();t.default=e},function(n,t,i){"use strict";function u(n){return n&&n.__esModule?n:{"default":n}}function y(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var f;t.__esModule=!0;var e=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),r=i(2),o=i(1),s=i(9),h=u(s),c=i(189),l=u(c),a=i(190),v=u(a);f=function(){function n(t){var i=this;y(this,n);this.wot=t;this.instance=this.wot;this.oversizedRows=[];this.oversizedColumnHeaders=[];this.hasOversizedColumnHeadersMarked={};this.clientHeight=0;this.containerWidth=NaN;this.rowHeaderWidth=NaN;this.rowsVisibleCalculator=null;this.columnsVisibleCalculator=null;this.eventManager=new h.default(this.wot);this.eventManager.addEventListener(window,"resize",function(){i.clientHeight=i.getWorkspaceHeight()})}return e(n,[{key:"getWorkspaceHeight",value:function(){var n=this.instance.wtOverlays.topOverlay.trimmingContainer,i=void 0,t=0;return n===window?t=document.documentElement.clientHeight:(i=r.outerHeight(n),t=i>0&&n.clientHeight>0?n.clientHeight:Infinity),t}},{key:"getWorkspaceWidth",value:function(){var n=void 0,f=this.wot.getSetting("totalColumns"),u=this.instance.wtOverlays.leftOverlay.trimmingContainer,t=void 0,e=this.wot.getSetting("stretchH"),i=document.documentElement.offsetWidth,o=this.wot.getSetting("preventOverflow");return o?r.outerWidth(this.instance.wtTable.wtRootElement):(n=this.wot.getSetting("freezeOverlays")?Math.min(i-this.getWorkspaceOffset().left,i):Math.min(this.getContainerFillWidth(),i-this.getWorkspaceOffset().left,i),u===window&&f>0&&this.sumColumnWidths(0,f-1)>n)?document.documentElement.clientWidth:u!==window&&(t=r.getStyle(this.instance.wtOverlays.leftOverlay.trimmingContainer,"overflow"),t=="scroll"||t=="hidden"||t=="auto")?Math.max(n,u.clientWidth):e==="none"||!e?Math.max(n,r.outerWidth(this.instance.wtTable.TABLE)):n}},{key:"hasVerticalScroll",value:function(){return this.getWorkspaceActualHeight()>this.getWorkspaceHeight()}},{key:"hasHorizontalScroll",value:function(){return this.getWorkspaceActualWidth()>this.getWorkspaceWidth()}},{key:"sumColumnWidths",value:function(n,t){for(var i=0;n<t;)i+=this.wot.wtTable.getColumnWidth(n),n++;return i}},{key:"getContainerFillWidth",value:function(){if(this.containerWidth)return this.containerWidth;var i=this.instance.wtTable.holder,t=void 0,n=void 0;return n=document.createElement("div"),n.style.width="100%",n.style.height="1px",i.appendChild(n),t=n.offsetWidth,this.containerWidth=t,i.removeChild(n),t}},{key:"getWorkspaceOffset",value:function(){return r.offset(this.wot.wtTable.TABLE)}},{key:"getWorkspaceActualHeight",value:function(){return r.outerHeight(this.wot.wtTable.TABLE)}},{key:"getWorkspaceActualWidth",value:function(){return r.outerWidth(this.wot.wtTable.TABLE)||r.outerWidth(this.wot.wtTable.TBODY)||r.outerWidth(this.wot.wtTable.THEAD)}},{key:"getColumnHeaderHeight",value:function(){return isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=r.outerHeight(this.wot.wtTable.THEAD)),this.columnHeaderHeight}},{key:"getViewportHeight",value:function(){var n=this.getWorkspaceHeight(),t=void 0;return n===Infinity?n:(t=this.getColumnHeaderHeight(),t>0&&(n-=t),n)}},{key:"getRowHeaderWidth",value:function(){var i=this.instance.getSetting("rowHeaderWidth"),u=this.instance.getSetting("rowHeaders"),t,e,n,f,o;if(i)for(this.rowHeaderWidth=0,t=0,e=u.length;t<e;t++)this.rowHeaderWidth+=i[t]||i;if(this.wot.cloneSource)return this.wot.cloneSource.wtViewport.getRowHeaderWidth();if(isNaN(this.rowHeaderWidth))if(u.length)for(n=this.instance.wtTable.TABLE.querySelector("TH"),this.rowHeaderWidth=0,f=0,o=u.length;f<o;f++)n?(this.rowHeaderWidth+=r.outerWidth(n),n=n.nextSibling):this.rowHeaderWidth+=50;else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.instance.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}},{key:"getViewportWidth",value:function(){var n=this.getWorkspaceWidth(),t=void 0;return n===Infinity?n:(t=this.getRowHeaderWidth(),t>0)?n-t:n}},{key:"createRowsCalculator",value:function(){var h=this,u=arguments.length>0&&arguments[0]!==undefined?arguments[0]:!1,i=void 0,n=void 0,f=void 0,s=void 0,e=void 0,t=void 0,o=void 0;return this.rowHeaderWidth=NaN,i=this.wot.wtSettings.settings.renderAllRows&&!u?Infinity:this.getViewportHeight(),n=this.wot.wtOverlays.topOverlay.getScrollPosition()-this.wot.wtOverlays.topOverlay.getTableParentOffset(),n<0&&(n=0),f=this.wot.getSetting("fixedRowsTop"),e=this.wot.getSetting("fixedRowsBottom"),o=this.wot.getSetting("totalRows"),f&&(t=this.wot.wtOverlays.topOverlay.sumCellSizes(0,f),n+=t,i-=t),e&&this.wot.wtOverlays.bottomOverlay.clone&&(t=this.wot.wtOverlays.bottomOverlay.sumCellSizes(o-e,o),i-=t),s=this.wot.wtTable.holder.clientHeight===this.wot.wtTable.holder.offsetHeight?0:r.getScrollbarWidth(),new v.default(i,n,this.wot.getSetting("totalRows"),function(n){return h.wot.wtTable.getRowHeight(n)},u?null:this.wot.wtSettings.settings.viewportRowCalculatorOverride,u,s)}},{key:"createColumnsCalculator",value:function(){var f=this,e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:!1,t=this.getViewportWidth(),n=void 0,i=void 0,u;return this.columnHeaderHeight=NaN,n=this.wot.wtOverlays.leftOverlay.getScrollPosition()-this.wot.wtOverlays.leftOverlay.getTableParentOffset(),n<0&&(n=0),i=this.wot.getSetting("fixedColumnsLeft"),i&&(u=this.wot.wtOverlays.leftOverlay.sumCellSizes(0,i),n+=u,t-=u),this.wot.wtTable.holder.clientWidth!==this.wot.wtTable.holder.offsetWidth&&(t-=r.getScrollbarWidth()),new l.default(t,n,this.wot.getSetting("totalColumns"),function(n){return f.wot.wtTable.getColumnWidth(n)},e?null:this.wot.wtSettings.settings.viewportColumnCalculatorOverride,e,this.wot.getSetting("stretchH"),function(n,t){return f.wot.getSetting("onBeforeStretchingColumnWidth",n,t)})}},{key:"createRenderCalculators",value:function(){var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:!1,t,i;return n&&(t=this.createRowsCalculator(!0),i=this.createColumnsCalculator(!0),this.areAllProposedVisibleRowsAlreadyRendered(t)&&this.areAllProposedVisibleColumnsAlreadyRendered(i)||(n=!1)),n||(this.rowsRenderCalculator=this.createRowsCalculator(),this.columnsRenderCalculator=this.createColumnsCalculator()),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,n}},{key:"createVisibleCalculators",value:function(){this.rowsVisibleCalculator=this.createRowsCalculator(!0);this.columnsVisibleCalculator=this.createColumnsCalculator(!0)}},{key:"areAllProposedVisibleRowsAlreadyRendered",value:function(n){return this.rowsVisibleCalculator?n.startRow<this.rowsRenderCalculator.startRow||n.startRow===this.rowsRenderCalculator.startRow&&n.startRow>0?!1:n.endRow>this.rowsRenderCalculator.endRow||n.endRow===this.rowsRenderCalculator.endRow&&n.endRow<this.wot.getSetting("totalRows")-1?!1:!0:!1}},{key:"areAllProposedVisibleColumnsAlreadyRendered",value:function(n){return this.columnsVisibleCalculator?n.startColumn<this.columnsRenderCalculator.startColumn||n.startColumn===this.columnsRenderCalculator.startColumn&&n.startColumn>0?!1:n.endColumn>this.columnsRenderCalculator.endColumn||n.endColumn===this.columnsRenderCalculator.endColumn&&n.endColumn<this.wot.getSetting("totalColumns")-1?!1:!0:!1}},{key:"resetHasOversizedColumnHeadersMarked",value:function(){o.objectEach(this.hasOversizedColumnHeadersMarked,function(n,t,i){i[t]=void 0})}}]),n}();t.default=f},function(n,t,i){"use strict";function e(n){return n&&n.__esModule?n:{"default":n}}function w(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var h;t.__esModule=!0;var f=function(){function n(n,t){var r=[],u=!0,f=!1,e=undefined,i,o;try{for(i=n[Symbol.iterator]();!(u=(o=i.next()).done);u=!0)if(r.push(o.value),t&&r.length===t)break}catch(s){f=!0;e=s}finally{try{!u&&i["return"]&&i["return"]()}finally{if(f)throw e;}}return r}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return n(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance");}}(),c=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),r=i(2),l=i(11),o=i(1),u=i(33),a=i(9),v=e(a),y=i(61),s=e(y),p=i(30),b=e(p);h=function(){function n(t,i){(w(this,n),i)&&(this.eventManager=new v.default(t),this.instance=t,this.wot=t,this.settings=i,this.mouseDown=!1,this.main=null,this.top=null,this.left=null,this.bottom=null,this.right=null,this.topStyle=null,this.leftStyle=null,this.bottomStyle=null,this.rightStyle=null,this.cornerDefaultStyle={width:"5px",height:"5px",borderWidth:"2px",borderStyle:"solid",borderColor:"#FFF"},this.corner=null,this.cornerStyle=null,this.createBorders(i),this.registerListeners())}return c(n,[{key:"registerListeners",value:function(){var n=this,r,t,i;for(this.eventManager.addEventListener(document.body,"mousedown",function(){return n.onMouseDown()}),this.eventManager.addEventListener(document.body,"mouseup",function(){return n.onMouseUp()}),r=function(t){n.eventManager.addEventListener(n.main.childNodes[t],"mouseenter",function(i){return n.onMouseEnter(i,n.main.childNodes[t])})},t=0,i=this.main.childNodes.length;t<i;t++)r(t,i)}},{key:"onMouseDown",value:function(){this.mouseDown=!0}},{key:"onMouseUp",value:function(){this.mouseDown=!1}},{key:"onMouseEnter",value:function(n,t){function f(n){return n.clientY<Math.floor(i.top)?!0:n.clientY>Math.ceil(i.top+i.height)?!0:n.clientX<Math.floor(i.left)?!0:n.clientX>Math.ceil(i.left+i.width)?!0:void 0}function r(n){f(n)&&(u.eventManager.removeEventListener(document.body,"mousemove",r),t.style.display="block")}if(this.mouseDown&&this.wot.getSetting("hideBorderOnMouseDownOver")){n.preventDefault();l.stopImmediatePropagation(n);var u=this,i=t.getBoundingClientRect();t.style.display="none";this.eventManager.addEventListener(document.body,"mousemove",r)}}},{key:"createBorders",value:function(n){var e,i,f,t,r;for(this.main=document.createElement("div"),e=["top","left","bottom","right","corner"],i=this.main.style,i.position="absolute",i.top=0,i.left=0,f=0;f<5;f++)t=e[f],r=document.createElement("div"),r.className="wtBorder "+(this.settings.className||""),this.settings[t]&&this.settings[t].hide&&(r.className+=" hidden"),i=r.style,i.backgroundColor=this.settings[t]&&this.settings[t].color?this.settings[t].color:n.border.color,i.height=this.settings[t]&&this.settings[t].width?this.settings[t].width+"px":n.border.width+"px",i.width=this.settings[t]&&this.settings[t].width?this.settings[t].width+"px":n.border.width+"px",this.main.appendChild(r);this.top=this.main.childNodes[0];this.left=this.main.childNodes[1];this.bottom=this.main.childNodes[2];this.right=this.main.childNodes[3];this.topStyle=this.top.style;this.leftStyle=this.left.style;this.bottomStyle=this.bottom.style;this.rightStyle=this.right.style;this.corner=this.main.childNodes[4];this.corner.className+=" corner";this.cornerStyle=this.corner.style;this.cornerStyle.width=this.cornerDefaultStyle.width;this.cornerStyle.height=this.cornerDefaultStyle.height;this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" ");u.isMobileBrowser()&&this.createMultipleSelectorHandles();this.disappear();this.wot.wtTable.bordersHolder||(this.wot.wtTable.bordersHolder=document.createElement("div"),this.wot.wtTable.bordersHolder.className="htBorders",this.wot.wtTable.spreader.appendChild(this.wot.wtTable.bordersHolder));this.wot.wtTable.bordersHolder.insertBefore(this.main,this.wot.wtTable.bordersHolder.firstChild)}},{key:"createMultipleSelectorHandles",value:function(){var u,f,i,n,r,t;this.selectionHandles={topLeft:document.createElement("DIV"),topLeftHitArea:document.createElement("DIV"),bottomRight:document.createElement("DIV"),bottomRightHitArea:document.createElement("DIV")};u=10;f=40;this.selectionHandles.topLeft.className="topLeftSelectionHandle";this.selectionHandles.topLeftHitArea.className="topLeftSelectionHandle-HitArea";this.selectionHandles.bottomRight.className="bottomRightSelectionHandle";this.selectionHandles.bottomRightHitArea.className="bottomRightSelectionHandle-HitArea";this.selectionHandles.styles={topLeft:this.selectionHandles.topLeft.style,topLeftHitArea:this.selectionHandles.topLeftHitArea.style,bottomRight:this.selectionHandles.bottomRight.style,bottomRightHitArea:this.selectionHandles.bottomRightHitArea.style};i={position:"absolute",height:f+"px",width:f+"px","border-radius":parseInt(f/1.5,10)+"px"};for(n in i)o.hasOwnProperty(i,n)&&(this.selectionHandles.styles.bottomRightHitArea[n]=i[n],this.selectionHandles.styles.topLeftHitArea[n]=i[n]);r={position:"absolute",height:u+"px",width:u+"px","border-radius":parseInt(u/1.5,10)+"px",background:"#F5F5FF",border:"1px solid #4285c8"};for(t in r)o.hasOwnProperty(r,t)&&(this.selectionHandles.styles.bottomRight[t]=r[t],this.selectionHandles.styles.topLeft[t]=r[t]);this.main.appendChild(this.selectionHandles.topLeft);this.main.appendChild(this.selectionHandles.bottomRight);this.main.appendChild(this.selectionHandles.topLeftHitArea);this.main.appendChild(this.selectionHandles.bottomRightHitArea)}},{key:"isPartRange",value:function(n,t){var i=this.wot.selections.createOrGetArea();return i.cellRange&&(n!=i.cellRange.to.row||t!=i.cellRange.to.col)?!0:!1}},{key:"updateMultipleSelectionHandlesPosition",value:function(n,t,i,r,u,f){var o=parseInt(this.selectionHandles.styles.topLeft.width,10),e=parseInt(this.selectionHandles.styles.topLeftHitArea.width,10);this.selectionHandles.styles.topLeft.top=parseInt(i-o,10)+"px";this.selectionHandles.styles.topLeft.left=parseInt(r-o,10)+"px";this.selectionHandles.styles.topLeftHitArea.top=parseInt(i-e/4*3,10)+"px";this.selectionHandles.styles.topLeftHitArea.left=parseInt(r-e/4*3,10)+"px";this.selectionHandles.styles.bottomRight.top=parseInt(i+f,10)+"px";this.selectionHandles.styles.bottomRight.left=parseInt(r+u,10)+"px";this.selectionHandles.styles.bottomRightHitArea.top=parseInt(i+f-e/4,10)+"px";this.selectionHandles.styles.bottomRightHitArea.left=parseInt(r+u-e/4,10)+"px";this.settings.border.multipleSelectionHandlesVisible&&this.settings.border.multipleSelectionHandlesVisible()?(this.selectionHandles.styles.topLeft.display="block",this.selectionHandles.styles.topLeftHitArea.display="block",this.isPartRange(n,t)?(this.selectionHandles.styles.bottomRight.display="none",this.selectionHandles.styles.bottomRightHitArea.display="none"):(this.selectionHandles.styles.bottomRight.display="block",this.selectionHandles.styles.bottomRightHitArea.display="block")):(this.selectionHandles.styles.topLeft.display="none",this.selectionHandles.styles.bottomRight.display="none",this.selectionHandles.styles.topLeftHitArea.display="none",this.selectionHandles.styles.bottomRightHitArea.display="none");n==this.wot.wtSettings.getSetting("fixedRowsTop")||t==this.wot.wtSettings.getSetting("fixedColumnsLeft")?(this.selectionHandles.styles.topLeft.zIndex="9999",this.selectionHandles.styles.topLeftHitArea.zIndex="9999"):(this.selectionHandles.styles.topLeft.zIndex="",this.selectionHandles.styles.topLeftHitArea.zIndex="")}},{key:"appear",value:function(n){var w,b,k,d,st,g,nt,tt,it,ct,ut,ft,e,t,lt,et,ot,at,vt,y,pt,wt,ri,ui;if(!this.disabled){var l=void 0,h=void 0,a=void 0,c=void 0,bt=this.wot.wtTable.getRenderedRowsCount();for(w=0;w<bt;w+=1)if(b=this.wot.wtTable.rowFilter.renderedToSource(w),b>=n[0]&&b<=n[2]){l=b;break}for(k=bt-1;k>=0;k-=1)if(d=this.wot.wtTable.rowFilter.renderedToSource(k),d>=n[0]&&d<=n[2]){h=d;break}for(st=this.wot.wtTable.getRenderedColumnsCount(),g=0;g<st;g+=1)if(nt=this.wot.wtTable.columnFilter.renderedToSource(g),nt>=n[1]&&nt<=n[3]){a=nt;break}for(tt=st-1;tt>=0;tt-=1)if(it=this.wot.wtTable.columnFilter.renderedToSource(tt),it>=n[1]&&it<=n[3]){c=it;break}if(l===void 0||a===void 0){this.disappear();return}var p=this.wot.wtTable.getCell(new s.default(l,a)),kt=l!==h||a!==c,v=kt?this.wot.wtTable.getCell(new s.default(h,c)):p,ht=r.offset(p),dt=kt?r.offset(v):ht,rt=r.offset(this.wot.wtTable.TABLE),gt=ht.top,ni=ht.left,o=ni-rt.left-1,i=dt.left+r.outerWidth(v)-ni;this.isEntireColumnSelected(l,h)&&(ct=this.getDimensionsFromHeader("columns",a,c,rt),ut=null,ct&&(ft=f(ct,3),ut=ft[0],o=ft[1],i=ft[2]),ut&&(p=ut));e=gt-rt.top-1;t=dt.top+r.outerHeight(v)-gt;this.isEntireRowSelected(a,c)&&(lt=this.getDimensionsFromHeader("rows",l,h,rt),et=null,lt&&(ot=f(lt,3),et=ot[0],e=ot[1],t=ot[2]),et&&(p=et));at=r.getComputedStyle(p);parseInt(at.borderTopWidth,10)>0&&(e+=1,t=t>0?t-1:0);parseInt(at.borderLeftWidth,10)>0&&(o+=1,i=i>0?i-1:0);this.topStyle.top=e+"px";this.topStyle.left=o+"px";this.topStyle.width=i+"px";this.topStyle.display="block";this.leftStyle.top=e+"px";this.leftStyle.left=o+"px";this.leftStyle.height=t+"px";this.leftStyle.display="block";vt=Math.floor(this.settings.border.width/2);this.bottomStyle.top=e+t-vt+"px";this.bottomStyle.left=o+"px";this.bottomStyle.width=i+"px";this.bottomStyle.display="block";this.rightStyle.top=e+"px";this.rightStyle.left=o+i-vt+"px";this.rightStyle.height=t+1+"px";this.rightStyle.display="block";y=this.settings.border.cornerVisible;y=typeof y=="function"?y(this.settings.layerLevel):y;var yt=this.wot.getSetting("onModifyGetCellCoords",h,c),ti=h,ii=c;yt&&Array.isArray(yt)&&(pt=f(yt,4),ti=pt[2],ii=pt[3]);u.isMobileBrowser()||!y||this.isPartRange(ti,ii)?this.cornerStyle.display="none":(this.cornerStyle.top=e+t-4+"px",this.cornerStyle.left=o+i-4+"px",this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none",wt=r.getTrimmingContainer(this.wot.wtTable.TABLE),c===this.wot.getSetting("totalColumns")-1&&(ri=v.offsetLeft+r.outerWidth(v)+parseInt(this.cornerDefaultStyle.width,10)/2>=r.innerWidth(wt),ri&&(this.cornerStyle.left=Math.floor(o+i-3-parseInt(this.cornerDefaultStyle.width,10)/2)+"px",this.cornerStyle.borderRightWidth=0)),h===this.wot.getSetting("totalRows")-1&&(ui=v.offsetTop+r.outerHeight(v)+parseInt(this.cornerDefaultStyle.height,10)/2>=r.innerHeight(wt),ui&&(this.cornerStyle.top=Math.floor(e+t-3-parseInt(this.cornerDefaultStyle.height,10)/2)+"px",this.cornerStyle.borderBottomWidth=0)),this.cornerStyle.display="block");u.isMobileBrowser()&&this.updateMultipleSelectionHandlesPosition(l,a,e,o,i,t)}}},{key:"isEntireColumnSelected",value:function(n,t){return n===this.wot.wtTable.getFirstRenderedRow()&&t===this.wot.wtTable.getLastRenderedRow()}},{key:"isEntireRowSelected",value:function(n,t){return n===this.wot.wtTable.getFirstRenderedColumn()&&t===this.wot.wtTable.getLastRenderedColumn()}},{key:"getDimensionsFromHeader",value:function(n,t,i,u){var a=this,w=this.wot.wtTable.wtRootElement.parentNode,s=null,h=null,c=null,v=null,y=null,f=null,e=null,o=null,l,p;switch(n){case"rows":s=function(){var n;return(n=a.wot.wtTable).getRowHeader.apply(n,arguments)};h=function(){return r.outerHeight.apply(undefined,arguments)};c="ht__selection--rows";f="top";break;case"columns":s=function(){var n;return(n=a.wot.wtTable).getColumnHeader.apply(n,arguments)};h=function(){return r.outerWidth.apply(undefined,arguments)};c="ht__selection--columns";f="left"}return w.className.includes(c)?(e=s(t,0),o=s(i,0),!e||!o)?!1:(l=r.offset(e),p=r.offset(o),e&&o&&(v=l[f]-u[f]-1,y=p[f]+h(o)-l[f]),[e,v,y]):!1}},{key:"disappear",value:function(){this.topStyle.display="none";this.leftStyle.display="none";this.bottomStyle.display="none";this.rightStyle.display="none";this.cornerStyle.display="none";u.isMobileBrowser()&&(this.selectionHandles.styles.topLeft.display="none",this.selectionHandles.styles.bottomRight.display="none")}}]),n}();t.default=h},function(n,t,i){"use strict";function v(n){return n&&n.__esModule?n:{"default":n}}function l(n){var t,i;if(o=!1,t=this.getActiveEditor(),e.isPrintableChar(n.keyCode)||n.keyCode===e.KEY_CODES.BACKSPACE||n.keyCode===e.KEY_CODES.DELETE||n.keyCode===e.KEY_CODES.INSERT){if(i=0,n.keyCode===e.KEY_CODES.C&&(n.ctrlKey||n.metaKey))return;t.isOpened()||(i+=10);t.htEditor&&t.instance._registerTimeout(setTimeout(function(){t.queryChoices(t.TEXTAREA.value);o=!0},i))}}var r,o;t.__esModule=!0;var e=i(18),s=i(13),c=i(31),h=i(0),u=i(2),a=i(323),f=v(a);r=f.default.prototype.extend();r.prototype.init=function(){f.default.prototype.init.apply(this,arguments);this.query=null;this.strippedChoices=[];this.rawChoices=[]};r.prototype.getValue=function(){var n=this,t=this.rawChoices.find(function(t){var i=n.stripValueIfNeeded(t);return i===n.TEXTAREA.value});return s.isDefined(t)?t:this.TEXTAREA.value};r.prototype.createElements=function(){f.default.prototype.createElements.apply(this,arguments);u.addClass(this.htContainer,"autocompleteEditor");u.addClass(this.htContainer,window.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll")};o=!1;r.prototype.prepare=function(){this.instance.addHook("beforeKeyDown",l);f.default.prototype.prepare.apply(this,arguments)};r.prototype.open=function(){this.TEXTAREA_PARENT.style.overflow="auto";f.default.prototype.open.apply(this,arguments);this.TEXTAREA_PARENT.style.overflow="";var i=this.htEditor.getInstance(),n=this,t=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown;this.TEXTAREA.style.visibility="visible";this.focus();i.updateSettings({colWidths:t?[u.outerWidth(this.TEXTAREA)-2]:void 0,width:t?u.outerWidth(this.TEXTAREA)+u.getScrollbarWidth()+2:void 0,afterRenderer:function(t,i,r,u,f){var h=n.cellProperties,c=h.filteringCaseSensitive,l=h.allowHtml,e=void 0,o=void 0;f=s.stringify(f);f&&!l&&(e=c===!0?f.indexOf(this.query):f.toLowerCase().indexOf(n.query.toLowerCase()),e!==-1&&(o=f.substr(e,n.query.length),f=f.replace(o,"<strong>"+o+"<\/strong>")));t.innerHTML=f},autoColumnSize:!0,modifyColWidth:function(n,i){var r=this.getPlugin("autoColumnSize").widths;return r[i]&&(n=r[i]),t?n:n+15}});this.htEditor.view.wt.wtTable.holder.parentNode.style["padding-right"]=u.getScrollbarWidth()+2+"px";o&&(o=!1);n.instance._registerTimeout(setTimeout(function(){n.queryChoices(n.TEXTAREA.value)},0))};r.prototype.close=function(){f.default.prototype.close.apply(this,arguments)};r.prototype.queryChoices=function(n){var i=this,t;this.query=n;t=this.cellProperties.source;typeof t=="function"?t.call(this.cellProperties,n,function(n){i.rawChoices=n;i.updateChoicesList(i.stripValuesIfNeeded(n))}):Array.isArray(t)?(this.rawChoices=t,this.updateChoicesList(this.stripValuesIfNeeded(t))):this.updateChoicesList([])};r.prototype.updateChoicesList=function(n){var s=u.getCaretPosition(this.TEXTAREA),c=u.getSelectionEndPosition(this.TEXTAREA),l=this.cellProperties.sortByRelevance,v=this.cellProperties.filter,i=null,o=null,f,e,t,a;if(l&&(i=r.sortByRelevance(this.stripValueIfNeeded(this.getValue()),n,this.cellProperties.filteringCaseSensitive)),f=Array.isArray(i)?i.length:0,v===!1)f&&(o=i[0]);else{for(e=[],t=0,a=n.length;t<a;t++){if(l&&f<=t)break;f?e.push(n[i[t]]):e.push(n[t])}o=0;n=e}this.strippedChoices=n;this.htEditor.loadData(h.pivot([n]));this.updateDropdownHeight();this.flipDropdownIfNeeded();this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(o);this.instance.listen(!1);u.setCaretPosition(this.TEXTAREA,s,s===c?void 0:c)};r.prototype.flipDropdownIfNeeded=function(){var s=u.offset(this.TEXTAREA),h=u.outerHeight(this.TEXTAREA),t=this.getDropdownHeight(),n=u.getTrimmingContainer(this.instance.view.wt.wtTable.TABLE),c=n.scrollTop,e=u.outerHeight(this.instance.view.wt.wtTable.THEAD),o={row:0,col:0};n!==window&&(o=u.offset(n));var i=s.top-o.top-e+c,r=n.scrollHeight-i-e-h,f=t>r&&i>r;return f?this.flipDropdown(t):this.unflipDropdown(),this.limitDropdownIfNeeded(f?i:r,t),f};r.prototype.limitDropdownIfNeeded=function(n,t){if(t>n){var i=0,u=0,r=0,f=null;do r=this.htEditor.getRowHeight(u)||this.htEditor.view.wt.wtSettings.settings.defaultRowHeight,i+=r,u++;while(i<n);f=i-r;this.htEditor.flipped&&(this.htEditor.rootElement.style.top=parseInt(this.htEditor.rootElement.style.top,10)+t-f+"px");this.setDropdownHeight(i-r)}};r.prototype.flipDropdown=function(n){var t=this.htEditor.rootElement.style;t.position="absolute";t.top=-n+"px";this.htEditor.flipped=!0};r.prototype.unflipDropdown=function(){var n=this.htEditor.rootElement.style;n.position==="absolute"&&(n.position="",n.top="");this.htEditor.flipped=void 0};r.prototype.updateDropdownHeight=function(){var n=this.htEditor.getColWidth(0)+u.getScrollbarWidth()+2,t=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:t?void 0:n});this.htEditor.view.wt.wtTable.alignOverlaysWithTrimmingContainer()};r.prototype.setDropdownHeight=function(n){this.htEditor.updateSettings({height:n})};r.prototype.finishEditing=function(n){n||this.instance.removeHook("beforeKeyDown",l);f.default.prototype.finishEditing.apply(this,arguments)};r.prototype.highlightBestMatchingChoice=function(n){typeof n=="number"?this.htEditor.selectCell(n,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()};r.sortByRelevance=function(n,t,i){var f=[],u=void 0,l=n.length,e=void 0,a=void 0,o=[],r=void 0,h=t.length;if(l===0){for(r=0;r<h;r++)o.push(r);return o}for(r=0;r<h;r++)u=c.stripTags(s.stringify(t[r])),e=i?u.indexOf(n):u.toLowerCase().indexOf(n.toLowerCase()),e!==-1&&(a=u.length-e-l,f.push({baseIndex:r,index:e,charsLeft:a,value:u}));for(f.sort(function(n,t){if(t.index===-1)return-1;if(n.index===-1)return 1;if(n.index<t.index)return-1;if(t.index<n.index)return 1;if(n.index===t.index){if(n.charsLeft<t.charsLeft)return-1;if(n.charsLeft>t.charsLeft)return 1}return 0}),r=0,h=f.length;r<h;r++)o.push(f[r].baseIndex);return o};r.prototype.getDropdownHeight=function(){var n=this.htEditor.getInstance().getRowHeight(0)||23,t=this.cellProperties.visibleRows;return this.strippedChoices.length>=t?t*n:this.strippedChoices.length*n+8};r.prototype.stripValueIfNeeded=function(n){return this.stripValuesIfNeeded([n])[0]};r.prototype.stripValuesIfNeeded=function(n){var t=this.cellProperties.allowHtml,i=h.arrayMap(n,function(n){return s.stringify(n)});return h.arrayMap(i,function(n){return t?n:c.stripTags(n)})};r.prototype.allowKeyEventPropagation=function(n){var r=this.htEditor.getSelectedRangeLast(),t={row:r?r.from.row:-1},i=!1;return n===e.KEY_CODES.ARROW_DOWN&&t.row>0&&t.row<this.htEditor.countRows()-1&&(i=!0),n===e.KEY_CODES.ARROW_UP&&t.row>-1&&(i=!0),i};r.prototype.discardEditor=function(){f.default.prototype.discardEditor.apply(this,arguments);this.instance.view.render()};t.default=r},function(n,t,i){"use strict";function l(n){return n&&n.__esModule?n:{"default":n}}var r,f;t.__esModule=!0;var e=i(18),s=i(1),h=i(2),o=i(11),c=i(62),u=l(c);r=u.default.prototype.extend();r.prototype.createElements=function(){u.default.prototype.createElements.apply(this,arguments);var n=document.createElement("DIV");n.className="handsontableEditor";this.TEXTAREA_PARENT.appendChild(n);this.htContainer=n;this.assignHooks()};r.prototype.prepare=function(n,t,i,r,f,e){u.default.prototype.prepare.apply(this,arguments);var o=this,h={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,afterOnCellMouseDown:function(n,t){var i=this.getSourceData(t.row,t.col);i!==void 0&&o.setValue(i);o.instance.destroyEditor()}};this.cellProperties.handsontable&&s.extend(h,e.handsontable);this.htOptions=h};f=function(n){var u,t,i,r,f;o.isImmediatePropagationStopped(n)||(u=this.getActiveEditor(),t=u.htEditor.getInstance(),n.keyCode==e.KEY_CODES.ARROW_DOWN?t.getSelectedLast()||t.flipped?t.getSelectedLast()&&(t.flipped?i=t.getSelectedLast()[0]+1:t.flipped||(r=t.getSelectedLast()[0],f=t.countRows()-1,i=Math.min(f,r+1))):i=0:n.keyCode==e.KEY_CODES.ARROW_UP&&(!t.getSelectedLast()&&t.flipped?i=t.countRows()-1:t.getSelectedLast()&&(t.flipped?(r=t.getSelectedLast()[0],i=Math.max(0,r-1)):(r=t.getSelectedLast()[0],i=r-1))),i!==void 0&&(i<0||t.flipped&&i>t.countRows()-1?t.deselectCell():t.selectCell(i,0),t.getData().length&&(n.preventDefault(),o.stopImmediatePropagation(n),u.instance.listen(),u.TEXTAREA.focus())))};r.prototype.open=function(){this.instance.addHook("beforeKeyDown",f);u.default.prototype.open.apply(this,arguments);this.htEditor&&this.htEditor.destroy();this.htEditor=new this.instance.constructor(this.htContainer,this.htOptions);this.htEditor.init();this.cellProperties.strict?(this.htEditor.selectCell(0,0),this.TEXTAREA.style.visibility="hidden"):(this.htEditor.deselectCell(),this.TEXTAREA.style.visibility="visible");h.setCaretPosition(this.TEXTAREA,0,this.TEXTAREA.value.length)};r.prototype.close=function(){this.instance.removeHook("beforeKeyDown",f);this.instance.listen();u.default.prototype.close.apply(this,arguments)};r.prototype.focus=function(){this.instance.listen();u.default.prototype.focus.apply(this,arguments)};r.prototype.beginEditing=function(){var n=this.instance.getSettings().onBeginEditing;n&&n()===!1||u.default.prototype.beginEditing.apply(this,arguments)};r.prototype.finishEditing=function(){if(this.htEditor&&this.htEditor.isListening()&&this.instance.listen(),this.htEditor&&this.htEditor.getSelectedLast()){var n=this.htEditor.getInstance().getValue();n!==void 0&&this.setValue(n)}return u.default.prototype.finishEditing.apply(this,arguments)};r.prototype.assignHooks=function(){var n=this;this.instance.addHook("afterDestroy",function(){n.htEditor&&n.htEditor.destroy()})};t.default=r},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(n,t,i){var u,r;
/*!
 * numbro.js
 * version : 1.11.0
 * author : Företagsplatsen AB
 * license : MIT
 * http://www.foretagsplatsen.se
 */
(function(){"use strict";function d(n){this._value=n}function rt(n){return n===0?1:Math.floor(Math.log(Math.abs(n))/Math.LN10)+1}function c(n){for(var i="",t=0;t<n;t++)i+="0";return i}function st(n,t){var e,u,f,r,o,s,h,i;return i=n.toString(),e=i.split("e")[0],r=i.split("e")[1],u=e.split(".")[0],f=e.split(".")[1]||"",+r>0?i=u+f+c(r-f.length):(o=+u<0?"-0":"0",t>0&&(o+="."),h=c(-1*r-1),s=(h+Math.abs(u)+f).substr(0,t),i=o+s),+r>0&&t>0&&(i+="."+c(t)),i}function a(n,t,i,r){var e=Math.pow(10,t),f,u;return n.toString().indexOf("e")>-1?(u=st(n,t),u.charAt(0)==="-"&&+u>=0&&(u=u.substr(1))):u=(i(n+"e+"+t)/e).toFixed(t),r&&(f=new RegExp("0{1,"+r+"}$"),u=u.replace(f,"")),u}function ht(n,t,i){var r=t.replace(/\{[^\{\}]*\}/g,"");return r.indexOf("$")>-1?g(n,e[o].currency.symbol,t,i):r.indexOf("%")>-1?at(n,t,i):r.indexOf(":")>-1?vt(n,t):nt(n._value,t,i)}function ct(n,t){var u=t,s,h,c,a,r=!1,i,f;if(t.indexOf(":")>-1)n._value=yt(t);else if(t===l)n._value=0;else{for(e[o].delimiters.decimal!=="."&&(t=t.replace(/\./g,"").replace(e[o].delimiters.decimal,".")),s=new RegExp("[^a-zA-Z]"+e[o].abbreviations.thousand+"(?:\\)|(\\"+e[o].currency.symbol+")?(?:\\))?)?$"),h=new RegExp("[^a-zA-Z]"+e[o].abbreviations.million+"(?:\\)|(\\"+e[o].currency.symbol+")?(?:\\))?)?$"),c=new RegExp("[^a-zA-Z]"+e[o].abbreviations.billion+"(?:\\)|(\\"+e[o].currency.symbol+")?(?:\\))?)?$"),a=new RegExp("[^a-zA-Z]"+e[o].abbreviations.trillion+"(?:\\)|(\\"+e[o].currency.symbol+")?(?:\\))?)?$"),i=1;i<w.length&&!r;++i)t.indexOf(w[i])>-1?r=Math.pow(1024,i):t.indexOf(b[i])>-1&&(r=Math.pow(1e3,i));f=t.replace(/[^0-9\.]+/g,"");f===""?n._value=NaN:(n._value=(r?r:1)*(u.match(s)?Math.pow(10,3):1)*(u.match(h)?Math.pow(10,6):1)*(u.match(c)?Math.pow(10,9):1)*(u.match(a)?Math.pow(10,12):1)*(t.indexOf("%")>-1?.01:1)*((t.split("-").length+Math.min(t.split("(").length-1,t.split(")").length-1))%2?1:-1)*Number(f),n._value=r?Math.ceil(n._value):n._value)}return n._value}function g(n,t,i,r){var f=i,c=f.indexOf("$"),a=f.indexOf("("),y=f.indexOf("+"),v=f.indexOf("-"),s="",l="",h,u;if(f.indexOf("$")===-1?e[o].currency.position==="infix"?(l=t,e[o].currency.spaceSeparated&&(l=" "+l+" ")):e[o].currency.spaceSeparated&&(s=" "):f.indexOf(" $")>-1?(s=" ",f=f.replace(" $","")):f.indexOf("$ ")>-1?(s=" ",f=f.replace("$ ","")):f=f.replace("$",""),u=nt(n._value,f,r,l),i.indexOf("$")===-1)switch(e[o].currency.position){case"postfix":u.indexOf(")")>-1?(u=u.split(""),u.splice(-1,0,s+t),u=u.join("")):u=u+s+t;break;case"infix":break;case"prefix":u.indexOf("(")>-1||u.indexOf("-")>-1?(u=u.split(""),h=Math.max(a,v)+1,u.splice(h,0,t+s),u=u.join("")):u=t+s+u;break;default:throw Error('Currency position should be among ["prefix", "infix", "postfix"]');}else c<=1?u.indexOf("(")>-1||u.indexOf("+")>-1||u.indexOf("-")>-1?(u=u.split(""),h=1,(c<a||c<y||c<v)&&(h=0),u.splice(h,0,t+s),u=u.join("")):u=t+s+u:u.indexOf(")")>-1?(u=u.split(""),u.splice(-1,0,s+t),u=u.join("")):u=u+s+t;return u}function lt(n,t,i,r){return g(n,t,i,r)}function at(n,t,i){var u="",r,f=n._value*100;return t.indexOf(" %")>-1?(u=" ",t=t.replace(" %","")):t=t.replace("%",""),r=nt(f,t,i),r.indexOf(")")>-1?(r=r.split(""),r.splice(-1,0,u+"%"),r=r.join("")):r=r+u+"%",r}function vt(n){var i=Math.floor(n._value/3600),t=Math.floor((n._value-i*3600)/60),r=Math.round(n._value-i*3600-t*60);return i+":"+(t<10?"0"+t:t)+":"+(r<10?"0"+r:r)}function yt(n){var i=n.split(":"),t=0;return i.length===3?(t=t+Number(i[0])*3600,t=t+Number(i[1])*60,t=t+Number(i[2])):i.length===2&&(t=t+Number(i[0])*60,t=t+Number(i[1])),Number(t)}function v(n,t,i){var u=t[0],r,f,o,e=Math.abs(n);if(e>=i){for(r=1;r<t.length;++r)if(f=Math.pow(i,r),o=Math.pow(i,r+1),e>=f&&e<o){u=t[r];n=n/f;break}u===t[0]&&(n=n/Math.pow(i,t.length-1),u=t[t.length-1])}return{value:n,suffix:u}}function nt(n,t,i,r){var k=!1,gt=!1,ni=!1,f="",ht=!1,ct=!1,lt=!1,at=!1,nt=!1,d="",g,vt,it="",y=Math.abs(n),ft,yt,ut,ti,u,p,s,pt,wt,ii,h="",bt=!1,w=!1,ri,ui,fi="",kt,et,ot,st,dt,b,ei;if(n===0&&l!==null)return l;if(!isFinite(n))return""+n;if(t.indexOf("{")===0){if(ot=t.indexOf("}"),ot===-1)throw Error('Format should also contain a "}"');pt=t.slice(1,ot);t=t.slice(ot+1)}else pt="";if(t.indexOf("}")===t.length-1&&t.length){if(st=t.indexOf("{"),st===-1)throw Error('Format should also contain a "{"');wt=t.slice(st+1,-1);t=t.slice(0,st+1)}else wt="";for(dt=t.indexOf(".")===-1?t.match(/([0-9]+).*/):t.match(/([0-9]+)\..*/),kt=dt===null?-1:dt[1].length,t.indexOf("-")!==-1&&(bt=!0),t.indexOf("(")>-1?(k=!0,t=t.slice(1,-1)):t.indexOf("+")>-1&&(gt=!0,t=t.replace(/\+/g,"")),t.indexOf("a")>-1&&(p=t.split(".")[0].match(/[0-9]+/g)||["0"],p=parseInt(p[0],10),ht=t.indexOf("aK")>=0,ct=t.indexOf("aM")>=0,lt=t.indexOf("aB")>=0,at=t.indexOf("aT")>=0,nt=ht||ct||lt||at,t.indexOf(" a")>-1?(f=" ",t=t.replace(" a","")):t=t.replace("a",""),ft=rt(n),ut=ft%3,ut=ut===0?3:ut,p&&y!==0&&(ti=3*~~((Math.min(p,ft)-ut)/3),y=y/Math.pow(10,ti)),ft!==p&&(y>=Math.pow(10,12)&&!nt||at?(f=f+e[o].abbreviations.trillion,n=n/Math.pow(10,12)):y<Math.pow(10,12)&&y>=Math.pow(10,9)&&!nt||lt?(f=f+e[o].abbreviations.billion,n=n/Math.pow(10,9)):y<Math.pow(10,9)&&y>=Math.pow(10,6)&&!nt||ct?(f=f+e[o].abbreviations.million,n=n/Math.pow(10,6)):(y<Math.pow(10,6)&&y>=Math.pow(10,3)&&!nt||ht)&&(f=f+e[o].abbreviations.thousand,n=n/Math.pow(10,3))),yt=rt(n),p&&yt<p&&t.indexOf(".")===-1&&(t+="[.]",t+=c(p-yt))),et=0;et<tt.length;++et)if(g=tt[et],t.indexOf(g.marker)>-1){t.indexOf(" "+g.marker)>-1&&(d=" ");t=t.replace(d+g.marker,"");vt=v(n,g.suffixes,g.scale);n=vt.value;d=d+vt.suffix;break}return t.indexOf("o")>-1&&(t.indexOf(" o")>-1?(it=" ",t=t.replace(" o","")):t=t.replace("o",""),e[o].ordinal&&(it=it+e[o].ordinal(n))),t.indexOf("[.]")>-1&&(ni=!0,t=t.replace("[.]",".")),s=t.split(".")[1],ii=t.indexOf(","),s?(b=[],s.indexOf("*")!==-1?(h=n.toString(),b=h.split("."),b.length>1&&(h=a(n,b[1].length,i))):s.indexOf("[")>-1?(s=s.replace("]",""),s=s.split("["),h=a(n,s[0].length+s[1].length,i,s[1].length)):h=a(n,s.length,i),b=h.split("."),u=b[0],b.length>1&&b[1].length?(ei=r?f+r:e[o].delimiters.decimal,h=ei+b[1]):h="",ni&&Number(h.slice(1))===0&&(h="")):u=a(n,0,i),u.indexOf("-")>-1&&(u=u.slice(1),w=!0),u.length<kt&&(u=c(kt-u.length)+u),ii>-1&&(u=u.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+e[o].delimiters.thousands)),t.indexOf(".")===0&&(u=""),ri=t.indexOf("("),ui=t.indexOf("-"),fi=ri<ui?(k&&w?"(":"")+(bt&&w||!k&&w?"-":""):(bt&&w||!k&&w?"-":"")+(k&&w?"(":""),pt+fi+(!w&&gt&&n!==0?"+":"")+u+h+(it?it:"")+(f&&!r?f:"")+(d?d:"")+(k&&w?")":"")+wt}function ut(n,t){e[n]=t}function y(n){o=n;var t=e[n].defaults;t&&t.format&&f.defaultFormat(t.format);t&&t.currencyFormat&&f.defaultCurrencyFormat(t.currencyFormat)}function pt(){return typeof process!="undefined"&&process.browser===undefined&&process.title&&(process.title.indexOf("node")!==-1||process.title.indexOf("meteor-tool")>0||process.title==="grunt"||process.title==="gulp")&&!0}function ft(n){var t=n.toString().split(".");return t.length<2?1:Math.pow(10,t[1].length)}function p(){var n=Array.prototype.slice.call(arguments);return n.reduce(function(n,t){var i=ft(n),r=ft(t);return i>r?i:r},-Infinity)}var f,w=["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],b=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],s={general:{scale:1024,suffixes:b,marker:"bd"},binary:{scale:1024,suffixes:w,marker:"b"},decimal:{scale:1e3,suffixes:b,marker:"d"}},tt=[s.general,s.binary,s.decimal],e={},h=e,o="en-US",l=null,it="0,0",k="0$",et=typeof n!="undefined"&&n.exports,ot={delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(n){var t=n%10;return~~(n%100/10)==1?"th":t===1?"st":t===2?"nd":t===3?"rd":"th"},currency:{symbol:"$",position:"prefix"},defaults:{currencyFormat:",0000 a"},formats:{fourDigits:"0000 a",fullWithTwoDecimals:"$ ,0.00",fullWithTwoDecimalsNoCurrency:",0.00"}};f=function(n){return n=f.isNumbro(n)?n.value():typeof n=="string"||typeof n=="number"?f.fn.unformat(n):NaN,new d(Number(n))};f.version="1.11.0";f.isNumbro=function(n){return n instanceof d};f.setLanguage=function(n,t){console.warn("`setLanguage` is deprecated since version 1.6.0. Use `setCulture` instead");var i=n,u=n.split("-")[0],r=null;h[i]||(Object.keys(h).forEach(function(n){r||n.split("-")[0]!==u||(r=n)}),i=r||t||"en-US");y(i)};f.setCulture=function(n,t){var i=n,u=n.split("-")[1],r=null;e[i]||(u&&Object.keys(e).forEach(function(n){r||n.split("-")[1]!==u||(r=n)}),i=r||t||"en-US");y(i)};f.language=function(n,t){if(console.warn("`language` is deprecated since version 1.6.0. Use `culture` instead"),!n)return o;if(n&&!t){if(!h[n])throw new Error("Unknown language : "+n);y(n)}return(t||!h[n])&&ut(n,t),f};f.culture=function(n,t){if(!n)return o;if(n&&!t){if(!e[n])throw new Error("Unknown culture : "+n);y(n)}return(t||!e[n])&&ut(n,t),f};f.languageData=function(n){if(console.warn("`languageData` is deprecated since version 1.6.0. Use `cultureData` instead"),!n)return h[o];if(!h[n])throw new Error("Unknown language : "+n);return h[n]};f.cultureData=function(n){if(!n)return e[o];if(!e[n])throw new Error("Unknown culture : "+n);return e[n]};f.culture("en-US",ot);f.languages=function(){return console.warn("`languages` is deprecated since version 1.6.0. Use `cultures` instead"),h};f.cultures=function(){return e};f.zeroFormat=function(n){l=typeof n=="string"?n:null};f.defaultFormat=function(n){it=typeof n=="string"?n:"0.0"};f.defaultCurrencyFormat=function(n){k=typeof n=="string"?n:"0$"};f.validate=function(n,t){var s,h,c,i,e,o,u,r;if(typeof n!="string"&&(n+="",console.warn&&console.warn("Numbro.js: Value is not string. It has been co-erced to: ",n)),n=n.trim(),n=n.replace(/^[+-]?/,""),!!n.match(/^\d+$/))return!0;if(n==="")return!1;try{u=f.cultureData(t)}catch(l){u=f.cultureData(f.culture())}return(c=u.currency.symbol,e=u.abbreviations,s=u.delimiters.decimal,h=u.delimiters.thousands==="."?"\\.":u.delimiters.thousands,r=n.match(/^[^\d\.\,]+/),r!==null&&(n=n.substr(1),r[0]!==c))?!1:(r=n.match(/[^\d]+$/),r!==null&&(n=n.slice(0,-1),r[0]!==e.thousand&&r[0]!==e.million&&r[0]!==e.billion&&r[0]!==e.trillion))?!1:(o=new RegExp(h+"{2}"),!n.match(/[^\d.,]/g))?(i=n.split(s),i.length>2?!1:i.length<2?!!i[0].match(/^\d+.*\d$/)&&!i[0].match(o):i[0]===""?!i[0].match(o)&&!!i[1].match(/^\d+$/):i[0].length===1?!!i[0].match(/^\d+$/)&&!i[0].match(o)&&!!i[1].match(/^\d+$/):!!i[0].match(/^\d+.*\d$/)&&!i[0].match(o)&&!!i[1].match(/^\d+$/)):!1};f.loadLanguagesInNode=function(){console.warn("`loadLanguagesInNode` is deprecated since version 1.6.0. Use `loadCulturesInNode` instead");f.loadCulturesInNode()};f.loadCulturesInNode=function(){var t=i(521);for(var n in t)n&&f.culture(n,t[n])};"function"!=typeof Array.prototype.reduce&&(Array.prototype.reduce=function(n,t){if(null===this||"undefined"==typeof this)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!=typeof n)throw new TypeError(n+" is not a function");var i,r,f=this.length>>>0,u=!1;for(1<arguments.length&&(r=t,u=!0),i=0;f>i;++i)this.hasOwnProperty(i)&&(u?r=n(r,this[i],i,this):(r=this[i],u=!0));if(!u)throw new TypeError("Reduce of empty array with no initial value");return r});f.fn=d.prototype={clone:function(){return f(this)},format:function(n,t){return ht(this,n?n:it,t!==undefined?t:Math.round)},formatCurrency:function(n,t){return g(this,e[o].currency.symbol,n?n:k,t!==undefined?t:Math.round)},formatForeignCurrency:function(n,t,i){return lt(this,n,t?t:k,i!==undefined?i:Math.round)},unformat:function(n){if(typeof n=="number")return n;if(typeof n=="string"){var t=ct(this,n);return isNaN(t)?undefined:t}return undefined},binaryByteUnits:function(){return v(this._value,s.binary.suffixes,s.binary.scale).suffix},byteUnits:function(){return v(this._value,s.general.suffixes,s.general.scale).suffix},decimalByteUnits:function(){return v(this._value,s.decimal.suffixes,s.decimal.scale).suffix},value:function(){return this._value},valueOf:function(){return this._value},set:function(n){return this._value=Number(n),this},add:function(n){function i(n,i){return n+t*i}var t=p.call(null,this._value,n);return this._value=[this._value,n].reduce(i,0)/t,this},subtract:function(n){function i(n,i){return n-t*i}var t=p.call(null,this._value,n);return this._value=[n].reduce(i,this._value*t)/t,this},multiply:function(n){function t(n,t){var i=p(n,t),r=n*i;return r*=t*i,r/(i*i)}return this._value=[this._value,n].reduce(t,1),this},divide:function(n){function t(n,t){var i=p(n,t);return n*i/(t*i)}return this._value=[this._value,n].reduce(t),this},difference:function(n){return Math.abs(f(this._value).subtract(n).value())}};pt()&&f.loadCulturesInNode();et?n.exports=f:(typeof ender=="undefined"&&(this.numbro=f),!0&&!(u=[],r=function(){return f}.apply(t,u),r!==undefined&&(n.exports=r)))}).call(typeof window=="undefined"?this:window);window.numbro=i(446)},function(n,t){"use strict";function i(n){var t=new Date(n);return isNaN(new Date(n+"T00:00").getDate())?t:new Date(t.getTime()+t.getTimezoneOffset()*6e4)}t.__esModule=!0;t.getNormalizedDate=i},function(n,t){"use strict";(function(n){function r(n){return n.split('"').length-1}var i={parse:function(n){var i,c,t,u=[],f=0,e,h,o,s;for(t=n.split("\n"),t.length>1&&t[t.length-1]===""&&t.pop(),i=0,c=t.length;i<c;i+=1){for(t[i]=t[i].split("\t"),e=0,h=t[i].length;e<h;e+=1)u[f]||(u[f]=[]),o&&e===0?(s=u[f].length-1,u[f][s]=u[f][s]+"\n"+t[i][0],o&&r(t[i][0])&1&&(o=!1,u[f][s]=u[f][s].substring(0,u[f][s].length-1).replace(/""/g,'"'))):e===h-1&&t[i][e].indexOf('"')===0&&r(t[i][e])&1?(u[f].push(t[i][e].substring(1).replace(/""/g,'"')),o=!0):(u[f].push(t[i][e].replace(/""/g,'"')),o=!1);o||(f+=1)}return u},stringify:function(n){for(var r,e,u="",t,i=0,f=n.length;i<f;i+=1){for(e=n[i].length,r=0;r<e;r+=1)r>0&&(u+="\t"),t=n[i][r],u+=typeof t=="string"?t.indexOf("\n")>-1?'"'+t.replace(/"/g,'""')+'"':t:t===null||t===void 0?"":t;i!==f-1&&(u+="\n")}return u}};t.parse=i.parse;t.stringify=i.stringify})(window)},function(n,t){"use strict";function u(n){i.set(n,!0)}function f(n){return n===r}function e(n){return i.has(n)}t.__esModule=!0;t.registerAsRootInstance=u;t.hasValidParameter=f;t.isRootInstance=e;var i=t.holder=new WeakMap,r=t.rootInstanceSymbol=Symbol("rootInstance")},function(n,t,i){"use strict";function u(){}t.__esModule=!0;var f=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},r=i(13),e=i(1);u.prototype={licenseKey:"trial",data:void 0,dataSchema:void 0,width:void 0,height:void 0,startRows:5,startCols:5,rowHeaders:void 0,colHeaders:null,colWidths:void 0,rowHeights:void 0,columns:void 0,cells:void 0,cell:[],comments:!1,customBorders:!1,minRows:0,minCols:0,maxRows:Infinity,maxCols:Infinity,minSpareRows:0,minSpareCols:0,allowInsertRow:!0,allowInsertColumn:!0,allowRemoveRow:!0,allowRemoveColumn:!0,selectionMode:"multiple",fillHandle:!0,fixedRowsTop:0,fixedRowsBottom:0,fixedColumnsLeft:0,outsideClickDeselects:!0,enterBeginsEditing:!0,enterMoves:{row:1,col:0},tabMoves:{row:0,col:1},autoWrapRow:!1,autoWrapCol:!1,persistentState:void 0,currentRowClassName:void 0,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",className:void 0,tableClassName:void 0,stretchH:"none",isEmptyRow:function(n){for(var t,o,i=0,u=this.countCols();i<u;i++)if(t=this.getDataAtCell(n,i),t!==""&&t!==null&&r.isDefined(t))return(typeof t=="undefined"?"undefined":f(t))==="object"?(o=this.getCellMeta(n,i),e.isObjectEqual(this.getSchema()[o.prop],t)):!1;return!0},isEmptyCol:function(n){for(var i,t=0,u=this.countRows();t<u;t++)if(i=this.getDataAtCell(t,n),i!==""&&i!==null&&r.isDefined(i))return!1;return!0},observeDOMVisibility:!0,allowInvalid:!0,allowEmpty:!0,invalidCellClassName:"htInvalid",placeholder:!1,placeholderCellClassName:"htPlaceholder",readOnlyCellClassName:"htDimmed",renderer:void 0,commentedCellClassName:"htCommentCell",fragmentSelection:!1,readOnly:!1,skipColumnOnPaste:!1,search:!1,type:"text",copyable:!0,editor:void 0,autoComplete:void 0,visibleRows:10,trimDropdown:!0,debug:!1,wordWrap:!0,noWordWrapClassName:"htNoWrap",contextMenu:void 0,copyPaste:!0,undo:void 0,columnSorting:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,mergeCells:!1,viewportRowRenderingOffset:"auto",viewportColumnRenderingOffset:"auto",validator:void 0,disableVisualSelection:!1,sortIndicator:void 0,manualColumnFreeze:void 0,trimWhitespace:!0,settings:void 0,source:void 0,title:void 0,checkedTemplate:void 0,uncheckedTemplate:void 0,label:void 0,numericFormat:void 0,language:void 0,selectOptions:void 0,autoColumnSize:void 0,autoRowSize:void 0,dateFormat:void 0,correctFormat:!1,defaultDate:void 0,strict:void 0,allowHtml:!1,renderAllRows:void 0,preventOverflow:!1,bindRowsWithHeaders:void 0,collapsibleColumns:void 0,columnSummary:void 0,dropdownMenu:void 0,filters:void 0,formulas:void 0,ganttChart:void 0,headerTooltips:void 0,hiddenColumns:void 0,hiddenRows:void 0,nestedHeaders:void 0,trimRows:void 0,rowHeaderWidth:void 0,columnHeaderHeight:void 0,observeChanges:void 0,sortFunction:void 0,sortByRelevance:!0,filter:!0,filteringCaseSensitive:!1,dragToScroll:!0};t.default=u},function(n,t,i){"use strict";function o(n,t,i){var o=u.getLanguageDictionary(n),f,r;return o===null?null:(f=o[t],e.isUndefined(f))?null:(r=s(f,i),Array.isArray(r))?r[0]:r}function s(n,t){var i=n;return r.arrayEach(f.getPhraseFormatters(),function(r){i=r(n,t)}),i}t.__esModule=!0;t.getTranslatedPhrase=o;var r=i(0),u=i(82),f=i(544),e=i(13)},function(n,t,i){"use strict";function c(n,t){return Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(t)}}))}function l(n,t){return s.objectEach(t,function(t,i){u.isUndefined(n[i])&&(n[i]=t)}),n}function a(n,t){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:n,r=arguments.length>3&&arguments[3]!==undefined?arguments[3]:t,u;return n>t&&(u=[r,i],i=u[0],r=u[1]),i+"-"+r}function e(n){var t=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(n);return t?t[1].toLowerCase()+"-"+t[2].toUpperCase():n}function v(n,t){var i=e(t);f.hasLanguageDictionary(i)?n.language=i:(n.language=f.DEFAULT_LANGUAGE_CODE,o(t))}function o(n){u.isDefined(n)&&console.error(h.toSingleLine(r,n))}var r;t.__esModule=!0;r=c(['Language with code "','" was not found. You should register particular language \n    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.'],['Language with code "','" was not found. You should register particular language \n    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.']);t.extendNotExistingKeys=l;t.createCellHeadersRange=a;t.normalizeLanguageCode=e;t.applyLanguageSetting=v;t.warnUserAboutLanguageRegistration=o;var u=i(13),s=i(1),h=i(34),f=i(82)},function(n,t,i){"use strict";function c(n){return n&&n.__esModule?n:{"default":n}}function l(){u===0&&(f.addEventListener(document,"keydown",function(n){r.has(n.keyCode)||r.add(n.keyCode)}),f.addEventListener(document,"keyup",function(n){r.has(n.keyCode)&&r.delete(n.keyCode)}),f.addEventListener(document,"visibilitychange",function(){document.hidden&&r.clear()}));u+=1}function a(){u>0&&(u-=1);u===0&&o()}function o(){f.clearEvents();r.clear();u=0}function v(n){return Array.from(r.values()).some(function(t){return e.isKey(t,n)})}function y(){return Array.from(r.values()).some(function(n){return e.isCtrlMetaKey(n)})}function p(){return u}t.__esModule=!0;t.stopObserving=t.startObserving=t.isPressedCtrlKey=t.isPressed=t._resetState=t._getRefCount=undefined;var s=i(9),h=c(s),e=i(18),w=i(0);var f=new h.default,r=new Set,u=0;t._getRefCount=p;t._resetState=o;t.isPressed=v;t.isPressedCtrlKey=y;t.startObserving=l;t.stopObserving=a},function(n,t,i){"use strict";function r(n){if(Array.isArray(n)){for(var t=0,i=Array(n.length);t<n.length;t++)i[t]=n[t];return i}return Array.from(n)}function s(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}t.__esModule=!0;t.HEADER_TYPE=t.AREA_TYPE=t.FILL_TYPE=t.CELL_TYPE=undefined;var o=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),u=i(547),f=i(0);var e=t.CELL_TYPE="cell",h=t.FILL_TYPE="fill",c=t.AREA_TYPE="area",l=t.HEADER_TYPE="header",a=function(){function n(t){s(this,n);this.options=t;this.layerLevel=0;this.cell=u.createHighlight(e,t);this.fill=u.createHighlight(h,t);this.areas=new Map;this.headers=new Map;this.borders=[]}return o(n,[{key:"isEnabledFor",value:function(n){var t=this.options.disableHighlight;return n==="current"&&(n=e),typeof t=="string"&&(t=[t]),t===!1||Array.isArray(t)&&!t.includes(n)}},{key:"useLayerLevel",value:function(){var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;return this.layerLevel=n,this}},{key:"getCell",value:function(){return this.cell}},{key:"getFill",value:function(){return this.fill}},{key:"createOrGetArea",value:function(){var n=this.layerLevel,t=void 0;return this.areas.has(n)?t=this.areas.get(n):(t=u.createHighlight(c,Object.assign({layerLevel:n},this.options)),this.areas.set(n,t)),t}},{key:"getAreas",value:function(){return[].concat(r(this.areas.values()))}},{key:"createOrGetHeader",value:function(){var n=void 0,t=this.layerLevel;return this.headers.has(t)?n=this.headers.get(t):(n=u.createHighlight(l,Object.assign({},this.options)),this.headers.set(t,n)),n}},{key:"getHeaders",value:function(){return[].concat(r(this.headers.values()))}},{key:"clear",value:function(){this.cell.clear();this.fill.clear();f.arrayEach(this.areas.values(),function(n){n.clear()});f.arrayEach(this.headers.values(),function(n){n.clear()})}},{key:Symbol.iterator,value:function(){return[this.cell].concat(r(this.areas.values()),r(this.headers.values()),[this.fill],r(this.borders))[Symbol.iterator]()}}]),n}();t.default=a},function(n,t,i){"use strict";function s(n,t,i){return t in n?Object.defineProperty(n,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[t]=i,n}function h(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var f;t.__esModule=!0;var r=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),e=i(1),u=i(4),o=i(13);f=function(){function n(t){h(this,n);this.samples=null;this.dataFactory=t;this.customSampleCount=null;this.allowDuplicates=!1}return r(n,null,[{key:"SAMPLE_COUNT",get:function(){return 3}}]),r(n,[{key:"getSampleCount",value:function(){return this.customSampleCount?this.customSampleCount:n.SAMPLE_COUNT}},{key:"setSampleCount",value:function(n){this.customSampleCount=n}},{key:"setAllowDuplicates",value:function(n){this.allowDuplicates=n}},{key:"generateRowSamples",value:function(n,t){return this.generateSamples("row",t,n)}},{key:"generateColumnSamples",value:function(n,t){return this.generateSamples("col",t,n)}},{key:"generateSamples",value:function(n,t,i){var f=this,r=new Map;return typeof i=="number"&&(i={from:i,to:i}),u.rangeEach(i.from,i.to,function(i){var u=f.generateSample(n,t,i);r.set(i,u)}),r}},{key:"generateSample",value:function(n,t,i){var f=this,h=new Map,c=[],r=void 0;return u.rangeEach(t.from,t.to,function(t){var u=void 0,l,a,v;if(n==="row")u=f.dataFactory(i,t);else if(n==="col")u=f.dataFactory(t,i);else throw new Error("Unsupported sample type");r=e.isObject(u)?Object.keys(u).length:Array.isArray(u)?u.length:o.stringify(u).length;h.has(r)||h.set(r,{needed:f.getSampleCount(),strings:[]});l=h.get(r);l.needed&&(a=c.indexOf(u)>-1,(!a||f.allowDuplicates)&&(v=n==="row"?"col":"row",l.strings.push(s({value:u},v,t)),c.push(u),l.needed--))}),h}}]),n}();t.default=f},function(n,t,i){"use strict";function o(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function s(n,t){var i=void 0;return r.arrayEach(t,function(t){var r=t.key?t.key.split(":"):null;if(Array.isArray(r)&&r[1]===n)return i=t,!1}),i}var u;t.__esModule=!0;var f=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),r=i(0),e=i(1);u=function(){function n(t){o(this,n);this.hot=t;this.commands={};this.commonCallback=null}return f(n,[{key:"registerCommand",value:function(n,t){this.commands[n]=t}},{key:"setCommonCallback",value:function(n){this.commonCallback=n}},{key:"execute",value:function(n){for(var i,c,t,f,l=this,o=arguments.length,h=Array(o>1?o-1:0),u=1;u<o;u++)h[u-1]=arguments[u];if(i=n.split(":"),n=i[0],c=i.length===2?i[1]:null,t=this.commands[n],!t)throw new Error("Menu command '"+n+"' not exists.");(c&&t.submenu&&(t=s(c,t.submenu.items)),t.disabled!==!0)&&(typeof t.disabled!="function"||t.disabled.call(this.hot)!==!0)&&(e.hasOwnProperty(t,"submenu")||(f=[],typeof t.callback=="function"&&f.push(t.callback),typeof this.commonCallback=="function"&&f.push(this.commonCallback),h.unshift(i.join(":")),r.arrayEach(f,function(n){return n.apply(l.hot,h)})))}}]),n}();t.default=u},function(n,t,i){"use strict";function s(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function h(){var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null,f=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[],i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{},t=[];return n&&n.items?n=n.items:Array.isArray(n)||(n=f),r.isObject(n)?r.objectEach(n,function(n,u){var f=i[typeof n=="string"?n:u];f||(f=n);r.isObject(n)?r.extend(f,n):typeof f=="string"&&(f={name:f});f.key===void 0&&(f.key=u);t.push(f)}):o.arrayEach(n,function(n,f){var e=i[n];!e&&u.ITEMS.indexOf(n)>=0||(e||(e={name:n,key:""+f}),r.isObject(n)&&r.extend(e,n),e.key===void 0&&(e.key=f),t.push(e))}),t}var f;t.__esModule=!0;var e=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),r=i(1),o=i(0),u=i(44);f=function(){function n(t){var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;s(this,n);this.hot=t;this.predefinedItems=u.predefinedItems();this.defaultOrderPattern=i}return e(n,[{key:"setPredefinedItems",value:function(n){var i=this,t={};this.defaultOrderPattern.length=0;r.objectEach(n,function(n,r){var f="";n.name===u.SEPARATOR?(t[u.SEPARATOR]=n,f=u.SEPARATOR):isNaN(parseInt(r,10))?(n.key=n.key===void 0?r:n.key,t[r]=n,f=n.key):(t[n.key]=n,f=n.key);i.defaultOrderPattern.push(f)});this.predefinedItems=t}},{key:"getItems",value:function(){var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;return h(n,this.defaultOrderPattern,this.predefinedItems)}}]),n}();t.default=f},function(n,t,i){"use strict";function h(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var f,r;t.__esModule=!0;f=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}();r=i(4);var e=0,o=1,s=2,u="px",c=function(){function n(t){h(this,n);this.hot=t;this._element=null;this.state=e}return f(n,[{key:"appendTo",value:function(n){n.appendChild(this._element);this.state=s}},{key:"build",value:function(){this._element=document.createElement("div");this.state=o}},{key:"destroy",value:function(){this.isAppended()&&this._element.parentElement.removeChild(this._element);this._element=null;this.state=e}},{key:"isAppended",value:function(){return this.state===s}},{key:"isBuilt",value:function(){return this.state>=o}},{key:"setPosition",value:function(n,t){r.isNumeric(n)&&(this._element.style.top=n+u);r.isNumeric(t)&&(this._element.style.left=t+u)}},{key:"getPosition",value:function(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}},{key:"setSize",value:function(n,t){r.isNumeric(n)&&(this._element.style.width=n+u);r.isNumeric(t)&&(this._element.style.height=t+u)}},{key:"getSize",value:function(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}},{key:"setOffset",value:function(n,t){r.isNumeric(n)&&(this._element.style.marginTop=n+u);r.isNumeric(t)&&(this._element.style.marginLeft=t+u)}},{key:"getOffset",value:function(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}}]),n}();t.default=c},function(n,t){"use strict";function o(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var r;t.__esModule=!0;r=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}();var u=0,f=1,e=2,i="px",s=function(){function n(t){o(this,n);this.hot=t;this._element=null;this.state=u}return r(n,[{key:"appendTo",value:function(n){n.appendChild(this._element);this.state=e}},{key:"build",value:function(){this._element=document.createElement("div");this.state=f}},{key:"destroy",value:function(){this.isAppended()&&this._element.parentElement.removeChild(this._element);this._element=null;this.state=u}},{key:"isAppended",value:function(){return this.state===e}},{key:"isBuilt",value:function(){return this.state>=f}},{key:"setPosition",value:function(n,t){n!==void 0&&(this._element.style.top=n+i);t!==void 0&&(this._element.style.left=t+i)}},{key:"getPosition",value:function(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}},{key:"setSize",value:function(n,t){n&&(this._element.style.width=n+i);t&&(this._element.style.height=t+i)}},{key:"getSize",value:function(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}},{key:"setOffset",value:function(n,t){n&&(this._element.style.marginTop=n+i);t&&(this._element.style.marginLeft=t+i)}},{key:"getOffset",value:function(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}}]),n}();t.default=s},function(n,t){"use strict";function i(n,t,i,r){t?t.row===i&&t.col===r?(n.setAttribute("rowspan",t.rowspan.toString()),n.setAttribute("colspan",t.colspan.toString())):(n.removeAttribute("rowspan"),n.removeAttribute("colspan"),n.style.display="none"):(n.removeAttribute("rowspan"),n.removeAttribute("colspan"),n.style.display="")}t.__esModule=!0;t.applySpanProperties=i},function(n,t){"use strict";var r=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},f,u,i;
/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * json-patch-duplex.js version: 0.5.7
 * (c) 2013 Joachim Wester
 * MIT license
 */
f=undefined&&undefined.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);n.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)};u=Error,function(n){function l(n,t){var f,e,u,i;switch(typeof n=="undefined"?"undefined":r(n)){case"undefined":case"boolean":case"string":case"number":return n===t;case"object":if(n===null)return t===null;if(h(n)){if(!h(t)||n.length!==t.length)return!1;for(i=0,f=n.length;i<f;i++)if(!l(n[i],t[i]))return!1;return!0}if(e=c(t),u=e.length,c(n).length!==u)return!1;for(i=0;i<u;i++)if(!l(n[i],t[i]))return!1;return!0;default:return!1}}function o(n){return n.indexOf("/")===-1&&n.indexOf("~")===-1?n:n.replace(/~/g,"~0").replace(/\//g,"~1")}function nt(n){for(var t=0,i=s.length;t<i;t++)if(s[t].obj===n)return s[t]}function tt(n,t){for(var i=0,r=n.observers.length;i<r;i++)if(n.observers[i].callback===t)return n.observers[i].observer}function it(n,t){for(var i=0,r=n.observers.length;i<r;i++)if(n.observers[i].observer===t){n.observers.splice(i,1);return}}function rt(n,t){t.unobserve()}function a(n){return(typeof n=="undefined"?"undefined":r(n))==="object"?JSON.parse(JSON.stringify(n)):n}function ut(n,t){var l=n,i,f=nt(n),e;if(f?i=tt(f,t):(f=new d(n),s.push(f)),i)return i;if(i={},f.value=a(n),t){if(i.callback=t,i.next=null,e=this.intervals||[100,1e3,1e4,6e4],e.push===void 0)throw new u("jsonpatch.intervals must be an array");var o=0,c=function(){v(i)},r=function(){clearTimeout(i.next);i.next=setTimeout(function(){c();o=0;i.next=setTimeout(h,e[o++])},0)},h=function h(){c();o==e.length&&(o=e.length-1);i.next=setTimeout(h,e[o++])};typeof window!="undefined"&&(window.addEventListener?(window.addEventListener("mousedown",r),window.addEventListener("mouseup",r),window.addEventListener("keydown",r)):(document.documentElement.attachEvent("onmousedown",r),document.documentElement.attachEvent("onmouseup",r),document.documentElement.attachEvent("onkeydown",r)));i.next=setTimeout(h,e[o++])}return i.patches=[],i.object=n,i.unobserve=function(){v(i);clearTimeout(i.next);it(f,i);typeof window!="undefined"&&(window.removeEventListener?(window.removeEventListener("mousedown",r),window.removeEventListener("mouseup",r),window.removeEventListener("keydown",r)):(document.documentElement.detachEvent("onmousedown",r),document.documentElement.detachEvent("onmouseup",r),document.documentElement.detachEvent("onkeydown",r)))},f.observers.push(new g(t,i)),i}function v(n){for(var r,u,t=0,f=s.length;t<f;t++)if(s[t].obj===n.object){u=s[t];break}return y(u.value,n.object,n.patches,""),n.patches.length&&i(u.value,n.patches),r=n.patches,r.length>0&&(n.patches=[],n.callback&&n.callback(r)),r}function y(n,t,i,u){for(var h,s,f,l=c(t),v=c(n),w=!1,p=!1,e=v.length-1;e>=0;e--)f=v[e],h=n[f],t.hasOwnProperty(f)?(s=t[f],(typeof h=="undefined"?"undefined":r(h))=="object"&&h!=null&&(typeof s=="undefined"?"undefined":r(s))=="object"&&s!=null?y(h,s,i,u+"/"+o(f)):h!=s&&(w=!0,i.push({op:"replace",path:u+"/"+o(f),value:a(s)}))):(i.push({op:"remove",path:u+"/"+o(f)}),p=!0);if(p||l.length!=v.length)for(e=0;e<l.length;e++)f=l[e],n.hasOwnProperty(f)||i.push({op:"add",path:u+"/"+o(f),value:a(t[f])})}function ft(n){for(var t=0,r=n.length,i;t<r;){if(i=n.charCodeAt(t),i>=48&&i<=57){t++;continue}return!1}return!0}function i(n,i,r){for(var a=!1,c=0,w=i.length,f,u;c<w;){f=i[c];c++;for(var b=f.path||"",y=b.split("/"),o=n,s=1,v=y.length,l=undefined;;){if(u=y[s],r&&l===undefined&&(o[u]===undefined?l=y.slice(0,s).join("/"):s==v-1&&(l=f.path),l!==undefined&&this.validator(f,c-1,n,l)),s++,u===undefined&&s>=v){a=p[f.op].call(f,o,u,n);break}if(h(o)){if(u==="-")u=o.length;else{if(r&&!ft(u))throw new t("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",c-1,f.path,f);u=parseInt(u,10)}if(s>=v){if(r&&f.op==="add"&&u>o.length)throw new t("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",c-1,f.path,f);a=k[f.op].call(f,o,u,n);break}}else if(u&&u.indexOf("~")!=-1&&(u=u.replace(/~1/g,"/").replace(/~0/g,"~")),s>=v){a=e[f.op].call(f,o,u,n);break}o=o[u]}}return a}function et(n,t){var i=[];return y(n,t,i,""),i}function b(n){if(n===undefined)return!0;if(typeof n=="array"||(typeof n=="undefined"?"undefined":r(n))=="object")for(var t in n)if(b(n[t]))return!0;return!1}function ot(i,u,f,o){var s,c,a,l;if((typeof i=="undefined"?"undefined":r(i))!=="object"||i===null||h(i))throw new t("Operation is not an object","OPERATION_NOT_AN_OBJECT",u,i,f);else if(e[i.op]){if(typeof i.path!="string")throw new t("Operation `path` property is not a string","OPERATION_PATH_INVALID",u,i,f);else if((i.op==="move"||i.op==="copy")&&typeof i.from!="string")throw new t("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",u,i,f);else if((i.op==="add"||i.op==="replace"||i.op==="test")&&i.value===undefined)throw new t("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",u,i,f);else if((i.op==="add"||i.op==="replace"||i.op==="test")&&b(i.value))throw new t("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",u,i,f);else if(f)if(i.op=="add"){if(s=i.path.split("/").length,c=o.split("/").length,s!==c+1&&s!==c)throw new t("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",u,i,f);}else if(i.op==="replace"||i.op==="remove"||i.op==="_get"){if(i.path!==o)throw new t("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",u,i,f);}else if((i.op==="move"||i.op==="copy")&&(a={op:"_get",path:i.from,value:undefined},l=n.validate([a],f),l&&l.name==="OPERATION_PATH_UNRESOLVABLE"))throw new t("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",u,i,f);}else throw new t("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",u,i,f);}function st(n,r){try{if(!h(n))throw new t("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(r)r=JSON.parse(JSON.stringify(r)),i.call(this,r,n,!0);else for(var u=0;u<n.length;u++)this.validator(n[u],u)}catch(f){if(f instanceof t)return f;throw f;}}var c=function(n){var i,t,r;if(h(n)){for(t=new Array(n.length),i=0;i<t.length;i++)t[i]=""+i;return t}if(Object.keys)return Object.keys(n);t=[];for(r in n)n.hasOwnProperty(r)&&t.push(r);return t},e={add:function(n,t){return n[t]=this.value,!0},remove:function(n,t){return delete n[t],!0},replace:function(n,t){return n[t]=this.value,!0},move:function(n,t,r){var u={op:"_get",path:this.from};return i(r,[u]),i(r,[{op:"remove",path:this.from}]),i(r,[{op:"add",path:this.path,value:u.value}]),!0},copy:function(n,t,r){var u={op:"_get",path:this.from};return i(r,[u]),i(r,[{op:"add",path:this.path,value:u.value}]),!0},test:function(n,t){return l(n[t],this.value)},_get:function(n,t){this.value=n[t]}},k={add:function(n,t){return n.splice(t,0,this.value),!0},remove:function(n,t){return n.splice(t,1),!0},replace:function(n,t){return n[t]=this.value,!0},move:e.move,copy:e.copy,test:e.test,_get:e._get},p={add:function(n){p.remove.call(this,n);for(var t in this.value)this.value.hasOwnProperty(t)&&(n[t]=this.value[t]);return!0},remove:function(n){for(var t in n)n.hasOwnProperty(t)&&e.remove.call(this,n,t);return!0},replace:function(n){return i(n,[{op:"remove",path:this.path}]),i(n,[{op:"add",path:this.path,value:this.value}]),!0},move:e.move,copy:e.copy,test:function(n){return JSON.stringify(n)===JSON.stringify(this.value)},_get:function(n){this.value=n}},wt={add:function(n,t){var i={op:"add",path:t+o(this.name),value:this.object[this.name]};n.push(i)},"delete":function(n,t){var i={op:"remove",path:t+o(this.name)};n.push(i)},update:function(n,t){var i={op:"replace",path:t+o(this.name),value:this.object[this.name]};n.push(i)}},s=[],d=function(){function n(n){this.observers=[];this.obj=n}return n}(),g=function(){function n(n,t){this.callback=n;this.observer=t}return n}(),h,t;n.unobserve=rt;n.observe=ut;n.generate=v;h=Array.isArray?Array.isArray:function(n){return n.push&&typeof n.length=="number"};n.apply=i;n.compare=et;t=function(n){function t(t,i,r,u,f){n.call(this,t);this.message=t;this.name=i;this.index=r;this.operation=u;this.tree=f}return f(t,n),t}(u);n.JsonPatchError=t;n.Error=t;n.validator=ot;n.validate=st}(i||(i={}));!0&&(t.apply=i.apply,t.observe=i.observe,t.unobserve=i.unobserve,t.generate=i.generate,t.compare=i.compare,t.validate=i.validate,t.validator=i.validator,t.JsonPatchError=i.JsonPatchError,t.Error=i.Error)},function(n,t,i){"use strict";function s(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function u(n){return n.value===""||n.value===null||n.value===void 0}var r;t.__esModule=!0;t.CONDITION_NAME=undefined;t.condition=u;var f=i(3),e=s(f),o=i(10);r=t.CONDITION_NAME="empty";o.registerCondition(r,u,{name:e.FILTERS_CONDITIONS_EMPTY,inputsCount:0,showOperators:!0})},function(n,t,i){"use strict";function c(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function e(n){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:inputValues,i=r(t,1),f=i[0];return u.stringify(n.value).toLowerCase()===u.stringify(f)}var r,f;t.__esModule=!0;t.CONDITION_NAME=undefined;r=function(){function n(n,t){var r=[],u=!0,f=!1,e=undefined,i,o;try{for(i=n[Symbol.iterator]();!(u=(o=i.next()).done);u=!0)if(r.push(o.value),t&&r.length===t)break}catch(s){f=!0;e=s}finally{try{!u&&i["return"]&&i["return"]()}finally{if(f)throw e;}}return r}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return n(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance");}}();t.condition=e;var o=i(3),s=c(o),u=i(13),h=i(10);f=t.CONDITION_NAME="eq";h.registerCondition(f,e,{name:s.FILTERS_CONDITIONS_EQUAL,inputsCount:1,showOperators:!0})},function(n,t,i){"use strict";function l(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function e(n){var a=arguments.length>1&&arguments[1]!==undefined?arguments[1]:inputValues,o=u(a,2),t=o[0],i=o[1],f,e,s,l;if(n.meta.type==="numeric")f=parseFloat(t,10),e=parseFloat(i,10),t=Math.min(f,e),i=Math.max(f,e);else if(n.meta.type==="date")return s=r.getCondition(c.CONDITION_NAME,[i]),l=r.getCondition(h.CONDITION_NAME,[t]),s(n)&&l(n);return n.value>=t&&n.value<=i}var u,f;t.__esModule=!0;t.CONDITION_NAME=undefined;u=function(){function n(n,t){var r=[],u=!0,f=!1,e=undefined,i,o;try{for(i=n[Symbol.iterator]();!(u=(o=i.next()).done);u=!0)if(r.push(o.value),t&&r.length===t)break}catch(s){f=!0;e=s}finally{try{!u&&i["return"]&&i["return"]()}finally{if(f)throw e;}}return r}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return n(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance");}}();t.condition=e;var o=i(3),s=l(o),r=i(10),h=i(465),c=i(466);f=t.CONDITION_NAME="between";r.registerCondition(f,e,{name:s.FILTERS_CONDITIONS_BETWEEN,inputsCount:2,showOperators:!0})},function(n,t,i){"use strict";function l(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function a(n){return n&&n.__esModule?n:{"default":n}}function e(n){var f=arguments.length>1&&arguments[1]!==undefined?arguments[1]:inputValues,e=r(f,1),o=e[0],t=u.default(n.value,n.meta.dateFormat),i=u.default(o,n.meta.dateFormat);return!t.isValid()||!i.isValid()?!1:t.diff(i)>=0}var r,f;t.__esModule=!0;t.CONDITION_NAME=undefined;r=function(){function n(n,t){var r=[],u=!0,f=!1,e=undefined,i,o;try{for(i=n[Symbol.iterator]();!(u=(o=i.next()).done);u=!0)if(r.push(o.value),t&&r.length===t)break}catch(s){f=!0;e=s}finally{try{!u&&i["return"]&&i["return"]()}finally{if(f)throw e;}}return r}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return n(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance");}}();t.condition=e;var o=i(23),u=a(o),s=i(3),h=l(s),c=i(10);f=t.CONDITION_NAME="date_after";c.registerCondition(f,e,{name:h.FILTERS_CONDITIONS_AFTER,inputsCount:1,showOperators:!0})},function(n,t,i){"use strict";function l(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function a(n){return n&&n.__esModule?n:{"default":n}}function e(n){var f=arguments.length>1&&arguments[1]!==undefined?arguments[1]:inputValues,e=r(f,1),o=e[0],t=u.default(n.value,n.meta.dateFormat),i=u.default(o,n.meta.dateFormat);return!t.isValid()||!i.isValid()?!1:t.diff(i)<=0}var r,f;t.__esModule=!0;t.CONDITION_NAME=undefined;r=function(){function n(n,t){var r=[],u=!0,f=!1,e=undefined,i,o;try{for(i=n[Symbol.iterator]();!(u=(o=i.next()).done);u=!0)if(r.push(o.value),t&&r.length===t)break}catch(s){f=!0;e=s}finally{try{!u&&i["return"]&&i["return"]()}finally{if(f)throw e;}}return r}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return n(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance");}}();t.condition=e;var o=i(23),u=a(o),s=i(3),h=l(s),c=i(10);f=t.CONDITION_NAME="date_before";c.registerCondition(f,e,{name:h.FILTERS_CONDITIONS_BEFORE,inputsCount:1,showOperators:!0})},function(n,t,i){"use strict";function c(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function e(n){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:inputValues,i=r(t,1),f=i[0];return u.stringify(n.value).toLowerCase().indexOf(u.stringify(f))>=0}var r,f;t.__esModule=!0;t.CONDITION_NAME=undefined;r=function(){function n(n,t){var r=[],u=!0,f=!1,e=undefined,i,o;try{for(i=n[Symbol.iterator]();!(u=(o=i.next()).done);u=!0)if(r.push(o.value),t&&r.length===t)break}catch(s){f=!0;e=s}finally{try{!u&&i["return"]&&i["return"]()}finally{if(f)throw e;}}return r}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return n(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance");}}();t.condition=e;var o=i(3),s=c(o),u=i(13),h=i(10);f=t.CONDITION_NAME="contains";h.registerCondition(f,e,{name:s.FILTERS_CONDITIONS_CONTAINS,inputsCount:1,showOperators:!0})},function(n,t,i){"use strict";function h(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function f(n,t){return n.some(function(n){return n.func(t)})}var r,u;t.__esModule=!0;t.SHORT_NAME_FOR_COMPONENT=t.OPERATION_ID=undefined;t.operationResult=f;var e=i(3),o=h(e),s=i(64);r=t.OPERATION_ID="disjunction";u=t.SHORT_NAME_FOR_COMPONENT=o.FILTERS_LABELS_DISJUNCTION;s.registerOperation(r,u,f)},function(n,t,i){"use strict";function h(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function f(n,t){if(n.length<3)throw Error("Operation doesn't work on less then three conditions.");return n.slice(0,n.length-1).some(function(n){return n.func(t)})&&n[n.length-1].func(t)}var r,u;t.__esModule=!0;t.SHORT_NAME_FOR_COMPONENT=t.OPERATION_ID=undefined;t.operationResult=f;var e=i(3),o=h(e),s=i(64);r=t.OPERATION_ID="disjunctionAndVariable";u=t.SHORT_NAME_FOR_COMPONENT=o.FILTERS_LABELS_DISJUNCTION;s.registerOperation(r,u,f)},function(n,t,i){"use strict";function y(n){return n&&n.__esModule?n:{"default":n}}function p(n,t){return Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(t)}}))}function w(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var f;t.__esModule=!0;var s=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),h=p(["The column of index "," has been already applied with a `","` \n        filter operation. Use `removeConditions` to clear the current conditions and then add new ones. \n        Mind that you cannot mix different types of operations (for instance, if you use `conjunction`, \n        use it consequently for a particular column)."],["The column of index "," has been already applied with a \\`","\\` \n        filter operation. Use \\`removeConditions\\` to clear the current conditions and then add new ones. \n        Mind that you cannot mix different types of operations (for instance, if you use \\`conjunction\\`, \n        use it consequently for a particular column)."]),r=i(0),u=i(1),c=i(34),l=i(21),a=y(l),v=i(10),e=i(160),o=i(64);f=function(){function n(){w(this,n);this.conditions=this.initConditionsCollection();this.columnTypes={};this.orderStack=[]}return s(n,[{key:"isEmpty",value:function(){return!this.orderStack.length}},{key:"isMatch",value:function(n,t){var r=this,i=!0,f;return t===void 0?u.objectEach(this.columnTypes,function(t,u){return i=r.isMatchInConditions(r.conditions[t][u],n,t)}):(f=this.columnTypes[t],i=this.isMatchInConditions(this.getConditions(t),n,f)),i}},{key:"isMatchInConditions",value:function(n,t){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:e.OPERATION_ID;return n.length?o.getOperationFunc(i)(n,t):!0}},{key:"addCondition",value:function(n,t){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:e.OPERATION_ID,f=r.arrayMap(t.args,function(n){return typeof n=="string"?n.toLowerCase():n}),o=t.name||t.command.key,u;if(this.runLocalHooks("beforeAdd",n),this.orderStack.indexOf(n)===-1&&this.orderStack.push(n),u=this.columnTypes[n],u){if(u!==i)throw Error(c.toSingleLine(h,n,u));}else{if(!this.conditions[i])throw new Error("Unexpected operation named `"+i+"`. Possible ones are `disjunction` and `conjunction`.");this.columnTypes[n]=i}this.getConditions(n).push({name:o,args:f,func:v.getCondition(o,f)});this.runLocalHooks("afterAdd",n)}},{key:"getConditions",value:function(n){var t=this.columnTypes[n];return t?(this.conditions[t][n]||(this.conditions[t][n]=[]),this.conditions[t][n]):[]}},{key:"exportAllConditions",value:function(){var t=this,n=[];return r.arrayEach(this.orderStack,function(i){var u=r.arrayMap(t.getConditions(i),function(){var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:condition,t=n.name,i=n.args;return{name:t,args:i}});n.push({column:i,conditions:u})}),n}},{key:"importAllConditions",value:function(n){var t=this;this.clean();r.arrayEach(n,function(n){t.orderStack.push(n.column);r.arrayEach(n.conditions,function(i){return t.addCondition(n.column,i)})})}},{key:"removeConditions",value:function(n){this.runLocalHooks("beforeRemove",n);this.orderStack.indexOf(n)>=0&&this.orderStack.splice(this.orderStack.indexOf(n),1);this.clearConditions(n);this.runLocalHooks("afterRemove",n)}},{key:"clearConditions",value:function(n){this.runLocalHooks("beforeClear",n);this.getConditions(n).length=0;delete this.columnTypes[n];this.runLocalHooks("afterClear",n)}},{key:"hasConditions",value:function(n,t){var u=this.columnTypes[n],i;return u?(i=this.getConditions(n),t?r.arrayFilter(i,function(n){return n.name===t}).length>0:i.length>0):!1}},{key:"clean",value:function(){this.runLocalHooks("beforeClean");this.columnTypes=Object.create(null);this.orderStack.length=0;this.conditions=this.initConditionsCollection();this.runLocalHooks("afterClean")}},{key:"destroy",value:function(){this.clearLocalHooks();this.conditions=null;this.orderStack=null;this.columnTypes=null}},{key:"initConditionsCollection",value:function(){var n=Object.create(null);return u.objectEach(o.operations,function(t,i){n[i]=Object.create(null)}),n}}]),n}();u.mixin(f,a.default);t.default=f},function(n,t,i){"use strict";function e(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var u,r,f;t.__esModule=!0;u=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}();r=i(0);f=function(){function n(t){var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:function(){return[]};e(this,n);this.conditionCollection=t;this.columnDataFactory=i}return u(n,[{key:"filter",value:function(){var n=this,t=[];return this.conditionCollection.isEmpty()||r.arrayEach(this.conditionCollection.orderStack,function(i,r){var u=n.columnDataFactory(i);r&&(u=n._getIntersectData(u,t));t=n.filterByColumn(i,u)}),t}},{key:"filterByColumn",value:function(n){var i=this,u=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[],t=[];return r.arrayEach(u,function(r){r!==void 0&&i.conditionCollection.isMatch(r,n)&&t.push(r)}),t}},{key:"_getIntersectData",value:function(n,t){var i=[];return r.arrayEach(t,function(t){var r=t.meta.visualRow;n[r]!==void 0&&(i[r]=n[r])}),i}}]),n}();t.default=f},function(n,t,i){"use strict";function o(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var u;t.__esModule=!0;var f=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),r=i(1),e=i(66);u=function(){function n(t,i){o(this,n);var u=r.isObject(t),f=r.isObject(i);this._row=u?t.index:t;this.rowAbsolute=u?t.isAbsolute:!0;this._column=f?i.index:i;this.columnAbsolute=f?i.isAbsolute:!0;this.rowOffset=0;this.columnOffset=0;Object.defineProperty(this,"row",{get:function(){return this.rowOffset+this._row},set:function(n){this._row=n},enumerable:!0,configurable:!0});Object.defineProperty(this,"column",{get:function(){return this.columnOffset+this._column},set:function(n){this._column=n},enumerable:!0,configurable:!0})}return f(n,[{key:"translateTo",value:function(n,t){this.row=this.row+n;this.column=this.column+t}},{key:"isEqual",value:function(n){return n.row===this.row&&n.column===this.column}},{key:"toString",value:function(){return e.toLabel({index:this.row,isAbsolute:this.rowAbsolute},{index:this.column,isAbsolute:this.columnAbsolute})}}]),n}();t.default=u},function(n,t,i){"use strict";function s(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var e;t.__esModule=!0;var o=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),r=i(0),u=i(1),f=i(474);e=function(){function n(t,i){s(this,n);this.year=t;this.firstWeekDay="monday";this.allowSplitWeeks=i===void 0?!0:i;this.weekSectionCount=0;this.monthList=this.calculateMonthData();this.daysInColumns={};this.calculateWeekStructure()}return o(n,[{key:"setYear",value:function(n){this.year=n;this.monthList=this.calculateMonthData();this.calculateWeekStructure()}},{key:"setFirstWeekDay",value:function(n){var t=n.toLowerCase();t!=="monday"&&t!=="sunday"&&console.warn("First day of the week must be set to either Monday or Sunday");this.firstWeekDay=t;this.calculateWeekStructure()}},{key:"countWeekSections",value:function(){return this.weekSectionCount}},{key:"getFirstWeekDay",value:function(){return this.firstWeekDay}},{key:"getYear",value:function(){return this.year}},{key:"getMonthList",value:function(){return this.monthList}},{key:"parseDate",value:function(n){return!(n instanceof Date)&&(n=new Date(n),n.toString()==="Invalid Date")?null:n}},{key:"dateToColumn",value:function(n){if(n=this.parseDate(n),!n||n.getFullYear()!==this.year)return!1;var t=n.getMonth(),i=n.getDate()-1;return this.getWeekColumn(i,t)}},{key:"getWeekColumn",value:function(n,t){var i=null,f=this.getMonthCacheArray(t);return r.arrayEach(f,function(t){return u.objectEach(t,function(t,r){if(t.indexOf(n+1)>-1)return i=parseInt(r,10),!1}),i?!1:void 0}),i}},{key:"getMonthCacheArray",value:function(n){var r=this,f=this.getMonthList(),t=[],i;return this.allowSplitWeeks?t.push(this.daysInColumns[n]):(i=-1,u.objectEach(this.daysInColumns,function(u,e){var o=f[e];return Object.keys(u).length>1&&i++,i===n?(o.daysBeforeFullWeeks>0&&t.push(r.daysInColumns[parseInt(e,10)-1]),t.push(u),o.daysAfterFullWeeks>0&&t.push(r.daysInColumns[parseInt(e,10)+1]),!1):void 0})),t}},{key:"columnToDate",value:function(n){var t=null;return(u.objectEach(this.daysInColumns,function(i,r){if(i[n])return t=r,!1}),this.daysInColumns[t][n].length===1)?new Date(this.year,t,this.daysInColumns[t][n][0]):this.daysInColumns[t][n]}},{key:"isOnTheEdgeOfWeek",value:function(n){var f=this;if(n=this.parseDate(n),!n)return null;var e=n.getMonth(),i=n.getDate()-1,o=this.getMonthCacheArray(e),t=!1;return r.arrayEach(o,function(r){return u.objectEach(r,function(r){if(!f.allowSplitWeeks&&r.length!==7&&(i===0||i===new Date(n.getYear(),n.getMonth()+1,0).getDate()-1))return!0;var u=r.indexOf(i+1);return u===0?(t=[1,0],!1):u===r.length-1?(t=[0,1],!1):void 0}),t?!1:void 0}),t}},{key:"addDaysToCache",value:function(n,t,i,r){var u,o,f,e;if(this.daysInColumns[n]||(this.daysInColumns[n]={}),this.daysInColumns[n][t]||(this.daysInColumns[n][t]=[]),i<=r)for(u=i;u<=r;u++)this.daysInColumns[n][t].push(u);else{for(o=n-1>=0?this.countMonthDays(n):31,f=i;f<=o;f++)this.daysInColumns[n][t].push(f);for(e=1;e<=r;e++)this.daysInColumns[n][t].push(e)}}},{key:"isValidRangeBarData",value:function(n,t){var i=this.parseDate(n),r=this.parseDate(t);return i&&r&&i.getTime()<=r.getTime()}},{key:"calculateMonthData",value:function(){return[{name:"January",days:31},{name:"February",days:new Date(this.year,2,0).getDate()},{name:"March",days:31},{name:"April",days:30},{name:"May",days:31},{name:"June",days:30},{name:"July",days:31},{name:"August",days:31},{name:"September",days:30},{name:"October",days:31},{name:"November",days:30},{name:"December",days:31}].slice(0)}},{key:"countMonths",value:function(){return this.monthList.length}},{key:"countMonthDays",value:function(n){return this.monthList[n-1].days}},{key:"countMonthFullWeeks",value:function(n){return this.monthList[n-1].fullWeeks}},{key:"calculateWeekStructure",value:function(){var t=this;this.monthList=this.calculateMonthData();var o=this.getFirstWeekDay(),n=this.getMonthList(),s=this.getYear(),i=[],e=0,u=0;o==="monday"&&(e=1);r.arrayEach(n,function(r,o){var l=new Date(s,o,1).getDay(),c=0,h=null;r.daysBeforeFullWeeks=(7-l+e)%7;!t.allowSplitWeeks&&r.daysBeforeFullWeeks&&(h=f.getMixedMonthName(o,n),i.push(f.getMixedMonthObject(h,o)),c++);r.fullWeeks=Math.floor((r.days-r.daysBeforeFullWeeks)/7);r.daysAfterFullWeeks=r.days-r.daysBeforeFullWeeks-7*r.fullWeeks;t.allowSplitWeeks?u+=r.fullWeeks+(r.daysBeforeFullWeeks?1:0)+(r.daysAfterFullWeeks?1:0):(o===n.length-1&&r.daysAfterFullWeeks&&(h=f.getMixedMonthName(o,n),i.push(f.getMixedMonthObject(h,null)),c++),u+=r.fullWeeks+c)});r.arrayEach(i,function(n,i){var r=n.index;delete n.index;t.addMixedMonth(r===null?r:i+r,n)});this.weekSectionCount=u}},{key:"addMixedMonth",value:function(n,t){n===null?this.monthList.push(t):this.monthList.splice(n,0,t)}}]),n}();t.default=e},function(n,t){"use strict";function u(n,t){return{name:n,days:r,daysBeforeFullWeeks:0,daysAfterFullWeeks:0,fullWeeks:1,index:t}}function f(n,t){var r=i(t[n].name),u=n>0?i(t[n-1].name):null,f=i(t[0].name),e=i(t[t.length-1].name);return n>0?u+"/"+r:n===t.length-1?r+"/"+f:e+"/"+r}function i(n){return n.substring(0,3)}t.__esModule=!0;t.getMixedMonthObject=u;t.getMixedMonthName=f;t.getShorthand=i;var e=t.DEC_LENGTH=31,r=t.WEEK_LENGTH=7},function(n,t,i){"use strict";function c(n){return n&&n.__esModule?n:{"default":n}}function l(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function a(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function v(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var f;t.__esModule=!0;var u=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),e=i(0),o=i(4),r=i(2),s=i(162),h=c(s);f=function(n){function t(n,i){l(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n,i));return r.dataManager=r.plugin.dataManager,r.collapsingUI=r.plugin.collapsingUI,r.rowHeaderWidthCache=null,r.trimRowsPlugin=n.trimRowsPlugin,r}return v(t,n),u(t,null,[{key:"CSS_CLASSES",get:function(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}}]),u(t,[{key:"appendLevelIndicators",value:function(n,i){var h,f;n=this.trimRowsPlugin.rowsMapper.getValueByIndex(n);var s=this.dataManager.getRowLevel(n),c=this.dataManager.getDataObject(n),u=i.getElementsByTagName("DIV")[0],l=u.querySelector("span.rowHeader"),a=u.querySelectorAll('[class^="ht_nesting"]');e.arrayEach(a,function(n){n&&u.removeChild(n)});r.addClass(i,t.CSS_CLASSES.indicatorContainer);s&&(h=l.cloneNode(!0),u.innerHTML="",o.rangeEach(0,s-1,function(){var n=document.createElement("SPAN");r.addClass(n,t.CSS_CLASSES.emptyIndicator);u.appendChild(n)}),u.appendChild(h));this.dataManager.hasChildren(c)&&(f=document.createElement("DIV"),r.addClass(i,t.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(n)?r.addClass(f,t.CSS_CLASSES.button+" "+t.CSS_CLASSES.expandButton):r.addClass(f,t.CSS_CLASSES.button+" "+t.CSS_CLASSES.collapseButton),u.appendChild(f))}},{key:"updateRowHeaderWidth",value:function(n){n||(n=this.dataManager.cache.levelCount);this.rowHeaderWidthCache=Math.max(50,11+10*n+25);this.hot.render()}}]),t}(h.default);t.default=f},function(n,t,i){"use strict";function h(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function r(n){return n&&n.__esModule?n:{"default":n}}t.__esModule=!0;i(84);i(93);i(94);i(95);i(96);i(98);i(100);i(101);i(102);i(103);i(104);i(105);i(106);i(107);i(108);i(109);i(110);i(111);i(112);i(113);i(114);i(115);i(116);i(117);i(118);i(121);i(122);i(123);i(124);i(125);i(126);i(127);i(128);i(130);i(131);i(132);i(133);i(134);i(80);i(135);i(136);i(137);i(138);i(139);i(140);i(141);i(142);i(143);i(144);i(145);i(146);i(147);i(148);i(149);var f=i(495),u=r(f),e=i(622),c=h(e),o=i(702),l=r(o),s=i(703),a=r(s);u.default.baseVersion="0.38.1";t.default=u.default},function(n,t,i){var r=i(22),u=i(20),f=i(46);n.exports=i(25)?Object.defineProperties:function(n,t){u(n);for(var i=f(t),s=i.length,e=0,o;s>e;)r.f(n,o=i[e++],t[o]);return n}},function(n,t,i){"use strict";var u=i(87),f=i(56),e=i(58),r={};i(39)(r,i(16)("iterator"),function(){return this});n.exports=function(n,t,i){n.prototype=u(r,{next:f(1,i)});e(n,t+" Iterator")}},function(n,t,i){var u=i(12),r=i(176).set;n.exports=function(n,t,i){var f=t.constructor,e;return f!==i&&typeof f=="function"&&(e=f.prototype)!==i.prototype&&u(e)&&r&&r(n,e),n}},function(n,t,i){var r=i(481);n.exports=function(n,t){return new(r(n))(t)}},function(n,t,i){var u=i(12),r=i(177),f=i(16)("species");n.exports=function(n){var t;return r(n)&&(t=n.constructor,typeof t=="function"&&(t===Array||r(t.prototype))&&(t=undefined),u(t)&&(t=t[f],t===null&&(t=undefined))),t===undefined?Array:t}},function(n,t,i){var r=i(20),u=i(71),f=i(16)("species");n.exports=function(n,t){var i=r(n).constructor,e;return i===undefined||(e=r(i)[f])==undefined?t:u(e)}},function(n){n.exports=function(n,t,i){var r=i===undefined;switch(t.length){case 0:return r?n():n.call(i);case 1:return r?n(t[0]):n.call(i,t[0]);case 2:return r?n(t[0],t[1]):n.call(i,t[0],t[1]);case 3:return r?n(t[0],t[1],t[2]):n.call(i,t[0],t[1],t[2]);case 4:return r?n(t[0],t[1],t[2],t[3]):n.call(i,t[0],t[1],t[2],t[3])}return n.apply(i,t)}},function(n,t,i){var r=i(17),s=i(97).set,e=r.MutationObserver||r.WebKitMutationObserver,u=r.process,f=r.Promise,o=i(49)(u)=="process";n.exports=function(){var n,i,t,h=function(){var r,f;for(o&&(r=u.domain)&&r.exit();n;){f=n.fn;n=n.next;try{f()}catch(e){n?t():i=undefined;throw e;}}i=undefined;r&&r.enter()},c,l,a;return o?t=function(){u.nextTick(h)}:!e||r.navigator&&r.navigator.standalone?f&&f.resolve?(a=f.resolve(),t=function(){a.then(h)}):t=function(){s.call(r,h)}:(c=!0,l=document.createTextNode(""),new e(h).observe(l,{characterData:!0}),t=function(){l.data=c=!c}),function(r){var u={fn:r,next:undefined};i&&(i.next=u);n||(n=u,t());i=u}}},function(n){n.exports=function(n){try{return{e:!1,v:n()}}catch(t){return{e:!0,v:t}}}},function(n,t,i){var r=i(20),u=i(12),f=i(180);n.exports=function(n,t){if(r(n),u(t)&&t.constructor===n)return t;var i=f.f(n),e=i.resolve;return e(t),i.promise}},function(n,t,i){var u=i(17),r=i(50),f=i(74),e=i(181),o=i(22).f;n.exports=function(n){var t=r.Symbol||(r.Symbol=f?{}:u.Symbol||{});n.charAt(0)=="_"||n in t||o(t,n,{value:e.f(n)})}},function(n,t,i){var r=i(46),u=i(78),f=i(59);n.exports=function(n){var t=r(n),i=u.f;if(i)for(var e=i(n),h=f.f,o=0,s;e.length>o;)h.call(n,s=e[o++])&&t.push(s);return t}},function(n){n.exports=Object.is||function(n,t){return n===t?n!==0||1/n==1/t:n!=n&&t!=t}},function(n,t,i){var r=i(68),u=i(47);n.exports=function(n){return function(t,i){var e=String(u(t)),f=r(i),h=e.length,o,s;return f<0||f>=h?n?"":undefined:(o=e.charCodeAt(f),o<55296||o>56319||f+1===h||(s=e.charCodeAt(f+1))<56320||s>57343?n?e.charAt(f):o:n?e.slice(f,f+2):(o-55296<<10)+(s-56320)+65536)}}},function(n,t,i){"use strict";var r=i(20);n.exports=function(){var t=r(this),n="";return t.global&&(n+="g"),t.ignoreCase&&(n+="i"),t.multiline&&(n+="m"),t.unicode&&(n+="u"),t.sticky&&(n+="y"),n}},function(n,t,i){"use strict";var u=i(41),r=i(69),f=i(28);n.exports=[].copyWithin||function(n,t){var o=u(this),s=f(o.length),i=r(n,s),e=r(t,s),l=arguments.length>2?arguments[2]:undefined,h=Math.min((l===undefined?s:r(l,s))-e,s-i),c=1;for(e<i&&i<e+h&&(c=-1,e+=h-1,i+=h-1);h-->0;)e in o?o[i]=o[e]:delete o[i],i+=c,e+=c;return o}},function(n,t,i){"use strict";var u=i(41),r=i(69),f=i(28);n.exports=function(n){for(var t=u(this),i=f(t.length),e=arguments.length,o=r(e>1?arguments[1]:undefined,i),s=e>2?arguments[2]:undefined,h=s===undefined?i:r(s,i);h>o;)t[o++]=n;return t}},function(n,t,i){var u=i(99),f=i(78),e=i(20),r=i(17).Reflect;n.exports=r&&r.ownKeys||function(n){var t=u.f(e(n)),i=f.f;return i?t.concat(i(n)):t}},function(n,t,i){"use strict";function u(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function e(n){return n&&n.__esModule?n:{"default":n}}function r(n,t){var i=new y.default(n,t||{},pi.rootInstanceSymbol);return i.init(),i}var v,b,k;t.__esModule=!0;i(84);i(93);i(94);i(95);i(96);i(98);i(100);i(101);i(102);i(103);i(104);i(105);i(106);i(107);i(108);i(109);i(110);i(111);i(112);i(113);i(114);i(115);i(116);i(117);i(118);i(121);i(122);i(123);i(124);i(125);i(126);i(127);i(128);i(130);i(131);i(132);i(133);i(134);i(80);i(135);i(136);i(137);i(138);i(139);i(140);i(141);i(142);i(143);i(144);i(145);i(146);i(147);i(148);i(149);i(496);i(497);i(498);var o=i(19),s=i(15),h=i(36),c=i(151),d=i(152),y=e(d),g=i(555),nt=e(g),p=i(9),tt=e(p),it=i(14),rt=e(it),ut=i(155),ft=e(ut),et=i(0),f=u(et),ot=i(33),st=u(ot),ht=i(81),ct=u(ht),lt=i(447),at=u(lt),vt=i(43),yt=u(vt),pt=i(35),wt=u(pt),bt=i(13),kt=u(bt),dt=i(4),gt=u(dt),ni=i(1),ti=u(ni),ii=i(153),ri=u(ii),ui=i(31),l=u(ui),fi=i(18),ei=u(fi),oi=i(2),si=u(oi),hi=i(11),ci=u(hi),li=i(556),w=u(li),ai=i(6),vi=i(450),yi=e(vi),pi=i(449),wi=i(451),bi=i(3),ki=u(bi),a=i(82);nt.default(r);r.Core=y.default;r.DefaultSettings=yi.default;r.EventManager=tt.default;r._getListenersCounter=p.getListenersCounter;r.buildDate="20/03/2018 10:43:43";r.packageName="handsontable-pro";r.version="1.18.1";v="0.38.1";v&&(r.baseVersion=v);r.hooks=rt.default.getSingleton();r.__GhostTable=ft.default;b=[f,st,ct,at,yt,wt,kt,gt,ti,ri,l,ei];k=[si,ci];r.helper={};r.dom={};f.arrayEach(b,function(n){f.arrayEach(Object.getOwnPropertyNames(n),function(t){t.charAt(0)!=="_"&&(r.helper[t]=n[t])})});f.arrayEach(k,function(n){f.arrayEach(Object.getOwnPropertyNames(n),function(t){t.charAt(0)!=="_"&&(r.dom[t]=n[t])})});r.cellTypes={};f.arrayEach(c.getRegisteredCellTypeNames(),function(n){r.cellTypes[n]=c.getCellType(n)});r.cellTypes.registerCellType=c.registerCellType;r.cellTypes.getCellType=c.getCellType;r.editors={};f.arrayEach(o.getRegisteredEditorNames(),function(n){r.editors[l.toUpperCaseFirst(n)+"Editor"]=o.getEditor(n)});r.editors.registerEditor=o.registerEditor;r.editors.getEditor=o.getEditor;r.renderers={};f.arrayEach(s.getRegisteredRendererNames(),function(n){var t=s.getRenderer(n);n==="base"&&(r.renderers.cellDecorator=t);r.renderers[l.toUpperCaseFirst(n)+"Renderer"]=t});r.renderers.registerRenderer=s.registerRenderer;r.renderers.getRenderer=s.getRenderer;r.validators={};f.arrayEach(h.getRegisteredValidatorNames(),function(n){r.validators[l.toUpperCaseFirst(n)+"Validator"]=h.getValidator(n)});r.validators.registerValidator=h.registerValidator;r.validators.getValidator=h.getValidator;r.plugins={};f.arrayEach(Object.getOwnPropertyNames(w),function(n){var t=w[n];n==="Base"?r.plugins[n+"Plugin"]=t:r.plugins[n]=t});r.plugins.registerPlugin=ai.registerPlugin;r.languages={};r.languages.dictionaryKeys=ki;r.languages.getLanguageDictionary=a.getLanguageDictionary;r.languages.getLanguagesDictionaries=a.getLanguagesDictionaries;r.languages.registerLanguageDictionary=a.registerLanguageDictionary;r.languages.getTranslatedPhrase=function(){return wi.getTranslatedPhrase.apply(undefined,arguments)};t.default=r},function(){},function(){},function(){},function(n,t,i){"use strict";function o(n){return n&&n.__esModule?n:{"default":n}}function s(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function h(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function c(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var u;t.__esModule=!0;var f=i(2),e=i(30),r=o(e);u=function(n){function t(n){s(this,t);var i=h(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return i.clone=i.makeClone(r.default.CLONE_DEBUG),i.clone.wtTable.holder.style.opacity=.4,i.clone.wtTable.holder.style.textShadow="0 0 2px #ff0000",f.addClass(i.clone.wtTable.holder.parentNode,"wtDebugVisible"),i}return c(t,n),t}(r.default);r.default.registerOverlay(r.default.CLONE_DEBUG,u);t.default=u},function(n,t,i){function r(n){return i(f(n))}function f(n){var t=u[n];if(!(t+1))throw new Error("Cannot find module '"+n+"'.");return t}var u={"./af":195,"./af.js":195,"./ar":196,"./ar-dz":197,"./ar-dz.js":197,"./ar-kw":198,"./ar-kw.js":198,"./ar-ly":199,"./ar-ly.js":199,"./ar-ma":200,"./ar-ma.js":200,"./ar-sa":201,"./ar-sa.js":201,"./ar-tn":202,"./ar-tn.js":202,"./ar.js":196,"./az":203,"./az.js":203,"./be":204,"./be.js":204,"./bg":205,"./bg.js":205,"./bm":206,"./bm.js":206,"./bn":207,"./bn.js":207,"./bo":208,"./bo.js":208,"./br":209,"./br.js":209,"./bs":210,"./bs.js":210,"./ca":211,"./ca.js":211,"./cs":212,"./cs.js":212,"./cv":213,"./cv.js":213,"./cy":214,"./cy.js":214,"./da":215,"./da.js":215,"./de":216,"./de-at":217,"./de-at.js":217,"./de-ch":218,"./de-ch.js":218,"./de.js":216,"./dv":219,"./dv.js":219,"./el":220,"./el.js":220,"./en-au":221,"./en-au.js":221,"./en-ca":222,"./en-ca.js":222,"./en-gb":223,"./en-gb.js":223,"./en-ie":224,"./en-ie.js":224,"./en-nz":225,"./en-nz.js":225,"./eo":226,"./eo.js":226,"./es":227,"./es-do":228,"./es-do.js":228,"./es-us":229,"./es-us.js":229,"./es.js":227,"./et":230,"./et.js":230,"./eu":231,"./eu.js":231,"./fa":232,"./fa.js":232,"./fi":233,"./fi.js":233,"./fo":234,"./fo.js":234,"./fr":235,"./fr-ca":236,"./fr-ca.js":236,"./fr-ch":237,"./fr-ch.js":237,"./fr.js":235,"./fy":238,"./fy.js":238,"./gd":239,"./gd.js":239,"./gl":240,"./gl.js":240,"./gom-latn":241,"./gom-latn.js":241,"./gu":242,"./gu.js":242,"./he":243,"./he.js":243,"./hi":244,"./hi.js":244,"./hr":245,"./hr.js":245,"./hu":246,"./hu.js":246,"./hy-am":247,"./hy-am.js":247,"./id":248,"./id.js":248,"./is":249,"./is.js":249,"./it":250,"./it.js":250,"./ja":251,"./ja.js":251,"./jv":252,"./jv.js":252,"./ka":253,"./ka.js":253,"./kk":254,"./kk.js":254,"./km":255,"./km.js":255,"./kn":256,"./kn.js":256,"./ko":257,"./ko.js":257,"./ky":258,"./ky.js":258,"./lb":259,"./lb.js":259,"./lo":260,"./lo.js":260,"./lt":261,"./lt.js":261,"./lv":262,"./lv.js":262,"./me":263,"./me.js":263,"./mi":264,"./mi.js":264,"./mk":265,"./mk.js":265,"./ml":266,"./ml.js":266,"./mr":267,"./mr.js":267,"./ms":268,"./ms-my":269,"./ms-my.js":269,"./ms.js":268,"./mt":270,"./mt.js":270,"./my":271,"./my.js":271,"./nb":272,"./nb.js":272,"./ne":273,"./ne.js":273,"./nl":274,"./nl-be":275,"./nl-be.js":275,"./nl.js":274,"./nn":276,"./nn.js":276,"./pa-in":277,"./pa-in.js":277,"./pl":278,"./pl.js":278,"./pt":279,"./pt-br":280,"./pt-br.js":280,"./pt.js":279,"./ro":281,"./ro.js":281,"./ru":282,"./ru.js":282,"./sd":283,"./sd.js":283,"./se":284,"./se.js":284,"./si":285,"./si.js":285,"./sk":286,"./sk.js":286,"./sl":287,"./sl.js":287,"./sq":288,"./sq.js":288,"./sr":289,"./sr-cyrl":290,"./sr-cyrl.js":290,"./sr.js":289,"./ss":291,"./ss.js":291,"./sv":292,"./sv.js":292,"./sw":293,"./sw.js":293,"./ta":294,"./ta.js":294,"./te":295,"./te.js":295,"./tet":296,"./tet.js":296,"./th":297,"./th.js":297,"./tl-ph":298,"./tl-ph.js":298,"./tlh":299,"./tlh.js":299,"./tr":300,"./tr.js":300,"./tzl":301,"./tzl.js":301,"./tzm":302,"./tzm-latn":303,"./tzm-latn.js":303,"./tzm.js":302,"./uk":304,"./uk.js":304,"./ur":305,"./ur.js":305,"./uz":306,"./uz-latn":307,"./uz-latn.js":307,"./uz.js":306,"./vi":308,"./vi.js":308,"./x-pseudo":309,"./x-pseudo.js":309,"./yo":310,"./yo.js":310,"./zh-cn":311,"./zh-cn.js":311,"./zh-hk":312,"./zh-hk.js":312,"./zh-tw":313,"./zh-tw.js":313};r.keys=function(){return Object.keys(u)};r.resolve=f;n.exports=r;r.id=500},function(n,t,i){"use strict";function s(n){return n&&n.__esModule?n:{"default":n}}function h(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function c(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function l(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var f;t.__esModule=!0;var e=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),r=i(2),o=i(30),u=s(o);f=function(n){function t(n){h(this,t);var i=c(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return i.clone=i.makeClone(u.default.CLONE_LEFT),i}return l(t,n),e(t,[{key:"shouldBeRendered",value:function(){return!!(this.wot.getSetting("fixedColumnsLeft")||this.wot.getSetting("rowHeaders").length)}},{key:"resetFixedPosition",value:function(){if(this.needFullRender&&this.wot.wtTable.holder.parentNode){var i=this.clone.wtTable.holder.parentNode,u=0,f=this.wot.getSetting("preventOverflow");if(this.trimmingContainer!==window||f&&f==="horizontal")u=this.getScrollPosition(),r.resetCssTransform(i);else{var e=this.wot.wtTable.hider.getBoundingClientRect(),o=Math.ceil(e.left),s=Math.ceil(e.right),t=void 0,n=void 0;n=this.wot.wtTable.hider.style.top;n=n===""?0:n;t=o<0&&s-i.offsetWidth>0?-o:0;u=t;t+="px";r.setOverlayPosition(i,t,n)}this.adjustHeaderBordersPosition(u);this.adjustElementsSize()}}},{key:"setScrollPosition",value:function(n){this.mainTableScrollableElement===window?window.scrollTo(n,r.getWindowScrollTop()):this.mainTableScrollableElement.scrollLeft=n}},{key:"onScroll",value:function(){this.wot.getSetting("onScrollVertically")}},{key:"sumCellSizes",value:function(n,t){for(var i=0,r=this.wot.wtSettings.defaultColumnWidth;n<t;)i+=this.wot.wtTable.getStretchedColumnWidth(n)||r,n++;return i}},{key:"adjustElementsSize",value:function(){var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:!1;this.updateTrimmingContainer();(this.needFullRender||n)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize(),n||(this.areElementSizesAdjusted=!0))}},{key:"adjustRootElementSize",value:function(){var u=this.wot.wtTable.holder,f=u.clientHeight===u.offsetHeight?0:r.getScrollbarWidth(),e=this.clone.wtTable.holder.parentNode,n=e.style,o=this.wot.getSetting("preventOverflow"),t=void 0,i;this.trimmingContainer!==window||o==="vertical"?(i=this.wot.wtViewport.getWorkspaceHeight()-f,i=Math.min(i,r.innerHeight(this.wot.wtTable.wtRootElement)),n.height=i+"px"):n.height="";this.clone.wtTable.holder.style.height=n.height;t=r.outerWidth(this.clone.wtTable.TABLE);n.width=(t===0?t:t+4)+"px"}},{key:"adjustRootChildrenSize",value:function(){var n=r.getScrollbarWidth();this.clone.wtTable.hider.style.height=this.hider.style.height;this.clone.wtTable.holder.style.height=this.clone.wtTable.holder.parentNode.style.height;n===0&&(n=30);this.clone.wtTable.holder.style.width=parseInt(this.clone.wtTable.holder.parentNode.style.width,10)+n+"px"}},{key:"applyToDOM",value:function(){var n=this.wot.getSetting("totalColumns");if(this.areElementSizesAdjusted||this.adjustElementsSize(),typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style.left=this.wot.wtViewport.columnsRenderCalculator.startPosition+"px";else if(n===0)this.spreader.style.left="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.spreader.style.right="";this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){this.clone.wtTable.spreader.style.top=typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.wot.wtViewport.rowsRenderCalculator.startPosition+"px":""}},{key:"scrollTo",value:function(n,t){var i=this.getTableParentOffset(),e=this.wot.cloneSource?this.wot.cloneSource:this.wot,u=e.wtTable.holder,f=0;t&&u.offsetWidth!==u.clientWidth&&(f=r.getScrollbarWidth());t?(i+=this.sumCellSizes(0,n+1),i-=this.wot.wtViewport.getViewportWidth()):i+=this.sumCellSizes(this.wot.getSetting("fixedColumnsLeft"),n);i+=f;this.setScrollPosition(i)}},{key:"getTableParentOffset",value:function(){var t=this.wot.getSetting("preventOverflow"),n=0;return t||this.trimmingContainer!==window||(n=this.wot.wtTable.holderOffset.left),n}},{key:"getScrollPosition",value:function(){return r.getScrollLeft(this.mainTableScrollableElement)}},{key:"adjustHeaderBordersPosition",value:function(n){var t=this.wot.wtTable.holder.parentNode,u=this.wot.getSetting("rowHeaders"),f=this.wot.getSetting("fixedColumnsLeft"),e=this.wot.getSetting("totalRows"),i;e?r.removeClass(t,"emptyRows"):r.addClass(t,"emptyRows");f&&!u.length?r.addClass(t,"innerBorderLeft"):!f&&u.length&&(i=r.hasClass(t,"innerBorderLeft"),n?r.addClass(t,"innerBorderLeft"):r.removeClass(t,"innerBorderLeft"),(!i&&n||i&&!n)&&this.wot.wtOverlays.adjustElementsSize())}}]),t}(u.default);u.default.registerOverlay(u.default.CLONE_LEFT,f);t.default=f},function(n,t,i){"use strict";function h(n){return n&&n.__esModule?n:{"default":n}}function c(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function l(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function a(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var f;t.__esModule=!0;var e=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),r=i(2),o=i(0),s=i(30),u=h(s);f=function(n){function t(n){c(this,t);var i=l(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return i.clone=i.makeClone(u.default.CLONE_TOP),i}return a(t,n),e(t,[{key:"shouldBeRendered",value:function(){return!!(this.wot.getSetting("fixedRowsTop")||this.wot.getSetting("columnHeaders").length)}},{key:"resetFixedPosition",value:function(){if(this.needFullRender&&this.wot.wtTable.holder.parentNode){var i=this.clone.wtTable.holder.parentNode,u=0,f=this.wot.getSetting("preventOverflow");if(this.trimmingContainer!==window||f&&f==="vertical")u=this.getScrollPosition(),r.resetCssTransform(i);else{var e=this.wot.wtTable.hider.getBoundingClientRect(),o=Math.ceil(e.top),s=Math.ceil(e.bottom),n=void 0,t=void 0;n=this.wot.wtTable.hider.style.left;n=n===""?0:n;t=o<0&&s-i.offsetHeight>0?-o:0;u=t;t+="px";r.setOverlayPosition(i,n,t)}this.adjustHeaderBordersPosition(u);this.adjustElementsSize()}}},{key:"setScrollPosition",value:function(n){this.mainTableScrollableElement===window?window.scrollTo(r.getWindowScrollLeft(),n):this.mainTableScrollableElement.scrollTop=n}},{key:"onScroll",value:function(){this.wot.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function(n,t){for(var r=0,u=this.wot.wtSettings.settings.defaultRowHeight,i;n<t;)i=this.wot.wtTable.getRowHeight(n),r+=i===void 0?u:i,n++;return r}},{key:"adjustElementsSize",value:function(){var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:!1;this.updateTrimmingContainer();(this.needFullRender||n)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize(),n||(this.areElementSizesAdjusted=!0))}},{key:"adjustRootElementSize",value:function(){var u=this.wot.wtTable.holder,f=u.clientWidth===u.offsetWidth?0:r.getScrollbarWidth(),e=this.clone.wtTable.holder.parentNode,n=e.style,o=this.wot.getSetting("preventOverflow"),t=void 0,i;this.trimmingContainer!==window||o==="horizontal"?(i=this.wot.wtViewport.getWorkspaceWidth()-f,i=Math.min(i,r.innerWidth(this.wot.wtTable.wtRootElement)),n.width=i+"px"):n.width="";this.clone.wtTable.holder.style.width=n.width;t=r.outerHeight(this.clone.wtTable.TABLE);n.height=(t===0?t:t+4)+"px"}},{key:"adjustRootChildrenSize",value:function(){var n=r.getScrollbarWidth();this.clone.wtTable.hider.style.width=this.hider.style.width;this.clone.wtTable.holder.style.width=this.clone.wtTable.holder.parentNode.style.width;n===0&&(n=30);this.clone.wtTable.holder.style.height=parseInt(this.clone.wtTable.holder.parentNode.style.height,10)+n+"px"}},{key:"applyToDOM",value:function(){var n=this.wot.getSetting("totalRows");if(this.areElementSizesAdjusted||this.adjustElementsSize(),typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=this.wot.wtViewport.rowsRenderCalculator.startPosition+"px";else if(n===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="";this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){this.clone.wtTable.spreader.style.left=typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?this.wot.wtViewport.columnsRenderCalculator.startPosition+"px":""}},{key:"scrollTo",value:function(n,t){var i=this.getTableParentOffset(),o=this.wot.cloneSource?this.wot.cloneSource:this.wot,u=o.wtTable.holder,f=0;if(t&&u.offsetHeight!==u.clientHeight&&(f=r.getScrollbarWidth()),t){var s=this.wot.getSetting("fixedRowsBottom"),h=this.wot.getSetting("fixedRowsTop"),e=this.wot.getSetting("totalRows");i+=this.sumCellSizes(0,n+1);i-=this.wot.wtViewport.getViewportHeight()-this.sumCellSizes(e-s,e);i+=1}else i+=this.sumCellSizes(this.wot.getSetting("fixedRowsTop"),n);i+=f;this.setScrollPosition(i)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===window?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return r.getScrollTop(this.mainTableScrollableElement)}},{key:"redrawSelectionBorders",value:function(n){if(n&&n.cellRange){var t=n.getBorder(this.wot),i=n.getCorners();t.disappear();t.appear(i)}}},{key:"redrawAllSelectionsBorders",value:function(){var t=this,n=this.wot.selections;this.redrawSelectionBorders(n.getCell());o.arrayEach(n.getAreas(),function(n){t.redrawSelectionBorders(n)});this.redrawSelectionBorders(n.getFill());this.wot.wtTable.wot.wtOverlays.leftOverlay.refresh()}},{key:"adjustHeaderBordersPosition",value:function(n){var t=this.wot.wtTable.holder.parentNode,e=this.wot.getSetting("totalColumns"),f,i,u;if(e?r.removeClass(t,"emptyColumns"):r.addClass(t,"emptyColumns"),this.wot.getSetting("fixedRowsTop")===0&&this.wot.getSetting("columnHeaders").length>0&&(f=r.hasClass(t,"innerBorderTop"),n||this.wot.getSetting("totalRows")===0?r.addClass(t,"innerBorderTop"):r.removeClass(t,"innerBorderTop"),(!f&&n||f&&!n)&&(this.wot.wtOverlays.adjustElementsSize(),this.redrawAllSelectionsBorders())),this.wot.getSetting("rowHeaders").length===0&&(i=this.clone.wtTable.THEAD.querySelectorAll("th:nth-of-type(2)"),i))for(u=0;u<i.length;u++)i[u].style["border-left-width"]=0}}]),t}(u.default);u.default.registerOverlay(u.default.CLONE_TOP,f);t.default=f},function(n,t,i){"use strict";function s(n){return n&&n.__esModule?n:{"default":n}}function h(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function c(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function l(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var f;t.__esModule=!0;var e=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),r=i(2),o=i(30),u=s(o);f=function(n){function t(n){h(this,t);var i=c(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return i.clone=i.makeClone(u.default.CLONE_TOP_LEFT_CORNER),i}return l(t,n),e(t,[{key:"shouldBeRendered",value:function(){return!!((this.wot.getSetting("fixedRowsTop")||this.wot.getSetting("columnHeaders").length)&&(this.wot.getSetting("fixedColumnsLeft")||this.wot.getSetting("rowHeaders").length))}},{key:"resetFixedPosition",value:function(){if(this.updateTrimmingContainer(),this.wot.wtTable.holder.parentNode){var n=this.clone.wtTable.holder.parentNode,u=r.outerHeight(this.clone.wtTable.TABLE),f=r.outerWidth(this.clone.wtTable.TABLE),t=this.wot.getSetting("preventOverflow");if(this.trimmingContainer===window){var i=this.wot.wtTable.hider.getBoundingClientRect(),e=Math.ceil(i.top),o=Math.ceil(i.left),c=Math.ceil(i.bottom),l=Math.ceil(i.right),s="0",h="0";t&&t!=="vertical"||o<0&&l-n.offsetWidth>0&&(s=-o+"px");t&&t!=="horizontal"||e<0&&c-n.offsetHeight>0&&(h=-e+"px");r.setOverlayPosition(n,s,h)}else r.resetCssTransform(n);n.style.height=(u===0?u:u+4)+"px";n.style.width=(f===0?f:f+4)+"px"}}}]),t}(u.default);u.default.registerOverlay(u.default.CLONE_TOP_LEFT_CORNER,f);t.default=f},function(n,t,i){"use strict";function u(n){return n&&n.__esModule?n:{"default":n}}function y(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var f;t.__esModule=!0;var e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},o=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),r=i(2),s=i(321),h=u(s),c=i(61),l=u(c),a=i(150),v=u(a);f=function(){function n(t,i){y(this,n);this.settings=t;this.cellRange=i||null;this.instanceBorders={};this.classNames=[this.settings.className];this.classNameGenerator=this.linearClassNameGenerator(this.settings.className,this.settings.layerLevel)}return o(n,[{key:"getBorder",value:function(n){return this.instanceBorders[n.guid]||(this.instanceBorders[n.guid]=new h.default(n,this.settings)),this.instanceBorders[n.guid]}},{key:"isEmpty",value:function(){return this.cellRange===null}},{key:"add",value:function(n){return this.isEmpty()?this.cellRange=new v.default(n,n,n):this.cellRange.expand(n),this}},{key:"replace",value:function(n,t){if(!this.isEmpty()){if(this.cellRange.from.isEqual(n))return this.cellRange.from=t,!0;if(this.cellRange.to.isEqual(n))return this.cellRange.to=t,!0}return!1}},{key:"clear",value:function(){return this.cellRange=null,this}},{key:"getCorners",value:function(){var n=this.cellRange.getTopLeftCorner(),t=this.cellRange.getBottomRightCorner();return[n.row,n.col,t.row,t.col]}},{key:"addClassAtCoords",value:function(n,t,i,u){var o=arguments.length>4&&arguments[4]!==undefined?arguments[4]:!1,f=n.wtTable.getCell(new l.default(t,i));return(typeof f=="undefined"?"undefined":e(f))==="object"&&(o&&(u=this.classNameGenerator(f),this.classNames.includes(u)||this.classNames.push(u)),r.addClass(f,u)),this}},{key:"linearClassNameGenerator",value:function(n,t){return function i(u){var o=arguments.length>1&&arguments[1]!==undefined?arguments[1]:-1,f,e,s,h;return t===0||o===0?n:(f=o>=0?o:t,e=n,f-=1,s=f===0?n:n+"-"+f,r.hasClass(u,s)?(h=f+1,e=n+"-"+h):e=i(u,f),e)}}},{key:"draw",value:function(n){var e,o,s,h,c;if(this.isEmpty()){this.settings.border&&this.getBorder(n).disappear();return}var a=n.wtTable.getRenderedRowsCount(),l=n.wtTable.getRenderedColumnsCount(),t=this.getCorners(),u=void 0,i=void 0,f=void 0;for(e=0;e<l;e++)i=n.wtTable.columnFilter.renderedToSource(e),i>=t[1]&&i<=t[3]&&(f=n.wtTable.getColumnHeader(i),f&&(o=[],this.settings.highlightHeaderClassName&&o.push(this.settings.highlightHeaderClassName),this.settings.highlightColumnClassName&&o.push(this.settings.highlightColumnClassName),r.addClass(f,o)));for(s=0;s<a;s++)for(u=n.wtTable.rowFilter.renderedToSource(s),u>=t[0]&&u<=t[2]&&(f=n.wtTable.getRowHeader(u),f&&(h=[],this.settings.highlightHeaderClassName&&h.push(this.settings.highlightHeaderClassName),this.settings.highlightRowClassName&&h.push(this.settings.highlightRowClassName),r.addClass(f,h))),c=0;c<l;c++)i=n.wtTable.columnFilter.renderedToSource(c),u>=t[0]&&u<=t[2]&&i>=t[1]&&i<=t[3]?this.settings.className&&this.addClassAtCoords(n,u,i,this.settings.className,this.settings.markIntersections):u>=t[0]&&u<=t[2]?this.settings.highlightRowClassName&&this.addClassAtCoords(n,u,i,this.settings.highlightRowClassName):i>=t[1]&&i<=t[3]&&this.settings.highlightColumnClassName&&this.addClassAtCoords(n,u,i,this.settings.highlightColumnClassName);n.getSetting("onBeforeDrawBorders",t,this.settings.className);this.settings.border&&this.getBorder(n).appear(t)}}]),n}();t.default=f},function(n){"use strict";function t(){function h(n){return n.currentStyle||document.defaultView.getComputedStyle(n)}var t={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},n,s=document.body,o=document.createTextNode(""),i=document.createElement("SPAN"),f=function(n,t,i){n.attachEvent?n.attachEvent("on"+t,i):n.addEventListener(t,i,!1)},e=function(n,t,i){n.removeEventListener?n.removeEventListener(t,i,!1):n.detachEvent("on"+t,i)},u=function(r){var u,f;r?/^[a-zA-Z \.,\\\/\|0-9]$/.test(r)||(r="."):r="";o.textContent!==void 0?o.textContent=n.value+r:o.data=n.value+r;i.style.fontSize=h(n).fontSize;i.style.fontFamily=h(n).fontFamily;i.style.whiteSpace="pre";s.appendChild(i);u=i.clientWidth+2;s.removeChild(i);n.style.height=t.minHeight+"px";n.style.width=t.minWidth>u?t.minWidth+"px":u>t.maxWidth?t.maxWidth+"px":u+"px";f=n.scrollHeight?n.scrollHeight-1:0;t.minHeight>f?n.style.height=t.minHeight+"px":t.maxHeight<f?(n.style.height=t.maxHeight+"px",n.style.overflowY="visible"):n.style.height=f+"px"},r=function(){window.setTimeout(u,0)},c=function(r){var u,f,e,s;r&&r.minHeight&&(r.minHeight=="inherit"?t.minHeight=n.clientHeight:(u=parseInt(r.minHeight),isNaN(u)||(t.minHeight=u)));r&&r.maxHeight&&(r.maxHeight=="inherit"?t.maxHeight=n.clientHeight:(f=parseInt(r.maxHeight),isNaN(f)||(t.maxHeight=f)));r&&r.minWidth&&(r.minWidth=="inherit"?t.minWidth=n.clientWidth:(e=parseInt(r.minWidth),isNaN(e)||(t.minWidth=e)));r&&r.maxWidth&&(r.maxWidth=="inherit"?t.maxWidth=n.clientWidth:(s=parseInt(r.maxWidth),isNaN(s)||(t.maxWidth=s)));i.firstChild||(i.className="autoResize",i.style.display="inline-block",i.appendChild(o))},l=function(i,e,o){n=i;c(e);n.nodeName=="TEXTAREA"&&(n.style.resize="none",n.style.overflowY="",n.style.height=t.minHeight+"px",n.style.minWidth=t.minWidth+"px",n.style.maxWidth=t.maxWidth+"px",n.style.overflowY="hidden");o&&(f(n,"change",u),f(n,"cut",r),f(n,"paste",r),f(n,"drop",r),f(n,"keydown",r),f(n,"focus",u));u()};return{init:function(n,t,i){l(n,t,i)},unObserve:function(){e(n,"change",u);e(n,"cut",r);e(n,"paste",r);e(n,"drop",r);e(n,"keydown",r);e(n,"focus",u)},resize:u}}!0&&(n.exports=t)},function(n,t,i){"use strict";function s(n){return n&&n.__esModule?n:{"default":n}}function h(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function c(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function l(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var r;t.__esModule=!0;var u=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),f=i(60),e=s(f),o=i(2);r=function(n){function t(){return h(this,t),c(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return l(t,n),u(t,[{key:"beginEditing",value:function(n,t){if(t.type==="mouseup"){var i=this.TD.querySelector('input[type="checkbox"]');o.hasClass(i,"htBadValue")||i.click()}}},{key:"finishEditing",value:function(){}},{key:"init",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"focus",value:function(){}}]),t}(e.default);t.default=r},function(n,t,i){"use strict";function f(n){return n&&n.__esModule?n:{"default":n}}function g(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function nt(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function tt(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var s;t.__esModule=!0;var h=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),r=function c(n,t,i){var r,u,f;return n===null&&(n=Function.prototype),r=Object.getOwnPropertyDescriptor(n,t),r===undefined?(u=Object.getPrototypeOf(n),u===null?undefined:c(u,t,i)):"value"in r?r.value:(f=r.get,f===undefined)?undefined:f.call(i)},l=i(23),u=f(l),a=i(508),e=f(a);i(511);var o=i(2),v=i(1),y=i(9),p=f(y),w=i(18),b=i(11),k=i(62),d=f(k);s=function(n){function t(n){g(this,t);var i=nt(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return i.defaultDateFormat="DD/MM/YYYY",i.isCellEdited=!1,i.parentDestroyed=!1,i}return tt(t,n),h(t,[{key:"init",value:function(){var n=this;if(typeof u.default!="function")throw new Error("You need to include moment.js to your project.");if(typeof e.default!="function")throw new Error("You need to include Pikaday to your project.");r(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"init",this).call(this);this.instance.addHook("afterDestroy",function(){n.parentDestroyed=!0;n.destroyElements()})}},{key:"createElements",value:function(){r(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"createElements",this).call(this);this.datePicker=document.createElement("DIV");this.datePickerStyle=this.datePicker.style;this.datePickerStyle.position="absolute";this.datePickerStyle.top=0;this.datePickerStyle.left=0;this.datePickerStyle.zIndex=9999;o.addClass(this.datePicker,"htDatepickerHolder");document.body.appendChild(this.datePicker);this.$datePicker=new e.default(this.getDatePickerConfig());var n=new p.default(this);n.addEventListener(this.datePicker,"mousedown",function(n){return b.stopPropagation(n)});this.hideDatepicker()}},{key:"destroyElements",value:function(){this.$datePicker.destroy()}},{key:"prepare",value:function(n,i,u,f,e,o){this._opened=!1;r(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"prepare",this).call(this,n,i,u,f,e,o)}},{key:"open",value:function(){var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;r(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"open",this).call(this);this.showDatepicker(n)}},{key:"close",value:function(){var n=this;this._opened=!1;this.instance._registerTimeout(setTimeout(function(){n.instance._refreshBorders()},0));r(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"close",this).call(this)}},{key:"finishEditing",value:function(){var i=arguments.length>0&&arguments[0]!==undefined?arguments[0]:!1,u=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!1,n;i&&(n=this.originalValue,n!==void 0&&this.setValue(n));this.hideDatepicker();r(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"finishEditing",this).call(this,i,u)}},{key:"showDatepicker",value:function(n){this.$datePicker.config(this.getDatePickerConfig());var r=this.TD.getBoundingClientRect(),i=this.cellProperties.dateFormat||this.defaultDateFormat,f=this.$datePicker.config(),t=void 0,e=this.instance.view.isMouseDown(),s=n?w.isMetaKey(n.keyCode):!1;this.datePickerStyle.top=window.pageYOffset+r.top+o.outerHeight(this.TD)+"px";this.datePickerStyle.left=window.pageXOffset+r.left+"px";this.$datePicker._onInputFocus=function(){};f.format=i;this.originalValue?(t=this.originalValue,u.default(t,i,!0).isValid()&&this.$datePicker.setMoment(u.default(t,i),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),s||e||this.setValue("")):this.cellProperties.defaultDate?(t=this.cellProperties.defaultDate,f.defaultDate=t,u.default(t,i,!0).isValid()&&this.$datePicker.setMoment(u.default(t,i),!0),s||e||this.setValue("")):this.$datePicker.gotoToday();this.datePickerStyle.display="block";this.$datePicker.show()}},{key:"hideDatepicker",value:function(){this.datePickerStyle.display="none";this.$datePicker.hide()}},{key:"getDatePickerConfig",value:function(){var t=this,f=this.TEXTAREA,n={},i,r;return this.cellProperties&&this.cellProperties.datePickerConfig&&v.deepExtend(n,this.cellProperties.datePickerConfig),i=n.onSelect,r=n.onClose,n.field=f,n.trigger=f,n.container=this.datePicker,n.bound=!1,n.format=n.format||this.defaultDateFormat,n.reposition=n.reposition||!1,n.onSelect=function(n){isNaN(n.getTime())||(n=u.default(n).format(t.cellProperties.dateFormat||t.defaultDateFormat));t.setValue(n);t.hideDatepicker();i&&i()},n.onClose=function(){t.parentDestroyed||t.finishEditing(!1);r&&r()},n}}]),t}(d.default);t.default=s},function(n,t,i){
/*!
 * Pikaday
 *
 * Copyright © 2014 David Bushell | BSD & MIT license | https://github.com/dbushell/Pikaday
 */
(function(t,r){"use strict";var u;if(1){try{u=i(509)}catch(f){}n.exports=r(u)}else typeof define=="function"&&define.amd?define(function(n){try{u=n("moment")}catch(t){}return r(u)}):t.Pikaday=r(t.moment)})(this,function(n){"use strict";var o=typeof n=="function",l=!!window.addEventListener,t=window.document,a=window.setTimeout,u=function(n,t,i,r){l?n.addEventListener(t,i,!!r):n.attachEvent("on"+t,i)},e=function(n,t,i,r){l?n.removeEventListener(t,i,!!r):n.detachEvent("on"+t,i)},y=function(n,i,r){var u;t.createEvent?(u=t.createEvent("HTMLEvents"),u.initEvent(i,!0,!1),u=s(u,r),n.dispatchEvent(u)):t.createEventObject&&(u=t.createEventObject(),u=s(u,r),n.fireEvent("on"+i,u))},d=function(n){return n.trim?n.trim():n.replace(/^\s+|\s+$/g,"")},i=function(n,t){return(" "+n.className+" ").indexOf(" "+t+" ")!==-1},g=function(n,t){i(n,t)||(n.className=n.className===""?t:n.className+" "+t)},nt=function(n,t){n.className=d((" "+n.className+" ").replace(" "+t+" "," "))},v=function(n){return/Array/.test(Object.prototype.toString.call(n))},r=function(n){return/Date/.test(Object.prototype.toString.call(n))&&!isNaN(n.getTime())},tt=function(n){var t=n.getDay();return t===0||t===6},it=function(n){return n%4==0&&n%100!=0||n%400==0},p=function(n,t){return[31,it(n)?29:28,31,30,31,30,31,31,30,31,30,31][t]},h=function(n){r(n)&&n.setHours(0,0,0,0)},c=function(n,t){return n.getTime()===t.getTime()},s=function(n,t,i){var u,f;for(u in t)f=n[u]!==undefined,f&&typeof t[u]=="object"&&t[u]!==null&&t[u].nodeName===undefined?r(t[u])?i&&(n[u]=new Date(t[u].getTime())):v(t[u])?i&&(n[u]=t[u].slice(0)):n[u]=s({},t[u],i):(i||!f)&&(n[u]=t[u]);return n},w=function(n){return n.month<0&&(n.year-=Math.ceil(Math.abs(n.month)/12),n.month+=12),n.month>11&&(n.year+=Math.floor(Math.abs(n.month)/12),n.month-=12),n},f={field:null,bound:undefined,position:"bottom left",reposition:!0,format:"YYYY-MM-DD",defaultDate:null,setDefaultDate:!1,firstDay:0,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,minYear:0,maxYear:9999,minMonth:undefined,maxMonth:undefined,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:undefined,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,onSelect:null,onOpen:null,onClose:null,onDraw:null},b=function(n,t,i){for(t+=n.firstDay;t>=7;)t-=7;return i?n.i18n.weekdaysShort[t]:n.i18n.weekdays[t]},rt=function(n){var t=[],i="false";if(n.isEmpty)if(n.showDaysInNextAndPreviousMonths)t.push("is-outside-current-month");else return'<td class="is-empty"><\/td>';return n.isDisabled&&t.push("is-disabled"),n.isToday&&t.push("is-today"),n.isSelected&&(t.push("is-selected"),i="true"),n.isInRange&&t.push("is-inrange"),n.isStartRange&&t.push("is-startrange"),n.isEndRange&&t.push("is-endrange"),'<td data-day="'+n.day+'" class="'+t.join(" ")+'" aria-selected="'+i+'"><button class="pika-button pika-day" type="button" data-pika-year="'+n.year+'" data-pika-month="'+n.month+'" data-pika-day="'+n.day+'">'+n.day+"<\/button><\/td>"},ut=function(n,t,i){var r=new Date(i,0,1),u=Math.ceil(((new Date(i,t,n)-r)/864e5+r.getDay()+1)/7);return'<td class="pika-week">'+u+"<\/td>"},ft=function(n,t){return"<tr>"+(t?n.reverse():n).join("")+"<\/tr>"},et=function(n){return"<tbody>"+n.join("")+"<\/tbody>"},ot=function(n){var t,i=[];for(n.showWeekNumber&&i.push("<th><\/th>"),t=0;t<7;t++)i.push('<th scope="col"><abbr title="'+b(n,t)+'">'+b(n,t,!0)+"<\/abbr><\/th>");return"<thead><tr>"+(n.isRTL?i.reverse():i).join("")+"<\/tr><\/thead>"},st=function(n,t,i,r,u,f){for(var c,e=n._o,y=i===e.minYear,p=i===e.maxYear,h='<div id="'+f+'" class="pika-title" role="heading" aria-live="assertive">',l,a,w=!0,b=!0,s=[],o=0;o<12;o++)s.push('<option value="'+(i===u?o-t:12+o-t)+'"'+(o===r?' selected="selected"':"")+(y&&o<e.minMonth||p&&o>e.maxMonth?'disabled="disabled"':"")+">"+e.i18n.months[o]+"<\/option>");for(l='<div class="pika-label">'+e.i18n.months[r]+'<select class="pika-select pika-select-month" tabindex="-1">'+s.join("")+"<\/select><\/div>",v(e.yearRange)?(o=e.yearRange[0],c=e.yearRange[1]+1):(o=i-e.yearRange,c=1+i+e.yearRange),s=[];o<c&&o<=e.maxYear;o++)o>=e.minYear&&s.push('<option value="'+o+'"'+(o===i?' selected="selected"':"")+">"+o+"<\/option>");return a='<div class="pika-label">'+i+e.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+s.join("")+"<\/select><\/div>",h+=e.showMonthAfterYear?a+l:l+a,y&&(r===0||e.minMonth>=r)&&(w=!1),p&&(r===11||e.maxMonth<=r)&&(b=!1),t===0&&(h+='<button class="pika-prev'+(w?"":" is-disabled")+'" type="button">'+e.i18n.previousMonth+"<\/button>"),t===n._o.numberOfMonths-1&&(h+='<button class="pika-next'+(b?"":" is-disabled")+'" type="button">'+e.i18n.nextMonth+"<\/button>"),h+"<\/div>"},ht=function(n,t,i){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+i+'">'+ot(n)+et(t)+"<\/table>"},k=function(f){var e=this,s=e.config(f),h;e._onMouseDown=function(n){if(e._v){n=n||window.event;var t=n.target||n.srcElement;if(t)if(i(t,"is-disabled")||(!i(t,"pika-button")||i(t,"is-empty")||i(t.parentNode,"is-disabled")?i(t,"pika-prev")?e.prevMonth():i(t,"pika-next")&&e.nextMonth():(e.setDate(new Date(t.getAttribute("data-pika-year"),t.getAttribute("data-pika-month"),t.getAttribute("data-pika-day"))),s.bound&&a(function(){e.hide();s.field&&s.field.blur()},100))),i(t,"pika-select"))e._c=!0;else if(n.preventDefault)n.preventDefault();else return n.returnValue=!1,!1}};e._onChange=function(n){n=n||window.event;var t=n.target||n.srcElement;t&&(i(t,"pika-select-month")?e.gotoMonth(t.value):i(t,"pika-select-year")&&e.gotoYear(t.value))};e._onKeyChange=function(n){if(n=n||window.event,e.isVisible())switch(n.keyCode){case 13:case 27:s.field.blur();break;case 37:n.preventDefault();e.adjustDate("subtract",1);break;case 38:e.adjustDate("subtract",7);break;case 39:e.adjustDate("add",1);break;case 40:e.adjustDate("add",7)}};e._onInputChange=function(t){var i;t.firedBy!==e&&(o?(i=n(s.field.value,s.format,s.formatStrict),i=i&&i.isValid()?i.toDate():null):i=new Date(Date.parse(s.field.value)),r(i)&&e.setDate(i),e._v||e.show())};e._onInputFocus=function(){e.show()};e._onInputClick=function(){e.show()};e._onInputBlur=function(){var n=t.activeElement;do if(i(n,"pika-single"))return;while(n=n.parentNode);e._c||(e._b=a(function(){e.hide()},50));e._c=!1};e._onClick=function(n){n=n||window.event;var t=n.target||n.srcElement,r=t;if(t){!l&&i(t,"pika-select")&&(t.onchange||(t.setAttribute("onchange","return;"),u(t,"change",e._onChange)));do if(i(r,"pika-single")||r===s.trigger)return;while(r=r.parentNode);e._v&&t!==s.trigger&&r!==s.trigger&&e.hide()}};e.el=t.createElement("div");e.el.className="pika-single"+(s.isRTL?" is-rtl":"")+(s.theme?" "+s.theme:"");u(e.el,"mousedown",e._onMouseDown,!0);u(e.el,"touchend",e._onMouseDown,!0);u(e.el,"change",e._onChange);u(t,"keydown",e._onKeyChange);s.field&&(s.container?s.container.appendChild(e.el):s.bound?t.body.appendChild(e.el):s.field.parentNode.insertBefore(e.el,s.field.nextSibling),u(s.field,"change",e._onInputChange),s.defaultDate||(s.defaultDate=o&&s.field.value?n(s.field.value,s.format).toDate():new Date(Date.parse(s.field.value)),s.setDefaultDate=!0));h=s.defaultDate;r(h)?s.setDefaultDate?e.setDate(h,!0):e.gotoDate(h):e.gotoDate(new Date);s.bound?(this.hide(),e.el.className+=" is-bound",u(s.trigger,"click",e._onInputClick),u(s.trigger,"focus",e._onInputFocus),u(s.trigger,"blur",e._onInputBlur)):this.show()};return k.prototype={config:function(n){var t,i,u;return this._o||(this._o=s({},f,!0)),t=s(this._o,n,!0),t.isRTL=!!t.isRTL,t.field=t.field&&t.field.nodeName?t.field:null,t.theme=typeof t.theme=="string"&&t.theme?t.theme:null,t.bound=!!(t.bound!==undefined?t.field&&t.bound:t.field),t.trigger=t.trigger&&t.trigger.nodeName?t.trigger:t.field,t.disableWeekends=!!t.disableWeekends,t.disableDayFn=typeof t.disableDayFn=="function"?t.disableDayFn:null,i=parseInt(t.numberOfMonths,10)||1,t.numberOfMonths=i>4?4:i,r(t.minDate)||(t.minDate=!1),r(t.maxDate)||(t.maxDate=!1),t.minDate&&t.maxDate&&t.maxDate<t.minDate&&(t.maxDate=t.minDate=!1),t.minDate&&this.setMinDate(t.minDate),t.maxDate&&this.setMaxDate(t.maxDate),v(t.yearRange)?(u=(new Date).getFullYear()-10,t.yearRange[0]=parseInt(t.yearRange[0],10)||u,t.yearRange[1]=parseInt(t.yearRange[1],10)||u):(t.yearRange=Math.abs(parseInt(t.yearRange,10))||f.yearRange,t.yearRange>100&&(t.yearRange=100)),t},toString:function(t){return r(this._d)?o?n(this._d).format(t||this._o.format):this._d.toDateString():""},getMoment:function(){return o?n(this._d):null},setMoment:function(t,i){o&&n.isMoment(t)&&this.setDate(t.toDate(),i)},getDate:function(){return r(this._d)?new Date(this._d.getTime()):new Date},setDate:function(n,t){if(!n)return this._d=null,this._o.field&&(this._o.field.value="",y(this._o.field,"change",{firedBy:this})),this.draw();if(typeof n=="string"&&(n=new Date(Date.parse(n))),r(n)){var i=this._o.minDate,u=this._o.maxDate;r(i)&&n<i?n=i:r(u)&&n>u&&(n=u);this._d=new Date(n.getTime());h(this._d);this.gotoDate(this._d);this._o.field&&(this._o.field.value=this.toString(),y(this._o.field,"change",{firedBy:this}));t||typeof this._o.onSelect!="function"||this._o.onSelect.call(this,this.getDate())}},gotoDate:function(n){var i=!0;if(r(n)){if(this.calendars){var f=new Date(this.calendars[0].year,this.calendars[0].month,1),t=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),u=n.getTime();t.setMonth(t.getMonth()+1);t.setDate(t.getDate()-1);i=u<f.getTime()||t.getTime()<u}i&&(this.calendars=[{month:n.getMonth(),year:n.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths));this.adjustCalendars()}},adjustDate:function(t,i){var u=this.getDate(),f=parseInt(i)*864e5,r;t==="add"?r=new Date(u.valueOf()+f):t==="subtract"&&(r=new Date(u.valueOf()-f));o&&(t==="add"?r=n(u).add(i,"days").toDate():t==="subtract"&&(r=n(u).subtract(i,"days").toDate()));this.setDate(r)},adjustCalendars:function(){this.calendars[0]=w(this.calendars[0]);for(var n=1;n<this._o.numberOfMonths;n++)this.calendars[n]=w({month:this.calendars[0].month+n,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(n){isNaN(n)||(this.calendars[0].month=parseInt(n,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++;this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--;this.adjustCalendars()},gotoYear:function(n){isNaN(n)||(this.calendars[0].year=parseInt(n,10),this.adjustCalendars())},setMinDate:function(n){n instanceof Date?(h(n),this._o.minDate=n,this._o.minYear=n.getFullYear(),this._o.minMonth=n.getMonth()):(this._o.minDate=f.minDate,this._o.minYear=f.minYear,this._o.minMonth=f.minMonth,this._o.startRange=f.startRange);this.draw()},setMaxDate:function(n){n instanceof Date?(h(n),this._o.maxDate=n,this._o.maxYear=n.getFullYear(),this._o.maxMonth=n.getMonth()):(this._o.maxDate=f.maxDate,this._o.maxYear=f.maxYear,this._o.maxMonth=f.maxMonth,this._o.endRange=f.endRange);this.draw()},setStartRange:function(n){this._o.startRange=n},setEndRange:function(n){this._o.endRange=n},draw:function(n){var i;if(this._v||n){var t=this._o,e=t.minYear,o=t.maxYear,r=t.minMonth,u=t.maxMonth,s="",f;for(this._y<=e&&(this._y=e,!isNaN(r)&&this._m<r&&(this._m=r)),this._y>=o&&(this._y=o,!isNaN(u)&&this._m>u&&(this._m=u)),f="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),i=0;i<t.numberOfMonths;i++)s+='<div class="pika-lendar">'+st(this,i,this.calendars[i].year,this.calendars[i].month,this.calendars[0].year,f)+this.render(this.calendars[i].year,this.calendars[i].month,f)+"<\/div>";if(this.el.innerHTML=s,t.bound&&t.field.type!=="hidden"&&a(function(){t.trigger.focus()},1),typeof this._o.onDraw=="function")this._o.onDraw(this);t.bound&&t.field.setAttribute("aria-label","Use the arrow keys to pick a date")}},adjustPosition:function(){var n,i,f,e,s,h,c,r,u,o;if(!this._o.container){if(this.el.style.position="absolute",n=this._o.trigger,i=n,f=this.el.offsetWidth,e=this.el.offsetHeight,s=window.innerWidth||t.documentElement.clientWidth,h=window.innerHeight||t.documentElement.clientHeight,c=window.pageYOffset||t.body.scrollTop||t.documentElement.scrollTop,typeof n.getBoundingClientRect=="function")o=n.getBoundingClientRect(),r=o.left+window.pageXOffset,u=o.bottom+window.pageYOffset;else for(r=i.offsetLeft,u=i.offsetTop+i.offsetHeight;i=i.offsetParent;)r+=i.offsetLeft,u+=i.offsetTop;(this._o.reposition&&r+f>s||this._o.position.indexOf("right")>-1&&r-f+n.offsetWidth>0)&&(r=r-f+n.offsetWidth);(this._o.reposition&&u+e>h+c||this._o.position.indexOf("top")>-1&&u-e-n.offsetHeight>0)&&(u=u-e-n.offsetHeight);this.el.style.left=r+"px";this.el.style.top=u+"px"}},render:function(n,t,i){var u=this._o,d=new Date,a=p(n,t),f=new Date(n,t,1).getDay(),g=[],l=[],o,w,ot;h(d);u.firstDay>0&&(f-=u.firstDay,f<0&&(f+=7));for(var nt=t===0?11:t-1,st=t===11?0:t+1,it=t===0?n-1:n,ct=t===11?n+1:n,lt=p(it,nt),v=a+f,y=v;y>7;)y-=7;for(v+=7-y,o=0,w=0;o<v;o++){var e=new Date(n,t,1+(o-f)),at=r(this._d)?c(e,this._d):!1,vt=c(e,d),et=o<f||o>=a+f,s=1+(o-f),b=t,k=n,yt=u.startRange&&c(u.startRange,e),pt=u.endRange&&c(u.endRange,e),wt=u.startRange&&u.endRange&&u.startRange<e&&e<u.endRange,bt=u.minDate&&e<u.minDate||u.maxDate&&e>u.maxDate||u.disableWeekends&&tt(e)||u.disableDayFn&&u.disableDayFn(e);et&&(o<f?(s=lt+s,b=nt,k=it):(s=s-a,b=st,k=ct));ot={day:s,month:b,year:k,isSelected:at,isToday:vt,isDisabled:bt,isEmpty:et,isStartRange:yt,isEndRange:pt,isInRange:wt,showDaysInNextAndPreviousMonths:u.showDaysInNextAndPreviousMonths};l.push(rt(ot));++w==7&&(u.showWeekNumber&&l.unshift(ut(o-f,t,n)),g.push(ft(l,u.isRTL)),l=[],w=0)}return ht(u,g,i)},isVisible:function(){return this._v},show:function(){this.isVisible()||(nt(this.el,"is-hidden"),this._v=!0,this.draw(),this._o.bound&&(u(t,"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){var n=this._v;n!==!1&&(this._o.bound&&e(t,"click",this._onClick),this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto",g(this.el,"is-hidden"),this._v=!1,n!==undefined&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){this.hide();e(this.el,"mousedown",this._onMouseDown,!0);e(this.el,"touchend",this._onMouseDown,!0);e(this.el,"change",this._onChange);this._o.field&&(e(this._o.field,"change",this._onInputChange),this._o.bound&&(e(this._o.trigger,"click",this._onInputClick),e(this._o.trigger,"focus",this._onInputFocus),e(this._o.trigger,"blur",this._onInputBlur)));this.el.parentNode&&this.el.parentNode.removeChild(this.el)}},k})},function(n,t,i){(function(n){var t;
//! moment.js
(function(t,i){n.exports=i()})(this,function(){"use strict";function u(){return pf.apply(null,arguments)}function ih(n){pf=n}function ut(n){return n instanceof Array||Object.prototype.toString.call(n)==="[object Array]"}function yi(n){return n!=null&&Object.prototype.toString.call(n)==="[object Object]"}function rh(n){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(n).length===0;for(var t in n)if(n.hasOwnProperty(t))return!1;return!0}function k(n){return n===void 0}function ti(n){return typeof n=="number"||Object.prototype.toString.call(n)==="[object Number]"}function ir(n){return n instanceof Date||Object.prototype.toString.call(n)==="[object Date]"}function wf(n,t){for(var r=[],i=0;i<n.length;++i)r.push(t(n[i],i));return r}function y(n,t){return Object.prototype.hasOwnProperty.call(n,t)}function bt(n,t){for(var i in t)y(t,i)&&(n[i]=t[i]);return y(t,"toString")&&(n.toString=t.toString),y(t,"valueOf")&&(n.valueOf=t.valueOf),n}function ht(n,t,i,r){return bo(n,t,i,r,!0).utc()}function uh(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function o(n){return n._pf==null&&(n._pf=uh()),n._pf}function uu(n){if(n._isValid==null){var t=o(n),r=bf.call(t.parsedDateParts,function(n){return n!=null}),i=!isNaN(n._d.getTime())&&t.overflow<0&&!t.empty&&!t.invalidMonth&&!t.invalidWeekday&&!t.weekdayMismatch&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated&&(!t.meridiem||t.meridiem&&r);if(n._strict&&(i=i&&t.charsLeftOver===0&&t.unusedTokens.length===0&&t.bigHour===undefined),Object.isFrozen!=null&&Object.isFrozen(n))return i;n._isValid=i}return n._isValid}function rr(n){var t=ht(NaN);return n!=null?bt(o(t),n):o(t).userInvalidated=!0,t}function fu(n,t){var i,r,u;if(k(t._isAMomentObject)||(n._isAMomentObject=t._isAMomentObject),k(t._i)||(n._i=t._i),k(t._f)||(n._f=t._f),k(t._l)||(n._l=t._l),k(t._strict)||(n._strict=t._strict),k(t._tzm)||(n._tzm=t._tzm),k(t._isUTC)||(n._isUTC=t._isUTC),k(t._offset)||(n._offset=t._offset),k(t._pf)||(n._pf=o(t)),k(t._locale)||(n._locale=t._locale),ur.length>0)for(i=0;i<ur.length;i++)r=ur[i],u=t[r],k(u)||(n[r]=u);return n}function pi(n){fu(this,n);this._d=new Date(n._d!=null?n._d.getTime():NaN);this.isValid()||(this._d=new Date(NaN));fr===!1&&(fr=!0,u.updateOffset(this),fr=!1)}function kt(n){return n instanceof pi||n!=null&&n._isAMomentObject!=null}function tt(n){return n<0?Math.ceil(n)||0:Math.floor(n)}function s(n){var t=+n,i=0;return t!==0&&isFinite(t)&&(i=tt(t)),i}function kf(n,t,i){for(var f=Math.min(n.length,t.length),e=Math.abs(n.length-t.length),u=0,r=0;r<f;r++)(i&&n[r]!==t[r]||!i&&s(n[r])!==s(t[r]))&&u++;return u+e}function df(n){u.suppressDeprecationWarnings===!1&&typeof console!="undefined"&&console.warn&&console.warn("Deprecation warning: "+n)}function it(n,t){var i=!0;return bt(function(){var e,r,f,o;if(u.deprecationHandler!=null&&u.deprecationHandler(null,n),i){for(e=[],f=0;f<arguments.length;f++){if(r="",typeof arguments[f]=="object"){r+="\n["+f+"] ";for(o in arguments[0])r+=o+": "+arguments[0][o]+", ";r=r.slice(0,-2)}else r=arguments[f];e.push(r)}df(n+"\nArguments: "+Array.prototype.slice.call(e).join("")+"\n"+(new Error).stack);i=!1}return t.apply(this,arguments)},t)}function gf(n,t){u.deprecationHandler!=null&&u.deprecationHandler(n,t);eu[n]||(df(t),eu[n]=!0)}function ct(n){return n instanceof Function||Object.prototype.toString.call(n)==="[object Function]"}function fh(n){var t;for(var i in n)t=n[i],ct(t)?this[i]=t:this["_"+i]=t;this._config=n;this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function ne(n,t){var r=bt({},n);for(var i in t)y(t,i)&&(yi(n[i])&&yi(t[i])?(r[i]={},bt(r[i],n[i]),bt(r[i],t[i])):t[i]!=null?r[i]=t[i]:delete r[i]);for(i in n)y(n,i)&&!y(t,i)&&yi(n[i])&&(r[i]=bt({},r[i]));return r}function ou(n){n!=null&&this.set(n)}function eh(n,t,i){var r=this._calendar[n]||this._calendar.sameElse;return ct(r)?r.call(t,i):r}function oh(n){var t=this._longDateFormat[n],i=this._longDateFormat[n.toUpperCase()];return t||!i?t:(this._longDateFormat[n]=i.replace(/MMMM|MM|DD|dddd/g,function(n){return n.slice(1)}),this._longDateFormat[n])}function sh(){return this._invalidDate}function hh(n){return this._ordinal.replace("%d",n)}function ch(n,t,i,r){var u=this._relativeTime[i];return ct(u)?u(n,t,i,r):u.replace(/%d/i,n)}function lh(n,t){var i=this._relativeTime[n>0?"future":"past"];return ct(i)?i(t):i.replace(/%s/i,t)}function d(n,t){var i=n.toLowerCase();oi[i]=oi[i+"s"]=oi[t]=n}function rt(n){return typeof n=="string"?oi[n]||oi[n.toLowerCase()]:undefined}function su(n){var r={},t;for(var i in n)y(n,i)&&(t=rt(i),t&&(r[t]=n[i]));return r}function g(n,t){hu[n]=t}function ah(n){var t=[];for(var i in n)t.push({unit:i,priority:hu[i]});return t.sort(function(n,t){return n.priority-t.priority}),t}function vt(n,t,i){var r=""+Math.abs(n),u=t-r.length,f=n>=0;return(f?i?"+":"":"-")+Math.pow(10,Math.max(0,u)).toString().substr(1)+r}function e(n,t,i,r){var u=r;typeof r=="string"&&(u=function(){return this[r]()});n&&(si[n]=u);t&&(si[t[0]]=function(){return vt(u.apply(this,arguments),t[1],t[2])});i&&(si[i]=function(){return this.localeData().ordinal(u.apply(this,arguments),n)})}function vh(n){return n.match(/\[[\s\S]/)?n.replace(/^\[|\]$/g,""):n.replace(/\\/g,"")}function yh(n){for(var t=n.match(se),i=0,r=t.length;i<r;i++)t[i]=si[t[i]]?si[t[i]]:vh(t[i]);return function(i){for(var f="",u=0;u<r;u++)f+=ct(t[u])?t[u].call(i,n):t[u];return f}}function or(n,t){return n.isValid()?(t=he(t,n.localeData()),cu[t]=cu[t]||yh(t),cu[t](n)):n.localeData().invalidDate()}function he(n,t){function r(n){return t.longDateFormat(n)||n}var i=5;for(er.lastIndex=0;i>=0&&er.test(n);)n=n.replace(er,r),er.lastIndex=0,i-=1;return n}function f(n,t,i){vu[n]=ct(t)?t:function(n){return n&&i?i:t}}function wh(n,t){return y(vu,n)?vu[n](t._strict,t._locale):new RegExp(bh(n))}function bh(n){return ii(n.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(n,t,i,r,u){return t||i||r||u}))}function ii(n){return n.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function a(n,t){var i,r=t;for(typeof n=="string"&&(n=[n]),ti(t)&&(r=function(n,i){i[t]=s(n)}),i=0;i<n.length;i++)vr[n[i]]=r}function bi(n,t){a(n,function(n,i,r,u){r._w=r._w||{};t(n,r._w,r,u)})}function kh(n,t,i){t!=null&&y(vr,n)&&vr[n](t,i._a,i,n)}function ki(n){return yr(n)?366:365}function yr(n){return n%4==0&&n%100!=0||n%400==0}function nc(){return yr(this.year())}function hi(n,t){return function(i){return i!=null?(ye(this,n,i),u.updateOffset(this,t),this):pr(this,n)}}function pr(n,t){return n.isValid()?n._d["get"+(n._isUTC?"UTC":"")+t]():NaN}function ye(n,t,i){n.isValid()&&!isNaN(i)&&(t==="FullYear"&&yr(n.year())&&n.month()===1&&n.date()===29?n._d["set"+(n._isUTC?"UTC":"")+t](i,n.month(),wr(i,n.month())):n._d["set"+(n._isUTC?"UTC":"")+t](i))}function tc(n){return(n=rt(n),ct(this[n]))?this[n]():this}function ic(n,t){var r,i;if(typeof n=="object")for(n=su(n),r=ah(n),i=0;i<r.length;i++)this[r[i].unit](n[r[i].unit]);else if(n=rt(n),ct(this[n]))return this[n](t);return this}function rc(n,t){return(n%t+t)%t}function wr(n,t){if(isNaN(n)||isNaN(t))return NaN;var i=rc(t,12);return n+=(t-i)/12,i===1?yr(n)?29:28:31-i%7%2}function uc(n,t){return n?ut(this._months)?this._months[n.month()]:this._months[(this._months.isFormat||pu).test(t)?"format":"standalone"][n.month()]:ut(this._months)?this._months:this._months.standalone}function fc(n,t){return n?ut(this._monthsShort)?this._monthsShort[n.month()]:this._monthsShort[pu.test(t)?"format":"standalone"][n.month()]:ut(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function ec(n,t,i){var u,r,e,f=n.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],u=0;u<12;++u)e=ht([2e3,u]),this._shortMonthsParse[u]=this.monthsShort(e,"").toLocaleLowerCase(),this._longMonthsParse[u]=this.months(e,"").toLocaleLowerCase();return i?t==="MMM"?(r=p.call(this._shortMonthsParse,f),r!==-1?r:null):(r=p.call(this._longMonthsParse,f),r!==-1?r:null):t==="MMM"?(r=p.call(this._shortMonthsParse,f),r!==-1)?r:(r=p.call(this._longMonthsParse,f),r!==-1?r:null):(r=p.call(this._longMonthsParse,f),r!==-1)?r:(r=p.call(this._shortMonthsParse,f),r!==-1?r:null)}function oc(n,t,i){var r,u,f;if(this._monthsParseExact)return ec.call(this,n,t,i);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),r=0;r<12;r++)if((u=ht([2e3,r]),i&&!this._longMonthsParse[r]&&(this._longMonthsParse[r]=new RegExp("^"+this.months(u,"").replace(".","")+"$","i"),this._shortMonthsParse[r]=new RegExp("^"+this.monthsShort(u,"").replace(".","")+"$","i")),i||this._monthsParse[r]||(f="^"+this.months(u,"")+"|^"+this.monthsShort(u,""),this._monthsParse[r]=new RegExp(f.replace(".",""),"i")),i&&t==="MMMM"&&this._longMonthsParse[r].test(n))||i&&t==="MMM"&&this._shortMonthsParse[r].test(n)||!i&&this._monthsParse[r].test(n))return r}function we(n,t){var i;if(!n.isValid())return n;if(typeof t=="string")if(/^\d+$/.test(t))t=s(t);else if(t=n.localeData().monthsParse(t),!ti(t))return n;return i=Math.min(n.date(),wr(n.year(),t)),n._d["set"+(n._isUTC?"UTC":"")+"Month"](t,i),n}function be(n){return n!=null?(we(this,n),u.updateOffset(this,!0),this):pr(this,"Month")}function sc(){return wr(this.year(),this.month())}function hc(n){return this._monthsParseExact?(y(this,"_monthsRegex")||ge.call(this),n?this._monthsShortStrictRegex:this._monthsShortRegex):(y(this,"_monthsShortRegex")||(this._monthsShortRegex=ke),this._monthsShortStrictRegex&&n?this._monthsShortStrictRegex:this._monthsShortRegex)}function cc(n){return this._monthsParseExact?(y(this,"_monthsRegex")||ge.call(this),n?this._monthsStrictRegex:this._monthsRegex):(y(this,"_monthsRegex")||(this._monthsRegex=de),this._monthsStrictRegex&&n?this._monthsStrictRegex:this._monthsRegex)}function ge(){function f(n,t){return t.length-n.length}for(var i=[],r=[],t=[],u,n=0;n<12;n++)u=ht([2e3,n]),i.push(this.monthsShort(u,"")),r.push(this.months(u,"")),t.push(this.months(u,"")),t.push(this.monthsShort(u,""));for(i.sort(f),r.sort(f),t.sort(f),n=0;n<12;n++)i[n]=ii(i[n]),r[n]=ii(r[n]);for(n=0;n<24;n++)t[n]=ii(t[n]);this._monthsRegex=new RegExp("^("+t.join("|")+")","i");this._monthsShortRegex=this._monthsRegex;this._monthsStrictRegex=new RegExp("^("+r.join("|")+")","i");this._monthsShortStrictRegex=new RegExp("^("+i.join("|")+")","i")}function lc(n,t,i,r,u,f,e){var o=new Date(n,t,i,r,u,f,e);return n<100&&n>=0&&isFinite(o.getFullYear())&&o.setFullYear(n),o}function di(n){var t=new Date(Date.UTC.apply(null,arguments));return n<100&&n>=0&&isFinite(t.getUTCFullYear())&&t.setUTCFullYear(n),t}function br(n,t,i){var r=7+t-i,u=(7+di(n,0,r).getUTCDay()-t)%7;return-u+r-1}function no(n,t,i,r,u){var s=(7+i-r)%7,h=br(n,r,u),f=1+7*(t-1)+s+h,e,o;return f<=0?(e=n-1,o=ki(e)+f):f>ki(n)?(e=n+1,o=f-ki(n)):(e=n,o=f),{year:e,dayOfYear:o}}function gi(n,t,i){var e=br(n.year(),t,i),r=Math.floor((n.dayOfYear()-e-1)/7)+1,f,u;return r<1?(u=n.year()-1,f=r+ui(u,t,i)):r>ui(n.year(),t,i)?(f=r-ui(n.year(),t,i),u=n.year()+1):(u=n.year(),f=r),{week:f,year:u}}function ui(n,t,i){var r=br(n,t,i),u=br(n+1,t,i);return(ki(n)-r+u)/7}function ac(n){return gi(n,this._week.dow,this._week.doy).week}function vc(){return this._week.dow}function yc(){return this._week.doy}function pc(n){var t=this.localeData().week(this);return n==null?t:this.add((n-t)*7,"d")}function wc(n){var t=gi(this,1,4).week;return n==null?t:this.add((n-t)*7,"d")}function bc(n,t){return typeof n!="string"?n:isNaN(n)?(n=t.weekdaysParse(n),typeof n=="number")?n:null:parseInt(n,10)}function kc(n,t){return typeof n=="string"?t.weekdaysParse(n)%7||7:isNaN(n)?null:n}function dc(n,t){return n?ut(this._weekdays)?this._weekdays[n.day()]:this._weekdays[this._weekdays.isFormat.test(t)?"format":"standalone"][n.day()]:ut(this._weekdays)?this._weekdays:this._weekdays.standalone}function gc(n){return n?this._weekdaysShort[n.day()]:this._weekdaysShort}function nl(n){return n?this._weekdaysMin[n.day()]:this._weekdaysMin}function tl(n,t,i){var f,r,e,u=n.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],f=0;f<7;++f)e=ht([2e3,1]).day(f),this._minWeekdaysParse[f]=this.weekdaysMin(e,"").toLocaleLowerCase(),this._shortWeekdaysParse[f]=this.weekdaysShort(e,"").toLocaleLowerCase(),this._weekdaysParse[f]=this.weekdays(e,"").toLocaleLowerCase();return i?t==="dddd"?(r=p.call(this._weekdaysParse,u),r!==-1?r:null):t==="ddd"?(r=p.call(this._shortWeekdaysParse,u),r!==-1?r:null):(r=p.call(this._minWeekdaysParse,u),r!==-1?r:null):t==="dddd"?(r=p.call(this._weekdaysParse,u),r!==-1)?r:(r=p.call(this._shortWeekdaysParse,u),r!==-1)?r:(r=p.call(this._minWeekdaysParse,u),r!==-1?r:null):t==="ddd"?(r=p.call(this._shortWeekdaysParse,u),r!==-1)?r:(r=p.call(this._weekdaysParse,u),r!==-1)?r:(r=p.call(this._minWeekdaysParse,u),r!==-1?r:null):(r=p.call(this._minWeekdaysParse,u),r!==-1)?r:(r=p.call(this._weekdaysParse,u),r!==-1)?r:(r=p.call(this._shortWeekdaysParse,u),r!==-1?r:null)}function il(n,t,i){var r,u,f;if(this._weekdaysParseExact)return tl.call(this,n,t,i);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),r=0;r<7;r++)if((u=ht([2e3,1]).day(r),i&&!this._fullWeekdaysParse[r]&&(this._fullWeekdaysParse[r]=new RegExp("^"+this.weekdays(u,"").replace(".",".?")+"$","i"),this._shortWeekdaysParse[r]=new RegExp("^"+this.weekdaysShort(u,"").replace(".",".?")+"$","i"),this._minWeekdaysParse[r]=new RegExp("^"+this.weekdaysMin(u,"").replace(".",".?")+"$","i")),this._weekdaysParse[r]||(f="^"+this.weekdays(u,"")+"|^"+this.weekdaysShort(u,"")+"|^"+this.weekdaysMin(u,""),this._weekdaysParse[r]=new RegExp(f.replace(".",""),"i")),i&&t==="dddd"&&this._fullWeekdaysParse[r].test(n))||i&&t==="ddd"&&this._shortWeekdaysParse[r].test(n)||i&&t==="dd"&&this._minWeekdaysParse[r].test(n)||!i&&this._weekdaysParse[r].test(n))return r}function rl(n){if(!this.isValid())return n!=null?this:NaN;var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return n!=null?(n=bc(n,this.localeData()),this.add(n-t,"d")):t}function ul(n){if(!this.isValid())return n!=null?this:NaN;var t=(this.day()+7-this.localeData()._week.dow)%7;return n==null?t:this.add(n-t,"d")}function fl(n){if(!this.isValid())return n!=null?this:NaN;if(n!=null){var t=kc(n,this.localeData());return this.day(this.day()%7?t:t-7)}return this.day()||7}function el(n){return this._weekdaysParseExact?(y(this,"_weekdaysRegex")||ku.call(this),n?this._weekdaysStrictRegex:this._weekdaysRegex):(y(this,"_weekdaysRegex")||(this._weekdaysRegex=uo),this._weekdaysStrictRegex&&n?this._weekdaysStrictRegex:this._weekdaysRegex)}function ol(n){return this._weekdaysParseExact?(y(this,"_weekdaysRegex")||ku.call(this),n?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(y(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=fo),this._weekdaysShortStrictRegex&&n?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function sl(n){return this._weekdaysParseExact?(y(this,"_weekdaysRegex")||ku.call(this),n?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(y(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=eo),this._weekdaysMinStrictRegex&&n?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function ku(){function u(n,t){return t.length-n.length}for(var e=[],i=[],r=[],t=[],f,o,s,h,n=0;n<7;n++)f=ht([2e3,1]).day(n),o=this.weekdaysMin(f,""),s=this.weekdaysShort(f,""),h=this.weekdays(f,""),e.push(o),i.push(s),r.push(h),t.push(o),t.push(s),t.push(h);for(e.sort(u),i.sort(u),r.sort(u),t.sort(u),n=0;n<7;n++)i[n]=ii(i[n]),r[n]=ii(r[n]),t[n]=ii(t[n]);this._weekdaysRegex=new RegExp("^("+t.join("|")+")","i");this._weekdaysShortRegex=this._weekdaysRegex;this._weekdaysMinRegex=this._weekdaysRegex;this._weekdaysStrictRegex=new RegExp("^("+r.join("|")+")","i");this._weekdaysShortStrictRegex=new RegExp("^("+i.join("|")+")","i");this._weekdaysMinStrictRegex=new RegExp("^("+e.join("|")+")","i")}function du(){return this.hours()%12||12}function hl(){return this.hours()||24}function oo(n,t){e(n,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)})}function so(n,t){return t._meridiemParse}function cl(n){return(n+"").toLowerCase().charAt(0)==="p"}function ll(n,t,i){return n>11?i?"pm":"PM":i?"am":"AM"}function lo(n){return n?n.toLowerCase().replace("_","-"):n}function vl(n){for(var r=0,i,t,f,u;r<n.length;){for(u=lo(n[r]).split("-"),i=u.length,t=lo(n[r+1]),t=t?t.split("-"):null;i>0;){if(f=kr(u.slice(0,i).join("-")),f)return f;if(t&&t.length>=i&&kf(u,t,!0)>=i-1)break;i--}r++}return tr}function kr(r){var u=null,f;if(!b[r]&&typeof n!="undefined"&&n&&n.exports)try{u=tr._abbr;f=t;i(510)("./"+r);ci(u)}catch(e){}return b[r]}function ci(n,t){var i;return n&&(i=k(t)?dt(n):gu(n,t),i?tr=i:typeof console!="undefined"&&console.warn&&console.warn("Locale "+n+" not found. Did you forget to load it?")),tr._abbr}function gu(n,t){if(t!==null){var r,i=co;if(t.abbr=n,b[n]!=null)gf("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),i=b[n]._config;else if(t.parentLocale!=null)if(b[t.parentLocale]!=null)i=b[t.parentLocale]._config;else if(r=kr(t.parentLocale),r!=null)i=r._config;else return nr[t.parentLocale]||(nr[t.parentLocale]=[]),nr[t.parentLocale].push({name:n,config:t}),null;return b[n]=new ou(ne(i,t)),nr[n]&&nr[n].forEach(function(n){gu(n.name,n.config)}),ci(n),b[n]}return delete b[n],null}function yl(n,t){if(t!=null){var i,r,u=co;r=kr(n);r!=null&&(u=r._config);t=ne(u,t);i=new ou(t);i.parentLocale=b[n];b[n]=i;ci(n)}else b[n]!=null&&(b[n].parentLocale!=null?b[n]=b[n].parentLocale:b[n]!=null&&delete b[n]);return b[n]}function dt(n){var t;if(n&&n._locale&&n._locale._abbr&&(n=n._locale._abbr),!n)return tr;if(!ut(n)){if(t=kr(n),t)return t;n=[n]}return vl(n)}function pl(){return te(b)}function nf(n){var i,t=n._a;return t&&o(n).overflow===-2&&(i=t[yt]<0||t[yt]>11?yt:t[lt]<1||t[lt]>wr(t[ft],t[yt])?lt:t[w]<0||t[w]>24||t[w]===24&&(t[et]!==0||t[pt]!==0||t[ri]!==0)?w:t[et]<0||t[et]>59?et:t[pt]<0||t[pt]>59?pt:t[ri]<0||t[ri]>999?ri:-1,o(n)._overflowDayOfYear&&(i<ft||i>lt)&&(i=lt),o(n)._overflowWeeks&&i===-1&&(i=dh),o(n)._overflowWeekday&&i===-1&&(i=gh),o(n).overflow=i),n}function li(n,t,i){return n!=null?n:t!=null?t:i}function wl(n){var t=new Date(u.now());return n._useUTC?[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]:[t.getFullYear(),t.getMonth(),t.getDate()]}function tf(n){var t,i,r=[],u,e,f;if(!n._d){for(u=wl(n),n._w&&n._a[lt]==null&&n._a[yt]==null&&bl(n),n._dayOfYear!=null&&(f=li(n._a[ft],u[ft]),(n._dayOfYear>ki(f)||n._dayOfYear===0)&&(o(n)._overflowDayOfYear=!0),i=di(f,0,n._dayOfYear),n._a[yt]=i.getUTCMonth(),n._a[lt]=i.getUTCDate()),t=0;t<3&&n._a[t]==null;++t)n._a[t]=r[t]=u[t];for(;t<7;t++)n._a[t]=r[t]=n._a[t]==null?t===2?1:0:n._a[t];n._a[w]===24&&n._a[et]===0&&n._a[pt]===0&&n._a[ri]===0&&(n._nextDay=!0,n._a[w]=0);n._d=(n._useUTC?di:lc).apply(null,r);e=n._useUTC?n._d.getUTCDay():n._d.getDay();n._tzm!=null&&n._d.setUTCMinutes(n._d.getUTCMinutes()-n._tzm);n._nextDay&&(n._a[w]=24);n._w&&typeof n._w.d!="undefined"&&n._w.d!==e&&(o(n).weekdayMismatch=!0)}}function bl(n){var t,e,u,i,r,f,h,s,c;t=n._w;t.GG!=null||t.W!=null||t.E!=null?(r=1,f=4,e=li(t.GG,n._a[ft],gi(v(),1,4).year),u=li(t.W,1),i=li(t.E,1),(i<1||i>7)&&(s=!0)):(r=n._locale._week.dow,f=n._locale._week.doy,c=gi(v(),r,f),e=li(t.gg,n._a[ft],c.year),u=li(t.w,c.week),t.d!=null?(i=t.d,(i<0||i>6)&&(s=!0)):t.e!=null?(i=t.e+r,(t.e<0||t.e>6)&&(s=!0)):i=r);u<1||u>ui(e,r,f)?o(n)._overflowWeeks=!0:s!=null?o(n)._overflowWeekday=!0:(h=no(e,u,i,r,f),n._a[ft]=h.year,n._dayOfYear=h.dayOfYear)}function ao(n){var t,r,e=n._i,i=kl.exec(e)||dl.exec(e),s,f,u,h;if(i){for(o(n).iso=!0,t=0,r=dr.length;t<r;t++)if(dr[t][1].exec(i[1])){f=dr[t][0];s=dr[t][2]!==!1;break}if(f==null){n._isValid=!1;return}if(i[3]){for(t=0,r=rf.length;t<r;t++)if(rf[t][1].exec(i[3])){u=(i[2]||" ")+rf[t][0];break}if(u==null){n._isValid=!1;return}}if(!s&&u!=null){n._isValid=!1;return}if(i[4])if(gl.exec(i[4]))h="Z";else{n._isValid=!1;return}n._f=f+(u||"")+(h||"");uf(n)}else n._isValid=!1}function ta(n,t,i,r,u,f){var e=[ia(n),wu.indexOf(t),parseInt(i,10),parseInt(r,10),parseInt(u,10)];return f&&e.push(parseInt(f,10)),e}function ia(n){var t=parseInt(n,10);return t<=49?2e3+t:t<=999?1900+t:t}function ra(n){return n.replace(/\([^)]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").trim()}function ua(n,t,i){if(n){var r=bu.indexOf(n),u=new Date(t[0],t[1],t[2]).getDay();if(r!==u)return o(i).weekdayMismatch=!0,i._isValid=!1,!1}return!0}function fa(n,t,i){if(n)return yo[n];if(t)return 0;var r=parseInt(i,10),u=r%100,f=(r-u)/100;return f*60+u}function po(n){var t=vo.exec(ra(n._i)),i;if(t){if(i=ta(t[4],t[3],t[2],t[5],t[6],t[7]),!ua(t[1],i,n))return;n._a=i;n._tzm=fa(t[8],t[9],t[10]);n._d=di.apply(null,n._a);n._d.setUTCMinutes(n._d.getUTCMinutes()-n._tzm);o(n).rfc2822=!0}else n._isValid=!1}function ea(n){var t=na.exec(n._i);if(t!==null){n._d=new Date(+t[1]);return}if(ao(n),n._isValid===!1)delete n._isValid;else return;if(po(n),n._isValid===!1)delete n._isValid;else return;u.createFromInputFallback(n)}function uf(n){if(n._f===u.ISO_8601){ao(n);return}if(n._f===u.RFC_2822){po(n);return}n._a=[];o(n).empty=!0;for(var t=""+n._i,i,r,s,c=t.length,h=0,e=he(n._f,n._locale).match(se)||[],f=0;f<e.length;f++)r=e[f],i=(t.match(wh(r,n))||[])[0],i&&(s=t.substr(0,t.indexOf(i)),s.length>0&&o(n).unusedInput.push(s),t=t.slice(t.indexOf(i)+i.length),h+=i.length),si[r]?(i?o(n).empty=!1:o(n).unusedTokens.push(r),kh(r,i,n)):n._strict&&!i&&o(n).unusedTokens.push(r);o(n).charsLeftOver=c-h;t.length>0&&o(n).unusedInput.push(t);n._a[w]<=12&&o(n).bigHour===!0&&n._a[w]>0&&(o(n).bigHour=undefined);o(n).parsedDateParts=n._a.slice(0);o(n).meridiem=n._meridiem;n._a[w]=oa(n._locale,n._a[w],n._meridiem);tf(n);nf(n)}function oa(n,t,i){var r;return i==null?t:n.meridiemHour!=null?n.meridiemHour(t,i):n.isPM!=null?(r=n.isPM(i),r&&t<12&&(t+=12),r||t!==12||(t=0),t):t}function sa(n){var t,f,u,r,i;if(n._f.length===0){o(n).invalidFormat=!0;n._d=new Date(NaN);return}for(r=0;r<n._f.length;r++)(i=0,t=fu({},n),n._useUTC!=null&&(t._useUTC=n._useUTC),t._f=n._f[r],uf(t),uu(t))&&(i+=o(t).charsLeftOver,i+=o(t).unusedTokens.length*10,o(t).score=i,(u==null||i<u)&&(u=i,f=t));bt(n,f||t)}function ha(n){if(!n._d){var t=su(n._i);n._a=wf([t.year,t.month,t.day||t.date,t.hour,t.minute,t.second,t.millisecond],function(n){return n&&parseInt(n,10)});tf(n)}}function ca(n){var t=new pi(nf(wo(n)));return t._nextDay&&(t.add(1,"d"),t._nextDay=undefined),t}function wo(n){var t=n._i,i=n._f;return(n._locale=n._locale||dt(n._l),t===null||i===undefined&&t==="")?rr({nullInput:!0}):(typeof t=="string"&&(n._i=t=n._locale.preparse(t)),kt(t))?new pi(nf(t)):(ir(t)?n._d=t:ut(i)?sa(n):i?uf(n):la(n),uu(n)||(n._d=null),n)}function la(n){var t=n._i;k(t)?n._d=new Date(u.now()):ir(t)?n._d=new Date(t.valueOf()):typeof t=="string"?ea(n):ut(t)?(n._a=wf(t.slice(0),function(n){return parseInt(n,10)}),tf(n)):yi(t)?ha(n):ti(t)?n._d=new Date(t):u.createFromInputFallback(n)}function bo(n,t,i,r,u){var f={};return(i===!0||i===!1)&&(r=i,i=undefined),(yi(n)&&rh(n)||ut(n)&&n.length===0)&&(n=undefined),f._isAMomentObject=!0,f._useUTC=f._isUTC=u,f._l=i,f._i=n,f._f=t,f._strict=r,ca(f)}function v(n,t,i,r){return bo(n,t,i,r,!1)}function ns(n,t){var r,i;if(t.length===1&&ut(t[0])&&(t=t[0]),!t.length)return v();for(r=t[0],i=1;i<t.length;++i)(!t[i].isValid()||t[i][n](r))&&(r=t[i]);return r}function aa(){var n=[].slice.call(arguments,0);return ns("isBefore",n)}function va(){var n=[].slice.call(arguments,0);return ns("isAfter",n)}function ya(n){var i,r,t;for(i in n)if(!(p.call(ai,i)!==-1&&(n[i]==null||!isNaN(n[i]))))return!1;for(r=!1,t=0;t<ai.length;++t)if(n[ai[t]]){if(r)return!1;parseFloat(n[ai[t]])!==s(n[ai[t]])&&(r=!0)}return!0}function pa(){return this._isValid}function wa(){return ot(NaN)}function gr(n){var t=su(n),i=t.year||0,r=t.quarter||0,u=t.month||0,f=t.week||0,e=t.day||0,o=t.hour||0,s=t.minute||0,h=t.second||0,c=t.millisecond||0;this._isValid=ya(t);this._milliseconds=+c+h*1e3+s*6e4+o*36e5;this._days=+e+f*7;this._months=+u+r*3+i*12;this._data={};this._locale=dt();this._bubble()}function ff(n){return n instanceof gr}function ef(n){return n<0?Math.round(-1*n)*-1:Math.round(n)}function is(n,t){e(n,0,0,function(){var n=this.utcOffset(),i="+";return n<0&&(n=-n,i="-"),i+vt(~~(n/60),2)+t+vt(~~n%60,2)})}function of(n,t){var i=(t||"").match(n);if(i===null)return null;var f=i[i.length-1]||[],r=(f+"").match(rs)||["-",0,0],u=+(r[1]*60)+s(r[2]);return u===0?0:r[0]==="+"?u:-u}function sf(n,t){var i,r;return t._isUTC?(i=t.clone(),r=(kt(n)||ir(n)?n.valueOf():v(n).valueOf())-i.valueOf(),i._d.setTime(i._d.valueOf()+r),u.updateOffset(i,!1),i):v(n).local()}function hf(n){return-Math.round(n._d.getTimezoneOffset()/15)*15}function ba(n,t,i){var r=this._offset||0,f;if(!this.isValid())return n!=null?this:NaN;if(n!=null){if(typeof n=="string"){if(n=of(ar,n),n===null)return this}else Math.abs(n)<16&&!i&&(n=n*60);return!this._isUTC&&t&&(f=hf(this)),this._offset=n,this._isUTC=!0,f!=null&&this.add(f,"m"),r!==n&&(!t||this._changeInProgress?hs(this,ot(n-r,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,u.updateOffset(this,!0),this._changeInProgress=null)),this}return this._isUTC?r:hf(this)}function ka(n,t){return n!=null?(typeof n!="string"&&(n=-n),this.utcOffset(n,t),this):-this.utcOffset()}function da(n){return this.utcOffset(0,n)}function ga(n){return this._isUTC&&(this.utcOffset(0,n),this._isUTC=!1,n&&this.subtract(hf(this),"m")),this}function nv(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var n=of(ph,this._i);n!=null?this.utcOffset(n):this.utcOffset(0,!0)}return this}function tv(n){return this.isValid()?(n=n?v(n).utcOffset():0,(this.utcOffset()-n)%60==0):!1}function iv(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function rv(){var n,t;return k(this._isDSTShifted)?(n={},fu(n,this),n=wo(n),n._a?(t=n._isUTC?ht(n._a):v(n._a),this._isDSTShifted=this.isValid()&&kf(n._a,t.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted):this._isDSTShifted}function uv(){return this.isValid()?!this._isUTC:!1}function fv(){return this.isValid()?this._isUTC:!1}function us(){return this.isValid()?this._isUTC&&this._offset===0:!1}function ot(n,t){var i=n,r=null,u,f,e;return ff(n)?i={ms:n._milliseconds,d:n._days,M:n._months}:ti(n)?(i={},t?i[t]=n:i.milliseconds=n):(r=fs.exec(n))?(u=r[1]==="-"?-1:1,i={y:0,d:s(r[lt])*u,h:s(r[w])*u,m:s(r[et])*u,s:s(r[pt])*u,ms:s(ef(r[ri]*1e3))*u}):(r=es.exec(n))?(u=r[1]==="-"?-1:r[1]==="+"?1:1,i={y:fi(r[2],u),M:fi(r[3],u),w:fi(r[4],u),d:fi(r[5],u),h:fi(r[6],u),m:fi(r[7],u),s:fi(r[8],u)}):i==null?i={}:typeof i=="object"&&("from"in i||"to"in i)&&(e=ev(v(i.from),v(i.to)),i={},i.ms=e.milliseconds,i.M=e.months),f=new gr(i),ff(n)&&y(n,"_locale")&&(f._locale=n._locale),f}function fi(n,t){var i=n&&parseFloat(n.replace(",","."));return(isNaN(i)?0:i)*t}function os(n,t){var i={milliseconds:0,months:0};return i.months=t.month()-n.month()+(t.year()-n.year())*12,n.clone().add(i.months,"M").isAfter(t)&&--i.months,i.milliseconds=+t-+n.clone().add(i.months,"M"),i}function ev(n,t){var i;return(n.isValid()&&t.isValid())?(t=sf(t,n),n.isBefore(t)?i=os(n,t):(i=os(t,n),i.milliseconds=-i.milliseconds,i.months=-i.months),i):{milliseconds:0,months:0}}function ss(n,t){return function(i,r){var u,f;return r===null||isNaN(+r)||(gf(t,"moment()."+t+"(period, number) is deprecated. Please use moment()."+t+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),f=i,i=r,r=f),i=typeof i=="string"?+i:i,u=ot(i,r),hs(this,u,n),this}}function hs(n,t,i,r){var o=t._milliseconds,f=ef(t._days),e=ef(t._months);n.isValid()&&(r=r==null?!0:r,e&&we(n,pr(n,"Month")+e*i),f&&ye(n,"Date",pr(n,"Date")+f*i),o&&n._d.setTime(n._d.valueOf()+o*i),r&&u.updateOffset(n,f||e))}function ov(n,t){var i=n.diff(t,"days",!0);return i<-6?"sameElse":i<-1?"lastWeek":i<0?"lastDay":i<1?"sameDay":i<2?"nextDay":i<7?"nextWeek":"sameElse"}function sv(n,t){var r=n||v(),f=sf(r,this).startOf("day"),i=u.calendarFormat(this,f)||"sameElse",e=t&&(ct(t[i])?t[i].call(this,r):t[i]);return this.format(e||this.localeData().calendar(i,this,v(r)))}function hv(){return new pi(this)}function cv(n,t){var i=kt(n)?n:v(n);return(this.isValid()&&i.isValid())?(t=rt(k(t)?"millisecond":t),t==="millisecond"?this.valueOf()>i.valueOf():i.valueOf()<this.clone().startOf(t).valueOf()):!1}function lv(n,t){var i=kt(n)?n:v(n);return(this.isValid()&&i.isValid())?(t=rt(k(t)?"millisecond":t),t==="millisecond"?this.valueOf()<i.valueOf():this.clone().endOf(t).valueOf()<i.valueOf()):!1}function av(n,t,i,r){return r=r||"()",(r[0]==="("?this.isAfter(n,i):!this.isBefore(n,i))&&(r[1]===")"?this.isBefore(t,i):!this.isAfter(t,i))}function vv(n,t){var i=kt(n)?n:v(n),r;return(this.isValid()&&i.isValid())?(t=rt(t||"millisecond"),t==="millisecond"?this.valueOf()===i.valueOf():(r=i.valueOf(),this.clone().startOf(t).valueOf()<=r&&r<=this.clone().endOf(t).valueOf())):!1}function yv(n,t){return this.isSame(n,t)||this.isAfter(n,t)}function pv(n,t){return this.isSame(n,t)||this.isBefore(n,t)}function wv(n,t,i){var r,f,u;if(!this.isValid())return NaN;if(r=sf(n,this),!r.isValid())return NaN;f=(r.utcOffset()-this.utcOffset())*6e4;t=rt(t);switch(t){case"year":u=cf(this,r)/12;break;case"month":u=cf(this,r);break;case"quarter":u=cf(this,r)/3;break;case"second":u=(this-r)/1e3;break;case"minute":u=(this-r)/6e4;break;case"hour":u=(this-r)/36e5;break;case"day":u=(this-r-f)/864e5;break;case"week":u=(this-r-f)/6048e5;break;default:u=this-r}return i?u:tt(u)}function cf(n,t){var r=(t.year()-n.year())*12+(t.month()-n.month()),i=n.clone().add(r,"months"),u,f;return t-i<0?(u=n.clone().add(r-1,"months"),f=(t-i)/(i-u)):(u=n.clone().add(r+1,"months"),f=(t-i)/(u-i)),-(r+f)||0}function bv(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function kv(n){if(!this.isValid())return null;var i=n!==!0,t=i?this.clone().utc():this;return t.year()<0||t.year()>9999?or(t,i?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):ct(Date.prototype.toISOString)?i?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*6e4).toISOString().replace("Z",or(t,"Z")):or(t,i?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function dv(){var n,t;if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";n="moment";t="";this.isLocal()||(n=this.utcOffset()===0?"moment.utc":"moment.parseZone",t="Z");var i="["+n+'("]',r=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",u=t+'[")]';return this.format(i+r+"-MM-DD[T]HH:mm:ss.SSS"+u)}function gv(n){n||(n=this.isUtc()?u.defaultFormatUtc:u.defaultFormat);var t=or(this,n);return this.localeData().postformat(t)}function ny(n,t){return this.isValid()&&(kt(n)&&n.isValid()||v(n).isValid())?ot({to:this,from:n}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function ty(n){return this.from(v(),n)}function iy(n,t){return this.isValid()&&(kt(n)&&n.isValid()||v(n).isValid())?ot({from:this,to:n}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function ry(n){return this.to(v(),n)}function as(n){var t;return n===undefined?this._locale._abbr:(t=dt(n),t!=null&&(this._locale=t),this)}function vs(){return this._locale}function uy(n){n=rt(n);switch(n){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":case"date":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return n==="week"&&this.weekday(0),n==="isoWeek"&&this.isoWeekday(1),n==="quarter"&&this.month(Math.floor(this.month()/3)*3),this}function fy(n){return(n=rt(n),n===undefined||n==="millisecond")?this:(n==="date"&&(n="day"),this.startOf(n).add(1,n==="isoWeek"?"week":n).subtract(1,"ms"))}function ey(){return this._d.valueOf()-(this._offset||0)*6e4}function oy(){return Math.floor(this.valueOf()/1e3)}function sy(){return new Date(this.valueOf())}function hy(){var n=this;return[n.year(),n.month(),n.date(),n.hour(),n.minute(),n.second(),n.millisecond()]}function cy(){var n=this;return{years:n.year(),months:n.month(),date:n.date(),hours:n.hours(),minutes:n.minutes(),seconds:n.seconds(),milliseconds:n.milliseconds()}}function ly(){return this.isValid()?this.toISOString():null}function ay(){return uu(this)}function vy(){return bt({},o(this))}function yy(){return o(this).overflow}function py(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}function nu(n,t){e(0,[n,n.length],0,t)}function wy(n){return ys.call(this,n,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function by(n){return ys.call(this,n,this.isoWeek(),this.isoWeekday(),1,4)}function ky(){return ui(this.year(),1,4)}function dy(){var n=this.localeData()._week;return ui(this.year(),n.dow,n.doy)}function ys(n,t,i,r,u){var f;return n==null?gi(this,r,u).year:(f=ui(n,r,u),t>f&&(t=f),gy.call(this,n,t,i,r,u))}function gy(n,t,i,r,u){var e=no(n,t,i,r,u),f=di(e.year,0,e.dayOfYear);return this.year(f.getUTCFullYear()),this.month(f.getUTCMonth()),this.date(f.getUTCDate()),this}function np(n){return n==null?Math.ceil((this.month()+1)/3):this.month((n-1)*3+this.month()%3)}function tp(n){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return n==null?t:this.add(n-t,"d")}function ip(n,t){t[ri]=s(("0."+n)*1e3)}function rp(){return this._isUTC?"UTC":""}function up(){return this._isUTC?"Coordinated Universal Time":""}function fp(n){return v(n*1e3)}function ep(){return v.apply(null,arguments).parseZone()}function ks(n){return n}function tu(n,t,i,r){var u=dt(),f=ht().set(r,t);return u[i](f,n)}function ds(n,t,i){if(ti(n)&&(t=n,n=undefined),n=n||"",t!=null)return tu(n,t,i,"month");for(var u=[],r=0;r<12;r++)u[r]=tu(n,r,i,"month");return u}function vf(n,t,i,r){var o,f,u,e;if(typeof n=="boolean"?(ti(t)&&(i=t,t=undefined),t=t||""):(t=n,i=t,n=!1,ti(t)&&(i=t,t=undefined),t=t||""),o=dt(),f=n?o._week.dow:0,i!=null)return tu(t,(i+f)%7,r,"day");for(e=[],u=0;u<7;u++)e[u]=tu(t,(u+f)%7,r,"day");return e}function op(n,t){return ds(n,t,"months")}function sp(n,t){return ds(n,t,"monthsShort")}function hp(n,t,i){return vf(n,t,i,"weekdays")}function cp(n,t,i){return vf(n,t,i,"weekdaysShort")}function lp(n,t,i){return vf(n,t,i,"weekdaysMin")}function ap(){var n=this._data;return this._milliseconds=at(this._milliseconds),this._days=at(this._days),this._months=at(this._months),n.milliseconds=at(n.milliseconds),n.seconds=at(n.seconds),n.minutes=at(n.minutes),n.hours=at(n.hours),n.months=at(n.months),n.years=at(n.years),this}function gs(n,t,i,r){var u=ot(t,i);return n._milliseconds+=r*u._milliseconds,n._days+=r*u._days,n._months+=r*u._months,n._bubble()}function vp(n,t){return gs(this,n,t,1)}function yp(n,t){return gs(this,n,t,-1)}function nh(n){return n<0?Math.floor(n):Math.ceil(n)}function pp(){var r=this._milliseconds,n=this._days,t=this._months,i=this._data,u,f,e,s,o;return r>=0&&n>=0&&t>=0||r<=0&&n<=0&&t<=0||(r+=nh(yf(t)+n)*864e5,n=0,t=0),i.milliseconds=r%1e3,u=tt(r/1e3),i.seconds=u%60,f=tt(u/60),i.minutes=f%60,e=tt(f/60),i.hours=e%24,n+=tt(e/24),o=tt(th(n)),t+=o,n-=nh(yf(o)),s=tt(t/12),t%=12,i.days=n,i.months=t,i.years=s,this}function th(n){return n*4800/146097}function yf(n){return n*146097/4800}function wp(n){if(!this.isValid())return NaN;var t,r,i=this._milliseconds;if(n=rt(n),n==="month"||n==="year")return t=this._days+i/864e5,r=this._months+th(t),n==="month"?r:r/12;t=this._days+Math.round(yf(this._months));switch(n){case"week":return t/7+i/6048e5;case"day":return t+i/864e5;case"hour":return t*24+i/36e5;case"minute":return t*1440+i/6e4;case"second":return t*86400+i/1e3;case"millisecond":return Math.floor(t*864e5)+i;default:throw new Error("Unknown unit "+n);}}function bp(){return this.isValid()?this._milliseconds+this._days*864e5+this._months%12*2592e6+s(this._months/12)*31536e6:NaN}function ni(n){return function(){return this.as(n)}}function fw(){return ot(this)}function ew(n){return n=rt(n),this.isValid()?this[n+"s"]():NaN}function ei(n){return function(){return this.isValid()?this._data[n]:NaN}}function yw(){return tt(this.days()/7)}function pw(n,t,i,r,u){return u.relativeTime(t||1,!!i,n,r)}function ww(n,t,i){var r=ot(n).abs(),u=wt(r.as("s")),e=wt(r.as("m")),o=wt(r.as("h")),s=wt(r.as("d")),h=wt(r.as("M")),c=wt(r.as("y")),f=u<=st.ss&&["s",u]||u<st.s&&["ss",u]||e<=1&&["m"]||e<st.m&&["mm",e]||o<=1&&["h"]||o<st.h&&["hh",o]||s<=1&&["d"]||s<st.d&&["dd",s]||h<=1&&["M"]||h<st.M&&["MM",h]||c<=1&&["y"]||["yy",c];return f[2]=t,f[3]=+n>0,f[4]=i,pw.apply(null,f)}function bw(n){return n===undefined?wt:typeof n=="function"?(wt=n,!0):!1}function kw(n,t){return st[n]===undefined?!1:t===undefined?st[n]:(st[n]=t,n==="s"&&(st.ss=t-1),!0)}function dw(n){if(!this.isValid())return this.localeData().invalidDate();var t=this.localeData(),i=ww(this,!n,t);return n&&(i=t.pastFuture(+this,i)),t.postformat(i)}function vi(n){return(n>0)-(n<0)||+n}function ru(){if(!this.isValid())return this.localeData().invalidDate();var t=iu(this._milliseconds)/1e3,y=iu(this._days),r=iu(this._months),i,s,h;i=tt(t/60);s=tt(i/60);t%=60;i%=60;h=tt(r/12);r%=12;var c=h,l=r,a=y,u=s,f=i,e=t?t.toFixed(3).replace(/\.?0+$/,""):"",n=this.asSeconds();if(!n)return"P0D";var p=n<0?"-":"",v=vi(this._months)!==vi(n)?"-":"",w=vi(this._days)!==vi(n)?"-":"",o=vi(this._milliseconds)!==vi(n)?"-":"";return p+"P"+(c?v+c+"Y":"")+(l?v+l+"M":"")+(a?w+a+"D":"")+(u||f||e?"T":"")+(u?o+u+"H":"")+(f?o+f+"M":"")+(e?o+e+"S":"")}var pf,bf,ur,fr,eu,te,ie,re,ue,fe,ee,oe,oi,hu,vr,yu,p,pu,pe,wu,ke,de,to,io,bu,ro,uo,fo,eo,ho,vo,yo,ko,go,ts,ai,rs,fs,es,cs,ls,lf,af,ps,ws,gt,bs,r,c,at,wt,st,iu,h;bf=Array.prototype.some?Array.prototype.some:function(n){for(var i=Object(this),r=i.length>>>0,t=0;t<r;t++)if(t in i&&n.call(this,i[t],t,i))return!0;return!1};ur=u.momentProperties=[];fr=!1;eu={};u.suppressDeprecationWarnings=!1;u.deprecationHandler=null;te=Object.keys?Object.keys:function(n){var t,i=[];for(t in n)y(n,t)&&i.push(t);return i};ie={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};re={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};ue="Invalid date";fe="%d";ee=/\d{1,2}/;oe={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};oi={};hu={};var se=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,er=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,cu={},si={};var ce=/\d/,nt=/\d\d/,le=/\d{3}/,lu=/\d{4}/,sr=/[+-]?\d{6}/,l=/\d\d?/,ae=/\d\d\d\d?/,ve=/\d\d\d\d\d\d?/,hr=/\d{1,3}/,au=/\d{1,4}/,cr=/[+-]?\d{1,6}/,lr=/[+-]?\d+/,ph=/Z|[+-]\d\d:?\d\d/gi,ar=/Z|[+-]\d\d(?::?\d\d)?/gi,wi=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,vu={};vr={};var ft=0,yt=1,lt=2,w=3,et=4,pt=5,ri=6,dh=7,gh=8;e("Y",0,0,function(){var n=this.year();return n<=9999?""+n:"+"+n});e(0,["YY",2],0,function(){return this.year()%100});e(0,["YYYY",4],0,"year");e(0,["YYYYY",5],0,"year");e(0,["YYYYYY",6,!0],0,"year");d("year","y");g("year",1);f("Y",lr);f("YY",l,nt);f("YYYY",au,lu);f("YYYYY",cr,sr);f("YYYYYY",cr,sr);a(["YYYYY","YYYYYY"],ft);a("YYYY",function(n,t){t[ft]=n.length===2?u.parseTwoDigitYear(n):s(n)});a("YY",function(n,t){t[ft]=u.parseTwoDigitYear(n)});a("Y",function(n,t){t[ft]=parseInt(n,10)});u.parseTwoDigitYear=function(n){return s(n)+(s(n)>68?1900:2e3)};yu=hi("FullYear",!0);p=Array.prototype.indexOf?Array.prototype.indexOf:function(n){for(var t=0;t<this.length;++t)if(this[t]===n)return t;return-1};e("M",["MM",2],"Mo",function(){return this.month()+1});e("MMM",0,0,function(n){return this.localeData().monthsShort(this,n)});e("MMMM",0,0,function(n){return this.localeData().months(this,n)});d("month","M");g("month",8);f("M",l);f("MM",l,nt);f("MMM",function(n,t){return t.monthsShortRegex(n)});f("MMMM",function(n,t){return t.monthsRegex(n)});a(["M","MM"],function(n,t){t[yt]=s(n)-1});a(["MMM","MMMM"],function(n,t,i,r){var u=i._locale.monthsParse(n,r,i._strict);u!=null?t[yt]=u:o(i).invalidMonth=n});pu=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/;pe="January_February_March_April_May_June_July_August_September_October_November_December".split("_");wu="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_");ke=wi;de=wi;e("w",["ww",2],"wo","week");e("W",["WW",2],"Wo","isoWeek");d("week","w");d("isoWeek","W");g("week",5);g("isoWeek",5);f("w",l);f("ww",l,nt);f("W",l);f("WW",l,nt);bi(["w","ww","W","WW"],function(n,t,i,r){t[r.substr(0,1)]=s(n)});to={dow:0,doy:6};e("d",0,"do","day");e("dd",0,0,function(n){return this.localeData().weekdaysMin(this,n)});e("ddd",0,0,function(n){return this.localeData().weekdaysShort(this,n)});e("dddd",0,0,function(n){return this.localeData().weekdays(this,n)});e("e",0,0,"weekday");e("E",0,0,"isoWeekday");d("day","d");d("weekday","e");d("isoWeekday","E");g("day",11);g("weekday",11);g("isoWeekday",11);f("d",l);f("e",l);f("E",l);f("dd",function(n,t){return t.weekdaysMinRegex(n)});f("ddd",function(n,t){return t.weekdaysShortRegex(n)});f("dddd",function(n,t){return t.weekdaysRegex(n)});bi(["dd","ddd","dddd"],function(n,t,i,r){var u=i._locale.weekdaysParse(n,r,i._strict);u!=null?t.d=u:o(i).invalidWeekday=n});bi(["d","e","E"],function(n,t,i,r){t[r]=s(n)});io="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_");bu="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_");ro="Su_Mo_Tu_We_Th_Fr_Sa".split("_");uo=wi;fo=wi;eo=wi;e("H",["HH",2],0,"hour");e("h",["hh",2],0,du);e("k",["kk",2],0,hl);e("hmm",0,0,function(){return""+du.apply(this)+vt(this.minutes(),2)});e("hmmss",0,0,function(){return""+du.apply(this)+vt(this.minutes(),2)+vt(this.seconds(),2)});e("Hmm",0,0,function(){return""+this.hours()+vt(this.minutes(),2)});e("Hmmss",0,0,function(){return""+this.hours()+vt(this.minutes(),2)+vt(this.seconds(),2)});oo("a",!0);oo("A",!1);d("hour","h");g("hour",13);f("a",so);f("A",so);f("H",l);f("h",l);f("k",l);f("HH",l,nt);f("hh",l,nt);f("kk",l,nt);f("hmm",ae);f("hmmss",ve);f("Hmm",ae);f("Hmmss",ve);a(["H","HH"],w);a(["k","kk"],function(n,t){var i=s(n);t[w]=i===24?0:i});a(["a","A"],function(n,t,i){i._isPm=i._locale.isPM(n);i._meridiem=n});a(["h","hh"],function(n,t,i){t[w]=s(n);o(i).bigHour=!0});a("hmm",function(n,t,i){var r=n.length-2;t[w]=s(n.substr(0,r));t[et]=s(n.substr(r));o(i).bigHour=!0});a("hmmss",function(n,t,i){var r=n.length-4,u=n.length-2;t[w]=s(n.substr(0,r));t[et]=s(n.substr(r,2));t[pt]=s(n.substr(u));o(i).bigHour=!0});a("Hmm",function(n,t){var i=n.length-2;t[w]=s(n.substr(0,i));t[et]=s(n.substr(i))});a("Hmmss",function(n,t){var i=n.length-4,r=n.length-2;t[w]=s(n.substr(0,i));t[et]=s(n.substr(i,2));t[pt]=s(n.substr(r))});ho=/[ap]\.?m?\.?/i;var al=hi("Hours",!0),co={calendar:ie,longDateFormat:re,invalidDate:ue,ordinal:fe,dayOfMonthOrdinalParse:ee,relativeTime:oe,months:pe,monthsShort:wu,week:to,weekdays:io,weekdaysMin:ro,weekdaysShort:bu,meridiemParse:ho},b={},nr={},tr;var kl=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,dl=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,gl=/Z|[+-]\d\d(?::?\d\d)?/,dr=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/]],rf=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],na=/^\/?Date\((\-?\d+)/i;for(vo=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,yo={UT:0,GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480},u.createFromInputFallback=it("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged and will be removed in an upcoming major release. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(n){n._d=new Date(n._i+(n._useUTC?" UTC":""))}),u.ISO_8601=function(){},u.RFC_2822=function(){},ko=it("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var n=v.apply(null,arguments);return this.isValid()&&n.isValid()?n<this?this:n:rr()}),go=it("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var n=v.apply(null,arguments);return this.isValid()&&n.isValid()?n>this?this:n:rr()}),ts=function(){return Date.now?Date.now():+new Date},ai=["year","quarter","month","week","day","hour","minute","second","millisecond"],is("Z",":"),is("ZZ",""),f("Z",ar),f("ZZ",ar),a(["Z","ZZ"],function(n,t,i){i._useUTC=!0;i._tzm=of(ar,n)}),rs=/([\+\-]|\d\d)/gi,u.updateOffset=function(){},fs=/^(\-|\+)?(?:(\d*)[. ])?(\d+)\:(\d+)(?:\:(\d+)(\.\d*)?)?$/,es=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/,ot.fn=gr.prototype,ot.invalid=wa,cs=ss(1,"add"),ls=ss(-1,"subtract"),u.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",u.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]",lf=it("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(n){return n===undefined?this.localeData():this.locale(n)}),e(0,["gg",2],0,function(){return this.weekYear()%100}),e(0,["GG",2],0,function(){return this.isoWeekYear()%100}),nu("gggg","weekYear"),nu("ggggg","weekYear"),nu("GGGG","isoWeekYear"),nu("GGGGG","isoWeekYear"),d("weekYear","gg"),d("isoWeekYear","GG"),g("weekYear",1),g("isoWeekYear",1),f("G",lr),f("g",lr),f("GG",l,nt),f("gg",l,nt),f("GGGG",au,lu),f("gggg",au,lu),f("GGGGG",cr,sr),f("ggggg",cr,sr),bi(["gggg","ggggg","GGGG","GGGGG"],function(n,t,i,r){t[r.substr(0,2)]=s(n)}),bi(["gg","GG"],function(n,t,i,r){t[r]=u.parseTwoDigitYear(n)}),e("Q",0,"Qo","quarter"),d("quarter","Q"),g("quarter",7),f("Q",ce),a("Q",function(n,t){t[yt]=(s(n)-1)*3}),e("D",["DD",2],"Do","date"),d("date","D"),g("date",9),f("D",l),f("DD",l,nt),f("Do",function(n,t){return n?t._dayOfMonthOrdinalParse||t._ordinalParse:t._dayOfMonthOrdinalParseLenient}),a(["D","DD"],lt),a("Do",function(n,t){t[lt]=s(n.match(l)[0])}),af=hi("Date",!0),e("DDD",["DDDD",3],"DDDo","dayOfYear"),d("dayOfYear","DDD"),g("dayOfYear",4),f("DDD",hr),f("DDDD",le),a(["DDD","DDDD"],function(n,t,i){i._dayOfYear=s(n)}),e("m",["mm",2],0,"minute"),d("minute","m"),g("minute",14),f("m",l),f("mm",l,nt),a(["m","mm"],et),ps=hi("Minutes",!1),e("s",["ss",2],0,"second"),d("second","s"),g("second",15),f("s",l),f("ss",l,nt),a(["s","ss"],pt),ws=hi("Seconds",!1),e("S",0,0,function(){return~~(this.millisecond()/100)}),e(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),e(0,["SSS",3],0,"millisecond"),e(0,["SSSS",4],0,function(){return this.millisecond()*10}),e(0,["SSSSS",5],0,function(){return this.millisecond()*100}),e(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3}),e(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4}),e(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5}),e(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6}),d("millisecond","ms"),g("millisecond",16),f("S",hr,ce),f("SS",hr,nt),f("SSS",hr,le),gt="SSSS";gt.length<=9;gt+="S")f(gt,/\d+/);for(gt="S";gt.length<=9;gt+="S")a(gt,ip);bs=hi("Milliseconds",!1);e("z",0,0,"zoneAbbr");e("zz",0,0,"zoneName");r=pi.prototype;r.add=cs;r.calendar=sv;r.clone=hv;r.diff=wv;r.endOf=fy;r.format=gv;r.from=ny;r.fromNow=ty;r.to=iy;r.toNow=ry;r.get=tc;r.invalidAt=yy;r.isAfter=cv;r.isBefore=lv;r.isBetween=av;r.isSame=vv;r.isSameOrAfter=yv;r.isSameOrBefore=pv;r.isValid=ay;r.lang=lf;r.locale=as;r.localeData=vs;r.max=go;r.min=ko;r.parsingFlags=vy;r.set=ic;r.startOf=uy;r.subtract=ls;r.toArray=hy;r.toObject=cy;r.toDate=sy;r.toISOString=kv;r.inspect=dv;r.toJSON=ly;r.toString=bv;r.unix=oy;r.valueOf=ey;r.creationData=py;r.year=yu;r.isLeapYear=nc;r.weekYear=wy;r.isoWeekYear=by;r.quarter=r.quarters=np;r.month=be;r.daysInMonth=sc;r.week=r.weeks=pc;r.isoWeek=r.isoWeeks=wc;r.weeksInYear=dy;r.isoWeeksInYear=ky;r.date=af;r.day=r.days=rl;r.weekday=ul;r.isoWeekday=fl;r.dayOfYear=tp;r.hour=r.hours=al;r.minute=r.minutes=ps;r.second=r.seconds=ws;r.millisecond=r.milliseconds=bs;r.utcOffset=ba;r.utc=da;r.local=ga;r.parseZone=nv;r.hasAlignedHourOffset=tv;r.isDST=iv;r.isLocal=uv;r.isUtcOffset=fv;r.isUtc=us;r.isUTC=us;r.zoneAbbr=rp;r.zoneName=up;r.dates=it("dates accessor is deprecated. Use date instead.",af);r.months=it("months accessor is deprecated. Use month instead",be);r.years=it("years accessor is deprecated. Use year instead",yu);r.zone=it("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",ka);r.isDSTShifted=it("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",rv);c=ou.prototype;c.calendar=eh;c.longDateFormat=oh;c.invalidDate=sh;c.ordinal=hh;c.preparse=ks;c.postformat=ks;c.relativeTime=ch;c.pastFuture=lh;c.set=fh;c.months=uc;c.monthsShort=fc;c.monthsParse=oc;c.monthsRegex=cc;c.monthsShortRegex=hc;c.week=ac;c.firstDayOfYear=yc;c.firstDayOfWeek=vc;c.weekdays=dc;c.weekdaysMin=nl;c.weekdaysShort=gc;c.weekdaysParse=il;c.weekdaysRegex=el;c.weekdaysShortRegex=ol;c.weekdaysMinRegex=sl;c.isPM=cl;c.meridiem=ll;ci("en",{dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(n){var t=n%10,i=s(n%100/10)===1?"th":t===1?"st":t===2?"nd":t===3?"rd":"th";return n+i}});u.lang=it("moment.lang is deprecated. Use moment.locale instead.",ci);u.langData=it("moment.langData is deprecated. Use moment.localeData instead.",dt);at=Math.abs;var kp=ni("ms"),dp=ni("s"),gp=ni("m"),nw=ni("h"),tw=ni("d"),iw=ni("w"),rw=ni("M"),uw=ni("y");var ow=ei("milliseconds"),sw=ei("seconds"),hw=ei("minutes"),cw=ei("hours"),lw=ei("days"),aw=ei("months"),vw=ei("years");return wt=Math.round,st={ss:44,s:45,m:45,h:22,d:26,M:11},iu=Math.abs,h=gr.prototype,h.isValid=pa,h.abs=ap,h.add=vp,h.subtract=yp,h.as=wp,h.asMilliseconds=kp,h.asSeconds=dp,h.asMinutes=gp,h.asHours=nw,h.asDays=tw,h.asWeeks=iw,h.asMonths=rw,h.asYears=uw,h.valueOf=bp,h._bubble=pp,h.clone=fw,h.get=ew,h.milliseconds=ow,h.seconds=sw,h.minutes=hw,h.hours=cw,h.days=lw,h.weeks=yw,h.months=aw,h.years=vw,h.humanize=dw,h.toISOString=ru,h.toString=ru,h.toJSON=ru,h.locale=as,h.localeData=vs,h.toIsoString=it("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",ru),h.lang=lf,e("X",0,0,"unix"),e("x",0,0,"valueOf"),f("x",lr),f("X",/[+-]?\d+(\.\d{1,3})?/),a("X",function(n,t,i){i._d=new Date(parseFloat(n,10)*1e3)}),a("x",function(n,t,i){i._d=new Date(s(n))}),u.version="2.21.0",ih(v),u.fn=r,u.min=aa,u.max=va,u.now=ts,u.utc=ht,u.unix=fp,u.months=op,u.isDate=ir,u.locale=ci,u.invalid=rr,u.duration=ot,u.isMoment=kt,u.weekdays=hp,u.parseZone=ep,u.localeData=dt,u.isDuration=ff,u.monthsShort=sp,u.weekdaysMin=lp,u.defineLocale=gu,u.updateLocale=yl,u.locales=pl,u.weekdaysShort=cp,u.normalizeUnits=rt,u.relativeTimeRounding=bw,u.relativeTimeThreshold=kw,u.calendarFormat=ov,u.prototype=r,u.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"YYYY-[W]WW",MONTH:"YYYY-MM"},u})}).call(t,i(194)(n))},function(n,t,i){function r(n){return i(f(n))}function f(n){var t=u[n];if(!(t+1))throw new Error("Cannot find module '"+n+"'.");return t}var u={"./af":324,"./af.js":324,"./ar":325,"./ar-dz":326,"./ar-dz.js":326,"./ar-kw":327,"./ar-kw.js":327,"./ar-ly":328,"./ar-ly.js":328,"./ar-ma":329,"./ar-ma.js":329,"./ar-sa":330,"./ar-sa.js":330,"./ar-tn":331,"./ar-tn.js":331,"./ar.js":325,"./az":332,"./az.js":332,"./be":333,"./be.js":333,"./bg":334,"./bg.js":334,"./bm":335,"./bm.js":335,"./bn":336,"./bn.js":336,"./bo":337,"./bo.js":337,"./br":338,"./br.js":338,"./bs":339,"./bs.js":339,"./ca":340,"./ca.js":340,"./cs":341,"./cs.js":341,"./cv":342,"./cv.js":342,"./cy":343,"./cy.js":343,"./da":344,"./da.js":344,"./de":345,"./de-at":346,"./de-at.js":346,"./de-ch":347,"./de-ch.js":347,"./de.js":345,"./dv":348,"./dv.js":348,"./el":349,"./el.js":349,"./en-au":350,"./en-au.js":350,"./en-ca":351,"./en-ca.js":351,"./en-gb":352,"./en-gb.js":352,"./en-ie":353,"./en-ie.js":353,"./en-il":354,"./en-il.js":354,"./en-nz":355,"./en-nz.js":355,"./eo":356,"./eo.js":356,"./es":357,"./es-do":358,"./es-do.js":358,"./es-us":359,"./es-us.js":359,"./es.js":357,"./et":360,"./et.js":360,"./eu":361,"./eu.js":361,"./fa":362,"./fa.js":362,"./fi":363,"./fi.js":363,"./fo":364,"./fo.js":364,"./fr":365,"./fr-ca":366,"./fr-ca.js":366,"./fr-ch":367,"./fr-ch.js":367,"./fr.js":365,"./fy":368,"./fy.js":368,"./gd":369,"./gd.js":369,"./gl":370,"./gl.js":370,"./gom-latn":371,"./gom-latn.js":371,"./gu":372,"./gu.js":372,"./he":373,"./he.js":373,"./hi":374,"./hi.js":374,"./hr":375,"./hr.js":375,"./hu":376,"./hu.js":376,"./hy-am":377,"./hy-am.js":377,"./id":378,"./id.js":378,"./is":379,"./is.js":379,"./it":380,"./it.js":380,"./ja":381,"./ja.js":381,"./jv":382,"./jv.js":382,"./ka":383,"./ka.js":383,"./kk":384,"./kk.js":384,"./km":385,"./km.js":385,"./kn":386,"./kn.js":386,"./ko":387,"./ko.js":387,"./ky":388,"./ky.js":388,"./lb":389,"./lb.js":389,"./lo":390,"./lo.js":390,"./lt":391,"./lt.js":391,"./lv":392,"./lv.js":392,"./me":393,"./me.js":393,"./mi":394,"./mi.js":394,"./mk":395,"./mk.js":395,"./ml":396,"./ml.js":396,"./mr":397,"./mr.js":397,"./ms":398,"./ms-my":399,"./ms-my.js":399,"./ms.js":398,"./mt":400,"./mt.js":400,"./my":401,"./my.js":401,"./nb":402,"./nb.js":402,"./ne":403,"./ne.js":403,"./nl":404,"./nl-be":405,"./nl-be.js":405,"./nl.js":404,"./nn":406,"./nn.js":406,"./pa-in":407,"./pa-in.js":407,"./pl":408,"./pl.js":408,"./pt":409,"./pt-br":410,"./pt-br.js":410,"./pt.js":409,"./ro":411,"./ro.js":411,"./ru":412,"./ru.js":412,"./sd":413,"./sd.js":413,"./se":414,"./se.js":414,"./si":415,"./si.js":415,"./sk":416,"./sk.js":416,"./sl":417,"./sl.js":417,"./sq":418,"./sq.js":418,"./sr":419,"./sr-cyrl":420,"./sr-cyrl.js":420,"./sr.js":419,"./ss":421,"./ss.js":421,"./sv":422,"./sv.js":422,"./sw":423,"./sw.js":423,"./ta":424,"./ta.js":424,"./te":425,"./te.js":425,"./tet":426,"./tet.js":426,"./tg":427,"./tg.js":427,"./th":428,"./th.js":428,"./tl-ph":429,"./tl-ph.js":429,"./tlh":430,"./tlh.js":430,"./tr":431,"./tr.js":431,"./tzl":432,"./tzl.js":432,"./tzm":433,"./tzm-latn":434,"./tzm-latn.js":434,"./tzm.js":433,"./ug-cn":435,"./ug-cn.js":435,"./uk":436,"./uk.js":436,"./ur":437,"./ur.js":437,"./uz":438,"./uz-latn":439,"./uz-latn.js":439,"./uz.js":438,"./vi":440,"./vi.js":440,"./x-pseudo":441,"./x-pseudo.js":441,"./yo":442,"./yo.js":442,"./zh-cn":443,"./zh-cn.js":443,"./zh-hk":444,"./zh-hk.js":444,"./zh-tw":445,"./zh-tw.js":445};r.keys=function(){return Object.keys(u)};r.resolve=f;n.exports=r;r.id=510},function(){},function(n,t,i){"use strict";function u(n){return n&&n.__esModule?n:{"default":n}}function a(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function v(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function y(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var r;t.__esModule=!0;var f=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),e=function o(n,t,i){var r,u,f;return n===null&&(n=Function.prototype),r=Object.getOwnPropertyDescriptor(n,t),r===undefined?(u=Object.getPrototypeOf(n),u===null?undefined:o(u,t,i)):"value"in r?r.value:(f=r.get,f===undefined)?undefined:f.call(i)},s=i(322),h=u(s),c=i(14),l=u(c);r=function(n){function t(){return a(this,t),v(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return y(t,n),f(t,[{key:"prepare",value:function(n,i,r,u,f,o){e(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"prepare",this).call(this,n,i,r,u,f,o);this.cellProperties.filter=!1;this.cellProperties.strict=!0}}]),t}(h.default);l.default.getSingleton().add("beforeValidate",function(n,t,i){var u=this.getCellMeta(t,this.propToCol(i));u.editor===r&&u.strict===void 0&&(u.filter=!1,u.strict=!0)});t.default=r},function(n,t,i){"use strict";function e(n){return n&&n.__esModule?n:{"default":n}}function o(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function s(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function h(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var r,u,f;t.__esModule=!0;r=i(62);u=e(r);f=function(n){function t(){return o(this,t),s(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return h(t,n),t}(u.default);t.default=f},function(n,t,i){"use strict";function c(n){return n&&n.__esModule?n:{"default":n}}function l(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function a(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function v(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var r;t.__esModule=!0;var u=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),f=function e(n,t,i){var r,u,f;return n===null&&(n=Function.prototype),r=Object.getOwnPropertyDescriptor(n,t),r===undefined?(u=Object.getPrototypeOf(n),u===null?undefined:e(u,t,i)):"value"in r?r.value:(f=r.get,f===undefined)?undefined:f.call(i)},o=i(2),s=i(62),h=c(s);r=function(n){function t(){return l(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return v(t,n),u(t,[{key:"createElements",value:function(){f(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"createElements",this).call(this);this.TEXTAREA=document.createElement("input");this.TEXTAREA.setAttribute("type","password");this.TEXTAREA.className="handsontableInput";this.textareaStyle=this.TEXTAREA.style;this.textareaStyle.width=0;this.textareaStyle.height=0;o.empty(this.TEXTAREA_PARENT);this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}]),t}(h.default);t.default=r},function(n,t,i){"use strict";function l(n){return n&&n.__esModule?n:{"default":n}}var u,f;t.__esModule=!0;var c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},r=i(2),e=i(11),o=i(18),s=i(60),h=l(s);u=h.default.prototype.extend();u.prototype.init=function(){this.select=document.createElement("SELECT");r.addClass(this.select,"htSelectEditor");this.select.style.display="none";this.instance.rootElement.appendChild(this.select);this.registerHooks()};u.prototype.registerHooks=function(){var n=this;this.instance.addHook("afterScrollHorizontally",function(){return n.refreshDimensions()});this.instance.addHook("afterScrollVertically",function(){return n.refreshDimensions()});this.instance.addHook("afterColumnResize",function(){return n.refreshDimensions()});this.instance.addHook("afterRowResize",function(){return n.refreshDimensions()})};u.prototype.prepare=function(){var n,t,i,u;h.default.prototype.prepare.apply(this,arguments);n=this.cellProperties.selectOptions;t=typeof n=="function"?this.prepareOptions(n(this.row,this.col,this.prop)):this.prepareOptions(n);r.empty(this.select);for(i in t)Object.prototype.hasOwnProperty.call(t,i)&&(u=document.createElement("OPTION"),u.value=i,r.fastInnerHTML(u,t[i]),this.select.appendChild(u))};u.prototype.prepareOptions=function(n){var i={},t,r;if(Array.isArray(n))for(t=0,r=n.length;t<r;t++)i[n[t]]=n[t];else(typeof n=="undefined"?"undefined":c(n))=="object"&&(i=n);return i};u.prototype.getValue=function(){return this.select.value};u.prototype.setValue=function(n){this.select.value=n};f=function(n){var u=this,t=u.getActiveEditor(),i,r;switch(n.keyCode){case o.KEY_CODES.ARROW_UP:i=t.select.selectedIndex-1;i>=0&&(t.select[i].selected=!0);e.stopImmediatePropagation(n);n.preventDefault();break;case o.KEY_CODES.ARROW_DOWN:r=t.select.selectedIndex+1;r<=t.select.length-1&&(t.select[r].selected=!0);e.stopImmediatePropagation(n);n.preventDefault()}};u.prototype.open=function(){this._opened=!0;this.refreshDimensions();this.select.style.display="";this.instance.addHook("beforeKeyDown",f)};u.prototype.close=function(){this._opened=!1;this.select.style.display="none";this.instance.removeHook("beforeKeyDown",f)};u.prototype.focus=function(){this.select.focus()};u.prototype.refreshValue=function(){var n=this.instance.getSourceDataAtCell(this.row,this.prop);this.originalValue=n;this.setValue(n);this.refreshDimensions()};u.prototype.refreshDimensions=function(){var t,i;if(this.state===s.EditorState.EDITING){if(this.TD=this.getEditedCell(),!this.TD){this.close();return}var u=r.outerWidth(this.TD)+1,f=r.outerHeight(this.TD)+1,e=r.offset(this.TD),o=r.offset(this.instance.rootElement),h=r.getScrollableElement(this.TD),c=e.top-o.top-1-(h.scrollTop||0),l=e.left-o.left-1-(h.scrollLeft||0),v=this.checkEditorSection(),n,a=this.instance.getSettings(),y=a.rowHeaders?1:0,p=a.colHeaders?1:0;switch(v){case"top":n=r.getCssTransform(this.instance.view.wt.wtOverlays.topOverlay.clone.wtTable.holder.parentNode);break;case"left":n=r.getCssTransform(this.instance.view.wt.wtOverlays.leftOverlay.clone.wtTable.holder.parentNode);break;case"top-left-corner":n=r.getCssTransform(this.instance.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.holder.parentNode);break;case"bottom-left-corner":n=r.getCssTransform(this.instance.view.wt.wtOverlays.bottomLeftCornerOverlay.clone.wtTable.holder.parentNode);break;case"bottom":n=r.getCssTransform(this.instance.view.wt.wtOverlays.bottomOverlay.clone.wtTable.holder.parentNode)}this.instance.getSelectedLast()[0]===0&&(c+=1);this.instance.getSelectedLast()[1]===0&&(l+=1);t=this.select.style;n&&n!=-1?t[n[0]]=n[1]:r.resetCssTransform(this.select);i=r.getComputedStyle(this.TD);parseInt(i.borderTopWidth,10)>0&&(f-=1);parseInt(i.borderLeftWidth,10)>0&&(u-=1);t.height=f+"px";t.minWidth=u+"px";t.top=c+"px";t.left=l+"px";t.margin="0px"}};u.prototype.getEditedCell=function(){var t=this.checkEditorSection(),n;switch(t){case"top":n=this.instance.view.wt.wtOverlays.topOverlay.clone.wtTable.getCell({row:this.row,col:this.col});this.select.style.zIndex=101;break;case"corner":n=this.instance.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.getCell({row:this.row,col:this.col});this.select.style.zIndex=103;break;case"left":n=this.instance.view.wt.wtOverlays.leftOverlay.clone.wtTable.getCell({row:this.row,col:this.col});this.select.style.zIndex=102;break;default:n=this.instance.getCell(this.row,this.col);this.select.style.zIndex=""}if(n!=-1&&n!=-2)return n};t.default=u},function(n,t,i){"use strict";function u(n,t,i,u,f,e,o){o.className&&(t.className=t.className?t.className+" "+o.className:o.className);o.readOnly&&r.addClass(t,o.readOnlyCellClassName);o.valid===!1&&o.invalidCellClassName?r.addClass(t,o.invalidCellClassName):r.removeClass(t,o.invalidCellClassName);o.wordWrap===!1&&o.noWordWrapClassName&&r.addClass(t,o.noWordWrapClassName);!e&&o.placeholder&&r.addClass(t,o.placeholderCellClassName)}t.__esModule=!0;var r=i(2);t.default=u},function(n,t,i){"use strict";function c(n){return n&&n.__esModule?n:{"default":n}}function a(n,t,i,o,c,l,a){var p=f.cloneNode(!0),y=r.cloneNode(!0),v;a.allowHtml?e.getRenderer("html").apply(this,arguments):e.getRenderer("text").apply(this,arguments);t.appendChild(y);u.addClass(t,"htAutocomplete");t.firstChild||t.appendChild(document.createTextNode(String.fromCharCode(160)));n.acArrowListener||(v=new s.default(n),n.acArrowListener=function(r){u.hasClass(r.target,"htAutocompleteArrow")&&n.view.wt.getSetting("onCellDblClick",null,new h.CellCoords(i,o),t)},v.addEventListener(n.rootElement,"mousedown",n.acArrowListener),n.addHookOnce("afterDestroy",function(){v.destroy()}))}var f,r,l;t.__esModule=!0;var u=i(2),o=i(9),s=c(o),h=i(8),e=i(15);f=document.createElement("DIV");f.className="htAutocompleteWrapper";r=document.createElement("DIV");r.className="htAutocompleteArrow";r.appendChild(document.createTextNode(String.fromCharCode(9660)));l=function(n,t){t.innerHTML=n.innerHTML;u.empty(n);n.appendChild(t)};t.default=a},function(n,t,i){"use strict";function y(n){return n&&n.__esModule?n:{"default":n}}function w(n,t,i,u,s,h,c){function rt(n){var i="SPACE|ENTER",r="DELETE|BACKSPACE",t=a.partial(l.isKey,n.keyCode);t(i+"|"+r)&&!e.isImmediatePropagationStopped(n)&&ut(function(){e.stopImmediatePropagation(n);n.preventDefault()});t(i)&&it();t(r)&&it(!0)}function it(){var h=arguments.length>0&&arguments[0]!==undefined?arguments[0]:!1,f=n.getSelectedRangeLast(),i,r,t,e;if(f){var o=f.getTopLeftCorner(),c=o.row,l=o.col,s=f.getBottomRightCorner(),a=s.row,v=s.col,u=[];for(i=c;i<=a;i+=1)for(r=l;r<=v;r+=1){if(t=n.getCellMeta(i,r),t.type!=="checkbox")return;t.readOnly!==!0&&(typeof t.checkedTemplate=="undefined"&&(t.checkedTemplate=!0),typeof t.uncheckedTemplate=="undefined"&&(t.uncheckedTemplate=!1),e=n.getDataAtCell(i,r),h===!1?[t.checkedTemplate,t.checkedTemplate.toString()].includes(e)?u.push([i,r,t.uncheckedTemplate]):[t.uncheckedTemplate,t.uncheckedTemplate.toString(),null,void 0].includes(e)&&u.push([i,r,t.checkedTemplate]):u.push([i,r,t.uncheckedTemplate]))}u.length>0&&n.setDataAtCell(u)}}function ut(t){var f=n.getSelectedRangeLast(),e,o,i,r,u,s,h;if(f)for(e=f.getTopLeftCorner(),o=f.getBottomRightCorner(),i=e.row;i<=o.row;i++)for(r=e.col;r<=o.col;r++){if(u=n.getCellMeta(i,r),u.type!=="checkbox")return;s=n.getCell(i,r);s==null?t(i,r,u):(h=s.querySelectorAll("input[type=checkbox]"),h.length>0&&!u.readOnly&&t(h))}}var nt,g;v.getRenderer("base").apply(this,arguments);var ft=b(n),y=k(),w=c.label,tt=!1;typeof c.checkedTemplate=="undefined"&&(c.checkedTemplate=!0);typeof c.uncheckedTemplate=="undefined"&&(c.uncheckedTemplate=!1);r.empty(t);h===c.checkedTemplate||f.equalsIgnoreCase(h,c.checkedTemplate)?y.checked=!0:h===c.uncheckedTemplate||f.equalsIgnoreCase(h,c.uncheckedTemplate)?y.checked=!1:h===null?r.addClass(y,"noValue"):(y.style.display="none",r.addClass(y,p),tt=!0);y.setAttribute("data-row",i);y.setAttribute("data-col",u);!tt&&w&&(nt="",w.value?nt=typeof w.value=="function"?w.value.call(this,i,u,s,h):w.value:w.property&&(nt=n.getDataAtRowProp(i,w.property)),g=d(nt),w.position==="before"?g.appendChild(y):g.insertBefore(y,g.firstChild),y=g);t.appendChild(y);tt&&t.appendChild(document.createTextNode("#bad-value#"));o.has(n)||(o.set(n,!0),n.addHook("beforeKeyDown",rt))}function b(n){var t=s.get(n);return t||(t=new c.default(n),t.addEventListener(n.rootElement,"click",function(t){return nt(t,n)}),t.addEventListener(n.rootElement,"mouseup",function(t){return g(t,n)}),t.addEventListener(n.rootElement,"change",function(t){return tt(t,n)}),s.set(n,t)),t}function k(){var n=document.createElement("input");return n.className="htCheckboxRendererInput",n.type="checkbox",n.setAttribute("autocomplete","off"),n.setAttribute("tabindex","-1"),n.cloneNode(!1)}function d(n){var t=document.createElement("label");return t.className="htCheckboxRendererLabel",t.appendChild(document.createTextNode(n)),t.cloneNode(!0)}function g(n,t){u(n.target)&&setTimeout(t.listen,10)}function nt(n,t){if(!u(n.target))return!1;var i=parseInt(n.target.getAttribute("data-row"),10),r=parseInt(n.target.getAttribute("data-col"),10),f=t.getCellMeta(i,r);f.readOnly&&n.preventDefault()}function tt(n,t){var r;if(!u(n.target))return!1;var f=parseInt(n.target.getAttribute("data-row"),10),e=parseInt(n.target.getAttribute("data-col"),10),i=t.getCellMeta(f,e);i.readOnly||(r=null,r=n.target.checked?i.uncheckedTemplate===void 0?!0:i.checkedTemplate:i.uncheckedTemplate===void 0?!1:i.uncheckedTemplate,t.setDataAtCell(f,e,r))}function u(n){return n.tagName==="INPUT"&&n.getAttribute("type")==="checkbox"}t.__esModule=!0;var r=i(2),f=i(31),h=i(9),c=y(h),l=i(18),a=i(35),e=i(11),v=i(15);var o=new WeakMap,s=new WeakMap,p="htBadValue";t.default=w},function(n,t,i){"use strict";function f(n,t,i,f,e,o){u.getRenderer("base").apply(this,arguments);(o===null||o===void 0)&&(o="");r.fastInnerHTML(t,o)}t.__esModule=!0;var r=i(2),u=i(15);t.default=f},function(n,t,i){"use strict";function o(n){return n&&n.__esModule?n:{"default":n}}function s(n,t,i,u,o,s,h){if(e.isNumeric(s)){var l=h.numericFormat,a=l&&l.culture,y=l&&l.pattern,v=h.className||"",c=v.length?v.split(" "):[];typeof a!="undefined"&&r.default.culture(a);s=r.default(s).format(y||"0");c.indexOf("htLeft")<0&&c.indexOf("htCenter")<0&&c.indexOf("htRight")<0&&c.indexOf("htJustify")<0&&c.push("htRight");c.indexOf("htNumeric")<0&&c.push("htNumeric");h.className=c.join(" ")}f.getRenderer("text")(n,t,i,u,o,s,h)}t.__esModule=!0;var u=i(446),r=o(u),f=i(15),e=i(4);t.default=s},function(){},function(n,t,i){"use strict";function e(n,t,i,e,o,s,h){u.getRenderer("text").apply(this,arguments);s=t.innerHTML;var l=h.hashLength||s.length,a=h.hashSymbol||"*",c="";f.rangeEach(l-1,function(){c+=a});r.fastInnerHTML(t,c)}t.__esModule=!0;var r=i(2),u=i(15),f=i(4);t.default=e},function(n,t,i){"use strict";function e(n,t,i,e,o,s,h){var l,c;f.getRenderer("base").apply(this,arguments);!s&&h.placeholder&&(s=h.placeholder);l=u.stringify(s);n.getSettings().trimWhitespace||(l=l.replace(/ /g,String.fromCharCode(160)));h.rendererTemplate?(r.empty(t),c=document.createElement("TEMPLATE"),c.setAttribute("bind","{{}}"),c.innerHTML=h.rendererTemplate,HTMLTemplateElement.decorate(c),c.model=n.getSourceDataAtRow(i),t.appendChild(c)):r.fastInnerText(t,l)}t.__esModule=!0;var r=i(2),u=i(13),f=i(15);t.default=e},function(n,t){"use strict";function r(n,t){if(n==null&&(n=""),this.allowEmpty&&n===""){t(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(n,i(n,t)):i(n,t)(this.source):t(!0)}function i(n,t){var i=n;return function(n){for(var u=!1,r=0,f=n.length;r<f;r++)if(i===n[r]){u=!0;break}t(u)}}t.__esModule=!0;t.default=r},function(n,t,i){"use strict";function s(n){return n&&n.__esModule?n:{"default":n}}function h(n,t){var i=!0,s=o.getEditorInstance("date",this.instance),f,e;if(n==null&&(n=""),f=r.default(new Date(n)).isValid()||r.default(n,s.defaultDateFormat).isValid(),e=r.default(n,this.dateFormat||s.defaultDateFormat,!0).isValid(),this.allowEmpty&&n===""&&(f=!0,e=!0),f||(i=!1),!f&&e&&(i=!0),f&&!e)if(this.correctFormat===!0){var h=u(n,this.dateFormat),c=this.instance.runHooks("unmodifyRow",this.row),l=this.instance.runHooks("unmodifyCol",this.col);this.instance.setDataAtCell(c,l,h,"dateValidator");i=!0}else i=!1;t(i)}function u(n,t){var i=r.default(e.getNormalizedDate(n)),u=r.default(n,t),o=n.search(/[A-z]/g)>-1,f=void 0;return f=i.isValid()&&i.format("x")===u.format("x")||!u.isValid()||o?i:u,f.format(t)}t.__esModule=!0;t.default=h;t.correctFormat=u;var f=i(23),r=s(f),e=i(447),o=i(19)},function(n,t){"use strict";function i(n,t){n==null&&(n="");this.allowEmpty&&n===""?t(!0):n===""?t(!1):t(/^-?\d*(\.|,)?\d*$/.test(n))}t.__esModule=!0;t.default=i},function(n,t,i){"use strict";function e(n){return n&&n.__esModule?n:{"default":n}}function o(n,t){var i=!0,e=this.timeFormat||"h:mm:ss a",o;n===null&&(n="");n=/^\d{3,}$/.test(n)?parseInt(n,10):n;o=/^\d{1,2}$/.test(n);o&&(n+=":00");var h=r.default(n,f,!0).isValid()?r.default(n):r.default(n,e),u=h.isValid(),s=r.default(n,e,!0).isValid()&&!o;if(this.allowEmpty&&n===""&&(u=!0,s=!0),u||(i=!1),!u&&s&&(i=!0),u&&!s)if(this.correctFormat===!0){var c=h.format(e),l=this.instance.runHooks("unmodifyRow",this.row),a=this.instance.runHooks("unmodifyCol",this.col);this.instance.setDataAtCell(l,a,c,"timeValidator");i=!0}else i=!1;t(i)}var u,r,f;t.__esModule=!0;t.default=o;u=i(23);r=e(u);f=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"]},function(n,t,i){"use strict";t.__esModule=!0;var u=i(19),f=i(15),e=i(36),r="autocomplete";t.default={editor:u.getEditor(r),renderer:f.getRenderer(r),validator:e.getValidator(r)}},function(n,t,i){"use strict";t.__esModule=!0;var u=i(19),f=i(15),r="checkbox";t.default={editor:u.getEditor(r),renderer:f.getRenderer(r)}},function(n,t,i){"use strict";t.__esModule=!0;var u=i(19),f=i(15),e=i(36),r="date";t.default={editor:u.getEditor(r),renderer:f.getRenderer("autocomplete"),validator:e.getValidator(r)}},function(n,t,i){"use strict";t.__esModule=!0;var r=i(19),u=i(15),f=i(36);t.default={editor:r.getEditor("dropdown"),renderer:u.getRenderer("autocomplete"),validator:f.getValidator("autocomplete")}},function(n,t,i){"use strict";t.__esModule=!0;var r=i(19),u=i(15);t.default={editor:r.getEditor("handsontable"),renderer:u.getRenderer("autocomplete")}},function(n,t,i){"use strict";t.__esModule=!0;var u=i(19),f=i(15),e=i(36),r="numeric";t.default={editor:u.getEditor(r),renderer:f.getRenderer(r),validator:e.getValidator(r),dataType:"number"}},function(n,t,i){"use strict";t.__esModule=!0;var u=i(19),f=i(15),e=i(36),r="password";t.default={editor:u.getEditor(r),renderer:f.getRenderer(r),copyable:!1}},function(n,t,i){"use strict";t.__esModule=!0;var e=i(33),u=i(19),f=i(15),r="text";t.default={editor:u.getEditor(r),renderer:f.getRenderer(r)}},function(n,t,i){"use strict";t.__esModule=!0;var r=i(19),u=i(15),f=i(36);t.default={editor:r.getEditor("text"),renderer:u.getRenderer("text"),validator:f.getValidator("time")}},function(n,t,i){"use strict";function f(n){return n&&n.__esModule?n:{"default":n}}function r(n,t,i){var r=this;this.instance=n;this.priv=t;this.GridSettings=i;this.dataSource=this.instance.getSettings().data;this.cachedLength=null;this.skipCache=!1;this.latestSourceRowsCount=0;this.duckSchema=this.dataSource&&this.dataSource[0]?this.recursiveDuckSchema(this.dataSource[0]):{};this.createMap();this.interval=p.default.create(function(){return r.clearLengthCache()},"15fps");this.instance.addHook("skipLengthCache",function(n){return r.onSkipLengthCache(n)});this.onSkipLengthCache(500)}var h;t.__esModule=!0;var c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},l=i(448),o=f(l),a=i(81),v=i(153),u=i(1),e=i(0),y=i(538),p=f(y),s=i(4),w=i(539),b=f(w),k=i(14),d=f(k);r.prototype.DESTINATION_RENDERER=1;r.prototype.DESTINATION_CLIPBOARD_GENERATOR=2;r.prototype.recursiveDuckSchema=function(n){return u.duckSchema(n)};r.prototype.recursiveDuckColumns=function(n,t,i){var f,r;if(typeof t=="undefined"&&(t=0,i=""),(typeof n=="undefined"?"undefined":c(n))==="object"&&!Array.isArray(n))for(r in n)u.hasOwnProperty(n,r)&&(n[r]===null?(f=i+r,this.colToPropCache.push(f),this.propToColCache.set(f,t),t++):t=this.recursiveDuckColumns(n[r],t,r+"."));return t};r.prototype.createMap=function(){var n=void 0,r=this.getSchema(),t,i,e;if(typeof r=="undefined")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");if(this.colToPropCache=[],this.propToColCache=new b.default,t=this.instance.getSettings().columns,t){var c=this.instance.getSettings().maxCols,o=Math.min(c,t.length),s=0,f=!1,h=u.deepObjectSize(r);for(typeof t=="function"&&(o=h>0?h:this.instance.countSourceCols(),f=!0),n=0;n<o;n++)i=f?t(n):t[n],u.isObject(i)&&(typeof i.data!="undefined"&&(e=f?s:n,this.colToPropCache[e]=i.data,this.propToColCache.set(i.data,e)),s++)}else this.recursiveDuckColumns(r)};r.prototype.colToProp=function(n){return(n=this.instance.runHooks("modifyCol",n),!isNaN(n)&&this.colToPropCache&&typeof this.colToPropCache[n]!="undefined")?this.colToPropCache[n]:n};r.prototype.propToCol=function(n){var t;return t=typeof this.propToColCache.get(n)=="undefined"?n:this.propToColCache.get(n),this.instance.runHooks("unmodifyCol",t)};r.prototype.getSchema=function(){var n=this.instance.getSettings().dataSchema;return n?typeof n=="function"?n():n:this.duckSchema};r.prototype.createRow=function(n){var t=this,r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1,f=arguments[2],i=0,e;if((typeof n!="number"||n>=this.instance.countSourceRows())&&(n=this.instance.countSourceRows()),e=this.instance.runHooks("beforeCreateRow",n,r,f),e===!1)return 0;for(var o=this.instance.getSettings().maxRows,h=this.instance.countCols(),c=function(){var r=null;t.instance.dataType==="array"?t.instance.getSettings().dataSchema?r=u.deepClone(t.getSchema()):(r=[],s.rangeEach(h-1,function(){return r.push(null)})):t.instance.dataType==="function"?r=t.instance.getSettings().dataSchema(n):(r={},u.deepExtend(r,t.getSchema()));n===t.instance.countSourceRows()?t.dataSource.push(r):t.spliceData(n,0,r);i++};i<r&&this.instance.countSourceRows()<o;)c();return this.instance.runHooks("afterCreateRow",n,i,f),this.instance.forceFullRender=!0,i};r.prototype.createCol=function(n,t,i){var c,r,o;if(!this.instance.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");var s=this.instance.countSourceRows(),u=this.dataSource,h,f=0,e;for(t||(t=1),(typeof n!="number"||n>=this.instance.countCols())&&(n=this.instance.countCols()),this.instance.runHooks("beforeCreateCol",n,t,i),e=n,c=this.instance.getSettings().maxCols;f<t&&this.instance.countCols()<c;){if(h=v.columnFactory(this.GridSettings,this.priv.columnsSettingConflicts),typeof n!="number"||n>=this.instance.countCols()){if(s>0)for(r=0;r<s;r++)typeof u[r]=="undefined"&&(u[r]=[]),u[r].push(null);else u.push([null]);this.priv.columnSettings.push(h)}else{for(o=0;o<s;o++)u[o].splice(e,0,null);this.priv.columnSettings.splice(e,0,h)}f++;e++}return this.instance.runHooks("afterCreateCol",n,f,i),this.instance.forceFullRender=!0,f};r.prototype.removeRow=function(n,t,i){var u,e,f,r;(t||(t=1),typeof n!="number"&&(n=-t),t=this.instance.runHooks("modifyRemovedAmount",t,n),n=(this.instance.countSourceRows()+n)%this.instance.countSourceRows(),u=this.visualRowsToPhysical(n,t),e=this.instance.runHooks("beforeRemoveRow",n,t,u,i),e!==!1)&&(f=this.dataSource,r=void 0,r=this.filterData(n,t),r&&(f.length=0,Array.prototype.push.apply(f,r)),this.instance.runHooks("afterRemoveRow",n,t,u,i),this.instance.forceFullRender=!0)};r.prototype.removeCol=function(n,t,i){var u,f,v,e,y,o,s;if(this.instance.dataType==="object"||this.instance.getSettings().columns)throw new Error("cannot remove column with object data source or columns option specified");t||(t=1);typeof n!="number"&&(n=-t);n=(this.instance.countCols()+n)%this.instance.countCols();var r=this.visualColumnsToPhysical(n,t),l=r.slice(0).sort(function(n,t){return t-n}),p=this.instance.runHooks("beforeRemoveCol",n,t,r,i);if(p!==!1){var h=!0,c=l.length,a=this.dataSource;for(u=0;u<c;u++)h&&r[0]!==r[u]-u&&(h=!1);if(h)for(f=0,v=this.instance.countSourceRows();f<v;f++)a[f].splice(r[0],t);else{for(e=0,y=this.instance.countSourceRows();e<y;e++)for(o=0;o<c;o++)a[e].splice(l[o],1);for(s=0;s<c;s++)this.priv.columnSettings.splice(r[s],1)}this.instance.runHooks("afterRemoveCol",n,t,r,i);this.instance.forceFullRender=!0}};r.prototype.spliceCol=function(n,t,i){var r=arguments.length>=4?[].slice.call(arguments,3):[],f=this.instance.getDataAtCol(n),o=f.slice(t,t+i),s=f.slice(t+i),u;for(e.extendArray(r,s),u=0;u<i;)r.push(null),u++;return e.to2dArray(r),this.instance.populateFromArray(t,n,r,null,null,"spliceCol"),o};r.prototype.spliceRow=function(n,t,i){var r=arguments.length>=4?[].slice.call(arguments,3):[],f=this.instance.getSourceDataAtRow(n),o=f.slice(t,t+i),s=f.slice(t+i),u;for(e.extendArray(r,s),u=0;u<i;)r.push(null),u++;return this.instance.populateFromArray(n,t,[r],null,null,"spliceRow"),o};r.prototype.spliceData=function(n,t,i){var r=this.instance.runHooks("beforeDataSplice",n,t,i);r!==!1&&this.dataSource.splice(n,t,i)};r.prototype.filterData=function(n,t){var i=this.visualRowsToPhysical(n,t),r=this.instance.runHooks("beforeDataFilter",n,t,i);if(r!==!1)return this.dataSource.filter(function(n,t){return i.indexOf(t)==-1})};r.prototype.get=function(n,t){var i,s,r,h,f,e,c,o;if(n=this.instance.runHooks("modifyRow",n),i=this.dataSource[n],s=this.instance.runHooks("modifyRowData",n),i=isNaN(s)?s:i,r=null,i&&i.hasOwnProperty&&u.hasOwnProperty(i,t))r=i[t];else if(typeof t=="string"&&t.indexOf(".")>-1){if(h=t.split("."),f=i,!f)return null;for(e=0,c=h.length;e<c;e++)if(f=f[h[e]],typeof f=="undefined")return null;r=f}else typeof t=="function"&&(r=t(this.dataSource.slice(n,n+1)[0]));return this.instance.hasHook("modifyData")&&(o=u.createObjectPropListener(r),this.instance.runHooks("modifyData",n,this.propToCol(t),o,"get"),o.isTouched()&&(r=o.value)),r};h=a.cellMethodLookupFactory("copyable",!1);r.prototype.getCopyable=function(n,t){return h.call(this.instance,n,this.propToCol(t))?this.get(n,t):""};r.prototype.set=function(n,t,i,r){var f,c,h;if(n=this.instance.runHooks("modifyRow",n,r||"datamapGet"),f=this.dataSource[n],c=this.instance.runHooks("modifyRowData",n),f=isNaN(c)?c:f,this.instance.hasHook("modifyData")&&(h=u.createObjectPropListener(i),this.instance.runHooks("modifyData",n,this.propToCol(t),h,"set"),h.isTouched()&&(i=h.value)),f&&f.hasOwnProperty&&u.hasOwnProperty(f,t))f[t]=i;else if(typeof t=="string"&&t.indexOf(".")>-1){for(var o=t.split("."),s=f,e=0,l=void 0,e=0,l=o.length-1;e<l;e++)typeof s[o[e]]=="undefined"&&(s[o[e]]={}),s=s[o[e]];s[o[e]]=i}else typeof t=="function"?t(this.dataSource.slice(n,n+1)[0],i):f[t]=i};r.prototype.visualRowsToPhysical=function(n,t){for(var i=this.instance.countSourceRows(),r=(i+n)%i,u=[],f=t,e;r<i&&f;)e=this.instance.runHooks("modifyRow",r),u.push(e),f--,r++;return u};r.prototype.visualColumnsToPhysical=function(n,t){for(var i=this.instance.countCols(),r=(i+n)%i,u=[],f=t,e;r<i&&f;)e=this.instance.runHooks("modifyCol",r),u.push(e),f--,r++;return u};r.prototype.clear=function(){for(var t,n=0;n<this.instance.countSourceRows();n++)for(t=0;t<this.instance.countCols();t++)this.set(n,this.colToProp(t),"")};r.prototype.clearLengthCache=function(){this.cachedLength=null};r.prototype.getLength=function(){var u=this,r=void 0,t=this.instance.getSettings().maxRows,n,i;return r=t<0||t===0?0:t||Infinity,n=this.instance.countSourceRows(),this.instance.hasHook("modifyRow")?(i=this.skipCache,this.interval.start(),n!==this.latestSourceRowsCount&&(i=!0),this.latestSourceRowsCount=n,this.cachedLength===null||i?(s.rangeEach(n-1,function(t){t=u.instance.runHooks("modifyRow",t);t===null&&--n}),this.cachedLength=n):n=this.cachedLength):this.interval.stop(),Math.min(n,r)};r.prototype.getAll=function(){var n={row:0,col:0},t={row:Math.max(this.instance.countSourceRows()-1,0),col:Math.max(this.instance.countCols()-1,0)};return n.row-t.row==0&&!this.instance.countSourceRows()?[]:this.getRange(n,t,r.prototype.DESTINATION_RENDERER)};r.prototype.getRange=function(n,t,i){var r,o,u,s,h=[],f,c=this.instance.getSettings().maxRows,l=this.instance.getSettings().maxCols,a,e;if(c===0||l===0)return[];for(a=i===this.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,o=Math.min(Math.max(c-1,0),Math.max(n.row,t.row)),s=Math.min(Math.max(l-1,0),Math.max(n.col,t.col)),r=Math.min(n.row,t.row);r<=o;r++){for(f=[],e=this.instance.runHooks("modifyRow",r),u=Math.min(n.col,t.col);u<=s;u++){if(e===null)break;f.push(a.call(this,r,this.colToProp(u)))}e!==null&&h.push(f)}return h};r.prototype.getText=function(n,t){return o.default.stringify(this.getRange(n,t,this.DESTINATION_RENDERER))};r.prototype.getCopyableText=function(n,t){return o.default.stringify(this.getRange(n,t,this.DESTINATION_CLIPBOARD_GENERATOR))};r.prototype.onSkipLengthCache=function(n){var t=this;this.skipCache=!0;setTimeout(function(){t.skipCache=!1},n)};r.prototype.destroy=function(){this.interval.stop();this.interval=null;this.instance=null;this.priv=null;this.GridSettings=null;this.dataSource=null;this.cachedLength=null;this.duckSchema=null};t.default=r},function(n,t,i){"use strict";function o(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function e(n){return typeof n=="string"&&/fps$/.test(n)&&(n=1e3/parseInt(n.replace("fps","")||0,10)),n}var u,r,f;t.__esModule=!0;u=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}();t.parseDelay=e;r=i(43);f=function(){function n(t,i){var r=this;o(this,n);this.timer=null;this.func=t;this.delay=e(i);this.stopped=!0;this._then=null;this._callback=function(){return r.__callback()}}return u(n,null,[{key:"create",value:function(t,i){return new n(t,i)}}]),u(n,[{key:"start",value:function(){return this.stopped&&(this._then=Date.now(),this.stopped=!1,this.timer=r.requestAnimationFrame(this._callback)),this}},{key:"stop",value:function(){return this.stopped||(this.stopped=!0,r.cancelAnimationFrame(this.timer),this.timer=null),this}},{key:"__callback",value:function(){if(this.timer=r.requestAnimationFrame(this._callback),this.delay){var n=Date.now(),t=n-this._then;t>this.delay&&(this._then=n-t%this.delay,this.func())}else this.func()}}]),n}();t.default=f},function(n,t){"use strict";function r(){function t(n){return n!==null&&!u(n)&&(typeof n=="string"||typeof n=="number")}function r(n){return n!==null&&((typeof n=="undefined"?"undefined":i(n))=="object"||typeof n=="function")}function u(n){return n!==n}var n={arrayMap:[],weakMap:new WeakMap};return{get:function(i){return t(i)?n.arrayMap[i]:r(i)?n.weakMap.get(i):void 0},set:function(i,u){if(t(i))n.arrayMap[i]=u;else if(r(i))n.weakMap.set(i,u);else throw new Error("Invalid key type");},"delete":function(i){t(i)?delete n.arrayMap[i]:r(i)&&n.weakMap.delete(i)}}}t.__esModule=!0;var i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n};t.default=r},function(n,t,i){"use strict";function a(n){return n&&n.__esModule?n:{"default":n}}function e(n,t,i){function v(n){i.setSelectedHeaders(!1,!1,!1);var r=typeof t.settings.enterMoves=="function"?t.settings.enterMoves(event):t.settings.enterMoves;n?i.transformStart(-r.row,-r.col):i.transformStart(r.row,r.col,!0)}function p(n){n?(i.selectedHeader.cols&&i.setSelectedHeaders(i.selectedHeader.rows,!1,!1),i.transformEnd(-1,0)):(i.setSelectedHeaders(!1,!1,!1),i.transformStart(-1,0))}function w(n){n?i.transformEnd(1,0):(i.setSelectedHeaders(!1,!1,!1),i.transformStart(1,0))}function b(n){n?i.transformEnd(0,1):(i.setSelectedHeaders(!1,!1,!1),i.transformStart(0,1))}function k(n){n?(i.selectedHeader.rows&&i.setSelectedHeaders(!1,i.selectedHeader.cols,!1),i.transformEnd(0,-1)):(i.setSelectedHeaders(!1,!1,!1),i.transformStart(0,-1))}function d(s){var h,c,y;if(n.isListening()&&(n.runHooks("beforeKeyDown",s),!a)&&!u.isImmediatePropagationStopped(s)&&(t.lastKeyCode=s.keyCode,i.isSelected())){if(h=(s.ctrlKey||s.metaKey)&&!s.altKey,e&&!e.isWaiting()&&!r.isMetaKey(s.keyCode)&&!r.isCtrlMetaKey(s.keyCode)&&!h&&!o.isEditorOpened()){o.openEditor("",s);return}c=s.shiftKey?i.setRangeEnd:i.setRangeStart;switch(s.keyCode){case r.KEY_CODES.A:!o.isEditorOpened()&&h&&(i.selectAll(),s.preventDefault(),u.stopPropagation(s));break;case r.KEY_CODES.ARROW_UP:o.isEditorOpened()&&!e.isWaiting()&&o.closeEditorAndSaveChanges(h);p(s.shiftKey);s.preventDefault();u.stopPropagation(s);break;case r.KEY_CODES.ARROW_DOWN:o.isEditorOpened()&&!e.isWaiting()&&o.closeEditorAndSaveChanges(h);w(s.shiftKey);s.preventDefault();u.stopPropagation(s);break;case r.KEY_CODES.ARROW_RIGHT:o.isEditorOpened()&&!e.isWaiting()&&o.closeEditorAndSaveChanges(h);b(s.shiftKey);s.preventDefault();u.stopPropagation(s);break;case r.KEY_CODES.ARROW_LEFT:o.isEditorOpened()&&!e.isWaiting()&&o.closeEditorAndSaveChanges(h);k(s.shiftKey);s.preventDefault();u.stopPropagation(s);break;case r.KEY_CODES.TAB:i.setSelectedHeaders(!1,!1,!1);y=typeof t.settings.tabMoves=="function"?t.settings.tabMoves(s):t.settings.tabMoves;s.shiftKey?i.transformStart(-y.row,-y.col):i.transformStart(y.row,y.col,!0);s.preventDefault();u.stopPropagation(s);break;case r.KEY_CODES.BACKSPACE:case r.KEY_CODES.DELETE:n.emptySelectedCells();o.prepareEditor();s.preventDefault();break;case r.KEY_CODES.F2:o.openEditor(null,s);e&&e.enableFullEditMode();s.preventDefault();break;case r.KEY_CODES.ENTER:o.isEditorOpened()?(e&&e.state!==l.EditorState.WAITING&&o.closeEditorAndSaveChanges(h),v(s.shiftKey)):n.getSettings().enterBeginsEditing?(o.openEditor(null,s),e&&e.enableFullEditMode()):v(s.shiftKey);s.preventDefault();u.stopImmediatePropagation(s);break;case r.KEY_CODES.ESCAPE:o.isEditorOpened()&&o.closeEditorAndRestoreOriginalValue(h);s.preventDefault();break;case r.KEY_CODES.HOME:i.setSelectedHeaders(!1,!1,!1);s.ctrlKey||s.metaKey?c.call(i,new f.CellCoords(0,i.selectedRange.current().from.col)):c.call(i,new f.CellCoords(i.selectedRange.current().from.row,0));s.preventDefault();u.stopPropagation(s);break;case r.KEY_CODES.END:i.setSelectedHeaders(!1,!1,!1);s.ctrlKey||s.metaKey?c.call(i,new f.CellCoords(n.countRows()-1,i.selectedRange.current().from.col)):c.call(i,new f.CellCoords(i.selectedRange.current().from.row,n.countCols()-1));s.preventDefault();u.stopPropagation(s);break;case r.KEY_CODES.PAGE_UP:i.setSelectedHeaders(!1,!1,!1);i.transformStart(-n.countVisibleRows(),0);s.preventDefault();u.stopPropagation(s);break;case r.KEY_CODES.PAGE_DOWN:i.setSelectedHeaders(!1,!1,!1);i.transformStart(n.countVisibleRows(),0);s.preventDefault();u.stopPropagation(s)}}}function g(){function t(n,t,i){i.nodeName==="TD"&&(o.openEditor(null,n),e&&e.enableFullEditMode())}n.addHook("afterDocumentKeyDown",d);y.addEventListener(document.documentElement,"keydown",function(t){a||n.runHooks("afterDocumentKeyDown",t)});n.view.wt.update("onCellDblClick",t)}var o=this,a=!1,h=!1,y,e;y=new c.default(n);this.lockEditor=function(){h=!0};this.unlockEditor=function(){h=!1};this.destroyEditor=function(n){h||this.closeEditor(n)};this.getActiveEditor=function(){return e};this.prepareEditor=function(){if(!h){var i,t,f,c,l,r,u;if(e&&e.isWaiting()){this.closeEditor(!1,!1,function(n){n&&o.prepareEditor()});return}i=n.selection.selectedRange.current().highlight.row;t=n.selection.selectedRange.current().highlight.col;f=n.colToProp(t);c=n.getCell(i,t);l=n.getSourceDataAtCell(n.runHooks("modifyRow",i),t);r=n.getCellMeta(i,t);u=n.getCellEditor(r);u?(e=s.getEditorInstance(u,n),e.prepare(i,t,f,c,l,r)):e=void 0}};this.isEditorOpened=function(){return e&&e.isOpened()};this.openEditor=function(n,t){e&&!e.cellProperties.readOnly?e.beginEditing(n,t):e&&e.cellProperties.readOnly&&t&&t.keyCode===r.KEY_CODES.ENTER&&v()};this.closeEditor=function(n,t,i){e?e.finishEditing(n,t,i):i&&i(!1)};this.closeEditorAndSaveChanges=function(n){return this.closeEditor(!1,n)};this.closeEditorAndRestoreOriginalValue=function(n){return this.closeEditor(!0,n)};this.destroy=function(){a=!0};g()}var o;t.__esModule=!0;var f=i(8),r=i(18),u=i(11),s=i(19),h=i(9),c=a(h),l=i(60);o=new WeakMap;e.getInstance=function(n,t,i,r){var u=o.get(n);return u||(u=new e(n,t,i,r),o.set(n,u)),u};t.default=e},function(n,t,i){"use strict";function s(n){return n&&n.__esModule?n:{"default":n}}function u(n){var v=this,t=this,s,i,u,h,c;this.eventManager=new l.default(n);this.instance=n;this.settings=n.getSettings();this.selectionMouseDown=!1;s=n.rootElement.getAttribute("style");s&&n.rootElement.setAttribute("data-originalstyle",s);r.addClass(n.rootElement,"handsontable");i=document.createElement("TABLE");r.addClass(i,"htCore");n.getSettings().tableClassName&&r.addClass(i,n.getSettings().tableClassName);this.THEAD=document.createElement("THEAD");i.appendChild(this.THEAD);this.TBODY=document.createElement("TBODY");i.appendChild(this.TBODY);n.table=i;n.container.insertBefore(i,n.container.firstChild);this.eventManager.addEventListener(n.rootElement,"mousedown",function(n){this.selectionMouseDown=!0;t.isTextSelectionAllowed(n.target)||(h(),n.preventDefault(),window.focus())});this.eventManager.addEventListener(n.rootElement,"mouseup",function(){this.selectionMouseDown=!1});this.eventManager.addEventListener(n.rootElement,"mousemove",function(n){this.selectionMouseDown&&!t.isTextSelectionAllowed(n.target)&&(h(),n.preventDefault())});this.eventManager.addEventListener(document.documentElement,"keyup",function(t){n.selection.isInProgress()&&!t.shiftKey&&n.selection.finish()});this.isMouseDown=function(){return u};this.eventManager.addEventListener(document.documentElement,"mouseup",function(t){n.selection.isInProgress()&&e.isLeftClick(t)&&n.selection.finish();u=!1;!r.isOutsideInput(document.activeElement)&&(n.selection.isSelected()||e.isRightClick(t))||n.unlisten()});this.eventManager.addEventListener(document.documentElement,"mousedown",function(i){var c=i.target,f=i.target,o=i.x||i.clientX,s=i.y||i.clientY,e,h;if(!u&&n.rootElement){if(f===n.view.wt.wtTable.holder){if(e=r.getScrollbarWidth(),document.elementFromPoint(o+e,s)!==n.view.wt.wtTable.holder||document.elementFromPoint(o,s+e)!==n.view.wt.wtTable.holder)return}else while(f!==document.documentElement){if(f===null){if(i.isTargetWebComponent)break;return}if(f===n.rootElement)return;f=f.parentNode}h=typeof t.settings.outsideClickDeselects=="function"?t.settings.outsideClickDeselects(c):t.settings.outsideClickDeselects;h?n.deselectCell():n.destroyEditor()}});this.eventManager.addEventListener(i,"selectstart",function(n){t.settings.fragmentSelection||r.isInput(n.target)||n.preventDefault()});h=function(){window.getSelection?window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&window.getSelection().removeAllRanges():document.selection&&document.selection.empty()};c={debug:function(){return t.settings.debug},externalRowCalculator:this.instance.getPlugin("autoRowSize")&&this.instance.getPlugin("autoRowSize").isEnabled(),table:i,preventOverflow:function(){return v.settings.preventOverflow},stretchH:function(){return t.settings.stretchH},data:n.getDataAtCell,totalRows:function(){return n.countRows()},totalColumns:function(){return n.countCols()},fixedColumnsLeft:function(){return t.settings.fixedColumnsLeft},fixedRowsTop:function(){return t.settings.fixedRowsTop},fixedRowsBottom:function(){return t.settings.fixedRowsBottom},minSpareRows:function(){return t.settings.minSpareRows},renderAllRows:t.settings.renderAllRows,rowHeaders:function(){var i=[];return n.hasRowHeaders()&&i.push(function(n,i){t.appendRowHeader(n,i)}),n.runHooks("afterGetRowHeaderRenderers",i),i},columnHeaders:function(){var i=[];return n.hasColHeaders()&&i.push(function(n,i){t.appendColHeader(n,i)}),n.runHooks("afterGetColumnHeaderRenderers",i),i},columnWidth:n.getColWidth,rowHeight:n.getRowHeight,cellRenderer:function(n,i,r){var u=t.instance.getCellMeta(n,i),e=t.instance.colToProp(i),f=t.instance.getDataAtRowProp(n,e);t.instance.hasHook("beforeValueRender")&&(f=t.instance.runHooks("beforeValueRender",f,u));t.instance.runHooks("beforeRenderer",r,n,i,e,f,u);t.instance.getCellRenderer(u)(t.instance,r,n,i,e,f,u);t.instance.runHooks("afterRenderer",r,n,i,e,f,u)},selections:t.instance.selection.highlight,hideBorderOnMouseDownOver:function(){return t.settings.fragmentSelection},onCellMouseDown:function(i,r,o,s){var l={row:!1,column:!1,cells:!1},v,k,d,g,nt,w,b;if(n.listen(),t.activeWt=s,u=!0,n.runHooks("beforeOnCellMouseDown",i,r,o,l),!e.isImmediatePropagationStopped(i)){var a=n.getSelectedRangeLast(),h=n.selection,c=h.selectedHeader;if(i.shiftKey&&a)r.row>=0&&r.col>=0&&!l.cells?(h.setSelectedHeaders(!1,!1),h.setRangeEnd(r)):(c.cols||c.rows)&&r.row>=0&&r.col>=0&&!l.cells?(h.setSelectedHeaders(!1,!1),h.setRangeEnd(new f.CellCoords(r.row,r.col))):c.cols&&r.row<0&&!l.column?h.setRangeEnd(new f.CellCoords(a.to.row,r.col)):c.rows&&r.col<0&&!l.row?h.setRangeEnd(new f.CellCoords(r.row,a.to.col)):(!c.cols&&!c.rows&&r.col<0||c.cols&&r.col<0)&&!l.row?(h.setSelectedHeaders(!0,!1),h.selectRows(a.from.row,r.row)):(!c.cols&&!c.rows&&r.row<0||c.rows&&r.row<0)&&!l.column&&(h.setSelectedHeaders(!1,!0),h.selectColumns(a.from.col,r.col));else{if(v=!0,a){var y=a.from,p=a.to,tt=!h.inInSelection(r);r.row<0&&c.cols?(k=Math.min(y.col,p.col),d=Math.max(y.col,p.col),v=r.col<k||r.col>d):r.col<0&&c.rows?(g=Math.min(y.row,p.row),nt=Math.max(y.row,p.row),v=r.row<g||r.row>nt):v=tt}w=e.isRightClick(i);b=e.isLeftClick(i)||i.type==="touchstart";r.row<0&&r.col>=0&&!l.column?(h.setSelectedHeaders(!1,!0),(b||w&&v)&&(h.setRangeStartOnly(new f.CellCoords(0,r.col)),h.setRangeEnd(new f.CellCoords(Math.max(n.countRows()-1,0),r.col)))):r.col<0&&r.row>=0&&!l.row?(h.setSelectedHeaders(!0,!1),(b||w&&v)&&(h.setRangeStartOnly(new f.CellCoords(r.row,0)),h.setRangeEnd(new f.CellCoords(r.row,Math.max(n.countCols()-1,0))))):r.col>=0&&r.row>=0&&!l.cells?(b||w&&v)&&(h.setSelectedHeaders(!1,!1),h.setRangeStart(r)):r.col<0&&r.row<0&&(r.row=0,r.col=0,h.setSelectedHeaders(!1,!1,!0),h.setRangeStart(r))}n.runHooks("afterOnCellMouseDown",i,r,o);t.activeWt=t.wt}},onCellMouseOut:function(i,r,u,f){(t.activeWt=f,n.runHooks("beforeOnCellMouseOut",i,r,u),e.isImmediatePropagationStopped(i))||(n.runHooks("afterOnCellMouseOut",i,r,u),t.activeWt=t.wt)},onCellMouseOver:function(i,r,o,s){var h={row:!1,column:!1,cell:!1};(t.activeWt=s,n.runHooks("beforeOnCellMouseOver",i,r,o,h),e.isImmediatePropagationStopped(i))||(e.isLeftClick(i)&&u&&(r.row>=0&&r.col>=0?n.selection.selectedHeader.cols&&!h.column?n.selection.setRangeEnd(new f.CellCoords(n.countRows()-1,r.col)):n.selection.selectedHeader.rows&&!h.row?n.selection.setRangeEnd(new f.CellCoords(r.row,n.countCols()-1)):h.cell||n.selection.setRangeEnd(r):n.selection.selectedHeader.cols&&!h.column?n.selection.setRangeEnd(new f.CellCoords(n.countRows()-1,r.col)):n.selection.selectedHeader.rows&&!h.row?n.selection.setRangeEnd(new f.CellCoords(r.row,n.countCols()-1)):h.cell||n.selection.setRangeEnd(r)),n.runHooks("afterOnCellMouseOver",i,r,o),t.activeWt=t.wt)},onCellMouseUp:function(i,r,u,f){t.activeWt=f;n.runHooks("beforeOnCellMouseUp",i,r,u);n.runHooks("afterOnCellMouseUp",i,r,u);t.activeWt=t.wt},onCellCornerMouseDown:function(t){t.preventDefault();n.runHooks("afterOnCellCornerMouseDown",t)},onCellCornerDblClick:function(t){t.preventDefault();n.runHooks("afterOnCellCornerDblClick",t)},beforeDraw:function(n,i){t.beforeRender(n,i)},onDraw:function(n){t.onDraw(n)},onScrollVertically:function(){n.runHooks("afterScrollVertically")},onScrollHorizontally:function(){n.runHooks("afterScrollHorizontally")},onBeforeDrawBorders:function(t,i){n.runHooks("beforeDrawBorders",t,i)},onBeforeTouchScroll:function(){n.runHooks("beforeTouchScroll")},onAfterMomentumScroll:function(){n.runHooks("afterMomentumScroll")},onBeforeStretchingColumnWidth:function(t,i){return n.runHooks("beforeStretchingColumnWidth",t,i)},onModifyRowHeaderWidth:function(t){return n.runHooks("modifyRowHeaderWidth",t)},onModifyGetCellCoords:function(t,i,r){return n.runHooks("modifyGetCellCoords",t,i,r)},viewportRowCalculatorOverride:function(i){var u=n.countRows(),r=t.settings.viewportRowRenderingOffset,e,f;r==="auto"&&t.settings.fixedRowsTop&&(r=10);typeof r=="number"&&(i.startRow=Math.max(i.startRow-r,0),i.endRow=Math.min(i.endRow+r,u-1));r==="auto"&&(e=i.startRow+i.endRow-i.startRow,f=Math.ceil(e/u*12),i.startRow=Math.max(i.startRow-f,0),i.endRow=Math.min(i.endRow+f,u-1));n.runHooks("afterViewportRowCalculatorOverride",i)},viewportColumnCalculatorOverride:function(i){var u=n.countCols(),r=t.settings.viewportColumnRenderingOffset,e,f;r==="auto"&&t.settings.fixedColumnsLeft&&(r=10);typeof r=="number"&&(i.startColumn=Math.max(i.startColumn-r,0),i.endColumn=Math.min(i.endColumn+r,u-1));r==="auto"&&(e=i.startColumn+i.endColumn-i.startColumn,f=Math.ceil(e/u*12),i.startRow=Math.max(i.startColumn-f,0),i.endColumn=Math.min(i.endColumn+f,u-1));n.runHooks("afterViewportColumnCalculatorOverride",i)},rowHeaderWidth:function(){return t.settings.rowHeaderWidth},columnHeaderHeight:function(){var i=n.runHooks("modifyColumnHeaderHeight");return t.settings.columnHeaderHeight||i}};n.runHooks("beforeInitWalkontable",c);this.wt=new a.default(c);this.activeWt=this.wt;o.isChrome()||o.isSafari()||this.eventManager.addEventListener(n.rootElement,"wheel",function(n){var e=parseInt(r.getComputedStyle(document.body)["font-size"],10),i=t.wt.wtOverlays.scrollableElement,u,f;i!==window&&n.preventDefault();u=-1*n.wheelDeltaY||n.deltaY;f=-1*n.wheelDeltaX||n.deltaX;switch(n.deltaMode){case 0:i.scrollLeft+=f;i.scrollTop+=u;break;case 1:i.scrollLeft+=f*e;i.scrollTop+=u*e}});this.eventManager.addEventListener(t.wt.wtTable.spreader,"mousedown",function(n){n.target===t.wt.wtTable.spreader&&n.which===3&&e.stopPropagation(n)});this.eventManager.addEventListener(t.wt.wtTable.spreader,"contextmenu",function(n){n.target===t.wt.wtTable.spreader&&n.which===3&&e.stopPropagation(n)});this.eventManager.addEventListener(document.documentElement,"click",function(){t.settings.observeDOMVisibility&&t.wt.drawInterrupted&&(t.instance.forceFullRender=!0,t.render())})}t.__esModule=!0;var h=function(){function n(n,t){var r=[],u=!0,f=!1,e=undefined,i,o;try{for(i=n[Symbol.iterator]();!(u=(o=i.next()).done);u=!0)if(r.push(o.value),t&&r.length===t)break}catch(s){f=!0;e=s}finally{try{!u&&i["return"]&&i["return"]()}finally{if(f)throw e;}}return r}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return n(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance");}}(),r=i(2),o=i(33),c=i(9),l=s(c),e=i(11),f=i(8),a=s(f);u.prototype.isTextSelectionAllowed=function(n){if(r.isInput(n))return!0;var t=r.isChildOf(n,this.instance.view.wt.wtTable.spreader);return this.settings.fragmentSelection===!0&&t?!0:this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&t?!0:!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell()?!0:!1};u.prototype.isSelectedOnlyCell=function(){var i=this.instance.getSelectedLast()||[],n=h(i,4),t=n[0],r=n[1],u=n[2],f=n[3];return t!==void 0&&t===u&&r===f};u.prototype.isCellEdited=function(){var n=this.instance.getActiveEditor();return n&&n.isOpened()};u.prototype.beforeRender=function(n,t){n&&this.instance.runHooks("beforeRender",this.instance.forceFullRender,t)};u.prototype.onDraw=function(n){n&&this.instance.runHooks("afterRender",this.instance.forceFullRender)};u.prototype.render=function(){this.wt.draw(!this.instance.forceFullRender);this.instance.forceFullRender=!1;this.instance.renderCall=!1};u.prototype.getCellAtCoords=function(n,t){var i=this.wt.getCell(n,t);return i<0?null:i};u.prototype.scrollViewport=function(n){this.wt.scrollViewport(n)};u.prototype.appendRowHeader=function(n,t){var f,i,u;if(t.firstChild){if(f=t.firstChild,!r.hasClass(f,"relative")){r.empty(t);this.appendRowHeader(n,t);return}this.updateCellHeader(f.querySelector(".rowHeader"),n,this.instance.getRowHeader)}else i=document.createElement("div"),u=document.createElement("span"),i.className="relative",u.className="rowHeader",this.updateCellHeader(u,n,this.instance.getRowHeader),i.appendChild(u),t.appendChild(i);this.instance.runHooks("afterGetRowHeader",n,t)};u.prototype.appendColHeader=function(n,t){var f,i,u;t.firstChild?(f=t.firstChild,r.hasClass(f,"relative")?this.updateCellHeader(f.querySelector(".colHeader"),n,this.instance.getColHeader):(r.empty(t),this.appendColHeader(n,t))):(i=document.createElement("div"),u=document.createElement("span"),i.className="relative",u.className="colHeader",this.updateCellHeader(u,n,this.instance.getColHeader),i.appendChild(u),t.appendChild(i));this.instance.runHooks("afterGetColHeader",n,t)};u.prototype.updateCellHeader=function(n,t,i){var u=t,f=this.wt.wtOverlays.getParentOverlay(n)||this.wt;n.parentNode&&(r.hasClass(n,"colHeader")?u=f.wtTable.columnFilter.sourceToRendered(t):r.hasClass(n,"rowHeader")&&(u=f.wtTable.rowFilter.sourceToRendered(t)));u>-1?r.fastInnerHTML(n,i(t)):(r.fastInnerText(n,String.fromCharCode(160)),r.addClass(n,"cornerHeader"))};u.prototype.maximumVisibleElementWidth=function(n){var i=this.wt.wtViewport.getWorkspaceWidth(),t=i-n;return t>0?t:0};u.prototype.maximumVisibleElementHeight=function(n){var i=this.wt.wtViewport.getWorkspaceHeight(),t=i-n;return t>0?t:0};u.prototype.mainViewIsActive=function(){return this.wt===this.activeWt};u.prototype.destroy=function(){this.wt.destroy();this.eventManager.destroy()};t.default=u},function(n,t,i){"use strict";function s(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var f;t.__esModule=!0;var e=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),r=i(1),o=i(0),u=i(4);f=function(){function n(t){var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];s(this,n);this.hot=t;this.data=i;this.dataType="array";this.colToProp=function(){};this.propToCol=function(){}}return e(n,[{key:"getData",value:function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:!1,n=this.data;return t&&(n=this.getByRange({row:0,col:0},{row:Math.max(this.countRows()-1,0),col:Math.max(this.countColumns()-1,0)},!0)),n}},{key:"setData",value:function(n){this.data=n}},{key:"getAtColumn",value:function(n){var i=this,t=[];return o.arrayEach(this.data,function(u){var f=i.colToProp(n);u=typeof f=="string"?r.getProperty(u,f):u[f];t.push(u)}),t}},{key:"getAtRow",value:function(n){return this.data[n]}},{key:"getAtCell",value:function(n,t){var f=null,e=this.hot.runHooks("modifyRowData",n),u=isNaN(e)?e:this.data[n],i;return u&&(i=this.colToProp(t),f=typeof i=="string"?r.getProperty(u,i):typeof i=="function"?i(this.data.slice(n,n+1)[0]):u[i]),f}},{key:"getByRange",value:function(n,t){var i=this,r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:!1,s=Math.min(n.row,t.row),f=Math.min(n.col,t.col),h=Math.max(n.row,t.row),e=Math.max(n.col,t.col),o=[];return u.rangeEach(s,h,function(n){var s=i.getAtRow(n),t=void 0;i.dataType==="array"?t=s.slice(f,e+1):i.dataType==="object"&&(t=r?[]:{},u.rangeEach(f,e,function(n){var u=i.colToProp(n);r?t.push(s[u]):t[u]=s[u]}));o.push(t)}),o}},{key:"countRows",value:function(){return Array.isArray(this.data)?this.data.length:0}},{key:"countColumns",value:function(){var n=0;return Array.isArray(this.data)&&(this.dataType==="array"?n=this.data[0].length:this.dataType==="object"&&(n=Object.keys(this.data[0]).length)),n}},{key:"destroy",value:function(){this.data=null;this.hot=null}}]),n}();t.default=f},function(n,t,i){"use strict";function s(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function f(n,t,i){return t in n?Object.defineProperty(n,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[t]=i,n}var r,e,u,o;t.__esModule=!0;e=i(3);u=s(e);
/**
                                                                                                                                                                                                                   * @preserve
                                                                                                                                                                                                                   * Authors: Handsoncode
                                                                                                                                                                                                                   * Last updated: Nov 15, 2017
                                                                                                                                                                                                                   *
                                                                                                                                                                                                                   * Description: Definition file for English - United States language-country.
                                                                                                                                                                                                                   */
o=(r={languageCode:"en-US"},f(r,u.CONTEXTMENU_ITEMS_ROW_ABOVE,"Insert row above"),f(r,u.CONTEXTMENU_ITEMS_ROW_BELOW,"Insert row below"),f(r,u.CONTEXTMENU_ITEMS_INSERT_LEFT,"Insert column left"),f(r,u.CONTEXTMENU_ITEMS_INSERT_RIGHT,"Insert column right"),f(r,u.CONTEXTMENU_ITEMS_REMOVE_ROW,["Remove row","Remove rows"]),f(r,u.CONTEXTMENU_ITEMS_REMOVE_COLUMN,["Remove column","Remove columns"]),f(r,u.CONTEXTMENU_ITEMS_UNDO,"Undo"),f(r,u.CONTEXTMENU_ITEMS_REDO,"Redo"),f(r,u.CONTEXTMENU_ITEMS_READ_ONLY,"Read only"),f(r,u.CONTEXTMENU_ITEMS_CLEAR_COLUMN,"Clear column"),f(r,u.CONTEXTMENU_ITEMS_ALIGNMENT,"Alignment"),f(r,u.CONTEXTMENU_ITEMS_ALIGNMENT_LEFT,"Left"),f(r,u.CONTEXTMENU_ITEMS_ALIGNMENT_CENTER,"Center"),f(r,u.CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT,"Right"),f(r,u.CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY,"Justify"),f(r,u.CONTEXTMENU_ITEMS_ALIGNMENT_TOP,"Top"),f(r,u.CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE,"Middle"),f(r,u.CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM,"Bottom"),f(r,u.CONTEXTMENU_ITEMS_FREEZE_COLUMN,"Freeze column"),f(r,u.CONTEXTMENU_ITEMS_UNFREEZE_COLUMN,"Unfreeze column"),f(r,u.CONTEXTMENU_ITEMS_BORDERS,"Borders"),f(r,u.CONTEXTMENU_ITEMS_BORDERS_TOP,"Top"),f(r,u.CONTEXTMENU_ITEMS_BORDERS_RIGHT,"Right"),f(r,u.CONTEXTMENU_ITEMS_BORDERS_BOTTOM,"Bottom"),f(r,u.CONTEXTMENU_ITEMS_BORDERS_LEFT,"Left"),f(r,u.CONTEXTMENU_ITEMS_REMOVE_BORDERS,"Remove border(s)"),f(r,u.CONTEXTMENU_ITEMS_ADD_COMMENT,"Add comment"),f(r,u.CONTEXTMENU_ITEMS_EDIT_COMMENT,"Edit comment"),f(r,u.CONTEXTMENU_ITEMS_REMOVE_COMMENT,"Delete comment"),f(r,u.CONTEXTMENU_ITEMS_READ_ONLY_COMMENT,"Read-only comment"),f(r,u.CONTEXTMENU_ITEMS_MERGE_CELLS,"Merge cells"),f(r,u.CONTEXTMENU_ITEMS_UNMERGE_CELLS,"Unmerge cells"),f(r,u.CONTEXTMENU_ITEMS_COPY,"Copy"),f(r,u.CONTEXTMENU_ITEMS_CUT,"Cut"),f(r,u.CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD,"Insert child row"),f(r,u.CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD,"Detach from parent"),f(r,u.CONTEXTMENU_ITEMS_HIDE_COLUMN,["Hide column","Hide columns"]),f(r,u.CONTEXTMENU_ITEMS_SHOW_COLUMN,["Show column","Show columns"]),f(r,u.CONTEXTMENU_ITEMS_HIDE_ROW,["Hide row","Hide rows"]),f(r,u.CONTEXTMENU_ITEMS_SHOW_ROW,["Show row","Show rows"]),f(r,u.FILTERS_CONDITIONS_NONE,"None"),f(r,u.FILTERS_CONDITIONS_EMPTY,"Is empty"),f(r,u.FILTERS_CONDITIONS_NOT_EMPTY,"Is not empty"),f(r,u.FILTERS_CONDITIONS_EQUAL,"Is equal to"),f(r,u.FILTERS_CONDITIONS_NOT_EQUAL,"Is not equal to"),f(r,u.FILTERS_CONDITIONS_BEGINS_WITH,"Begins with"),f(r,u.FILTERS_CONDITIONS_ENDS_WITH,"Ends with"),f(r,u.FILTERS_CONDITIONS_CONTAINS,"Contains"),f(r,u.FILTERS_CONDITIONS_NOT_CONTAIN,"Does not contain"),f(r,u.FILTERS_CONDITIONS_GREATER_THAN,"Greater than"),f(r,u.FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL,"Greater than or equal to"),f(r,u.FILTERS_CONDITIONS_LESS_THAN,"Less than"),f(r,u.FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL,"Less than or equal to"),f(r,u.FILTERS_CONDITIONS_BETWEEN,"Is between"),f(r,u.FILTERS_CONDITIONS_NOT_BETWEEN,"Is not between"),f(r,u.FILTERS_CONDITIONS_AFTER,"After"),f(r,u.FILTERS_CONDITIONS_BEFORE,"Before"),f(r,u.FILTERS_CONDITIONS_TODAY,"Today"),f(r,u.FILTERS_CONDITIONS_TOMORROW,"Tomorrow"),f(r,u.FILTERS_CONDITIONS_YESTERDAY,"Yesterday"),f(r,u.FILTERS_VALUES_BLANK_CELLS,"Blank cells"),f(r,u.FILTERS_DIVS_FILTER_BY_CONDITION,"Filter by condition"),f(r,u.FILTERS_DIVS_FILTER_BY_VALUE,"Filter by value"),f(r,u.FILTERS_LABELS_CONJUNCTION,"And"),f(r,u.FILTERS_LABELS_DISJUNCTION,"Or"),f(r,u.FILTERS_BUTTONS_SELECT_ALL,"Select all"),f(r,u.FILTERS_BUTTONS_CLEAR,"Clear"),f(r,u.FILTERS_BUTTONS_OK,"OK"),f(r,u.FILTERS_BUTTONS_CANCEL,"Cancel"),f(r,u.FILTERS_BUTTONS_PLACEHOLDER_SEARCH,"Search"),f(r,u.FILTERS_BUTTONS_PLACEHOLDER_VALUE,"Value"),f(r,u.FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE,"Second value"),r);t.default=o},function(n,t,i){"use strict";function u(n){return n&&n.__esModule?n:{"default":n}}function r(n,t){l(n,t)}function e(){return a()}t.__esModule=!0;t.getPhraseFormatters=t.registerPhraseFormatter=undefined;t.register=r;t.getAll=e;var o=i(48),s=u(o),h=i(545),c=u(h);var f=s.default("phraseFormatters"),l=f.register,a=f.getValues;t.registerPhraseFormatter=r;t.getPhraseFormatters=e;r("pluralize",c.default)},function(n,t){"use strict";function i(n,t){var i=Array.isArray(n)&&Number.isInteger(t);return i?n[t]:n}t.__esModule=!0;t.default=i},function(n,t,i){"use strict";function r(n){return n&&n.__esModule?n:{"default":n}}t.__esModule=!0;t.Selection=t.Highlight=undefined;var u=i(454),f=r(u),e=i(552),o=r(e);t.Highlight=f.default;t.Selection=o.default},function(n,t,i){"use strict";function r(n){return n&&n.__esModule?n:{"default":n}}function b(n,t){return w(n)(t)}t.__esModule=!0;t.createHighlight=undefined;var e=i(48),o=r(e),s=i(548),h=r(s),c=i(549),l=r(c),a=i(550),v=r(a),y=i(551),p=r(y);var u=o.default("highlight/types"),f=u.register,w=u.getItem,k=u.hasItem,d=u.getNames,g=u.getValues;f("area",h.default);f("cell",l.default);f("fill",v.default);f("header",p.default);t.createHighlight=b},function(n,t,i){"use strict";function u(n){var t=n.layerLevel,f=n.cornerVisible,i=n.multipleSelectionHandlesVisible,u=n.areaCornerVisible;return new r.Selection({className:"area",markIntersections:!0,layerLevel:Math.min(t,7),border:{width:1,color:"#4b89ff",cornerVisible:u,multipleSelectionHandlesVisible:i}})}t.__esModule=!0;var r=i(8);t.default=u},function(n,t,i){"use strict";function u(n){var u=n.cornerVisible,t=n.multipleSelectionHandlesVisible,i=n.cellCornerVisible;return new r.Selection({className:"current",border:{width:2,color:"#4b89ff",cornerVisible:i,multipleSelectionHandlesVisible:t}})}t.__esModule=!0;var r=i(8);t.default=u},function(n,t,i){"use strict";function u(){return new r.Selection({className:"fill",border:{width:1,color:"#ff0000"}})}t.__esModule=!0;var r=i(8);t.default=u},function(n,t,i){"use strict";function u(n){var t=n.headerClassName,i=n.rowClassName,u=n.columnClassName;return new r.Selection({className:"highlight",highlightHeaderClassName:t,highlightRowClassName:i,highlightColumnClassName:u})}t.__esModule=!0;var r=i(8);t.default=u},function(n,t,i){"use strict";function o(n){return n&&n.__esModule?n:{"default":n}}function it(n,t){return Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(t)}}))}function rt(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var h;t.__esModule=!0;var c=function(){function n(n,t){var r=[],u=!0,f=!1,e=undefined,i,o;try{for(i=n[Symbol.iterator]();!(u=(o=i.next()).done);u=!0)if(r.push(o.value),t&&r.length===t)break}catch(s){f=!0;e=s}finally{try{!u&&i["return"]&&i["return"]()}finally{if(f)throw e;}}return r}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return n(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance");}}(),v=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),y=it(["Unsupported format of the selection ranges was passed. To select cells pass \n        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd, columnEnd/columnPropEnd]]) \n        or as an array of CellRange objects."],["Unsupported format of the selection ranges was passed. To select cells pass\\x20\n        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd, columnEnd/columnPropEnd]])\\x20\n        or as an array of CellRange objects."]),f=i(454),p=o(f),w=i(553),b=o(w),u=i(8),l=i(453),a=i(1),e=i(13),s=i(0),k=i(21),d=o(k),g=i(554),nt=o(g),r=i(154),tt=i(34);h=function(){function n(t,i){var r=this;rt(this,n);this.settings=t;this.tableProps=i;this.inProgress=!1;this.selectedHeader={cols:!1,rows:!1,corner:!1};this.selectedRange=new b.default;this.highlight=new p.default({headerClassName:t.currentHeaderClassName,rowClassName:t.currentRowClassName,columnClassName:t.currentColClassName,disableHighlight:this.settings.disableVisualSelection,cellCornerVisible:function(){return r.isCellCornerVisible.apply(r,arguments)},areaCornerVisible:function(){return r.isAreaCornerVisible.apply(r,arguments)}});this.transformation=new nt.default(this.selectedRange,{countRows:function(){return r.tableProps.countRows()},countCols:function(){return r.tableProps.countCols()},fixedRowsBottom:function(){return t.fixedRowsBottom},minSpareRows:function(){return t.minSpareRows},minSpareCols:function(){return t.minSpareCols},autoWrapRow:function(){return t.autoWrapRow},autoWrapCol:function(){return t.autoWrapCol}});this.transformation.addLocalHook("beforeTransformStart",function(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];return r.runLocalHooks.apply(r,["beforeModifyTransformStart"].concat(i))});this.transformation.addLocalHook("afterTransformStart",function(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];return r.runLocalHooks.apply(r,["afterModifyTransformStart"].concat(i))});this.transformation.addLocalHook("beforeTransformEnd",function(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];return r.runLocalHooks.apply(r,["beforeModifyTransformEnd"].concat(i))});this.transformation.addLocalHook("afterTransformEnd",function(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];return r.runLocalHooks.apply(r,["afterModifyTransformEnd"].concat(i))});this.transformation.addLocalHook("insertRowRequire",function(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];return r.runLocalHooks.apply(r,["insertRowRequire"].concat(i))});this.transformation.addLocalHook("insertColRequire",function(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];return r.runLocalHooks.apply(r,["insertColRequire"].concat(i))})}return v(n,[{key:"getSelectedRange",value:function(){return this.selectedRange}},{key:"setSelectedHeaders",value:function(){var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:!1,t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!1,i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:!1;this.selectedHeader.rows=n;this.selectedHeader.cols=t;this.selectedHeader.corner=i}},{key:"begin",value:function(){this.inProgress=!0}},{key:"finish",value:function(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange));this.inProgress=!1}},{key:"isInProgress",value:function(){return this.inProgress}},{key:"setRangeStart",value:function(n,t){var i=this.settings.selectionMode==="multiple",r=e.isUndefined(t)?l.isPressedCtrlKey():t;this.runLocalHooks("beforeSetRangeStart",n);(!i||i&&!r&&e.isUndefined(t))&&this.selectedRange.clear();this.selectedRange.add(n);this.setRangeEnd(n)}},{key:"setRangeStartOnly",value:function(n,t){var i=this.settings.selectionMode==="multiple",r=e.isUndefined(t)?l.isPressedCtrlKey():t;this.runLocalHooks("beforeSetRangeStartOnly",n);(!i||i&&!r&&e.isUndefined(t))&&this.selectedRange.clear();this.selectedRange.add(n)}},{key:"setRangeEnd",value:function(n){var t,i,e,r;this.selectedRange.isEmpty()||(this.runLocalHooks("beforeSetRangeEnd",n),this.begin(),t=this.selectedRange.current(),this.settings.selectionMode!=="single"&&t.setTo(new u.CellCoords(n.row,n.col)),this.highlight.getCell().clear(),this.highlight.isEnabledFor(f.CELL_TYPE)&&this.highlight.getCell().add(this.selectedRange.current().highlight),i=this.selectedRange.size()-1,i<this.highlight.layerLevel&&(s.arrayEach(this.highlight.getAreas(),function(n){n.clear()}),s.arrayEach(this.highlight.getHeaders(),function(n){n.clear()})),this.highlight.useLayerLevel(i),e=this.highlight.createOrGetArea(),r=this.highlight.createOrGetHeader(),e.clear(),r.clear(),this.highlight.isEnabledFor(f.AREA_TYPE)&&(this.isMultiple()||i>=1)&&(e.add(t.from).add(t.to),i===1&&(this.highlight.useLayerLevel(i-1).createOrGetArea().add(this.selectedRange.previous().from),this.highlight.useLayerLevel(i))),this.highlight.isEnabledFor(f.HEADER_TYPE)&&(this.settings.selectionMode==="single"?r.add(t.highlight):r.add(t.from).add(t.to)),this.runLocalHooks("afterSetRangeEnd",n))}},{key:"isMultiple",value:function(){var n=a.createObjectPropListener(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",n),n.value}},{key:"transformStart",value:function(n,t,i){var r=this.transformation.transformStart(n,t,i);this.setRangeStart(r)}},{key:"transformEnd",value:function(n,t){var i=this.transformation.transformEnd(n,t);this.setRangeEnd(i)}},{key:"isSelected",value:function(){return!this.selectedRange.isEmpty()}},{key:"inInSelection",value:function(n){return this.selectedRange.includes(n)}},{key:"isCellCornerVisible",value:function(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}},{key:"isAreaCornerVisible",value:function(n){return n!==this.selectedRange.ranges.length-1?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}},{key:"clear",value:function(){this.selectedRange.clear();this.highlight.clear()}},{key:"deselect",value:function(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}},{key:"selectAll",value:function(){this.settings.selectionMode!=="single"&&(this.clear(),this.setSelectedHeaders(!0,!0,!0),this.setRangeStart(new u.CellCoords(0,0)),this.setRangeEnd(new u.CellCoords(this.tableProps.countRows()-1,this.tableProps.countCols()-1)))}},{key:"selectCells",value:function(n){var t=this,i=r.detectSelectionType(n);if(i===r.SELECTION_TYPE_EMPTY)return!1;if(i===r.SELECTION_TYPE_UNRECOGNIZED)throw new Error(tt.toSingleLine(y));var f=r.normalizeSelectionFactory(i,{propToCol:function(n){return t.tableProps.propToCol(n)},keepDirection:!0}),e=this.tableProps.countRows(),o=this.tableProps.countCols(),h=!n.some(function(n){var i=f(n),t=c(i,4),u=t[0],s=t[1],h=t[2],l=t[3],a=r.isValidCoord(u,e)&&r.isValidCoord(s,o)&&r.isValidCoord(h,e)&&r.isValidCoord(l,o);return!a});return h&&(this.clear(),s.arrayEach(n,function(n){var r=f(n),i=c(r,4),e=i[0],o=i[1],s=i[2],h=i[3];t.setRangeStartOnly(new u.CellCoords(e,o),!1);t.setRangeEnd(new u.CellCoords(s,h));t.finish()})),h}},{key:"selectColumns",value:function(n){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:n,i,f;return n=typeof n=="string"?this.tableProps.propToCol(n):n,t=typeof t=="string"?this.tableProps.propToCol(t):t,i=this.tableProps.countCols(),f=r.isValidCoord(n,i)&&r.isValidCoord(t,i),f&&(this.clear(),this.setSelectedHeaders(!1,!0,!1),this.setRangeStartOnly(new u.CellCoords(0,n)),this.setRangeEnd(new u.CellCoords(this.tableProps.countRows()-1,t)),this.finish()),f}},{key:"selectRows",value:function(n){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:n,i=this.tableProps.countRows(),f=r.isValidCoord(n,i)&&r.isValidCoord(t,i);return f&&(this.clear(),this.setSelectedHeaders(!0,!1,!1),this.setRangeStartOnly(new u.CellCoords(n,0)),this.setRangeEnd(new u.CellCoords(t,this.tableProps.countCols()-1)),this.finish()),f}}]),n}();a.mixin(h,d.default);t.default=h},function(n,t,i){"use strict";function e(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var u,r,f;t.__esModule=!0;u=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}();r=i(8);f=function(){function n(){e(this,n);this.ranges=[]}return u(n,[{key:"isEmpty",value:function(){return this.size()===0}},{key:"set",value:function(n){return this.clear(),this.ranges.push(new r.CellRange(n)),this}},{key:"add",value:function(n){return this.ranges.push(new r.CellRange(n)),this}},{key:"current",value:function(){return this.peekByIndex(0)}},{key:"previous",value:function(){return this.peekByIndex(-1)}},{key:"includes",value:function(n){return this.ranges.some(function(t){return t.includes(n)})}},{key:"clear",value:function(){return this.ranges.length=0,this}},{key:"size",value:function(){return this.ranges.length}},{key:"peekByIndex",value:function(){var i=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0,n=this.size()+i-1,t=void 0;return n>=0&&(t=this.ranges[n]),t}},{key:Symbol.iterator,value:function(){return this.ranges[Symbol.iterator]()}}]),n}();t.default=f},function(n,t,i){"use strict";function h(n){return n&&n.__esModule?n:{"default":n}}function c(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var u;t.__esModule=!0;var f=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),r=i(8),e=i(1),o=i(21),s=h(o);u=function(){function n(t,i){c(this,n);this.range=t;this.options=i}return f(n,[{key:"transformStart",value:function(n,t,i){var u=new r.CellCoords(n,t);this.runLocalHooks("beforeTransformStart",u);var e=this.options.countRows(),s=this.options.countCols(),l=this.options.fixedRowsBottom(),y=this.options.minSpareRows(),p=this.options.minSpareCols(),a=this.options.autoWrapRow(),v=this.options.autoWrapCol(),f=this.range.current().highlight;f.row+n>e-1?i&&y>0&&!(l&&f.row>=e-l-1)?(this.runLocalHooks("insertRowRequire",e),e=this.options.countRows()):v&&(u.row=1-e,u.col=f.col+u.col==s-1?1-s:1):v&&f.row+u.row<0&&f.col+u.col>=0&&(u.row=e-1,u.col=f.col+u.col==0?s-1:-1);f.col+u.col>s-1?i&&p>0?(this.runLocalHooks("insertColRequire",e),s=this.options.countCols()):a&&(u.row=f.row+u.row==e-1?1-e:1,u.col=1-s):a&&f.col+u.col<0&&f.row+u.row>=0&&(u.row=f.row+u.row==0?e-1:-1,u.col=s-1);var o=new r.CellCoords(f.row+u.row,f.col+u.col),h=0,c=0;return o.row<0?(h=-1,o.row=0):o.row>0&&o.row>=e&&(h=1,o.row=e-1),o.col<0?(c=-1,o.col=0):o.col>0&&o.col>=s&&(c=1,o.col=s-1),this.runLocalHooks("afterTransformStart",o,h,c),o}},{key:"transformEnd",value:function(n,t){var u=new r.CellCoords(n,t);this.runLocalHooks("beforeTransformEnd",u);var o=this.options.countRows(),s=this.options.countCols(),h=this.range.current(),i=new r.CellCoords(h.to.row+u.row,h.to.col+u.col),f=0,e=0;return i.row<0?(f=-1,i.row=0):i.row>0&&i.row>=o&&(f=1,i.row=o-1),i.col<0?(e=-1,i.col=0):i.col>0&&i.col>=s&&(e=1,i.col=s-1),this.runLocalHooks("afterTransformEnd",i,f,e),i}}]),n}();e.mixin(u,s.default);t.default=u},function(n,t){"use strict";function i(n){var t=typeof window=="undefined"?!1:window.jQuery;t&&(t.fn.handsontable=function(t){var r=this.first(),i=r.data("handsontable"),f,e,o,u,s;if(typeof t!="string")return f=t||{},i?i.updateSettings(f):(i=new n.Core(r[0],f),r.data("handsontable",i),i.init()),r;if(e=[],o=void 0,arguments.length>1)for(u=1,s=arguments.length;u<s;u++)e.push(arguments[u]);if(i)if(typeof i[t]!="undefined")o=i[t].apply(i,e),t==="destroy"&&r.removeData();else throw new Error("Handsontable do not provide action: "+t);return o})}t.__esModule=!0;t.default=i},function(n,t,i){"use strict";function r(n){return n&&n.__esModule?n:{"default":n}}t.__esModule=!0;t.Base=t.UndoRedo=t.TouchScroll=t.Search=t.PersistentState=t.ObserveChanges=t.MultipleSelectionHandles=t.MergeCells=t.ManualRowResize=t.ManualRowMove=t.ManualColumnResize=t.ManualColumnMove=t.ManualColumnFreeze=t.DragToScroll=t.CustomBorders=t.CopyPaste=t.ContextMenu=t.Comments=t.ColumnSorting=t.AutoRowSize=t.AutoFill=t.AutoColumnSize=undefined;var u=i(557),f=r(u),e=i(559),o=r(e),s=i(560),h=r(s),c=i(562),l=r(c),a=i(563),v=r(a),y=i(566),p=r(y),w=i(570),b=r(w),k=i(584),d=r(k),g=i(591),nt=r(g),tt=i(592),it=r(tt),rt=i(593),ut=r(rt),ft=i(597),et=r(ft),ot=i(602),st=r(ot),ht=i(603),ct=r(ht),lt=i(608),at=r(lt),vt=i(609),yt=r(vt),pt=i(615),wt=r(pt),bt=i(616),kt=r(bt),dt=i(619),gt=r(dt),ni=i(620),ti=r(ni),ii=i(621),ri=r(ii),ui=i(7),fi=r(ui);t.AutoColumnSize=o.default;t.AutoFill=h.default;t.AutoRowSize=l.default;t.ColumnSorting=v.default;t.Comments=p.default;t.ContextMenu=b.default;t.CopyPaste=d.default;t.CustomBorders=nt.default;t.DragToScroll=it.default;t.ManualColumnFreeze=ut.default;t.ManualColumnMove=et.default;t.ManualColumnResize=st.default;t.ManualRowMove=ct.default;t.ManualRowResize=at.default;t.MergeCells=yt.default;t.MultipleSelectionHandles=wt.default;t.ObserveChanges=kt.default;t.PersistentState=f.default;t.Search=gt.default;t.TouchScroll=ti.default;t.UndoRedo=ri.default;t.Base=fi.default},function(n,t,i){"use strict";function f(n){return n&&n.__esModule?n:{"default":n}}function p(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function w(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function b(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var e;t.__esModule=!0;var o=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),r=function s(n,t,i){var r,u,f;return n===null&&(n=Function.prototype),r=Object.getOwnPropertyDescriptor(n,t),r===undefined?(u=Object.getPrototypeOf(n),u===null?undefined:s(u,t,i)):"value"in r?r.value:(f=r.get,f===undefined)?undefined:f.call(i)},h=i(7),c=f(h),l=i(6),a=i(558),v=f(a),y=i(14),u=f(y);u.default.getSingleton().register("persistentStateSave");u.default.getSingleton().register("persistentStateLoad");u.default.getSingleton().register("persistentStateReset");e=function(n){function t(n){p(this,t);var i=w(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return i.storage=void 0,i}return b(t,n),o(t,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().persistentState}},{key:"enablePlugin",value:function(){var n=this;this.enabled||(this.storage||(this.storage=new v.default(this.hot.rootElement.id)),this.addHook("persistentStateSave",function(t,i){return n.saveValue(t,i)}),this.addHook("persistentStateLoad",function(t,i){return n.loadValue(t,i)}),this.addHook("persistentStateReset",function(){return n.resetValue()}),r(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.storage=void 0;r(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin();this.enablePlugin();r(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updatePlugin",this).call(this)}},{key:"loadValue",value:function(n,t){t.value=this.storage.loadValue(n)}},{key:"saveValue",value:function(n,t){this.storage.saveValue(n,t)}},{key:"resetValue",value:function(n){typeof n=="undefined"?this.storage.resetAll():this.storage.reset(n)}},{key:"destroy",value:function(){r(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}}]),t}(c.default);l.registerPlugin("persistentState",e);t.default=e},function(n,t,i){"use strict";function e(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var r,u,f;t.__esModule=!0;r=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}();u=i(0);f=function(){function n(t){e(this,n);this.prefix=t;this.savedKeys=[];this.loadSavedKeys()}return r(n,[{key:"saveValue",value:function(n,t){window.localStorage.setItem(this.prefix+"_"+n,JSON.stringify(t));this.savedKeys.indexOf(n)===-1&&(this.savedKeys.push(n),this.saveSavedKeys())}},{key:"loadValue",value:function(n,t){n=typeof n=="undefined"?t:n;var i=window.localStorage.getItem(this.prefix+"_"+n);if(i!==null)return JSON.parse(i)}},{key:"reset",value:function(n){window.localStorage.removeItem(this.prefix+"_"+n)}},{key:"resetAll",value:function(){var n=this;u.arrayEach(this.savedKeys,function(t,i){window.localStorage.removeItem(n.prefix+"_"+n.savedKeys[i])});this.clearSavedKeys()}},{key:"loadSavedKeys",value:function(){var n=window.localStorage.getItem(this.prefix+"__persistentStateKeys"),t=typeof n=="string"?JSON.parse(n):void 0;this.savedKeys=t?t:[]}},{key:"saveSavedKeys",value:function(){window.localStorage.setItem(this.prefix+"__persistentStateKeys",JSON.stringify(this.savedKeys))}},{key:"clearSavedKeys",value:function(){this.savedKeys.length=0;this.saveSavedKeys()}}]),n}();t.default=f},function(n,t,i){"use strict";function s(n){return n&&n.__esModule?n:{"default":n}}function rt(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function ut(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function ft(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var f,h;t.__esModule=!0;var a=function(){function n(n,t){var r=[],u=!0,f=!1,e=undefined,i,o;try{for(i=n[Symbol.iterator]();!(u=(o=i.next()).done);u=!0)if(r.push(o.value),t&&r.length===t)break}catch(s){f=!0;e=s}finally{try{!u&&i["return"]&&i["return"]()}finally{if(f)throw e;}}return r}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return n(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance");}}(),r=function v(n,t,i){var r,u,f;return n===null&&(n=Function.prototype),r=Object.getOwnPropertyDescriptor(n,t),r===undefined?(u=Object.getPrototypeOf(n),u===null?undefined:v(u,t,i)):"value"in r?r.value:(f=r.get,f===undefined)?undefined:f.call(i)},c=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),y=i(7),p=s(y),u=i(0),e=i(43),w=i(2),b=i(155),k=s(b),o=i(1),l=i(4),d=i(6),g=i(455),nt=s(g),tt=i(31),it=i(8);f=new WeakMap;h=function(n){function t(n){rt(this,t);var i=ut(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return f.set(i,{cachedColumnHeaders:[]}),i.widths=[],i.ghostTable=new k.default(i.hot),i.samplesGenerator=new nt.default(function(n,t){return i.hot.getCellMeta(n,t).spanned?"":i.hot.getDataAtCell(n,t)}),i.firstCalculation=!0,i.inProgress=!1,i.addHook("beforeColumnResize",function(n,t,r){return i.onBeforeColumnResize(n,t,r)}),i}return ft(t,n),c(t,null,[{key:"CALCULATION_STEP",get:function(){return 50}},{key:"SYNC_CALCULATION_LIMIT",get:function(){return 50}}]),c(t,[{key:"isEnabled",value:function(){return this.hot.getSettings().autoColumnSize!==!1&&!this.hot.getSettings().colWidths}},{key:"enablePlugin",value:function(){var n=this,i;this.enabled||(i=this.hot.getSettings().autoColumnSize,i&&i.useHeaders!=null&&this.ghostTable.setSetting("useHeaders",i.useHeaders),this.addHook("afterLoadData",function(){return n.onAfterLoadData()}),this.addHook("beforeChange",function(t){return n.onBeforeChange(t)}),this.addHook("beforeRender",function(t){return n.onBeforeRender(t)}),this.addHook("modifyColWidth",function(t,i){return n.getColumnWidth(i,t)}),this.addHook("afterInit",function(){return n.onAfterInit()}),r(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){var n=this.findColumnsWhereHeaderWasChanged();n.length&&this.clearCache(n);r(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){r(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disablePlugin",this).call(this)}},{key:"calculateColumnsWidth",value:function(){var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{from:0,to:this.hot.countCols()-1},t=this,i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{from:0,to:this.hot.countRows()-1},r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:!1;typeof n=="number"&&(n={from:n,to:n});typeof i=="number"&&(i={from:i,to:i});l.rangeEach(n.from,n.to,function(n){if(r||t.widths[n]===void 0&&!t.hot._getColWidthFromSettings(n)){var u=t.samplesGenerator.generateColumnSamples(n,i);u.forEach(function(n,i){return t.ghostTable.addColumn(i,n)})}});this.ghostTable.columns.length&&(this.ghostTable.getWidths(function(n,i){t.widths[n]=i}),this.ghostTable.clean())}},{key:"calculateAllColumnsWidth",value:function(){var n=this,o=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{from:0,to:this.hot.countRows()-1},i=0,r=this.hot.countCols()-1,u=null,f;this.inProgress=!0;f=function f(){if(!n.hot){e.cancelAnimationFrame(u);n.inProgress=!1;return}n.calculateColumnsWidth({from:i,to:Math.min(i+t.CALCULATION_STEP,r)},o);i=i+t.CALCULATION_STEP+1;i<r?u=e.requestAnimationFrame(f):(e.cancelAnimationFrame(u),n.inProgress=!1,n.hot.view.wt.wtOverlays.adjustElementsSize(!0),n.hot.view.wt.wtOverlays.leftOverlay.needFullRender&&n.hot.view.wt.wtOverlays.leftOverlay.clone.draw())};this.firstCalculation&&this.getSyncCalculationLimit()&&(this.calculateColumnsWidth({from:0,to:this.getSyncCalculationLimit()},o),this.firstCalculation=!1,i=this.getSyncCalculationLimit()+1);i<r?f():this.inProgress=!1}},{key:"setSamplingOptions",value:function(){var n=this.hot.getSettings().autoColumnSize,t=n&&o.hasOwnProperty(n,"samplingRatio")?this.hot.getSettings().autoColumnSize.samplingRatio:void 0,i=n&&o.hasOwnProperty(n,"allowSampleDuplicates")?this.hot.getSettings().autoColumnSize.allowSampleDuplicates:void 0;t&&!isNaN(t)&&this.samplesGenerator.setSampleCount(parseInt(t,10));i&&this.samplesGenerator.setAllowDuplicates(i)}},{key:"recalculateAllColumnsWidth",value:function(){this.hot.view&&w.isVisible(this.hot.view.wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllColumnsWidth())}},{key:"getSyncCalculationLimit",value:function(){var n=t.SYNC_CALCULATION_LIMIT,i=this.hot.countCols()-1;return o.isObject(this.hot.getSettings().autoColumnSize)&&(n=this.hot.getSettings().autoColumnSize.syncLimit,tt.isPercentValue(n)?n=l.valueAccordingPercent(i,n):n>>=0),Math.min(n,i)}},{key:"getColumnWidth",value:function(n){var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:void 0,r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:!0,t=i;return t===void 0&&(t=this.widths[n],r&&typeof t=="number"&&(t=Math.max(t,it.ViewportColumnsCalculator.DEFAULT_WIDTH))),t}},{key:"getFirstVisibleColumn",value:function(){var n=this.hot.view.wt;return n.wtViewport.columnsVisibleCalculator?n.wtTable.getFirstVisibleColumn():n.wtViewport.columnsRenderCalculator?n.wtTable.getFirstRenderedColumn():-1}},{key:"getLastVisibleColumn",value:function(){var n=this.hot.view.wt;return n.wtViewport.columnsVisibleCalculator?n.wtTable.getLastVisibleColumn():n.wtViewport.columnsRenderCalculator?n.wtTable.getLastRenderedColumn():-1}},{key:"findColumnsWhereHeaderWasChanged",value:function(){var t=this.hot.getColHeader(),i=f.get(this),n=i.cachedColumnHeaders;return u.arrayReduce(t,function(t,i,r){var u=n.length;return(u-1<r||n[r]!==i)&&t.push(r),u-1<r?n.push(i):n[r]=i,t},[])}},{key:"clearCache",value:function(){var t=this,n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];n.length?u.arrayEach(n,function(n){t.widths[n]=void 0}):this.widths.length=0}},{key:"isNeedRecalculate",value:function(){return!!u.arrayFilter(this.widths,function(n){return n===void 0}).length}},{key:"onBeforeRender",value:function(){var n=this.hot.renderCall,t=this.hot.countRows();t&&(this.calculateColumnsWidth({from:this.getFirstVisibleColumn(),to:this.getLastVisibleColumn()},void 0,n),this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllColumnsWidth())}},{key:"onAfterLoadData",value:function(){var n=this;this.hot.view?this.recalculateAllColumnsWidth():setTimeout(function(){n.hot&&n.recalculateAllColumnsWidth()},0)}},{key:"onBeforeChange",value:function(n){var t=this,i=u.arrayMap(n,function(n){var i=a(n,2),u=i[0],r=i[1];return t.hot.propToCol(r)});this.clearCache(i)}},{key:"onBeforeColumnResize",value:function(n,t,i){return i&&(this.calculateColumnsWidth(n,void 0,!0),t=this.getColumnWidth(n,void 0,!1)),t}},{key:"onAfterInit",value:function(){f.get(this).cachedColumnHeaders=this.hot.getColHeader()}},{key:"destroy",value:function(){this.ghostTable.clean();r(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}}]),t}(p.default);d.registerPlugin("autoColumnSize",h);t.default=h},function(n,t,i){"use strict";function o(n){return n&&n.__esModule?n:{"default":n}}function k(n){if(Array.isArray(n)){for(var t=0,i=Array(n.length);t<n.length;t++)i[t]=n[t];return i}return Array.from(n)}function d(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function g(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function nt(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}t.__esModule=!0;var c=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),u=function l(n,t,i){var r,u,f;return n===null&&(n=Function.prototype),r=Object.getOwnPropertyDescriptor(n,t),r===undefined?(u=Object.getPrototypeOf(n),u===null?undefined:l(u,t,i)):"value"in r?r.value:(f=r.get,f===undefined)?undefined:f.call(i)},a=i(7),v=o(a),y=i(14),s=o(y),f=i(2),p=i(9),w=o(p),b=i(6),e=i(8),r=i(561);s.default.getSingleton().register("modifyAutofillRange");s.default.getSingleton().register("beforeAutofill");var tt="insert_row",it=200,h=function(n){function t(n){d(this,t);var i=g(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return i.eventManager=new w.default(i),i.addingStarted=!1,i.mouseDownOnCellCorner=!1,i.mouseDragOutside=!1,i.handleDraggedCells=0,i.directions=[],i.autoInsertRow=!1,i}return nt(t,n),c(t,[{key:"isEnabled",value:function(){return this.hot.getSettings().fillHandle}},{key:"enablePlugin",value:function(){var n=this;this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",function(t){return n.onAfterCellCornerMouseDown(t)}),this.addHook("afterOnCellCornerDblClick",function(t){return n.onCellCornerDblClick(t)}),this.addHook("beforeOnCellMouseOver",function(t,i){return n.onBeforeCellMouseOver(i)}),u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin();this.enablePlugin();u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.clearMappedSettings();u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disablePlugin",this).call(this)}},{key:"getSelectionData",value:function(){var n={from:this.hot.getSelectedRangeLast().from,to:this.hot.getSelectedRangeLast().to};return this.hot.getData(n.from.row,n.from.col,n.to.row,n.to.col)}},{key:"fillIn",value:function(){var o,a,n,y,e,i,s,c,u,l;if(this.hot.selection.highlight.getFill().isEmpty())return!1;o=this.hot.selection.highlight.getFill().getCorners();this.resetSelectionOfDraggedArea();a=this.getCornersOfSelectedCells();o=this.hot.runHooks("modifyAutofillRange",o,a);var v=r.getDragDirectionAndRange(a,o),h=v.directionOfDrag,t=v.startOfDragCoords,f=v.endOfDragCoords;if(t&&t.row>-1&&t.col>-1){if(n=this.getSelectionData(),this.hot.runHooks("beforeAutofill",t,f,n),y=r.getDeltas(t,f,n,h),e=n,["up","left"].indexOf(h)>-1)if(e=[],i=null,s=null,h==="up")for(i=f.row-t.row+1,s=i%n.length,c=0;c<i;c++)e.push(n[(c+(n.length-s))%n.length]);else for(i=f.col-t.col+1,s=i%n[0].length,u=0;u<n.length;u++)for(e.push([]),l=0;l<i;l++)e[u].push(n[u][(l+(n[u].length-s))%n[u].length]);this.hot.populateFromArray(t.row,t.col,e,f.row,f.col,this.pluginName+".fill",null,h,y);this.setSelection(o)}else this.hot._refreshBorders();return!0}},{key:"reduceSelectionAreaIfNeeded",value:function(n){return n.row<0&&(n.row=0),n.col<0&&(n.col=0),n}},{key:"getCoordsOfDragAndDropBorders",value:function(n){var u=this.hot.getSelectedRangeLast().getTopLeftCorner(),t=this.hot.getSelectedRangeLast().getBottomRightCorner(),i=void 0;if(this.directions.includes(r.DIRECTIONS.vertical)&&(t.row<n.row||u.row>n.row))i=new e.CellCoords(n.row,t.col);else if(this.directions.includes(r.DIRECTIONS.horizontal))i=new e.CellCoords(t.row,n.col);else return;return this.reduceSelectionAreaIfNeeded(i)}},{key:"showBorder",value:function(n){var t=this.getCoordsOfDragAndDropBorders(n);t&&this.redrawBorders(t)}},{key:"addRow",value:function(){var n=this;this.hot._registerTimeout(setTimeout(function(){n.hot.alter(tt,void 0,1,n.pluginName+".fill");n.addingStarted=!1},it))}},{key:"addNewRowIfNeeded",value:function(){if(this.hot.selection.highlight.getFill().cellRange&&this.addingStarted===!1&&this.autoInsertRow){var t=this.hot.getSelectedLast(),i=this.hot.selection.highlight.getFill().getCorners(),n=this.hot.countRows();t[2]<n-1&&i[2]===n-1&&(this.addingStarted=!0,this.addRow())}}},{key:"getCornersOfSelectedCells",value:function(){return this.hot.selection.isMultiple()?this.hot.selection.highlight.createOrGetArea().getCorners():this.hot.selection.highlight.getCell().getCorners()}},{key:"getIndexOfLastAdjacentFilledInRow",value:function(n){for(var i,f,e,o,r=this.hot.getData(),s=this.hot.countRows(),u=void 0,t=n[2]+1;t<s;t++){for(i=n[1];i<=n[3];i++)if(f=r[t][i],f)return-1;e=r[t][n[1]-1];o=r[t][n[3]+1];!e&&!o||(u=t)}return u}},{key:"addSelectionFromStartAreaToSpecificRowIndex",value:function(n,t){this.hot.selection.highlight.getFill().clear().add(new e.CellCoords(n[0],n[1])).add(new e.CellCoords(t,n[3]))}},{key:"setSelection",value:function(n){var t;(t=this.hot).selectCell.apply(t,k(n).concat([!1,!1]))}},{key:"selectAdjacent",value:function(){var n=this.getCornersOfSelectedCells(),t=this.getIndexOfLastAdjacentFilledInRow(n);return t===-1?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(n,t),!0)}},{key:"resetSelectionOfDraggedArea",value:function(){this.handleDraggedCells=0;this.hot.selection.highlight.getFill().clear()}},{key:"redrawBorders",value:function(n){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(n);this.hot.view.render()}},{key:"getIfMouseWasDraggedOutside",value:function(n){var t=f.offset(this.hot.table).top-(window.pageYOffset||document.documentElement.scrollTop)+f.outerHeight(this.hot.table),i=f.offset(this.hot.table).left-(window.pageXOffset||document.documentElement.scrollLeft)+f.outerWidth(this.hot.table);return n.clientY>t&&n.clientX<=i}},{key:"registerEvents",value:function(){var n=this;this.eventManager.addEventListener(document.documentElement,"mouseup",function(){return n.onMouseUp()});this.eventManager.addEventListener(document.documentElement,"mousemove",function(t){return n.onMouseMove(t)})}},{key:"onCellCornerDblClick",value:function(){var n=this.selectAdjacent();n&&this.fillIn()}},{key:"onAfterCellCornerMouseDown",value:function(){this.handleDraggedCells=1;this.mouseDownOnCellCorner=!0}},{key:"onBeforeCellMouseOver",value:function(n){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells++,this.showBorder(n),this.addNewRowIfNeeded())}},{key:"onMouseUp",value:function(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}},{key:"onMouseMove",value:function(n){var t=this.getIfMouseWasDraggedOutside(n);this.addingStarted===!1&&this.handleDraggedCells>0&&t?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1;this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}},{key:"clearMappedSettings",value:function(){this.directions.length=0;this.autoInsertRow=!1}},{key:"mapSettings",value:function(){var n=r.getMappedFillHandleSetting(this.hot.getSettings().fillHandle);this.directions=n.directions;this.autoInsertRow=n.autoInsertRow}},{key:"destroy",value:function(){u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}}]),t}(v.default);b.registerPlugin("autofill",h);t.default=h},function(n,t,i){"use strict";function o(n,t,i,r){var s=i.length,h=i?i[0].length:0,e=[],y=t.row-n.row,p=t.col-n.col,o,u,f;if(["down","up"].indexOf(r)!==-1){for(o=[],u=0;u<=p;u++){var c=parseInt(i[0][u],10),l=parseInt(i[s-1][u],10),w=(r==="down"?l-c:c-l)/(s-1)||0;o.push(w)}e.push(o)}if(["right","left"].indexOf(r)!==-1)for(f=0;f<=y;f++){var a=parseInt(i[f][0],10),v=parseInt(i[f][h-1],10),b=(r==="right"?v-a:a-v)/(h-1)||0;e.push([b])}return e}function s(n,t){var i=void 0,u=void 0,f=void 0;return t[0]===n[0]&&t[1]<n[1]?(f="left",i=new r.CellCoords(t[0],t[1]),u=new r.CellCoords(t[2],n[1]-1)):t[2]===n[2]&&t[0]===n[0]&&t[3]>n[3]?(f="right",i=new r.CellCoords(t[0],n[3]+1),u=new r.CellCoords(t[2],t[3])):t[0]<n[0]&&t[1]===n[1]?(f="up",i=new r.CellCoords(t[0],t[1]),u=new r.CellCoords(n[0]-1,t[3])):t[2]>n[2]&&t[1]===n[1]&&(f="down",i=new r.CellCoords(n[2]+1,t[1]),u=new r.CellCoords(t[2],t[3])),{directionOfDrag:f,startOfDragCoords:i,endOfDragCoords:u}}function h(n){var t={};return n===!0?(t.directions=Object.keys(u),t.autoInsertRow=!0):e.isObject(n)?(t.autoInsertRow=f.isDefined(n.autoInsertRow)?n.direction===u.horizontal?!1:n.autoInsertRow:!1,t.directions=f.isDefined(n.direction)?[n.direction]:Object.keys(u)):typeof n=="string"?(t.directions=[n],t.autoInsertRow=!0):(t.directions=[],t.autoInsertRow=!1),t}t.__esModule=!0;t.DIRECTIONS=undefined;t.getDeltas=o;t.getDragDirectionAndRange=s;t.getMappedFillHandleSetting=h;var e=i(1),f=i(13),r=i(8),u=t.DIRECTIONS={horizontal:"horizontal",vertical:"vertical"}},function(n,t,i){"use strict";function o(n){return n&&n.__esModule?n:{"default":n}}function nt(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function tt(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function it(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var s;t.__esModule=!0;var u=function c(n,t,i){var r,u,f;return n===null&&(n=Function.prototype),r=Object.getOwnPropertyDescriptor(n,t),r===undefined?(u=Object.getPrototypeOf(n),u===null?undefined:c(u,t,i)):"value"in r?r.value:(f=r.get,f===undefined)?undefined:f.call(i)},h=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),l=i(7),a=o(l),v=i(0),f=i(43),y=i(2),p=i(155),w=o(p),r=i(1),e=i(4),b=i(6),k=i(455),d=o(k),g=i(31);s=function(n){function t(n){nt(this,t);var i=tt(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return i.heights=[],i.ghostTable=new w.default(i.hot),i.samplesGenerator=new d.default(function(n,t){return n>=0?i.hot.getDataAtCell(n,t):n===-1?i.hot.getColHeader(t):null}),i.firstCalculation=!0,i.inProgress=!1,i.addHook("beforeRowResize",function(n,t,r){return i.onBeforeRowResize(n,t,r)}),i}return it(t,n),h(t,null,[{key:"CALCULATION_STEP",get:function(){return 50}},{key:"SYNC_CALCULATION_LIMIT",get:function(){return 500}}]),h(t,[{key:"isEnabled",value:function(){return this.hot.getSettings().autoRowSize===!0||r.isObject(this.hot.getSettings().autoRowSize)}},{key:"enablePlugin",value:function(){var n=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",function(){return n.onAfterLoadData()}),this.addHook("beforeChange",function(t){return n.onBeforeChange(t)}),this.addHook("beforeColumnMove",function(){return n.recalculateAllRowsHeight()}),this.addHook("beforeColumnResize",function(){return n.recalculateAllRowsHeight()}),this.addHook("beforeColumnSort",function(){return n.clearCache()}),this.addHook("beforeRender",function(t){return n.onBeforeRender(t)}),this.addHook("beforeRowMove",function(t,i){return n.onBeforeRowMove(t,i)}),this.addHook("modifyRowHeight",function(t,i){return n.getRowHeight(i,t)}),this.addHook("modifyColumnHeaderHeight",function(){return n.getColumnHeaderHeight()}),u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disablePlugin",this).call(this)}},{key:"calculateRowsHeight",value:function(){var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{from:0,to:this.hot.countRows()-1},i=this,t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{from:0,to:this.hot.countCols()-1},u=arguments.length>2&&arguments[2]!==undefined?arguments[2]:!1,r;typeof n=="number"&&(n={from:n,to:n});typeof t=="number"&&(t={from:t,to:t});this.hot.getColHeader(0)!==null&&(r=this.samplesGenerator.generateRowSamples(-1,t),this.ghostTable.addColumnHeadersRow(r.get(-1)));e.rangeEach(n.from,n.to,function(n){if(u||i.heights[n]===void 0){var r=i.samplesGenerator.generateRowSamples(n,t);r.forEach(function(n,t){i.ghostTable.addRow(t,n)})}});this.ghostTable.rows.length&&(this.ghostTable.getHeights(function(n,t){i.heights[n]=t}),this.ghostTable.clean())}},{key:"calculateAllRowsHeight",value:function(){var n=this,o=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{from:0,to:this.hot.countCols()-1},i=0,r=this.hot.countRows()-1,u=null,e;this.inProgress=!0;e=function e(){if(!n.hot){f.cancelAnimationFrame(u);n.inProgress=!1;return}n.calculateRowsHeight({from:i,to:Math.min(i+t.CALCULATION_STEP,r)},o);i=i+t.CALCULATION_STEP+1;i<r?u=f.requestAnimationFrame(e):(f.cancelAnimationFrame(u),n.inProgress=!1,n.hot.view.wt.wtOverlays.adjustElementsSize(!0),n.hot.view.wt.wtOverlays.leftOverlay.needFullRender&&n.hot.view.wt.wtOverlays.leftOverlay.clone.draw())};this.firstCalculation&&this.getSyncCalculationLimit()&&(this.calculateRowsHeight({from:0,to:this.getSyncCalculationLimit()},o),this.firstCalculation=!1,i=this.getSyncCalculationLimit()+1);i<r?e():(this.inProgress=!1,this.hot.view.wt.wtOverlays.adjustElementsSize(!1))}},{key:"setSamplingOptions",value:function(){var n=this.hot.getSettings().autoRowSize,t=n&&r.hasOwnProperty(n,"samplingRatio")?this.hot.getSettings().autoRowSize.samplingRatio:void 0,i=n&&r.hasOwnProperty(n,"allowSampleDuplicates")?this.hot.getSettings().autoRowSize.allowSampleDuplicates:void 0;t&&!isNaN(t)&&this.samplesGenerator.setSampleCount(parseInt(t,10));i&&this.samplesGenerator.setAllowDuplicates(i)}},{key:"recalculateAllRowsHeight",value:function(){y.isVisible(this.hot.view.wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllRowsHeight())}},{key:"getSyncCalculationLimit",value:function(){var n=t.SYNC_CALCULATION_LIMIT,i=this.hot.countRows()-1;return r.isObject(this.hot.getSettings().autoRowSize)&&(n=this.hot.getSettings().autoRowSize.syncLimit,g.isPercentValue(n)?n=e.valueAccordingPercent(i,n):n>>=0),Math.min(n,i)}},{key:"getRowHeight",value:function(n){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:void 0,i=t;return this.heights[n]!==void 0&&this.heights[n]>(t||0)&&(i=this.heights[n]),i}},{key:"getColumnHeaderHeight",value:function(){return this.heights[-1]}},{key:"getFirstVisibleRow",value:function(){var n=this.hot.view.wt;return n.wtViewport.rowsVisibleCalculator?n.wtTable.getFirstVisibleRow():n.wtViewport.rowsRenderCalculator?n.wtTable.getFirstRenderedRow():-1}},{key:"getLastVisibleRow",value:function(){var n=this.hot.view.wt;return n.wtViewport.rowsVisibleCalculator?n.wtTable.getLastVisibleRow():n.wtViewport.rowsRenderCalculator?n.wtTable.getLastRenderedRow():-1}},{key:"clearCache",value:function(){this.heights.length=0;this.heights[-1]=void 0}},{key:"clearCacheByRange",value:function(n){var t=this;typeof n=="number"&&(n={from:n,to:n});e.rangeEach(Math.min(n.from,n.to),Math.max(n.from,n.to),function(n){t.heights[n]=void 0})}},{key:"isNeedRecalculate",value:function(){return!!v.arrayFilter(this.heights,function(n){return n===void 0}).length}},{key:"onBeforeRender",value:function(){var i=this.hot.renderCall,n,t;this.calculateRowsHeight({from:this.getFirstVisibleRow(),to:this.getLastVisibleRow()},void 0,i);n=this.hot.getSettings().fixedRowsBottom;n&&(t=this.hot.countRows()-1,this.calculateRowsHeight({from:t-n,to:t}));this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllRowsHeight()}},{key:"onBeforeRowMove",value:function(n,t){this.clearCacheByRange({from:n,to:t});this.calculateAllRowsHeight()}},{key:"onBeforeRowResize",value:function(n,t,i){return i&&(this.calculateRowsHeight(n,void 0,!0),t=this.getRowHeight(n)),t}},{key:"onAfterLoadData",value:function(){var n=this;this.hot.view?this.recalculateAllRowsHeight():setTimeout(function(){n.hot&&n.recalculateAllRowsHeight()},0)}},{key:"onBeforeChange",value:function(n){var t=null;n.length===1?t=n[0][0]:n.length>1&&(t={from:n[0][0],to:n[n.length-1][0]});t!==null&&this.clearCacheByRange(t)}},{key:"destroy",value:function(){this.ghostTable.clean();u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}}]),t}(a.default);b.registerPlugin("autoRowSize",s);t.default=s},function(n,t,i){"use strict";function f(n){return n&&n.__esModule?n:{"default":n}}function tt(n){if(Array.isArray(n)){for(var t=0,i=Array(n.length);t<n.length;t++)i[t]=n[t];return i}return Array.from(n)}function it(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function rt(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function ut(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var o;t.__esModule=!0;var a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},v=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),s=function y(n,t,i){var r,u,f;return n===null&&(n=Function.prototype),r=Object.getOwnPropertyDescriptor(n,t),r===undefined?(u=Object.getPrototypeOf(n),u===null?undefined:y(u,t,i)):"value"in r?r.value:(f=r.get,f===undefined)?undefined:f.call(i)},p=i(23),h=f(p),u=i(2),e=i(0),r=i(13),c=i(1),w=i(7),b=f(w),k=i(6),d=i(564),g=f(d),nt=i(14),l=f(nt);l.default.getSingleton().register("beforeColumnSort");l.default.getSingleton().register("afterColumnSort");o=function(n){function t(n){it(this,t);var i=rt(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return i.sortIndicators=[],i.lastSortedColumn=null,i.sortEmptyCells=!1,i}return ut(t,n),v(t,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().columnSorting}},{key:"enablePlugin",value:function(){var n=this,i;this.enabled||(this.setPluginOptions(),i=this,this.hot.sortIndex=[],this.hot.sort=function(){var n=Array.prototype.slice.call(arguments);return i.sortByColumn.apply(i,tt(n))},typeof this.hot.getSettings().observeChanges=="undefined"&&this.enableObserveChangesPlugin(),this.addHook("afterTrimRow",function(){return n.sort()}),this.addHook("afterUntrimRow",function(){return n.sort()}),this.addHook("modifyRow",function(t){return n.translateRow(t)}),this.addHook("unmodifyRow",function(t){return n.untranslateRow(t)}),this.addHook("afterUpdateSettings",function(){return n.onAfterUpdateSettings()}),this.addHook("afterGetColHeader",function(t,i){return n.getColHeader(t,i)}),this.addHook("afterOnCellMouseDown",function(t,i){return n.onAfterOnCellMouseDown(t,i)}),this.addHook("afterCreateRow",function(){i.afterCreateRow.apply(i,arguments)}),this.addHook("afterRemoveRow",function(){i.afterRemoveRow.apply(i,arguments)}),this.addHook("afterInit",function(){return n.sortBySettings()}),this.addHook("afterLoadData",function(){n.hot.sortIndex=[];n.hot.view&&n.sortBySettings()}),this.hot.view&&this.sortBySettings(),s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.hot.sort=void 0;s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disablePlugin",this).call(this)}},{key:"onAfterUpdateSettings",value:function(){this.sortBySettings()}},{key:"sortBySettings",value:function(){var r=this.hot.getSettings().columnSorting,t=this.loadSortingState(),n=void 0,i=void 0;typeof t=="undefined"?(n=r.column,i=r.sortOrder):(n=t.sortColumn,i=t.sortOrder);typeof n=="number"&&(this.lastSortedColumn=n,this.sortByColumn(n,i))}},{key:"setSortingColumn",value:function(n,t){if(typeof n=="undefined"){this.hot.sortColumn=void 0;this.hot.sortOrder=void 0;return}this.hot.sortOrder=this.hot.sortColumn===n&&typeof t=="undefined"?this.hot.sortOrder===!1?void 0:!this.hot.sortOrder:typeof t=="undefined"?!0:t;this.hot.sortColumn=n}},{key:"sortByColumn",value:function(n,t){if(this.setSortingColumn(n,t),typeof this.hot.sortColumn!="undefined"){var i=this.hot.runHooks("beforeColumnSort",this.hot.sortColumn,this.hot.sortOrder);i!==!1&&this.sort();this.updateOrderClass();this.updateSortIndicator();this.hot.runHooks("afterColumnSort",this.hot.sortColumn,this.hot.sortOrder);this.hot.render();this.saveSortingState()}}},{key:"saveSortingState",value:function(){var n={};typeof this.hot.sortColumn!="undefined"&&(n.sortColumn=this.hot.sortColumn);typeof this.hot.sortOrder!="undefined"&&(n.sortOrder=this.hot.sortOrder);(c.hasOwnProperty(n,"sortColumn")||c.hasOwnProperty(n,"sortOrder"))&&this.hot.runHooks("persistentStateSave","columnSorting",n)}},{key:"loadSortingState",value:function(){var n={};return this.hot.runHooks("persistentStateLoad","columnSorting",n),n.value}},{key:"updateOrderClass",value:function(){var n=void 0;this.hot.sortOrder===!0?n="ascending":this.hot.sortOrder===!1&&(n="descending");this.sortOrderClass=n}},{key:"enableObserveChangesPlugin",value:function(){var n=this;this.hot._registerTimeout(setTimeout(function(){n.hot.updateSettings({observeChanges:!0})},0))}},{key:"defaultSort",value:function(n,t){return function(i,u){return(typeof i[1]=="string"&&(i[1]=i[1].toLowerCase()),typeof u[1]=="string"&&(u[1]=u[1].toLowerCase()),i[1]===u[1])?0:r.isEmpty(i[1])?r.isEmpty(u[1])?0:t.columnSorting.sortEmptyCells?n?-1:1:1:r.isEmpty(u[1])?r.isEmpty(i[1])?0:t.columnSorting.sortEmptyCells?n?1:-1:-1:isNaN(i[1])&&!isNaN(u[1])?n?1:-1:!isNaN(i[1])&&isNaN(u[1])?n?-1:1:(isNaN(i[1])||isNaN(u[1])||(i[1]=parseFloat(i[1]),u[1]=parseFloat(u[1])),i[1]<u[1])?n?-1:1:i[1]>u[1]?n?1:-1:0}}},{key:"dateSort",value:function(n,t){return function(i,u){if(i[1]===u[1])return 0;if(r.isEmpty(i[1]))return r.isEmpty(u[1])?0:t.columnSorting.sortEmptyCells?n?-1:1:1;if(r.isEmpty(u[1]))return r.isEmpty(i[1])?0:t.columnSorting.sortEmptyCells?n?1:-1:-1;var f=h.default(i[1],t.dateFormat),e=h.default(u[1],t.dateFormat);return f.isValid()?e.isValid()?e.isAfter(f)?n?-1:1:e.isBefore(f)?n?1:-1:0:-1:1}}},{key:"numericSort",value:function(n,t){return function(i,u){var f=parseFloat(i[1]),e=parseFloat(u[1]);if(f===e||isNaN(f)&&isNaN(e))return 0;if(t.columnSorting.sortEmptyCells){if(r.isEmpty(i[1]))return n?-1:1;if(r.isEmpty(u[1]))return n?1:-1}return isNaN(f)?1:isNaN(e)?-1:f<e?n?-1:1:f>e?n?1:-1:0}}},{key:"sort",value:function(){var i,f,r;if(typeof this.hot.sortOrder=="undefined"){this.hot.sortIndex.length=0;return}var n=this.hot.getCellMeta(0,this.hot.sortColumn),e=this.hot.countEmptyRows(),t=void 0,u=void 0;for(this.hot.sortingEnabled=!1,this.hot.sortIndex.length=0,typeof n.columnSorting.sortEmptyCells=="undefined"&&(n.columnSorting={sortEmptyCells:this.sortEmptyCells}),u=this.hot.getSettings().maxRows===Number.POSITIVE_INFINITY?this.hot.countRows()-this.hot.getSettings().minSpareRows:this.hot.countRows()-e,i=0,f=u;i<f;i++)this.hot.sortIndex.push([i,this.hot.getDataAtCell(i,this.hot.sortColumn)]);if(n.sortFunction)t=n.sortFunction;else switch(n.type){case"date":t=this.dateSort;break;case"numeric":t=this.numericSort;break;default:t=this.defaultSort}for(g.default(this.hot.sortIndex,t(this.hot.sortOrder,n)),r=this.hot.sortIndex.length;r<this.hot.countRows();r++)this.hot.sortIndex.push([r,this.hot.getDataAtCell(r,this.hot.sortColumn)]);this.hot.sortingEnabled=!0}},{key:"updateSortIndicator",value:function(){if(typeof this.hot.sortOrder!="undefined"){var n=this.hot.getCellMeta(0,this.hot.sortColumn);this.sortIndicators[this.hot.sortColumn]=n.sortIndicator}}},{key:"translateRow",value:function(n){return this.hot.sortingEnabled&&typeof this.hot.sortOrder!="undefined"&&this.hot.sortIndex&&this.hot.sortIndex.length&&this.hot.sortIndex[n]?this.hot.sortIndex[n][0]:n}},{key:"untranslateRow",value:function(n){if(this.hot.sortingEnabled&&this.hot.sortIndex&&this.hot.sortIndex.length)for(var t=0;t<this.hot.sortIndex.length;t++)if(this.hot.sortIndex[t][0]==n)return t}},{key:"getColHeader",value:function(n,t){if(n<0||!t.parentNode)return!1;var i=t.querySelector(".colHeader"),e=t.getAttribute("colspan"),r=t.parentNode.parentNode.childNodes,f=Array.prototype.indexOf.call(r,t.parentNode);(f-=r.length,i)&&(this.hot.getSettings().columnSorting&&n>=0&&f===-1&&u.addClass(i,"columnSorting"),u.removeClass(i,"descending"),u.removeClass(i,"ascending"),this.sortIndicators[n]&&n===this.hot.sortColumn&&(this.sortOrderClass==="ascending"?u.addClass(i,"ascending"):this.sortOrderClass==="descending"&&u.addClass(i,"descending")))}},{key:"isSorted",value:function(){return typeof this.hot.sortColumn!="undefined"}},{key:"afterCreateRow",value:function(n,t){var r,i;if(this.isSorted()){for(r=0;r<this.hot.sortIndex.length;r++)this.hot.sortIndex[r][0]>=n&&(this.hot.sortIndex[r][0]+=t);for(i=0;i<t;i++)this.hot.sortIndex.splice(n+i,0,[n+i,this.hot.getSourceData()[n+i][this.hot.sortColumn+this.hot.colOffset()]]);this.saveSortingState()}}},{key:"afterRemoveRow",value:function(n,t){function r(n){return e.arrayReduce(i,function(t,i){return n>i&&t++,t},0)}if(this.isSorted()){var i=this.hot.sortIndex.splice(n,t);i=e.arrayMap(i,function(n){return n[0]});this.hot.sortIndex=e.arrayMap(this.hot.sortIndex,function(n){var t=r(n[0]);return t&&(n[0]-=t),n});this.saveSortingState()}}},{key:"setPluginOptions",value:function(){var n=this.hot.getSettings().columnSorting;this.sortEmptyCells=(typeof n=="undefined"?"undefined":a(n))==="object"?n.sortEmptyCells||!1:!1}},{key:"onAfterOnCellMouseDown",value:function(n,t){t.row>-1||u.hasClass(n.realTarget,"columnSorting")&&(t.col!==this.lastSortedColumn&&(this.hot.sortOrder=!0),this.lastSortedColumn=t.col,this.sortByColumn(t.col))}}]),t}(b.default);k.registerPlugin("columnSorting",o);t.default=o},function(n,t,i){"use strict";function s(n){return n&&n.__esModule?n:{"default":n}}function u(n){var f=arguments.length>1&&arguments[1]!==undefined?arguments[1]:e,t=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0,i=arguments.length>3&&arguments[3]!==undefined?arguments[3]:n.length,r;return Math.abs(i-t)<=1?[]:(r=Math.ceil((t+i)/2),u(n,f,t,r),u(n,f,r,i),o(n,f,t,r,i))}function o(n,t,i,u,f){for(var h,e=new r.default,s=new r.default,c=u-i,l=f-u,a=Math.max(c,l),v=f-i,o=0;o<a;o+=1)o<c&&e.push(n[i+o]),o<l&&s.push(n[u+o]);for(h=0;h<v;)n[i+h]=e.first&&s.first?t(e.first.data,s.first.data)>0?s.shift().data:e.shift().data:e.first?e.shift().data:s.shift().data,h+=1;return n}var f,r,e;t.__esModule=!0;t.default=u;t.merge=o;f=i(565);r=s(f);e=function(n,t){var i=n.toString(),r=t.toString();return i===r?0:i<r?-1:1}},function(n,t){"use strict";function u(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var r,i,f;t.__esModule=!0;r=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}();i=function i(n){u(this,i);this.data=n;this.next=null;this.prev=null};f=function(){function n(){u(this,n);this.first=null;this.last=null}return r(n,[{key:"push",value:function(n){var t=new i(n),r;this.first===null?(this.first=t,this.last=t):(r=this.last,this.last=t,t.prev=r,r.next=t)}},{key:"unshift",value:function(n){var t=new i(n),r;this.first===null?(this.first=t,this.last=t):(r=this.first,this.first=t,t.next=r,r.prev=t)}},{key:"inorder",value:function(n){for(var t=this.first;t;)n(t),t=t.next}},{key:"remove",value:function(n){if(this.first===null)return!1;for(var t=this.first,i=void 0,r=void 0;t;){if(t.data===n)return i=t.next,r=t.prev,i&&(i.prev=r),r&&(r.next=i),t===this.first&&(this.first=i),t===this.last&&(this.last=r),!0;t=t.next}return!1}},{key:"hasCycle",value:function(){for(var n=this.first,t=this.first;;){if(n===null||(n=n.next,n===null))return!1;if(n=n.next,t=t.next,n===t)return!0}}},{key:"pop",value:function(){if(this.last===null)return null;var n=this.last;return this.last=this.last.prev,n}},{key:"shift",value:function(){if(this.first===null)return null;var n=this.first;return this.first=this.first.next,n}},{key:"recursiveReverse",value:function(){function n(t,i){i&&(n(i,i.next),i.next=t)}if(this.first){n(this.first,this.first.next);this.first.next=null;var t=this.first;this.first=this.last;this.last=t}}},{key:"reverse",value:function(){if(this.first&&this.first.next){for(var n=this.first.next,t=this.first,i=void 0;n;)i=n.next,n.next=t,t.prev=n,t=n,n=i;this.first.next=null;this.last.prev=null;i=this.first;this.first=t;this.last=i}}}]),n}();t.NodeStructure=i;t.default=f},function(n,t,i){"use strict";function st(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function h(n){return n&&n.__esModule?n:{"default":n}}function v(n,t,i){return t in n?Object.defineProperty(n,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[t]=i,n}function ht(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function ct(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function lt(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}t.__esModule=!0;var b=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),e=function k(n,t,i){var r,u,f;return n===null&&(n=Function.prototype),r=Object.getOwnPropertyDescriptor(n,t),r===undefined?(u=Object.getPrototypeOf(n),u===null?undefined:k(u,t,i)):"value"in r?r.value:(f=r.get,f===undefined)?undefined:f.call(i)},r=i(2),a=i(1),d=i(9),g=h(d),o=i(8),nt=i(6),tt=i(7),it=h(tt),rt=i(567),ut=h(rt),y=i(24),ft=i(568),et=h(ft),ot=i(3),s=st(ot);i(569);var c=new WeakMap,u="comment",f="value",p="style",l="readOnly",w=function(n){function t(n){ht(this,t);var i=ct(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return i.editor=null,i.displaySwitch=null,i.eventManager=null,i.range={},i.mouseDown=!1,i.contextMenuEvent=!1,i.timer=null,c.set(i,{tempEditorDimensions:{},cellBelowCursor:null}),i}return lt(t,n),b(t,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().comments}},{key:"enablePlugin",value:function(){var n=this;this.enabled||(this.editor||(this.editor=new ut.default),this.eventManager||(this.eventManager=new g.default(this)),this.displaySwitch||(this.displaySwitch=new et.default(this.getDisplayDelaySetting())),this.addHook("afterContextMenuDefaultOptions",function(t){return n.addToContextMenu(t)}),this.addHook("afterRenderer",function(t,i,r,u,f,e){return n.onAfterRenderer(t,e)}),this.addHook("afterScrollHorizontally",function(){return n.hide()}),this.addHook("afterScrollVertically",function(){return n.hide()}),this.addHook("afterBeginEditing",function(t){return n.onAfterBeginEditing(t)}),this.displaySwitch.addLocalHook("hide",function(){return n.hide()}),this.displaySwitch.addLocalHook("show",function(t,i){return n.showAtCell(t,i)}),this.registerListeners(),e(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin();this.enablePlugin();e(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updatePlugin",this).call(this);this.displaySwitch.updateDelay(this.getDisplayDelaySetting())}},{key:"disablePlugin",value:function(){e(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disablePlugin",this).call(this)}},{key:"registerListeners",value:function(){var n=this;this.eventManager.addEventListener(document,"mouseover",function(t){return n.onMouseOver(t)});this.eventManager.addEventListener(document,"mousedown",function(t){return n.onMouseDown(t)});this.eventManager.addEventListener(document,"mouseup",function(t){return n.onMouseUp(t)});this.eventManager.addEventListener(this.editor.getInputElement(),"blur",function(t){return n.onEditorBlur(t)});this.eventManager.addEventListener(this.editor.getInputElement(),"mousedown",function(t){return n.onEditorMouseDown(t)});this.eventManager.addEventListener(this.editor.getInputElement(),"mouseup",function(t){return n.onEditorMouseUp(t)})}},{key:"setRange",value:function(n){this.range=n}},{key:"clearRange",value:function(){this.range={}}},{key:"targetIsCellWithComment",value:function(n){var t=r.closest(n.target,"TD","TBODY");return!!(t&&r.hasClass(t,"htCommentCell")&&r.closest(t,[this.hot.rootElement]))}},{key:"targetIsCommentTextArea",value:function(n){return this.editor.getInputElement()===n.target}},{key:"setComment",value:function(n){var i,t,r,u;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');i=this.editor.getValue();t="";n!=null?t=n:i!=null&&(t=i);r=this.range.from.row;u=this.range.from.col;this.updateCommentMeta(r,u,v({},f,t));this.hot.render()}},{key:"setCommentAtCell",value:function(n,t,i){this.setRange({from:new o.CellCoords(n,t)});this.setComment(i)}},{key:"removeComment",value:function(){var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,u,void 0);n&&this.hot.render();this.hide()}},{key:"removeCommentAtCell",value:function(n,t){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:!0;this.setRange({from:new o.CellCoords(n,t)});this.removeComment(i)}},{key:"getComment",value:function(){var n=this.range.from.row,t=this.range.from.col;return this.getCommentMeta(n,t,f)}},{key:"getCommentAtCell",value:function(n,t){return this.getCommentMeta(n,t,f)}},{key:"show",value:function(){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var n=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return this.refreshEditor(!0),this.editor.setValue(n[u]?n[u][f]:""),this.editor.hidden&&this.editor.show(),!0}},{key:"showAtCell",value:function(n,t){return this.setRange({from:new o.CellCoords(n,t)}),this.show()}},{key:"hide",value:function(){this.editor.hidden||this.editor.hide()}},{key:"refreshEditor",value:function(){var s=arguments.length>0&&arguments[0]!==undefined?arguments[0]:!1;if(s||this.range.from&&this.editor.isVisible()){var u=r.getScrollableElement(this.hot.view.wt.wtTable.TABLE),h=this.hot.view.wt.wtTable.getCell(this.range.from),f=this.range.from.row,n=this.range.from.col,t=r.offset(h),c=this.hot.view.wt.wtTable.getStretchedColumnWidth(n),e=t.top<0?0:t.top,o=t.left;this.hot.view.wt.wtViewport.hasVerticalScroll()&&u!==window&&(e-=this.hot.view.wt.wtOverlays.topOverlay.getScrollPosition());this.hot.view.wt.wtViewport.hasHorizontalScroll()&&u!==window&&(o-=this.hot.view.wt.wtOverlays.leftOverlay.getScrollPosition());var a=o+c,v=e,i=this.getCommentMeta(f,n,p),y=this.getCommentMeta(f,n,l);i?this.editor.setSize(i.width,i.height):this.editor.resetSize();this.editor.setReadOnlyState(y);this.editor.setPosition(a,v)}}},{key:"checkSelectionCommentsConsistency",value:function(){var i=this.hot.getSelectedRangeLast(),n,t;return i?(n=!1,t=i.from,this.getCommentMeta(t.row,t.col,f)&&(n=!0),n):!1}},{key:"updateCommentMeta",value:function(n,t,i){var f=this.hot.getCellMeta(n,t)[u],r=void 0;f?(r=a.deepClone(f),a.deepExtend(r,i)):r=i;this.hot.setCellMeta(n,t,u,r)}},{key:"getCommentMeta",value:function(n,t,i){var r=this.hot.getCellMeta(n,t);if(r[u])return r[u][i]}},{key:"onMouseDown",value:function(n){if(this.mouseDown=!0,this.hot.view&&this.hot.view.wt){if(!this.contextMenuEvent&&!this.targetIsCommentTextArea(n)){var i=r.closest(n.target,"TD","TBODY"),t=null;i&&(t=this.hot.view.wt.wtTable.getCoords(i));(!i||this.range.from&&t&&(this.range.from.row!==t.row||this.range.from.col!==t.col))&&this.hide()}this.contextMenuEvent=!1}}},{key:"onMouseOver",value:function(n){var i=c.get(this),t,u;(i.cellBelowCursor=document.elementFromPoint(n.clientX,n.clientY),this.mouseDown||this.editor.isFocused()||r.hasClass(n.target,"wtBorder")||i.cellBelowCursor!==n.target||!this.editor)||(this.targetIsCellWithComment(n)?(t=this.hot.view.wt.wtTable.getCoords(n.target),u={from:new o.CellCoords(t.row,t.col)},this.displaySwitch.show(u)):r.isChildOf(n.target,document)&&!this.targetIsCommentTextArea(n)&&this.displaySwitch.hide())}},{key:"onMouseUp",value:function(){this.mouseDown=!1}},{key:"onAfterRenderer",value:function(n,t){t[u]&&t[u][f]&&r.addClass(n,t.commentedCellClassName)}},{key:"onEditorBlur",value:function(){this.setComment()}},{key:"onEditorMouseDown",value:function(n){var t=c.get(this);t.tempEditorDimensions={width:r.outerWidth(n.target),height:r.outerHeight(n.target)}}},{key:"onEditorMouseUp",value:function(n){var t=c.get(this),i=r.outerWidth(n.target),u=r.outerHeight(n.target);(i!==t.tempEditorDimensions.width+1||u!==t.tempEditorDimensions.height+2)&&this.updateCommentMeta(this.range.from.row,this.range.from.col,v({},p,{width:i,height:u}))}},{key:"onContextMenuAddComment",value:function(){var n=this,t;this.displaySwitch.cancelHiding();t=this.hot.getSelectedRangeLast();this.contextMenuEvent=!0;this.setRange({from:t.from});this.show();setTimeout(function(){n.hot&&(n.hot.deselectCell(),n.editor.focus())},10)}},{key:"onContextMenuRemoveComment",value:function(){var n,t;this.contextMenuEvent=!0;var i=this.hot.getSelectedRangeLast(),r=i.from,u=i.to;for(n=r.row;n<=u.row;n++)for(t=r.col;t<=u.col;t++)this.removeCommentAtCell(n,t,!1);this.hot.render()}},{key:"onContextMenuMakeReadOnly",value:function(){var n,t,f;this.contextMenuEvent=!0;var i=this.hot.getSelectedRangeLast(),r=i.from,u=i.to;for(n=r.row;n<=u.row;n++)for(t=r.col;t<=u.col;t++)f=!!this.getCommentMeta(n,t,l),this.updateCommentMeta(n,t,v({},l,!f))}},{key:"addToContextMenu",value:function(n){var t=this;n.items.push({name:"---------"},{key:"commentsAddEdit",name:function(){return t.checkSelectionCommentsConsistency()?t.hot.getTranslatedPhrase(s.CONTEXTMENU_ITEMS_EDIT_COMMENT):t.hot.getTranslatedPhrase(s.CONTEXTMENU_ITEMS_ADD_COMMENT)},callback:function(){return t.onContextMenuAddComment()},disabled:function(){return!(this.getSelectedLast()&&!this.selection.selectedHeader.corner)}},{key:"commentsRemove",name:function(){return this.getTranslatedPhrase(s.CONTEXTMENU_ITEMS_REMOVE_COMMENT)},callback:function(){return t.onContextMenuRemoveComment()},disabled:function(){return t.hot.selection.selectedHeader.corner}},{key:"commentsReadOnly",name:function(){var t=this,n=this.getTranslatedPhrase(s.CONTEXTMENU_ITEMS_READ_ONLY_COMMENT),i=y.checkSelectionConsistency(this.getSelectedRangeLast(),function(n,i){var r=t.getCellMeta(n,i)[u];return r&&(r=r[l]),r?!0:void 0});return i&&(n=y.markLabelAsSelected(n)),n},callback:function(){return t.onContextMenuMakeReadOnly()},disabled:function(){return t.hot.selection.selectedHeader.corner||!t.checkSelectionCommentsConsistency()}})}},{key:"getDisplayDelaySetting",value:function(){var n=this.hot.getSettings().comments;if(a.isObject(n))return n.displayDelay}},{key:"onAfterBeginEditing",value:function(){this.hide()}},{key:"destroy",value:function(){this.editor&&this.editor.destroy();this.displaySwitch&&this.displaySwitch.destroy();e(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}}]),t}(it.default);nt.registerPlugin("comments",w);t.default=w},function(n,t,i){"use strict";function e(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var u,r,f;t.__esModule=!0;u=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}();r=i(2);f=function(){function n(){e(this,n);this.editor=this.createEditor();this.editorStyle=this.editor.style;this.hidden=!0;this.hide()}return u(n,null,[{key:"CLASS_EDITOR_CONTAINER",get:function(){return"htCommentsContainer"}},{key:"CLASS_EDITOR",get:function(){return"htComments"}},{key:"CLASS_INPUT",get:function(){return"htCommentTextArea"}},{key:"CLASS_CELL",get:function(){return"htCommentCell"}}]),u(n,[{key:"setPosition",value:function(n,t){this.editorStyle.left=n+"px";this.editorStyle.top=t+"px"}},{key:"setSize",value:function(n,t){if(n&&t){var i=this.getInputElement();i.style.width=n+"px";i.style.height=t+"px"}}},{key:"resetSize",value:function(){var n=this.getInputElement();n.style.width="";n.style.height=""}},{key:"setReadOnlyState",value:function(n){var t=this.getInputElement();t.readOnly=n}},{key:"show",value:function(){this.editorStyle.display="block";this.hidden=!1}},{key:"hide",value:function(){this.editorStyle.display="none";this.hidden=!0}},{key:"isVisible",value:function(){return this.editorStyle.display==="block"}},{key:"setValue",value:function(){var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"";n=n||"";this.getInputElement().value=n}},{key:"getValue",value:function(){return this.getInputElement().value}},{key:"isFocused",value:function(){return document.activeElement===this.getInputElement()}},{key:"focus",value:function(){this.getInputElement().focus()}},{key:"createEditor",value:function(){var t=document.querySelector("."+n.CLASS_EDITOR_CONTAINER),i=void 0,u=void 0;return t||(t=document.createElement("div"),r.addClass(t,n.CLASS_EDITOR_CONTAINER),document.body.appendChild(t)),i=document.createElement("div"),r.addClass(i,n.CLASS_EDITOR),u=document.createElement("textarea"),r.addClass(u,n.CLASS_INPUT),i.appendChild(u),t.appendChild(i),i}},{key:"getInputElement",value:function(){return this.editor.querySelector("."+n.CLASS_INPUT)}},{key:"destroy",value:function(){this.editor.parentNode.removeChild(this.editor);this.editor=null;this.editorStyle=null}}]),n}();t.default=f},function(n,t,i){"use strict";function h(n){return n&&n.__esModule?n:{"default":n}}function c(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}t.__esModule=!0;var u=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),f=i(35),e=i(1),o=i(21),s=h(o);var l=250,a=250,r=function(){function n(t){c(this,n);this.wasLastActionShow=!0;this.showDebounced=null;this.hidingTimer=null;this.updateDelay(t)}return u(n,[{key:"hide",value:function(){var n=this;this.wasLastActionShow=!1;this.hidingTimer=setTimeout(function(){n.wasLastActionShow===!1&&n.runLocalHooks("hide")},a)}},{key:"show",value:function(n){this.wasLastActionShow=!0;this.showDebounced(n)}},{key:"cancelHiding",value:function(){this.wasLastActionShow=!0;clearTimeout(this.hidingTimer);this.hidingTimer=null}},{key:"updateDelay",value:function(){var n=this,t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:l;this.showDebounced=f.debounce(function(t){n.wasLastActionShow&&n.runLocalHooks("show",t.from.row,t.from.col)},t)}},{key:"destroy",value:function(){this.clearLocalHooks()}}]),n}();e.mixin(r,s.default);t.default=r},function(){},function(n,t,i){"use strict";function u(n){return n&&n.__esModule?n:{"default":n}}function ut(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function ft(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function et(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var s;t.__esModule=!0;var e=function l(n,t,i){var r,u,f;return n===null&&(n=Function.prototype),r=Object.getOwnPropertyDescriptor(n,t),r===undefined?(u=Object.getPrototypeOf(n),u===null?undefined:l(u,t,i)):"value"in r?r.value:(f=r.get,f===undefined)?undefined:f.call(i)},c=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),a=i(7),v=u(a),y=i(14),o=u(y),p=i(0),w=i(456),b=u(w),k=i(9),d=u(k),g=i(457),nt=u(g),tt=i(157),it=u(tt),rt=i(6),h=i(11),f=i(2),r=i(44);i(583);o.default.getSingleton().register("afterContextMenuDefaultOptions");o.default.getSingleton().register("afterContextMenuShow");o.default.getSingleton().register("afterContextMenuHide");o.default.getSingleton().register("afterContextMenuExecute");s=function(n){function t(n){ut(this,t);var i=ft(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return i.eventManager=new d.default(i),i.commandExecutor=new b.default(i.hot),i.itemsFactory=null,i.menu=null,i}return et(t,n),c(t,null,[{key:"DEFAULT_ITEMS",get:function(){return[r.ROW_ABOVE,r.ROW_BELOW,r.SEPARATOR,r.COLUMN_LEFT,r.COLUMN_RIGHT,r.SEPARATOR,r.REMOVE_ROW,r.REMOVE_COLUMN,r.SEPARATOR,r.UNDO,r.REDO,r.SEPARATOR,r.READ_ONLY,r.SEPARATOR,r.ALIGNMENT]}}]),c(t,[{key:"isEnabled",value:function(){return this.hot.getSettings().contextMenu}},{key:"enablePlugin",value:function(){var n=this,i,r,u;this.enabled||(this.itemsFactory=new nt.default(this.hot,t.DEFAULT_ITEMS),i=this.hot.getSettings().contextMenu,r={items:this.itemsFactory.getItems(i)},this.registerEvents(),typeof i.callback=="function"&&this.commandExecutor.setCommonCallback(i.callback),e(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enablePlugin",this).call(this),u=function(){if(n.hot){n.hot.runHooks("afterContextMenuDefaultOptions",r);n.itemsFactory.setPredefinedItems(r.items);var t=n.itemsFactory.getItems(i);n.menu=new it.default(n.hot,{className:"htContextMenu",keepInViewport:!0});n.hot.runHooks("beforeContextMenuSetItems",t);n.menu.setMenuItems(t);n.menu.addLocalHook("afterOpen",function(){return n.onMenuAfterOpen()});n.menu.addLocalHook("afterClose",function(){return n.onMenuAfterClose()});n.menu.addLocalHook("executeCommand",function(){for(var i=arguments.length,r=Array(i),t=0;t<i;t++)r[t]=arguments[t];return n.executeCommand.apply(n,r)});p.arrayEach(t,function(t){return n.commandExecutor.registerCommand(t.key,t)})}},this.callOnPluginsReady(function(){n.isPluginsReady?setTimeout(u,0):u()}))}},{key:"updatePlugin",value:function(){this.disablePlugin();this.enablePlugin();e(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.close();this.menu&&(this.menu.destroy(),this.menu=null);e(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disablePlugin",this).call(this)}},{key:"registerEvents",value:function(){var n=this;this.eventManager.addEventListener(this.hot.rootElement,"contextmenu",function(t){return n.onContextMenu(t)})}},{key:"open",value:function(n){this.menu&&(this.menu.open(),this.menu.setPosition({top:parseInt(h.pageY(n),10)-f.getWindowScrollTop(),left:parseInt(h.pageX(n),10)-f.getWindowScrollLeft()}),this.menu.hotMenu.isHotTableEnv=this.hot.isHotTableEnv)}},{key:"close",value:function(){this.menu&&this.menu.close()}},{key:"executeCommand",value:function(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];this.commandExecutor.execute.apply(this.commandExecutor,i)}},{key:"onContextMenu",value:function(n){function e(n){return n.nodeName==="TD"||n.parentNode.nodeName==="TD"}var i=this.hot.getSettings(),r=i.rowHeaders,u=i.colHeaders,t=n.realTarget;(this.close(),f.hasClass(t,"handsontableInput"))||(n.preventDefault(),h.stopPropagation(n),r||u||e(t)||f.hasClass(t,"current")&&f.hasClass(t,"wtBorder"))&&this.open(n)}},{key:"onMenuAfterOpen",value:function(){this.hot.runHooks("afterContextMenuShow",this)}},{key:"onMenuAfterClose",value:function(){this.hot.listen();this.hot.runHooks("afterContextMenuHide",this)}},{key:"destroy",value:function(){this.close();this.menu&&this.menu.destroy();e(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}}]),t}(v.default);s.SEPARATOR={name:r.SEPARATOR};rt.registerPlugin("contextMenu",s);t.default=s},function(n,t,i){"use strict";function s(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function h(){return{key:u,name:function(){return this.getTranslatedPhrase(f.CONTEXTMENU_ITEMS_ALIGNMENT)},disabled:function(){return!(this.getSelectedRange()&&!this.selection.selectedHeader.corner)},submenu:{items:[{key:u+":left",name:function(){var t=this,n=this.getTranslatedPhrase(f.CONTEXTMENU_ITEMS_ALIGNMENT_LEFT),i=r.checkSelectionConsistency(this.getSelectedRange(),function(n,i){var r=t.getCellMeta(n,i).className;if(r&&r.indexOf("htLeft")!==-1)return!0});return i&&(n=r.markLabelAsSelected(n)),n},callback:function(){var n=this,t=this.getSelectedRange(),f=r.getAlignmentClasses(t,function(t,i){return n.getCellMeta(t,i).className}),i="horizontal",u="htLeft";this.runHooks("beforeCellAlignment",f,t,i,u);r.align(t,i,u,function(t,i){return n.getCellMeta(t,i)},function(t,i,r,u){return n.setCellMeta(t,i,r,u)});this.render()},disabled:!1},{key:u+":center",name:function(){var t=this,n=this.getTranslatedPhrase(f.CONTEXTMENU_ITEMS_ALIGNMENT_CENTER),i=r.checkSelectionConsistency(this.getSelectedRange(),function(n,i){var r=t.getCellMeta(n,i).className;if(r&&r.indexOf("htCenter")!==-1)return!0});return i&&(n=r.markLabelAsSelected(n)),n},callback:function(){var n=this,t=this.getSelectedRange(),f=r.getAlignmentClasses(t,function(t,i){return n.getCellMeta(t,i).className}),i="horizontal",u="htCenter";this.runHooks("beforeCellAlignment",f,t,i,u);r.align(t,i,u,function(t,i){return n.getCellMeta(t,i)},function(t,i,r,u){return n.setCellMeta(t,i,r,u)});this.render()},disabled:!1},{key:u+":right",name:function(){var t=this,n=this.getTranslatedPhrase(f.CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT),i=r.checkSelectionConsistency(this.getSelectedRange(),function(n,i){var r=t.getCellMeta(n,i).className;if(r&&r.indexOf("htRight")!==-1)return!0});return i&&(n=r.markLabelAsSelected(n)),n},callback:function(){var n=this,t=this.getSelectedRange(),f=r.getAlignmentClasses(t,function(t,i){return n.getCellMeta(t,i).className}),i="horizontal",u="htRight";this.runHooks("beforeCellAlignment",f,t,i,u);r.align(t,i,u,function(t,i){return n.getCellMeta(t,i)},function(t,i,r,u){return n.setCellMeta(t,i,r,u)});this.render()},disabled:!1},{key:u+":justify",name:function(){var t=this,n=this.getTranslatedPhrase(f.CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY),i=r.checkSelectionConsistency(this.getSelectedRange(),function(n,i){var r=t.getCellMeta(n,i).className;if(r&&r.indexOf("htJustify")!==-1)return!0});return i&&(n=r.markLabelAsSelected(n)),n},callback:function(){var n=this,t=this.getSelectedRange(),f=r.getAlignmentClasses(t,function(t,i){return n.getCellMeta(t,i).className}),i="horizontal",u="htJustify";this.runHooks("beforeCellAlignment",f,t,i,u);r.align(t,i,u,function(t,i){return n.getCellMeta(t,i)},function(t,i,r,u){return n.setCellMeta(t,i,r,u)});this.render()},disabled:!1},{name:e.KEY},{key:u+":top",name:function(){var t=this,n=this.getTranslatedPhrase(f.CONTEXTMENU_ITEMS_ALIGNMENT_TOP),i=r.checkSelectionConsistency(this.getSelectedRange(),function(n,i){var r=t.getCellMeta(n,i).className;if(r&&r.indexOf("htTop")!==-1)return!0});return i&&(n=r.markLabelAsSelected(n)),n},callback:function(){var n=this,t=this.getSelectedRange(),f=r.getAlignmentClasses(t,function(t,i){return n.getCellMeta(t,i).className}),i="vertical",u="htTop";this.runHooks("beforeCellAlignment",f,t,i,u);r.align(t,i,u,function(t,i){return n.getCellMeta(t,i)},function(t,i,r,u){return n.setCellMeta(t,i,r,u)});this.render()},disabled:!1},{key:u+":middle",name:function(){var t=this,n=this.getTranslatedPhrase(f.CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE),i=r.checkSelectionConsistency(this.getSelectedRange(),function(n,i){var r=t.getCellMeta(n,i).className;if(r&&r.indexOf("htMiddle")!==-1)return!0});return i&&(n=r.markLabelAsSelected(n)),n},callback:function(){var n=this,t=this.getSelectedRange(),f=r.getAlignmentClasses(t,function(t,i){return n.getCellMeta(t,i).className}),i="vertical",u="htMiddle";this.runHooks("beforeCellAlignment",f,t,i,u);r.align(t,i,u,function(t,i){return n.getCellMeta(t,i)},function(t,i,r,u){return n.setCellMeta(t,i,r,u)});this.render()},disabled:!1},{key:u+":bottom",name:function(){var t=this,n=this.getTranslatedPhrase(f.CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM),i=r.checkSelectionConsistency(this.getSelectedRange(),function(n,i){var r=t.getCellMeta(n,i).className;if(r&&r.indexOf("htBottom")!==-1)return!0});return i&&(n=r.markLabelAsSelected(n)),n},callback:function(){var n=this,t=this.getSelectedRange(),f=r.getAlignmentClasses(t,function(t,i){return n.getCellMeta(t,i).className}),i="vertical",u="htBottom";this.runHooks("beforeCellAlignment",f,t,i,u);r.align(t,i,u,function(t,i){return n.getCellMeta(t,i)},function(t,i,r,u){return n.setCellMeta(t,i,r,u)});this.render()},disabled:!1}]}}}var u;t.__esModule=!0;t.KEY=undefined;t.default=h;var r=i(24),e=i(156),o=i(3),f=s(o);u=t.KEY="alignment"},function(n,t,i){"use strict";function s(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function h(){return{key:u,name:function(){return this.getTranslatedPhrase(o.CONTEXTMENU_ITEMS_CLEAR_COLUMN)},callback:function(n,t){var i=t[0].start.col;this.countRows()&&this.populateFromArray(0,i,[[null]],Math.max(t[0].start.row,t[0].end.row),i,"ContextMenu.clearColumn")},disabled:function(){var t=f.getValidSelection(this);if(!t)return!0;var n=r(t[0],4),i=n[0],u=n[1],e=n[2],h=n[3],o=[i,0,e,this.countCols()-1],s=o.join(",")===t.join(",");return u<0||this.countCols()>=this.getSettings().maxCols||s}}}var r,u;t.__esModule=!0;t.KEY=undefined;r=function(){function n(n,t){var r=[],u=!0,f=!1,e=undefined,i,o;try{for(i=n[Symbol.iterator]();!(u=(o=i.next()).done);u=!0)if(r.push(o.value),t&&r.length===t)break}catch(s){f=!0;e=s}finally{try{!u&&i["return"]&&i["return"]()}finally{if(f)throw e;}}return r}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return n(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance");}}();t.default=h;var f=i(24),e=i(3),o=s(e);u=t.KEY="clear_column"},function(n,t,i){"use strict";function s(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function h(){return{key:u,name:function(){return this.getTranslatedPhrase(o.CONTEXTMENU_ITEMS_INSERT_LEFT)},callback:function(n,t){var i=t[Math.max(t.length-1,0)];this.alter("insert_col",i.start.col,1,"ContextMenu.columnLeft")},disabled:function(){var t=f.getValidSelection(this);if(!t||!this.isColumnModificationAllowed())return!0;var n=r(t[0],4),i=n[0],u=n[1],e=n[2],c=n[3],o=[i,0,e,this.countCols()-1],s=o.join(",")===t.join(","),h=this.countCols()===1;return u<0||this.countCols()>=this.getSettings().maxCols||!h&&s},hidden:function(){return!this.getSettings().allowInsertColumn}}}var r,u;t.__esModule=!0;t.KEY=undefined;r=function(){function n(n,t){var r=[],u=!0,f=!1,e=undefined,i,o;try{for(i=n[Symbol.iterator]();!(u=(o=i.next()).done);u=!0)if(r.push(o.value),t&&r.length===t)break}catch(s){f=!0;e=s}finally{try{!u&&i["return"]&&i["return"]()}finally{if(f)throw e;}}return r}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return n(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance");}}();t.default=h;var f=i(24),e=i(3),o=s(e);u=t.KEY="col_left"},function(n,t,i){"use strict";function s(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function h(){return{key:u,name:function(){return this.getTranslatedPhrase(o.CONTEXTMENU_ITEMS_INSERT_RIGHT)},callback:function(n,t){var i=t[Math.max(t.length-1,0)];this.alter("insert_col",i.end.col+1,1,"ContextMenu.columnRight")},disabled:function(){var t=f.getValidSelection(this);if(!t||!this.isColumnModificationAllowed())return!0;var n=r(t[0],4),i=n[0],u=n[1],e=n[2],c=n[3],o=[i,0,e,this.countCols()-1],s=o.join(",")===t.join(","),h=this.countCols()===1;return u<0||this.countCols()>=this.getSettings().maxCols||!h&&s},hidden:function(){return!this.getSettings().allowInsertColumn}}}var r,u;t.__esModule=!0;t.KEY=undefined;r=function(){function n(n,t){var r=[],u=!0,f=!1,e=undefined,i,o;try{for(i=n[Symbol.iterator]();!(u=(o=i.next()).done);u=!0)if(r.push(o.value),t&&r.length===t)break}catch(s){f=!0;e=s}finally{try{!u&&i["return"]&&i["return"]()}finally{if(f)throw e;}}return r}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return n(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance");}}();t.default=h;var f=i(24),e=i(3),o=s(e);u=t.KEY="col_right"},function(n,t,i){"use strict";function s(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function h(){return{key:u,name:function(){var t=this,n=this.getTranslatedPhrase(o.CONTEXTMENU_ITEMS_READ_ONLY),i=r.checkSelectionConsistency(this.getSelectedRange(),function(n,i){return t.getCellMeta(n,i).readOnly});return i&&(n=r.markLabelAsSelected(n)),n},callback:function(){var n=this,t=this.getSelectedRange(),i=r.checkSelectionConsistency(t,function(t,i){return n.getCellMeta(t,i).readOnly});f.arrayEach(t,function(t){t.forAll(function(t,r){n.setCellMeta(t,r,"readOnly",!i)})});this.render()},disabled:function(){return!(this.getSelectedRange()&&!this.selection.selectedHeader.corner)}}}var u;t.__esModule=!0;t.KEY=undefined;t.default=h;var r=i(24),f=i(0),e=i(3),o=s(e);u=t.KEY="make_read_only"},function(n,t,i){"use strict";function e(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function o(){return{key:f,name:function(){return this.getTranslatedPhrase(u.CONTEXTMENU_ITEMS_REDO)},callback:function(){this.redo()},disabled:function(){return this.undoRedo&&!this.undoRedo.isRedoAvailable()}}}var r,u,f;t.__esModule=!0;t.KEY=undefined;t.default=o;r=i(3);u=e(r);f=t.KEY="redo"},function(n,t,i){"use strict";function h(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function c(){return{key:u,name:function(){var n=this.getSelected(),t=0;if(n)if(n.length>1)t=1;else{var i=r(n[0],4),u=i[1],f=i[3];u-f!=0&&(t=1)}return this.getTranslatedPhrase(s.CONTEXTMENU_ITEMS_REMOVE_COLUMN,t)},callback:function(){this.alter("remove_col",e.transformSelectionToColumnDistance(this.getSelected()),null,"ContextMenu.removeColumn")},disabled:function(){var n=f.getValidSelection(this),t=this.countCols();return n?this.selection.selectedHeader.rows||this.selection.selectedHeader.corner||!this.isColumnModificationAllowed()||!t:!0},hidden:function(){return!this.getSettings().allowRemoveColumn}}}var r,u;t.__esModule=!0;t.KEY=undefined;r=function(){function n(n,t){var r=[],u=!0,f=!1,e=undefined,i,o;try{for(i=n[Symbol.iterator]();!(u=(o=i.next()).done);u=!0)if(r.push(o.value),t&&r.length===t)break}catch(s){f=!0;e=s}finally{try{!u&&i["return"]&&i["return"]()}finally{if(f)throw e;}}return r}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return n(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance");}}();t.default=c;var f=i(24),l=i(0),e=i(154),o=i(3),s=h(o);u=t.KEY="remove_col"},function(n,t,i){"use strict";function h(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function c(){return{key:u,name:function(){var n=this.getSelected(),t=0;if(n)if(n.length>1)t=1;else{var i=r(n[0],3),u=i[0],f=i[2];u-f!=0&&(t=1)}return this.getTranslatedPhrase(s.CONTEXTMENU_ITEMS_REMOVE_ROW,t)},callback:function(){this.alter("remove_row",e.transformSelectionToRowDistance(this.getSelected()),null,"ContextMenu.removeRow")},disabled:function(){var n=f.getValidSelection(this),t=this.countRows();return n?this.selection.selectedHeader.cols||this.selection.selectedHeader.corner||!t:!0},hidden:function(){return!this.getSettings().allowRemoveRow}}}var r,u;t.__esModule=!0;t.KEY=undefined;r=function(){function n(n,t){var r=[],u=!0,f=!1,e=undefined,i,o;try{for(i=n[Symbol.iterator]();!(u=(o=i.next()).done);u=!0)if(r.push(o.value),t&&r.length===t)break}catch(s){f=!0;e=s}finally{try{!u&&i["return"]&&i["return"]()}finally{if(f)throw e;}}return r}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return n(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance");}}();t.default=c;var f=i(24),l=i(0),e=i(154),o=i(3),s=h(o);u=t.KEY="remove_row"},function(n,t,i){"use strict";function o(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function s(){return{key:r,name:function(){return this.getTranslatedPhrase(e.CONTEXTMENU_ITEMS_ROW_ABOVE)},callback:function(n,t){var i=t[Math.max(t.length-1,0)];this.alter("insert_row",i.start.row,1,"ContextMenu.rowAbove")},disabled:function(){var n=u.getValidSelection(this);return n?this.selection.selectedHeader.cols||this.countRows()>=this.getSettings().maxRows:!0},hidden:function(){return!this.getSettings().allowInsertRow}}}var r;t.__esModule=!0;t.KEY=undefined;t.default=s;var u=i(24),f=i(3),e=o(f);r=t.KEY="row_above"},function(n,t,i){"use strict";function o(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function s(){return{key:r,name:function(){return this.getTranslatedPhrase(e.CONTEXTMENU_ITEMS_ROW_BELOW)},callback:function(n,t){var i=t[Math.max(t.length-1,0)];this.alter("insert_row",i.end.row+1,1,"ContextMenu.rowBelow")},disabled:function(){var n=u.getValidSelection(this);return n?this.selection.selectedHeader.cols||this.countRows()>=this.getSettings().maxRows:!0},hidden:function(){return!this.getSettings().allowInsertRow}}}var r;t.__esModule=!0;t.KEY=undefined;t.default=s;var u=i(24),f=i(3),e=o(f);r=t.KEY="row_below"},function(n,t,i){"use strict";function e(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function o(){return{key:f,name:function(){return this.getTranslatedPhrase(u.CONTEXTMENU_ITEMS_UNDO)},callback:function(){this.undo()},disabled:function(){return this.undoRedo&&!this.undoRedo.isUndoAvailable()}}}var r,u,f;t.__esModule=!0;t.KEY=undefined;t.default=o;r=i(3);u=e(r);f=t.KEY="undo"},function(n,t,i){"use strict";function o(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var f;t.__esModule=!0;var e=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),r=i(2),u=i(11);f=function(){function n(t){o(this,n);var e=r.getWindowScrollTop(),s=r.getWindowScrollLeft(),i=void 0,h=void 0,f=void 0,c=void 0,l=void 0,a=void 0;this.type=this.getSourceType(t);this.type==="literal"?(i=parseInt(t.top,10),f=parseInt(t.left,10),l=t.height||0,a=t.width||0,h=i,c=f,i+=e,f+=s):this.type==="event"&&(i=parseInt(u.pageY(t),10),f=parseInt(u.pageX(t),10),l=t.target.clientHeight,a=t.target.clientWidth,h=i-e,c=f-s);this.top=i;this.topRelative=h;this.left=f;this.leftRelative=c;this.scrollTop=e;this.scrollLeft=s;this.cellHeight=l;this.cellWidth=a}return e(n,[{key:"getSourceType",value:function(n){var t="literal";return n instanceof Event&&(t="event"),t}},{key:"fitsAbove",value:function(n){return this.topRelative>=n.offsetHeight}},{key:"fitsBelow",value:function(n){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:window.innerHeight;return this.topRelative+n.offsetHeight<=t}},{key:"fitsOnRight",value:function(n){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:window.innerWidth;return this.leftRelative+this.cellWidth+n.offsetWidth<=t}},{key:"fitsOnLeft",value:function(n){return this.leftRelative>=n.offsetWidth}}]),n}();t.default=f},function(){},function(n,t,i){"use strict";function u(n){return n&&n.__esModule?n:{"default":n}}function ct(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function lt(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function at(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}t.__esModule=!0;var a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},v=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),o=function y(n,t,i){var r,u,f;return n===null&&(n=Function.prototype),r=Object.getOwnPropertyDescriptor(n,t),r===undefined?(u=Object.getPrototypeOf(n),u===null?undefined:y(u,t,i)):"value"in r?r.value:(f=r.get,f===undefined)?undefined:f.call(i)},p=i(7),w=u(p),b=i(14),r=u(b),k=i(448),s=u(k),h=i(8),d=i(2),f=i(0),c=i(4),g=i(6),nt=i(585),tt=u(nt),it=i(586),rt=u(it),ut=i(587),ft=u(ut),et=i(9),ot=u(et),st=i(588),ht=u(st);i(590);r.default.getSingleton().register("afterCopyLimit");r.default.getSingleton().register("modifyCopyableRange");r.default.getSingleton().register("beforeCut");r.default.getSingleton().register("afterCut");r.default.getSingleton().register("beforePaste");r.default.getSingleton().register("afterPaste");r.default.getSingleton().register("beforeCopy");r.default.getSingleton().register("afterCopy");var vt=1e3,yt=1e3,e=new WeakMap,l=function(n){function t(n){ct(this,t);var i=lt(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return i.eventManager=new ot.default(i),i.columnsLimit=yt,i.copyableRanges=[],i.pasteMode="overwrite",i.rowsLimit=vt,i.textarea=void 0,e.set(i,{isTriggeredByCopy:!1,isTriggeredByCut:!1,isBeginEditing:!1,isFragmentSelectionEnabled:!1}),i}return at(t,n),v(t,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().copyPaste}},{key:"enablePlugin",value:function(){var i=this,n,r;this.enabled||(n=this.hot.getSettings(),r=e.get(this),this.textarea=tt.default.getSingleton(),r.isFragmentSelectionEnabled=n.fragmentSelection,a(n.copyPaste)==="object"&&(this.pasteMode=n.copyPaste.pasteMode||this.pasteMode,this.rowsLimit=n.copyPaste.rowsLimit||this.rowsLimit,this.columnsLimit=n.copyPaste.columnsLimit||this.columnsLimit),this.addHook("afterContextMenuDefaultOptions",function(n){return i.onAfterContextMenuDefaultOptions(n)}),this.addHook("afterSelectionEnd",function(){return i.onAfterSelectionEnd()}),this.registerEvents(),o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin();this.enablePlugin();o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.textarea&&this.textarea.destroy();o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disablePlugin",this).call(this)}},{key:"setCopyableText",value:function(){var n=this.hot.getSelectedRangeLast();if(n){var f=n.getTopLeftCorner(),e=n.getBottomRightCorner(),t=f.row,i=f.col,r=e.row,u=e.col,o=Math.min(r,t+this.rowsLimit-1),s=Math.min(u,i+this.columnsLimit-1);this.copyableRanges.length=0;this.copyableRanges.push({startRow:t,startCol:i,endRow:o,endCol:s});this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);(r!==o||u!==s)&&this.hot.runHooks("afterCopyLimit",r-t+1,u-i+1,this.rowsLimit,this.columnsLimit)}}},{key:"getRangedCopyableData",value:function(n){var u=this,r=[],t=[],i=[];return f.arrayEach(n,function(n){c.rangeEach(n.startRow,n.endRow,function(n){t.indexOf(n)===-1&&t.push(n)});c.rangeEach(n.startCol,n.endCol,function(n){i.indexOf(n)===-1&&i.push(n)})}),f.arrayEach(t,function(n){var t=[];f.arrayEach(i,function(i){t.push(u.hot.getCopyableData(n,i))});r.push(t)}),s.default.stringify(r)}},{key:"getRangedData",value:function(n){var u=this,r=[],t=[],i=[];return f.arrayEach(n,function(n){c.rangeEach(n.startRow,n.endRow,function(n){t.indexOf(n)===-1&&t.push(n)});c.rangeEach(n.startCol,n.endCol,function(n){i.indexOf(n)===-1&&i.push(n)})}),f.arrayEach(t,function(n){var t=[];f.arrayEach(i,function(i){t.push(u.hot.getCopyableData(n,i))});r.push(t)}),r}},{key:"copy",value:function(){var n=e.get(this);n.isTriggeredByCopy=!0;this.textarea.select();document.execCommand("copy")}},{key:"cut",value:function(){var n=e.get(this);n.isTriggeredByCut=!0;this.textarea.select();document.execCommand("cut")}},{key:"paste",value:function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"",n=new ht.default;n.clipboardData.setData("text/plain",t);this.onPaste(n)}},{key:"registerEvents",value:function(){var n=this;this.eventManager.addEventListener(this.textarea.element,"paste",function(t){return n.onPaste(t)});this.eventManager.addEventListener(this.textarea.element,"cut",function(t){return n.onCut(t)});this.eventManager.addEventListener(this.textarea.element,"copy",function(t){return n.onCopy(t)})}},{key:"onCopy",value:function(n){var r=e.get(this);if(this.hot.isListening()||r.isTriggeredByCopy){this.setCopyableText();r.isTriggeredByCopy=!1;var t=this.getRangedData(this.copyableRanges),u=!!this.hot.runHooks("beforeCopy",t,this.copyableRanges),i="";u&&(i=s.default.stringify(t),n&&n.clipboardData?n.clipboardData.setData("text/plain",i):typeof ClipboardEvent=="undefined"&&window.clipboardData.setData("Text",i),this.hot.runHooks("afterCopy",t,this.copyableRanges));n.preventDefault()}}},{key:"onCut",value:function(n){var r=e.get(this);if(this.hot.isListening()||r.isTriggeredByCut){this.setCopyableText();r.isTriggeredByCut=!1;var t=this.getRangedData(this.copyableRanges),u=!!this.hot.runHooks("beforeCut",t,this.copyableRanges),i=void 0;u&&(i=s.default.stringify(t),n&&n.clipboardData?n.clipboardData.setData("text/plain",i):typeof ClipboardEvent=="undefined"&&window.clipboardData.setData("Text",i),this.hot.emptySelectedCells(),this.hot.runHooks("afterCut",t,this.copyableRanges));n.preventDefault()}}},{key:"onPaste",value:function(n){var y=this,t,l;if(this.hot.isListening()&&(n&&n.preventDefault&&n.preventDefault(),t=void 0,n&&typeof n.clipboardData!="undefined"?this.textarea.setValue(n.clipboardData.getData("text/plain")):typeof ClipboardEvent=="undefined"&&typeof clipboardData!="undefined"&&this.textarea.setValue(window.clipboardData.getData("Text")),t=s.default.parse(this.textarea.getValue()),this.textarea.setValue(" "),t.length!==0)&&(l=!!this.hot.runHooks("beforePaste",t,this.copyableRanges),l)){var i=this.hot.getSelectedLast(),r=new h.CellCoords(i[0],i[1]),o=new h.CellCoords(i[2],i[3]),a=new h.CellRange(r,r,o),c=a.getTopLeftCorner(),v=a.getBottomRightCorner(),u=c,e=new h.CellCoords(Math.max(v.row,t.length-1+c.row),Math.max(v.col,t[0].length-1+c.col)),p=o.row-r.row>=t.length-1,w=o.col-r.col>=t[0].length-1;this.hot.addHookOnce("afterChange",function(n){var r=n?n.length:0,t,i;r&&(t={row:0,col:0},i=-1,f.arrayEach(n,function(u,f){var e=r>f+1?n[f+1]:null;e&&(p||(t.row+=Math.max(e[0]-u[0]-1,0)),!w&&u[1]>i&&(i=u[1],t.col+=Math.max(e[1]-u[1]-1,0)))}),y.hot.selectCell(u.row,u.col,e.row+t.row,e.col+t.col))});this.hot.populateFromArray(u.row,u.col,t,e.row,e.col,"CopyPaste.paste",this.pasteMode);this.hot.runHooks("afterPaste",t,this.copyableRanges)}}},{key:"onAfterContextMenuDefaultOptions",value:function(n){n.items.push({name:"---------"},rt.default(this),ft.default(this))}},{key:"onAfterSelectionEnd",value:function(){var t=e.get(this),n=this.hot.getActiveEditor();n&&typeof n.isOpened!="undefined"&&n.isOpened()||t.isFragmentSelectionEnabled&&!this.textarea.isActive()&&d.getSelectionText()||(this.setCopyableText(),this.textarea.select())}},{key:"destroy",value:function(){this.textarea&&this.textarea.destroy();o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}}]),t}(w.default);g.registerPlugin("CopyPaste",l);t.default=l},function(n,t){"use strict";function f(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var i,r,u;t.__esModule=!0;i=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}();r=function(){function n(){f(this,n);this.element=void 0;this.isAppended=!1;this.refCounter=0}return i(n,null,[{key:"getSingleton",value:function(){return u.append(),u}}]),i(n,[{key:"append",value:function(){this.hasBeenDestroyed()&&this.create();this.refCounter++;!this.isAppended&&document.body&&document.body&&(this.isAppended=!0,document.body.appendChild(this.element))}},{key:"create",value:function(){this.element=document.createElement("textarea");this.element.id="HandsontableCopyPaste";this.element.className="copyPaste";this.element.tabIndex=-1;this.element.autocomplete="off";this.element.wrap="hard";this.element.value=" "}},{key:"deselect",value:function(){this.element===document.activeElement&&document.activeElement.blur()}},{key:"destroy",value:function(){this.refCounter--;this.refCounter=this.refCounter<0?0:this.refCounter;this.hasBeenDestroyed()&&this.element&&this.element.parentNode&&(this.element.parentNode.removeChild(this.element),this.element=null,this.isAppended=!1)}},{key:"getValue",value:function(){return this.element.value}},{key:"hasBeenDestroyed",value:function(){return this.refCounter<1}},{key:"isActive",value:function(){return this.element===document.activeElement}},{key:"select",value:function(){this.element.focus();this.element.select()}},{key:"setValue",value:function(n){this.element.value=n}}]),n}();u=new r;t.default=r},function(n,t,i){"use strict";function f(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function e(n){return{key:"copy",name:function(){return this.getTranslatedPhrase(u.CONTEXTMENU_ITEMS_COPY)},callback:function(){n.copy()},disabled:function(){var n=this.getSelected();return!n||n.length>1?!0:!1},hidden:!1}}t.__esModule=!0;t.default=e;var r=i(3),u=f(r)},function(n,t,i){"use strict";function f(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function e(n){return{key:"cut",name:function(){return this.getTranslatedPhrase(u.CONTEXTMENU_ITEMS_CUT)},callback:function(){n.cut()},disabled:function(){var n=this.getSelected();return!n||n.length>1?!0:!1},hidden:!1}}t.__esModule=!0;t.default=e;var r=i(3),u=f(r)},function(n,t,i){"use strict";function e(n){return n&&n.__esModule?n:{"default":n}}function o(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var u,f,r;t.__esModule=!0;u=i(589);f=e(u);r=function r(){o(this,r);this.clipboardData=new f.default};t.default=r},function(n,t){"use strict";function u(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var i,r;t.__esModule=!0;i=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}();r=function(){function n(){u(this,n);this.data={}}return i(n,[{key:"setData",value:function(n,t){this.data[n]=t}},{key:"getData",value:function(n){return this.data[n]||void 0}}]),n}();t.default=r},function(){},function(n,t,i){"use strict";function it(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function rt(n){return n&&n.__esModule?n:{"default":n}}function b(){}t.__esModule=!0;var g=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},nt=i(14),l=rt(nt),r=i(1),a=i(0),w=i(8),tt=i(3),f=it(tt);var h,ut=function(n){return typeof n=="boolean"&&n===!0?!0:(typeof n=="undefined"?"undefined":g(n))==="object"&&n.length>0?!0:!1},ft=function(){ut(this.getSettings().customBorders)&&(this.customBorders||(h=this,this.customBorders=new b))},et=function(n){var t=-1;return a.arrayEach(h.selection.highlight.borders,function(i,r){if(i.settings.className==n)return t=r,!1}),t},v=function(n){var t={row:n.row,col:n.col},i=new w.Selection(n,new w.CellRange(t,t,t)),r=et(n.className);r>=0?h.selection.highlight.borders[r]=i:h.selection.highlight.borders.push(i)},ot=function(n,t,i){var r=p(n,t);r=lt(r,i);this.setCellMeta(n,t,"borders",r);v(r)},st=function(n){for(var i,u,e,t=n.range,f=t.from.row;f<=t.to.row;f++)for(i=t.from.col;i<=t.to.col;i++)u=p(f,i),e=0,f==t.from.row&&(e++,r.hasOwnProperty(n,"top")&&(u.top=n.top)),f==t.to.row&&(e++,r.hasOwnProperty(n,"bottom")&&(u.bottom=n.bottom)),i==t.from.col&&(e++,r.hasOwnProperty(n,"left")&&(u.left=n.left)),i==t.to.col&&(e++,r.hasOwnProperty(n,"right")&&(u.right=n.right)),e>0&&(this.setCellMeta(f,i,"borders",u),v(u))},y=function(n,t){return"border_row"+n+"col"+t},ht=function(){return{width:1,color:"#000"}},e=function(){return{hide:!0}},ct=function(){return{width:1,color:"#000",cornerVisible:!1}},p=function(n,t){return{className:y(n,t),border:ct(),row:n,col:t,top:e(),right:e(),bottom:e(),left:e()}},lt=function(n,t){return r.hasOwnProperty(t,"border")&&(n.border=t.border),r.hasOwnProperty(t,"top")&&(n.top=t.top),r.hasOwnProperty(t,"right")&&(n.right=t.right),r.hasOwnProperty(t,"bottom")&&(n.bottom=t.bottom),r.hasOwnProperty(t,"left")&&(n.left=t.left),n},k=function(n){for(var r,i=document.querySelectorAll("."+n),t=0;t<i.length;t++)i[t]&&i[t].nodeName!="TD"&&(r=i[t].parentNode,r.parentNode&&r.parentNode.removeChild(r))},d=function(n,t){var i=y(n,t);k(i);this.removeCellMeta(n,t,"borders")},o=function(n,t,i,r){var u=this.getCellMeta(n,t).borders,f;u&&u.border!=undefined||(u=p(n,t));u[i]=r?e():ht();this.setCellMeta(n,t,"borders",u);f=y(n,t);k(f);v(u)},s=function(n,t,i){var r=this;a.arrayEach(n,function(n){var u=n.start,f=n.end,e,s,h,c,l,a;if(u.row==f.row&&u.col==f.col)t=="noBorders"?d.call(r,u.row,u.col):o.call(r,u.row,u.col,t,i);else switch(t){case"noBorders":for(e=u.col;e<=f.col;e++)for(s=u.row;s<=f.row;s++)d.call(r,s,e);break;case"top":for(h=u.col;h<=f.col;h++)o.call(r,u.row,h,t,i);break;case"right":for(c=u.row;c<=f.row;c++)o.call(r,c,f.col,t);break;case"bottom":for(l=u.col;l<=f.col;l++)o.call(r,f.row,l,t);break;case"left":for(a=u.row;a<=f.row;a++)o.call(r,a,u.col,t)}});this.render()},u=function(n,t){var i=!1;return a.arrayEach(n.getSelectedRange(),function(u){u.forAll(function(u,f){var e=n.getCellMeta(u,f).borders;if(e)if(t){if(!r.hasOwnProperty(e[t],"hide"))return i=!0,!1}else return i=!0,!1})}),i},c=function(n){return'<span class="selected">'+String.fromCharCode(10003)+"<\/span>"+n},at=function(n){this.getSettings().customBorders&&(n.items.push({name:"---------"}),n.items.push({key:"borders",name:function(){return this.getTranslatedPhrase(f.CONTEXTMENU_ITEMS_BORDERS)},disabled:function(){return this.selection.selectedHeader.corner},submenu:{items:[{key:"borders:top",name:function(){var n=this.getTranslatedPhrase(f.CONTEXTMENU_ITEMS_BORDERS_TOP),t=u(this,"top");return t&&(n=c(n)),n},callback:function(n,t){var i=u(this,"top");s.call(this,t,"top",i)}},{key:"borders:right",name:function(){var n=this.getTranslatedPhrase(f.CONTEXTMENU_ITEMS_BORDERS_RIGHT),t=u(this,"right");return t&&(n=c(n)),n},callback:function(n,t){var i=u(this,"right");s.call(this,t,"right",i)}},{key:"borders:bottom",name:function(){var n=this.getTranslatedPhrase(f.CONTEXTMENU_ITEMS_BORDERS_BOTTOM),t=u(this,"bottom");return t&&(n=c(n)),n},callback:function(n,t){var i=u(this,"bottom");s.call(this,t,"bottom",i)}},{key:"borders:left",name:function(){var n=this.getTranslatedPhrase(f.CONTEXTMENU_ITEMS_BORDERS_LEFT),t=u(this,"left");return t&&(n=c(n)),n},callback:function(n,t){var i=u(this,"left");s.call(this,t,"left",i)}},{key:"borders:no_borders",name:function(){return this.getTranslatedPhrase(f.CONTEXTMENU_ITEMS_REMOVE_BORDERS)},callback:function(n,t){s.call(this,t,"noBorders")},disabled:function(){return!u(this)}}]}}))};l.default.getSingleton().add("beforeInit",ft);l.default.getSingleton().add("afterContextMenuDefaultOptions",at);l.default.getSingleton().add("afterInit",function(){var t=this.getSettings().customBorders,n;if(t){for(n=0;n<t.length;n++)t[n].range?st.call(this,t[n]):ot.call(this,t[n].row,t[n].col,t[n]);this.render();this.view.wt.draw(!0)}});t.default=b},function(n,t,i){"use strict";function f(n){return n&&n.__esModule?n:{"default":n}}function v(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function y(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function p(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var u;t.__esModule=!0;var e=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),r=function o(n,t,i){var r,u,f;return n===null&&(n=Function.prototype),r=Object.getOwnPropertyDescriptor(n,t),r===undefined?(u=Object.getPrototypeOf(n),u===null?undefined:o(u,t,i)):"value"in r?r.value:(f=r.get,f===undefined)?undefined:f.call(i)},s=i(7),h=f(s),c=i(9),l=f(c),a=i(6);u=function(n){function t(n){v(this,t);var i=y(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return i.eventManager=new l.default(i),i.boundaries=null,i.callback=null,i.listening=!1,i}return p(t,n),e(t,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().dragToScroll}},{key:"enablePlugin",value:function(){var n=this;this.enabled||(this.addHook("afterOnCellMouseDown",function(){return n.setupListening()}),this.addHook("afterOnCellCornerMouseDown",function(){return n.setupListening()}),this.registerEvents(),r(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin();this.enablePlugin();r(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.unregisterEvents();r(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disablePlugin",this).call(this)}},{key:"setBoundaries",value:function(n){this.boundaries=n}},{key:"setCallback",value:function(n){this.callback=n}},{key:"check",value:function(n,t){var i=0,r=0;t<this.boundaries.top?r=t-this.boundaries.top:t>this.boundaries.bottom&&(r=t-this.boundaries.bottom);n<this.boundaries.left?i=n-this.boundaries.left:n>this.boundaries.right&&(i=n-this.boundaries.right);this.callback(i,r)}},{key:"registerEvents",value:function(){var n=this;this.eventManager.addEventListener(document,"mouseup",function(){return n.onMouseUp()});this.eventManager.addEventListener(document,"mousemove",function(t){return n.onMouseMove(t)})}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"setupListening",value:function(){var n=this.hot.view.wt.wtTable.holder;n!==window&&(this.setBoundaries(n.getBoundingClientRect()),this.setCallback(function(t,i){t<0?n.scrollLeft-=50:t>0&&(n.scrollLeft+=50);i<0?n.scrollTop-=20:i>0&&(n.scrollTop+=20)}),this.listening=!0)}},{key:"onMouseMove",value:function(n){this.listening&&this.check(n.clientX,n.clientY)}},{key:"onMouseUp",value:function(){this.listening=!1}},{key:"destroy",value:function(){r(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}}]),t}(h.default);a.registerPlugin("dragToScroll",u);t.default=u},function(n,t,i){"use strict";function f(n){return n&&n.__esModule?n:{"default":n}}function b(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function k(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function d(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var r,e;t.__esModule=!0;var o=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),u=function s(n,t,i){var r,u,f;return n===null&&(n=Function.prototype),r=Object.getOwnPropertyDescriptor(n,t),r===undefined?(u=Object.getPrototypeOf(n),u===null?undefined:s(u,t,i)):"value"in r?r.value:(f=r.get,f===undefined)?undefined:f.call(i)},h=i(7),c=f(h),l=i(6),a=i(0),v=i(594),y=f(v),p=i(595),w=f(p);i(596);r=new WeakMap;e=function(n){function t(n){b(this,t);var i=k(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return r.set(i,{moveByFreeze:!1,afterFirstUse:!1}),i.frozenColumnsBasePositions=[],i.manualColumnMovePlugin=void 0,i}return d(t,n),o(t,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().manualColumnFreeze}},{key:"enablePlugin",value:function(){var n=this;this.enabled||(this.addHook("afterContextMenuDefaultOptions",function(t){return n.addContextMenuEntry(t)}),this.addHook("afterInit",function(){return n.onAfterInit()}),this.addHook("beforeColumnMove",function(t,i){return n.onBeforeColumnMove(t,i)}),u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var n=r.get(this);n.afterFirstUse=!1;n.moveByFreeze=!1;u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin();this.enablePlugin();u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updatePlugin",this).call(this)}},{key:"freezeColumn",value:function(n){var i=r.get(this),t=this.hot.getSettings();(i.afterFirstUse||(i.afterFirstUse=!0),t.fixedColumnsLeft===this.hot.countCols()||n<=t.fixedColumnsLeft-1)||(i.moveByFreeze=!0,n!==this.getMovePlugin().columnsMapper.getValueByIndex(n)&&(this.frozenColumnsBasePositions[t.fixedColumnsLeft]=n),this.getMovePlugin().moveColumn(n,t.fixedColumnsLeft++))}},{key:"unfreezeColumn",value:function(n){var t=r.get(this),i=this.hot.getSettings(),u;(t.afterFirstUse||(t.afterFirstUse=!0),i.fixedColumnsLeft<=0||n>i.fixedColumnsLeft-1)||(u=this.getBestColumnReturnPosition(n),t.moveByFreeze=!0,i.fixedColumnsLeft--,this.getMovePlugin().moveColumn(n,u+1))}},{key:"getMovePlugin",value:function(){return this.manualColumnMovePlugin||(this.manualColumnMovePlugin=this.hot.getPlugin("manualColumnMove")),this.manualColumnMovePlugin}},{key:"getBestColumnReturnPosition",value:function(n){var r=this.getMovePlugin(),f=this.hot.getSettings(),t=f.fixedColumnsLeft,i=r.columnsMapper.getValueByIndex(t),u=void 0;if(this.frozenColumnsBasePositions[n]===null||this.frozenColumnsBasePositions[n]===void 0)for(u=r.columnsMapper.getValueByIndex(n);i!==null&&i<=u;)t++,i=r.columnsMapper.getValueByIndex(t);else{for(u=this.frozenColumnsBasePositions[n],this.frozenColumnsBasePositions[n]=void 0;i!==null&&i<=u;)t++,i=r.columnsMapper.getValueByIndex(t);t=i}return t-1}},{key:"addContextMenuEntry",value:function(n){n.items.push({name:"---------"},y.default(this),w.default(this))}},{key:"onAfterInit",value:function(){this.getMovePlugin().isEnabled()||this.getMovePlugin().enablePlugin()}},{key:"onBeforeColumnMove",value:function(n,t){var i=r.get(this),f,u;if(i.afterFirstUse&&!i.moveByFreeze&&(f=this.hot.getSettings().fixedColumnsLeft,u=t<f,u||a.arrayEach(n,function(n){if(n<f)return u=!0,!1}),u))return!1;i.moveByFreeze&&(i.moveByFreeze=!1)}},{key:"destroy",value:function(){u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}}]),t}(c.default);l.registerPlugin("manualColumnFreeze",e);t.default=e},function(n,t,i){"use strict";function e(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function o(n){return{key:"freeze_column",name:function(){return this.getTranslatedPhrase(f.CONTEXTMENU_ITEMS_FREEZE_COLUMN)},callback:function(t,i){var u=r(i,1),f=u[0].start.col;n.freezeColumn(f);this.render();this.view.wt.wtOverlays.adjustElementsSize(!0)},hidden:function(){var n=this.getSelectedRange(),t=!1;return n===void 0?t=!0:n.length>1?t=!0:(n[0].from.col!==n[0].to.col||n[0].from.col<=this.getSettings().fixedColumnsLeft-1)&&(t=!0),t}}}var r,u,f;t.__esModule=!0;r=function(){function n(n,t){var r=[],u=!0,f=!1,e=undefined,i,o;try{for(i=n[Symbol.iterator]();!(u=(o=i.next()).done);u=!0)if(r.push(o.value),t&&r.length===t)break}catch(s){f=!0;e=s}finally{try{!u&&i["return"]&&i["return"]()}finally{if(f)throw e;}}return r}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return n(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance");}}();t.default=o;u=i(3);f=e(u)},function(n,t,i){"use strict";function e(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function o(n){return{key:"unfreeze_column",name:function(){return this.getTranslatedPhrase(f.CONTEXTMENU_ITEMS_UNFREEZE_COLUMN)},callback:function(t,i){var u=r(i,1),f=u[0].start.col;n.unfreezeColumn(f);this.render();this.view.wt.wtOverlays.adjustElementsSize(!0)},hidden:function(){var n=this.getSelectedRange(),t=!1;return n===void 0?t=!0:n.length>1?t=!0:(n[0].from.col!==n[0].to.col||n[0].from.col>=this.getSettings().fixedColumnsLeft)&&(t=!0),t}}}var r,u,f;t.__esModule=!0;r=function(){function n(n,t){var r=[],u=!0,f=!1,e=undefined,i,o;try{for(i=n[Symbol.iterator]();!(u=(o=i.next()).done);u=!0)if(r.push(o.value),t&&r.length===t)break}catch(s){f=!0;e=s}finally{try{!u&&i["return"]&&i["return"]()}finally{if(f)throw e;}}return r}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return n(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance");}}();t.default=o;u=i(3);f=e(u)},function(){},function(n,t,i){"use strict";function f(n){return n&&n.__esModule?n:{"default":n}}function st(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function ht(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function ct(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}t.__esModule=!0;var p=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),e=function w(n,t,i){var r,u,f;return n===null&&(n=Function.prototype),r=Object.getOwnPropertyDescriptor(n,t),r===undefined?(u=Object.getPrototypeOf(n),u===null?undefined:w(u,t,i)):"value"in r?r.value:(f=r.get,f===undefined)?undefined:f.call(i)},b=i(7),k=f(b),d=i(14),s=f(d),h=i(0),r=i(2),a=i(4),g=i(9),nt=f(g),tt=i(6),it=i(598),rt=f(it),ut=i(599),ft=f(ut),et=i(600),ot=f(et),lt=i(8);i(601);s.default.getSingleton().register("beforeColumnMove");s.default.getSingleton().register("afterColumnMove");s.default.getSingleton().register("unmodifyCol");var u=new WeakMap,v="ht__manualColumnMove",o="show-ui",c="on-moving--columns",l="after-selection--columns",y=function(n){function t(n){st(this,t);var i=ht(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return u.set(i,{columnsToMove:[],countCols:0,fixedColumns:0,pressed:void 0,disallowMoving:void 0,target:{eventPageX:void 0,coords:void 0,TD:void 0,col:void 0}}),i.removedColumns=[],i.columnsMapper=new rt.default(i),i.eventManager=new nt.default(i),i.backlight=new ft.default(n),i.guideline=new ot.default(n),i}return ct(t,n),p(t,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().manualColumnMove}},{key:"enablePlugin",value:function(){var n=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(t,i,r,u){return n.onBeforeOnCellMouseDown(t,i,r,u)}),this.addHook("beforeOnCellMouseOver",function(t,i,r,u){return n.onBeforeOnCellMouseOver(t,i,r,u)}),this.addHook("afterScrollVertically",function(){return n.onAfterScrollVertically()}),this.addHook("modifyCol",function(t,i){return n.onModifyCol(t,i)}),this.addHook("beforeRemoveCol",function(t,i){return n.onBeforeRemoveCol(t,i)}),this.addHook("afterRemoveCol",function(){return n.onAfterRemoveCol()}),this.addHook("afterCreateCol",function(t,i){return n.onAfterCreateCol(t,i)}),this.addHook("afterLoadData",function(){return n.onAfterLoadData()}),this.addHook("unmodifyCol",function(t){return n.onUnmodifyCol(t)}),this.registerEvents(),r.addClass(this.hot.rootElement,v),e(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin();this.enablePlugin();this.onAfterPluginsInitialized();e(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var n=this.hot.getSettings().manualColumnMove;Array.isArray(n)&&this.columnsMapper.clearMap();r.removeClass(this.hot.rootElement,v);this.unregisterEvents();this.backlight.destroy();this.guideline.destroy();e(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disablePlugin",this).call(this)}},{key:"moveColumn",value:function(n,t){this.moveColumns([n],t)}},{key:"moveColumns",value:function(n,t){var i=this,f=u.get(this),r=this.hot.runHooks("beforeColumnMove",n,t);f.disallowMoving=!r;r!==!1&&(h.arrayEach(n,function(n,t,r){r[t]=i.columnsMapper.getValueByIndex(n)}),h.arrayEach(n,function(n,r){var u=i.columnsMapper.getIndexByValue(n);u!==t&&i.columnsMapper.moveColumn(u,t+r)}),this.columnsMapper.clearNull());this.hot.runHooks("afterColumnMove",n,t)}},{key:"changeSelection",value:function(n,t){this.hot.selectColumns(n,t)}},{key:"getColumnsWidth",value:function(n,t){for(var r,u=0,i=n;i<t;i++)r=0,r=i<0?this.hot.view.wt.wtViewport.getRowHeaderWidth()||0:this.hot.view.wt.wtTable.getStretchedColumnWidth(i)||0,u+=r;return u}},{key:"initialSettings",value:function(){var n=this.hot.getSettings().manualColumnMove;Array.isArray(n)?this.moveColumns(n,0):n!==void 0&&this.persistentStateLoad()}},{key:"isFixedColumnsLeft",value:function(n){return n<this.hot.getSettings().fixedColumnsLeft}},{key:"persistentStateSave",value:function(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.columnsMapper._arrayMap)}},{key:"persistentStateLoad",value:function(){var n={};this.hot.runHooks("persistentStateLoad","manualColumnMove",n);n.value&&(this.columnsMapper._arrayMap=n.value)}},{key:"prepareColumnsToMoving",value:function(n,t){var i=[];return a.rangeEach(n,t,function(n){i.push(n)}),i}},{key:"refreshPositions",value:function(){var n=u.get(this),t=this.hot.view.wt.wtTable.getFirstVisibleColumn(),v=this.hot.view.wt.wtTable.getLastVisibleColumn(),l=this.hot.view.wt.wtTable,i=this.hot.view.wt.wtOverlays.scrollableElement,a=typeof i.scrollX=="number"?i.scrollX:i.scrollLeft,r=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,n.coordsColumn),e=n.target.eventPageX-(n.rootElementOffset-(i.scrollX===void 0?a:0)),o=l.hider.offsetWidth,y=l.TBODY.offsetLeft,s=this.backlight.getOffset().left,p=this.backlight.getSize().width,h=0,w,c,f;n.rootElementOffset+l.holder.offsetWidth+a<n.target.eventPageX&&n.coordsColumn<n.countCols&&n.coordsColumn++;n.hasRowHeaders&&(h=this.hot.view.wt.wtOverlays.leftOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth);this.isFixedColumnsLeft(n.coordsColumn)&&(r+=a);r+=h;n.coordsColumn<0?n.target.col=n.fixedColumns>0?0:t>0?t-1:t:n.target.TD.offsetWidth/2+r<=e?(w=n.coordsColumn>=n.countCols?n.countCols-1:n.coordsColumn,n.target.col=w+1,r+=n.target.TD.offsetWidth,n.target.col>v&&this.hot.scrollViewportTo(void 0,v+1,void 0,!0)):(n.target.col=n.coordsColumn,n.target.col<=t&&n.target.col>=n.fixedColumns&&this.hot.scrollViewportTo(void 0,t-1));n.target.col<=t&&n.target.col>=n.fixedColumns&&this.hot.scrollViewportTo(void 0,t-1);c=e;f=r;e+p+s>=o?c=o-p-s:e+s<y+h&&(c=y+h+Math.abs(s));r>=o-1?f=o-1:f===0?f=1:i.scrollX!==void 0&&n.coordsColumn<n.fixedColumns&&(f-=n.rootElementOffset<=i.scrollX?n.rootElementOffset:0);this.backlight.setPosition(null,c);this.guideline.setPosition(null,f)}},{key:"updateColumnsMapper",value:function(){var n=this.hot.countSourceCols(),t=this.columnsMapper._arrayMap.length,r,u,i;t===0?this.columnsMapper.createMap(n||this.hot.getSettings().startCols):t<n?(r=n-t,this.columnsMapper.insertItems(t,r)):t>n&&(u=n-1,i=[],h.arrayEach(this.columnsMapper._arrayMap,function(n,t){n>u&&i.push(t)}),this.columnsMapper.removeItems(i))}},{key:"registerEvents",value:function(){var n=this;this.eventManager.addEventListener(document.documentElement,"mousemove",function(t){return n.onMouseMove(t)});this.eventManager.addEventListener(document.documentElement,"mouseup",function(){return n.onMouseUp()})}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"onBeforeOnCellMouseDown",value:function(n,t,i,f){var s=this.hot.view.wt.wtTable,nt=this.hot.selection.selectedHeader.cols,a=this.hot.getSelectedRangeLast(),e=u.get(this),tt=n.realTarget.className.indexOf("columnSorting")>-1,y,p;if(!a||!nt||e.pressed||n.button!==0||tt){e.pressed=!1;e.columnsToMove.length=0;r.removeClass(this.hot.rootElement,[c,o]);return}y=this.guideline.isBuilt()&&!this.guideline.isAppended();p=this.backlight.isBuilt()&&!this.backlight.isAppended();y&&p&&(this.guideline.appendTo(s.hider),this.backlight.appendTo(s.hider));var w=a.from,b=a.to,h=Math.min(w.col,b.col),v=Math.max(w.col,b.col);if(t.row<0&&t.col>=h&&t.col<=v){f.column=!0;e.pressed=!0;e.target.eventPageX=n.pageX;e.coordsColumn=t.col;e.target.TD=i;e.target.col=t.col;e.columnsToMove=this.prepareColumnsToMoving(h,v);e.hasRowHeaders=!!this.hot.getSettings().rowHeaders;e.countCols=this.hot.countCols();e.fixedColumns=this.hot.getSettings().fixedColumnsLeft;e.rootElementOffset=r.offset(this.hot.rootElement).left;var it=e.hasRowHeaders?-1:0,k=s.holder.scrollTop+s.getColumnHeaderHeight(0)+1,rt=t.col<e.fixedColumns,d=this.hot.view.wt.wtOverlays.scrollableElement,ut=d.scrollX?d.scrollX-e.rootElementOffset:0,ft=n.layerX-(rt?ut:0),g=Math.abs(this.getColumnsWidth(h,t.col)+ft);this.backlight.setPosition(k,this.getColumnsWidth(it,h)+g);this.backlight.setSize(this.getColumnsWidth(h,v+1),s.hider.offsetHeight-k);this.backlight.setOffset(null,g*-1);r.addClass(this.hot.rootElement,c)}else r.removeClass(this.hot.rootElement,l),e.pressed=!1,e.columnsToMove.length=0}},{key:"onMouseMove",value:function(n){var t=u.get(this),i;t.pressed&&(n.realTarget===this.backlight.element&&(i=this.backlight.getSize().width,this.backlight.setSize(0),setTimeout(function(){this.backlight.setPosition(i)})),t.target.eventPageX=n.pageX,this.refreshPositions())}},{key:"onBeforeOnCellMouseOver",value:function(n,t,i,f){var s=this.hot.getSelectedRangeLast(),e=u.get(this);s&&e.pressed&&(e.columnsToMove.indexOf(t.col)>-1?r.removeClass(this.hot.rootElement,o):r.addClass(this.hot.rootElement,o),f.row=!0,f.column=!0,f.cell=!0,e.coordsColumn=t.col,e.target.TD=i)}},{key:"onMouseUp",value:function(){var n=u.get(this),t,i;(n.coordsColumn=void 0,n.pressed=!1,n.backlightWidth=0,r.removeClass(this.hot.rootElement,[c,o,l]),this.hot.selection.selectedHeader.cols&&r.addClass(this.hot.rootElement,l),n.columnsToMove.length<1||n.target.col===void 0||n.columnsToMove.indexOf(n.target.col)>-1)||(this.moveColumns(n.columnsToMove,n.target.col),this.persistentStateSave(),this.hot.render(),this.hot.view.wt.wtOverlays.adjustElementsSize(!0),n.disallowMoving||(t=this.columnsMapper.getIndexByValue(n.columnsToMove[0]),i=this.columnsMapper.getIndexByValue(n.columnsToMove[n.columnsToMove.length-1]),this.changeSelection(t,i)),n.columnsToMove.length=0)}},{key:"onAfterScrollVertically",value:function(){var n=this.hot.view.wt.wtTable,i=n.getColumnHeaderHeight(0)+1,r=n.holder.scrollTop,t=i+r;this.backlight.setPosition(t);this.backlight.setSize(null,n.hider.offsetHeight-t)}},{key:"onAfterCreateCol",value:function(n,t){this.columnsMapper.shiftItems(n,t)}},{key:"onBeforeRemoveCol",value:function(n,t){var i=this;this.removedColumns.length=0;n!==!1&&a.rangeEach(n,n+t-1,function(n){i.removedColumns.push(i.hot.runHooks("modifyCol",n,i.pluginName))})}},{key:"onAfterRemoveCol",value:function(){this.columnsMapper.unshiftItems(this.removedColumns)}},{key:"onAfterLoadData",value:function(){this.updateColumnsMapper()}},{key:"onModifyCol",value:function(n,t){if(t!==this.pluginName){var i=this.columnsMapper.getValueByIndex(n);n=i===null?n:i}return n}},{key:"onUnmodifyCol",value:function(n){var t=this.columnsMapper.getIndexByValue(n);return t===null?n:t}},{key:"onAfterPluginsInitialized",value:function(){this.updateColumnsMapper();this.initialSettings();this.backlight.build();this.guideline.build()}},{key:"destroy",value:function(){this.backlight.destroy();this.guideline.destroy();e(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}}]),t}(k.default);tt.registerPlugin("ManualColumnMove",y);t.default=y},function(n,t,i){"use strict";function c(n){return n&&n.__esModule?n:{"default":n}}function l(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var r;t.__esModule=!0;var u=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),f=i(54),e=c(f),o=i(0),s=i(1),h=i(4);r=function(){function n(t){l(this,n);this.manualColumnMove=t}return u(n,[{key:"createMap",value:function(n){var t=this,i=n===void 0?this._arrayMap.length:n;this._arrayMap.length=0;h.rangeEach(i-1,function(n){t._arrayMap[n]=n})}},{key:"destroy",value:function(){this._arrayMap=null}},{key:"moveColumn",value:function(n,t){var i=this._arrayMap[n];this._arrayMap[n]=null;this._arrayMap.splice(t,0,i)}},{key:"clearNull",value:function(){this._arrayMap=o.arrayFilter(this._arrayMap,function(n){return n!==null})}}]),n}();s.mixin(r,e.default);t.default=r},function(n,t,i){"use strict";function l(n){return n&&n.__esModule?n:{"default":n}}function a(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function v(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function y(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var r,u;t.__esModule=!0;var f=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),e=function o(n,t,i){var r,u,f;return n===null&&(n=Function.prototype),r=Object.getOwnPropertyDescriptor(n,t),r===undefined?(u=Object.getPrototypeOf(n),u===null?undefined:o(u,t,i)):"value"in r?r.value:(f=r.get,f===undefined)?undefined:f.call(i)},s=i(458),h=l(s),c=i(2);r="ht__manualColumnMove--backlight";u=function(n){function t(){return a(this,t),v(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return y(t,n),f(t,[{key:"build",value:function(){e(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"build",this).call(this);c.addClass(this._element,r)}}]),t}(h.default);t.default=u},function(n,t,i){"use strict";function l(n){return n&&n.__esModule?n:{"default":n}}function a(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function v(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function y(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var r,u;t.__esModule=!0;var f=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),e=function o(n,t,i){var r,u,f;return n===null&&(n=Function.prototype),r=Object.getOwnPropertyDescriptor(n,t),r===undefined?(u=Object.getPrototypeOf(n),u===null?undefined:o(u,t,i)):"value"in r?r.value:(f=r.get,f===undefined)?undefined:f.call(i)},s=i(458),h=l(s),c=i(2);r="ht__manualColumnMove--guideline";u=function(n){function t(){return a(this,t),v(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return y(t,n),f(t,[{key:"build",value:function(){e(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"build",this).call(this);c.addClass(this._element,r)}}]),t}(h.default);t.default=u},function(){},function(n,t,i){"use strict";function s(n){return n&&n.__esModule?n:{"default":n}}function b(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function k(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function d(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var f;t.__esModule=!0;var h=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),e=function c(n,t,i){var r,u,f;return n===null&&(n=Function.prototype),r=Object.getOwnPropertyDescriptor(n,t),r===undefined?(u=Object.getPrototypeOf(n),u===null?undefined:c(u,t,i)):"value"in r?r.value:(f=r.get,f===undefined)?undefined:f.call(i)},l=i(7),a=s(l),r=i(2),v=i(9),y=s(v),o=i(11),u=i(0),p=i(4),w=i(6);f=function(n){function t(n){b(this,t);var i=k(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return i.currentTH=null,i.currentCol=null,i.selectedCols=[],i.currentWidth=null,i.newSize=null,i.startY=null,i.startWidth=null,i.startOffset=null,i.handle=document.createElement("DIV"),i.guide=document.createElement("DIV"),i.eventManager=new y.default(i),i.pressed=null,i.dblclick=0,i.autoresizeTimeout=null,i.manualColumnWidths=[],r.addClass(i.handle,"manualColumnResizer"),r.addClass(i.guide,"manualColumnResizerGuide"),i}return d(t,n),h(t,[{key:"isEnabled",value:function(){return this.hot.getSettings().manualColumnResize}},{key:"enablePlugin",value:function(){var n=this,i,r;this.enabled||(this.manualColumnWidths=[],i=this.hot.getSettings().manualColumnResize,r=this.loadManualColumnWidths(),this.addHook("modifyColWidth",function(t,i){return n.onModifyColWidth(t,i)}),this.addHook("beforeStretchingColumnWidth",function(t,i){return n.onBeforeStretchingColumnWidth(t,i)}),this.addHook("beforeColumnResize",function(t,i,r){return n.onBeforeColumnResize(t,i,r)}),this.manualColumnWidths=typeof r!="undefined"?r:Array.isArray(i)?i:[],this.bindEvents(),e(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){var n=this.hot.getSettings().manualColumnResize;Array.isArray(n)?this.manualColumnWidths=n:n||(this.manualColumnWidths=[])}},{key:"disablePlugin",value:function(){e(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disablePlugin",this).call(this)}},{key:"saveManualColumnWidths",value:function(){this.hot.runHooks("persistentStateSave","manualColumnWidths",this.manualColumnWidths)}},{key:"loadManualColumnWidths",value:function(){var n={};return this.hot.runHooks("persistentStateLoad","manualColumnWidths",n),n.value}},{key:"setupHandlePosition",value:function(n){var c=this,f,e,t;if(!n.parentNode)return!1;if(this.currentTH=n,f=this.hot.view.wt.wtTable.getCoords(n).col,e=r.outerHeight(this.currentTH),f>=0){if(t=this.currentTH.getBoundingClientRect(),this.currentCol=f,this.selectedCols=[],this.hot.selection.isSelected()&&this.hot.selection.selectedHeader.cols){var o=this.hot.getSelectedRangeLast(),s=o.from,h=o.to,i=s.col,u=h.col;i>=u&&(i=h.col,u=s.col);this.currentCol>=i&&this.currentCol<=u?p.rangeEach(i,u,function(n){return c.selectedCols.push(n)}):this.selectedCols.push(this.currentCol)}else this.selectedCols.push(this.currentCol);this.startOffset=t.left-6;this.startWidth=parseInt(t.width,10);this.handle.style.top=t.top+"px";this.handle.style.left=this.startOffset+this.startWidth+"px";this.handle.style.height=e+"px";this.hot.rootElement.appendChild(this.handle)}}},{key:"refreshHandlePosition",value:function(){this.handle.style.left=this.startOffset+this.currentWidth+"px"}},{key:"setupGuidePosition",value:function(){var n=parseInt(r.outerHeight(this.handle),10),t=parseInt(this.handle.style.top,10)+n,i=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);r.addClass(this.handle,"active");r.addClass(this.guide,"active");this.guide.style.top=t+"px";this.guide.style.left=this.handle.style.left;this.guide.style.height=i-n+"px";this.hot.rootElement.appendChild(this.guide)}},{key:"refreshGuidePosition",value:function(){this.guide.style.left=this.handle.style.left}},{key:"hideHandleAndGuide",value:function(){r.removeClass(this.handle,"active");r.removeClass(this.guide,"active")}},{key:"checkIfColumnHeader",value:function(n){if(n!=this.hot.rootElement){var t=n.parentNode;return t.tagName==="THEAD"?!0:this.checkIfColumnHeader(t)}return!1}},{key:"getTHFromTargetElement",value:function(n){return n.tagName!="TABLE"?n.tagName=="TH"?n:this.getTHFromTargetElement(n.parentNode):null}},{key:"onMouseOver",value:function(n){var t,i;if(this.checkIfColumnHeader(n.target)){if(t=this.getTHFromTargetElement(n.target),!t)return;i=t.getAttribute("colspan");t&&(i===null||i===1)&&(this.pressed||this.setupHandlePosition(t))}}},{key:"afterMouseDownTimeout",value:function(){var n=this,t=function(){n.hot.forceFullRender=!0;n.hot.view.render();n.hot.view.wt.wtOverlays.adjustElementsSize(!0)},i=function(i,r){var u=n.hot.runHooks("beforeColumnResize",i,n.newSize,!0);u!==void 0&&(n.newSize=u);n.hot.getSettings().stretchH==="all"?n.clearManualSize(i):n.setManualSize(i,n.newSize);r&&t();n.saveManualColumnWidths();n.hot.runHooks("afterColumnResize",i,n.newSize,!0)},r;this.dblclick>=2&&(r=this.selectedCols.length,r>1?(u.arrayEach(this.selectedCols,function(n){i(n)}),t()):u.arrayEach(this.selectedCols,function(n){i(n,!0)}));this.dblclick=0;this.autoresizeTimeout=null}},{key:"onMouseDown",value:function(n){var t=this;r.hasClass(n.target,"manualColumnResizer")&&(this.setupGuidePosition(),this.pressed=this.hot,this.autoresizeTimeout===null&&(this.autoresizeTimeout=setTimeout(function(){return t.afterMouseDownTimeout()},500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick++,this.startX=o.pageX(n),this.newSize=this.startWidth)}},{key:"onMouseMove",value:function(n){var t=this;this.pressed&&(this.currentWidth=this.startWidth+(o.pageX(n)-this.startX),u.arrayEach(this.selectedCols,function(n){t.newSize=t.setManualSize(n,t.currentWidth)}),this.refreshHandlePosition(),this.refreshGuidePosition())}},{key:"onMouseUp",value:function(){var n=this,t=function(){n.hot.forceFullRender=!0;n.hot.view.render();n.hot.view.wt.wtOverlays.adjustElementsSize(!0)},i=function(i,r){n.hot.runHooks("beforeColumnResize",i,n.newSize);r&&t();n.saveManualColumnWidths();n.hot.runHooks("afterColumnResize",i,n.newSize)},r;this.pressed&&(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!=this.startWidth&&(r=this.selectedCols.length,r>1?(u.arrayEach(this.selectedCols,function(n){i(n)}),t()):u.arrayEach(this.selectedCols,function(n){i(n,!0)})),this.setupHandlePosition(this.currentTH))}},{key:"bindEvents",value:function(){var n=this;this.eventManager.addEventListener(this.hot.rootElement,"mouseover",function(t){return n.onMouseOver(t)});this.eventManager.addEventListener(this.hot.rootElement,"mousedown",function(t){return n.onMouseDown(t)});this.eventManager.addEventListener(window,"mousemove",function(t){return n.onMouseMove(t)});this.eventManager.addEventListener(window,"mouseup",function(t){return n.onMouseUp(t)})}},{key:"setManualSize",value:function(n,t){return t=Math.max(t,20),n=this.hot.runHooks("modifyCol",n),this.manualColumnWidths[n]=t,t}},{key:"clearManualSize",value:function(n){n=this.hot.runHooks("modifyCol",n);this.manualColumnWidths[n]=void 0}},{key:"onModifyColWidth",value:function(n,t){return this.enabled&&(t=this.hot.runHooks("modifyCol",t),this.hot.getSettings().manualColumnResize&&this.manualColumnWidths[t])?this.manualColumnWidths[t]:n}},{key:"onBeforeStretchingColumnWidth",value:function(n,t){var i=this.manualColumnWidths[t];return i===void 0&&(i=n),i}},{key:"onBeforeColumnResize",value:function(){this.hot.view.wt.wtViewport.hasOversizedColumnHeadersMarked={}}}]),t}(a.default);w.registerPlugin("manualColumnResize",f);t.default=f},function(n,t,i){"use strict";function f(n){return n&&n.__esModule?n:{"default":n}}function st(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function ht(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function ct(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}t.__esModule=!0;var p=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),e=function w(n,t,i){var r,u,f;return n===null&&(n=Function.prototype),r=Object.getOwnPropertyDescriptor(n,t),r===undefined?(u=Object.getPrototypeOf(n),u===null?undefined:w(u,t,i)):"value"in r?r.value:(f=r.get,f===undefined)?undefined:f.call(i)},b=i(7),k=f(b),d=i(14),s=f(d),h=i(0),r=i(2),a=i(4),g=i(9),nt=f(g),tt=i(6),it=i(604),rt=f(it),ut=i(605),ft=f(ut),et=i(606),ot=f(et),lt=i(8);i(607);s.default.getSingleton().register("beforeRowMove");s.default.getSingleton().register("afterRowMove");s.default.getSingleton().register("unmodifyRow");var u=new WeakMap,v="ht__manualRowMove",o="show-ui",c="on-moving--rows",l="after-selection--rows",y=function(n){function t(n){st(this,t);var i=ht(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return u.set(i,{rowsToMove:[],pressed:void 0,disallowMoving:void 0,target:{eventPageY:void 0,coords:void 0,TD:void 0,row:void 0}}),i.removedRows=[],i.rowsMapper=new rt.default(i),i.eventManager=new nt.default(i),i.backlight=new ft.default(n),i.guideline=new ot.default(n),i}return ct(t,n),p(t,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().manualRowMove}},{key:"enablePlugin",value:function(){var n=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(t,i,r,u){return n.onBeforeOnCellMouseDown(t,i,r,u)}),this.addHook("beforeOnCellMouseOver",function(t,i,r,u){return n.onBeforeOnCellMouseOver(t,i,r,u)}),this.addHook("afterScrollHorizontally",function(){return n.onAfterScrollHorizontally()}),this.addHook("modifyRow",function(t,i){return n.onModifyRow(t,i)}),this.addHook("beforeRemoveRow",function(t,i){return n.onBeforeRemoveRow(t,i)}),this.addHook("afterRemoveRow",function(){return n.onAfterRemoveRow()}),this.addHook("afterCreateRow",function(t,i){return n.onAfterCreateRow(t,i)}),this.addHook("afterLoadData",function(){return n.onAfterLoadData()}),this.addHook("beforeColumnSort",function(t,i){return n.onBeforeColumnSort(t,i)}),this.addHook("unmodifyRow",function(t){return n.onUnmodifyRow(t)}),this.registerEvents(),r.addClass(this.hot.rootElement,v),e(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin();this.enablePlugin();this.onAfterPluginsInitialized();e(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var n=this.hot.getSettings().manualRowMove;Array.isArray(n)&&this.rowsMapper.clearMap();r.removeClass(this.hot.rootElement,v);this.unregisterEvents();this.backlight.destroy();this.guideline.destroy();e(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disablePlugin",this).call(this)}},{key:"moveRow",value:function(n,t){this.moveRows([n],t)}},{key:"moveRows",value:function(n,t){var i=this,r=u.get(this),f=this.hot.runHooks("beforeRowMove",n,t);r.disallowMoving=f===!1;r.disallowMoving||(h.arrayEach(n,function(n,t,r){r[t]=i.rowsMapper.getValueByIndex(n)}),h.arrayEach(n,function(n,r){var u=i.rowsMapper.getIndexByValue(n);u!==t&&i.rowsMapper.moveRow(u,t+r)}),this.rowsMapper.clearNull());this.hot.runHooks("afterRowMove",n,t)}},{key:"changeSelection",value:function(n,t){this.hot.selectRows(n,t)}},{key:"getRowsHeight",value:function(n,t){for(var u,r=0,i=n;i<t;i++)u=this.hot.view.wt.wtTable.getRowHeight(i)||23,r+=u;return r}},{key:"initialSettings",value:function(){var n=this.hot.getSettings().manualRowMove,t;Array.isArray(n)?this.moveRows(n,0):n!==void 0&&(t=this.persistentStateLoad(),t.length&&this.moveRows(t,0))}},{key:"isFixedRowTop",value:function(n){return n<this.hot.getSettings().fixedRowsTop}},{key:"isFixedRowBottom",value:function(n){return n>this.hot.getSettings().fixedRowsBottom}},{key:"persistentStateSave",value:function(){this.hot.runHooks("persistentStateSave","manualRowMove",this.rowsMapper._arrayMap)}},{key:"persistentStateLoad",value:function(){var n={};return this.hot.runHooks("persistentStateLoad","manualRowMove",n),n.value?n.value:[]}},{key:"prepareRowsToMoving",value:function(){var n=this.hot.getSelectedRangeLast(),t=[];if(!n)return t;var i=n.from,r=n.to,u=Math.min(i.row,r.row),f=Math.max(i.row,r.row);return a.rangeEach(u,f,function(n){t.push(n)}),t}},{key:"refreshPositions",value:function(){var t=u.get(this),n=t.target.coords,i=this.hot.view.wt.wtTable.getFirstVisibleRow(),a=this.hot.view.wt.wtTable.getLastVisibleRow(),p=this.hot.getSettings().fixedRowsTop,k=this.hot.countRows(),c,l,y;n.row<p&&i>0&&this.hot.scrollViewportTo(i-1);n.row>=a&&a<k&&this.hot.scrollViewportTo(a+1,undefined,!0);var f=this.hot.view.wt.wtTable,v=t.target.TD,d=r.offset(this.hot.rootElement),e=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,n.row),o=t.target.eventPageY-d.top+f.holder.scrollTop,s=f.hider.offsetHeight,w=f.TBODY.offsetTop,h=this.backlight.getOffset().top,b=this.backlight.getSize().height;this.isFixedRowTop(n.row)&&(e+=f.holder.scrollTop);n.row<0?t.target.row=i>0?i-1:i:v.offsetHeight/2+e<=o?(t.target.row=n.row+1,e+=n.row===0?v.offsetHeight-1:v.offsetHeight):t.target.row=n.row;c=o;l=e;o+b+h>=s?c=s-b-h:o+h<w&&(c=w+Math.abs(h));e>=s-1&&(l=s-1);y=0;this.hot.view.wt.wtOverlays.topOverlay&&(y=this.hot.view.wt.wtOverlays.topOverlay.clone.wtTable.TABLE.offsetHeight);n.row>=p&&l-f.holder.scrollTop<y&&this.hot.scrollViewportTo(n.row);this.backlight.setPosition(c);this.guideline.setPosition(l)}},{key:"updateRowsMapper",value:function(){var n=this.hot.countSourceRows(),t=this.rowsMapper._arrayMap.length,r,u,i;t===0?this.rowsMapper.createMap(n||this.hot.getSettings().startRows):t<n?(r=n-t,this.rowsMapper.insertItems(t,r)):t>n&&(u=n-1,i=[],h.arrayEach(this.rowsMapper._arrayMap,function(n,t){n>u&&i.push(t)}),this.rowsMapper.removeItems(i))}},{key:"registerEvents",value:function(){var n=this;this.eventManager.addEventListener(document.documentElement,"mousemove",function(t){return n.onMouseMove(t)});this.eventManager.addEventListener(document.documentElement,"mouseup",function(){return n.onMouseUp()})}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"onBeforeColumnSort",value:function(n,t){var i=u.get(this);i.disallowMoving=t!==void 0}},{key:"onBeforeOnCellMouseDown",value:function(n,t,i,f){var s=this.hot.view.wt.wtTable,d=this.hot.selection.selectedHeader.rows,h=this.hot.getSelectedRangeLast(),e=u.get(this),y,p,v;if(!h||!d||e.pressed||n.button!==0){e.pressed=!1;e.rowsToMove.length=0;r.removeClass(this.hot.rootElement,[c,o]);return}y=this.guideline.isBuilt()&&!this.guideline.isAppended();p=this.backlight.isBuilt()&&!this.backlight.isAppended();y&&p&&(this.guideline.appendTo(s.hider),this.backlight.appendTo(s.hider));var w=h.from,b=h.to,a=Math.min(w.row,b.row),k=Math.max(w.row,b.row);t.col<0&&t.row>=a&&t.row<=k?(f.row=!0,e.pressed=!0,e.target.eventPageY=n.pageY,e.target.coords=t,e.target.TD=i,e.rowsToMove=this.prepareRowsToMoving(),v=s.holder.scrollLeft+this.hot.view.wt.wtViewport.getRowHeaderWidth(),this.backlight.setPosition(null,v),this.backlight.setSize(s.hider.offsetWidth-v,this.getRowsHeight(a,k+1)),this.backlight.setOffset((this.getRowsHeight(a,t.row)+n.layerY)*-1,null),r.addClass(this.hot.rootElement,c),this.refreshPositions()):(r.removeClass(this.hot.rootElement,l),e.pressed=!1,e.rowsToMove.length=0)}},{key:"onMouseMove",value:function(n){var t=u.get(this),i;t.pressed&&(n.realTarget===this.backlight.element&&(i=this.backlight.getSize().height,this.backlight.setSize(null,0),setTimeout(function(){this.backlight.setPosition(null,i)})),t.target.eventPageY=n.pageY,this.refreshPositions())}},{key:"onBeforeOnCellMouseOver",value:function(n,t,i,f){var s=this.hot.getSelectedRangeLast(),e=u.get(this);s&&e.pressed&&(e.rowsToMove.indexOf(t.row)>-1?r.removeClass(this.hot.rootElement,o):r.addClass(this.hot.rootElement,o),f.row=!0,f.column=!0,f.cell=!0,e.target.coords=t,e.target.TD=i)}},{key:"onMouseUp",value:function(){var n=u.get(this),t=n.target.row,i=n.rowsToMove.length,f,e;(n.pressed=!1,n.backlightHeight=0,r.removeClass(this.hot.rootElement,[c,o,l]),this.hot.selection.selectedHeader.rows&&r.addClass(this.hot.rootElement,l),i<1||t===void 0||n.rowsToMove.indexOf(t)>-1||n.rowsToMove[i-1]===t-1)||(this.moveRows(n.rowsToMove,t),this.persistentStateSave(),this.hot.render(),n.disallowMoving||(f=this.rowsMapper.getIndexByValue(n.rowsToMove[0]),e=this.rowsMapper.getIndexByValue(n.rowsToMove[i-1]),this.changeSelection(f,e)),n.rowsToMove.length=0)}},{key:"onAfterScrollHorizontally",value:function(){var n=this.hot.view.wt.wtTable,i=this.hot.view.wt.wtViewport.getRowHeaderWidth(),r=n.holder.scrollLeft,t=i+r;this.backlight.setPosition(null,t);this.backlight.setSize(n.hider.offsetWidth-t)}},{key:"onAfterCreateRow",value:function(n,t){this.rowsMapper.shiftItems(n,t)}},{key:"onBeforeRemoveRow",value:function(n,t){var i=this;this.removedRows.length=0;n!==!1&&a.rangeEach(n,n+t-1,function(n){i.removedRows.push(i.hot.runHooks("modifyRow",n,i.pluginName))})}},{key:"onAfterRemoveRow",value:function(){this.rowsMapper.unshiftItems(this.removedRows)}},{key:"onAfterLoadData",value:function(){this.updateRowsMapper()}},{key:"onModifyRow",value:function(n,t){if(t!==this.pluginName){var i=this.rowsMapper.getValueByIndex(n);n=i===null?n:i}return n}},{key:"onUnmodifyRow",value:function(n){var t=this.rowsMapper.getIndexByValue(n);return t===null?n:t}},{key:"onAfterPluginsInitialized",value:function(){this.updateRowsMapper();this.initialSettings();this.backlight.build();this.guideline.build()}},{key:"destroy",value:function(){this.backlight.destroy();this.guideline.destroy();e(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}}]),t}(k.default);tt.registerPlugin("ManualRowMove",y);t.default=y},function(n,t,i){"use strict";function c(n){return n&&n.__esModule?n:{"default":n}}function l(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var r;t.__esModule=!0;var u=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),f=i(54),e=c(f),o=i(0),s=i(1),h=i(4);r=function(){function n(t){l(this,n);this.manualRowMove=t}return u(n,[{key:"createMap",value:function(n){var t=this,i=n===void 0?this._arrayMap.length:n;this._arrayMap.length=0;h.rangeEach(i-1,function(n){t._arrayMap[n]=n})}},{key:"destroy",value:function(){this._arrayMap=null}},{key:"moveRow",value:function(n,t){var i=this._arrayMap[n];this._arrayMap[n]=null;this._arrayMap.splice(t,0,i)}},{key:"clearNull",value:function(){this._arrayMap=o.arrayFilter(this._arrayMap,function(n){return n!==null})}}]),n}();s.mixin(r,e.default);t.default=r},function(n,t,i){"use strict";function l(n){return n&&n.__esModule?n:{"default":n}}function a(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function v(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function y(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var r,u;t.__esModule=!0;var f=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),e=function o(n,t,i){var r,u,f;return n===null&&(n=Function.prototype),r=Object.getOwnPropertyDescriptor(n,t),r===undefined?(u=Object.getPrototypeOf(n),u===null?undefined:o(u,t,i)):"value"in r?r.value:(f=r.get,f===undefined)?undefined:f.call(i)},s=i(459),h=l(s),c=i(2);r="ht__manualRowMove--backlight";u=function(n){function t(){return a(this,t),v(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return y(t,n),f(t,[{key:"build",value:function(){e(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"build",this).call(this);c.addClass(this._element,r)}}]),t}(h.default);t.default=u},function(n,t,i){"use strict";function l(n){return n&&n.__esModule?n:{"default":n}}function a(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function v(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function y(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var r,u;t.__esModule=!0;var f=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),e=function o(n,t,i){var r,u,f;return n===null&&(n=Function.prototype),r=Object.getOwnPropertyDescriptor(n,t),r===undefined?(u=Object.getPrototypeOf(n),u===null?undefined:o(u,t,i)):"value"in r?r.value:(f=r.get,f===undefined)?undefined:f.call(i)},s=i(459),h=l(s),c=i(2);r="ht__manualRowMove--guideline";u=function(n){function t(){return a(this,t),v(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return y(t,n),f(t,[{key:"build",value:function(){e(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"build",this).call(this);c.addClass(this._element,r)}}]),t}(h.default);t.default=u},function(){},function(n,t,i){"use strict";function s(n){return n&&n.__esModule?n:{"default":n}}function b(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function k(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function d(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var f;t.__esModule=!0;var h=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),e=function c(n,t,i){var r,u,f;return n===null&&(n=Function.prototype),r=Object.getOwnPropertyDescriptor(n,t),r===undefined?(u=Object.getPrototypeOf(n),u===null?undefined:c(u,t,i)):"value"in r?r.value:(f=r.get,f===undefined)?undefined:f.call(i)},l=i(7),a=s(l),r=i(2),v=i(9),y=s(v),o=i(11),u=i(0),p=i(4),w=i(6);f=function(n){function t(n){b(this,t);var i=k(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return i.currentTH=null,i.currentRow=null,i.selectedRows=[],i.currentHeight=null,i.newSize=null,i.startY=null,i.startHeight=null,i.startOffset=null,i.handle=document.createElement("DIV"),i.guide=document.createElement("DIV"),i.eventManager=new y.default(i),i.pressed=null,i.dblclick=0,i.autoresizeTimeout=null,i.manualRowHeights=[],r.addClass(i.handle,"manualRowResizer"),r.addClass(i.guide,"manualRowResizerGuide"),i}return d(t,n),h(t,[{key:"isEnabled",value:function(){return this.hot.getSettings().manualRowResize}},{key:"enablePlugin",value:function(){var r=this,n,i;this.enabled||(this.manualRowHeights=[],n=this.hot.getSettings().manualRowResize,i=this.loadManualRowHeights(),this.manualRowHeights=typeof i!="undefined"?i:Array.isArray(n)?n:[],this.addHook("modifyRowHeight",function(n,t){return r.onModifyRowHeight(n,t)}),this.bindEvents(),e(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){var n=this.hot.getSettings().manualRowResize;Array.isArray(n)?this.manualRowHeights=n:n||(this.manualRowHeights=[])}},{key:"disablePlugin",value:function(){e(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disablePlugin",this).call(this)}},{key:"saveManualRowHeights",value:function(){this.hot.runHooks("persistentStateSave","manualRowHeights",this.manualRowHeights)}},{key:"loadManualRowHeights",value:function(){var n={};return this.hot.runHooks("persistentStateLoad","manualRowHeights",n),n.value}},{key:"setupHandlePosition",value:function(n){var c=this,f,e,t;if(this.currentTH=n,f=this.hot.view.wt.wtTable.getCoords(n).row,e=r.outerWidth(this.currentTH),f>=0){if(t=this.currentTH.getBoundingClientRect(),this.currentRow=f,this.selectedRows=[],this.hot.selection.isSelected()&&this.hot.selection.selectedHeader.rows){var o=this.hot.getSelectedRangeLast(),s=o.from,h=o.to,i=s.row,u=h.row;i>=u&&(i=h.row,u=s.row);this.currentRow>=i&&this.currentRow<=u?p.rangeEach(i,u,function(n){return c.selectedRows.push(n)}):this.selectedRows.push(this.currentRow)}else this.selectedRows.push(this.currentRow);this.startOffset=t.top-6;this.startHeight=parseInt(t.height,10);this.handle.style.left=t.left+"px";this.handle.style.top=this.startOffset+this.startHeight+"px";this.handle.style.width=e+"px";this.hot.rootElement.appendChild(this.handle)}}},{key:"refreshHandlePosition",value:function(){this.handle.style.top=this.startOffset+this.currentHeight+"px"}},{key:"setupGuidePosition",value:function(){var n=parseInt(r.outerWidth(this.handle),10),t=parseInt(this.handle.style.left,10)+n,i=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);r.addClass(this.handle,"active");r.addClass(this.guide,"active");this.guide.style.top=this.handle.style.top;this.guide.style.left=t+"px";this.guide.style.width=i-n+"px";this.hot.rootElement.appendChild(this.guide)}},{key:"refreshGuidePosition",value:function(){this.guide.style.top=this.handle.style.top}},{key:"hideHandleAndGuide",value:function(){r.removeClass(this.handle,"active");r.removeClass(this.guide,"active")}},{key:"checkIfRowHeader",value:function(n){if(n!=this.hot.rootElement){var t=n.parentNode;return t.tagName==="TBODY"?!0:this.checkIfRowHeader(t)}return!1}},{key:"getTHFromTargetElement",value:function(n){return n.tagName!="TABLE"?n.tagName=="TH"?n:this.getTHFromTargetElement(n.parentNode):null}},{key:"onMouseOver",value:function(n){if(this.checkIfRowHeader(n.target)){var t=this.getTHFromTargetElement(n.target);t&&(this.pressed||this.setupHandlePosition(t))}}},{key:"afterMouseDownTimeout",value:function(){var n=this,t=function(){n.hot.forceFullRender=!0;n.hot.view.render();n.hot.view.wt.wtOverlays.adjustElementsSize(!0)},i=function(i,r){var u=n.hot.runHooks("beforeRowResize",i,n.newSize,!0);u!==void 0&&(n.newSize=u);n.setManualSize(i,n.newSize);r&&t();n.hot.runHooks("afterRowResize",i,n.newSize,!0)},r;this.dblclick>=2&&(r=this.selectedRows.length,r>1?(u.arrayEach(this.selectedRows,function(n){i(n)}),t()):u.arrayEach(this.selectedRows,function(n){i(n,!0)}));this.dblclick=0;this.autoresizeTimeout=null}},{key:"onMouseDown",value:function(n){var t=this;r.hasClass(n.target,"manualRowResizer")&&(this.setupGuidePosition(),this.pressed=this.hot,this.autoresizeTimeout==null&&(this.autoresizeTimeout=setTimeout(function(){return t.afterMouseDownTimeout()},500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick++,this.startY=o.pageY(n),this.newSize=this.startHeight)}},{key:"onMouseMove",value:function(n){var t=this;this.pressed&&(this.currentHeight=this.startHeight+(o.pageY(n)-this.startY),u.arrayEach(this.selectedRows,function(n){t.newSize=t.setManualSize(n,t.currentHeight)}),this.refreshHandlePosition(),this.refreshGuidePosition())}},{key:"onMouseUp",value:function(){var n=this,t=function(){n.hot.forceFullRender=!0;n.hot.view.render();n.hot.view.wt.wtOverlays.adjustElementsSize(!0)},i=function(i,r){n.hot.runHooks("beforeRowResize",i,n.newSize);r&&t();n.saveManualRowHeights();n.hot.runHooks("afterRowResize",i,n.newSize)},r;this.pressed&&(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!=this.startHeight&&(r=this.selectedRows.length,r>1?(u.arrayEach(this.selectedRows,function(n){i(n)}),t()):u.arrayEach(this.selectedRows,function(n){i(n,!0)})),this.setupHandlePosition(this.currentTH))}},{key:"bindEvents",value:function(){var n=this;this.eventManager.addEventListener(this.hot.rootElement,"mouseover",function(t){return n.onMouseOver(t)});this.eventManager.addEventListener(this.hot.rootElement,"mousedown",function(t){return n.onMouseDown(t)});this.eventManager.addEventListener(window,"mousemove",function(t){return n.onMouseMove(t)});this.eventManager.addEventListener(window,"mouseup",function(t){return n.onMouseUp(t)})}},{key:"setManualSize",value:function(n,t){return n=this.hot.runHooks("modifyRow",n),this.manualRowHeights[n]=t,t}},{key:"onModifyRowHeight",value:function(n,t){var r,u,i;return this.enabled&&(r=this.hot.getPlugin("autoRowSize"),u=r?r.heights[t]:null,t=this.hot.runHooks("modifyRow",t),i=this.manualRowHeights[t],i!==void 0&&(i===u||i>(n||0)))?i:n}}]),t}(a.default);w.registerPlugin("manualRowResize",f);t.default=f},function(n,t,i){"use strict";function e(n){return n&&n.__esModule?n:{"default":n}}function v(n){if(Array.isArray(n)){for(var t=0,i=Array(n.length);t<n.length;t++)i[t]=n[t];return i}return Array.from(n)}function lt(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function at(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function vt(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var l,a;t.__esModule=!0;var y=function(){function n(n,t){var r=[],u=!0,f=!1,e=undefined,i,o;try{for(i=n[Symbol.iterator]();!(u=(o=i.next()).done);u=!0)if(r.push(o.value),t&&r.length===t)break}catch(s){f=!0;e=s}finally{try{!u&&i["return"]&&i["return"]()}finally{if(f)throw e;}}return r}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return n(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance");}}(),p=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),h=function w(n,t,i){var r,u,f;return n===null&&(n=Function.prototype),r=Object.getOwnPropertyDescriptor(n,t),r===undefined?(u=Object.getPrototypeOf(n),u===null?undefined:w(u,t,i)):"value"in r?r.value:(f=r.get,f===undefined)?undefined:f.call(i)},b=i(7),k=e(b),d=i(14),s=e(d),g=i(6),nt=i(11),r=i(8),tt=i(610),it=e(tt),rt=i(158),u=e(rt),ut=i(611),ft=e(ut),et=i(612),ot=e(et),st=i(613),ht=e(st),f=i(0),c=i(1),o=i(4),ct=i(460);i(614);s.default.getSingleton().register("beforeMergeCells");s.default.getSingleton().register("afterMergeCells");s.default.getSingleton().register("beforeUnmergeCells");s.default.getSingleton().register("afterUnmergeCells");l=new WeakMap;a=function(n){function t(n){lt(this,t);var i=at(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return l.set(i,{lastDesiredCoords:null}),i.mergedCellsCollection=null,i.autofillCalculations=null,i.selectionCalculations=null,i}return vt(t,n),p(t,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().mergeCells}},{key:"enablePlugin",value:function(){var n=this;this.enabled||(this.mergedCellsCollection=new it.default(this),this.autofillCalculations=new ft.default(this),this.selectionCalculations=new ot.default,this.addHook("afterInit",function(){return n.onAfterInit.apply(n,arguments)}),this.addHook("beforeKeyDown",function(){return n.onBeforeKeyDown.apply(n,arguments)}),this.addHook("modifyTransformStart",function(){return n.onModifyTransformStart.apply(n,arguments)}),this.addHook("modifyTransformEnd",function(){return n.onModifyTransformEnd.apply(n,arguments)}),this.addHook("modifyGetCellCoords",function(){return n.onModifyGetCellCoords.apply(n,arguments)}),this.addHook("beforeSetRangeEnd",function(){return n.onBeforeSetRangeEnd.apply(n,arguments)}),this.addHook("afterIsMultipleSelection",function(){return n.onAfterIsMultipleSelection.apply(n,arguments)}),this.addHook("afterRenderer",function(){return n.onAfterRenderer.apply(n,arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){return n.addMergeActionsToContextMenu.apply(n,arguments)}),this.addHook("afterGetCellMeta",function(){return n.onAfterGetCellMeta.apply(n,arguments)}),this.addHook("afterViewportRowCalculatorOverride",function(){return n.onAfterViewportRowCalculatorOverride.apply(n,arguments)}),this.addHook("afterViewportColumnCalculatorOverride",function(){return n.onAfterViewportColumnCalculatorOverride.apply(n,arguments)}),this.addHook("modifyAutofillRange",function(){return n.onModifyAutofillRange.apply(n,arguments)}),this.addHook("afterCreateCol",function(){return n.onAfterCreateCol.apply(n,arguments)}),this.addHook("afterRemoveCol",function(){return n.onAfterRemoveCol.apply(n,arguments)}),this.addHook("afterCreateRow",function(){return n.onAfterCreateRow.apply(n,arguments)}),this.addHook("afterRemoveRow",function(){return n.onAfterRemoveRow.apply(n,arguments)}),this.addHook("afterChange",function(){return n.onAfterChange.apply(n,arguments)}),this.addHook("beforeDrawBorders",function(){return n.onBeforeDrawAreaBorders.apply(n,arguments)}),h(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.clearCollections();this.hot.render();h(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){var n=this.hot.getSettings().mergeCells;this.clearCollections();this.disablePlugin();this.enablePlugin();this.generateFromSettings(n);h(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updatePlugin",this).call(this)}},{key:"validateSetting",value:function(n){var t=!0;return n?(u.default.containsNegativeValues(n)?(console.warn(u.default.NEGATIVE_VALUES_WARNING(n)),t=!1):u.default.isOutOfBounds(n,this.hot.countRows(),this.hot.countCols())?(console.warn(u.default.IS_OUT_OF_BOUNDS_WARNING(n)),t=!1):u.default.isSingleCell(n)?(console.warn(u.default.IS_SINGLE_CELL(n)),t=!1):u.default.containsZeroSpan(n)&&(console.warn(u.default.ZERO_SPAN_WARNING(n)),t=!1),t):!1}},{key:"generateFromSettings",value:function(n){var i=this,u,t,e;Array.isArray(n)&&(t=[],f.arrayEach(n,function(n){if(i.validateSetting(n)){var u=new r.CellCoords(n.row,n.col),f=new r.CellCoords(n.row+n.rowspan-1,n.col+n.colspan-1),e=new r.CellRange(u,u,f);t.push(i.mergeRange(e,!0,!0))}}),t=t.filter(function(n){return n!==!0}),e=this.getBulkCollectionData(t),(u=this.hot).populateFromArray.apply(u,v(e)))}},{key:"getBulkCollectionData",value:function(n){var i,t=this.getBulkCollectionDataRange(n),u=(i=this.hot).getData.apply(i,v(t)),r=u.splice(0);return f.arrayEach(n,function(n){var i=y(n,3),u=i[0],e=i[1],o=i[2];f.arrayEach(o,function(n,i){f.arrayEach(n,function(n,f){r[u-t[0]+i][e-t[1]+f]=n})})}),[t[0],t[1],r]}},{key:"getBulkCollectionDataRange",value:function(n){var t=[0,0],i=[0,0],r=null,u=null,e=null;return f.arrayEach(n,function(n){r=n[0];u=n[1];e=n[2];t[0]=Math.min(r,t[0]);t[1]=Math.min(u,t[1]);i[0]=Math.max(r+e.length-1,i[0]);i[1]=Math.max(u+e[0].length-1,i[1])}),[].concat(t,i)}},{key:"clearCollections",value:function(){this.mergedCellsCollection.clear()}},{key:"canMergeRange",value:function(n){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!1;return t?!0:this.validateSetting(n)}},{key:"toggleMergeOnSelection",value:function(){var n=this.hot.getSelectedRangeLast(),t,i;n&&(n.setDirection("NW-SE"),t=n.from,i=n.to,this.toggleMerge(n),this.hot.selectCell(t.row,t.col,i.row,i.col,!1))}},{key:"mergeSelection",value:function(){var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.hot.getSelectedRangeLast(),t,i;n&&(n.setDirection("NW-SE"),t=n.from,i=n.to,this.unmergeRange(n,!0),this.mergeRange(n),this.hot.selectCell(t.row,t.col,i.row,i.col,!1))}},{key:"unmergeSelection",value:function(){var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.hot.getSelectedRangeLast(),t,i;n&&(t=n.from,i=n.to,this.unmergeRange(n,!0),this.hot.selectCell(t.row,t.col,i.row,i.col,!1))}},{key:"mergeRange",value:function(n){var f=this,u=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!1,c=arguments.length>2&&arguments[2]!==undefined?arguments[2]:!1,r=n.getTopLeftCorner(),e=n.getBottomRightCorner(),t={row:r.row,col:r.col,rowspan:e.row-r.row+1,colspan:e.col-r.col+1},i=[],s=null,h;return this.canMergeRange(t,u)?(this.hot.runHooks("beforeMergeCells",n,u),o.rangeEach(0,t.rowspan-1,function(n){o.rangeEach(0,t.colspan-1,function(r){var u=null;i[n]||(i[n]=[]);n===0&&r===0?u=f.hot.getDataAtCell(t.row,t.col):f.hot.setCellMeta(t.row+n,t.col+r,"hidden",!0);i[n][r]=u})}),this.hot.setCellMeta(t.row,t.col,"spanned",!0),h=this.mergedCellsCollection.add(t),h)?(c?s=[t.row,t.col,i]:this.hot.populateFromArray(t.row,t.col,i,void 0,void 0,this.pluginName),this.hot.runHooks("afterMergeCells",n,t,u),s):!0:!1}},{key:"unmergeRange",value:function(n){var t=this,i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!1,r=this.mergedCellsCollection.getWithinRange(n);r&&(this.hot.runHooks("beforeUnmergeCells",n,i),f.arrayEach(r,function(n){t.mergedCellsCollection.remove(n.row,n.col);o.rangeEach(0,n.rowspan-1,function(i){o.rangeEach(0,n.colspan-1,function(r){t.hot.removeCellMeta(n.row+i,n.col+r,"hidden")})});t.hot.removeCellMeta(n.row,n.col,"spanned")}),this.hot.render(),this.hot.runHooks("afterUnmergeCells",n,i))}},{key:"toggleMerge",value:function(n){var t=this.mergedCellsCollection.get(n.from.row,n.from.col),i=t.row===n.from.row&&t.col===n.from.col&&t.row+t.rowspan-1===n.to.row&&t.col+t.colspan-1===n.to.col;i?this.unmergeRange(n):this.mergeSelection(n)}},{key:"merge",value:function(n,t,i,u){var f=new r.CellCoords(n,t),e=new r.CellCoords(i,u);this.mergeRange(new r.CellRange(f,f,e))}},{key:"unmerge",value:function(n,t,i,u){var f=new r.CellCoords(n,t),e=new r.CellCoords(i,u);this.unmergeRange(new r.CellRange(f,f,e))}},{key:"onAfterInit",value:function(){this.generateFromSettings(this.hot.getSettings().mergeCells);this.hot.render()}},{key:"onBeforeKeyDown",value:function(n){var t=(n.ctrlKey||n.metaKey)&&!n.altKey;t&&n.keyCode===77&&(this.toggleMerge(this.hot.getSelectedRangeLast()),this.hot.render(),nt.stopImmediatePropagation(n))}},{key:"onAfterIsMultipleSelection",value:function(n){var i,r,t;if(n)for(i=this.mergedCellsCollection.mergedCells,r=this.hot.getSelectedRangeLast(),t=0;t<i.length;t+=1)if(r.highlight.row===i[t].row&&r.highlight.col===i[t].col&&r.to.row===i[t].row+i[t].rowspan-1&&r.to.col===i[t].col+i[t].colspan-1)return!1;return n}},{key:"onModifyTransformStart",value:function(n){var f=l.get(this),e=this.hot.getSelectedRangeLast(),t={row:n.row,col:n.col},o=null,u=new r.CellCoords(e.highlight.row,e.highlight.col),i=this.mergedCellsCollection.get(u.row,u.col),s;if(f.lastDesiredCoords||(f.lastDesiredCoords=new r.CellCoords(null,null)),i){var h=new r.CellCoords(i.row,i.col),c=new r.CellCoords(i.row+i.rowspan-1,i.col+i.colspan-1),a=new r.CellRange(h,h,c);a.includes(f.lastDesiredCoords)||(f.lastDesiredCoords=new r.CellCoords(null,null));t.row=f.lastDesiredCoords.row?f.lastDesiredCoords.row-u.row:t.row;t.col=f.lastDesiredCoords.col?f.lastDesiredCoords.col-u.col:t.col;n.row>0?t.row=i.row+i.rowspan-1-u.row+n.row:n.row<0&&(t.row=u.row-i.row+n.row);n.col>0?t.col=i.col+i.colspan-1-u.col+n.col:n.col<0&&(t.col=u.col-i.col+n.col)}o=new r.CellCoords(e.highlight.row+t.row,e.highlight.col+t.col);s=this.mergedCellsCollection.get(o.row,o.col);s&&(f.lastDesiredCoords=o,t={row:s.row-u.row,col:s.col-u.col});t.row!==0&&(n.row=t.row);t.col!==0&&(n.col=t.col)}},{key:"onModifyTransformEnd",value:function(n){var u=this,i=this.hot.getSelectedRangeLast(),t=c.clone(n),e=this.selectionCalculations.getUpdatedSelectionRange(i,n),r=c.clone(t),o=this.mergedCellsCollection.getWithinRange(e,!0);do r=c.clone(t),this.selectionCalculations.getUpdatedSelectionRange(i,t),f.arrayEach(o,function(n){u.selectionCalculations.snapDelta(t,i,n)});while(t.row!==r.row||t.col!==r.col);n.row=t.row;n.col=t.col}},{key:"onModifyGetCellCoords",value:function(n,t){var i=this.mergedCellsCollection.get(n,t);if(i)return[i.row,i.col,i.row+i.rowspan-1,i.col+i.colspan-1]}},{key:"addMergeActionsToContextMenu",value:function(n){n.items.push({name:"---------"},ht.default(this))}},{key:"onAfterRenderer",value:function(n,t,i){var r=this.mergedCellsCollection.get(t,i);ct.applySpanProperties(n,r,t,i)}},{key:"onBeforeSetRangeEnd",value:function(n){var t=this.hot.getSelectedRangeLast(),i,u,f,e;if(t.highlight=new r.CellCoords(t.highlight.row,t.highlight.col),t.to=n,i=!1,(t.from.row!==0||t.to.row!==this.hot.countRows()-1)&&(t.from.col!==0||t.to.col!==this.hot.countCols()-1))do for(i=!1,u=0;u<this.mergedCellsCollection.mergedCells.length;u++)f=this.mergedCellsCollection.mergedCells[u],e=f.getRange(),t.expandByRange(e)&&(n.row=t.to.row,n.col=t.to.col,i=!0);while(i)}},{key:"onAfterGetCellMeta",value:function(n,t,i){var r=this.mergedCellsCollection.get(n,t);r&&(r.row!==n||r.col!==t)&&(i.copyable=!1)}},{key:"onAfterViewportRowCalculatorOverride",value:function(n){var i=this,r=this.hot.countCols(),t=void 0;o.rangeEach(0,r-1,function(r){if(t=i.mergedCellsCollection.get(n.startRow,r),t&&t.row<n.startRow)return n.startRow=t.row,i.onAfterViewportRowCalculatorOverride.call(i,n);if(t=i.mergedCellsCollection.get(n.endRow,r),t){var u=t.row+t.rowspan-1;if(u>n.endRow)return n.endRow=u,i.onAfterViewportRowCalculatorOverride.call(i,n)}return!0})}},{key:"onAfterViewportColumnCalculatorOverride",value:function(n){var i=this,r=this.hot.countRows(),t=void 0;o.rangeEach(0,r-1,function(r){if(t=i.mergedCellsCollection.get(r,n.startColumn),t&&t.col<n.startColumn)return n.startColumn=t.col,i.onAfterViewportColumnCalculatorOverride.call(i,n);if(t=i.mergedCellsCollection.get(r,n.endColumn),t){var u=t.col+t.colspan-1;if(u>n.endColumn)return n.endColumn=u,i.onAfterViewportColumnCalculatorOverride.call(i,n)}return!0})}},{key:"onModifyAutofillRange",value:function(n,t){var i,r;return(this.autofillCalculations.correctSelectionAreaSize(t),i=this.autofillCalculations.getDirection(t,n),this.autofillCalculations.dragAreaOverlapsCollections(t,n,i))?t:(r=this.mergedCellsCollection.getWithinRange({from:{row:t[0],col:t[1]},to:{row:t[2],col:t[3]}}),!r)?n:this.autofillCalculations.snapDragArea(t,n,i,r)}},{key:"onAfterCreateCol",value:function(n,t){this.mergedCellsCollection.shiftCollections("right",n,t)}},{key:"onAfterRemoveCol",value:function(n,t){this.mergedCellsCollection.shiftCollections("left",n,t)}},{key:"onAfterCreateRow",value:function(n,t,i){i!=="auto"&&this.mergedCellsCollection.shiftCollections("down",n,t)}},{key:"onAfterRemoveRow",value:function(n,t){this.mergedCellsCollection.shiftCollections("up",n,t)}},{key:"onAfterChange",value:function(n,t){t==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(n)}},{key:"onBeforeDrawAreaBorders",value:function(n,t){if(t&&t==="area"){var i=this.hot.getSelectedRangeLast(),r=this.mergedCellsCollection.getWithinRange(i);f.arrayEach(r,function(t){i.getBottomRightCorner().row===t.getLastRow()&&i.getBottomRightCorner().col===t.getLastColumn()&&(n[2]=t.row,n[3]=t.col)})}}}]),t}(k.default);g.registerPlugin("mergeCells",a);t.default=a},function(n,t,i){"use strict";function y(n){return n&&n.__esModule?n:{"default":n}}function p(n,t){return Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(t)}}))}function o(n){if(Array.isArray(n)){for(var t=0,i=Array(n.length);t<n.length;t++)i[t]=n[t];return i}return Array.from(n)}function w(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var s;t.__esModule=!0;var h=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),c=p(["The merged cell declared at [",", ","] overlaps with the other declared merged \n      cell. The overlapping merged cell was not added to the table, please fix your setup."],["The merged cell declared at [",", ","] overlaps with the other declared merged \n      cell. The overlapping merged cell was not added to the table, please fix your setup."]),l=i(158),a=y(l),r=i(8),f=i(4),u=i(0),e=i(460),v=i(34);s=function(){function n(t){w(this,n);this.plugin=t;this.mergedCells=[];this.hot=t.hot}return h(n,[{key:"get",value:function(n,t){var r=this.mergedCells,i=!1;return u.arrayEach(r,function(r){return r.row<=n&&r.row+r.rowspan-1>=n&&r.col<=t&&r.col+r.colspan-1>=t?(i=r,!1):!0}),i}},{key:"getByRange",value:function(n){var i=this.mergedCells,t=!1;return u.arrayEach(i,function(i){return i.row<=n.from.row&&i.row+i.rowspan-1>=n.to.row&&i.col<=n.from.col&&i.col+i.colspan-1>=n.to.col?t=i:!0}),t}},{key:"getWithinRange",value:function(n){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!1,o=this.mergedCells,t=[],i,f;return n.includesRange||(i=new r.CellCoords(n.from.row,n.from.col),f=new r.CellCoords(n.to.row,n.to.col),n=new r.CellRange(i,i,f)),u.arrayEach(o,function(i){var u=new r.CellCoords(i.row,i.col),o=new r.CellCoords(i.row+i.rowspan-1,i.col+i.colspan-1),f=new r.CellRange(u,u,o);e?n.overlaps(f)&&t.push(i):n.includesRange(f)&&t.push(i)}),t.length?t:!1}},{key:"add",value:function(t){var f=this.mergedCells,r=t.row,u=t.col,e=t.rowspan,o=t.colspan,i=new a.default(r,u,e,o),s=this.get(r,u),h=this.isOverlapping(i);return!s&&!h?(this.hot&&i.normalize(this.hot),f.push(i),i):(console.warn(n.IS_OVERLAPPING_WARNING(i)),!1)}},{key:"remove",value:function(n,t){var u=this.mergedCells,i=this.get(n,t),r=i?this.mergedCells.indexOf(i):null;return i&&r!==!1?(u.splice(r,1),i):!1}},{key:"clear",value:function(){var t=this,r=this.mergedCells,n=[],i=[];u.arrayEach(r,function(i){n.push([t.hot.getCell(i.row,i.col),t.get(i.row,i.col),i.row,i.col])});this.mergedCells.length=0;u.arrayEach(n,function(r,u){f.rangeEach(0,r.rowspan-1,function(n){f.rangeEach(0,r.colspan-1,function(u){(u!==0||n!==0)&&i.push([t.hot.getCell(r.row+n,r.col+u),null,null,null])})});n[u][1]=null});u.arrayEach(n,function(n){e.applySpanProperties.apply(undefined,o(n))});u.arrayEach(i,function(n){e.applySpanProperties.apply(undefined,o(n))})}},{key:"isOverlapping",value:function(n){var i=new r.CellRange(null,new r.CellCoords(n.row,n.col),new r.CellCoords(n.row+n.rowspan-1,n.col+n.colspan-1)),t=!1;return u.arrayEach(this.mergedCells,function(n){var u=new r.CellRange(null,new r.CellCoords(n.row,n.col),new r.CellCoords(n.row+n.rowspan-1,n.col+n.colspan-1));return u.overlaps(i)?(t=!0,!1):!0}),t}},{key:"isMergedParent",value:function(n,t){var r=this.mergedCells,i=!1;return u.arrayEach(r,function(r){return r.row===n&&r.col===t?(i=!0,!1):!0}),i}},{key:"shiftCollections",value:function(n,t,i){var f=this,r=[0,0];switch(n){case"right":r[0]+=i;break;case"left":r[0]-=i;break;case"down":r[1]+=i;break;case"up":r[1]-=i}u.arrayEach(this.mergedCells,function(n){n.shift(r,t)});u.arrayEach(this.mergedCells,function(n){n.removed&&f.mergedCells.splice(f.mergedCells.indexOf(n),1)})}}],[{key:"IS_OVERLAPPING_WARNING",value:function(n){return v.toSingleLine(c,n.row,n.col)}}]),n}();t.default=s},function(n,t,i){"use strict";function h(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var e;t.__esModule=!0;var r=function(){function n(n,t){var r=[],u=!0,f=!1,e=undefined,i,o;try{for(i=n[Symbol.iterator]();!(u=(o=i.next()).done);u=!0)if(r.push(o.value),t&&r.length===t)break}catch(s){f=!0;e=s}finally{try{!u&&i["return"]&&i["return"]()}finally{if(f)throw e;}}return r}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return n(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance");}}(),o=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),s=i(1),u=i(8),f=i(0);e=function(){function n(t){h(this,n);this.plugin=t;this.mergedCellsCollection=this.plugin.mergedCellsCollection;this.currentFillData=null}return o(n,[{key:"correctSelectionAreaSize",value:function(n){if(n[0]===n[2]&&n[1]===n[3]){var t=this.mergedCellsCollection.get(n[0],n[1]);t&&(n[2]=n[0]+t.rowspan-1,n[3]=n[1]+t.colspan-1)}}},{key:"getDirection",value:function(n,t){return t[0]===n[0]&&t[1]===n[1]&&t[3]===n[3]?"down":t[2]===n[2]&&t[1]===n[1]&&t[3]===n[3]?"up":t[1]===n[1]&&t[2]===n[2]?"right":"left"}},{key:"snapDragArea",value:function(n,t,i,u){var f=t.slice(0),h=this.getAutofillSize(n,t,i),s=r(n,4),p=s[0],w=s[1],b=s[2],k=s[3],it=["up","down"].indexOf(i)>-1,c=it?b-p+1:k-w+1,rt=Math.floor(h/c)*c,e=h-rt,o=this.getFarthestCollection(n,t,i,u),l,d,a,g,v,nt,y,tt;return o&&(i==="down"?(l=o.row+o.rowspan-p-e,d=f[2]+l,d>=this.plugin.hot.countRows()?f[2]-=e:f[2]+=e?l:0):i==="right"?(a=o.col+o.colspan-w-e,g=f[3]+a,g>=this.plugin.hot.countCols()?f[3]-=e:f[3]+=e?a:0):i==="up"?(v=b-e-o.row+1,nt=f[0]+v,nt<0?f[0]+=e:f[0]-=e?v:0):i==="left"&&(y=k-e-o.col+1,tt=f[1]+y,tt<0?f[1]+=e:f[1]-=e?y:0)),this.updateCurrentFillCache({baseArea:n,dragDirection:i,foundMergedCells:u,fillSize:h,dragArea:f,cycleLength:c}),f}},{key:"updateCurrentFillCache",value:function(n){this.currentFillData||(this.currentFillData={});s.extend(this.currentFillData,n)}},{key:"getAutofillSize",value:function(n,t,i){var u=r(n,4),e=u[0],o=u[1],s=u[2],h=u[3],f=r(t,4),c=f[0],l=f[1],a=f[2],v=f[3];switch(i){case"up":return e-c;case"down":return a-s;case"left":return o-l;case"right":return v-h;default:return null}}},{key:"getDragArea",value:function(n,t,i){var u=r(n,4),o=u[0],s=u[1],h=u[2],e=u[3],f=r(t,4),c=f[0],l=f[1],a=f[2],v=f[3];switch(i){case"up":return[c,l,o-1,e];case"down":return[h+1,s,a,e];case"left":return[c,l,h,s-1];case"right":return[o,e+1,a,v];default:return null}}},{key:"getFarthestCollection",value:function(n,t,i,u){var s=r(n,4),a=s[0],v=s[1],y=s[2],p=s[3],c=["up","down"].indexOf(i)>-1,w=c?y:p,b=c?a:v,k=this.getAutofillSize(n,t,i),d=c?y-a+1:p-v+1,g=Math.floor(k/d)*d,h=k-g,e=null,l=null,o=null;switch(i){case"up":e="includesVertically";o=w-h+1;break;case"left":e="includesHorizontally";o=w-h+1;break;case"down":e="includesVertically";o=b+h-1;break;case"right":e="includesHorizontally";o=b+h-1}return f.arrayEach(u,function(n){n[e](o)&&n.isFarther(l,i)&&(l=n)}),l}},{key:"recreateAfterDataPopulation",value:function(n){var r;if(this.currentFillData){var u=this.getRangeFromChanges(n),f=this.currentFillData.foundMergedCells,e=this.currentFillData.dragDirection,o=function(n,t){switch(e){case"up":return n.row-t>=u.from.row;case"down":return n.row+n.rowspan-1+t<=u.to.row;case"left":return n.col-t>=u.from.column;case"right":return n.col+n.colspan-1+t<=u.to.column;default:return null}},i=0,t=null,s=1;do for(r=0;r<f.length;r++){if(t=f[r],i=s*this.currentFillData.cycleLength,o(t,i))switch(e){case"up":this.plugin.mergedCellsCollection.add({row:t.row-i,rowspan:t.rowspan,col:t.col,colspan:t.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:t.row+i,rowspan:t.rowspan,col:t.col,colspan:t.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:t.row,rowspan:t.rowspan,col:t.col-i,colspan:t.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:t.row,rowspan:t.rowspan,col:t.col+i,colspan:t.colspan})}r===f.length-1&&(s+=1)}while(o(t,i));this.currentFillData=null;this.plugin.hot.render()}}},{key:"getRangeFromChanges",value:function(n){var t={min:null,max:null},i={min:null,max:null};return f.arrayEach(n,function(n){(t.min===null||n[0]<t.min)&&(t.min=n[0]);(t.max===null||n[0]>t.max)&&(t.max=n[0]);(i.min===null||n[1]<i.min)&&(i.min=n[1]);(i.max===null||n[1]>i.max)&&(i.max=n[1])}),{from:{row:t.min,column:i.min},to:{row:t.max,column:i.max}}}},{key:"dragAreaOverlapsCollections",value:function(n,t,i){var o=this.getDragArea(n,t,i),f=r(o,4),s=f[0],h=f[1],c=f[2],l=f[3],e=new u.CellCoords(s,h),a=new u.CellCoords(c,l),v=new u.CellRange(e,e,a);return!!this.mergedCellsCollection.getWithinRange(v,!0)}}]),n}();t.default=e},function(n,t,i){"use strict";function e(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var u,r,f;t.__esModule=!0;u=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}();r=i(8);f=function(){function n(){e(this,n)}return u(n,[{key:"snapDelta",value:function(n,t,i){var r=t.to,u=r.row+n.row,f=r.col+n.col;n.row?this.jumpOverMergedCell(n,i,u):n.col&&this.jumpOverMergedCell(n,i,f)}},{key:"jumpOverMergedCell",value:function(n,t,i){var r=n.row||n.col,u=null,f=null,e=null;(n.row?(u=t.includesVertically(i),f=t.row,e=t.getLastRow()):n.col&&(u=t.includesHorizontally(i),f=t.col,e=t.getLastColumn()),r!==0)&&(r>0?u&&i!==f&&(r+=e-i+1):u&&i!==e&&(r-=i-f+1),n.row?n.row=r:n.col&&(n.col=r))}},{key:"getUpdatedSelectionRange",value:function(n,t){return new r.CellRange(n.highlight,n.from,new r.CellCoords(n.to.row+t.row,n.to.col+t.col))}}]),n}();t.default=f},function(n,t,i){"use strict";function o(n){return n&&n.__esModule?n:{"default":n}}function s(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function h(n){return{key:"mergeCells",name:function(){var t=this.getSelectedLast(),i;return t&&(i=n.mergedCellsCollection.get(t[0],t[1]),i.row===t[0]&&i.col===t[1]&&i.row+i.rowspan-1===t[2]&&i.col+i.colspan-1===t[3])?this.getTranslatedPhrase(r.CONTEXTMENU_ITEMS_UNMERGE_CELLS):this.getTranslatedPhrase(r.CONTEXTMENU_ITEMS_MERGE_CELLS)},callback:function(){n.toggleMergeOnSelection()},disabled:function(){var n=this.getSelectedLast(),t;return n?(t=e.default.isSingleCell({row:n[0],col:n[1],rowspan:n[2]-n[0]+1,colspan:n[3]-n[1]+1}),t||this.selection.selectedHeader.corner):!0},hidden:!1}}t.__esModule=!0;t.default=h;var u=i(3),r=s(u),f=i(158),e=o(f)},function(){},function(n,t,i){"use strict";function f(n){return n&&n.__esModule?n:{"default":n}}function b(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function k(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function d(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var e;t.__esModule=!0;var o=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),s=function h(n,t,i){var r,u,f;return n===null&&(n=Function.prototype),r=Object.getOwnPropertyDescriptor(n,t),r===undefined?(u=Object.getPrototypeOf(n),u===null?undefined:h(u,t,i)):"value"in r?r.value:(f=r.get,f===undefined)?undefined:f.call(i)},c=i(14),g=f(c),u=i(2),l=i(33),a=i(7),v=f(a),y=i(9),p=f(y),w=i(6),r=i(8);e=function(n){function t(n){b(this,t);var i=k(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return i.dragged=[],i.eventManager=null,i.lastSetCell=null,i}return d(t,n),o(t,[{key:"isEnabled",value:function(){return l.isMobileBrowser()}},{key:"enablePlugin",value:function(){this.enabled||(this.eventManager||(this.eventManager=new p.default(this)),this.registerListeners(),s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enablePlugin",this).call(this))}},{key:"registerListeners",value:function(){function t(t){if(n.dragged.length===1)return n.dragged.splice(0,n.dragged.length),!0;var i=n.dragged.indexOf(t);if(i==-1)return!1;i===0?n.dragged=n.dragged.slice(0,1):i==1&&(n.dragged=n.dragged.slice(-1))}var n=this;this.eventManager.addEventListener(this.hot.rootElement,"touchstart",function(t){var i=void 0;return u.hasClass(t.target,"topLeftSelectionHandle-HitArea")?(i=n.hot.getSelectedRangeLast(),n.dragged.push("topLeft"),n.touchStartRange={width:i.getWidth(),height:i.getHeight(),direction:i.getDirection()},t.preventDefault(),!1):u.hasClass(t.target,"bottomRightSelectionHandle-HitArea")?(i=n.hot.getSelectedRangeLast(),n.dragged.push("bottomRight"),n.touchStartRange={width:i.getWidth(),height:i.getHeight(),direction:i.getDirection()},t.preventDefault(),!1):void 0});this.eventManager.addEventListener(this.hot.rootElement,"touchend",function(i){return u.hasClass(i.target,"topLeftSelectionHandle-HitArea")?(t.call(n,"topLeft"),n.touchStartRange=void 0,i.preventDefault(),!1):u.hasClass(i.target,"bottomRightSelectionHandle-HitArea")?(t.call(n,"bottomRight"),n.touchStartRange=void 0,i.preventDefault(),!1):void 0});this.eventManager.addEventListener(this.hot.rootElement,"touchmove",function(t){var c=u.getWindowScrollTop(),l=u.getWindowScrollLeft(),i=void 0,r=void 0,f=void 0,o=void 0,s=void 0,h=void 0,e=void 0;n.dragged.length!==0&&(i=document.elementFromPoint(t.touches[0].screenX-l,t.touches[0].screenY-c),i&&i!==n.lastSetCell)&&((i.nodeName=="TD"||i.nodeName=="TH")&&(r=n.hot.getCoords(i),r.col==-1&&(r.col=0),f=n.hot.getSelectedRangeLast(),o=f.getWidth(),s=f.getHeight(),h=f.getDirection(),o==1&&s==1&&n.hot.selection.setRangeEnd(r),e=n.getCurrentRangeCoords(f,r,n.touchStartRange.direction,h,n.dragged[0]),e.start!==null&&n.hot.selection.setRangeStart(e.start),n.hot.selection.setRangeEnd(e.end),n.lastSetCell=i),t.preventDefault())})}},{key:"getCurrentRangeCoords",value:function(n,t,i,u,f){var o=n.getTopLeftCorner(),s=n.getBottomRightCorner(),h=n.getBottomLeftCorner(),c=n.getTopRightCorner(),e={start:null,end:null};switch(i){case"NE-SW":switch(u){case"NE-SW":case"NW-SE":e=f=="topLeft"?{start:new r.CellCoords(t.row,n.highlight.col),end:new r.CellCoords(h.row,t.col)}:{start:new r.CellCoords(n.highlight.row,t.col),end:new r.CellCoords(t.row,o.col)};break;case"SE-NW":f=="bottomRight"&&(e={start:new r.CellCoords(s.row,t.col),end:new r.CellCoords(t.row,o.col)})}break;case"NW-SE":switch(u){case"NE-SW":f=="topLeft"?e={start:t,end:h}:e.end=t;break;case"NW-SE":f=="topLeft"?e={start:t,end:s}:e.end=t;break;case"SE-NW":f=="topLeft"?e={start:t,end:o}:e.end=t;break;case"SW-NE":f=="topLeft"?e={start:t,end:c}:e.end=t}break;case"SW-NE":switch(u){case"NW-SE":e=f=="bottomRight"?{start:new r.CellCoords(t.row,o.col),end:new r.CellCoords(h.row,t.col)}:{start:new r.CellCoords(o.row,t.col),end:new r.CellCoords(t.row,s.col)};break;case"SW-NE":e=f=="topLeft"?{start:new r.CellCoords(n.highlight.row,t.col),end:new r.CellCoords(t.row,s.col)}:{start:new r.CellCoords(t.row,o.col),end:new r.CellCoords(o.row,t.col)};break;case"SE-NW":f=="bottomRight"?e={start:new r.CellCoords(t.row,c.col),end:new r.CellCoords(o.row,t.col)}:f=="topLeft"&&(e={start:h,end:t})}break;case"SE-NW":switch(u){case"NW-SE":case"NE-SW":case"SW-NE":f=="topLeft"&&(e.end=t);break;case"SE-NW":f=="topLeft"?e.end=t:e={start:t,end:o}}}return e}},{key:"isDragged",value:function(){return this.dragged.length>0}}]),t}(v.default);w.registerPlugin("multipleSelectionHandles",e);t.default=e},function(n,t,i){"use strict";function u(n){return n&&n.__esModule?n:{"default":n}}function p(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function w(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function b(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var f;t.__esModule=!0;var e=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),r=function o(n,t,i){var r,u,f;return n===null&&(n=Function.prototype),r=Object.getOwnPropertyDescriptor(n,t),r===undefined?(u=Object.getPrototypeOf(n),u===null?undefined:o(u,t,i)):"value"in r?r.value:(f=r.get,f===undefined)?undefined:f.call(i)},s=i(7),h=u(s),c=i(461),k=u(c),l=i(617),a=u(l),v=i(0),y=i(6);f=function(n){function t(n){p(this,t);var i=w(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return i.observer=null,i}return b(t,n),e(t,[{key:"isEnabled",value:function(){return this.hot.getSettings().observeChanges}},{key:"enablePlugin",value:function(){var n=this;this.enabled||(this.observer||(this.observer=new a.default(this.hot.getSourceData()),this._exposePublicApi()),this.observer.addLocalHook("change",function(t){return n.onDataChange(t)}),this.addHook("afterCreateRow",function(){return n.onAfterTableAlter()}),this.addHook("afterRemoveRow",function(){return n.onAfterTableAlter()}),this.addHook("afterCreateCol",function(){return n.onAfterTableAlter()}),this.addHook("afterRemoveCol",function(){return n.onAfterTableAlter()}),this.addHook("afterChange",function(t,i){return n.onAfterTableAlter(i)}),this.addHook("afterLoadData",function(t){return n.onAfterLoadData(t)}),r(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.observer&&(this.observer.destroy(),this.observer=null,this._deletePublicApi());r(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disablePlugin",this).call(this)}},{key:"onDataChange",value:function(n){var i=this,t,r;this.observer.isPaused()||(t=this.pluginName+".change",r={add:function(n){isNaN(n.col)?i.hot.runHooks("afterCreateRow",n.row,1,t):i.hot.runHooks("afterCreateCol",n.col,1,t)},remove:function(n){isNaN(n.col)?i.hot.runHooks("afterRemoveRow",n.row,1,t):i.hot.runHooks("afterRemoveCol",n.col,1,t)},replace:function(n){i.hot.runHooks("afterChange",[[n.row,n.col,null,n.value]],t)}},v.arrayEach(n,function(n){r[n.op]&&r[n.op](n)}),this.hot.render());this.hot.runHooks("afterChangesObserved")}},{key:"onAfterTableAlter",value:function(n){var t=this;n!=="loadData"&&(this.observer.pause(),this.hot.addHookOnce("afterChangesObserved",function(){return t.observer.resume()}))}},{key:"onAfterLoadData",value:function(n){n||this.observer.setObservedData(this.hot.getSourceData())}},{key:"destroy",value:function(){this.observer&&(this.observer.destroy(),this._deletePublicApi());r(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}},{key:"_exposePublicApi",value:function(){var n=this,t=this.hot;t.pauseObservingChanges=function(){return n.observer.pause()};t.resumeObservingChanges=function(){return n.observer.resume()};t.isPausedObservingChanges=function(){return n.observer.isPaused()}}},{key:"_deletePublicApi",value:function(){var n=this.hot;delete n.pauseObservingChanges;delete n.resumeObservingChanges;delete n.isPausedObservingChanges}}]),t}(h.default);t.default=f;y.registerPlugin("observeChanges",f)},function(n,t,i){"use strict";function f(n){return n&&n.__esModule?n:{"default":n}}function a(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var u;t.__esModule=!0;var e=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),o=i(461),r=f(o),s=i(21),h=f(s),c=i(1),l=i(618);u=function(){function n(t){a(this,n);this.observedData=null;this.observer=null;this.paused=!1;this.setObservedData(t)}return e(n,[{key:"setObservedData",value:function(n){var t=this;this.observer&&r.default.unobserve(this.observedData,this.observer);this.observedData=n;this.observer=r.default.observe(this.observedData,function(n){return t.onChange(n)})}},{key:"isPaused",value:function(){return this.paused}},{key:"pause",value:function(){this.paused=!0}},{key:"resume",value:function(){this.paused=!1}},{key:"onChange",value:function(n){this.runLocalHooks("change",l.cleanPatches(n))}},{key:"destroy",value:function(){r.default.unobserve(this.observedData,this.observer);this.observedData=null;this.observer=null}}]),n}();c.mixin(u,h.default);t.default=u},function(n,t,i){"use strict";function e(n){var t=[];return n=r.arrayFilter(n,function(n){return/[/]length/ig.test(n.path)?!1:u(n.path)?!0:!1}),n=r.arrayMap(n,function(n){var t=u(n.path);return n.row=t.row,n.col=t.col,n}),n=r.arrayFilter(n,function(n){if(["add","remove"].indexOf(n.op)!==-1&&!isNaN(n.col)){if(t.indexOf(n.col)!==-1)return!1;t.push(n.col)}return!0}),t.length=0,n}function u(n){var i=n.match(/^\/(\d+)\/?(.*)?$/);if(!i)return null;var r=f(i,3),u=r[1],t=r[2];return{row:parseInt(u,10),col:/^\d*$/.test(t)?parseInt(t,10):t}}var f,r;t.__esModule=!0;f=function(){function n(n,t){var r=[],u=!0,f=!1,e=undefined,i,o;try{for(i=n[Symbol.iterator]();!(u=(o=i.next()).done);u=!0)if(r.push(o.value),t&&r.length===t)break}catch(s){f=!0;e=s}finally{try{!u&&i["return"]&&i["return"]()}finally{if(f)throw e;}}return r}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return n(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance");}}();t.cleanPatches=e;t.parsePath=u;r=i(0)},function(n,t,i){"use strict";function l(n){return n&&n.__esModule?n:{"default":n}}function r(n){this.query=function(t,i,u){var v=n.countRows(),y=n.countCols(),s=[],f,e,a;for(i||(i=r.global.getDefaultCallback()),u||(u=r.global.getDefaultQueryMethod()),f=0;f<v;f++)for(e=0;e<y;e++){var o=n.getDataAtCell(f,e),h=n.getCellMeta(f,e),c=h.search.callback||i,p=h.search.queryMethod||u,l=p(t,o);l&&(a={row:f,col:e,data:o},s.push(a));c&&c(n,f,e,o,l)}return s}}function a(n,t,i,u,e,o,s){var c=s.search!==null&&h(s.search)=="object"&&s.search.searchResultClass||r.global.getDefaultSearchResultClass();s.isSearchResult?f.addClass(t,c):f.removeClass(t,c)}function s(){var n=this,t=!!n.getSettings().search;t?n.search=new r(n):delete n.search}var o;t.__esModule=!0;var h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},c=i(14),u=l(c),f=i(2),e=i(15);r.DEFAULT_CALLBACK=function(n,t,i,r,u){n.getCellMeta(t,i).isSearchResult=u};r.DEFAULT_QUERY_METHOD=function(n,t){return typeof n=="undefined"||n==null||!n.toLowerCase||n.length===0?!1:typeof t=="undefined"||t==null?!1:t.toString().toLowerCase().indexOf(n.toLowerCase())!=-1};r.DEFAULT_SEARCH_RESULT_CLASS="htSearchResult";r.global=function(){var n=r.DEFAULT_CALLBACK,t=r.DEFAULT_QUERY_METHOD,i=r.DEFAULT_SEARCH_RESULT_CLASS;return{getDefaultCallback:function(){return n},setDefaultCallback:function(t){n=t},getDefaultQueryMethod:function(){return t},setDefaultQueryMethod:function(n){t=n},getDefaultSearchResultClass:function(){return i},setDefaultSearchResultClass:function(n){i=n}}}();o=e.getRenderer("base");e.registerRenderer("base",function(){o.apply(this,arguments);a.apply(this,arguments)});u.default.getSingleton().add("afterInit",s);u.default.getSingleton().add("afterUpdateSettings",s);t.default=r},function(n,t,i){"use strict";function v(n){return n&&n.__esModule?n:{"default":n}}function y(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function p(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function w(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var e;t.__esModule=!0;var o=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),f=function s(n,t,i){var r,u,f;return n===null&&(n=Function.prototype),r=Object.getOwnPropertyDescriptor(n,t),r===undefined?(u=Object.getPrototypeOf(n),u===null?undefined:s(u,t,i)):"value"in r?r.value:(f=r.get,f===undefined)?undefined:f.call(i)},r=i(2),u=i(0),h=i(7),c=v(h),l=i(6),a=i(43);e=function(n){function t(n){y(this,t);var i=p(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return i.scrollbars=[],i.clones=[],i.lockedCollection=!1,i.freezeOverlays=!1,i}return w(t,n),o(t,[{key:"isEnabled",value:function(){return a.isTouchSupported()}},{key:"enablePlugin",value:function(){var n=this;this.enabled||(this.addHook("afterRender",function(){return n.onAfterRender()}),this.registerEvents(),f(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.lockedCollection=!1;f(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){f(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disablePlugin",this).call(this)}},{key:"registerEvents",value:function(){var n=this;this.addHook("beforeTouchScroll",function(){return n.onBeforeTouchScroll()});this.addHook("afterMomentumScroll",function(){return n.onAfterMomentumScroll()})}},{key:"onAfterRender",value:function(){if(!this.lockedCollection){var t=this.hot.view.wt.wtOverlays,u=t.topOverlay,i=t.bottomOverlay,f=t.leftOverlay,r=t.topLeftCornerOverlay,n=t.bottomLeftCornerOverlay;this.lockedCollection=!0;this.scrollbars.length=0;this.scrollbars.push(u);i.clone&&this.scrollbars.push(i);this.scrollbars.push(f);r&&this.scrollbars.push(r);n&&n.clone&&this.scrollbars.push(n);this.clones.length=0;u.needFullRender&&this.clones.push(u.clone.wtTable.holder.parentNode);i.needFullRender&&this.clones.push(i.clone.wtTable.holder.parentNode);f.needFullRender&&this.clones.push(f.clone.wtTable.holder.parentNode);r&&this.clones.push(r.clone.wtTable.holder.parentNode);n&&n.clone&&this.clones.push(n.clone.wtTable.holder.parentNode)}}},{key:"onBeforeTouchScroll",value:function(){this.freezeOverlays=!0;u.arrayEach(this.clones,function(n){r.addClass(n,"hide-tween")})}},{key:"onAfterMomentumScroll",value:function(){var n=this;this.freezeOverlays=!1;u.arrayEach(this.clones,function(n){r.removeClass(n,"hide-tween");r.addClass(n,"show-tween")});setTimeout(function(){u.arrayEach(n.clones,function(n){r.removeClass(n,"show-tween")})},400);u.arrayEach(this.scrollbars,function(n){n.refresh();n.resetFixedPosition()});this.hot.view.wt.wtOverlays.syncScrollWithMaster()}}]),t}(c.default);l.registerPlugin("touchScroll",e);t.default=e},function(n,t,i){"use strict";function g(n){return n&&n.__esModule?n:{"default":n}}function c(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function l(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function a(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}function r(n){var t=this;this.instance=n;this.doneActions=[];this.undoneActions=[];this.ignoreNewActions=!1;n.addHook("afterChange",function(n,i){n&&i!=="UndoRedo.undo"&&i!=="UndoRedo.redo"&&i!=="MergeCells"&&t.done(new r.ChangeAction(n))});n.addHook("afterCreateRow",function(n,i,u){if(u!=="UndoRedo.undo"&&u!=="UndoRedo.undo"&&u!=="auto"){var f=new r.CreateRowAction(n,i);t.done(f)}});n.addHook("beforeRemoveRow",function(n,i,f,e){var o,s;e!=="UndoRedo.undo"&&e!=="UndoRedo.redo"&&e!=="auto"&&(o=t.instance.getSourceDataArray(),n=(o.length+n)%o.length,s=u.deepClone(o.slice(n,n+i)),t.done(new r.RemoveRowAction(n,s)))});n.addHook("afterCreateCol",function(n,i,u){u!=="UndoRedo.undo"&&u!=="UndoRedo.redo"&&u!=="auto"&&t.done(new r.CreateColumnAction(n,i))});n.addHook("beforeRemoveCol",function(i,u,e,o){var s;if(o!=="UndoRedo.undo"&&o!=="UndoRedo.redo"&&o!=="auto"){s=t.instance.getSourceDataArray();i=(t.instance.countCols()+i)%t.instance.countCols();var h=[],c=[],l=[];f.rangeEach(s.length-1,function(t){var r=[],e=s[t];f.rangeEach(i,i+(u-1),function(t){r.push(e[n.runHooks("modifyCol",t)])});h.push(r)});f.rangeEach(u-1,function(t){l.push(n.runHooks("modifyCol",i+t))});Array.isArray(n.getSettings().colHeaders)&&f.rangeEach(u-1,function(t){c.push(n.getSettings().colHeaders[n.runHooks("modifyCol",i+t)]||null)});var a=t.instance.getPlugin("manualColumnMove"),v=a.isEnabled()?a.columnsMapper.__arrayMap:[],y=new r.RemoveColumnAction(i,l,h,c,v);t.done(y)}});n.addHook("beforeCellAlignment",function(n,i,u,f){var e=new r.CellAlignmentAction(n,i,u,f);t.done(e)});n.addHook("beforeFilter",function(n){t.done(new r.FiltersAction(n))});n.addHook("beforeRowMove",function(n,i){n!==!1&&t.done(new r.RowMoveAction(n,i))});n.addHook("beforeMergeCells",function(i,u){u||t.done(new r.MergeCellsAction(n,i))});n.addHook("afterUnmergeCells",function(i,u){u||t.done(new r.UnmergeCellsAction(n,i))})}function p(){var n=this,t=typeof n.getSettings().undo=="undefined"||n.getSettings().undo;t?n.undoRedo||(n.undoRedo=new r(n),nt(n),n.addHook("beforeKeyDown",w),n.addHook("afterChange",b)):n.undoRedo&&(delete n.undoRedo,tt(n),n.removeHook("beforeKeyDown",w),n.removeHook("afterChange",b))}function w(n){var t=this,i=(n.ctrlKey||n.metaKey)&&!n.altKey;i&&(n.keyCode===89||n.shiftKey&&n.keyCode===90?(t.undoRedo.redo(),h.stopImmediatePropagation(n)):n.keyCode===90&&(t.undoRedo.undo(),h.stopImmediatePropagation(n)))}function b(n,t){var i=this;if(t==="loadData")return i.undoRedo.clear()}function nt(n){n.undo=function(){return n.undoRedo.undo()};n.redo=function(){return n.undoRedo.redo()};n.isUndoAvailable=function(){return n.undoRedo.isUndoAvailable()};n.isRedoAvailable=function(){return n.undoRedo.isRedoAvailable()};n.clearUndo=function(){return n.undoRedo.clear()}}function tt(n){delete n.undo;delete n.redo;delete n.isUndoAvailable;delete n.isRedoAvailable;delete n.clearUndo}var v,y,e;t.__esModule=!0;var s=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),k=i(14),d=g(k),o=i(0),f=i(4),u=i(1),h=i(11),it=i(8);r.prototype.done=function(n){this.ignoreNewActions||(this.doneActions.push(n),this.undoneActions.length=0)};r.prototype.undo=function(){var t;if(this.isUndoAvailable()){var n=this.doneActions.pop(),i=u.deepClone(n),r=this.instance,f=r.runHooks("beforeUndo",i);if(f===!1)return;this.ignoreNewActions=!0;t=this;n.undo(this.instance,function(){t.ignoreNewActions=!1;t.undoneActions.push(n)});r.runHooks("afterUndo",i)}};r.prototype.redo=function(){var t;if(this.isRedoAvailable()){var n=this.undoneActions.pop(),i=u.deepClone(n),r=this.instance,f=r.runHooks("beforeRedo",i);if(f===!1)return;this.ignoreNewActions=!0;t=this;n.redo(this.instance,function(){t.ignoreNewActions=!1;t.doneActions.push(n)});r.runHooks("afterRedo",i)}};r.prototype.isUndoAvailable=function(){return this.doneActions.length>0};r.prototype.isRedoAvailable=function(){return this.undoneActions.length>0};r.prototype.clear=function(){this.doneActions.length=0;this.undoneActions.length=0};r.Action=function(){};r.Action.prototype.undo=function(){};r.Action.prototype.redo=function(){};r.ChangeAction=function(n){this.changes=n;this.actionType="change"};u.inherit(r.ChangeAction,r.Action);r.ChangeAction.prototype.undo=function(n,t){for(var r,e,i=u.deepClone(this.changes),o=n.countEmptyRows(!0),s=n.countEmptyCols(!0),f=0,h=i.length;f<h;f++)i[f].splice(3,1);for(n.addHookOnce("afterChange",t),n.setDataAtRowProp(i,null,null,"UndoRedo.undo"),r=0,e=i.length;r<e;r++)n.getSettings().minSpareRows&&i[r][0]+1+n.getSettings().minSpareRows===n.countRows()&&o===n.getSettings().minSpareRows&&(n.alter("remove_row",parseInt(i[r][0]+1,10),n.getSettings().minSpareRows),n.undoRedo.doneActions.pop()),n.getSettings().minSpareCols&&i[r][1]+1+n.getSettings().minSpareCols===n.countCols()&&s===n.getSettings().minSpareCols&&(n.alter("remove_col",parseInt(i[r][1]+1,10),n.getSettings().minSpareCols),n.undoRedo.doneActions.pop())};r.ChangeAction.prototype.redo=function(n,t){for(var i=u.deepClone(this.changes),r=0,f=i.length;r<f;r++)i[r].splice(2,1);n.addHookOnce("afterChange",t);n.setDataAtRowProp(i,null,null,"UndoRedo.redo")};r.CreateRowAction=function(n,t){this.index=n;this.amount=t;this.actionType="insert_row"};u.inherit(r.CreateRowAction,r.Action);r.CreateRowAction.prototype.undo=function(n,t){var i=n.countRows(),r=n.getSettings().minSpareRows;this.index>=i&&this.index-r<i&&(this.index-=r);n.addHookOnce("afterRemoveRow",t);n.alter("remove_row",this.index,this.amount,"UndoRedo.undo")};r.CreateRowAction.prototype.redo=function(n,t){n.addHookOnce("afterCreateRow",t);n.alter("insert_row",this.index,this.amount,"UndoRedo.redo")};r.RemoveRowAction=function(n,t){this.index=n;this.data=t;this.actionType="remove_row"};u.inherit(r.RemoveRowAction,r.Action);r.RemoveRowAction.prototype.undo=function(n,t){n.alter("insert_row",this.index,this.data.length,"UndoRedo.undo");n.addHookOnce("afterRender",t);n.populateFromArray(this.index,0,this.data,void 0,void 0,"UndoRedo.undo")};r.RemoveRowAction.prototype.redo=function(n,t){n.addHookOnce("afterRemoveRow",t);n.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")};r.CreateColumnAction=function(n,t){this.index=n;this.amount=t;this.actionType="insert_col"};u.inherit(r.CreateColumnAction,r.Action);r.CreateColumnAction.prototype.undo=function(n,t){n.addHookOnce("afterRemoveCol",t);n.alter("remove_col",this.index,this.amount,"UndoRedo.undo")};r.CreateColumnAction.prototype.redo=function(n,t){n.addHookOnce("afterCreateCol",t);n.alter("insert_col",this.index,this.amount,"UndoRedo.redo")};r.RemoveColumnAction=function(n,t,i,r,u){this.index=n;this.indexes=t;this.data=i;this.amount=this.data[0].length;this.headers=r;this.columnPositions=u.slice(0);this.actionType="remove_col"};u.inherit(r.RemoveColumnAction,r.Action);r.RemoveColumnAction.prototype.undo=function(n,t){var s=this,h=void 0,i=this.indexes.slice(0).sort(),c=function(n,t,r){return r[s.indexes.indexOf(i[t])]},u=[],r,e;if(f.rangeEach(this.data.length-1,function(n){u[n]=o.arrayMap(s.data[n],c)}),r=[],r=o.arrayMap(this.headers,c),e=[],n.runHooks("beforeCreateCol",this.indexes[0],this.indexes.length,"UndoRedo.undo"),f.rangeEach(this.data.length-1,function(t){h=n.getSourceDataAtRow(t);f.rangeEach(i.length-1,function(n){h.splice(i[n],0,u[t][n]);e.push([t,i[n],null,u[t][n]])})}),n.getPlugin("formulas"))n.getPlugin("formulas").onAfterSetDataAtCell(e);typeof this.headers!="undefined"&&f.rangeEach(r.length-1,function(t){n.getSettings().colHeaders.splice(i[t],0,r[t])});n.getPlugin("manualColumnMove")&&(n.getPlugin("manualColumnMove").columnsMapper.__arrayMap=this.columnPositions);n.addHookOnce("afterRender",t);n.runHooks("afterCreateCol",this.indexes[0],this.indexes.length,"UndoRedo.undo");n.getPlugin("formulas")&&n.getPlugin("formulas").recalculateFull();n.render()};r.RemoveColumnAction.prototype.redo=function(n,t){n.addHookOnce("afterRemoveCol",t);n.alter("remove_col",this.index,this.amount,"UndoRedo.redo")};r.CellAlignmentAction=function(n,t,i,r){this.stateBefore=n;this.range=t;this.type=i;this.alignment=r};r.CellAlignmentAction.prototype.undo=function(n,t){var i=this;n.getPlugin("contextMenu").isEnabled()&&(o.arrayEach(this.range,function(t){for(var r,f=t.from,e=t.to,u=f.row;u<=e.row;u++)for(r=f.col;r<=e.col;r++)n.setCellMeta(u,r,"className",i.stateBefore[u][r]||" htLeft")}),n.addHookOnce("afterRender",t),n.render())};r.CellAlignmentAction.prototype.redo=function(n,t){var i=this;n.getPlugin("contextMenu").isEnabled()&&(o.arrayEach(this.range,function(t){var r=t.from,u=t.to;n.selectCell(r.row,r.col,u.row,u.col);n.getPlugin("contextMenu").executeCommand("alignment:"+i.alignment.replace("ht","").toLowerCase())}),n.addHookOnce("afterRender",t),n.render())};r.FiltersAction=function(n){this.conditionsStack=n;this.actionType="filter"};u.inherit(r.FiltersAction,r.Action);r.FiltersAction.prototype.undo=function(n,t){var i=n.getPlugin("filters");n.addHookOnce("afterRender",t);i.conditionCollection.importAllConditions(this.conditionsStack.slice(0,this.conditionsStack.length-1));i.filter()};r.FiltersAction.prototype.redo=function(n,t){var i=n.getPlugin("filters");n.addHookOnce("afterRender",t);i.conditionCollection.importAllConditions(this.conditionsStack);i.filter()};v=function(n){function t(n,i){c(this,t);var r=l(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return r.cellRange=i,r.rangeData=n.getData(i.from.row,i.from.col,i.to.row,i.to.col),r}return a(t,n),s(t,[{key:"undo",value:function(n,t){var i=n.getPlugin("mergeCells");n.addHookOnce("afterRender",t);i.unmergeRange(this.cellRange,!0);n.populateFromArray(this.cellRange.from.row,this.cellRange.from.col,this.rangeData,void 0,void 0,"MergeCells")}},{key:"redo",value:function(n,t){var i=n.getPlugin("mergeCells");n.addHookOnce("afterRender",t);i.mergeRange(this.cellRange)}}]),t}(r.Action);r.MergeCellsAction=v;y=function(n){function t(n,i){c(this,t);var r=l(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return r.cellRange=i,r}return a(t,n),s(t,[{key:"undo",value:function(n,t){var i=n.getPlugin("mergeCells");n.addHookOnce("afterRender",t);i.mergeRange(this.cellRange,!0)}},{key:"redo",value:function(n,t){var i=n.getPlugin("mergeCells");n.addHookOnce("afterRender",t);i.unmergeRange(this.cellRange,!0);n.render()}}]),t}(r.Action);r.UnmergeCellsAction=y;r.RowMoveAction=function(n,t){this.rows=n.slice();this.target=t};u.inherit(r.RowMoveAction,r.Action);r.RowMoveAction.prototype.undo=function(n,t){var f=n.getPlugin("manualRowMove"),i;n.addHookOnce("afterRender",t);var r=this.rows[0]<this.target?-1*this.rows.length:0,e=this.rows[0]>this.target?this.rows[0]+this.rows.length:this.rows[0],u=[],o=this.rows.length+r;for(i=r;i<o;i+=1)u.push(this.target+i);f.moveRows(u.slice(),e);n.render();n.selectCell(this.rows[0],0,this.rows[this.rows.length-1],n.countCols()-1,!1,!1)};r.RowMoveAction.prototype.redo=function(n,t){var r=n.getPlugin("manualRowMove"),i;n.addHookOnce("afterRender",t);r.moveRows(this.rows.slice(),this.target);n.render();i=this.rows[0]<this.target?this.target-this.rows.length:this.target;n.selectCell(i,0,i+this.rows.length-1,n.countCols()-1,!1,!1)};e=d.default.getSingleton();e.add("afterInit",p);e.add("afterUpdateSettings",p);e.register("beforeUndo");e.register("afterUndo");e.register("beforeRedo");e.register("afterRedo");t.default=r},function(n,t,i){"use strict";function r(n){return n&&n.__esModule?n:{"default":n}}t.__esModule=!0;t.TrimRows=t.NestedRows=t.NestedHeaders=t.HiddenRows=t.HiddenColumns=t.HeaderTooltips=t.GanttChart=t.Formulas=t.Filters=t.ExportFile=t.DropdownMenu=t.ColumnSummary=t.CollapsibleColumns=t.BindRowsWithHeaders=undefined;var u=i(623),f=r(u),e=i(628),o=r(e),s=i(629),h=r(s),c=i(631),l=r(c),a=i(633),v=r(a),y=i(638),p=r(y),w=i(667),b=r(w),k=i(680),d=r(k),g=i(683),nt=r(g),tt=i(684),it=r(tt),rt=i(687),ut=r(rt),ft=i(692),et=r(ft),ot=i(696),st=r(ot),ht=i(700),ct=r(ht);t.BindRowsWithHeaders=f.default;t.CollapsibleColumns=o.default;t.ColumnSummary=h.default;t.DropdownMenu=l.default;t.ExportFile=v.default;t.Filters=p.default;t.Formulas=b.default;t.GanttChart=d.default;t.HeaderTooltips=nt.default;t.HiddenColumns=et.default;t.HiddenRows=st.default;t.NestedHeaders=it.default;t.NestedRows=ut.default;t.TrimRows=ct.default},function(n,t,i){"use strict";function e(n){return n&&n.__esModule?n:{"default":n}}function y(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function p(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function w(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var u;t.__esModule=!0;var o=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),r=function s(n,t,i){var r,u,f;return n===null&&(n=Function.prototype),r=Object.getOwnPropertyDescriptor(n,t),r===undefined?(u=Object.getPrototypeOf(n),u===null?undefined:s(u,t,i)):"value"in r?r.value:(f=r.get,f===undefined)?undefined:f.call(i)},h=i(7),c=e(h),b=i(0),l=i(4),a=i(6),v=i(624),f=e(v);u=function(n){function t(n){y(this,t);var i=p(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return i.bindStrategy=new f.default,i.removedRows=[],i}return w(t,n),o(t,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().bindRowsWithHeaders}},{key:"enablePlugin",value:function(){var n=this,i;this.enabled||(i=this.hot.getSettings().bindRowsWithHeaders,typeof i!="string"&&(i=f.default.DEFAULT_STRATEGY),this.bindStrategy.setStrategy(i),this.bindStrategy.createMap(this.hot.countSourceRows()),this.addHook("modifyRowHeader",function(t){return n.onModifyRowHeader(t)}),this.addHook("afterCreateRow",function(t,i){return n.onAfterCreateRow(t,i)}),this.addHook("beforeRemoveRow",function(t,i){return n.onBeforeRemoveRow(t,i)}),this.addHook("afterRemoveRow",function(t,i){return n.onAfterRemoveRow(t,i)}),this.addHook("afterLoadData",function(t){return n.onAfterLoadData(t)}),r(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){r(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.removedRows.length=0;this.bindStrategy.clearMap();r(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disablePlugin",this).call(this)}},{key:"onModifyRowHeader",value:function(n){return this.bindStrategy.translate(this.hot.runHooks("modifyRow",n))}},{key:"onAfterCreateRow",value:function(n,t){this.bindStrategy.createRow(n,t)}},{key:"onBeforeRemoveRow",value:function(n,t){var i=this;this.removedRows.length=0;n!==!1&&l.rangeEach(n,n+t-1,function(n){i.removedRows.push(i.hot.runHooks("modifyRow",n))})}},{key:"onAfterRemoveRow",value:function(){this.bindStrategy.removeRow(this.removedRows)}},{key:"onAfterLoadData",value:function(n){n||this.bindStrategy.createMap(this.hot.countSourceRows())}},{key:"destroy",value:function(){this.bindStrategy.destroy();r(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}}]),t}(c.default);a.registerPlugin("bindRowsWithHeaders",u);t.default=u},function(n,t,i){"use strict";function h(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function c(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var u;t.__esModule=!0;var r=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),l=i(54),a=i(1),f=i(4),e=i(31),o=i(625),s=h(o);u=function(){function n(){c(this,n);this.strategy=null}return r(n,null,[{key:"DEFAULT_STRATEGY",get:function(){return"loose"}}]),r(n,[{key:"setStrategy",value:function(n){var t=s[e.toUpperCaseFirst(n)];if(!t)throw new Error('Bind strategy "'+n+'" does not exist.');this.strategy=new t}},{key:"createMap",value:function(n){var t=this.strategy,i=n===void 0?t._arrayMap.length:n;t._arrayMap.length=0;f.rangeEach(i-1,function(n){t._arrayMap.push(n)})}},{key:"createRow",value:function(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];this.strategy.createRow.apply(this.strategy,i)}},{key:"removeRow",value:function(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];this.strategy.removeRow.apply(this.strategy,i)}},{key:"translate",value:function(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];return this.strategy.getValueByIndex.apply(this.strategy,i)}},{key:"clearMap",value:function(){this.strategy.clearMap()}},{key:"destroy",value:function(){this.strategy&&this.strategy.destroy();this.strategy=null}}]),n}();t.default=u},function(n,t,i){"use strict";function r(n){return n&&n.__esModule?n:{"default":n}}t.__esModule=!0;t.Strict=t.Loose=undefined;var u=i(626),f=r(u),e=i(627),o=r(e);t.Loose=f.default;t.Strict=o.default},function(n,t,i){"use strict";function s(n){return n&&n.__esModule?n:{"default":n}}function h(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var r;t.__esModule=!0;var u=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),f=i(54),e=s(f),o=i(1);r=function(){function n(){h(this,n)}return u(n,[{key:"createRow",value:function(n,t){this.shiftItems(n,t)}},{key:"removeRow",value:function(n,t){this.unshiftItems(n,t)}},{key:"destroy",value:function(){this._arrayMap=null}}],[{key:"STRATEGY_NAME",get:function(){return"loose"}}]),n}();o.mixin(r,e.default);t.default=r},function(n,t,i){"use strict";function s(n){return n&&n.__esModule?n:{"default":n}}function h(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var r;t.__esModule=!0;var u=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),f=i(54),e=s(f),o=i(1);r=function(){function n(){h(this,n)}return u(n,[{key:"createRow",value:function(n,t){this.insertItems(n,t)}},{key:"removeRow",value:function(n,t){this.removeItems(n,t)}},{key:"destroy",value:function(){this._arrayMap=null}}],[{key:"STRATEGY_NAME",get:function(){return"strict"}}]),n}();o.mixin(r,e.default);t.default=r},function(n,t,i){"use strict";function h(n){return n&&n.__esModule?n:{"default":n}}function k(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function d(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function g(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var o;t.__esModule=!0;var c=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),u=function l(n,t,i){var r,u,f;return n===null&&(n=Function.prototype),r=Object.getOwnPropertyDescriptor(n,t),r===undefined?(u=Object.getPrototypeOf(n),u===null?undefined:l(u,t,i)):"value"in r?r.value:(f=r.get,f===undefined)?undefined:f.call(i)},f=i(1),s=i(0),e=i(4),r=i(2),a=i(9),v=h(a),y=i(6),p=i(11),w=i(7),b=h(w);o=function(n){function t(n){k(this,t);var i=d(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return i.settings=null,i.buttonEnabledList={},i.hiddenColumnsPlugin=null,i.nestedHeadersPlugin=null,i.collapsedSections={},i.columnHeaderLevelCount=null,i.eventManager=null,i}return g(t,n),c(t,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().collapsibleColumns}},{key:"enablePlugin",value:function(){var n=this;this.enabled||(this.settings=this.hot.getSettings().collapsibleColumns,typeof this.settings!="boolean"&&this.parseSettings(),this.hiddenColumnsPlugin=this.hot.getPlugin("hiddenColumns"),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.checkDependencies(),this.addHook("afterRender",function(){return n.onAfterRender()}),this.addHook("afterInit",function(){return n.onAfterInit()}),this.addHook("afterGetColHeader",function(t,i){return n.onAfterGetColHeader(t,i)}),this.addHook("beforeOnCellMouseDown",function(t,i,r){return n.onBeforeOnCellMouseDown(t,i,r)}),this.eventManager=new v.default(this.hot),u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.settings=null;this.buttonEnabledList={};this.hiddenColumnsPlugin=null;this.collapsedSections={};this.clearButtons();u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disablePlugin",this).call(this)}},{key:"clearButtons",value:function(){if(this.hot.view){var i=this.hot.view.wt.getSetting("columnHeaders").length,r=this.hot.view.wt.wtTable.THEAD,u=this.hot.view.wt.wtOverlays.topOverlay.clone.wtTable.THEAD,n=this.hot.view.wt.wtOverlays.topLeftCornerOverlay?this.hot.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.THEAD:null,t=function(n){n&&n.parentNode.removeChild(n)};e.rangeEach(0,i-1,function(i){var s=r.childNodes[i],f=u.childNodes[i],o=n?n.childNodes[i]:null;e.rangeEach(0,s.childNodes.length-1,function(i){var r=s.childNodes[i].querySelector(".collapsibleIndicator");t(r);f&&f.childNodes[i]&&(r=f.childNodes[i].querySelector(".collapsibleIndicator"),t(r));n&&o&&o.childNodes[i]&&(r=o.childNodes[i].querySelector(".collapsibleIndicator"),t(r))})},!0)}}},{key:"parseSettings",value:function(){var n=this;f.objectEach(this.settings,function(t){n.buttonEnabledList[t.row]||(n.buttonEnabledList[t.row]={});n.buttonEnabledList[t.row][t.col]=t.collapsible})}},{key:"meetsDependencies",value:function(){var n=this.hot.getSettings();return n.nestedHeaders&&n.hiddenColumns}},{key:"checkDependencies",value:function(){var n=this.hot.getSettings();this.meetsDependencies()||(n.nestedHeaders||console.warn("You need to configure the Nested Headers plugin in order to use collapsible headers."),n.hiddenColumns||console.warn("You need to configure the Hidden Columns plugin in order to use collapsible headers."))}},{key:"generateIndicator",value:function(n,t){var f=t.parentNode,e=f.parentNode,u=-1*e.childNodes.length+Array.prototype.indexOf.call(e.childNodes,f),i;return Object.keys(this.buttonEnabledList).length>0&&(!this.buttonEnabledList[u]||!this.buttonEnabledList[u][n])?null:(i=document.createElement("DIV"),r.addClass(i,"collapsibleIndicator"),this.collapsedSections[u]&&this.collapsedSections[u][n]===!0?(r.addClass(i,"collapsed"),r.fastInnerText(i,"+")):(r.addClass(i,"expanded"),r.fastInnerText(i,"-")),i)}},{key:"markSectionAs",value:function(n,t,i,r){var u;this.collapsedSections[t]||(this.collapsedSections[t]={});switch(n){case"collapsed":this.collapsedSections[t][i]=!0;break;case"expanded":this.collapsedSections[t][i]=void 0}if(r){var o=this.nestedHeadersPlugin.colspanArray,s=this.nestedHeadersPlugin.rowCoordsToLevel(t),f=this.nestedHeadersPlugin.getChildHeaders(t,i),e=o[s+1];for(u=1;u<f.length;u++)e&&e[f[u]].colspan>1&&this.markSectionAs(n,t+1,f[u],!0)}}},{key:"expandSection",value:function(n){this.markSectionAs("expanded",n.row,n.col,!0);this.toggleCollapsibleSection(n,"expand")}},{key:"collapseSection",value:function(n){this.markSectionAs("collapsed",n.row,n.col,!0);this.toggleCollapsibleSection(n,"collapse")}},{key:"toggleAllCollapsibleSections",value:function(n){var t=this,i=this.nestedHeadersPlugin.colspanArray;this.settings===!0?s.arrayEach(i,function(i,r){s.arrayEach(i,function(i,u){if(i.colspan>1){r=parseInt(r,10);u=parseInt(u,10);var f=t.nestedHeadersPlugin.levelToRowCoords(r),e=u;t.markSectionAs(n==="collapse"?"collapsed":"expanded",f,e,!0);t.toggleCollapsibleSection({row:f,col:e},n)}})}):f.objectEach(this.buttonEnabledList,function(i,r){f.objectEach(i,function(i,u){r=parseInt(r,10);u=parseInt(u,10);t.markSectionAs(n==="collapse"?"collapsed":"expanded",r,u,!0);t.toggleCollapsibleSection({row:r,col:u},n)})})}},{key:"collapseAll",value:function(){this.toggleAllCollapsibleSections("collapse")}},{key:"expandAll",value:function(){this.toggleAllCollapsibleSections("expand")}},{key:"toggleCollapsibleSection",value:function(n,t){var s=this;n.row&&(n.row=parseInt(n.row,10));n.col&&(n.col=parseInt(n.col,10));for(var u=this.hiddenColumnsPlugin.hiddenColumns,f=this.nestedHeadersPlugin.colspanArray,h=this.nestedHeadersPlugin.rowCoordsToLevel(n.row),c=f[h][n.col].colspan,l=this.nestedHeadersPlugin.getChildHeaders(n.row,n.col),r=h+1,i=f[r],o=i?i[l[0]].colspan||1:1;o===c&&r<this.columnHeaderLevelCount;)r+=1,i=f[r],o=i?i[l[0]].colspan||1:1;e.rangeEach(o,c-1,function(i){var r=n.col+i;switch(t){case"collapse":s.hiddenColumnsPlugin.isHidden(r)||u.push(r);break;case"expand":s.hiddenColumnsPlugin.isHidden(r)&&u.splice(u.indexOf(r),1)}});this.hot.render()}},{key:"onAfterGetColHeader",value:function(n,t){if(t.hasAttribute("colspan")&&t.getAttribute("colspan")>1&&n>=this.hot.getSettings().fixedColumnsLeft){var i=this.generateIndicator(n,t);i!==null&&t.querySelector("div:first-child").appendChild(i)}}},{key:"onBeforeOnCellMouseDown",value:function(n,t){if(r.hasClass(n.target,"collapsibleIndicator"))return r.hasClass(n.target,"expanded")?(this.collapsedSections[t.row]||(this.collapsedSections[t.row]=[]),this.markSectionAs("collapsed",t.row,t.col,!0),this.eventManager.fireEvent(n.target,"mouseup"),this.toggleCollapsibleSection(t,"collapse")):r.hasClass(n.target,"collapsed")&&(this.markSectionAs("expanded",t.row,t.col,!0),this.eventManager.fireEvent(n.target,"mouseup"),this.toggleCollapsibleSection(t,"expand")),p.stopImmediatePropagation(n),!1}},{key:"onAfterInit",value:function(){this.columnHeaderLevelCount=this.hot.view.wt.getSetting("columnHeaders").length}},{key:"onAfterRender",value:function(){this.nestedHeadersPlugin.enabled&&this.hiddenColumnsPlugin.enabled||this.disablePlugin()}},{key:"destroy",value:function(){this.settings=null;this.buttonEnabledList=null;this.hiddenColumnsPlugin=null;this.nestedHeadersPlugin=null;this.collapsedSections=null;this.columnHeaderLevelCount=null;u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}}]),t}(b.default);y.registerPlugin("collapsibleColumns",o);t.default=o},function(n,t,i){"use strict";function f(n){return n&&n.__esModule?n:{"default":n}}function y(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function p(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function w(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var u;t.__esModule=!0;var e=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),o=function s(n,t,i){var r,u,f;return n===null&&(n=Function.prototype),r=Object.getOwnPropertyDescriptor(n,t),r===undefined?(u=Object.getPrototypeOf(n),u===null?undefined:s(u,t,i)):"value"in r?r.value:(f=r.get,f===undefined)?undefined:f.call(i)},h=i(7),c=f(h),r=i(1),b=i(0),l=i(6),a=i(630),v=f(a);u=function(n){function t(n){y(this,t);var i=p(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return i.endpoints=null,i}return w(t,n),e(t,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().columnSummary}},{key:"enablePlugin",value:function(){var n=this;this.enabled||(this.settings=this.hot.getSettings().columnSummary,this.endpoints=new v.default(this,this.settings),this.addHook("afterInit",function(){return n.onAfterInit.apply(n,arguments)}),this.addHook("afterChange",function(){return n.onAfterChange.apply(n,arguments)}),this.addHook("beforeCreateRow",function(t,i,r){return n.endpoints.resetSetupBeforeStructureAlteration("insert_row",t,i,null,r)}),this.addHook("beforeCreateCol",function(t,i,r){return n.endpoints.resetSetupBeforeStructureAlteration("insert_col",t,i,null,r)}),this.addHook("beforeRemoveRow",function(){for(var i,r=arguments.length,u=Array(r),t=0;t<r;t++)u[t]=arguments[t];return(i=n.endpoints).resetSetupBeforeStructureAlteration.apply(i,["remove_row"].concat(u))}),this.addHook("beforeRemoveCol",function(){for(var i,r=arguments.length,u=Array(r),t=0;t<r;t++)u[t]=arguments[t];return(i=n.endpoints).resetSetupBeforeStructureAlteration.apply(i,["remove_col"].concat(u))}),this.addHook("beforeRowMove",function(){return n.onBeforeRowMove.apply(n,arguments)}),this.addHook("afterCreateRow",function(t,i,r){return n.endpoints.resetSetupAfterStructureAlteration("insert_row",t,i,null,r)}),this.addHook("afterCreateCol",function(t,i,r){return n.endpoints.resetSetupAfterStructureAlteration("insert_col",t,i,null,r)}),this.addHook("afterRemoveRow",function(){for(var i,r=arguments.length,u=Array(r),t=0;t<r;t++)u[t]=arguments[t];return(i=n.endpoints).resetSetupAfterStructureAlteration.apply(i,["remove_row"].concat(u))}),this.addHook("afterRemoveCol",function(){for(var i,r=arguments.length,u=Array(r),t=0;t<r;t++)u[t]=arguments[t];return(i=n.endpoints).resetSetupAfterStructureAlteration.apply(i,["remove_col"].concat(u))}),this.addHook("afterRowMove",function(){return n.onAfterRowMove.apply(n,arguments)}),o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.endpoints=null;this.settings=null;this.currentEndpoint=null}},{key:"calculate",value:function(n){switch(n.type.toLowerCase()){case"sum":n.result=this.calculateSum(n);break;case"min":n.result=this.calculateMinMax(n,n.type);break;case"max":n.result=this.calculateMinMax(n,n.type);break;case"count":n.result=this.countEntries(n);break;case"average":n.result=this.calculateAverage(n);break;case"custom":n.result=n.customFunction.call(this,n)}}},{key:"calculateSum",value:function(n){var t=0;for(var i in n.ranges)r.hasOwnProperty(n.ranges,i)&&(t+=this.getPartialSum(n.ranges[i],n.sourceColumn));return t}},{key:"getPartialSum",value:function(n,t){var e=0,r=n[1]||n[0],u=null,i=0,f;do u=this.getCellValue(r,t)||0,f=((u+"").split(".")[1]||[]).length||1,f>i&&(i=f),e+=u||0,r--;while(r>=n[0]);return Math.round(e*Math.pow(10,i))/Math.pow(10,i)}},{key:"calculateMinMax",value:function(n,t){var i=null,f,u;for(f in n.ranges)if(r.hasOwnProperty(n.ranges,f)&&(u=this.getPartialMinMax(n.ranges[f],n.sourceColumn,t),i===null&&u!==null&&(i=u),u!==null))switch(t){case"min":i=Math.min(i,u);break;case"max":i=Math.max(i,u)}return i===null?"Not enough data":i}},{key:"getPartialMinMax",value:function(n,t,i){var r=null,f=n[1]||n[0],u=void 0;do{if(u=this.getCellValue(f,t)||null,r===null)r=u;else if(u!==null)switch(i){case"min":r=Math.min(r,u);break;case"max":r=Math.max(r,u)}f--}while(f>=n[0]);return r}},{key:"countEmpty",value:function(n,t){var r=void 0,u=0,i=n[1]||n[0];do r=this.getCellValue(i,t),r||u++,i--;while(i>=n[0]);return u}},{key:"countEntries",value:function(n){var u=0,t=n.ranges,i,f,e;for(i in t)r.hasOwnProperty(t,i)&&(f=t[i][1]===void 0?1:t[i][1]-t[i][0]+1,e=this.countEmpty(t[i],n.sourceColumn),u+=f,u-=e);return u}},{key:"calculateAverage",value:function(n){var t=this.calculateSum(n),i=this.countEntries(n);return t/i}},{key:"getCellValue",value:function(n,t){var r=this.endpoints.getVisualRowIndex(n),u=this.endpoints.getVisualColumnIndex(t),i=this.hot.getSourceDataAtCell(n,t),f=this.hot.getCellMeta(r,u).className||"";if(f.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof i=="string"&&(i=i.replace(/,/,".")),i=parseFloat(i)),isNaN(i)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error("ColumnSummary plugin: cell at ("+n+", "+t+") is not in a numeric format. Cannot do the calculation.");return i}},{key:"onAfterInit",value:function(){this.endpoints.endpoints=this.endpoints.parseSettings();this.endpoints.refreshAllEndpoints(!0)}},{key:"onAfterChange",value:function(n,t){n&&t!=="ColumnSummary.reset"&&t!=="ColumnSummary.set"&&t!=="loadData"&&this.endpoints.refreshChangedEndpoints(n)}},{key:"onBeforeRowMove",value:function(n){this.endpoints.resetSetupBeforeStructureAlteration("move_row",n[0],n.length,n,this.pluginName)}},{key:"onAfterRowMove",value:function(n,t){this.endpoints.resetSetupAfterStructureAlteration("move_row",t,n.length,n,this.pluginName)}}]),t}(c.default);l.registerPlugin("columnSummary",u);t.default=u},function(n,t,i){"use strict";function s(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var u;t.__esModule=!0;var f=function(){function n(n,t){var r=[],u=!0,f=!1,e=undefined,i,o;try{for(i=n[Symbol.iterator]();!(u=(o=i.next()).done);u=!0)if(r.push(o.value),t&&r.length===t)break}catch(s){f=!0;e=s}finally{try{!u&&i["return"]&&i["return"]()}finally{if(f)throw e;}}return r}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return n(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance");}}(),e=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),r=i(0),h=i(1),o=i(53);u=function(){function n(t,i){s(this,n);this.plugin=t;this.hot=this.plugin.hot;this.endpoints=[];this.settings=i;this.settingsType="array";this.currentEndpoint=null;this.cellsToSetCache=[];this.recordTranslator=o.getTranslator(this.hot)}return e(n,[{key:"getEndpoint",value:function(n){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[n]:this.endpoints[n]}},{key:"getAllEndpoints",value:function(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}},{key:"fillMissingEndpointData",value:function(n){return this.parseSettings(n.call(this))}},{key:"parseSettings",value:function(n){var t=this,i=[];if(!n&&typeof this.settings=="function"){this.settingsType="function";return}return n||(n=this.settings),r.arrayEach(n,function(n){var r={};t.assignSetting(n,r,"ranges",[[0,t.hot.countRows()-1]]);t.assignSetting(n,r,"reversedRowCoords",!1);t.assignSetting(n,r,"destinationRow",new Error("\n        You must provide a destination row for the Column Summary plugin in order to work properly!\n      "));t.assignSetting(n,r,"destinationColumn",new Error("\n        You must provide a destination column for the Column Summary plugin in order to work properly!\n      "));t.assignSetting(n,r,"sourceColumn",n.destinationColumn);t.assignSetting(n,r,"type","sum");t.assignSetting(n,r,"forceNumeric",!1);t.assignSetting(n,r,"suppressDataTypeErrors",!0);t.assignSetting(n,r,"suppressDataTypeErrors",!0);t.assignSetting(n,r,"customFunction",null);t.assignSetting(n,r,"readOnly",!0);t.assignSetting(n,r,"roundFloat",!1);i.push(r)}),i}},{key:"assignSetting",value:function(n,t,i,r){if(i==="ranges"&&n[i]===void 0){t[i]=r;return}if(i!=="ranges"||n[i].length!==0)if(n[i]===void 0){if(r instanceof Error)throw r;t[i]=r}else t[i]=i==="destinationRow"&&t.reversedRowCoords?this.hot.countRows()-n[i]-1:n[i]}},{key:"resetSetupBeforeStructureAlteration",value:function(n,t,i){if(this.settingsType==="function"){var u=n.indexOf("row")>-1?"row":"col",f=this.getAllEndpoints();r.arrayEach(f,function(r){u==="row"&&r.destinationRow>=t&&(n==="insert_row"?r.alterRowOffset=i:n==="remove_row"&&(r.alterRowOffset=-1*i));u==="col"&&r.destinationColumn>=t&&(n==="insert_col"?r.alterColumnOffset=i:n==="remove_col"&&(r.alterColumnOffset=-1*i))});this.resetAllEndpoints(f,!1)}}},{key:"resetSetupAfterStructureAlteration",value:function(n,t,i,u){var f=this,a=arguments.length>5&&arguments[5]!==undefined?arguments[5]:!0,s;if(this.settingsType==="function"){s=function s(){return f.hot.removeHook("beforeRender",s),f.refreshAllEndpoints(!0)};this.hot.addHookOnce("beforeRender",s);return}var h=n.indexOf("row")>-1?"row":"col",c=n.indexOf("remove")>-1?-1:1,e=this.getAllEndpoints(),l=n.indexOf("move_row")===0,o=t;r.arrayEach(e,function(n){h==="row"&&n.destinationRow>=o&&(n.alterRowOffset=c*i);h==="col"&&n.destinationColumn>=o&&(n.alterColumnOffset=c*i)});this.resetAllEndpoints(e,!l);l?r.arrayEach(e,function(n){f.extendEndpointRanges(n,o,u[0],u.length);f.recreatePhysicalRanges(n);f.clearOffsetInformation(n)}):r.arrayEach(e,function(n){f.shiftEndpointCoordinates(n,o)});a&&this.refreshAllEndpoints(!0)}},{key:"clearOffsetInformation",value:function(n){n.alterRowOffset=void 0;n.alterColumnOffset=void 0}},{key:"extendEndpointRanges",value:function(n,t,i,u){r.arrayEach(n.ranges,function(n){n[1]&&(t>=n[0]&&t<=n[1]?i>n[1]?n[1]+=u:i<n[0]&&(n[0]-=u):i>=n[0]&&i<=n[1]&&(n[1]-=u,t<=n[0]&&(n[0]++,n[1]++)))})}},{key:"recreatePhysicalRanges",value:function(n){var i=this,f=n.ranges,t=[],u=[];r.arrayEach(f,function(n){var r=[],t;if(n[1])for(t=n[0];t<=n[1];t++)r.push(i.recordTranslator.toPhysicalRow(t));else r.push(i.recordTranslator.toPhysicalRow(n[0]));u.push(r)});r.arrayEach(u,function(n){var i=[];r.arrayEach(n,function(r,u){u===0?i.push(r):n[u]!==n[u-1]+1&&(i.push(n[u-1]),t.push(i),i=[],i.push(r));u===n.length-1&&(i.push(r),t.push(i))})});n.ranges=t}},{key:"shiftEndpointCoordinates",value:function(n,t){n.alterRowOffset&&n.alterRowOffset!==0?(n.destinationRow+=n.alterRowOffset||0,r.arrayEach(n.ranges,function(i){r.arrayEach(i,function(r,u){r>=t&&(i[u]+=n.alterRowOffset||0)})})):n.alterColumnOffset&&n.alterColumnOffset!==0&&(n.destinationColumn+=n.alterColumnOffset||0,n.sourceColumn+=n.alterColumnOffset||0)}},{key:"resetAllEndpoints",value:function(n){var t=this,i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!0;this.cellsToSetCache=[];n||(n=this.getAllEndpoints());r.arrayEach(n,function(n){t.resetEndpointValue(n,i)});this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset");this.cellsToSetCache=[]}},{key:"refreshAllEndpoints",value:function(){var n=this;this.cellsToSetCache=[];r.arrayEach(this.getAllEndpoints(),function(t){n.currentEndpoint=t;n.plugin.calculate(t);n.setEndpointValue(t,"init")});this.currentEndpoint=null;this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset");this.cellsToSetCache=[]}},{key:"refreshChangedEndpoints",value:function(n){var t=this,i=[];this.cellsToSetCache=[];r.arrayEach(n,function(n,u,f){(n[2]||"")+""!=n[3]+""&&r.arrayEach(t.getAllEndpoints(),function(n,r){t.hot.propToCol(f[u][1])===n.sourceColumn&&i.indexOf(r)===-1&&i.push(r)})});r.arrayEach(i,function(n){t.refreshEndpoint(t.getEndpoint(n))});this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset");this.cellsToSetCache=[]}},{key:"refreshEndpoint",value:function(n){this.currentEndpoint=n;this.plugin.calculate(n);this.setEndpointValue(n);this.currentEndpoint=null}},{key:"resetEndpointValue",value:function(n){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!0,u=n.alterRowOffset||0,e=n.alterColumnOffset||0,o=this.recordTranslator.toVisual(n.destinationRow,n.destinationColumn),i=f(o,2),s=i[0],h=i[1],r=this.hot.getCellMeta(s,h);r.readOnly=!1;r.className="";this.cellsToSetCache.push([this.recordTranslator.toVisualRow(n.destinationRow+(t?u:0)),this.recordTranslator.toVisualColumn(n.destinationColumn+(t?e:0)),""])}},{key:"setEndpointValue",value:function(n,t){var u=arguments.length>2&&arguments[2]!==undefined?arguments[2]:!1,f=-1*n.alterRowOffset||0,e=-1*n.alterColumnOffset||0,i=this.getVisualRowIndex(n.destinationRow),r=this.hot.getCellMeta(this.getVisualRowIndex(n.destinationRow+f),n.destinationColumn+e);if(i>this.hot.countRows()||n.destinationColumn>this.hot.countCols()){this.throwOutOfBoundsWarning();return}(t==="init"||r.readOnly!==n.readOnly)&&(r.readOnly=n.readOnly,r.className="columnSummaryResult");n.roundFloat&&!isNaN(n.result)&&(n.result=n.result.toFixed(n.roundFloat));u?this.hot.setDataAtCell(i,n.destinationColumn,n.result,"ColumnSummary.set"):this.cellsToSetCache.push([i,n.destinationColumn,n.result]);n.alterRowOffset=void 0;n.alterColumnOffset=void 0}},{key:"getVisualRowIndex",value:function(n){return this.hot.runHooks("unmodifyRow",n,"columnSummary")}},{key:"getVisualColumnIndex",value:function(n){return this.hot.runHooks("unmodifyCol",n,"columnSummary")}},{key:"throwOutOfBoundsWarning",value:function(){console.warn("One of the  Column Summary plugins' destination points you provided is beyond the table boundaries!")}}]),n}();t.default=u},function(n,t,i){"use strict";function u(n){return n&&n.__esModule?n:{"default":n}}function ft(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function et(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function ot(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var o,s;t.__esModule=!0;var f=function c(n,t,i){var r,u,f;return n===null&&(n=Function.prototype),r=Object.getOwnPropertyDescriptor(n,t),r===undefined?(u=Object.getPrototypeOf(n),u===null?undefined:c(u,t,i)):"value"in r?r.value:(f=r.get,f===undefined)?undefined:f.call(i)},h=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),l=i(7),a=u(l),v=i(0),st=i(1),y=i(456),p=u(y),w=i(9),b=u(w),k=i(2),d=i(457),g=u(d),nt=i(157),tt=u(nt),it=i(6),rt=i(14),e=u(rt),ut=i(11),r=i(44);i(632);e.default.getSingleton().register("afterDropdownMenuDefaultOptions");e.default.getSingleton().register("afterDropdownMenuShow");e.default.getSingleton().register("afterDropdownMenuHide");e.default.getSingleton().register("afterDropdownMenuExecute");o="changeType";s=function(n){function t(n){ft(this,t);var i=et(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return i.eventManager=new b.default(i),i.commandExecutor=new p.default(i.hot),i.itemsFactory=null,i.menu=null,i.hot.addHook("afterGetColHeader",function(n,t){return i.onAfterGetColHeader(n,t)}),i}return ot(t,n),h(t,null,[{key:"DEFAULT_ITEMS",get:function(){return[r.COLUMN_LEFT,r.COLUMN_RIGHT,r.SEPARATOR,r.REMOVE_COLUMN,r.SEPARATOR,r.CLEAR_COLUMN,r.SEPARATOR,r.READ_ONLY,r.SEPARATOR,r.ALIGNMENT]}}]),h(t,[{key:"isEnabled",value:function(){return this.hot.getSettings().dropdownMenu}},{key:"enablePlugin",value:function(){var n=this,i,r;this.enabled||(this.itemsFactory=new g.default(this.hot,t.DEFAULT_ITEMS),i=this.hot.getSettings().dropdownMenu,r={items:this.itemsFactory.getItems(i)},this.registerEvents(),typeof i.callback=="function"&&this.commandExecutor.setCommonCallback(i.callback),f(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enablePlugin",this).call(this),this.callOnPluginsReady(function(){n.hot.runHooks("afterDropdownMenuDefaultOptions",r);n.itemsFactory.setPredefinedItems(r.items);var t=n.itemsFactory.getItems(i);n.menu&&n.menu.destroy();n.menu=new tt.default(n.hot,{className:"htDropdownMenu",keepInViewport:!0});n.hot.runHooks("beforeDropdownMenuSetItems",t);n.menu.setMenuItems(t);n.menu.addLocalHook("afterOpen",function(){return n.onMenuAfterOpen()});n.menu.addLocalHook("afterClose",function(){return n.onMenuAfterClose()});n.menu.addLocalHook("executeCommand",function(){for(var i=arguments.length,r=Array(i),t=0;t<i;t++)r[t]=arguments[t];return n.executeCommand.apply(n,r)});v.arrayEach(t,function(t){return n.commandExecutor.registerCommand(t.key,t)})}))}},{key:"updatePlugin",value:function(){this.disablePlugin();this.enablePlugin();f(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.close();this.menu&&this.menu.destroy();f(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disablePlugin",this).call(this)}},{key:"registerEvents",value:function(){var n=this;this.eventManager.addEventListener(this.hot.rootElement,"click",function(t){return n.onTableClick(t)})}},{key:"open",value:function(n){this.menu&&(this.menu.open(),n.width&&this.menu.setOffset("left",n.width),this.menu.setPosition(n),this.menu.hotMenu.isHotTableEnv=this.hot.isHotTableEnv)}},{key:"close",value:function(){this.menu&&this.menu.close()}},{key:"executeCommand",value:function(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];this.commandExecutor.execute.apply(this.commandExecutor,i)}},{key:"setListening",value:function(){var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:!0;this.menu.isOpened()&&(n?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}},{key:"onTableClick",value:function(n){if(ut.stopPropagation(n),k.hasClass(n.target,o)&&!this.menu.isOpened()){var t=n.target.getBoundingClientRect();this.open({left:t.left,top:t.top+n.target.offsetHeight+3,width:t.width,height:t.height})}}},{key:"onAfterGetColHeader",value:function(n,t){var u=t.parentNode,f,e,i,r;if(u&&(f=u.parentNode.childNodes,e=Array.prototype.indexOf.call(f,u),!(n<0)&&e===f.length-1)&&(i=t.querySelector("."+o),!this.enabled||!i)){if(!this.enabled){i&&i.parentNode.removeChild(i);return}r=document.createElement("button");r.className=o;r.onclick=function(){return!1};t.firstChild.insertBefore(r,t.firstChild.firstChild)}}},{key:"onMenuAfterOpen",value:function(){this.hot.runHooks("afterDropdownMenuShow",this)}},{key:"onMenuAfterClose",value:function(){this.hot.listen();this.hot.runHooks("afterDropdownMenuHide",this)}},{key:"destroy",value:function(){this.close();this.menu&&this.menu.destroy();f(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}}]),t}(a.default);s.SEPARATOR={name:r.SEPARATOR};it.registerPlugin("dropdownMenu",s);t.default=s},function(){},function(n,t,i){"use strict";function r(n){return n&&n.__esModule?n:{"default":n}}function v(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function y(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function p(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var u;t.__esModule=!0;var e=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),o=i(7),s=r(o),w=i(1),h=i(6),c=i(634),l=r(c),f=i(635),a=r(f);u=function(n){function t(){return v(this,t),y(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p(t,n),e(t,[{key:"isEnabled",value:function(){return!0}},{key:"exportAsString",value:function(n){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};return this._createTypeFormatter(n,t).export()}},{key:"exportAsBlob",value:function(n){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};return this._createBlob(this._createTypeFormatter(n,t))}},{key:"downloadFile",value:function(n){var o=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{},i=this._createTypeFormatter(n,o),u=this._createBlob(i),f=window.URL||window.webkitURL,t=document.createElement("a"),e=i.options.filename+"."+i.options.fileExtension,r;t.download!==void 0?(r=f.createObjectURL(u),t.style.display="none",t.setAttribute("href",r),t.setAttribute("download",e),document.body.appendChild(t),t.dispatchEvent(new MouseEvent("click")),document.body.removeChild(t),setTimeout(function(){f.revokeObjectURL(r)},100)):navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(u,e)}},{key:"_createTypeFormatter",value:function(n){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};if(!f.EXPORT_TYPES[n])throw new Error('Export format type "'+n+'" is not supported.');return a.default(n,new l.default(this.hot),t)}},{key:"_createBlob",value:function(n){var t=null;return typeof Blob!="undefined"&&(t=new Blob([n.export()],{type:n.options.mimeType+";charset="+n.options.encoding})),t}}]),t}(s.default);h.registerPlugin("exportFile",u);t.default=u},function(n,t,i){"use strict";function o(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var u;t.__esModule=!0;var f=function(){function n(n,t){var r=[],u=!0,f=!1,e=undefined,i,o;try{for(i=n[Symbol.iterator]();!(u=(o=i.next()).done);u=!0)if(r.push(o.value),t&&r.length===t)break}catch(s){f=!0;e=s}finally{try{!u&&i["return"]&&i["return"]()}finally{if(f)throw e;}}return r}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return n(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance");}}(),e=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),s=i(0),h=i(1),r=i(4);u=function(){function n(t){o(this,n);this.hot=t;this.options={}}return e(n,[{key:"setOptions",value:function(n){this.options=n}},{key:"getData",value:function(){var t=this,n=this._getDataRange(),f=n.startRow,e=n.startCol,o=n.endRow,s=n.endCol,i=this.options,u=[];return r.rangeEach(f,o,function(n){var f=[];(i.exportHiddenRows||!t._isHiddenRow(n))&&(r.rangeEach(e,s,function(r){(i.exportHiddenColumns||!t._isHiddenColumn(r))&&f.push(t.hot.getDataAtCell(n,r))}),u.push(f))}),u}},{key:"getRowHeaders",value:function(){var n=this,t=[];if(this.options.rowHeaders){var i=this._getDataRange(),u=i.startRow,f=i.endRow,e=this.hot.getRowHeader();r.rangeEach(u,f,function(i){(n.options.exportHiddenRows||!n._isHiddenRow(i))&&t.push(e[i])})}return t}},{key:"getColumnHeaders",value:function(){var n=this,t=[];if(this.options.columnHeaders){var i=this._getDataRange(),u=i.startCol,f=i.endCol,e=this.hot.getColHeader();r.rangeEach(u,f,function(i){(n.options.exportHiddenColumns||!n._isHiddenColumn(i))&&t.push(e[i])})}return t}},{key:"_getDataRange",value:function(){var e=this.hot.countCols()-1,o=this.hot.countRows()-1,n=f(this.options.range,4),s=n[0],t=s===undefined?0:s,h=n[1],i=h===undefined?0:h,c=n[2],r=c===undefined?o:c,l=n[3],u=l===undefined?e:l;return t=Math.max(t,0),i=Math.max(i,0),r=Math.min(r,o),u=Math.min(u,e),{startRow:t,startCol:i,endRow:r,endCol:u}}},{key:"_isHiddenRow",value:function(n){return this.hot.hasHook("hiddenRow")&&this.hot.runHooks("hiddenRow",n)}},{key:"_isHiddenColumn",value:function(n){return this.hot.hasHook("hiddenColumn")&&this.hot.runHooks("hiddenColumn",n)}}]),n}();t.default=u},function(n,t,i){"use strict";function e(n){return n&&n.__esModule?n:{"default":n}}function o(n,t,i){return t in n?Object.defineProperty(n,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[t]=i,n}function h(n,t,i){return typeof f[n]=="function"?new f[n](t,i):null}var r,u;t.__esModule=!0;t.EXPORT_TYPES=t.TYPE_PDF=t.TYPE_EXCEL=t.TYPE_CSV=undefined;t.default=h;r=i(636);u=e(r);var s=t.TYPE_CSV="csv",c=t.TYPE_EXCEL="excel",l=t.TYPE_PDF="pdf",f=t.EXPORT_TYPES=o({},s,u.default)},function(n,t,i){"use strict";function s(n){return n&&n.__esModule?n:{"default":n}}function h(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function c(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function l(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}t.__esModule=!0;var u=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),r=i(0),f=i(13),e=i(637),o=s(e);var a=String.fromCharCode(13),v=String.fromCharCode(34),y=String.fromCharCode(10),p=function(n){function t(){return h(this,t),c(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return l(t,n),u(t,[{key:"export",value:function(){var u=this,t=this.options,o=this.dataProvider.getData(),i=this.dataProvider.getColumnHeaders(),s=i.length>0,f=this.dataProvider.getRowHeaders(),e=f.length>0,n="﻿";return s&&(i=r.arrayMap(i,function(n){return u._escapeCell(n,!0)}),e&&(n+=t.columnDelimiter),n+=i.join(t.columnDelimiter),n+=t.rowDelimiter),r.arrayEach(o,function(i,r){r>0&&(n+=t.rowDelimiter);e&&(n+=u._escapeCell(f[r])+t.columnDelimiter);n+=i.map(function(n){return u._escapeCell(n)}).join(t.columnDelimiter)}),n}},{key:"_escapeCell",value:function(n){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!1;return n=f.stringify(n),n!==""&&(t||n.indexOf(a)>=0||n.indexOf(v)>=0||n.indexOf(y)>=0||n.indexOf(this.options.columnDelimiter)>=0)&&(n=n.replace(new RegExp('"',"g"),'""'),n='"'+n+'"'),n}}],[{key:"DEFAULT_OPTIONS",get:function(){return{mimeType:"text/csv",fileExtension:"csv",columnDelimiter:",",rowDelimiter:"\r\n"}}}]),t}(o.default);t.default=p},function(n,t,i){"use strict";function o(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var f;t.__esModule=!0;var u=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),s=i(0),r=i(1),h=i(4),e=i(31);f=function(){function n(t,i){o(this,n);this.dataProvider=t;this.options=this._mergeOptions(i);this.dataProvider.setOptions(this.options)}return u(n,null,[{key:"DEFAULT_OPTIONS",get:function(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}}]),u(n,[{key:"_mergeOptions",value:function(t){var i=r.clone(this.constructor.DEFAULT_OPTIONS),u=new Date;return i=r.extend(r.clone(n.DEFAULT_OPTIONS),i),i=r.extend(i,t),i.filename=e.substitute(i.filename,{YYYY:u.getFullYear(),MM:(u.getMonth()+1+"").padStart(2,"0"),DD:(u.getDate()+"").padStart(2,"0")}),i}}]),n}();t.default=f},function(n,t,i){"use strict";function bt(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function u(n){return n&&n.__esModule?n:{"default":n}}function kt(n,t){return Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(t)}}))}function dt(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function gt(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function ni(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var c;t.__esModule=!0;var l=function(){function n(n,t){var r=[],u=!0,f=!1,e=undefined,i,o;try{for(i=n[Symbol.iterator]();!(u=(o=i.next()).done);u=!0)if(r.push(o.value),t&&r.length===t)break}catch(s){f=!0;e=s}finally{try{!u&&i["return"]&&i["return"]()}finally{if(f)throw e;}}return r}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return n(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance");}}(),v=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),e=function y(n,t,i){var r,u,f;return n===null&&(n=Function.prototype),r=Object.getOwnPropertyDescriptor(n,t),r===undefined?(u=Object.getPrototypeOf(n),u===null?undefined:y(u,t,i)):"value"in r?r.value:(f=r.get,f===undefined)?undefined:f.call(i)},p=kt(["The filter conditions have been applied properly, but couldn’t be displayed visually. \n        The overall amount of conditions exceed the capability of the dropdown menu. \n        For more details see the documentation."],["The filter conditions have been applied properly, but couldn’t be displayed visually. \n        The overall amount of conditions exceed the capability of the dropdown menu. \n        For more details see the documentation."]),w=i(7),b=u(w),f=i(0),k=i(34),d=i(4),g=i(9),nt=u(g),o=i(2),tt=i(6),it=i(44),rt=i(3),a=bt(rt),ut=i(639),s=u(ut),ft=i(659),et=u(ft),ot=i(661),st=u(ot),ht=i(664),ct=u(ht),lt=i(470),at=u(lt),vt=i(471),yt=u(vt),pt=i(665),wt=u(pt),h=i(63),r=i(159);i(666);c=function(n){function t(n){dt(this,t);var i=gt(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return i.eventManager=new nt.default(i),i.trimRowsPlugin=null,i.dropdownMenuPlugin=null,i.conditionCollection=null,i.conditionUpdateObserver=null,i.components=new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]]),i.lastSelectedColumn=null,i.hiddenRowsCache=new Map,i.hot.addHook("afterGetColHeader",function(n,t){return i.onAfterGetColHeader(n,t)}),i}return ni(t,n),v(t,[{key:"isEnabled",value:function(){return this.hot.getSettings().filters?!0:!1}},{key:"enablePlugin",value:function(){var n=this,r,u;if(!this.enabled){this.trimRowsPlugin=this.hot.getPlugin("trimRows");this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");var i=function(t){return t.addLocalHook("accept",function(){return n.onActionBarSubmit("accept")}),t.addLocalHook("cancel",function(){return n.onActionBarSubmit("cancel")}),t.addLocalHook("change",function(i){return n.onComponentChange(t,i)}),t},f=function(){return n.hot.getTranslatedPhrase(a.FILTERS_DIVS_FILTER_BY_CONDITION)+":"},o=function(){return n.hot.getTranslatedPhrase(a.FILTERS_DIVS_FILTER_BY_VALUE)+":"};this.components.get("filter_by_condition")||(r=new s.default(this.hot,{id:"filter_by_condition",name:f,addSeparator:!1}),r.addLocalHook("afterClose",function(){return n.onSelectUIClosed()}),this.components.set("filter_by_condition",i(r)));this.components.get("filter_operators")||this.components.set("filter_operators",new et.default(this.hot,{id:"filter_operators",name:"Operators"}));this.components.get("filter_by_condition2")||(u=new s.default(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0}),u.addLocalHook("afterClose",function(){return n.onSelectUIClosed()}),this.components.set("filter_by_condition2",i(u)));this.components.get("filter_by_value")||this.components.set("filter_by_value",i(new st.default(this.hot,{id:"filter_by_value",name:o})));this.components.get("filter_action_bar")||this.components.set("filter_action_bar",i(new ct.default(this.hot,{id:"filter_action_bar",name:"Action bar"})));this.conditionCollection||(this.conditionCollection=new at.default);this.conditionUpdateObserver||(this.conditionUpdateObserver=new wt.default(this.conditionCollection,function(t){return n.getDataMapAtColumn(t)}),this.conditionUpdateObserver.addLocalHook("update",function(t){return n.updateComponents(t)}));this.components.forEach(function(n){n.show()});this.registerEvents();this.addHook("beforeDropdownMenuSetItems",function(t){return n.onBeforeDropdownMenuSetItems(t)});this.addHook("afterDropdownMenuDefaultOptions",function(t){return n.onAfterDropdownMenuDefaultOptions(t)});this.addHook("afterDropdownMenuShow",function(){return n.onAfterDropdownMenuShow()});this.addHook("afterDropdownMenuHide",function(){return n.onAfterDropdownMenuHide()});this.addHook("afterChange",function(t){return n.onAfterChange(t)});this.hot.getSettings().trimRows=!0;this.trimRowsPlugin.enablePlugin();this.hot.getSettings().dropdownMenu&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin());e(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enablePlugin",this).call(this)}}},{key:"registerEvents",value:function(){var n=this;this.eventManager.addEventListener(this.hot.rootElement,"click",function(t){return n.onTableClick(t)})}},{key:"disablePlugin",value:function(){this.enabled&&(this.dropdownMenuPlugin.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach(function(n){n.hide()}),this.conditionCollection.clean(),this.trimRowsPlugin.untrimAll());e(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disablePlugin",this).call(this)}},{key:"addCondition",value:function(n,t,i){var u=arguments.length>3&&arguments[3]!==undefined?arguments[3]:r.OPERATION_AND,f=this.t.toPhysicalColumn(n);this.conditionCollection.addCondition(f,{command:{key:t},args:i},u)}},{key:"removeConditions",value:function(n){var t=this.t.toPhysicalColumn(n);this.conditionCollection.removeConditions(t)}},{key:"clearConditions",value:function(n){if(n===void 0)this.conditionCollection.clean();else{var t=this.t.toPhysicalColumn(n);this.conditionCollection.clearConditions(t)}}},{key:"filter",value:function(){var u=this._createDataFilter(),e=!this.conditionCollection.isEmpty(),n=[],i=this.conditionCollection.exportAllConditions(),o=this.hot.runHooks("beforeFilter",i),t,r;o!==!1&&(e?(t=[],this.trimRowsPlugin.trimmedRows.length=0,n=f.arrayMap(u.filter(),function(n){return n.meta.visualRow}),r=h.createArrayAssertion(n),d.rangeEach(this.hot.countSourceRows()-1,function(n){r(n)||t.push(n)}),this.trimRowsPlugin.trimRows(t),n.length||this.hot.deselectCell()):this.trimRowsPlugin.untrimAll());this.hot.view.wt.wtOverlays.adjustElementsSize(!0);this.hot.render();this.clearColumnSelection();this.hot.runHooks("afterFilter",i)}},{key:"getSelectedColumn",value:function(){return this.lastSelectedColumn}},{key:"clearColumnSelection",value:function(){var r=this.hot.getSelectedLast()||[],n=l(r,2),t=n[0],i=n[1];t!==void 0&&i!==void 0&&this.hot.selectCell(t,i)}},{key:"getDataMapAtColumn",value:function(n){var r=this,t=this.t.toVisualColumn(n),i=[];return f.arrayEach(this.hot.getSourceDataAtCol(t),function(n,u){var f=r.hot.getCellMeta(u,t),e=f.row,o=f.col,s=f.visualCol,c=f.visualRow,l=f.type,a=f.instance,v=f.dateFormat;i.push({meta:{row:e,col:o,visualCol:s,visualRow:c,type:l,instance:a,dateFormat:v},value:h.toEmptyString(n)})}),i}},{key:"onAfterChange",value:function(n){var t=this;n&&f.arrayEach(n,function(n){var i=l(n,2),r=i[1],u=t.hot.propToCol(r);t.updateValueComponentCondition(u)})}},{key:"updateValueComponentCondition",value:function(n){var t=this.hot.getDataAtCol(n),i=h.unifyColumnValues(t);this.conditionUpdateObserver.updateStatesAtColumn(n,i)}},{key:"onAfterDropdownMenuShow",value:function(){var n=this.getSelectedColumn(),t=n&&n.physicalIndex;this.components.forEach(function(n){!n.isHidden()&&n.setState&&n.restoreState(t)})}},{key:"onAfterDropdownMenuHide",value:function(){this.components.get("filter_by_condition").getSelectElement().closeOptions();this.components.get("filter_by_condition2").getSelectElement().closeOptions()}},{key:"onBeforeDropdownMenuSetItems",value:function(n){var t=f.arrayMap(n,function(n){return n.key});this.components.forEach(function(n){n[t.indexOf(n.getMenuItemDescriptor().key)===-1?"hide":"show"]()});this.initHiddenRowsCache()}},{key:"onAfterDropdownMenuDefaultOptions",value:function(n){n.items.push({name:it.SEPARATOR});this.components.forEach(function(t){n.items.push(t.getMenuItemDescriptor())})}},{key:"getOperationBasedOnArguments",value:function(n,t,i,u){var f=n;return f===r.OPERATION_OR&&t.command.key!==r.CONDITION_NONE&&i.command.key!==r.CONDITION_NONE&&u.command.key!==r.CONDITION_NONE?f=r.OPERATION_OR_THEN_VARIABLE:u.command.key!==r.CONDITION_NONE&&(t.command.key===r.CONDITION_NONE||i.command.key===r.CONDITION_NONE)&&(f=r.OPERATION_AND),f}},{key:"onActionBarSubmit",value:function(n){if(n==="accept"){var o=this.getSelectedColumn(),t=o&&o.physicalIndex,i=this.components.get("filter_by_condition").getState(),u=this.components.get("filter_by_condition2").getState(),f=this.components.get("filter_by_value").getState(),e=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),i,u,f);this.conditionUpdateObserver.groupChanges();this.conditionCollection.clearConditions(t);i.command.key===r.CONDITION_NONE&&u.command.key===r.CONDITION_NONE&&f.command.key===r.CONDITION_NONE?this.conditionCollection.removeConditions(t):(i.command.key!==r.CONDITION_NONE&&(this.conditionCollection.addCondition(t,i,e),u.command.key!==r.CONDITION_NONE&&this.conditionCollection.addCondition(t,u,e)),f.command.key!==r.CONDITION_NONE&&this.conditionCollection.addCondition(t,f,e));this.conditionUpdateObserver.flush();this.components.get("filter_operators").saveState(t);this.components.get("filter_by_value").saveState(t);this.saveHiddenRowsCache(t);this.trimRowsPlugin.trimmedRows.length=0;this.filter()}this.dropdownMenuPlugin.close()}},{key:"onComponentChange",value:function(n,t){n===this.components.get("filter_by_condition")&&(t.showOperators?this.showComponents(this.components.get("filter_by_condition2"),this.components.get("filter_operators")):this.hideComponents(this.components.get("filter_by_condition2"),this.components.get("filter_operators")));n.constructor!==s.default||t.inputsCount||this.setListeningDropdownMenu()}},{key:"onSelectUIClosed",value:function(){this.setListeningDropdownMenu()}},{key:"setListeningDropdownMenu",value:function(){this.dropdownMenuPlugin.setListening()}},{key:"onAfterGetColHeader",value:function(n,t){var i=this.t.toPhysicalColumn(n);this.enabled&&this.conditionCollection.hasConditions(i)?o.addClass(t,"htFiltersActive"):o.removeClass(t,"htFiltersActive")}},{key:"onTableClick",value:function(n){var i=o.closest(n.target,"TH"),t,r;i&&(t=this.hot.getCoords(i).col,r=this.t.toPhysicalColumn(t),this.lastSelectedColumn={visualIndex:t,physicalIndex:r})}},{key:"destroy",value:function(){this.enabled&&(this.components.forEach(function(n){n.destroy()}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hiddenRowsCache.clear(),this.trimRowsPlugin.disablePlugin());e(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}},{key:"_createDataFilter",value:function(){var n=this,t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.conditionCollection;return new yt.default(t,function(t){return n.getDataMapAtColumn(t)})}},{key:"updateComponents",value:function(n){if(this.dropdownMenuPlugin.enabled){var u=n.editedConditionStack.conditions,t=n.editedConditionStack.column,f=u.filter(function(n){return n.name===r.CONDITION_BY_VALUE}),i=u.filter(function(n){return n.name!==r.CONDITION_BY_VALUE}),e=this.conditionCollection.columnTypes[t];f.length===2||i.length===3?console.warn(k.toSingleLine(p)):(i.length>0&&this.showComponentForParticularColumn(this.components.get("filter_operators"),t),this.components.get("filter_by_condition").updateState(i[0],t),this.components.get("filter_by_condition2").updateState(i[1],t),this.components.get("filter_by_value").updateState(n),this.components.get("filter_operators").updateState(e,t))}}},{key:"showComponentForParticularColumn",value:function(n,t){if(this.hiddenRowsCache.has(t)){var i=this.getIndexesOfComponents(n);this.removeIndexesFromHiddenRowsCache(t,i)}else this.hiddenRowsCache.set(t,[])}},{key:"removeIndexesFromHiddenRowsCache",value:function(n,t){var i=this.hiddenRowsCache.get(n);f.arrayEach(t,function(n){i.includes(n)&&i.splice(i.indexOf(n),1)})}},{key:"hideComponentForParticularColumn",value:function(n,t){if(this.hiddenRowsCache.has(t)){var i=this.getIndexesOfComponents(n);this.addIndexesToHiddenRowsCache(t,i)}else this.hiddenRowsCache.set(t,this.getIndexesOfComponents(n))}},{key:"addIndexesToHiddenRowsCache",value:function(n,t){var i=this.hiddenRowsCache.get(n);f.arrayEach(t,function(n){i.indexOf(n)===-1&&i.push(n)})}},{key:"getIndexesOfComponents",value:function(){for(var u=this.dropdownMenuPlugin.menu,t=[],i=arguments.length,r=Array(i),n=0;n<i;n++)r[n]=arguments[n];return f.arrayEach(r,function(n){f.arrayEach(u.menuItems,function(i,r){i.key===n.getMenuItemDescriptor().key&&t.push(r)})}),t}},{key:"changeComponentsVisibility",value:function(){for(var i,e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:!0,o=this.dropdownMenuPlugin.menu,r=o.hotMenu,u=r.getPlugin("hiddenRows"),t=arguments.length,f=Array(t>1?t-1:0),n=1;n<t;n++)f[n-1]=arguments[n];i=this.getIndexesOfComponents.apply(this,f);e?u.showRows(i):u.hideRows(i);r.render()}},{key:"initHiddenRowsCache",value:function(){var n=this;this.dropdownMenuPlugin.menu.addLocalHook("afterOpen",function(){var t=n.lastSelectedColumn.physicalIndex;n.hiddenRowsCache.has(t)||n.hiddenRowsCache.set(t,n.getIndexesOfComponents(n.components.get("filter_operators"),n.components.get("filter_by_condition2")));n.dropdownMenuPlugin.menu.hotMenu.updateSettings({hiddenRows:{rows:n.hiddenRowsCache.get(t)}})})}},{key:"saveHiddenRowsCache",value:function(n){this.hiddenRowsCache.set(n,this.dropdownMenuPlugin.menu.hotMenu.getPlugin("hiddenRows").hiddenRows)}},{key:"hideComponents",value:function(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];this.changeComponentsVisibility.apply(this,[!1].concat(i))}},{key:"showComponents",value:function(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];this.changeComponentsVisibility.apply(this,[!0].concat(i))}}]),t}(b.default);tt.registerPlugin("filters",c);t.default=c},function(n,t,i){"use strict";function u(n){return n&&n.__esModule?n:{"default":n}}function rt(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function ut(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function ft(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function et(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var v;t.__esModule=!0;var y=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),p=function w(n,t,i){var r,u,f;return n===null&&(n=Function.prototype),r=Object.getOwnPropertyDescriptor(n,t),r===undefined?(u=Object.getPrototypeOf(n),u===null?undefined:w(u,t,i)):"value"in r?r.value:(f=r.get,f===undefined)?undefined:f.call(i)},f=i(2),c=i(11),r=i(0),l=i(18),b=i(1),k=i(3),e=rt(k),d=i(83),g=u(d),o=i(159),nt=u(o),tt=i(161),s=u(tt),it=i(658),a=u(it),h=i(10);v=function(n){function t(n,i){ut(this,t);var r=ft(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return r.id=i.id,r.name=i.name,r.addSeparator=i.addSeparator,r.elements.push(new a.default(r.hot)),r.elements.push(new s.default(r.hot,{placeholder:e.FILTERS_BUTTONS_PLACEHOLDER_VALUE})),r.elements.push(new s.default(r.hot,{placeholder:e.FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE})),r.registerHooks(),r}return et(t,n),y(t,[{key:"registerHooks",value:function(){var n=this;this.getSelectElement().addLocalHook("select",function(t){return n.onConditionSelect(t)});this.getSelectElement().addLocalHook("afterClose",function(){return n.onSelectUIClosed()});r.arrayEach(this.getInputElements(),function(t){t.addLocalHook("keydown",function(t){return n.onInputKeyDown(t)})})}},{key:"setState",value:function(n){var i=this,t;this.reset();n&&(t=b.clone(n.command),t.name.startsWith(e.FILTERS_CONDITIONS_NAMESPACE)&&(t.name=this.hot.getTranslatedPhrase(t.name)),this.getSelectElement().setValue(t),r.arrayEach(n.args,function(n,r){if(r>t.inputsCount-1)return!1;var u=i.getInputElement(r);u.setValue(n);u[t.inputsCount>r?"show":"hide"]();r||setTimeout(function(){return u.focus()},10)}))}},{key:"getState",value:function(){var n=this.getSelectElement().getValue()||h.getConditionDescriptor(o.CONDITION_NONE),t=[];return r.arrayEach(this.getInputElements(),function(i,r){n.inputsCount>r&&t.push(i.getValue())}),{command:n,args:t}}},{key:"updateState",value:function(n,t){var i=n?h.getConditionDescriptor(n.name):h.getConditionDescriptor(o.CONDITION_NONE);this.setCachedState(t,{command:i,args:n?n.args:[]});n||r.arrayEach(this.getInputElements(),function(n){return n.setValue(null)})}},{key:"getSelectElement",value:function(){return this.elements.filter(function(n){return n instanceof a.default})[0]}},{key:"getInputElement",value:function(){var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;return this.getInputElements()[n]}},{key:"getInputElements",value:function(){return this.elements.filter(function(n){return n instanceof s.default})}},{key:"getMenuItemDescriptor",value:function(){var n=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return n.isHidden()},renderer:function(t,i,u,e,o,s){f.addClass(i.parentNode,"htFiltersMenuCondition");n.addSeparator&&f.addClass(i.parentNode,"border");var h=document.createElement("div");return f.addClass(h,"htFiltersMenuLabel"),h.textContent=s,i.appendChild(h),r.arrayEach(n.elements,function(n){return i.appendChild(n.element)}),i}}}},{key:"reset",value:function(){var n=this.hot.getPlugin("filters").getSelectedColumn(),u=n&&n.visualIndex,f=this.hot.getDataType.apply(this.hot,this.hot.getSelectedLast()||[0,u]),i=nt.default(f);r.arrayEach(this.getInputElements(),function(n){return n.hide()});this.getSelectElement().setItems(i);p(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"reset",this).call(this);this.getSelectElement().setValue(i[0])}},{key:"onConditionSelect",value:function(n){r.arrayEach(this.getInputElements(),function(t,i){t[n.inputsCount>i?"show":"hide"]();i||setTimeout(function(){return t.focus()},10)});this.runLocalHooks("change",n)}},{key:"onSelectUIClosed",value:function(){this.runLocalHooks("afterClose")}},{key:"onInputKeyDown",value:function(n){l.isKey(n.keyCode,"ENTER")?(this.runLocalHooks("accept"),c.stopImmediatePropagation(n)):l.isKey(n.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),c.stopImmediatePropagation(n))}}]),t}(g.default);t.default=v},function(n,t,i){"use strict";function u(n,t,i){return t in n?Object.defineProperty(n,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[t]=i,n}var r,l,s;t.__esModule=!0;l=i(0);s=i(1);var h="state_",f="_states",e=function(n,t){return n[f][h+t]},o=function(n,t,i){n[f][h+t]=i},c=(r={},u(r,f,{}),u(r,"getCachedState",function(n){return e(this,n)}),u(r,"setCachedState",function(n,t){o(this,n,t)}),u(r,"saveState",function(n){o(this,n,this.getState())}),u(r,"restoreState",function(n){this.setState(e(this,n))}),u(r,"hasSavedState",function(n){return e(this,n)!==void 0}),u(r,"clearState",function(n){o(this,n)}),u(r,"clearStates",function(){this[f]={}}),r);s.defineGetter(c,"MIXIN_NAME","stateSaver",{writable:!1,enumerable:!1});t.default=c},function(n,t,i){"use strict";function s(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function u(){return!0}var r;t.__esModule=!0;t.CONDITION_NAME=undefined;t.condition=u;var f=i(3),e=s(f),o=i(10);r=t.CONDITION_NAME="none";o.registerCondition(r,u,{name:e.FILTERS_CONDITIONS_NONE,inputsCount:0,showOperators:!1})},function(n,t,i){"use strict";function h(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function f(n,t){return!r.getCondition(s.CONDITION_NAME,t)(n)}var u;t.__esModule=!0;t.CONDITION_NAME=undefined;t.condition=f;var e=i(3),o=h(e),r=i(10),s=i(462);u=t.CONDITION_NAME="not_empty";r.registerCondition(u,f,{name:o.FILTERS_CONDITIONS_NOT_EMPTY,inputsCount:0,showOperators:!0})},function(n,t,i){"use strict";function h(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function f(n,t){return!r.getCondition(s.CONDITION_NAME,t)(n)}var u;t.__esModule=!0;t.CONDITION_NAME=undefined;t.condition=f;var e=i(3),o=h(e),r=i(10),s=i(463);u=t.CONDITION_NAME="neq";r.registerCondition(u,f,{name:o.FILTERS_CONDITIONS_NOT_EQUAL,inputsCount:1,showOperators:!0})},function(n,t,i){"use strict";function h(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function f(n){var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:inputValues,u=r(i,1),t=u[0];return n.meta.type==="numeric"&&(t=parseFloat(t,10)),n.value>t}var r,u;t.__esModule=!0;t.CONDITION_NAME=undefined;r=function(){function n(n,t){var r=[],u=!0,f=!1,e=undefined,i,o;try{for(i=n[Symbol.iterator]();!(u=(o=i.next()).done);u=!0)if(r.push(o.value),t&&r.length===t)break}catch(s){f=!0;e=s}finally{try{!u&&i["return"]&&i["return"]()}finally{if(f)throw e;}}return r}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return n(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance");}}();t.condition=f;var e=i(3),o=h(e),s=i(10);u=t.CONDITION_NAME="gt";s.registerCondition(u,f,{name:o.FILTERS_CONDITIONS_GREATER_THAN,inputsCount:1,showOperators:!0})},function(n,t,i){"use strict";function h(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function f(n){var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:inputValues,u=r(i,1),t=u[0];return n.meta.type==="numeric"&&(t=parseFloat(t,10)),n.value>=t}var r,u;t.__esModule=!0;t.CONDITION_NAME=undefined;r=function(){function n(n,t){var r=[],u=!0,f=!1,e=undefined,i,o;try{for(i=n[Symbol.iterator]();!(u=(o=i.next()).done);u=!0)if(r.push(o.value),t&&r.length===t)break}catch(s){f=!0;e=s}finally{try{!u&&i["return"]&&i["return"]()}finally{if(f)throw e;}}return r}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return n(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance");}}();t.condition=f;var e=i(3),o=h(e),s=i(10);u=t.CONDITION_NAME="gte";s.registerCondition(u,f,{name:o.FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL,inputsCount:1,showOperators:!0})},function(n,t,i){"use strict";function h(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function f(n){var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:inputValues,u=r(i,1),t=u[0];return n.meta.type==="numeric"&&(t=parseFloat(t,10)),n.value<t}var r,u;t.__esModule=!0;t.CONDITION_NAME=undefined;r=function(){function n(n,t){var r=[],u=!0,f=!1,e=undefined,i,o;try{for(i=n[Symbol.iterator]();!(u=(o=i.next()).done);u=!0)if(r.push(o.value),t&&r.length===t)break}catch(s){f=!0;e=s}finally{try{!u&&i["return"]&&i["return"]()}finally{if(f)throw e;}}return r}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return n(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance");}}();t.condition=f;var e=i(3),o=h(e),s=i(10);u=t.CONDITION_NAME="lt";s.registerCondition(u,f,{name:o.FILTERS_CONDITIONS_LESS_THAN,inputsCount:1,showOperators:!0})},function(n,t,i){"use strict";function h(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function f(n){var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:inputValues,u=r(i,1),t=u[0];return n.meta.type==="numeric"&&(t=parseFloat(t,10)),n.value<=t}var r,u;t.__esModule=!0;t.CONDITION_NAME=undefined;r=function(){function n(n,t){var r=[],u=!0,f=!1,e=undefined,i,o;try{for(i=n[Symbol.iterator]();!(u=(o=i.next()).done);u=!0)if(r.push(o.value),t&&r.length===t)break}catch(s){f=!0;e=s}finally{try{!u&&i["return"]&&i["return"]()}finally{if(f)throw e;}}return r}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return n(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance");}}();t.condition=f;var e=i(3),o=h(e),s=i(10);u=t.CONDITION_NAME="lte";s.registerCondition(u,f,{name:o.FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL,inputsCount:1,showOperators:!0})},function(n,t,i){"use strict";function h(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function f(n,t){return!r.getCondition(s.CONDITION_NAME,t)(n)}var u;t.__esModule=!0;t.CONDITION_NAME=undefined;t.condition=f;var e=i(3),o=h(e),r=i(10),s=i(464);u=t.CONDITION_NAME="not_between";r.registerCondition(u,f,{name:o.FILTERS_CONDITIONS_NOT_BETWEEN,inputsCount:2,showOperators:!0})},function(n,t,i){"use strict";function c(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function e(n){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:inputValues,i=r(t,1),f=i[0];return u.stringify(n.value).toLowerCase().startsWith(u.stringify(f))}var r,f;t.__esModule=!0;t.CONDITION_NAME=undefined;r=function(){function n(n,t){var r=[],u=!0,f=!1,e=undefined,i,o;try{for(i=n[Symbol.iterator]();!(u=(o=i.next()).done);u=!0)if(r.push(o.value),t&&r.length===t)break}catch(s){f=!0;e=s}finally{try{!u&&i["return"]&&i["return"]()}finally{if(f)throw e;}}return r}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return n(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance");}}();t.condition=e;var o=i(3),s=c(o),u=i(13),h=i(10);f=t.CONDITION_NAME="begins_with";h.registerCondition(f,e,{name:s.FILTERS_CONDITIONS_BEGINS_WITH,inputsCount:1,showOperators:!0})},function(n,t,i){"use strict";function c(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function e(n){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:inputValues,i=r(t,1),f=i[0];return u.stringify(n.value).toLowerCase().endsWith(u.stringify(f))}var r,f;t.__esModule=!0;t.CONDITION_NAME=undefined;r=function(){function n(n,t){var r=[],u=!0,f=!1,e=undefined,i,o;try{for(i=n[Symbol.iterator]();!(u=(o=i.next()).done);u=!0)if(r.push(o.value),t&&r.length===t)break}catch(s){f=!0;e=s}finally{try{!u&&i["return"]&&i["return"]()}finally{if(f)throw e;}}return r}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return n(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance");}}();t.condition=e;var o=i(3),s=c(o),u=i(13),h=i(10);f=t.CONDITION_NAME="ends_with";h.registerCondition(f,e,{name:s.FILTERS_CONDITIONS_ENDS_WITH,inputsCount:1,showOperators:!0})},function(n,t,i){"use strict";function h(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function f(n,t){return!r.getCondition(s.CONDITION_NAME,t)(n)}var u;t.__esModule=!0;t.CONDITION_NAME=undefined;t.condition=f;var e=i(3),o=h(e),r=i(10),s=i(467);u=t.CONDITION_NAME="not_contains";r.registerCondition(u,f,{name:o.FILTERS_CONDITIONS_NOT_CONTAIN,inputsCount:1,showOperators:!0})},function(n,t,i){"use strict";function c(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function l(n){return n&&n.__esModule?n:{"default":n}}function f(n){var t=r.default(n.value,n.meta.dateFormat);return t.isValid()?t.isSame(r.default().subtract(-1,"days").startOf("day"),"d"):!1}var u;t.__esModule=!0;t.CONDITION_NAME=undefined;t.condition=f;var e=i(23),r=l(e),o=i(3),s=c(o),h=i(10);u=t.CONDITION_NAME="date_tomorrow";h.registerCondition(u,f,{name:s.FILTERS_CONDITIONS_TOMORROW,inputsCount:0})},function(n,t,i){"use strict";function c(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function l(n){return n&&n.__esModule?n:{"default":n}}function f(n){var t=r.default(n.value,n.meta.dateFormat);return t.isValid()?t.isSame(r.default().startOf("day"),"d"):!1}var u;t.__esModule=!0;t.CONDITION_NAME=undefined;t.condition=f;var e=i(23),r=l(e),o=i(3),s=c(o),h=i(10);u=t.CONDITION_NAME="date_today";h.registerCondition(u,f,{name:s.FILTERS_CONDITIONS_TODAY,inputsCount:0})},function(n,t,i){"use strict";function c(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function l(n){return n&&n.__esModule?n:{"default":n}}function f(n){var t=r.default(n.value,n.meta.dateFormat);return t.isValid()?t.isSame(r.default().subtract(1,"days").startOf("day"),"d"):!1}var u;t.__esModule=!0;t.CONDITION_NAME=undefined;t.condition=f;var e=i(23),r=l(e),o=i(3),s=c(o),h=i(10);u=t.CONDITION_NAME="date_yesterday";h.registerCondition(u,f,{name:s.FILTERS_CONDITIONS_YESTERDAY,inputsCount:0})},function(n,t,i){"use strict";function h(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function f(n){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:inputValues,i=r(t,1),u=i[0];return u(n.value)}var r,u;t.__esModule=!0;t.CONDITION_NAME=undefined;r=function(){function n(n,t){var r=[],u=!0,f=!1,e=undefined,i,o;try{for(i=n[Symbol.iterator]();!(u=(o=i.next()).done);u=!0)if(r.push(o.value),t&&r.length===t)break}catch(s){f=!0;e=s}finally{try{!u&&i["return"]&&i["return"]()}finally{if(f)throw e;}}return r}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return n(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance");}}();t.condition=f;var e=i(3),c=h(e),o=i(10),s=i(63);u=t.CONDITION_NAME="by_value";o.registerCondition(u,f,{name:"By value",inputsCount:0,inputValuesDecorator:function(){var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:inputValues,t=r(n,1),i=t[0];return[s.createArrayAssertion(i)]},showOperators:!1})},function(n,t,i){"use strict";function o(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function u(){return!0}var r;t.__esModule=!0;t.CONDITION_NAME=undefined;t.condition=u;var f=i(3),s=o(f),e=i(10);r=t.CONDITION_NAME="true";e.registerCondition(r,u,{name:"True"})},function(n,t,i){"use strict";function o(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function u(){return!1}var r;t.__esModule=!0;t.CONDITION_NAME=undefined;t.condition=u;var f=i(3),s=o(f),e=i(10);r=t.CONDITION_NAME="false";e.registerCondition(r,u,{name:"False"})},function(n,t,i){"use strict";function k(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function c(n){return n&&n.__esModule?n:{"default":n}}function d(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function g(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function nt(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var r,l;t.__esModule=!0;var u=function a(n,t,i){var r,u,f;return n===null&&(n=Function.prototype),r=Object.getOwnPropertyDescriptor(n,t),r===undefined?(u=Object.getPrototypeOf(n),u===null?undefined:a(u,t,i)):"value"in r?r.value:(f=r.get,f===undefined)?undefined:f.call(i)},e=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),v=i(157),y=c(v),o=i(1),s=i(0),p=i(3),h=k(p),w=i(44),b=i(65),f=c(b);r=new WeakMap;l=function(n){function t(n,i){d(this,t);var u=g(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n,o.extend(t.DEFAULTS,i)));return r.set(u,{}),u.menu=null,u.items=[],u.registerHooks(),u}return nt(t,n),e(t,null,[{key:"DEFAULTS",get:function(){return o.clone({className:"htUISelect",wrapIt:!1})}}]),e(t,[{key:"registerHooks",value:function(){var n=this;this.addLocalHook("click",function(t){return n.onClick(t)})}},{key:"setItems",value:function(n){this.items=this.translateNames(n);this.menu&&this.menu.setMenuItems(this.items)}},{key:"translateNames",value:function(n){var t=this;return s.arrayEach(n,function(n){typeof n.name=="string"&&n.name.startsWith(h.FILTERS_CONDITIONS_NAMESPACE)&&(n.name=t.menu.hot.getTranslatedPhrase(n.name))}),n}},{key:"build",value:function(){var n=this;u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"build",this).call(this);this.menu=new y.default(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0});this.menu.setMenuItems(this.items);var i=new f.default(this.hot,{className:"htUISelectCaption"}),o=new f.default(this.hot,{className:"htUISelectDropdown"}),e=r.get(this);e.caption=i;e.captionElement=i.element;e.dropdown=o;s.arrayEach([i,o],function(t){return n._element.appendChild(t.element)});this.menu.addLocalHook("select",function(t){return n.onMenuSelect(t)});this.menu.addLocalHook("afterClose",function(){return n.onMenuClosed()});this.update()}},{key:"update",value:function(){if(this.isBuilt()){var n=void 0;n=this.options.value?this.options.value.name:this.menu.hot.getTranslatedPhrase(h.FILTERS_CONDITIONS_NONE);r.get(this).captionElement.textContent=n;u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"update",this).call(this)}}},{key:"openOptions",value:function(){var n=this.element.getBoundingClientRect();this.menu&&(this.menu.open(),this.menu.setPosition({left:n.left-5,top:n.top,width:n.width,height:n.height}))}},{key:"closeOptions",value:function(){this.menu&&this.menu.close()}},{key:"onMenuSelect",value:function(n){n.name!==w.SEPARATOR&&(this.options.value=n,this.closeOptions(),this.update(),this.runLocalHooks("select",this.options.value))}},{key:"onMenuClosed",value:function(){this.runLocalHooks("afterClose")}},{key:"onClick",value:function(){this.openOptions()}},{key:"destroy",value:function(){this.menu&&(this.menu.destroy(),this.menu=null);var n=r.get(this),i=n.caption,f=n.dropdown;i&&i.destroy();f&&f.destroy();u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}}]),t}(f.default);t.default=l},function(n,t,i){"use strict";function s(n){return n&&n.__esModule?n:{"default":n}}function d(n,t){return Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(t)}}))}function g(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function nt(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function tt(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var f,h;t.__esModule=!0;var c=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),l=d(["Radio button with index "," doesn't exist."],["Radio button with index "," doesn't exist."]),a=i(2),r=i(0),v=i(34),y=i(83),p=s(y),w=i(64),u=i(160),e=i(468),b=i(469),k=i(660),o=s(k);f=0;h=function(n){function t(n,i){g(this,t);var r=nt(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return r.id=i.id,r.name=i.name,r.buildOperatorsElement(),r}return tt(t,n),c(t,[{key:"getMenuItemDescriptor",value:function(){var n=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return n.isHidden()},renderer:function(t,i){return a.addClass(i.parentNode,"htFiltersMenuOperators"),r.arrayEach(n.elements,function(n){return i.appendChild(n.element)}),i}}}},{key:"buildOperatorsElement",value:function(){var n=this,t=[u.OPERATION_ID,e.OPERATION_ID];r.arrayEach(t,function(i){var r=new o.default(n.hot,{name:"operator",label:{htmlFor:i,textContent:w.getOperationName(i)},value:i,checked:i===t[f],id:i});r.addLocalHook("change",function(t){return n.onRadioInputChange(t)});n.elements.push(r)})}},{key:"setChecked",value:function(n){if(this.elements.length<n)throw Error(v.toSingleLine(l,n));r.arrayEach(this.elements,function(t,i){t.setChecked(i===n)})}},{key:"getActiveOperationId",value:function(){var n=this.elements.find(function(n){return n instanceof o.default&&n.isChecked()});return n?n.getValue():u.OPERATION_ID}},{key:"getState",value:function(){return this.getActiveOperationId()}},{key:"setState",value:function(n){this.reset();n&&this.getActiveOperationId()!==n&&r.arrayEach(this.elements,function(t){t.setChecked(t.getValue()===n)})}},{key:"updateState",value:function(){var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:u.OPERATION_ID,t=arguments[1];n===b.OPERATION_ID&&(n=e.OPERATION_ID);this.setCachedState(t,n)}},{key:"reset",value:function(){this.setChecked(f)}},{key:"onRadioInputChange",value:function(n){this.setState(n.realTarget.value)}}]),t}(p.default);t.default=h},function(n,t,i){"use strict";function l(n){return n&&n.__esModule?n:{"default":n}}function a(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function v(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function y(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var r,e;t.__esModule=!0;var o=function s(n,t,i){var r,u,f;return n===null&&(n=Function.prototype),r=Object.getOwnPropertyDescriptor(n,t),r===undefined?(u=Object.getPrototypeOf(n),u===null?undefined:s(u,t,i)):"value"in r?r.value:(f=r.get,f===undefined)?undefined:f.call(i)},u=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),f=i(1),h=i(65),c=l(h);r=new WeakMap;e=function(n){function t(n,i){a(this,t);var u=v(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n,f.extend(t.DEFAULTS,i)));return r.set(u,{}),u}return y(t,n),u(t,null,[{key:"DEFAULTS",get:function(){return f.clone({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}}]),u(t,[{key:"build",value:function(){var i,n;o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"build",this).call(this);i=r.get(this);i.input=this._element.firstChild;n=document.createElement("label");n.textContent=this.options.label.textContent;n.htmlFor=this.options.label.htmlFor;i.label=n;this._element.appendChild(n);this.update()}},{key:"update",value:function(){if(this.isBuilt()){var n=r.get(this);n.input.checked=this.options.checked;n.label.textContent=this.hot.getTranslatedPhrase(this.options.label.textContent)}}},{key:"isChecked",value:function(){return this.options.checked}},{key:"setChecked",value:function(){var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:!0;this.options.checked=n;this.update()}},{key:"focus",value:function(){this.isBuilt()&&r.get(this).input.focus()}}]),t}(c.default);t.default=e},function(n,t,i){"use strict";function c(n){return n&&n.__esModule?n:{"default":n}}function tt(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function it(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function rt(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function ut(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var l;t.__esModule=!0;var a=function(){function n(n,t){var r=[],u=!0,f=!1,e=undefined,i,o;try{for(i=n[Symbol.iterator]();!(u=(o=i.next()).done);u=!0)if(r.push(o.value),t&&r.length===t)break}catch(s){f=!0;e=s}finally{try{!u&&i["return"]&&i["return"]()}finally{if(f)throw e;}}return r}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return n(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance");}}(),v=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),y=function p(n,t,i){var r,u,f;return n===null&&(n=Function.prototype),r=Object.getOwnPropertyDescriptor(n,t),r===undefined?(u=Object.getPrototypeOf(n),u===null?undefined:p(u,t,i)):"value"in r?r.value:(f=r.get,f===undefined)?undefined:f.call(i)},e=i(2),w=i(11),f=i(0),b=i(18),k=i(3),o=tt(k),u=i(63),d=i(83),g=c(d),nt=i(662),s=c(nt),r=i(159),h=i(10);l=function(n){function t(n,i){it(this,t);var r=rt(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return r.id=i.id,r.name=i.name,r.elements.push(new s.default(r.hot)),r.registerHooks(),r}return ut(t,n),v(t,[{key:"registerHooks",value:function(){var n=this;this.getMultipleSelectElement().addLocalHook("keydown",function(t){return n.onInputKeyDown(t)})}},{key:"setState",value:function(n){if(this.reset(),n&&n.command.key===r.CONDITION_BY_VALUE){var t=this.getMultipleSelectElement();t.setItems(n.itemsSnapshot);t.setValue(n.args[0])}}},{key:"getState",value:function(){var n=this.getMultipleSelectElement(),t=n.getItems();return{command:{key:n.isSelectedAllValues()||!t.length?r.CONDITION_NONE:r.CONDITION_BY_VALUE},args:[n.getValue()],itemsSnapshot:t}}},{key:"updateState",value:function(n){var t=this,i=function(n,i,e,s,c){var b=f.arrayFilter(i,function(n){return n.name===r.CONDITION_BY_VALUE}),k=a(b,1),y=k[0],l={},d=t.hot.getTranslatedPhrase(o.FILTERS_VALUES_BLANK_CELLS),v,p,w;y?(v=f.arrayMap(s(n,c),function(n){return n.value}),v=u.unifyColumnValues(v),e&&(y.args[0]=e),p=[],w=u.intersectValues(v,y.args[0],d,function(n){n.checked&&p.push(n.value)}),l.args=[p],l.command=h.getConditionDescriptor(r.CONDITION_BY_VALUE),l.itemsSnapshot=w):(l.args=[],l.command=h.getConditionDescriptor(r.CONDITION_NONE));t.setCachedState(n,l)};i(n.editedConditionStack.column,n.editedConditionStack.conditions,n.conditionArgsChange,n.filteredRowsFactory);n.dependentConditionStacks.length&&i(n.dependentConditionStacks[0].column,n.dependentConditionStacks[0].conditions,n.conditionArgsChange,n.filteredRowsFactory,n.editedConditionStack)}},{key:"getMultipleSelectElement",value:function(){return this.elements.filter(function(n){return n instanceof s.default})[0]}},{key:"getMenuItemDescriptor",value:function(){var n=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return n.isHidden()},renderer:function(t,i,r,u,o,s){e.addClass(i.parentNode,"htFiltersMenuValue");var h=document.createElement("div");return e.addClass(h,"htFiltersMenuLabel"),h.textContent=s,i.appendChild(h),f.arrayEach(n.elements,function(n){return i.appendChild(n.element)}),i}}}},{key:"reset",value:function(){var i=this.hot.getTranslatedPhrase(o.FILTERS_VALUES_BLANK_CELLS),n=u.unifyColumnValues(this._getColumnVisibleValues()),r=u.intersectValues(n,n,i);this.getMultipleSelectElement().setItems(r);y(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"reset",this).call(this);this.getMultipleSelectElement().setValue(n)}},{key:"onInputKeyDown",value:function(n){b.isKey(n.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),w.stopImmediatePropagation(n))}},{key:"_getColumnVisibleValues",value:function(){var n=this.hot.getPlugin("filters").getSelectedColumn(),t=n&&n.visualIndex;return f.arrayMap(this.hot.getDataAtCol(t),function(n){return u.toEmptyString(n)})}}]),t}(g.default);t.default=l},function(n,t,i){"use strict";function e(n){return n&&n.__esModule?n:{"default":n}}function ut(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function y(n){if(Array.isArray(n)){for(var t=0,i=Array(n.length);t<n.length;t++)i[t]=n[t];return i}return Array.from(n)}function ft(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function et(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function ot(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}function st(n,t){var i=rt.createArrayAssertion(t);return r.arrayMap(n,function(n){return n.checked=i(n.value),n})}function ht(n){var t=[];return r.arrayEach(n,function(n){n.checked&&t.push(n.value)}),t}var p,w;t.__esModule=!0;var u=function b(n,t,i){var r,u,f;return n===null&&(n=Function.prototype),r=Object.getOwnPropertyDescriptor(n,t),r===undefined?(u=Object.getPrototypeOf(n),u===null?undefined:b(u,t,i)):"value"in r?r.value:(f=r.get,f===undefined)?undefined:f.call(i)},o=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),k=i(2),s=i(1),r=i(0),h=i(18),c=i(35),d=i(3),f=ut(d),l=i(11),g=i(65),a=e(g),nt=i(161),tt=e(nt),it=i(663),v=e(it),rt=i(63);p=new WeakMap;w=function(n){function t(n,i){ft(this,t);var r=et(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n,s.extend(t.DEFAULTS,i)));return p.set(r,{}),r.searchInput=new tt.default(r.hot,{placeholder:f.FILTERS_BUTTONS_PLACEHOLDER_SEARCH,className:"htUIMultipleSelectSearch"}),r.selectAllUI=new v.default(r.hot,{textContent:f.FILTERS_BUTTONS_SELECT_ALL,className:"htUISelectAll"}),r.clearAllUI=new v.default(r.hot,{textContent:f.FILTERS_BUTTONS_CLEAR,className:"htUIClearAll"}),r.items=[],r.itemsBox=null,r.registerHooks(),r}return ot(t,n),o(t,null,[{key:"DEFAULTS",get:function(){return s.clone({className:"htUIMultipleSelect",value:[]})}}]),o(t,[{key:"registerHooks",value:function(){var n=this;this.searchInput.addLocalHook("keydown",function(t){return n.onInputKeyDown(t)});this.searchInput.addLocalHook("input",function(t){return n.onInput(t)});this.selectAllUI.addLocalHook("click",function(t){return n.onSelectAllClick(t)});this.clearAllUI.addLocalHook("click",function(t){return n.onClearAllClick(t)})}},{key:"setItems",value:function(n){this.items=n;this.itemsBox&&this.itemsBox.loadData(this.items)}},{key:"getItems",value:function(){return[].concat(y(this.items))}},{key:"getValue",value:function(){return ht(this.items)}},{key:"isSelectedAllValues",value:function(){return this.items.length===this.getValue().length}},{key:"build",value:function(){var n=this,i,f,r;u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"build",this).call(this);i=document.createElement("div");f=new a.default(this.hot,{className:"htUISelectionControls",children:[this.selectAllUI,this.clearAllUI]});this._element.appendChild(this.searchInput.element);this._element.appendChild(f.element);this._element.appendChild(i);r=function(t){n._element&&(n.itemsBox&&n.itemsBox.destroy(),k.addClass(t,"htUIMultipleSelectHot"),n.itemsBox=new n.hot.constructor(t,{data:n.items,columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:function(n,t,i,r,u,f){n.title=f.instance.getDataAtRowProp(t,f.label.property)},autoWrapCol:!0,colWidths:187,height:110,width:187,copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},beforeKeyDown:function(t){return n.onItemsBoxBeforeKeyDown(t)}}),n.itemsBox.init())};r(i);setTimeout(function(){return r(i)},100)}},{key:"reset",value:function(){this.searchInput.reset();this.selectAllUI.reset();this.clearAllUI.reset()}},{key:"update",value:function(){this.isBuilt()&&(this.itemsBox.loadData(st(this.items,this.options.value)),u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"update",this).call(this))}},{key:"destroy",value:function(){this.itemsBox&&this.itemsBox.destroy();this.searchInput.destroy();this.clearAllUI.destroy();this.selectAllUI.destroy();this.searchInput=null;this.clearAllUI=null;this.selectAllUI=null;this.itemsBox=null;this.items=null;u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}},{key:"onInput",value:function(n){var t=n.target.value.toLowerCase(),i=void 0;i=t===""?[].concat(y(this.items)):r.arrayFilter(this.items,function(n){return(n.value+"").toLowerCase().indexOf(t)>=0});this.itemsBox.loadData(i)}},{key:"onInputKeyDown",value:function(n){this.runLocalHooks("keydown",n,this);var t=c.partial(h.isKey,n.keyCode);t("ARROW_DOWN|TAB")&&!this.itemsBox.isListening()&&(l.stopImmediatePropagation(n),this.itemsBox.listen(),this.itemsBox.selectCell(0,0))}},{key:"onItemsBoxBeforeKeyDown",value:function(n){var t=c.partial(h.isKey,n.keyCode);t("ESCAPE")&&this.runLocalHooks("keydown",n,this);t("ARROW_UP|ARROW_DOWN|ARROW_LEFT|ARROW_RIGHT|TAB|SPACE|ENTER")||(l.stopImmediatePropagation(n),this.itemsBox.unlisten(),this.itemsBox.deselectCell(),this.searchInput.focus())}},{key:"onSelectAllClick",value:function(n){n.preventDefault();r.arrayEach(this.itemsBox.getSourceData(),function(n){n.checked=!0});this.itemsBox.render()}},{key:"onClearAllClick",value:function(n){n.preventDefault();r.arrayEach(this.itemsBox.getSourceData(),function(n){n.checked=!1});this.itemsBox.render()}}]),t}(a.default);t.default=w},function(n,t,i){"use strict";function l(n){return n&&n.__esModule?n:{"default":n}}function a(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function v(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function y(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var r,e;t.__esModule=!0;var o=function s(n,t,i){var r,u,f;return n===null&&(n=Function.prototype),r=Object.getOwnPropertyDescriptor(n,t),r===undefined?(u=Object.getPrototypeOf(n),u===null?undefined:s(u,t,i)):"value"in r?r.value:(f=r.get,f===undefined)?undefined:f.call(i)},u=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),f=i(1),h=i(65),c=l(h);r=new WeakMap;e=function(n){function t(n,i){a(this,t);var u=v(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n,f.extend(t.DEFAULTS,i)));return r.set(u,{}),u}return y(t,n),u(t,null,[{key:"DEFAULTS",get:function(){return f.clone({href:"#",tagName:"a"})}}]),u(t,[{key:"build",value:function(){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"build",this).call(this);var n=r.get(this);n.link=this._element.firstChild}},{key:"update",value:function(){this.isBuilt()&&(r.get(this).link.textContent=this.hot.getTranslatedPhrase(this.options.textContent))}}]),t}(c.default);t.default=e},function(n,t,i){"use strict";function o(n){return n&&n.__esModule?n:{"default":n}}function y(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function p(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function w(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function b(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var s;t.__esModule=!0;var r=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),h=i(2),u=i(0),c=i(3),f=y(c),l=i(83),a=o(l),v=i(161),e=o(v);s=function(n){function t(n,i){p(this,t);var r=w(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return r.id=i.id,r.name=i.name,r.elements.push(new e.default(r.hot,{type:"button",value:f.FILTERS_BUTTONS_OK,className:"htUIButton htUIButtonOK",identifier:t.BUTTON_OK})),r.elements.push(new e.default(r.hot,{type:"button",value:f.FILTERS_BUTTONS_CANCEL,className:"htUIButton htUIButtonCancel",identifier:t.BUTTON_CANCEL})),r.registerHooks(),r}return b(t,n),r(t,null,[{key:"BUTTON_OK",get:function(){return"ok"}},{key:"BUTTON_CANCEL",get:function(){return"cancel"}}]),r(t,[{key:"registerHooks",value:function(){var n=this;u.arrayEach(this.elements,function(t){t.addLocalHook("click",function(t,i){return n.onButtonClick(t,i)})})}},{key:"getMenuItemDescriptor",value:function(){var n=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return n.isHidden()},renderer:function(t,i){return h.addClass(i.parentNode,"htFiltersMenuActionBar"),u.arrayEach(n.elements,function(n){return i.appendChild(n.element)}),i}}}},{key:"accept",value:function(){this.runLocalHooks("accept")}},{key:"cancel",value:function(){this.runLocalHooks("cancel")}},{key:"onButtonClick",value:function(n,i){i.options.identifier===t.BUTTON_OK?this.accept():this.cancel()}}]),t}(a.default);t.default=s},function(n,t,i){"use strict";function u(n){return n&&n.__esModule?n:{"default":n}}function w(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var f;t.__esModule=!0;var o=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),r=i(0),e=i(1),s=i(35),h=i(21),c=u(h),l=i(470),a=u(l),v=i(471),y=u(v),p=i(63);f=function(){function n(t){var i=this,r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:function(){return[]};w(this,n);this.conditionCollection=t;this.columnDataFactory=r;this.changes=[];this.grouping=!1;this.latestEditedColumnPosition=-1;this.latestOrderStack=[];this.conditionCollection.addLocalHook("beforeRemove",function(n){return i._onConditionBeforeModify(n)});this.conditionCollection.addLocalHook("afterAdd",function(n){return i.updateStatesAtColumn(n)});this.conditionCollection.addLocalHook("afterClear",function(n){return i.updateStatesAtColumn(n)});this.conditionCollection.addLocalHook("beforeClean",function(){return i._onConditionBeforeClean()});this.conditionCollection.addLocalHook("afterClean",function(){return i._onConditionAfterClean()})}return o(n,[{key:"groupChanges",value:function(){this.grouping=!0}},{key:"flush",value:function(){var n=this;this.grouping=!1;r.arrayEach(this.changes,function(t){n.updateStatesAtColumn(t)});this.changes.length=0}},{key:"_onConditionBeforeModify",value:function(n){this.latestEditedColumnPosition=this.conditionCollection.orderStack.indexOf(n)}},{key:"updateStatesAtColumn",value:function(n,t){var e=this,f,i,o,u,h,c;if(this.grouping){this.changes.indexOf(n)===-1&&this.changes.push(n);return}f=this.conditionCollection.exportAllConditions();i=this.conditionCollection.orderStack.indexOf(n);i===-1&&(i=this.latestEditedColumnPosition);o=f.slice(0,i);u=f.slice(i);u.length&&u[0].column===n&&u.shift();h=s.curry(function(n,t){var s=arguments.length>2&&arguments[2]!==undefined?arguments[2]:[],u=new a.default,f,i,o;return n=[].concat(n,s),u.importAllConditions(n),f=e.columnDataFactory(t),i=void 0,i=u.isEmpty()?f:new y.default(u,function(n){return e.columnDataFactory(n)}).filter(),i=r.arrayMap(i,function(n){return n.meta.visualRow}),o=p.createArrayAssertion(i),r.arrayFilter(f,function(n){return o(n.meta.visualRow)})})(o);c=[].concat(this.conditionCollection.getConditions(n));this.runLocalHooks("update",{editedConditionStack:{column:n,conditions:c},dependentConditionStacks:u,filteredRowsFactory:h,conditionArgsChange:t})}},{key:"_onConditionBeforeClean",value:function(){this.latestOrderStack=[].concat(this.conditionCollection.orderStack)}},{key:"_onConditionAfterClean",value:function(){var n=this;r.arrayEach(this.latestOrderStack,function(t){n.updateStatesAtColumn(t)})}},{key:"destroy",value:function(){var n=this;this.clearLocalHooks();e.objectEach(this,function(t,i){n[i]=null})}}]),n}();e.mixin(f,c.default);t.default=f},function(){},function(n,t,i){"use strict";function u(n){return n&&n.__esModule?n:{"default":n}}function it(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function rt(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function ut(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var o;t.__esModule=!0;var h=function(){function n(n,t){var r=[],u=!0,f=!1,e=undefined,i,o;try{for(i=n[Symbol.iterator]();!(u=(o=i.next()).done);u=!0)if(r.push(o.value),t&&r.length===t)break}catch(s){f=!0;e=s}finally{try{!u&&i["return"]&&i["return"]()}finally{if(f)throw e;}}return r}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return n(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance");}}(),c=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),f=function l(n,t,i){var r,u,f;return n===null&&(n=Function.prototype),r=Object.getOwnPropertyDescriptor(n,t),r===undefined?(u=Object.getPrototypeOf(n),u===null?undefined:l(u,t,i)):"value"in r?r.value:(f=r.get,f===undefined)?undefined:f.call(i)},a=i(7),v=u(a),s=i(0),e=i(1),y=i(9),p=u(y),w=i(6),r=i(37),b=i(668),k=u(b),d=i(677),g=u(d),nt=i(678),tt=u(nt);o=function(n){function t(n){it(this,t);var i=rt(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return i.eventManager=new p.default(i),i.dataProvider=new g.default(i.hot),i.sheet=new k.default(i.hot,i.dataProvider),i.undoRedoSnapshot=new tt.default(i.sheet),i._skipRendering=!1,i}return ut(t,n),c(t,[{key:"isEnabled",value:function(){return this.hot.getSettings().formulas?!0:!1}},{key:"enablePlugin",value:function(){var n=this,i;this.enabled||(i=this.hot.getSettings().formulas,e.isObject(i)&&e.isObject(i.variables)&&e.objectEach(i.variables,function(t,i){return n.setVariable(i,t)}),this.addHook("afterColumnSort",function(){return n.onAfterColumnSort.apply(n,arguments)}),this.addHook("afterCreateCol",function(){return n.onAfterCreateCol.apply(n,arguments)}),this.addHook("afterCreateRow",function(){return n.onAfterCreateRow.apply(n,arguments)}),this.addHook("afterLoadData",function(){return n.onAfterLoadData()}),this.addHook("afterRemoveCol",function(){return n.onAfterRemoveCol.apply(n,arguments)}),this.addHook("afterRemoveRow",function(){return n.onAfterRemoveRow.apply(n,arguments)}),this.addHook("afterSetDataAtCell",function(){return n.onAfterSetDataAtCell.apply(n,arguments)}),this.addHook("afterSetDataAtRowProp",function(){return n.onAfterSetDataAtCell.apply(n,arguments)}),this.addHook("beforeColumnSort",function(){return n.onBeforeColumnSort.apply(n,arguments)}),this.addHook("beforeCreateCol",function(){return n.onBeforeCreateCol.apply(n,arguments)}),this.addHook("beforeCreateRow",function(){return n.onBeforeCreateRow.apply(n,arguments)}),this.addHook("beforeRemoveCol",function(){return n.onBeforeRemoveCol.apply(n,arguments)}),this.addHook("beforeRemoveRow",function(){return n.onBeforeRemoveRow.apply(n,arguments)}),this.addHook("beforeValidate",function(){return n.onBeforeValidate.apply(n,arguments)}),this.addHook("beforeValueRender",function(){return n.onBeforeValueRender.apply(n,arguments)}),this.addHook("modifyData",function(){return n.onModifyData.apply(n,arguments)}),this.sheet.addLocalHook("afterRecalculate",function(){return n.onSheetAfterRecalculate.apply(n,arguments)}),f(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){f(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disablePlugin",this).call(this)}},{key:"getCellValue",value:function(n,t){var i=this.sheet.getCellAt(n,t);if(i)return i.getError()||i.getValue()}},{key:"hasComputedCellValue",value:function(n,t){return this.sheet.getCellAt(n,t)!==null}},{key:"recalculate",value:function(){this.sheet.recalculate()}},{key:"recalculateFull",value:function(){this.sheet.recalculateFull()}},{key:"recalculateOptimized",value:function(){this.sheet.recalculateOptimized()}},{key:"setVariable",value:function(n,t){this.sheet.setVariable(n,t)}},{key:"getVariable",value:function(n){return this.sheet.getVariable(n)}},{key:"onSheetAfterRecalculate",value:function(n){if(this._skipRendering){this._skipRendering=!1;return}var t=this.hot;s.arrayEach(n,function(n){var i=n.row,r=n.column;t.validateCell(t.getDataAtCell(i,r),t.getCellMeta(i,r),function(){})});t.render()}},{key:"onModifyData",value:function(n,t,i,u){u==="get"&&this.hasComputedCellValue(n,t)?i.value=this.getCellValue(n,t):u==="set"&&r.isFormulaExpression(i.value)&&(i.value=r.toUpperCaseFormula(i.value))}},{key:"onBeforeValueRender",value:function(n){return r.isFormulaExpressionEscaped(n)&&(n=r.unescapeFormulaExpression(n)),n}},{key:"onBeforeValidate",value:function(n,t,i){var r=this.hot.propToCol(i);return this.hasComputedCellValue(t,r)&&(n=this.getCellValue(t,r)),n}},{key:"onAfterSetDataAtCell",value:function(n,t){var i=this;t!=="loadData"&&(this.dataProvider.clearChanges(),s.arrayEach(n,function(n){var u=h(n,4),f=u[0],e=u[1],o=u[2],t=u[3];e=i.hot.propToCol(e);f=i.t.toPhysicalRow(f);r.isFormulaExpression(t)&&(t=r.toUpperCaseFormula(t));i.dataProvider.collectChanges(f,e,t);o!==t&&i.sheet.applyChanges(f,e,t)}),this.recalculate())}},{key:"onBeforeCreateRow",value:function(n,t,i){i==="UndoRedo.undo"&&this.undoRedoSnapshot.restore()}},{key:"onAfterCreateRow",value:function(n,t,i){this.sheet.alterManager.triggerAlter("insert_row",n,t,i!=="UndoRedo.undo")}},{key:"onBeforeRemoveRow",value:function(n,t){this.undoRedoSnapshot.save("row",n,t)}},{key:"onAfterRemoveRow",value:function(n,t){this.sheet.alterManager.triggerAlter("remove_row",n,t)}},{key:"onBeforeCreateCol",value:function(n,t,i){i==="UndoRedo.undo"&&this.undoRedoSnapshot.restore()}},{key:"onAfterCreateCol",value:function(n,t,i){this.sheet.alterManager.triggerAlter("insert_column",n,t,i!=="UndoRedo.undo")}},{key:"onBeforeRemoveCol",value:function(n,t){this.undoRedoSnapshot.save("column",n,t)}},{key:"onAfterRemoveCol",value:function(n,t){this.sheet.alterManager.triggerAlter("remove_column",n,t)}},{key:"onBeforeColumnSort",value:function(n,t){this.sheet.alterManager.prepareAlter("column_sorting",n,t)}},{key:"onAfterColumnSort",value:function(n,t){this.sheet.alterManager.triggerAlter("column_sorting",n,t)}},{key:"onAfterLoadData",value:function(){this._skipRendering=!0;this.recalculateFull()}},{key:"destroy",value:function(){this.dataProvider.destroy();this.dataProvider=null;this.sheet.destroy();this.sheet=null;f(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}}]),t}(v.default);w.registerPlugin("formulas",o);t.default=o},function(n,t,i){"use strict";function o(n){return n&&n.__esModule?n:{"default":n}}function rt(n){if(Array.isArray(n)){for(var t=0,i=Array(n.length);t<n.length;t++)i[t]=n[t];return i}return Array.from(n)}function ut(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}t.__esModule=!0;var v=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),f=i(66),u=i(0),ft=i(4),y=i(21),p=o(y),w=i(53),b=i(1),k=i(45),e=o(k),d=i(669),s=o(d),r=i(37),g=i(670),nt=o(g),tt=i(671),it=o(tt);var h=1,c=2,l=3,a=function(){function n(t,i){var r=this;ut(this,n);this.hot=t;this.t=w.getTranslator(this.hot);this.dataProvider=i;this.parser=new f.Parser;this.matrix=new nt.default(this.t);this.alterManager=new it.default(this);this._processingCell=null;this._state=l;this.parser.on("callCellValue",function(){return r._onCallCellValue.apply(r,arguments)});this.parser.on("callRangeValue",function(){return r._onCallRangeValue.apply(r,arguments)});this.alterManager.addLocalHook("afterAlter",function(){return r._onAfterAlter.apply(r,arguments)})}return v(n,[{key:"recalculate",value:function(){switch(this._state){case l:this.recalculateFull();break;case c:this.recalculateOptimized()}}},{key:"recalculateOptimized",value:function(){var n=this,t=this.matrix.getOutOfDateCells();u.arrayEach(t,function(t){var i=n.dataProvider.getSourceDataAtCell(t.row,t.column);r.isFormulaExpression(i)&&n.parseExpression(t,i.substr(1))});this._state=h;this.runLocalHooks("afterRecalculate",t,"optimized")}},{key:"recalculateFull",value:function(){var t=this,n=this.dataProvider.getSourceDataByRange();this.matrix.reset();u.arrayEach(n,function(n,i){u.arrayEach(n,function(n,u){r.isFormulaExpression(n)&&t.parseExpression(new e.default(i,u),n.substr(1))})});this._state=h;this.runLocalHooks("afterRecalculate",n,"full")}},{key:"setVariable",value:function(n,t){this.parser.setVariable(n,t)}},{key:"getVariable",value:function(n){return this.parser.getVariable(n)}},{key:"applyChanges",value:function(n,t,i){this.matrix.remove({row:n,column:t});r.isFormulaExpression(i)&&this.parseExpression(new e.default(n,t),i.substr(1));var f=this.getCellDependencies.apply(this,rt(this.t.toVisual(n,t)));u.arrayEach(f,function(n){n.setState(e.default.STATE_OUT_OFF_DATE)});this._state=c}},{key:"parseExpression",value:function(n,t){n.setState(e.default.STATE_COMPUTING);this._processingCell=n;var u=this.parser.parse(r.toUpperCaseFormula(t)),f=u.error,i=u.result;r.isFormulaExpression(i)?this.parseExpression(n,i.substr(1)):(n.setValue(i),n.setError(f),n.setState(e.default.STATE_UP_TO_DATE));this.matrix.add(n);this._processingCell=null}},{key:"getCellAt",value:function(n,t){return this.matrix.getCellAt(n,t)}},{key:"getCellDependencies",value:function(n,t){return this.matrix.getDependencies({row:n,column:t})}},{key:"_onCallCellValue",value:function(n,t){var e=n.row,o=n.column,u=new s.default(e,o),i,h;if(!this.dataProvider.isInDataRange(u.row,u.column))throw Error(f.ERROR_REF);if(this.matrix.registerCellRef(u),this._processingCell.addPrecedent(u),i=this.dataProvider.getRawDataAtCell(e.index,o.index),f.error(i)&&(h=this.matrix.getCellAt(e.index,o.index),h&&h.hasError()))throw Error(i);if(r.isFormulaExpression(i)){var c=this.parser.parse(i.substr(1)),l=c.error,a=c.result;if(l)throw Error(l);t(a)}else t(i)}},{key:"_onCallRangeValue",value:function(n,t,i){var o=n.row,h=n.column,e=this,c=t.row,l=t.column,a=this.dataProvider.getRawDataByRange(o.index,h.index,c.index,l.index),v=function(n,t){return u.arrayMap(n,function(n,i){var v=o.index+t,y=h.index+i,u=new s.default(v,y),c;if(!e.dataProvider.isInDataRange(u.row,u.column))throw Error(f.ERROR_REF);if(e.matrix.registerCellRef(u),e._processingCell.addPrecedent(u),f.error(n)&&(c=e.matrix.getCellAt(u.row,u.column),c&&c.hasError()))throw Error(n);if(r.isFormulaExpression(n)){var l=e.parser.parse(n.substr(1)),a=l.error,p=l.result;if(a)throw Error(a);n=p}return n})},y=u.arrayMap(a,function(n,t){return v(n,t)});i(y)}},{key:"_onAfterAlter",value:function(){this.recalculateOptimized()}},{key:"destroy",value:function(){this.hot=null;this.t=null;this.dataProvider.destroy();this.dataProvider=null;this.alterManager.destroy();this.alterManager=null;this.parser=null;this.matrix.reset();this.matrix=null}}]),n}();b.mixin(a,p.default);t.default=a},function(n,t,i){"use strict";function s(n){return n&&n.__esModule?n:{"default":n}}function h(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function c(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function l(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var r;t.__esModule=!0;var u=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),f=i(66),e=i(472),o=s(e);r=function(n){function t(){return h(this,t),c(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return l(t,n),u(t,[{key:"toString",value:function(){return f.toLabel({index:this.row,isAbsolute:!1},{index:this.column,isAbsolute:!1})}}]),t}(o.default);t.default=r},function(n,t,i){"use strict";function s(n){return n&&n.__esModule?n:{"default":n}}function h(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var u;t.__esModule=!0;var f=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),r=i(0),e=i(45),o=s(e);u=function(){function n(t){h(this,n);this.t=t;this.data=[];this.cellReferences=[]}return f(n,[{key:"getCellAt",value:function(n,t){var i=null;return r.arrayEach(this.data,function(r){if(r.row===n&&r.column===t)return i=r,!1}),i}},{key:"getOutOfDateCells",value:function(){return r.arrayFilter(this.data,function(n){return n.isState(o.default.STATE_OUT_OFF_DATE)})}},{key:"add",value:function(n){r.arrayFilter(this.data,function(t){return t.isEqual(n)}).length||this.data.push(n)}},{key:"remove",value:function(n){var t=Array.isArray(n),i=function(n,i){var u=!1;return t?r.arrayEach(i,function(t){if(n.isEqual(t))return u=!0,!1}):u=n.isEqual(i),u};this.data=r.arrayFilter(this.data,function(t){return!i(t,n)})}},{key:"getDependencies",value:function(n){var t=this,u=function(n){return r.arrayReduce(t.data,function(t,i){return i.hasPrecedent(n)&&t.indexOf(i)===-1&&t.push(i),t},[])},i=function i(n){var f=u(n);return f.length&&r.arrayEach(f,function(n){n.hasPrecedents()&&(f=f.concat(i(t.t.toVisual(n))))}),f};return i(n)}},{key:"registerCellRef",value:function(n){r.arrayFilter(this.cellReferences,function(t){return t.isEqual(n)}).length||this.cellReferences.push(n)}},{key:"removeCellRefsAtRange",value:function(n,t){var i=n.row,u=n.column,e=t.row,o=t.column,f=[],s=function(n){return i===void 0?!0:n.row>=i&&n.row<=e},h=function(n){return u===void 0?!0:n.column>=u&&n.column<=o};return this.cellReferences=r.arrayFilter(this.cellReferences,function(n){return s(n)&&h(n)?(f.push(n),!1):!0}),f}},{key:"reset",value:function(){this.data.length=0;this.cellReferences.length=0}}]),n}();t.default=u},function(n,t,i){"use strict";function f(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function tt(n){return n&&n.__esModule?n:{"default":n}}function it(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function u(n,t){r.has(n)||r.set(n,{prepare:t.prepare||o,operate:t.operate||o})}var s,r,e,o;t.__esModule=!0;s=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}();t.registerOperation=u;var rt=i(0),y=i(1),p=i(21),w=tt(p),b=i(672),h=f(b),k=i(673),c=f(k),d=i(674),l=f(d),g=i(675),a=f(g),nt=i(676),v=f(nt);r=new Map;u(h.OPERATION_NAME,h);u(c.OPERATION_NAME,c);u(l.OPERATION_NAME,l);u(a.OPERATION_NAME,a);u(v.OPERATION_NAME,v);e=function(){function n(t){it(this,n);this.sheet=t;this.hot=t.hot;this.dataProvider=t.dataProvider;this.matrix=t.matrix}return s(n,[{key:"prepareAlter",value:function(n){if(!r.has(n))throw Error('Alter operation "'+n+'" not exist.');for(var i=arguments.length,u=Array(i>1?i-1:0),t=1;t<i;t++)u[t-1]=arguments[t];r.get(n).prepare.apply(this,u)}},{key:"triggerAlter",value:function(n){if(!r.has(n))throw Error('Alter operation "'+n+'" not exist.');for(var i=arguments.length,u=Array(i>1?i-1:0),t=1;t<i;t++)u[t-1]=arguments[t];r.get(n).operate.apply(this,u);this.runLocalHooks.apply(this,["afterAlter"].concat(u))}},{key:"destroy",value:function(){this.sheet=null;this.hot=null;this.dataProvider=null;this.matrix=null}}]),n}();y.mixin(e,w.default);t.default=e;o=function(){}},function(n,t,i){"use strict";function f(n){return n&&n.__esModule?n:{"default":n}}function a(){var n=this.matrix,t=this.dataProvider;r=new WeakMap;u.arrayEach(n.data,function(n){r.set(n,t.t.toVisualRow(n.row))})}function v(){var t=this.matrix,n=this.dataProvider;t.cellReferences.length=0;u.arrayEach(t.data,function(t){var h,u;t.setState(s.default.STATE_OUT_OFF_DATE);t.clearPrecedents();var i=t.row,f=t.column,o=n.getSourceDataAtCell(i,f);e.isFormulaExpression(o)&&(h=r.get(t),u=new c.default(o),u.translate({row:n.t.toVisualRow(i)-h}),n.updateSourceData(i,f,u.toString()))});r=null}var l,r;t.__esModule=!0;t.OPERATION_NAME=undefined;t.prepare=a;t.operate=v;var u=i(0),e=i(37),o=i(45),s=f(o),h=i(67),c=f(h);l=t.OPERATION_NAME="column_sorting";r=void 0},function(n,t,i){"use strict";function f(n){return n&&n.__esModule?n:{"default":n}}function l(n,t){var s=arguments.length>2&&arguments[2]!==undefined?arguments[2]:!0,i=this.matrix,f=this.dataProvider,e=[0,t];r.arrayEach(i.cellReferences,function(t){t.column>=n&&t.translateTo.apply(t,e)});r.arrayEach(i.data,function(i){var p=i.row,w=i.column,y,r;if(i.column>=n&&(i.translateTo.apply(i,e),i.setState(o.default.STATE_OUT_OFF_DATE)),s){var c=i.row,l=i.column,v=f.getSourceDataAtCell(c,l);u.isFormulaExpression(v)&&(y=u.cellCoordFactory("column",n),r=new h.default(v),r.useCustomModifier(a),r.translate({column:t},y({row:p,column:w})),f.updateSourceData(c,l,r.toString()))}})}function a(n,t,i,r){var e=n.start,o=n.end,s=e[t].index,h=o[t].index,u=i,f=i;return r>s&&(u=0),r>h&&(f=0),[u,f,!1]}var c;t.__esModule=!0;t.OPERATION_NAME=undefined;t.operate=l;var r=i(0),u=i(37),e=i(45),o=f(e),s=i(67),h=f(s);c=t.OPERATION_NAME="insert_column"},function(n,t,i){"use strict";function f(n){return n&&n.__esModule?n:{"default":n}}function l(n,t){var s=arguments.length>2&&arguments[2]!==undefined?arguments[2]:!0,i=this.matrix,f=this.dataProvider,e=[t,0];r.arrayEach(i.cellReferences,function(t){t.row>=n&&t.translateTo.apply(t,e)});r.arrayEach(i.data,function(i){var p=i.row,w=i.column,y,r;if(i.row>=n&&(i.translateTo.apply(i,e),i.setState(o.default.STATE_OUT_OFF_DATE)),s){var c=i.row,l=i.column,v=f.getSourceDataAtCell(c,l);u.isFormulaExpression(v)&&(y=u.cellCoordFactory("row",n),r=new h.default(v),r.useCustomModifier(a),r.translate({row:t},y({row:p,column:w})),f.updateSourceData(c,l,r.toString()))}})}function a(n,t,i,r){var e=n.start,o=n.end,s=e[t].index,h=o[t].index,u=i,f=i;return r>s&&(u=0),r>h&&(f=0),[u,f,!1]}var c;t.__esModule=!0;t.OPERATION_NAME=undefined;t.operate=l;var r=i(0),u=i(37),e=i(45),o=f(e),s=i(67),h=f(s);c=t.OPERATION_NAME="insert_row"},function(n,t,i){"use strict";function e(n){return n&&n.__esModule?n:{"default":n}}function l(n,t){var l=arguments.length>2&&arguments[2]!==undefined?arguments[2]:!0;t=-t;var i=this.matrix,e=this.dataProvider,v=this.sheet,o=[0,t],s=Math.abs(t)-1,y=i.removeCellRefsAtRange({column:n},{column:n+s}),c=[];r.arrayEach(i.data,function(t){r.arrayEach(y,function(n){t.hasPrecedent(n)&&(t.removePrecedent(n),t.setState(u.default.STATE_OUT_OFF_DATE),r.arrayEach(v.getCellDependencies(t.row,t.column),function(n){n.setState(u.default.STATE_OUT_OFF_DATE)}))});t.column>=n&&t.column<=n+s&&c.push(t)});i.remove(c);r.arrayEach(i.cellReferences,function(t){t.column>=n&&t.translateTo.apply(t,o)});r.arrayEach(i.data,function(i){var p=i.row,w=i.column,y,r;if(i.column>=n&&(i.translateTo.apply(i,o),i.setState(u.default.STATE_OUT_OFF_DATE)),l){var s=i.row,c=i.column,v=e.getSourceDataAtCell(s,c);f.isFormulaExpression(v)&&(y=f.cellCoordFactory("column",n),r=new h.default(v),r.useCustomModifier(a),r.translate({column:t},y({row:p,column:w})),e.updateSourceData(s,c,r.toString()))}})}function a(n,t,i,r){var l=n.start,a=n.end,c=n.type,f=l[t].index,e=a[t].index,h=Math.abs(i)-1,u=i,o=i,s=!1;return f>=r&&e<=r+h&&(s=!0),s||c!=="cell"||r>=f&&(u=0,o=0),s||c!=="range"||(r>=f&&(u=0),r>e?o=0:e<=r+h&&(o-=Math.min(e-(r+h),0))),f+u<0&&(u-=f+u),[u,o,s]}var c;t.__esModule=!0;t.OPERATION_NAME=undefined;t.operate=l;var r=i(0),f=i(37),o=i(45),u=e(o),s=i(67),h=e(s);c=t.OPERATION_NAME="remove_column"},function(n,t,i){"use strict";function e(n){return n&&n.__esModule?n:{"default":n}}function l(n,t){var l=arguments.length>2&&arguments[2]!==undefined?arguments[2]:!0;t=-t;var i=this.matrix,e=this.dataProvider,v=this.sheet,o=[t,0],s=Math.abs(t)-1,y=i.removeCellRefsAtRange({row:n},{row:n+s}),c=[];r.arrayEach(i.data,function(t){r.arrayEach(y,function(n){t.hasPrecedent(n)&&(t.removePrecedent(n),t.setState(u.default.STATE_OUT_OFF_DATE),r.arrayEach(v.getCellDependencies(t.row,t.column),function(n){n.setState(u.default.STATE_OUT_OFF_DATE)}))});t.row>=n&&t.row<=n+s&&c.push(t)});i.remove(c);r.arrayEach(i.cellReferences,function(t){t.row>=n&&t.translateTo.apply(t,o)});r.arrayEach(i.data,function(i){var p=i.row,w=i.column,y,r;if(i.row>=n&&(i.translateTo.apply(i,o),i.setState(u.default.STATE_OUT_OFF_DATE)),l){var s=i.row,c=i.column,v=e.getSourceDataAtCell(s,c);f.isFormulaExpression(v)&&(y=f.cellCoordFactory("row",n),r=new h.default(v),r.useCustomModifier(a),r.translate({row:t},y({row:p,column:w})),e.updateSourceData(s,c,r.toString()))}})}function a(n,t,i,r){var l=n.start,a=n.end,c=n.type,f=l[t].index,e=a[t].index,h=Math.abs(i)-1,u=i,o=i,s=!1;return f>=r&&e<=r+h&&(s=!0),s||c!=="cell"||r>=f&&(u=0,o=0),s||c!=="range"||(r>=f&&(u=0),r>e?o=0:e<=r+h&&(o-=Math.min(e-(r+h),0))),f+u<0&&(u-=f+u),[u,o,s]}var c;t.__esModule=!0;t.OPERATION_NAME=undefined;t.operate=l;var r=i(0),f=i(37),o=i(45),u=e(o),s=i(67),h=e(s);c=t.OPERATION_NAME="remove_row"},function(n,t,i){"use strict";function u(n){if(Array.isArray(n)){for(var t=0,i=Array(n.length);t<n.length;t++)i[t]=n[t];return i}return Array.from(n)}function l(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var o;t.__esModule=!0;var s=function(){function n(n,t){var r=[],u=!0,f=!1,e=undefined,i,o;try{for(i=n[Symbol.iterator]();!(u=(o=i.next()).done);u=!0)if(r.push(o.value),t&&r.length===t)break}catch(s){f=!0;e=s}finally{try{!u&&i["return"]&&i["return"]()}finally{if(f)throw e;}}return r}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return n(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance");}}(),h=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),f=i(0),e=i(4),r=i(1),c=i(53),a=i(37);o=function(){function n(t){l(this,n);this.hot=t;this.changes={};this.t=c.getTranslator(this.hot)}return h(n,[{key:"collectChanges",value:function(n,t,i){this.changes[this._coordId(n,t)]=i}},{key:"clearChanges",value:function(){this.changes={}}},{key:"isInDataRange",value:function(n,t){return n>=0&&n<this.hot.countRows()&&t>=0&&t<this.hot.countCols()}},{key:"getDataAtCell",value:function(n,t){var i=this._coordId.apply(this,u(this.t.toPhysical(n,t)));return r.hasOwnProperty(this.changes,i)?this.changes[i]:this.hot.getDataAtCell(n,t)}},{key:"getDataByRange",value:function(n,t,i,e){var o=this,s=this.hot.getData(n,t,i,e);return f.arrayEach(s,function(i,e){f.arrayEach(i,function(i,f){var h=o._coordId.apply(o,u(o.t.toPhysical(e+n,f+t)));r.hasOwnProperty(o.changes,h)&&(s[e][f]=o.changes[h])})}),s}},{key:"getSourceDataAtCell",value:function(n,t){var i=this._coordId(n,t);return r.hasOwnProperty(this.changes,i)?this.changes[i]:this.hot.getSourceDataAtCell(n,t)}},{key:"getSourceDataByRange",value:function(n,t,i,r){return this.hot.getSourceDataArray(n,t,i,r)}},{key:"getRawDataAtCell",value:function(n,t){return this.getSourceDataAtCell.apply(this,u(this.t.toPhysical(n,t)))}},{key:"getRawDataByRange",value:function(n,t,i,u){var f=this,o=[];return e.rangeEach(n,i,function(n){var i=[];e.rangeEach(t,u,function(t){var c=f.t.toPhysical(n,t),u=s(c,2),e=u[0],o=u[1],h=f._coordId(e,o);r.hasOwnProperty(f.changes,h)?i.push(f.changes[h]):i.push(f.getSourceDataAtCell(e,o))});o.push(i)}),o}},{key:"updateSourceData",value:function(n,t,i){this.hot.getSourceData()[n][this.hot.colToProp(t)]=i}},{key:"_coordId",value:function(n,t){return n+":"+t}},{key:"destroy",value:function(){this.hot=null;this.changes=null;this.t=null}}]),n}();t.default=o},function(n,t,i){"use strict";function u(n){return n&&n.__esModule?n:{"default":n}}function l(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var f;t.__esModule=!0;var e=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),r=i(0),a=i(4),o=i(679),s=u(o),h=i(45),c=u(h);f=function(){function n(t){l(this,n);this.sheet=t;this.stack=new s.default}return e(n,[{key:"save",value:function(n,t,i){var u=this.sheet,e=u.matrix,o=u.dataProvider,f=[];r.arrayEach(e.data,function(r){var u=r.row,e=r.column,s;(r[n]<t||r[n]>t+(i-1))&&(s=o.getSourceDataAtCell(u,e),f.push({row:u,column:e,value:s}))});this.stack.push({axis:n,index:t,amount:i,changes:f})}},{key:"restore",value:function(){var t=this.sheet,o=t.matrix,i=t.dataProvider,n=this.stack.pop(),u=n.axis,s=n.index,f=n.amount,e=n.changes;e&&r.arrayEach(e,function(n){n[u]>s+(f-1)&&(n[u]-=f);var t=n.row,r=n.column,e=n.value,h=i.getSourceDataAtCell(t,r);h!==e&&(i.updateSourceData(t,r,e),o.getCellAt(t,r).setState(c.default.STATE_OUT_OFF_DATE))})}},{key:"destroy",value:function(){this.sheet=null;this.stack=null}}]),n}();t.default=f},function(n,t){"use strict";function u(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var i,r;t.__esModule=!0;i=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}();r=function(){function n(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];u(this,n);this.items=t}return i(n,[{key:"push",value:function(){var n;(n=this.items).push.apply(n,arguments)}},{key:"pop",value:function(){return this.items.pop()}},{key:"peek",value:function(){if(!this.isEmpty())return this.items[this.items.length-1]}},{key:"isEmpty",value:function(){return!this.size()}},{key:"size",value:function(){return this.items.length}}]),n}();t.default=r},function(n,t,i){"use strict";function e(n){return n&&n.__esModule?n:{"default":n}}function g(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function nt(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function tt(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var o;t.__esModule=!0;var s=function(){function n(n,t){var r=[],u=!0,f=!1,e=undefined,i,o;try{for(i=n[Symbol.iterator]();!(u=(o=i.next()).done);u=!0)if(r.push(o.value),t&&r.length===t)break}catch(s){f=!0;e=s}finally{try{!u&&i["return"]&&i["return"]()}finally{if(f)throw e;}}return r}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return n(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance");}}(),c=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),f=function l(n,t,i){var r,u,f;return n===null&&(n=Function.prototype),r=Object.getOwnPropertyDescriptor(n,t),r===undefined?(u=Object.getPrototypeOf(n),u===null?undefined:l(u,t,i)):"value"in r?r.value:(f=r.get,f===undefined)?undefined:f.call(i)},h=i(2),r=i(1),a=i(81),v=i(6),y=i(7),p=e(y),w=i(473),b=e(w),k=i(681),d=e(k),u=i(474);i(682);o=function(n){function t(n){g(this,t);var i=nt(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return i.settings={},i.dateCalculator=null,i.currentYear=null,i.monthList=[],i.monthHeadersArray=[],i.weekHeadersArray=[],i.rangeBars={},i.rangeList={},i.nestedHeadersPlugin=null,i.hotSource=null,i.overallWeekSectionCount=null,i.initialSettings=null,i.dataFeed=null,i.colorData={},i.rangeBarMeta=Object.create(null),i}return tt(t,n),c(t,[{key:"checkDependencies",value:function(){this.hot.getSettings().colHeaders||console.warn("You need to enable the colHeaders property in your Gantt Chart Handsontable in order for it to work properly.")}},{key:"isEnabled",value:function(){return!!this.hot.getSettings().ganttChart}},{key:"enablePlugin",value:function(){var n=this;this.enabled||(this.checkDependencies(),this.parseSettings(),this.currentYear=this.settings.startYear||(new Date).getFullYear(),this.dateCalculator=new b.default(this.currentYear,this.settings.allowSplitWeeks),this.dateCalculator.setFirstWeekDay(this.settings.firstWeekDay),this.monthList=this.dateCalculator.getMonthList(),this.monthHeadersArray=this.generateMonthHeaders(),this.weekHeadersArray=this.generateWeekHeaders(),this.overallWeekSectionCount=this.dateCalculator.countWeekSections(),this.assignGanttSettings(),this.nestedHeadersPlugin&&(this.applyDataSource(),this.colorData&&this.setRangeBarColors(this.colorData)),this.addHook("afterInit",function(){return n.onAfterInit()}),h.addClass(this.hot.rootElement,"ganttChart"),f(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.internalUpdateSettings||(this.dataFeed&&this.dataFeed.hotSource&&this.dataFeed.removeSourceHotHooks(this.dataFeed.hotSource),this.settings={},this.dataFeed={},this.currentYear=null,this.monthList=[],this.rangeBars={},this.rangeList={},this.rangeBarMeta={},this.hotSource=null,this.deassignGanttSettings(),this.hot.getPlugin("collapsibleColumns").disablePlugin(),this.hot.getPlugin("nestedHeaders").disablePlugin(),h.removeClass(this.hot.rootElement,"ganttChart"),f(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin();this.enablePlugin();f(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updatePlugin",this).call(this)}},{key:"parseSettings",value:function(){this.settings=this.hot.getSettings().ganttChart;typeof this.settings=="boolean"&&(this.settings={});this.settings.firstWeekDay||(this.settings.firstWeekDay="monday");this.settings.allowSplitWeeks===void 0&&(this.settings.allowSplitWeeks=!0);typeof this.settings.weekHeaderGenerator!="function"&&(this.settings.weekHeaderGenerator=null)}},{key:"applyDataSource",value:function(){if(this.settings.dataSource){var n=this.settings.dataSource;n.instance?this.loadData(n.instance,n.startDateColumn,n.endDateColumn,n.additionalData,n.asyncUpdates):this.loadData(n)}}},{key:"loadData",value:function(n,t,i,r,u){n.length>1&&this.hot.alter("insert_row",0,n.length-1,this.pluginName+".loadData");this.dataFeed=new d.default(this.hot,n,t,i,r,u);this.hot.render()}},{key:"clearRangeBars",value:function(){this.rangeBars={}}},{key:"clearRangeList",value:function(){this.rangeList={}}},{key:"getRangeBarCoordinates",value:function(n){return this.rangeList[n]}},{key:"generateHeaderSet",value:function(n){var t=this,u=this.settings.weekHeaderGenerator,i=[];return r.objectEach(this.monthList,function(r,f){var b=r.daysBeforeFullWeeks>0?1:0,k=r.daysAfterFullWeeks>0?1:0,v=r.fullWeeks+(t.settings.allowSplitWeeks?b+k:0),c=parseInt(f,10),d=t.settings.allowSplitWeeks,y="",h,e,o,p,l,w,a;if(n==="months")i.push({label:r.name,colspan:v});else if(n==="weeks")for(h=0;h<v;h++)e=null,o=null,d||r.fullWeeks!==1?(w=t.getWeekColumnRange(r,c,h),a=s(w,2),e=a[0],o=a[1]):(p=t.getWeekColumnRange(r,c,h,!0),l=s(p,2),e=l[0],o=l[1]),y=e===o?e:e+" -  "+o,i.push(u?u.call(t,e,o):y),t.dateCalculator.addDaysToCache(c,i.length-1,e,o)}),i}},{key:"getWeekColumnRange",value:function(n,t,i,r){var o=this.settings.allowSplitWeeks,s=n.daysBeforeFullWeeks>0?1:0,h=n.daysAfterFullWeeks>0?1:0,c=n.fullWeeks+(this.settings.allowSplitWeeks?s+h:0),f=null,e=null;return r?t===0?(e=this.monthList[t+1].daysBeforeFullWeeks,f=u.DEC_LENGTH-(u.WEEK_LENGTH-e)+1):t===this.monthList.length-1?(e=u.WEEK_LENGTH-this.monthList[t-1].daysAfterFullWeeks,f=this.monthList[t-1].days-this.monthList[t-1].daysAfterFullWeeks+1):(e=this.monthList[t+1].daysBeforeFullWeeks,f=this.monthList[t-1].days-(u.WEEK_LENGTH-e)+1):o&&s&&i===0?(f=i+1,e=n.daysBeforeFullWeeks):o&&h&&i===c-1?(f=n.days-n.daysAfterFullWeeks+1,e=n.days):(f=null,f=o?n.daysBeforeFullWeeks+(i-s)*u.WEEK_LENGTH+1:n.daysBeforeFullWeeks+i*u.WEEK_LENGTH+1,e=f+u.WEEK_LENGTH-1),[f,e]}},{key:"generateMonthHeaders",value:function(){return this.generateHeaderSet("months")}},{key:"generateWeekHeaders",value:function(){return this.generateHeaderSet("weeks")}},{key:"generateDayHeaders",value:function(){return this.generateHeaderSet("days")}},{key:"assignGanttSettings",value:function(){var t=this,n;this.initialSettings=r.deepClone(this.hot.getSettings());n={data:a.createEmptySpreadsheetData(1,this.overallWeekSectionCount),readOnly:!0,renderer:function(n,i,r,u,f,e,o){return t.uniformBackgroundRenderer(n,i,r,u,f,e,o)},colWidths:60,hiddenColumns:!0,nestedHeaders:[this.monthHeadersArray.slice(),this.weekHeadersArray.slice()],collapsibleColumns:!0,columnSorting:!1};this.internalUpdateSettings=!0;this.hot.updateSettings(n);this.internalUpdateSettings=void 0}},{key:"deassignGanttSettings",value:function(){this.internalUpdateSettings=!0;this.initialSettings&&this.hot.updateSettings(this.initialSettings);this.internalUpdateSettings=void 0}},{key:"cacheRangeBarMeta",value:function(n,t,i,r){this.rangeBarMeta[n]||(this.rangeBarMeta[n]={});this.rangeBarMeta[n][t]||(this.rangeBarMeta[n][t]={});this.rangeBarMeta[n][t][i]=r}},{key:"applyRangeBarMetaCache",value:function(){var n=this;r.objectEach(this.rangeBarMeta,function(t,i){r.objectEach(t,function(t,u){r.objectEach(t,function(t,r){n.hot.setCellMeta(i,u,r,t)})})})}},{key:"addRangeBar",value:function(n,t,i,u){var o=this,f=this.dateCalculator.dateToColumn(t),e=this.dateCalculator.dateToColumn(i);return!this.dateCalculator.isValidRangeBarData(t,i)||f==null||e==null?!1:(this.rangeBars[n]||(this.rangeBars[n]={}),this.rangeBars[n][f]={barLength:e-f+1,partialStart:!this.dateCalculator.isOnTheEdgeOfWeek(t)[0],partialEnd:!this.dateCalculator.isOnTheEdgeOfWeek(i)[1],additionalData:{}},r.objectEach(u,function(t,i){o.rangeBars[n][f].additionalData[i]=t}),this.colorData[n]&&(this.rangeBars[n][f].colors=this.colorData[n]),this.rangeList[n]=[n,f],this.renderRangeBar(n,f,e,u),[n,f])}},{key:"getRangeBarData",value:function(n,t){var i=this.getRangeBarCoordinates(n),r;return i?(r=this.rangeBars[i[0]][i[1]],r&&n===i[0]&&(t===i[1]||t>i[1]&&t<i[1]+r.barLength))?r:!1:!1}},{key:"updateRangeBarData",value:function(n,t,i){var u=this.getRangeBarData(n,t);r.objectEach(i,function(n,t){u[t]!==n&&(u[t]=n)})}},{key:"renderRangeBar",value:function(n,t,i){for(var e,u,f=this.rangeBars[n][t],r=t;r<=i;r++)e=this.hot.getCellMeta(n,r),u=(e.className||"")+" rangeBar",(r===t&&f.partialStart||r===i&&f.partialEnd)&&(u+=" partial"),r===i&&(u+=" last"),this.hot.setCellMeta(n,r,"originalClassName",e.className),this.hot.setCellMeta(n,r,"className",u),this.hot.setCellMeta(n,r,"additionalData",f.additionalData),this.cacheRangeBarMeta(n,r,"originalClassName",e.className),this.cacheRangeBarMeta(n,r,"className",u),this.cacheRangeBarMeta(n,r,"additionalData",f.additionalData)}},{key:"removeRangeBarByDate",value:function(n,t){var i=this.dateCalculator.dateToColumn(t);this.removeRangeBarByColumn(n,i)}},{key:"removeRangeBarByColumn",value:function(n,t){var u=this,i=this.rangeBars[n][t];i&&(this.unrenderRangeBar(n,t,t+i.barLength-1),this.rangeBars[n][t]=null,r.objectEach(this.rangeList,function(i,r){r=parseInt(r,10);JSON.stringify(i)===JSON.stringify([n,t])&&(u.rangeList[r]=null)}))}},{key:"removeAllRangeBars",value:function(){var n=this;r.objectEach(this.rangeBars,function(t,i){r.objectEach(t,function(t,r){n.removeRangeBarByColumn(i,r)})})}},{key:"unrenderRangeBar",value:function(n,t,i){for(var u,r=t;r<=i;r++)u=this.hot.getCellMeta(n,r),this.hot.setCellMeta(n,r,"className",u.originalClassName),this.hot.setCellMeta(n,r,"originalClassName",void 0),this.cacheRangeBarMeta(n,r,"className",u.originalClassName),this.cacheRangeBarMeta(n,r,"originalClassName",void 0);this.hot.render()}},{key:"uniformBackgroundRenderer",value:function(n,t,i,u,f,e,o){var s=this.getRangeBarData(i,u),c=this.getRangeBarCoordinates(i),h;o.className&&(t.className=o.className);h="";r.objectEach(o.additionalData,function(n,t){h+=t+": "+n+"\n"});h=h.replace(/\n$/,"");t.title=h;t.style.background=s&&s.colors?u===c[1]&&s.partialStart||u===c[1]+s.barLength-1&&s.partialEnd?s.colors[1]:s.colors[0]:""}},{key:"setRangeBarColors",value:function(n){var t=this;this.colorData=n;r.objectEach(n,function(n,i){var r=t.getRangeBarCoordinates(i);r&&t.updateRangeBarData(r[0],r[1],{colors:n})});this.hot.render()}},{key:"setYear",value:function(n){var t=r.extend(this.hot.getSettings().ganttChart,{startYear:n});this.hot.updateSettings({ganttChart:t})}},{key:"onAfterInit",value:function(){this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders");this.applyDataSource()}},{key:"onUpdateSettings",value:function(){if(this.internalUpdateSettings){this.applyRangeBarMetaCache();return}f(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"onUpdateSettings",this).call(this)}},{key:"destroy",value:function(){this.hotSource&&this.dataFeed.removeSourceHotHooks(this.hotSource);f(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}}]),t}(p.default);v.registerPlugin("ganttChart",o);t.default=o},function(n,t,i){"use strict";function s(n){return n&&n.__esModule?n:{"default":n}}function h(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var f;t.__esModule=!0;var e=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),r=i(1),u=i(0),o=i(473),c=s(o);f=function(){function n(t,i,r,u,f,e){h(this,n);this.data=i;this.chartInstance=t;this.chartPlugin=this.chartInstance.getPlugin("ganttChart");this.hotSource=null;this.sourceHooks={};this.ongoingAsync=!1;this.applyData(i,r,u,f,e||!1)}return e(n,[{key:"applyData",value:function(n,t,i,r,u){Object.prototype.toString.call(n)==="[object Array]"?this.loadData(n):n.guid&&this.bindWithHotInstance(n,t,i,r,u)}},{key:"bindWithHotInstance",value:function(n,t,i,r,u){this.hotSource={instance:n,startColumn:t,endColumn:i,additionalData:r,asyncUpdates:u};this.addSourceHotHooks();this.asyncCall(this.updateFromSource)}},{key:"asyncCall",value:function(n){var t=this;if(!this.hotSource.asyncUpdates){n.call(this);return}this.asyncStart();setTimeout(function(){n.call(t);t.asyncEnd()},0)}},{key:"asyncStart",value:function(){this.ongoingAsync=!0}},{key:"asyncEnd",value:function(){this.ongoingAsync=!1}},{key:"addSourceHotHooks",value:function(){var n=this;this.sourceHooks={afterLoadData:function(t){return n.onAfterSourceLoadData(t)},afterChange:function(t,i){return n.onAfterSourceChange(t,i)},afterColumnSort:function(t,i){return n.onAfterColumnSort(t,i)}};this.hotSource.instance.addHook("afterLoadData",this.sourceHooks.afterLoadData);this.hotSource.instance.addHook("afterChange",this.sourceHooks.afterChange);this.hotSource.instance.addHook("afterColumnSort",this.sourceHooks.afterColumnSort)}},{key:"removeSourceHotHooks",value:function(n){this.sourceHooks.afterLoadData&&n.instance.removeHook("afterLoadData",this.sourceHooks.afterLoadData);this.sourceHooks.afterChange&&n.instance.removeHook("afterChange",this.sourceHooks.afterChange);this.sourceHooks.afterColumnSort&&n.instance.removeHook("afterColumnSort",this.sourceHooks.afterColumnSort)}},{key:"getDataFromSource",value:function(n){var f={},t=this.hotSource,i=void 0,o=[],s,u,e,h;for(n===void 0?i=t.instance.getData(0,0,t.instance.countRows()-1,t.instance.countCols()-1):(i=[],i[n]=t.instance.getDataAtRow(n)),s=function(n){f={};var u=i[n];if(u[t.startColumn]===null||u[t.startColumn]==="")return"continue";r.objectEach(t.additionalData,function(n,t){f[t]=u[n]});o.push([n,u[t.startColumn],u[t.endColumn],f,n])},u=n||0,e=i.length;u<(n?n+1:e);u++)h=s(u,e),h==="continue";return o}},{key:"updateFromSource",value:function(n){var t=this,i=this.getDataFromSource(n);!n&&isNaN(n)&&(this.chartPlugin.clearRangeBars(),this.chartPlugin.clearRangeList());u.arrayEach(i,function(n){n=t.trimRangeIfNeeded(n);t.chartPlugin.addRangeBar.apply(t.chartPlugin,n)})}},{key:"loadData",value:function(n){var t=this;u.arrayEach(n,function(n,i){n=t.trimRangeIfNeeded(n);t.chartPlugin.addRangeBar(i,n.startDate,n.endDate,n.additionalData)})}},{key:"trimRangeIfNeeded",value:function(n){var t=null,i,r,u,f;return(t=n[1]?{startDate:1,endDate:2}:{startDate:"startDate",endDate:"endDate"},i=new Date(n[t.startDate]),r=new Date(n[t.endDate]),typeof i=="string"||typeof r=="string")?!1:(u=i.getFullYear(),f=r.getFullYear(),u<this.chartPlugin.currentYear&&f>=this.chartPlugin.currentYear&&(n[t.startDate]="01/01/"+this.chartPlugin.currentYear),f>this.chartPlugin.currentYear&&u<=this.chartPlugin.currentYear&&(n[t.endDate]="12/31/"+this.chartPlugin.currentYear),n)}},{key:"onAfterSourceChange",value:function(n){var t=this;this.asyncCall(function(){var i,u,o;if(n){for(i={},u=0,o=n.length;u<o;u++){var f=n[u],e=parseInt(f[0],10),s=parseInt(f[1],10);i[e]||(i[e]={});i[e][s]=[f[2],f[3]]}r.objectEach(i,function(n,i){i=parseInt(i,10);t.chartPlugin.getRangeBarCoordinates(i)&&t.chartPlugin.removeRangeBarByColumn(i,t.chartPlugin.rangeList[i][1]);t.updateFromSource(i)})}})}},{key:"onAfterSourceLoadData",value:function(){var n=this;this.asyncCall(function(){n.chartPlugin.removeAllRangeBars();n.updateFromSource()})}},{key:"onAfterColumnSort",value:function(){var n=this;this.asyncCall(function(){n.chartPlugin.removeAllRangeBars();n.updateFromSource()})}}]),n}();t.default=f},function(){},function(n,t,i){"use strict";function a(n){return n&&n.__esModule?n:{"default":n}}function v(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function y(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function p(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var f;t.__esModule=!0;var o=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),r=function s(n,t,i){var r,u,f;return n===null&&(n=Function.prototype),r=Object.getOwnPropertyDescriptor(n,t),r===undefined?(u=Object.getPrototypeOf(n),u===null?undefined:s(u,t,i)):"value"in r?r.value:(f=r.get,f===undefined)?undefined:f.call(i)},u=i(2),h=i(6),e=i(4),c=i(7),l=a(c);f=function(n){function t(n){v(this,t);var i=y(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return i.settings=null,i}return p(t,n),o(t,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().headerTooltips}},{key:"enablePlugin",value:function(){var n=this;this.enabled||(this.settings=this.hot.getSettings().headerTooltips,this.parseSettings(),this.addHook("afterGetColHeader",function(t,i){return n.onAfterGetHeader(t,i)}),this.addHook("afterGetRowHeader",function(t,i){return n.onAfterGetHeader(t,i)}),r(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.settings=null;this.clearTitleAttributes();r(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disablePlugin",this).call(this)}},{key:"parseSettings",value:function(){typeof this.settings=="boolean"&&(this.settings={rows:!0,columns:!0,onlyTrimmed:!1})}},{key:"clearTitleAttributes",value:function(){var t=this.hot.view.wt.getSetting("columnHeaders").length,i=this.hot.view.wt.wtTable.THEAD,r=this.hot.view.wt.wtOverlays.topOverlay.clone.wtTable.THEAD,n=this.hot.view.wt.wtOverlays.topLeftCornerOverlay?hot.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.THEAD:null;e.rangeEach(0,t-1,function(t){var o=i.childNodes[t],u=r.childNodes[t],f=n?n.childNodes[t]:null;e.rangeEach(0,o.childNodes.length-1,function(t){o.childNodes[t].removeAttribute("title");u&&u.childNodes[t]&&u.childNodes[t].removeAttribute("title");n&&f&&f.childNodes[t]&&f.childNodes[t].removeAttribute("title")})},!0)}},{key:"onAfterGetHeader",value:function(n,t){var i=t.querySelector("span"),r=t.parentNode.parentNode.nodeName==="THEAD";(r&&this.settings.columns||!r&&this.settings.rows)&&(this.settings.onlyTrimmed?u.outerWidth(i)>=u.outerWidth(t)&&u.outerWidth(i)!==0&&t.setAttribute("title",i.textContent):t.setAttribute("title",i.textContent))}},{key:"destroy",value:function(){this.settings=null;r(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}}]),t}(l.default);h.registerPlugin("headerTooltips",f);t.default=f},function(n,t,i){"use strict";function c(n){return n&&n.__esModule?n:{"default":n}}function k(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function d(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function g(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var h;t.__esModule=!0;var l=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),o=function a(n,t,i){var r,u,f;return n===null&&(n=Function.prototype),r=Object.getOwnPropertyDescriptor(n,t),r===undefined?(u=Object.getPrototypeOf(n),u===null?undefined:a(u,t,i)):"value"in r?r.value:(f=r.get,f===undefined)?undefined:f.call(i)},r=i(2),f=i(4),e=i(0),s=i(1),v=i(6),y=i(7),p=c(y),u=i(8),w=i(685),b=c(w);i(686);h=function(n){function t(n){k(this,t);var i=d(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return i.settings=[],i.columnHeaderLevelCount=0,i.colspanArray=[],i.ghostTable=new b.default(i),i}return g(t,n),l(t,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().nestedHeaders}},{key:"enablePlugin",value:function(){var n=this;this.enabled||(this.settings=this.hot.getSettings().nestedHeaders,this.addHook("afterGetColumnHeaderRenderers",function(t){return n.onAfterGetColumnHeaderRenderers(t)}),this.addHook("afterInit",function(){return n.onAfterInit()}),this.addHook("afterOnCellMouseDown",function(t,i,r){return n.onAfterOnCellMouseDown(t,i,r)}),this.addHook("beforeOnCellMouseOver",function(t,i,r,u){return n.onBeforeOnCellMouseOver(t,i,r,u)}),this.addHook("afterViewportColumnCalculatorOverride",function(t){return n.onAfterViewportColumnCalculatorOverride(t)}),this.addHook("modifyColWidth",function(t,i){return n.onModifyColWidth(t,i)}),this.setupColspanArray(),this.checkForFixedColumnsCollision(),this.columnHeaderLevelCount=this.hot.view?this.hot.view.wt.getSetting("columnHeaders").length:0,o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.clearColspans();this.settings=[];this.columnHeaderLevelCount=0;this.colspanArray=[];this.ghostTable.clear();o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin();this.enablePlugin();o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updatePlugin",this).call(this);this.ghostTable.buildWidthsMapper()}},{key:"clearColspans",value:function(){var t,i,r,u,n,e;if(this.hot.view){var o=this.hot.view.wt.getSetting("columnHeaders").length,s=this.hot.view.wt.wtTable.THEAD,h=this.hot.view.wt.wtOverlays.topOverlay.clone.wtTable.THEAD,f=this.hot.view.wt.wtOverlays.topLeftCornerOverlay?this.hot.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.THEAD:null;for(t=0;t<o;t++){if(i=s.childNodes[t],!i)break;for(r=h.childNodes[t],u=f?f.childNodes[t]:null,n=0,e=i.childNodes.length;n<e;n++)i.childNodes[n].removeAttribute("colspan"),r&&r.childNodes[n]&&r.childNodes[n].removeAttribute("colspan"),f&&u&&u.childNodes[n]&&u.childNodes[n].removeAttribute("colspan")}}}},{key:"checkForFixedColumnsCollision",value:function(){var t=this,n=this.hot.getSettings().fixedColumnsLeft;e.arrayEach(this.colspanArray,function(i,r){t.getNestedParent(r,n)!==n&&console.warn("You have declared a Nested Header overlapping the Fixed Columns section - it may lead to visual glitches. To prevent that kind of problems, split the nested headers between the fixed and non-fixed columns.")})}},{key:"checkForOverlappingHeaders",value:function(){var n=this;e.arrayEach(this.colspanArray,function(t,i){e.arrayEach(n.colspanArray[i],function(t,r){var u,f,o;if(t.colspan>1&&(u=n.levelToRowCoords(i),f=n.getChildHeaders(u,r),f.length>0))return o=0,e.arrayEach(f,function(t){o+=n.getColspan(u+1,t)}),o>t.colspan&&console.warn("Your Nested Headers plugin setup contains overlapping headers. This kind of configuration is currently not supported and might result in glitches."),!1})})}},{key:"setupColspanArray",value:function(){function t(n,t){n[t]||(n[t]=[])}var n=this;s.objectEach(this.settings,function(i,r){s.objectEach(i,function(i,u,f){if(t(n.colspanArray,r),f[u].colspan===void 0)n.colspanArray[r].push({label:f[u]||"",colspan:1,hidden:!1});else{var e=f[u].colspan||1;n.colspanArray[r].push({label:f[u].label||"",colspan:e,hidden:!1});n.fillColspanArrayWithDummies(e,r)}})})}},{key:"fillColspanArrayWithDummies",value:function(n,t){var i=this;f.rangeEach(0,n-2,function(){i.colspanArray[t].push({label:"",colspan:1,hidden:!0})})}},{key:"headerRendererFactory",value:function(n){var t=this;return function(i,u){var f,e;if(u.removeAttribute("colspan"),r.removeClass(u,"hiddenHeader"),t.colspanArray[n][i]&&t.colspanArray[n][i].colspan){var o=t.colspanArray[n][i].colspan,s=t.hot.getSettings().fixedColumnsLeft||0,h=t.hot.view.wt.wtOverlays.topLeftCornerOverlay,c=t.hot.view.wt.wtOverlays.leftOverlay,l=h?h.clone.wtTable.THEAD.contains(u):!1,a=c?c.clone.wtTable.THEAD.contains(u):!1;o>1&&u.setAttribute("colspan",l||a?Math.min(o,s-i):o);(l||a&&i===s-1)&&r.addClass(u,"overlayEdge")}t.colspanArray[n][i]&&t.colspanArray[n][i].hidden&&r.addClass(u,"hiddenHeader");r.empty(u);f=document.createElement("DIV");r.addClass(f,"relative");e=document.createElement("SPAN");r.addClass(e,"colHeader");r.fastInnerHTML(e,t.colspanArray[n][i]?t.colspanArray[n][i].label||"":"");f.appendChild(e);u.appendChild(f);t.hot.runHooks("afterGetColHeader",i,u)}}},{key:"getColspan",value:function(n,t){var i=this.colspanArray[this.rowCoordsToLevel(n)][t];return i?i.colspan:1}},{key:"levelToRowCoords",value:function(n){return n-this.columnHeaderLevelCount}},{key:"rowCoordsToLevel",value:function(n){return n+this.columnHeaderLevelCount}},{key:"getNestedParent",value:function(n,t){var r,u,i;if(n<0)return!1;if(r=this.colspanArray[n][t]?this.colspanArray[n][t].colspan:1,u=this.colspanArray[n][t]?this.colspanArray[n][t].hidden:!1,r>1||r===1&&u===!1)return t;i=t-1;do{if(this.colspanArray[n][i].colspan>1)break;i--}while(t>=0);return i}},{key:"getChildHeaders",value:function(n,t){var u=this.rowCoordsToLevel(n),i=this.colspanArray[u+1],e=this.getNestedParent(u,t),o=this.colspanArray[u][t].colspan,r=[];return i?(f.rangeEach(e,e+o-1,function(n){i[n]&&i[n].colspan>1&&(o-=i[n].colspan-1);i[n]&&!i[n].hidden&&r.indexOf(n)===-1&&r.push(n)}),r):r}},{key:"fillTheRemainingColspans",value:function(){var n=this;s.objectEach(this.settings,function(t,i){f.rangeEach(n.colspanArray[i].length-1,n.hot.countCols()-1,function(r){n.colspanArray[i].push({label:t[r]||"",colspan:1,hidden:!1})},!0)})}},{key:"updateHeadersHighlight",value:function(){var t=this,n=this.hot.getSelectedLast();if(n!==void 0){var i="ht__highlight",u=this.hot.view.wt.wtOverlays,o=this.hot.selection.selectedHeader.cols,s=Math.min(n[1],n[3]),h=Math.max(n[1],n[3]),c=o?-1:this.columnHeaderLevelCount-1;f.rangeEach(s,h,function(n){for(var l=function(f){var l=t.getNestedParent(f,n),a=u.topOverlay?u.topOverlay.clone.wtTable.getColumnHeader(l,f):void 0,v=u.topLeftCornerOverlay?u.topLeftCornerOverlay.clone.wtTable.getColumnHeader(l,f):void 0,y=[a,v],p=t.getColspan(f-t.columnHeaderLevelCount,l),w=l>=s&&l+p-1<=h;e.arrayEach(y,function(n){if(n===void 0)return!1;!o&&f<c||o&&!w?r.hasClass(n,i)&&r.removeClass(n,i):r.hasClass(n,i)||r.addClass(n,i)})},f=t.columnHeaderLevelCount-1;f>-1;f--)l(f)})}}},{key:"onAfterViewportColumnCalculatorOverride",value:function(n){var i=this,t=n.startColumn;f.rangeEach(0,Math.max(this.columnHeaderLevelCount-1,0),function(r){var u=i.getNestedParent(r,n.startColumn),f;u<n.startColumn&&(f=Math.min(t,u),t=f)});n.startColumn=t}},{key:"onAfterOnCellMouseDown",value:function(n,t){var i,r,f;t.row<0&&(i=this.getColspan(t.row,t.col),r=t.col+i-1,i>1&&(f=this.hot.countRows()-1,this.hot.selection.setRangeEnd(new u.CellCoords(f,r))))}},{key:"onBeforeOnCellMouseOver",value:function(n,t,i,r){var h;if(t.row<0&&t.col>=0&&this.hot.view.isMouseDown()){var c=this.hot.getSelectedRangeLast(),f=c.from,e=c.to,l=this.getColspan(t.row,t.col),o=t.col+l-1,s=!1;f.col<=e.col?(t.col<f.col&&o===e.col||t.col<f.col&&o<f.col||t.col<f.col&&o>=f.col&&o<e.col)&&(s=!0):(t.col<e.col&&o>f.col||t.col>f.col||t.col<=e.col&&o>f.col||t.col>e.col&&o>f.col)&&(s=!0);s&&(h=[e.col,f.col],f.col=h[0],e.col=h[1]);l>1&&(r.column=!0,r.cell=!0,this.hot.selection.setSelectedHeaders(!1,!0),f.col===e.col&&(o<=f.col&&t.col<f.col?(this.hot.selection.setRangeStartOnly(new u.CellCoords(f.row,e.col)),this.hot.selection.setRangeEnd(new u.CellCoords(e.row,t.col))):(this.hot.selection.setRangeStartOnly(new u.CellCoords(f.row,t.col<f.col?t.col:f.col)),this.hot.selection.setRangeEnd(new u.CellCoords(e.row,o>e.col?o:e.col)))),f.col<e.col&&(this.hot.selection.setRangeStartOnly(new u.CellCoords(f.row,t.col<f.col?t.col:f.col)),this.hot.selection.setRangeEnd(new u.CellCoords(e.row,o))),f.col>e.col&&(this.hot.selection.setRangeStartOnly(new u.CellCoords(f.row,f.col)),this.hot.selection.setRangeEnd(new u.CellCoords(e.row,t.col))))}}},{key:"onAfterInit",value:function(){this.columnHeaderLevelCount=this.hot.view.wt.getSetting("columnHeaders").length;this.fillTheRemainingColspans();this.checkForOverlappingHeaders();this.ghostTable.buildWidthsMapper()}},{key:"onAfterGetColumnHeaderRenderers",value:function(n){if(n){n.length=0;for(var i=this.colspanArray.length,t=i-1;t>=0;t--)n.push(this.headerRendererFactory(t));n.reverse()}this.updateHeadersHighlight()}},{key:"onModifyColWidth",value:function(n,t){var i=this.ghostTable.widthsCache[t];return n>i?n:i}},{key:"destroy",value:function(){this.settings=null;this.columnHeaderLevelCount=null;this.colspanArray=null;o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}}]),t}(p.default);v.registerPlugin("nestedHeaders",h);t.default=h},function(n,t,i){"use strict";function o(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var r;t.__esModule=!0;var u=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),f=i(2),e=i(1);r=function(){function n(t){o(this,n);this.nestedHeaders=t;this.container=void 0;this.widthsCache=[]}return u(n,[{key:"buildWidthsMapper",value:function(){var t,i,n;for(this.container=document.createElement("div"),this.buildGhostTable(this.container),this.nestedHeaders.hot.rootElement.appendChild(this.container),t=this.container.querySelectorAll("tr:last-of-type th"),i=t.length,n=0;n<i;n++)this.widthsCache.push(t[n].offsetWidth);this.container.parentNode.removeChild(this.container);this.container=null;this.nestedHeaders.hot.render()}},{key:"buildGhostTable",value:function(n){for(var c,u,o,t,l,a,w,i=document,v=i.createDocumentFragment(),s=i.createElement("table"),h=!1,b=!!this.nestedHeaders.hot.getSettings().dropdownMenu,y=this.nestedHeaders.colspanArray.length,p=this.nestedHeaders.hot.countCols(),k=y-1,r=0;r<y;r++){for(c=i.createElement("tr"),h=!1,u=0;u<p;u++)o=i.createElement("th"),t=e.clone(this.nestedHeaders.colspanArray[r][u]),t&&!t.hidden&&(r===k&&(t.colspan>1&&(h=!0),b&&(t.label+='<button class="changeType"><\/button>')),f.fastInnerHTML(o,t.label),o.colSpan=t.colspan,c.appendChild(o));s.appendChild(c)}if(h){for(l=i.createElement("tr"),a=0;a<p;a++)w=i.createElement("th"),l.appendChild(w);s.appendChild(l)}v.appendChild(s);n.appendChild(v)}},{key:"clear",value:function(){this.container=null;this.widthsCache.length=0}}]),n}();t.default=r},function(){},function(n,t,i){"use strict";function u(n){return n&&n.__esModule?n:{"default":n}}function c(n){if(Array.isArray(n)){for(var t=0,i=Array(n.length);t<n.length;t++)i[t]=n[t];return i}return Array.from(n)}function rt(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function ut(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function ft(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var r,e;t.__esModule=!0;var l=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),f=function a(n,t,i){var r,u,f;return n===null&&(n=Function.prototype),r=Object.getOwnPropertyDescriptor(n,t),r===undefined?(u=Object.getPrototypeOf(n),u===null?undefined:a(u,t,i)):"value"in r?r.value:(f=r.get,f===undefined)?undefined:f.call(i)},v=i(7),y=u(v),p=i(6),o=i(4),s=i(0),h=i(8),w=i(688),b=u(w),k=i(689),d=u(k),g=i(475),nt=u(g),tt=i(690),it=u(tt);i(691);r=new WeakMap;e=function(n){function t(n){rt(this,t);var i=ut(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return i.sourceData=null,i.trimRowsPlugin=null,i.bindRowsWithHeadersPlugin=null,i.dataManager=null,i.headersUI=null,r.set(i,{changeSelection:!1,movedToFirstChild:!1,movedToCollapsed:!1,skipRender:null}),i}return ft(t,n),l(t,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().nestedRows}},{key:"enablePlugin",value:function(){var n=this;this.sourceData=this.hot.getSourceData();this.trimRowsPlugin=this.hot.getPlugin("trimRows");this.manualRowMovePlugin=this.hot.getPlugin("manualRowMove");this.bindRowsWithHeadersPlugin=this.hot.getPlugin("bindRowsWithHeaders");this.dataManager=new b.default(this,this.hot,this.sourceData);this.collapsingUI=new d.default(this,this.hot,this.trimRowsPlugin);this.headersUI=new nt.default(this,this.hot);this.contextMenuUI=new it.default(this,this.hot);this.dataManager.rewriteCache();this.addHook("afterInit",function(){return n.onAfterInit.apply(n,arguments)});this.addHook("beforeRender",function(){return n.onBeforeRender.apply(n,arguments)});this.addHook("modifyRowData",function(){return n.onModifyRowData.apply(n,arguments)});this.addHook("modifySourceLength",function(){return n.onModifySourceLength.apply(n,arguments)});this.addHook("beforeDataSplice",function(){return n.onBeforeDataSplice.apply(n,arguments)});this.addHook("beforeDataFilter",function(){return n.onBeforeDataFilter.apply(n,arguments)});this.addHook("afterContextMenuDefaultOptions",function(){return n.onAfterContextMenuDefaultOptions.apply(n,arguments)});this.addHook("afterGetRowHeader",function(){return n.onAfterGetRowHeader.apply(n,arguments)});this.addHook("beforeOnCellMouseDown",function(){return n.onBeforeOnCellMouseDown.apply(n,arguments)});this.addHook("afterRemoveRow",function(){return n.onAfterRemoveRow.apply(n,arguments)});this.addHook("modifyRemovedAmount",function(){return n.onModifyRemovedAmount.apply(n,arguments)});this.addHook("beforeAddChild",function(){return n.onBeforeAddChild.apply(n,arguments)});this.addHook("afterAddChild",function(){return n.onAfterAddChild.apply(n,arguments)});this.addHook("beforeDetachChild",function(){return n.onBeforeDetachChild.apply(n,arguments)});this.addHook("afterDetachChild",function(){return n.onAfterDetachChild.apply(n,arguments)});this.addHook("modifyRowHeaderWidth",function(){return n.onModifyRowHeaderWidth.apply(n,arguments)});this.addHook("afterCreateRow",function(){return n.onAfterCreateRow.apply(n,arguments)});this.addHook("beforeRowMove",function(){return n.onBeforeRowMove.apply(n,arguments)});this.addHook("afterRowMove",function(){return n.onAfterRowMove.apply(n,arguments)});this.trimRowsPlugin.isEnabled()||(this.trimRowsPlugin.enablePlugin(),this.hot.getSettings().trimRows=!0);f(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enablePlugin",this).call(this)}},{key:"disablePlugin",value:function(){f(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin();this.enablePlugin();f(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updatePlugin",this).call(this)}},{key:"onBeforeRowMove",value:function(n,t){for(var s=r.get(this),o=n.length,u=[],f=this.dataManager.translateTrimmedRow(t),c=!0,i=void 0,l=null,e=null,h=null,a,i=0;i<o;i++)u.push(this.dataManager.translateTrimmedRow(n[i])),this.dataManager.isParent(u[i])&&(c=!1);if(u.indexOf(f)>-1||!c||(l=this.dataManager.getRowParent(u[0]),e=this.dataManager.getRowParent(f),e==null&&(e=this.dataManager.getRowParent(f-1)),e==null&&(e=this.dataManager.getDataObject(f-1),s.movedToFirstChild=!0),!e))return!1;for(h=l===e,s.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(e),this.collapsingUI.collapsedRowsStash.stash(),h||(Math.max.apply(Math,u)<=f?this.collapsingUI.collapsedRowsStash.shiftStash(u[0],-1*n.length):this.collapsingUI.collapsedRowsStash.shiftStash(f,n.length)),s.changeSelection=!0,(u[o-1]<=f&&h||s.movedToFirstChild===!0)&&(n.reverse(),u.reverse(),s.movedToFirstChild!==!0&&f--),i=0;i<o;i++)this.dataManager.moveRow(u[i],f);if(a=u[u.length-1]<f,a)for(i=o-1;i>=0;i--)this.dataManager.moveCellMeta(u[i],f);else for(i=0;i<o;i++)this.dataManager.moveCellMeta(u[i],f);return(u[o-1]<=f&&h||this.dataManager.isParent(f))&&n.reverse(),this.dataManager.rewriteCache(),!1}},{key:"onAfterRowMove",value:function(n,t){var e=r.get(this),o,v;if(e.changeSelection){var f=n.length,i=0,u=0,s=null,l=null,a=null;this.collapsingUI.collapsedRowsStash.applyStash();s=this.dataManager.translateTrimmedRow(t);e.movedToFirstChild?(e.movedToFirstChild=!1,i=t,u=t+f-1,t>=Math.max.apply(Math,c(n))&&(i-=f,u-=f)):e.movedToCollapsed?(o=this.dataManager.getRowParent(s-1),o==null&&(o=this.dataManager.getDataObject(s-1)),v=this.dataManager.getRowIndex(o),i=v,u=i):n[f-1]<t?(u=t-1,i=u-f+1):(i=t,u=i+f-1);l=this.hot.selection;a=this.hot.countCols()-1;l.setRangeStart(new h.CellCoords(i,0));l.setRangeEnd(new h.CellCoords(u,a),!0);e.changeSelection=!1}}},{key:"onBeforeOnCellMouseDown",value:function(n,t,i){this.collapsingUI.toggleState(n,t,i)}},{key:"onModifyRowData",value:function(n){return this.dataManager.getDataObject(n)}},{key:"onModifySourceLength",value:function(){return this.dataManager.countAllRows()}},{key:"onBeforeDataSplice",value:function(n,t,i){return this.dataManager.spliceData(n,t,i),!1}},{key:"onBeforeDataFilter",value:function(n,t){var u=[],i=this.dataManager.translateTrimmedRow(n),f=r.get(this);return o.rangeEach(i,i+t-1,function(n){u.push(n)}),this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(i,t),this.collapsingUI.collapsedRowsStash.shiftStash(i,-1*t),this.dataManager.filterData(n,t,u),f.skipRender=!0,!1}},{key:"onAfterContextMenuDefaultOptions",value:function(n){return this.contextMenuUI.appendOptions(n)}},{key:"onAfterGetRowHeader",value:function(n,t){this.headersUI.appendLevelIndicators(n,t)}},{key:"onModifyRowHeaderWidth",value:function(n){return this.headersUI.rowHeaderWidthCache||n}},{key:"onAfterRemoveRow",value:function(n,t,i,u){var f=this,e;u!==this.pluginName&&(e=r.get(this),setTimeout(function(){e.skipRender=null;f.headersUI.updateRowHeaderWidth();f.collapsingUI.collapsedRowsStash.applyStash()},0))}},{key:"onModifyRemovedAmount",value:function(n,t){var i=this,r=[],u=0;return o.rangeEach(t,t+n-1,function(n){var t=!1,e=i.collapsingUI.translateTrimmedRow(n),f=i.dataManager.getDataObject(e);i.dataManager.hasChildren(f)&&(r.push(f),s.arrayEach(r,function(n){if(n.__children.indexOf(f)>-1)return t=!0,!1}),t||(u+=i.dataManager.countChildren(f)));t=!1;s.arrayEach(r,function(n){if(n.__children.indexOf(f)>-1)return t=!0,!1});t&&u--}),n+u}},{key:"onBeforeAddChild",value:function(){this.collapsingUI.collapsedRowsStash.stash()}},{key:"onAfterAddChild",value:function(n,t){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(t));this.collapsingUI.collapsedRowsStash.applyStash();this.headersUI.updateRowHeaderWidth()}},{key:"onBeforeDetachChild",value:function(){this.collapsingUI.collapsedRowsStash.stash()}},{key:"onAfterDetachChild",value:function(n,t){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(t));this.collapsingUI.collapsedRowsStash.applyStash();this.headersUI.updateRowHeaderWidth()}},{key:"onAfterCreateRow",value:function(n,t,i){i!==this.pluginName&&this.dataManager.rewriteCache()}},{key:"onAfterInit",value:function(){this.bindRowsWithHeadersPlugin.bindStrategy.strategy&&this.bindRowsWithHeadersPlugin.bindStrategy.createMap(this.hot.countSourceRows());var n=Math.max.apply(Math,c(this.dataManager.cache.levels));n>0&&this.headersUI.updateRowHeaderWidth(n)}},{key:"onBeforeRender",value:function(n,t){var i=r.get(this);i.skipRender&&(t.skipRender=!0)}}]),t}(y.default);p.registerPlugin("nestedRows",e);t.default=e},function(n,t,i){"use strict";function c(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var e;t.__esModule=!0;var o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},s=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),u=i(4),f=i(1),r=i(0),h=i(53);e=function(){function n(t,i,r){c(this,n);this.hot=i;this.data=r;this.plugin=t;this.parentReference=new WeakMap;this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap};this.recordTranslator=h.getTranslator(this.hot)}return s(n,[{key:"rewriteCache",value:function(){var n=this;this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap};u.rangeEach(0,this.data.length-1,function(t){n.cacheNode(n.data[t],0,null)})}},{key:"cacheNode",value:function(n,t,i){var u=this;this.cache.levels[t]||(this.cache.levels[t]=[],this.cache.levelCount++);this.cache.levels[t].push(n);this.cache.rows.push(n);this.cache.nodeInfo.set(n,{parent:i,row:this.cache.rows.length-1,level:t});this.hasChildren(n)&&r.arrayEach(n.__children,function(i){u.cacheNode(i,t+1,n)})}},{key:"getDataObject",value:function(n){return n==null?null:this.cache.rows[n]}},{key:"readTreeNodes",value:function(n,t,i,u){var f=this,e=!1;return isNaN(t)&&t.end?t:(n||(n={__children:this.data},e=!0,t--),i!=null&&t===i)?{result:n,end:!0}:u!=null&&n===u?{result:t,end:!0}:(t++,n.__children&&r.arrayEach(n.__children,function(r){return f.parentReference.set(r,e?null:n),t=f.readTreeNodes(r,t,i,u),isNaN(t)&&t.end?!1:void 0}),t)}},{key:"updateParentReference",value:function(){this.readTreeNodes({__children:this.data},0,this.hot.countRows())}},{key:"mockParent",value:function(){var n=this.mockNode();return n.__children=this.data,n}},{key:"mockNode",value:function(){var n={};return f.objectEach(this.data[0],function(t,i){n[i]=null}),n}},{key:"getRowIndex",value:function(n){return n==null?null:this.cache.nodeInfo.get(n).row}},{key:"getRowIndexWithinParent",value:function(n){var t=null,i;return(t=isNaN(n)?n:this.getDataObject(n),i=this.getRowParent(n),i==null)?this.data.indexOf(t):i.__children.indexOf(t)}},{key:"countAllRows",value:function(){var n={__children:this.data};return this.countChildren(n)}},{key:"countChildren",value:function(n){var i=this,t=0;return(isNaN(n)||(n=this.getDataObject(n)),!n||!n.__children)?0:(r.arrayEach(n.__children,function(n){t++;n.__children&&(t+=i.countChildren(n))}),t)}},{key:"getRowParent",value:function(n){var t=void 0;return t=isNaN(n)?n:this.getDataObject(n),this.getRowObjectParent(t)}},{key:"getRowObjectParent",value:function(n){return(typeof n=="undefined"?"undefined":o(n))!=="object"?null:this.cache.nodeInfo.get(n).parent}},{key:"getRowLevel",value:function(n){var t=null;return t=isNaN(n)?n:this.getDataObject(n),t?this.getRowObjectLevel(t):null}},{key:"getRowObjectLevel",value:function(n){return n==null?null:this.cache.nodeInfo.get(n).level}},{key:"hasChildren",value:function(n){return isNaN(n)||(n=this.getDataObject(n)),!!(n.__children&&n.__children.length)}},{key:"isParent",value:function(n){return isNaN(n)||(n=this.getDataObject(n)),!!f.hasOwnProperty(n,"__children")}},{key:"addChild",value:function(n,t){var r,i,u;this.hot.runHooks("beforeAddChild",n,t);r=null;n&&(r=this.getRowIndex(n));this.hot.runHooks("beforeCreateRow",r+this.countChildren(n)+1,1);i=n;n||(i=this.mockParent());i.__children||(i.__children=[]);t||(t=this.mockNode());i.__children.push(t);this.rewriteCache();u=this.getRowIndex(t);this.hot.runHooks("afterCreateRow",u,1);this.hot.runHooks("afterAddChild",n,t)}},{key:"addChildAtIndex",value:function(n,t,i,r){this.hot.runHooks("beforeAddChild",n,i,t);this.hot.runHooks("beforeCreateRow",r+1,1);var u=n;n||(u=this.mockParent());u.__children||(u.__children=[]);i||(i=this.mockNode());u.__children.splice(t,null,i);this.rewriteCache();this.hot.runHooks("afterCreateRow",r+1,1);this.hot.runHooks("afterAddChild",n,i,t)}},{key:"addSibling",value:function(n){var u=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"below",t=this.translateTrimmedRow(n),i=this.getRowParent(t),r=this.getRowIndexWithinParent(t);switch(u){case"below":this.addChildAtIndex(i,r+1,null,n);break;case"above":this.addChildAtIndex(i,r,null,n)}}},{key:"detachFromParent",value:function(n){var s=this,c=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!0,t=null,i=[];Array.isArray(n)?(u.rangeEach(n[0],n[2],function(n){var t=s.translateTrimmedRow(n);i.push(s.getDataObject(t))}),u.rangeEach(0,i.length-2,function(n){s.detachFromParent(i[n],!1)}),t=i[i.length-1]):t=n;var f=this.getRowIndex(t),h=this.getRowIndexWithinParent(t),e=this.getRowParent(t),o=this.getRowParent(e),l=this.getRowIndex(o),r=null;this.hot.runHooks("beforeDetachChild",e,t);h!=null&&(this.hot.runHooks("beforeRemoveRow",f,1,[f],this.plugin.pluginName),e.__children.splice(h,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",f,1,[f],this.plugin.pluginName),o?(r=l+this.countChildren(o),this.hot.runHooks("beforeCreateRow",r,1,this.plugin.pluginName),o.__children.push(t)):(r=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",r,1,this.plugin.pluginName),this.data.push(t)));this.rewriteCache();this.hot.runHooks("afterCreateRow",r,1,this.plugin.pluginName);c&&this.hot.render();this.hot.runHooks("afterDetachChild",e,t)}},{key:"filterData",value:function(n,t,i){var u=this,f=[];r.arrayEach(i,function(n){f.push(u.getDataObject(n))});r.arrayEach(f,function(n){var t=u.getRowIndexWithinParent(n),i=u.getRowParent(n);i===null?u.data.splice(t,1):i.__children.splice(t,1)});this.rewriteCache()}},{key:"spliceData",value:function(n,t,i){if(n=this.translateTrimmedRow(n),n!=null){var f=this.getDataObject(n-1),u=null,r=null;f&&f.__children&&f.__children.length===0?(u=f,r=0):(u=this.getRowParent(n),r=this.getRowIndexWithinParent(n));u?i?u.__children.splice(r,t,i):u.__children.splice(r,t):i?this.data.splice(r,t,i):this.data.splice(r,t);this.rewriteCache()}}},{key:"moveRow",value:function(n,t){var f=this.isParent(t),u=this.getRowParent(n),r=this.getRowIndexWithinParent(n),i=this.getRowParent(t);i==null&&(i=this.getRowParent(t-1));i==null&&(i=this.getDataObject(t-1));i?i.__children||(i.__children=[]):(i=this.getDataObject(t),i.__children=[]);var e=this.getRowParent(t-1),o=f?this.countChildren(e):this.getRowIndexWithinParent(t),s=u.__children.slice(r,r+1);u.__children.splice(r,1);i.__children.splice(o,0,s[0])}},{key:"moveCellMeta",value:function(n,t){var i=this.hot.getCellMetaAtRow(n);this.hot.spliceCellsMeta(t,0,i);this.hot.spliceCellsMeta(n+(n<t?0:1),1)}},{key:"translateTrimmedRow",value:function(n){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(n):n}}]),n}();t.default=e},function(n,t,i){"use strict";function u(n){return n&&n.__esModule?n:{"default":n}}function y(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function p(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function w(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var f;t.__esModule=!0;var e=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),o=i(11),r=i(0),s=i(4),h=i(2),c=i(162),l=u(c),a=i(475),v=u(a);f=function(n){function t(n,i){y(this,t);var u=p(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n,i));return u.trimRowsPlugin=n.trimRowsPlugin,u.dataManager=u.plugin.dataManager,u.collapsedRows=[],u.collapsedRowsStash={stash:function(){u.lastCollapsedRows=u.collapsedRows.slice(0);u.expandMultipleChildren(u.lastCollapsedRows,!1)},shiftStash:function(n){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;n=u.translateTrimmedRow(n);r.arrayEach(u.lastCollapsedRows,function(i,r){i>n-1&&(u.lastCollapsedRows[r]=i+t)})},applyStash:function(){u.hot.runHooks("skipLengthCache",100);u.collapseMultipleChildren(u.lastCollapsedRows,!0);u.lastCollapsedRows=void 0},trimStash:function(n,t){s.rangeEach(n,n+t-1,function(n){var t=u.lastCollapsedRows.indexOf(n);t>-1&&u.lastCollapsedRows.splice(t,1)})}},u}return w(t,n),e(t,[{key:"collapseChildren",value:function(n){var e=this,o=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!0,s=arguments.length>2&&arguments[2]!==undefined?arguments[2]:!0,f=[],t=null,i=null,u=null;return isNaN(n)?(t=n,i=this.dataManager.getRowIndex(t)):(t=this.dataManager.getDataObject(n),i=n),this.dataManager.hasChildren(t)&&r.arrayEach(t.__children,function(n){f.push(e.dataManager.getRowIndex(n))}),u=this.collapseRows(f,!0,!1),s&&this.trimRowsPlugin.trimRows(u),o&&this.renderAndAdjust(),this.collapsedRows.indexOf(i)===-1&&this.collapsedRows.push(i),u}},{key:"collapseMultipleChildren",value:function(n){var i=this,u=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!0,f=arguments.length>2&&arguments[2]!==undefined?arguments[2]:!0,t=[];r.arrayEach(n,function(n){t=t.concat(i.collapseChildren(n,!1,!1))});f&&this.trimRowsPlugin.trimRows(t);u&&this.renderAndAdjust()}},{key:"collapseRow",value:function(n){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!0;this.collapseRows([n],t)}},{key:"collapseRows",value:function(n){var i=this,u=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!0,f=arguments.length>2&&arguments[2]!==undefined?arguments[2]:!1,t=[];return r.arrayEach(n,function(n){t.push(n);u&&i.collapseChildRows(n,t)}),f&&this.trimRowsPlugin.trimRows(t),t}},{key:"collapseChildRows",value:function(n){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[],i=this,e=arguments.length>2&&arguments[2]!==undefined?arguments[2]:!0,f=arguments.length>3&&arguments[3]!==undefined?arguments[3]:!1,u;this.dataManager.hasChildren(n)&&(u=this.dataManager.getDataObject(n),r.arrayEach(u.__children,function(n){var r=i.dataManager.getRowIndex(n);t.push(r);i.collapseChildRows(r,t)}));f&&this.trimRowsPlugin.trimRows(t)}},{key:"expandRow",value:function(n){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!0;this.expandRows([n],t)}},{key:"expandRows",value:function(n){var i=this,u=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!0,f=arguments.length>2&&arguments[2]!==undefined?arguments[2]:!1,t=[];return r.arrayEach(n,function(n){t.push(n);u&&i.expandChildRows(n,t)}),f&&this.trimRowsPlugin.untrimRows(t),t}},{key:"expandChildRows",value:function(n){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[],i=this,e=arguments.length>2&&arguments[2]!==undefined?arguments[2]:!0,f=arguments.length>3&&arguments[3]!==undefined?arguments[3]:!1,u;this.dataManager.hasChildren(n)&&(u=this.dataManager.getDataObject(n),r.arrayEach(u.__children,function(n){if(!i.isAnyParentCollapsed(n)){var r=i.dataManager.getRowIndex(n);t.push(r);i.expandChildRows(r,t)}}));f&&this.trimRowsPlugin.untrimRows(t)}},{key:"expandChildren",value:function(n){var e=this,o=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!0,s=arguments.length>2&&arguments[2]!==undefined?arguments[2]:!0,f=[],t=null,i=null,u=null;return isNaN(n)?(t=n,i=this.dataManager.getRowIndex(n)):(t=this.dataManager.getDataObject(n),i=n),this.collapsedRows.splice(this.collapsedRows.indexOf(i),1),this.dataManager.hasChildren(t)&&r.arrayEach(t.__children,function(n){var t=e.dataManager.getRowIndex(n);f.push(t)}),u=this.expandRows(f,!0,!1),s&&this.trimRowsPlugin.untrimRows(u),o&&this.renderAndAdjust(),u}},{key:"expandMultipleChildren",value:function(n){var i=this,u=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!0,f=arguments.length>2&&arguments[2]!==undefined?arguments[2]:!0,t=[];r.arrayEach(n,function(n){t=t.concat(i.expandChildren(n,!1,!1))});f&&this.trimRowsPlugin.untrimRows(t);u&&this.renderAndAdjust()}},{key:"collapseAll",value:function(){var t=this,i=this.hot.getSourceData(),n=[];r.arrayEach(i,function(i){t.dataManager.hasChildren(i)&&n.push(i)});this.collapseMultipleChildren(n);this.renderAndAdjust()}},{key:"expandAll",value:function(){var t=this,i=this.hot.getSourceData(),n=[];r.arrayEach(i,function(i){t.dataManager.hasChildren(i)&&n.push(i)});this.expandMultipleChildren(n);this.renderAndAdjust()}},{key:"areChildrenCollapsed",value:function(n){var i=this,t=null,u=!0;return t=isNaN(n)?n:this.dataManager.getDataObject(n),this.dataManager.hasChildren(t)&&r.arrayEach(t.__children,function(n){var t=i.dataManager.getRowIndex(n);if(!i.trimRowsPlugin.isTrimmed(t))return u=!1,!1}),u}},{key:"isAnyParentCollapsed",value:function(n){for(var t=n,i;t!==null;)if(t=this.dataManager.getRowParent(t),i=this.dataManager.getRowIndex(t),this.collapsedRows.indexOf(i)>-1)return!0;return!1}},{key:"toggleState",value:function(n,t){if(!(t.col>=0)){var i=this.translateTrimmedRow(t.row);h.hasClass(n.target,v.default.CSS_CLASSES.button)&&(this.areChildrenCollapsed(i)?this.expandChildren(i):this.collapseChildren(i),o.stopImmediatePropagation(n))}}},{key:"translateTrimmedRow",value:function(n){return this.trimRowsPlugin.rowsMapper.getValueByIndex(n)}},{key:"renderAndAdjust",value:function(){this.hot.render();this.hot.view.wt.wtOverlays.adjustElementsSize()}}]),t}(l.default);t.default=f},function(n,t,i){"use strict";function a(n){return n&&n.__esModule?n:{"default":n}}function v(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function y(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function p(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function w(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var r,e;t.__esModule=!0;var o=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),u=i(4),s=i(0),h=i(3),f=v(h),c=i(162),l=a(c);r=new WeakMap;e=function(n){function t(n,i){y(this,t);var u=p(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n,i));return r.set(u,{row_above:function(n,t){u.dataManager.addSibling(t.start.row,"above")},row_below:function(n,t){u.dataManager.addSibling(t.start.row,"below")}}),u.dataManager=u.plugin.dataManager,u}return w(t,n),o(t,[{key:"appendOptions",value:function(n){var t=this,i=[{key:"add_child",name:function(){return this.getTranslatedPhrase(f.CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD)},callback:function(){var n=t.dataManager.translateTrimmedRow(t.hot.getSelectedLast()[0]),i=t.dataManager.getDataObject(n);t.dataManager.addChild(i)},disabled:function(){var n=t.hot.getSelectedLast();return!n||n[0]<0||t.hot.selection.selectedHeader.cols||t.hot.countRows()>=t.hot.getSettings().maxRows}},{key:"detach_from_parent",name:function(){return this.getTranslatedPhrase(f.CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD)},callback:function(){var n=t.dataManager.translateTrimmedRow(t.hot.getSelectedLast()[0]),i=t.dataManager.getDataObject(n);t.dataManager.detachFromParent(t.hot.getSelectedLast())},disabled:function(){var n=t.hot.getSelectedLast(),i=t.dataManager.translateTrimmedRow(n[0]),r=t.dataManager.getRowParent(i);return!r||!n||n[0]<0||t.hot.selection.selectedHeader.cols||t.hot.countRows()>=t.hot.getSettings().maxRows}},{name:"---------"}];return u.rangeEach(0,n.items.length-1,function(t){if(t===0)return s.arrayEach(i,function(i,r){n.items.splice(t+r,0,i)}),!1}),n=this.modifyRowInsertingOptions(n)}},{key:"modifyRowInsertingOptions",value:function(n){var t=r.get(this);return u.rangeEach(0,n.items.length-1,function(i){t[n.items[i].key]!=null&&(n.items[i].callback=t[n.items[i].key])}),n}}]),t}(l.default);t.default=e},function(){},function(n,t,i){"use strict";function e(n){return n&&n.__esModule?n:{"default":n}}function nt(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function tt(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function it(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}function h(n,t){t.textContent=""}var o;t.__esModule=!0;var c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},l=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),u=function a(n,t,i){var r,u,f;return n===null&&(n=Function.prototype),r=Object.getOwnPropertyDescriptor(n,t),r===undefined?(u=Object.getPrototypeOf(n),u===null?undefined:a(u,t,i)):"value"in r?r.value:(f=r.get,f===undefined)?undefined:f.call(i)},v=i(7),y=e(v),f=i(2),s=i(4),r=i(0),p=i(6),w=i(44),b=i(693),k=e(b),d=i(694),g=e(d);i(695);o=function(n){function t(n){nt(this,t);var i=tt(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return i.settings={},i.hiddenColumns=[],i.lastSelectedColumn=-1,i}return it(t,n),l(t,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().hiddenColumns}},{key:"enablePlugin",value:function(){var n=this;this.enabled||(this.hot.hasColHeaders()?this.addHook("afterGetColHeader",function(t,i){return n.onAfterGetColHeader(t,i)}):this.addHook("afterRenderer",function(t,i,r){return n.onAfterGetColHeader(r,t)}),this.addHook("afterContextMenuDefaultOptions",function(t){return n.onAfterContextMenuDefaultOptions(t)}),this.addHook("afterGetCellMeta",function(t,i,r){return n.onAfterGetCellMeta(t,i,r)}),this.addHook("modifyColWidth",function(t,i){return n.onModifyColWidth(t,i)}),this.addHook("beforeSetRangeStartOnly",function(t){return n.onBeforeSetRangeStart(t)}),this.addHook("beforeSetRangeEnd",function(t){return n.onBeforeSetRangeEnd(t)}),this.addHook("hiddenColumn",function(t){return n.isHidden(t)}),this.addHook("beforeStretchingColumnWidth",function(t,i){return n.onBeforeStretchingColumnWidth(t,i)}),this.addHook("afterCreateCol",function(t,i){return n.onAfterCreateCol(t,i)}),this.addHook("afterRemoveCol",function(t,i){return n.onAfterRemoveCol(t,i)}),this.hot.view&&this.onAfterPluginsInitialized(),u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin();this.enablePlugin();u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.settings={};this.hiddenColumns=[];this.lastSelectedColumn=-1;this.hot.render();u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disablePlugin",this).call(this);this.resetCellsMeta()}},{key:"showColumns",value:function(n){var t=this;r.arrayEach(n,function(n){n=parseInt(n,10);n=t.getLogicalColumnIndex(n);t.isHidden(n,!0)&&t.hiddenColumns.splice(t.hiddenColumns.indexOf(n),1)})}},{key:"showColumn",value:function(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];this.showColumns(i)}},{key:"hideColumns",value:function(n){var t=this;r.arrayEach(n,function(n){n=parseInt(n,10);n=t.getLogicalColumnIndex(n);t.isHidden(n,!0)||t.hiddenColumns.push(n)})}},{key:"hideColumn",value:function(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];this.hideColumns(i)}},{key:"isHidden",value:function(n){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!1;return t||(n=this.getLogicalColumnIndex(n)),this.hiddenColumns.indexOf(n)>-1}},{key:"resetCellsMeta",value:function(){r.arrayEach(this.hot.getCellsMeta(),function(n){n&&(n.skipColumnOnPaste=!1,n.baseRenderer!==null&&(n.renderer=n.baseRenderer,n.baseRenderer=null))})}},{key:"getLogicalColumnIndex",value:function(n){return this.hot.runHooks("modifyCol",n)}},{key:"onBeforeStretchingColumnWidth",value:function(n,t){return this.isHidden(t)&&(n=0),n}},{key:"onModifyColWidth",value:function(n,t){return this.isHidden(t)?.1:this.settings.indicators&&(this.isHidden(t+1)||this.isHidden(t-1))?n+(this.hot.hasColHeaders()?15:0):void 0}},{key:"onAfterGetCellMeta",value:function(n,t,i){var f,u,r,e,o;if(t=this.hot.runHooks("unmodifyCol",t),this.settings.copyPasteEnabled===!1&&this.isHidden(t)&&(i.skipColumnOnPaste=!0),this.isHidden(t)?(i.renderer!==h&&(i.baseRenderer=i.renderer),i.renderer=h):i.baseRenderer!==null&&(i.renderer=i.baseRenderer,i.baseRenderer=null),this.isHidden(i.visualCol-1)){f=!0;u=i.visualCol-1;i.className=i.className||"";i.className.indexOf("afterHiddenColumn")===-1&&(i.className+=" afterHiddenColumn");do{if(!this.isHidden(u)){f=!1;break}u--}while(u>=0);f&&i.className.indexOf("firstVisibleColumn")===-1&&(i.className+=" firstVisibleColumn")}else i.className&&(r=i.className.split(" "),r.length&&(e=r.indexOf("afterHiddenColumn"),o=r.indexOf("firstVisibleColumn"),e>-1&&r.splice(e,1),o>-1&&r.splice(o,1),i.className=r.join(" ")))}},{key:"onModifyCopyableRange",value:function(n){var u=this,t=[],i=function(n,i,r,u){t.push({startRow:n,endRow:i,startCol:r,endCol:u})};return r.arrayEach(n,function(n){var t=!0,r=0;s.rangeEach(n.startCol,n.endCol,function(f){u.isHidden(f)?(t||i(n.startRow,n.endRow,r,f-1),t=!0):(t&&(r=f),f===n.endCol&&i(n.startRow,n.endRow,r,f),t=!1)})}),t}},{key:"onAfterGetColHeader",value:function(n,t){if(!this.isHidden(n)){var r=!0,i=n-1;do{if(!this.isHidden(i)){r=!1;break}i--}while(i>=0);(r&&f.addClass(t,"firstVisibleColumn"),this.settings.indicators)&&(this.isHidden(n-1)&&f.addClass(t,"afterHiddenColumn"),this.isHidden(n+1)&&n>-1&&f.addClass(t,"beforeHiddenColumn"))}}},{key:"onBeforeSetRangeStart",value:function(n){var i=this,t;n.col>0||(n.col=0,t=function t(n){var r=i.getLogicalColumnIndex(n);return i.isHidden(r,!0)&&(n=t(++n)),n},n.col=t(n.col))}},{key:"onBeforeSetRangeEnd",value:function(n){var t=this,r=this.hot.countCols(),i=function i(u){var f=t.getLogicalColumnIndex(u);return t.isHidden(f,!0)&&(t.lastSelectedColumn>u||n.col===r-1?u>0?u=i(--u):s.rangeEach(0,t.lastSelectedColumn,function(n){if(!t.isHidden(n))return u=n,!1}):u=i(++u)),u};n.col=i(n.col);this.lastSelectedColumn=n.col}},{key:"onAfterContextMenuDefaultOptions",value:function(n){n.items.push({name:w.SEPARATOR},k.default(this),g.default(this))}},{key:"onAfterCreateCol",value:function(n,t){var i=[];r.arrayEach(this.hiddenColumns,function(r){r>=n&&(r+=t);i.push(r)});this.hiddenColumns=i}},{key:"onAfterRemoveCol",value:function(n,t){var i=[];r.arrayEach(this.hiddenColumns,function(r){r>=n&&(r-=t);i.push(r)});this.hiddenColumns=i}},{key:"onAfterPluginsInitialized",value:function(){var t=this,n=this.hot.getSettings().hiddenColumns;(typeof n=="undefined"?"undefined":c(n))==="object"&&(this.settings=n,n.copyPasteEnabled===void 0&&(n.copyPasteEnabled=!0),Array.isArray(n.columns)&&this.hideColumns(n.columns),n.copyPasteEnabled||this.addHook("modifyCopyableRange",function(n){return t.onModifyCopyableRange(n)}))}},{key:"destroy",value:function(){u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}}]),t}(y.default);p.registerPlugin("hiddenColumns",o);t.default=o},function(n,t,i){"use strict";function o(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function s(n){return{key:"hidden_columns_hide",name:function(){var n=this.getSelectedLast(),t=0;if(Array.isArray(n)){var i=r(n,4),u=i[1],f=i[3];u-f!=0&&(t=1)}return this.getTranslatedPhrase(e.CONTEXTMENU_ITEMS_HIDE_COLUMN,t)},callback:function(){var t=this.getSelectedRangeLast(),i=t.from,r=t.to,f=Math.min(i.col,r.col),e=Math.max(i.col,r.col);u.rangeEach(f,e,function(t){return n.hideColumn(t)});this.render();this.view.wt.wtOverlays.adjustElementsSize(!0)},disabled:!1,hidden:function(){return!this.selection.selectedHeader.cols}}}var r;t.__esModule=!0;r=function(){function n(n,t){var r=[],u=!0,f=!1,e=undefined,i,o;try{for(i=n[Symbol.iterator]();!(u=(o=i.next()).done);u=!0)if(r.push(o.value),t&&r.length===t)break}catch(s){f=!0;e=s}finally{try{!u&&i["return"]&&i["return"]()}finally{if(f)throw e;}}return r}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return n(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance");}}();t.default=s;var u=i(4),f=i(3),e=o(f)},function(n,t,i){"use strict";function o(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function s(n){var t=[],i=[];return{key:"hidden_columns_show",name:function(){var c=this.getSelectedLast(),l=0,h,s;if(Array.isArray(c)){var a=u(c,4),f=a[1],o=a[3];f>o&&(h=[o,f],f=h[0],o=h[1]);s=0;f===o?s=t.length+i.length:r.rangeEach(f,o,function(t){n.isHidden(t)&&(s+=1)});l=s<=1?0:1}return this.getTranslatedPhrase(e.CONTEXTMENU_ITEMS_SHOW_COLUMN,l)},callback:function(){var f=this.getSelectedRangeLast(),e=f.from,o=f.to,u=Math.min(e.col,o.col),s=Math.max(e.col,o.col);u===s?(t.length===u&&(n.showColumns(t),t.length=0),i.length===this.countSourceCols()-(u+1)&&(n.showColumns(i),i.length=0)):r.rangeEach(u,s,function(t){return n.showColumn(t)});this.render();this.view.wt.wtOverlays.adjustElementsSize(!0)},disabled:!1,hidden:function(){var f;if(!n.hiddenColumns.length||!this.selection.selectedHeader.cols)return!0;t.length=0;i.length=0;var o=this.getSelectedRangeLast(),s=o.from,h=o.to,u=Math.min(s.col,h.col),c=Math.max(s.col,h.col),e=!1;return u===c?(f=this.countSourceCols(),r.rangeEach(0,f,function(r){var f=t.length+i.length;if(f===n.hiddenColumns.length)return!1;r<u&&n.isHidden(r)?t.push(r):n.isHidden(r)&&i.push(r)}),f-=1,(t.length===u&&u>0||i.length===f-u&&u<f)&&(e=!0)):r.rangeEach(u,c,function(t){if(n.isHidden(t))return e=!0,!1}),!e}}}var u;t.__esModule=!0;u=function(){function n(n,t){var r=[],u=!0,f=!1,e=undefined,i,o;try{for(i=n[Symbol.iterator]();!(u=(o=i.next()).done);u=!0)if(r.push(o.value),t&&r.length===t)break}catch(s){f=!0;e=s}finally{try{!u&&i["return"]&&i["return"]()}finally{if(f)throw e;}}return r}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return n(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance");}}();t.default=s;var r=i(4),f=i(3),e=o(f)},function(){},function(n,t,i){"use strict";function e(n){return n&&n.__esModule?n:{"default":n}}function d(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function g(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function nt(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var o;t.__esModule=!0;var h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},c=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),f=function l(n,t,i){var r,u,f;return n===null&&(n=Function.prototype),r=Object.getOwnPropertyDescriptor(n,t),r===undefined?(u=Object.getPrototypeOf(n),u===null?undefined:l(u,t,i)):"value"in r?r.value:(f=r.get,f===undefined)?undefined:f.call(i)},a=i(7),v=e(a),u=i(2),s=i(4),r=i(0),y=i(6),p=i(697),w=e(p),b=i(698),k=e(b);i(699);o=function(n){function t(n){d(this,t);var i=g(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return i.settings={},i.hiddenRows=[],i.lastSelectedRow=-1,i}return nt(t,n),c(t,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().hiddenRows}},{key:"enablePlugin",value:function(){var n=this;this.enabled||(this.hot.hasRowHeaders()?this.addHook("afterGetRowHeader",function(t,i){return n.onAfterGetRowHeader(t,i)}):this.addHook("afterRenderer",function(t,i){return n.onAfterGetRowHeader(i,t)}),this.addHook("afterContextMenuDefaultOptions",function(t){return n.onAfterContextMenuDefaultOptions(t)}),this.addHook("afterGetCellMeta",function(t,i,r){return n.onAfterGetCellMeta(t,i,r)}),this.addHook("modifyRowHeight",function(t,i){return n.onModifyRowHeight(t,i)}),this.addHook("beforeSetRangeStartOnly",function(t){return n.onBeforeSetRangeStartOnly(t)}),this.addHook("beforeSetRangeStart",function(t){return n.onBeforeSetRangeStart(t)}),this.addHook("beforeSetRangeEnd",function(t){return n.onBeforeSetRangeEnd(t)}),this.addHook("hiddenRow",function(t){return n.isHidden(t)}),this.addHook("afterCreateRow",function(t,i){return n.onAfterCreateRow(t,i)}),this.addHook("afterRemoveRow",function(t,i){return n.onAfterRemoveRow(t,i)}),this.hot.view&&this.onAfterPluginsInitialized(),f(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin();this.enablePlugin();this.onAfterPluginsInitialized();f(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.settings={};this.hiddenRows=[];this.lastSelectedRow=-1;f(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disablePlugin",this).call(this);this.resetCellsMeta()}},{key:"showRows",value:function(n){var t=this;r.arrayEach(n,function(n){n=parseInt(n,10);n=t.getLogicalRowIndex(n);t.isHidden(n,!0)&&t.hiddenRows.splice(t.hiddenRows.indexOf(n),1)})}},{key:"showRow",value:function(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];this.showRows(i)}},{key:"hideRows",value:function(n){var t=this;r.arrayEach(n,function(n){n=parseInt(n,10);n=t.getLogicalRowIndex(n);t.isHidden(n,!0)||t.hiddenRows.push(n)})}},{key:"hideRow",value:function(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];this.hideRows(i)}},{key:"isHidden",value:function(n){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!1;return t||(n=this.getLogicalRowIndex(n)),this.hiddenRows.indexOf(n)>-1}},{key:"resetCellsMeta",value:function(){r.arrayEach(this.hot.getCellsMeta(),function(n){n&&(n.skipRowOnPaste=!1)})}},{key:"getLogicalRowIndex",value:function(n){return this.hot.runHooks("modifyRow",n)}},{key:"onAfterGetCellMeta",value:function(n,t,i){var f,u,r,e,o;if(n=this.hot.runHooks("unmodifyRow",n),i.skipRowOnPaste=this.settings.copyPasteEnabled===!1&&this.isHidden(n)?!0:!1,this.isHidden(n-1)){f=!0;u=n-1;i.className=i.className||"";i.className.indexOf("afterHiddenRow")===-1&&(i.className+=" afterHiddenRow");do{if(!this.isHidden(u)){f=!1;break}u--}while(u>=0);f&&i.className.indexOf("firstVisibleRow")===-1&&(i.className+=" firstVisibleRow")}else i.className&&(r=i.className.split(" "),r.length&&(e=r.indexOf("afterHiddenRow"),o=r.indexOf("firstVisibleRow"),e>-1&&r.splice(e,1),o>-1&&r.splice(o,1),i.className=r.join(" ")))}},{key:"onAfterGetRowHeader",value:function(n,t){var r=t.parentNode,f,i;r&&(this.isHidden(n)?u.addClass(r,"hide"):u.removeClass(r,"hide"));f=!0;i=n-1;do{if(!this.isHidden(i)){f=!1;break}i--}while(i>=0);f&&u.addClass(t,"firstVisibleRow");this.settings.indicators&&this.hot.hasRowHeaders()&&(this.isHidden(n-1)&&u.addClass(t,"afterHiddenRow"),this.isHidden(n+1)&&u.addClass(t,"beforeHiddenRow"))}},{key:"onModifyRowHeight",value:function(n,t){return this.isHidden(t)?.1:n}},{key:"onModifyCopyableRange",value:function(n){var u=this,t=[],i=function(n,i,r,u){t.push({startRow:n,endRow:i,startCol:r,endCol:u})};return r.arrayEach(n,function(n){var t=!0,r=0;s.rangeEach(n.startRow,n.endRow,function(f){u.isHidden(f)?(t||i(r,f-1,n.startCol,n.endCol),t=!0):(t&&(r=f),f===n.endRow&&i(r,f,n.startCol,n.endCol),t=!1)})}),t}},{key:"onBeforeSetRangeStart",value:function(n){var t=this,i=this.hot.getSelectedLast()||!1,u=this.hot.countRows()-1,r=function r(n){var f=0;return(i&&(f=n>i[0]?1:-1,t.lastSelectedRow=i[0]),u<n||n<0)?t.lastSelectedRow:(t.isHidden(n)&&(n=r(n+f)),n)};n.row=r(n.row)}},{key:"onBeforeSetRangeStartOnly",value:function(n){var i=this,t;n.row>0||(n.row=0,t=function t(n){return i.isHidden(n)&&(n=t(++n)),n},n.row=t(n.row))}},{key:"onBeforeSetRangeEnd",value:function(n){var t=this,r=this.hot.countRows(),i=function i(u){return t.isHidden(u)&&(t.lastSelectedRow>u||n.row===r-1?u>0?u=i(--u):s.rangeEach(0,t.lastSelectedRow,function(n){if(!t.isHidden(n))return u=n,!1}):u=i(++u)),u};n.row=i(n.row);this.lastSelectedRow=n.row}},{key:"onAfterContextMenuDefaultOptions",value:function(n){n.items.push({name:"---------"},w.default(this),k.default(this))}},{key:"onAfterCreateRow",value:function(n,t){var i=[];r.arrayEach(this.hiddenRows,function(r){r>=n&&(r+=t);i.push(r)});this.hiddenRows=i}},{key:"onAfterRemoveRow",value:function(n,t){var i=[];r.arrayEach(this.hiddenRows,function(r){r>=n&&(r-=t);i.push(r)});this.hiddenRows=i}},{key:"onAfterPluginsInitialized",value:function(){var t=this,n=this.hot.getSettings().hiddenRows;(typeof n=="undefined"?"undefined":h(n))==="object"&&(this.settings=n,n.copyPasteEnabled===void 0&&(n.copyPasteEnabled=!0),Array.isArray(n.rows)&&this.hideRows(n.rows),n.copyPasteEnabled||this.addHook("modifyCopyableRange",function(n){return t.onModifyCopyableRange(n)}))}},{key:"destroy",value:function(){f(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}}]),t}(v.default);y.registerPlugin("hiddenRows",o);t.default=o},function(n,t,i){"use strict";function o(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function s(n){return{key:"hidden_rows_hide",name:function(){var n=this.getSelectedLast(),t=0;if(Array.isArray(n)){var i=r(n,3),u=i[0],f=i[2];u-f!=0&&(t=1)}return this.getTranslatedPhrase(e.CONTEXTMENU_ITEMS_HIDE_ROW,t)},callback:function(){var t=this.getSelectedRangeLast(),i=t.from,r=t.to,f=Math.min(i.row,r.row),e=Math.max(i.row,r.row);u.rangeEach(f,e,function(t){return n.hideRow(t)});this.render();this.view.wt.wtOverlays.adjustElementsSize(!0)},disabled:!1,hidden:function(){return!this.selection.selectedHeader.rows}}}var r;t.__esModule=!0;r=function(){function n(n,t){var r=[],u=!0,f=!1,e=undefined,i,o;try{for(i=n[Symbol.iterator]();!(u=(o=i.next()).done);u=!0)if(r.push(o.value),t&&r.length===t)break}catch(s){f=!0;e=s}finally{try{!u&&i["return"]&&i["return"]()}finally{if(f)throw e;}}return r}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return n(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance");}}();t.default=s;var u=i(4),f=i(3),e=o(f)},function(n,t,i){"use strict";function o(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function s(n){var t=[],i=[];return{key:"hidden_rows_show",name:function(){var c=this.getSelectedLast(),l=0,h,s;if(Array.isArray(c)){var a=u(c,3),f=a[0],o=a[2];f>o&&(h=[o,f],f=h[0],o=h[1]);s=0;f===o?s=t.length+i.length:r.rangeEach(f,o,function(t){n.isHidden(t)&&(s+=1)});l=s<=1?0:1}return this.getTranslatedPhrase(e.CONTEXTMENU_ITEMS_SHOW_ROW,l)},callback:function(){var f=this.getSelectedRangeLast(),e=f.from,o=f.to,u=Math.min(e.row,o.row),s=Math.max(e.row,o.row);u===s?(t.length===u&&(n.showRows(t),t.length=0),i.length===this.countSourceRows()-(u+1)&&(n.showRows(i),i.length=0)):r.rangeEach(u,s,function(t){return n.showRow(t)});this.render();this.view.wt.wtOverlays.adjustElementsSize(!0)},disabled:!1,hidden:function(){var f;if(!n.hiddenRows.length||!this.selection.selectedHeader.rows)return!0;t.length=0;i.length=0;var o=this.getSelectedRangeLast(),s=o.from,h=o.to,u=Math.min(s.row,h.row),c=Math.max(s.row,h.row),e=!1;return u===c?(f=this.countSourceRows(),r.rangeEach(0,f,function(r){var f=t.length+i.length;if(f===n.hiddenRows.length)return!1;r<u?n.isHidden(r)&&t.push(r):n.isHidden(r)&&i.push(r)}),f-=1,(t.length===u&&u>0||i.length===f-u&&u<f)&&(e=!0)):r.rangeEach(u,c,function(t){if(n.isHidden(t))return e=!0,!1}),!e}}}var u;t.__esModule=!0;u=function(){function n(n,t){var r=[],u=!0,f=!1,e=undefined,i,o;try{for(i=n[Symbol.iterator]();!(u=(o=i.next()).done);u=!0)if(r.push(o.value),t&&r.length===t)break}catch(s){f=!0;e=s}finally{try{!u&&i["return"]&&i["return"]()}finally{if(f)throw e;}}return r}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return n(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance");}}();t.default=s;var r=i(4),f=i(3),e=o(f)},function(){},function(n,t,i){"use strict";function e(n){return n&&n.__esModule?n:{"default":n}}function p(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function w(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function b(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var u;t.__esModule=!0;var o=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),r=function s(n,t,i){var r,u,f;return n===null&&(n=Function.prototype),r=Object.getOwnPropertyDescriptor(n,t),r===undefined?(u=Object.getPrototypeOf(n),u===null?undefined:s(u,t,i)):"value"in r?r.value:(f=r.get,f===undefined)?undefined:f.call(i)},h=i(7),c=e(h),f=i(0),l=i(4),a=i(6),v=i(701),y=e(v);u=function(n){function t(n){p(this,t);var i=w(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return i.trimmedRows=[],i.removedRows=[],i.rowsMapper=new y.default(i),i}return b(t,n),o(t,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().trimRows}},{key:"enablePlugin",value:function(){var n=this,i;this.enabled||(i=this.hot.getSettings().trimRows,Array.isArray(i)&&(this.trimmedRows=i),this.rowsMapper.createMap(this.hot.countSourceRows()),this.addHook("modifyRow",function(t,i){return n.onModifyRow(t,i)}),this.addHook("unmodifyRow",function(t,i){return n.onUnmodifyRow(t,i)}),this.addHook("beforeCreateRow",function(t,i,r){return n.onBeforeCreateRow(t,i,r)}),this.addHook("afterCreateRow",function(t,i){return n.onAfterCreateRow(t,i)}),this.addHook("beforeRemoveRow",function(t,i){return n.onBeforeRemoveRow(t,i)}),this.addHook("afterRemoveRow",function(t,i){return n.onAfterRemoveRow(t,i)}),this.addHook("afterLoadData",function(t){return n.onAfterLoadData(t)}),r(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){var n=this.hot.getSettings().trimRows;Array.isArray(n)&&(this.disablePlugin(),this.enablePlugin());r(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.trimmedRows=[];this.removedRows.length=0;this.rowsMapper.clearMap();r(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disablePlugin",this).call(this)}},{key:"trimRows",value:function(n){var t=this;f.arrayEach(n,function(n){n=parseInt(n,10);t.isTrimmed(n)||t.trimmedRows.push(n)});this.hot.runHooks("skipLengthCache",100);this.rowsMapper.createMap(this.hot.countSourceRows());this.hot.runHooks("afterTrimRow",n)}},{key:"trimRow",value:function(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];this.trimRows(i)}},{key:"untrimRows",value:function(n){var t=this;f.arrayEach(n,function(n){n=parseInt(n,10);t.isTrimmed(n)&&t.trimmedRows.splice(t.trimmedRows.indexOf(n),1)});this.hot.runHooks("skipLengthCache",100);this.rowsMapper.createMap(this.hot.countSourceRows());this.hot.runHooks("afterUntrimRow",n)}},{key:"untrimRow",value:function(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];this.untrimRows(i)}},{key:"isTrimmed",value:function(n){return this.trimmedRows.indexOf(n)>-1}},{key:"untrimAll",value:function(){this.untrimRows([].concat(this.trimmedRows))}},{key:"onModifyRow",value:function(n,t){return t!==this.pluginName&&(n=this.rowsMapper.getValueByIndex(n)),n}},{key:"onUnmodifyRow",value:function(n,t){return t!==this.pluginName&&(n=this.rowsMapper.getIndexByValue(n)),n}},{key:"onBeforeCreateRow",value:function(n,t,i){return!(this.isEnabled()&&this.trimmedRows.length>0&&i==="auto")}},{key:"onAfterCreateRow",value:function(n,t){this.rowsMapper.shiftItems(n,t)}},{key:"onBeforeRemoveRow",value:function(n,t){var i=this;this.removedRows.length=0;n!==!1&&l.rangeEach(n,n+t-1,function(n){i.removedRows.push(i.hot.runHooks("modifyRow",n,i.pluginName))})}},{key:"onAfterRemoveRow",value:function(){this.rowsMapper.unshiftItems(this.removedRows)}},{key:"onAfterLoadData",value:function(n){n||this.rowsMapper.createMap(this.hot.countSourceRows())}},{key:"destroy",value:function(){this.rowsMapper.destroy();r(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}}]),t}(c.default);a.registerPlugin("trimRows",u);t.default=u},function(n,t,i){"use strict";function h(n){return n&&n.__esModule?n:{"default":n}}function c(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var r;t.__esModule=!0;var u=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),f=i(54),e=h(f),o=i(1),s=i(4);r=function(){function n(t){c(this,n);this.trimRows=t}return u(n,[{key:"createMap",value:function(n){var t=this,i=0,r=n===void 0?this._arrayMap.length:n;this._arrayMap.length=0;s.rangeEach(r-1,function(n){t.trimRows.isTrimmed(n)?i++:t._arrayMap[n-i]=n})}},{key:"destroy",value:function(){this._arrayMap=null}}]),n}();o.mixin(r,e.default);t.default=r},function(n,t,i){"use strict";function s(n){return n&&n.__esModule?n:{"default":n}}function h(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function c(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function l(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var f;t.__esModule=!0;var e=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),r=i(2),o=i(30),u=s(o);f=function(n){function t(n){h(this,t);var i=c(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return i.clone=i.makeClone(u.default.CLONE_BOTTOM),i}return l(t,n),e(t,[{key:"repositionOverlay",value:function(){var n=r.getScrollbarWidth(),t=this.clone.wtTable.holder.parentNode;this.wot.wtTable.holder.clientHeight===this.wot.wtTable.holder.offsetHeight&&(n=0);t.style.top="";t.style.bottom=n+"px"}},{key:"shouldBeRendered",value:function(){return this.wot.getSetting("fixedRowsBottom")?!0:!1}},{key:"resetFixedPosition",value:function(){var n,i;if(this.needFullRender&&this.wot.wtTable.holder.parentNode){if(n=this.clone.wtTable.holder.parentNode,i=0,n.style.top="",this.wot.wtOverlays.leftOverlay.trimmingContainer===window){var o=this.wot.wtTable.hider.getBoundingClientRect(),f=Math.ceil(o.bottom),t=void 0,u=void 0,e=document.body.offsetHeight;t=this.wot.wtTable.hider.style.left;t=t===""?0:t;u=f>e?f-e:0;i=u;u+="px";n.style.top="";n.style.left=t;n.style.bottom=u}else i=this.getScrollPosition(),r.resetCssTransform(n),this.repositionOverlay();this.adjustHeaderBordersPosition(i)}}},{key:"setScrollPosition",value:function(n){this.mainTableScrollableElement===window?window.scrollTo(r.getWindowScrollLeft(),n):this.mainTableScrollableElement.scrollTop=n}},{key:"onScroll",value:function(){this.wot.getSetting("onScrollVertically")}},{key:"sumCellSizes",value:function(n,t){for(var r=0,u=this.wot.wtSettings.settings.defaultRowHeight,i;n<t;)i=this.wot.wtTable.getRowHeight(n),r+=i===void 0?u:i,n++;return r}},{key:"adjustElementsSize",value:function(){var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:!1;this.updateTrimmingContainer();(this.needFullRender||n)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize(),n||(this.areElementSizesAdjusted=!0))}},{key:"adjustRootElementSize",value:function(){var i=this.wot.wtTable.holder,u=i.clientWidth===i.offsetWidth?0:r.getScrollbarWidth(),f=this.clone.wtTable.holder.parentNode,t=f.style,n=void 0;t.width=this.trimmingContainer===window?"":this.wot.wtViewport.getWorkspaceWidth()-u+"px";this.clone.wtTable.holder.style.width=t.width;n=r.outerHeight(this.clone.wtTable.TABLE);t.height=(n===0?n:n)+"px"}},{key:"adjustRootChildrenSize",value:function(){var n=r.getScrollbarWidth();this.clone.wtTable.hider.style.width=this.hider.style.width;this.clone.wtTable.holder.style.width=this.clone.wtTable.holder.parentNode.style.width;n===0&&(n=30);this.clone.wtTable.holder.style.height=parseInt(this.clone.wtTable.holder.parentNode.style.height,10)+n+"px"}},{key:"applyToDOM",value:function(){var n=this.wot.getSetting("totalRows");if(this.areElementSizesAdjusted||this.adjustElementsSize(),typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=this.wot.wtViewport.rowsRenderCalculator.startPosition+"px";else if(n===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="";this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){this.clone.wtTable.spreader.style.left=typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?this.wot.wtViewport.columnsRenderCalculator.startPosition+"px":""}},{key:"scrollTo",value:function(n,t){var i=this.getTableParentOffset(),e=this.wot.cloneSource?this.wot.cloneSource:this.wot,u=e.wtTable.holder,f=0;t&&u.offsetHeight!==u.clientHeight&&(f=r.getScrollbarWidth());t?(i+=this.sumCellSizes(0,n+1),i-=this.wot.wtViewport.getViewportHeight(),i+=1):i+=this.sumCellSizes(this.wot.getSetting("fixedRowsBottom"),n);i+=f;this.setScrollPosition(i)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===window?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return r.getScrollTop(this.mainTableScrollableElement)}},{key:"adjustHeaderBordersPosition",value:function(n){var t,i,u;this.wot.getSetting("fixedRowsBottom")===0&&this.wot.getSetting("columnHeaders").length>0&&(t=this.wot.wtTable.holder.parentNode,i=r.hasClass(t,"innerBorderTop"),n?r.addClass(t,"innerBorderTop"):r.removeClass(t,"innerBorderTop"),(!i&&n||i&&!n)&&this.wot.wtOverlays.adjustElementsSize());this.wot.getSetting("rowHeaders").length===0&&(u=this.clone.wtTable.THEAD.querySelector("th:nth-of-type(2)"),u&&(u.style["border-left-width"]=0))}}]),t}(u.default);u.default.registerOverlay(u.default.CLONE_BOTTOM,f);t.default=f},function(n,t,i){"use strict";function s(n){return n&&n.__esModule?n:{"default":n}}function h(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function c(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function l(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var f;t.__esModule=!0;var e=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),r=i(2),o=i(30),u=s(o);f=function(n){function t(n){h(this,t);var i=c(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return i.clone=i.makeClone(u.default.CLONE_BOTTOM_LEFT_CORNER),i}return l(t,n),e(t,[{key:"shouldBeRendered",value:function(){return this.wot.getSetting("fixedRowsBottom")&&(this.wot.getSetting("fixedColumnsLeft")||this.wot.getSetting("rowHeaders").length)?!0:!1}},{key:"repositionOverlay",value:function(){var n=r.getScrollbarWidth(),t=this.clone.wtTable.holder.parentNode;this.wot.wtTable.holder.clientHeight===this.wot.wtTable.holder.offsetHeight&&(n=0);t.style.top="";t.style.bottom=n+"px"}},{key:"resetFixedPosition",value:function(){if(this.updateTrimmingContainer(),this.wot.wtTable.holder.parentNode){var n=this.clone.wtTable.holder.parentNode,t=r.outerHeight(this.clone.wtTable.TABLE),i=r.outerWidth(this.clone.wtTable.TABLE);if(n.style.top="",this.trimmingContainer===window){var e=this.wot.wtTable.hider.getBoundingClientRect(),o=Math.ceil(e.bottom),s=Math.ceil(e.left),u=void 0,f=void 0,h=document.body.offsetHeight;u=s<0?-s:0;f=o>h?o-h:0;f+="px";u+="px";n.style.top="";n.style.left=u;n.style.bottom=f}else r.resetCssTransform(n),this.repositionOverlay();n.style.height=(t===0?t:t)+"px";n.style.width=(i===0?i:i)+"px"}}}]),t}(u.default);u.default.registerOverlay(u.default.CLONE_BOTTOM_LEFT_CORNER,f);t.default=f}])["default"]});
//# sourceMappingURL=handsontable.full.min.js.map
