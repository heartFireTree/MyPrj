/*!
 * Copyright (c) Handsoncode sp. z o.o.
 * 
 * This Handsontable Pro is a commercial software distributed by Handsoncode sp. z o. o., a limited liability
 * company registered under the laws of Poland, with its registered office in Gdynia, Poland, at 96/98 Aleja Zwycięstwa,
 * postal code 81-451, entered into the Entrepreneurs Register of the National Court Register under number 0000538651,
 * share capital: PLN 62,800.00., hereinafter referred to as "HANDSONCODE".
 * 
 * By installing, copying, or otherwise using this software, you agree to be bound by the terms
 * of its General Software License Terms ("Terms") outlined in a file "handsontable-pro-general-terms.pdf"
 * available in the main directory of the software repository.
 * This software is copyrighted and protected by copyright laws and international treaties.
 * 
 * You shall obtain a commercial license for this software at handsontable.com.
 * 
 * YOU EXPRESSLY ACKNOWLEDGE AND AGREE THAT USE OF THE SOFTWARE IS AT YOUR OWN RISK AND THAT THE SOFTWARE
 * IS PROVIDED "AS IS" WITHOUT ANY WARRANTIES OR CONDITIONS WHATSOEVER. HANDSONCODE EXPRESSLY DISCLAIMS ANY WARRANTY,
 * EXPRESS OR IMPLIED, INCLUDING, WITHOUT LIMITATION, THE IMPLIED WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE, OR NON-INFRINGMENT. HANDSONCODE DOES NOT WARRANT THAT THE SOFTWARE AND ITS FUNCTIONALITY,
 * RELIABILITY AND PERFORMANCE WILL MEET YOUR REQUIREMENTS OR THAT THE OPERATION OF THE SOFTWARE WILL BE
 * UNINTERRUPTED OR ERROR FREE.
 * 
 * Version: 1.18.1
 * Release date: 20/03/2018 (built at 20/03/2018 10:43:43)
 */
(function(n,t){typeof exports=="object"&&typeof module=="object"?module.exports=t(require("moment"),require("pikaday"),require("numbro"),require("hot-formula-parser")):typeof define=="function"&&define.amd?define("Handsontable",["moment","pikaday","numbro","hot-formula-parser"],t):typeof exports=="object"?exports.Handsontable=t(require("moment"),require("pikaday"),require("numbro"),require("hot-formula-parser")):n.Handsontable=t(n.moment,n.Pikaday,n.numbro,n.formulaParser)})(typeof self!="undefined"?self:this,function(n,t,i,r){return function(n){function t(r){if(i[r])return i[r].exports;var u=i[r]={i:r,l:!1,exports:{}};return n[r].call(u.exports,u,u.exports,t),u.l=!0,u.exports}var i={};return t.m=n,t.c=i,t.d=function(n,i,r){t.o(n,i)||Object.defineProperty(n,i,{configurable:!1,enumerable:!0,get:r})},t.n=function(n){var i=n&&n.__esModule?function(){return n["default"]}:function(){return n};return t.d(i,"a",i),i},t.o=function(n,t){return Object.prototype.hasOwnProperty.call(n,t)},t.p="",t(t.s=233)}([function(n,t){"use strict";function e(n){for(var t=0,i=n.length;t<i;)n[t]=[n[t]],t++}function o(n,t){for(var i=0,r=t.length;i<r;)n.push(t[i]),i++}function s(n){var i=[],u,f,r,t;if(!n||n.length===0||!n[0]||n[0].length===0)return i;for(u=n.length,f=n[0].length,r=0;r<u;r++)for(t=0;t<f;t++)i[t]||(i[t]=[]),i[t][r]=n[r][t];return i}function i(n,t,i,r){var f=-1,u=n,e;for(Array.isArray(n)||(u=Array.from(n)),e=u.length,r&&e&&(i=u[++f]);++f<e;)i=t(i,u[f],f,u);return i}function h(n,t){var r=-1,i=n,u;Array.isArray(n)||(i=Array.from(n));for(var e=i.length,f=[],o=-1;++r<e;)u=i[r],t(u,r,i)&&(f[++o]=u);return f}function c(n,t){var r=-1,i=n,f;Array.isArray(n)||(i=Array.from(n));for(var e=i.length,u=[],o=-1;++r<e;)f=i[r],u[++o]=t(f,r,i);return u}function r(n,t){var r=-1,i=n,u;for(Array.isArray(n)||(i=Array.from(n)),u=i.length;++r<u;)if(t(i[r],r,i)===!1)break;return n}function u(n){return i(n,function(n,t){return n+t},0)}function l(n){return i(n,function(n,t){return n>t?n:t},Array.isArray(n)?n[0]:void 0)}function a(n){return i(n,function(n,t){return n<t?n:t},Array.isArray(n)?n[0]:void 0)}function v(n){return n.length?u(n)/n.length:0}function f(n){return i(n,function(n,t){return n.concat(Array.isArray(t)?f(t):t)},[])}function y(n){var t=[];return r(n,function(n){t.indexOf(n)===-1&&t.push(n)}),t}t.__esModule=!0;t.to2dArray=e;t.extendArray=o;t.pivot=s;t.arrayReduce=i;t.arrayFilter=h;t.arrayMap=c;t.arrayEach=r;t.arraySum=u;t.arrayMax=l;t.arrayMin=a;t.arrayAvg=v;t.arrayFlatten=f;t.arrayUnique=y},function(n,t,i){"use strict";function s(n,t,i){return t in n?Object.defineProperty(n,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[t]=i,n}function e(n){var t;return Array.isArray(n)?t=[]:(t={},r(n,function(n,i){i!=="__children"&&(t[i]=n&&(typeof n=="undefined"?"undefined":u(n))==="object"&&!Array.isArray(n)?e(n):Array.isArray(n)?n.length&&u(n[0])==="object"&&!Array.isArray(n[0])?[e(n[0])]:[]:null)})),t}function l(n,t){return t.prototype.constructor=t,n.prototype=new t,n.prototype.constructor=n,n}function a(n,t){return r(t,function(t,i){n[i]=t}),n}function h(n,t){r(t,function(i,r){t[r]&&u(t[r])==="object"?(n[r]||(n[r]=Array.isArray(t[r])?[]:Object.prototype.toString.call(t[r])==="[object Date]"?t[r]:{}),h(n[r],t[r])):n[r]=t[r]})}function c(n){return(typeof n=="undefined"?"undefined":u(n))==="object"?JSON.parse(JSON.stringify(n)):n}function v(n){var t={};return r(n,function(n,i){t[i]=n}),t}function y(n){n.MIXINS||(n.MIXINS=[]);for(var i=arguments.length,u=Array(i>1?i-1:0),t=1;t<i;t++)u[t-1]=arguments[t];return o.arrayEach(u,function(t){n.MIXINS.push(t.MIXIN_NAME);r(t,function(t,i){if(n.prototype[i]!==void 0)throw new Error("Mixin conflict. Property '"+i+"' already exist and cannot be overwritten.");if(typeof t=="function")n.prototype[i]=t;else{var r=function(n,t){n="_"+n;var i=function(n){return(Array.isArray(n)||f(n))&&(n=c(n)),n};return function(){return this[n]===void 0&&(this[n]=i(t)),this[n]}},u=function(n){return n="_"+n,function(t){this[n]=t}};Object.defineProperty(n.prototype,i,{get:r(i,t),set:u(i),configurable:!0})}})}),n}function p(n,t){return JSON.stringify(n)===JSON.stringify(t)}function f(n){return Object.prototype.toString.call(n)=="[object Object]"}function w(n,t,i,r){r.value=i;r.writable=r.writable!==!1;r.enumerable=r.enumerable!==!1;r.configurable=r.configurable!==!1;Object.defineProperty(n,t,r)}function r(n,t){for(var i in n)if((!n.hasOwnProperty||n.hasOwnProperty&&Object.prototype.hasOwnProperty.call(n,i))&&t(n[i],i,n)===!1)break;return n}function b(n,t){var u=t.split("."),i=n;return r(u,function(n){return i=i[n],i===void 0?(i=void 0,!1):void 0}),i}function k(n){if(!f(n))return 0;var t=function t(n){var i=0;return f(n)?r(n,function(n){i+=t(n)}):i++,i};return t(n)}function d(n){var t,r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"value",i="_"+r,u=(t={_touched:!1},s(t,i,n),s(t,"isTouched",function(){return this._touched}),t);return Object.defineProperty(u,r,{get:function(){return this[i]},set:function(n){this._touched=!0;this[i]=n},enumerable:!0,configurable:!0}),u}function g(n,t){return Object.prototype.hasOwnProperty.call(n,t)}var u,o;t.__esModule=!0;u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n};t.duckSchema=e;t.inherit=l;t.extend=a;t.deepExtend=h;t.deepClone=c;t.clone=v;t.mixin=y;t.isObjectEqual=p;t.isObject=f;t.defineGetter=w;t.objectEach=r;t.getProperty=b;t.deepObjectSize=k;t.createObjectPropListener=d;t.hasOwnProperty=g;o=i(0)},function(n,t,i){"use strict";function ft(n){for(var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0,t=-1,i=null;n!=null;){if(t===r){i=n;break}n.host&&n.nodeType===Node.DOCUMENT_FRAGMENT_NODE?n=n.host:(t++,n=n.parentNode)}return i}function a(n,t,i){while(n!=null&&n!==i){if(n.nodeType===Node.ELEMENT_NODE&&(t.indexOf(n.nodeName)>-1||t.indexOf(n)>-1))return n;n=n.host&&n.nodeType===Node.DOCUMENT_FRAGMENT_NODE?n.host:n.parentNode}return null}function et(n,t,i){for(var r=[],u;n;){if(n=a(n,t,i),!n||i&&!i.contains(n))break;r.push(n);n=n.host&&n.nodeType===Node.DOCUMENT_FRAGMENT_NODE?n.host:n.parentNode}return u=r.length,u?r[u-1]:null}function ot(n,t){var i=n.parentNode,r=[];for(typeof t=="string"?r=Array.prototype.slice.call(document.querySelectorAll(t),0):r.push(t);i!=null;){if(r.indexOf(i)>-1)return!0;i=i.parentNode}return!1}function st(n){function r(n){return n.nodeType===Node.ELEMENT_NODE&&n.nodeName===u.toUpperCase()}for(var u="hot-table",i=!1,t=v(n);t!=null;){if(r(t)){i=!0;break}else if(t.host&&t.nodeType===Node.DOCUMENT_FRAGMENT_NODE){if(i=r(t.host),i)break;t=t.host}t=t.parentNode}return i}function v(n){return typeof Polymer!="undefined"&&typeof wrap=="function"?wrap(n):n}function y(n){return typeof Polymer!="undefined"&&typeof unwrap=="function"?unwrap(n):n}function ht(n){var t=0;if(n.previousSibling)while(n=n.previousSibling)++t;return t}function ct(n,t){var i=document.querySelector(".ht_clone_"+n);return i?i.contains(t):null}function w(n){var t=0,i=[];if(!n||!n.length)return i;while(n[t])i.push(n[t]),t++;return i}function lt(n,t){return e(n,t)}function at(n,t){return o(n,t)}function vt(n,t){return s(n,t)}function b(n,t){var r,i;if(n.nodeType===3)t.removeChild(n);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(n.nodeName)>-1)for(r=n.childNodes,i=r.length-1;i>=0;i--)b(r[i],n)}function k(n){for(var t;t=n.lastChild;)n.removeChild(t)}function yt(n,t){d.test(t)?n.innerHTML=t:nt(n,t)}function nt(n,t){var i=n.firstChild;i&&i.nodeType===3&&i.nextSibling===null?g?i.textContent=t:i.data=t:(k(n),n.appendChild(document.createTextNode(t)))}function c(n){for(var t=n;y(t)!==document.documentElement;){if(t===null)return!1;if(t.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(t.host){if(t.host.impl)return c(t.host.impl);if(t.host)return c(t.host);throw new Error("Lost in Web Components world");}else return!1;else if(t.style.display==="none")return!1;t=t.parentNode}return!0}function pt(n){var i,r,u,t,e;if(t=document.documentElement,f.hasCaptionProblem()&&n.firstChild&&n.firstChild.nodeName==="CAPTION")return e=n.getBoundingClientRect(),{top:e.top+(window.pageYOffset||t.scrollTop)-(t.clientTop||0),left:e.left+(window.pageXOffset||t.scrollLeft)-(t.clientLeft||0)};for(i=n.offsetLeft,r=n.offsetTop,u=n;n=n.offsetParent;){if(n===document.body)break;i+=n.offsetLeft;r+=n.offsetTop;u=n}return u&&u.style.position==="fixed"&&(i+=window.pageXOffset||t.scrollLeft,r+=window.pageYOffset||t.scrollTop),{left:i,top:r}}function tt(){var n=window.scrollY;return n===void 0&&(n=document.documentElement.scrollTop),n}function it(){var n=window.scrollX;return n===void 0&&(n=document.documentElement.scrollLeft),n}function wt(n){return n===window?tt():n.scrollTop}function bt(n){return n===window?it():n.scrollLeft}function kt(n){for(var t=n.parentNode,i=["auto","scroll"],r,e,o,u="",f="",s="",h="";t&&t.style&&document.body!==t;){if((r=t.style.overflow,e=t.style.overflowX,o=t.style.overflowY,r=="scroll"||e=="scroll"||o=="scroll")||window.getComputedStyle&&(u=window.getComputedStyle(t),f=u.getPropertyValue("overflow"),s=u.getPropertyValue("overflow-y"),h=u.getPropertyValue("overflow-x"),f==="scroll"||h==="scroll"||s==="scroll")||t.clientHeight<=t.scrollHeight+1&&(i.indexOf(o)!==-1||i.indexOf(r)!==-1||i.indexOf(f)!==-1||i.indexOf(s)!==-1)||t.clientWidth<=t.scrollWidth+1&&(i.indexOf(e)!==-1||i.indexOf(r)!==-1||i.indexOf(f)!==-1||i.indexOf(h)!==-1))return t;t=t.parentNode}return window}function dt(n){for(var t=n.parentNode,i;t&&t.style&&document.body!==t;){if(t.style.overflow!=="visible"&&t.style.overflow!==""||window.getComputedStyle&&(i=window.getComputedStyle(t),i.getPropertyValue("overflow")!=="visible"&&i.getPropertyValue("overflow")!==""))return t;t=t.parentNode}return window}function gt(n,t){if(n){if(n===window)return t==="width"?window.innerWidth+"px":t==="height"?window.innerHeight+"px":void 0}else return;var r=n.style[t],i;return r!==""&&r!==void 0?r:(i=rt(n),i[t]!==""&&i[t]!==void 0)?i[t]:void 0}function rt(n){return n.currentStyle||document.defaultView.getComputedStyle(n)}function ni(n){return n.offsetWidth}function ti(n){return f.hasCaptionProblem()&&n.firstChild&&n.firstChild.nodeName==="CAPTION"?n.offsetHeight+n.firstChild.offsetHeight:n.offsetHeight}function ii(n){return n.clientHeight||n.innerHeight}function ri(n){return n.clientWidth||n.innerWidth}function ui(n,t,i){window.addEventListener?n.addEventListener(t,i,!1):n.attachEvent("on"+t,i)}function fi(n,t,i){window.removeEventListener?n.removeEventListener(t,i,!1):n.detachEvent("on"+t,i)}function ei(n){var i,t,r;return n.selectionStart?n.selectionStart:document.selection?(n.focus(),i=document.selection.createRange(),i==null)?0:(t=n.createTextRange(),r=t.duplicate(),t.moveToBookmark(i.getBookmark()),r.setEndPoint("EndToStart",t),r.text.length):0}function oi(n){var t,i;return n.selectionEnd?n.selectionEnd:document.selection?(t=document.selection.createRange(),t==null)?0:(i=n.createTextRange(),i.text.indexOf(t.text)+t.text.length):0}function si(){var n="";return window.getSelection?n=window.getSelection().toString():document.selection&&document.selection.type!=="Control"&&(n=document.selection.createRange().text),n}function hi(n,t,i){var u,f,r;if(i===void 0&&(i=t),n.setSelectionRange){n.focus();try{n.setSelectionRange(t,i)}catch(e){u=n.parentNode;f=u.style.display;u.style.display="block";n.setSelectionRange(t,i);u.style.display=f}}else n.createTextRange&&(r=n.createTextRange(),r.collapse(!0),r.moveEnd("character",i),r.moveStart("character",t),r.select())}function ci(){var t=document.createElement("div"),n,r,i;return t.style.height="200px",t.style.width="100%",n=document.createElement("div"),n.style.boxSizing="content-box",n.style.height="150px",n.style.left="0px",n.style.overflow="hidden",n.style.position="absolute",n.style.top="0px",n.style.width="200px",n.style.visibility="hidden",n.appendChild(t),(document.body||document.documentElement).appendChild(n),r=t.offsetWidth,n.style.overflow="scroll",i=t.offsetWidth,r==i&&(i=n.clientWidth),(document.body||document.documentElement).removeChild(n),r-i}function li(){return l===void 0&&(l=ci()),l}function ai(n){return n.offsetWidth!==n.clientWidth}function vi(n){return n.offsetHeight!==n.clientHeight}function yi(n,t,i){r.isIE8()||r.isIE9()?(n.style.top=i,n.style.left=t):r.isSafari()?n.style["-webkit-transform"]="translate3d("+t+","+i+",0)":n.style.transform="translate3d("+t+","+i+",0)"}function pi(n){var t;return n.style.transform&&(t=n.style.transform)!==""?["transform",t]:n.style["-webkit-transform"]&&(t=n.style["-webkit-transform"])!==""?["-webkit-transform",t]:-1}function wi(n){n.style.transform&&n.style.transform!==""?n.style.transform="":n.style["-webkit-transform"]&&n.style["-webkit-transform"]!==""&&(n.style["-webkit-transform"]="")}function ut(n){return n&&(["INPUT","SELECT","TEXTAREA"].indexOf(n.nodeName)>-1||n.contentEditable==="true")}function bi(n){return ut(n)&&n.className.indexOf("handsontableInput")==-1&&n.className.indexOf("copyPaste")==-1}var r,f,p,e,o,s,h,u,d,g,l;t.__esModule=!0;t.HTML_CHARACTERS=undefined;t.getParent=ft;t.closest=a;t.closestDown=et;t.isChildOf=ot;t.isChildOfWebComponentTable=st;t.polymerWrap=v;t.polymerUnwrap=y;t.index=ht;t.overlayContainsElement=ct;t.hasClass=lt;t.addClass=at;t.removeClass=vt;t.removeTextNodes=b;t.empty=k;t.fastInnerHTML=yt;t.fastInnerText=nt;t.isVisible=c;t.offset=pt;t.getWindowScrollTop=tt;t.getWindowScrollLeft=it;t.getScrollTop=wt;t.getScrollLeft=bt;t.getScrollableElement=kt;t.getTrimmingContainer=dt;t.getStyle=gt;t.getComputedStyle=rt;t.outerWidth=ni;t.outerHeight=ti;t.innerHeight=ii;t.innerWidth=ri;t.addEvent=ui;t.removeEvent=fi;t.getCaretPosition=ei;t.getSelectionEndPosition=oi;t.getSelectionText=si;t.setCaretPosition=hi;t.getScrollbarWidth=li;t.hasVerticalScrollbar=ai;t.hasHorizontalScrollbar=vi;t.setOverlayPosition=yi;t.getCssTransform=pi;t.resetCssTransform=wi;t.isInput=ut;t.isOutsideInput=bi;r=i(33);f=i(43);p=!!document.documentElement.classList;p?(h=function(){var n=document.createElement("div");return n.classList.add("test","test2"),n.classList.contains("test2")}(),e=function(n,t){return n.classList===void 0||t===""?!1:n.classList.contains(t)},o=function(n,t){var i=0;if(typeof t=="string"&&(t=t.split(" ")),t=w(t),h)n.classList.add.apply(n.classList,t);else while(t&&t[i])n.classList.add(t[i]),i++},s=function(n,t){var i=0;if(typeof t=="string"&&(t=t.split(" ")),t=w(t),h)n.classList.remove.apply(n.classList,t);else while(t&&t[i])n.classList.remove(t[i]),i++}):(u=function(n){return new RegExp("(\\s|^)"+n+"(\\s|$)")},e=function(n,t){return n.className!==void 0&&u(t).test(n.className)},o=function(n,t){var r=0,i=n.className;if(typeof t=="string"&&(t=t.split(" ")),i==="")i=t.join(" ");else while(t&&t[r])u(t[r]).test(i)||(i+=" "+t[r]),r++;n.className=i},s=function(n,t){var r=0,i=n.className;for(typeof t=="string"&&(t=t.split(" "));t&&t[r];)i=i.replace(u(t[r])," ").trim(),r++;n.className!==i&&(n.className=i)});d=t.HTML_CHARACTERS=/(<(.*)>|&(.*);)/;g=!!document.createTextNode("test").textContent},function(n,t){"use strict";t.__esModule=!0;var i=t.CONTEXT_MENU_ITEMS_NAMESPACE="ContextMenu:items",f=t.CONTEXTMENU_ITEMS_ROW_ABOVE=i+".insertRowAbove",e=t.CONTEXTMENU_ITEMS_ROW_BELOW=i+".insertRowBelow",o=t.CONTEXTMENU_ITEMS_INSERT_LEFT=i+".insertColumnOnTheLeft",s=t.CONTEXTMENU_ITEMS_INSERT_RIGHT=i+".insertColumnOnTheRight",h=t.CONTEXTMENU_ITEMS_REMOVE_ROW=i+".removeRow",c=t.CONTEXTMENU_ITEMS_REMOVE_COLUMN=i+".removeColumn",l=t.CONTEXTMENU_ITEMS_UNDO=i+".undo",a=t.CONTEXTMENU_ITEMS_REDO=i+".redo",v=t.CONTEXTMENU_ITEMS_READ_ONLY=i+".readOnly",y=t.CONTEXTMENU_ITEMS_CLEAR_COLUMN=i+".clearColumn",p=t.CONTEXTMENU_ITEMS_COPY=i+".copy",w=t.CONTEXTMENU_ITEMS_CUT=i+".cut",b=t.CONTEXTMENU_ITEMS_FREEZE_COLUMN=i+".freezeColumn",k=t.CONTEXTMENU_ITEMS_UNFREEZE_COLUMN=i+".unfreezeColumn",d=t.CONTEXTMENU_ITEMS_MERGE_CELLS=i+".mergeCells",g=t.CONTEXTMENU_ITEMS_UNMERGE_CELLS=i+".unmergeCells",nt=t.CONTEXTMENU_ITEMS_ADD_COMMENT=i+".addComment",tt=t.CONTEXTMENU_ITEMS_EDIT_COMMENT=i+".editComment",it=t.CONTEXTMENU_ITEMS_REMOVE_COMMENT=i+".removeComment",rt=t.CONTEXTMENU_ITEMS_READ_ONLY_COMMENT=i+".readOnlyComment",ut=t.CONTEXTMENU_ITEMS_ALIGNMENT=i+".align",ft=t.CONTEXTMENU_ITEMS_ALIGNMENT_LEFT=i+".align.left",et=t.CONTEXTMENU_ITEMS_ALIGNMENT_CENTER=i+".align.center",ot=t.CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT=i+".align.right",st=t.CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY=i+".align.justify",ht=t.CONTEXTMENU_ITEMS_ALIGNMENT_TOP=i+".align.top",ct=t.CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE=i+".align.middle",lt=t.CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM=i+".align.bottom",at=t.CONTEXTMENU_ITEMS_BORDERS=i+".borders",vt=t.CONTEXTMENU_ITEMS_BORDERS_TOP=i+".borders.top",yt=t.CONTEXTMENU_ITEMS_BORDERS_RIGHT=i+".borders.right",pt=t.CONTEXTMENU_ITEMS_BORDERS_BOTTOM=i+".borders.bottom",wt=t.CONTEXTMENU_ITEMS_BORDERS_LEFT=i+".borders.left",bt=t.CONTEXTMENU_ITEMS_REMOVE_BORDERS=i+".borders.remove",kt=t.CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD=i+".nestedHeaders.insertChildRow",dt=t.CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD=i+".nestedHeaders.detachFromParent",gt=t.CONTEXTMENU_ITEMS_HIDE_COLUMN=i+".hideColumn",ni=t.CONTEXTMENU_ITEMS_SHOW_COLUMN=i+".showColumn",ti=t.CONTEXTMENU_ITEMS_HIDE_ROW=i+".hideRow",ii=t.CONTEXTMENU_ITEMS_SHOW_ROW=i+".showRow",u=t.FILTERS_NAMESPACE="Filters:",r=t.FILTERS_CONDITIONS_NAMESPACE=u+"conditions",ri=t.FILTERS_CONDITIONS_NONE=r+".none",ui=t.FILTERS_CONDITIONS_EMPTY=r+".isEmpty",fi=t.FILTERS_CONDITIONS_NOT_EMPTY=r+".isNotEmpty",ei=t.FILTERS_CONDITIONS_EQUAL=r+".isEqualTo",oi=t.FILTERS_CONDITIONS_NOT_EQUAL=r+".isNotEqualTo",si=t.FILTERS_CONDITIONS_BEGINS_WITH=r+".beginsWith",hi=t.FILTERS_CONDITIONS_ENDS_WITH=r+".endsWith",ci=t.FILTERS_CONDITIONS_CONTAINS=r+".contains",li=t.FILTERS_CONDITIONS_NOT_CONTAIN=r+".doesNotContain",ai=t.FILTERS_CONDITIONS_BY_VALUE=r+".byValue",vi=t.FILTERS_CONDITIONS_GREATER_THAN=r+".greaterThan",yi=t.FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL=r+".greaterThanOrEqualTo",pi=t.FILTERS_CONDITIONS_LESS_THAN=r+".lessThan",wi=t.FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL=r+".lessThanOrEqualTo",bi=t.FILTERS_CONDITIONS_BETWEEN=r+".isBetween",ki=t.FILTERS_CONDITIONS_NOT_BETWEEN=r+".isNotBetween",di=t.FILTERS_CONDITIONS_AFTER=r+".after",gi=t.FILTERS_CONDITIONS_BEFORE=r+".before",nr=t.FILTERS_CONDITIONS_TODAY=r+".today",tr=t.FILTERS_CONDITIONS_TOMORROW=r+".tomorrow",ir=t.FILTERS_CONDITIONS_YESTERDAY=r+".yesterday",rr=t.FILTERS_DIVS_FILTER_BY_CONDITION=u+"labels.filterByCondition",ur=t.FILTERS_DIVS_FILTER_BY_VALUE=u+"labels.filterByValue",fr=t.FILTERS_LABELS_CONJUNCTION=u+"labels.conjunction",er=t.FILTERS_LABELS_DISJUNCTION=u+"labels.disjunction",or=t.FILTERS_VALUES_BLANK_CELLS=u+"values.blankCells",sr=t.FILTERS_BUTTONS_SELECT_ALL=u+"buttons.selectAll",hr=t.FILTERS_BUTTONS_CLEAR=u+"buttons.clear",cr=t.FILTERS_BUTTONS_OK=u+"buttons.ok",lr=t.FILTERS_BUTTONS_CANCEL=u+"buttons.cancel",ar=t.FILTERS_BUTTONS_PLACEHOLDER_SEARCH=u+"buttons.placeholder.search",vr=t.FILTERS_BUTTONS_PLACEHOLDER_VALUE=u+"buttons.placeholder.value",yr=t.FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE=u+"buttons.placeholder.secondValue"},function(n,t){"use strict";function r(n){var t=typeof n=="undefined"?"undefined":i(n);return t=="number"?!isNaN(n)&&isFinite(n):t=="string"?n.length?n.length==1?/\d/.test(n):/^\s*[+-]?\s*(?:(?:\d+(?:\.\d+)?(?:e[+-]?\d+)?)|(?:0x[a-f\d]+))\s*$/i.test(n):!1:t=="object"?!!n&&typeof n.valueOf()=="number"&&!(n instanceof Date):!1}function u(n,t,i){var r=-1;for(typeof t=="function"?(i=t,t=n):r=n-1;++r<=t;)if(i(r)===!1)break}function f(n,t,i){var r=n+1;for(typeof t=="function"&&(i=t,t=0);--r>=t;)if(i(r)===!1)break}function e(n,t){return t=parseInt(t.toString().replace("%",""),10),parseInt(n*t/100,10)}t.__esModule=!0;var i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n};t.isNumeric=r;t.rangeEach=u;t.rangeEachReverse=f;t.valueAccordingPercent=e},function(n,t,i){var u=i(17),f=i(50),s=i(39),h=i(38),o=i(40),e="prototype",r=function(n,t,i){var d=n&r.F,y=n&r.G,g=n&r.S,w=n&r.P,nt=n&r.B,a=y?u:g?u[t]||(u[t]={}):(u[t]||{})[e],v=y?f:f[t]||(f[t]={}),b=v[e]||(v[e]={}),l,p,c,k;y&&(i=t);for(l in i)p=!d&&a&&a[l]!==undefined,c=(p?a:i)[l],k=nt&&p?o(c,u):w&&typeof c=="function"?o(Function.call,c):c,a&&h(a,l,c,n&r.U),v[l]!=c&&s(v,l,k),w&&b[l]!=c&&(b[l]=c)};u.core=f;r.F=1;r.G=2;r.S=4;r.P=8;r.B=16;r.W=32;r.U=64;r.R=128;n.exports=r},function(n,t,i){"use strict";function s(n){return n&&n.__esModule?n:{"default":n}}function h(n,t){n=e.toUpperCaseFirst(n);u.default.getSingleton().add("construct",function(){var i=void 0;r.has(this)||r.set(this,{});i=r.get(this);i[n]||(i[n]=new t(this))});u.default.getSingleton().add("afterDestroy",function(){if(r.has(this)){var n=r.get(this);f.objectEach(n,function(n){return n.destroy()});r.delete(this)}})}function c(n,t){if(typeof t!="string")throw Error('Only strings can be passed as "plugin" parameter');var i=e.toUpperCaseFirst(t);if(r.has(n)&&r.get(n)[i])return r.get(n)[i]}function l(n){return r.has(n)?Object.keys(r.get(n)):[]}function a(n,t){var i=null;return r.has(n)&&f.objectEach(r.get(n),function(n,r){n===t&&(i=r)}),i}var r;t.__esModule=!0;t.getPluginName=t.getRegistredPluginNames=t.getPlugin=t.registerPlugin=undefined;var o=i(14),u=s(o),f=i(1),e=i(30);r=new WeakMap;t.registerPlugin=h;t.getPlugin=c;t.getRegistredPluginNames=l;t.getPluginName=a},function(n,t,i){"use strict";function c(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}t.__esModule=!0;var s=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),f=i(1),e=i(0),h=i(53),o=i(6);var r=new WeakMap,u=null,l=function(){function n(t){var i=this;c(this,n);f.defineGetter(this,"hot",t,{writable:!1});f.defineGetter(this,"t",h.getTranslator(t),{writable:!1});r.set(this,{hooks:{}});u=null;this.pluginName=null;this.pluginsInitializedCallbacks=[];this.isPluginsReady=!1;this.enabled=!1;this.initialized=!1;this.hot.addHook("afterPluginsInitialized",function(){return i.onAfterPluginsInitialized()});this.hot.addHook("afterUpdateSettings",function(){return i.onUpdateSettings()});this.hot.addHook("beforeInit",function(){return i.init()})}return s(n,[{key:"init",value:function(){this.pluginName=o.getPluginName(this.hot,this);this.isEnabled&&this.isEnabled()&&this.enablePlugin();u||(u=o.getRegistredPluginNames(this.hot));u.indexOf(this.pluginName)>=0&&u.splice(u.indexOf(this.pluginName),1);u.length||this.hot.runHooks("afterPluginsInitialized");this.initialized=!0}},{key:"enablePlugin",value:function(){this.enabled=!0}},{key:"disablePlugin",value:function(){this.eventManager&&this.eventManager.clear();this.clearHooks();this.enabled=!1}},{key:"addHook",value:function(n,t){r.get(this).hooks[n]=r.get(this).hooks[n]||[];var i=r.get(this).hooks[n];this.hot.addHook(n,t);i.push(t);r.get(this).hooks[n]=i}},{key:"removeHooks",value:function(n){var t=this;e.arrayEach(r.get(this).hooks[n]||[],function(i){t.hot.removeHook(n,i)})}},{key:"clearHooks",value:function(){var t=this,n=r.get(this).hooks;f.objectEach(n,function(n,i){return t.removeHooks(i)});n.length=0}},{key:"callOnPluginsReady",value:function(n){this.isPluginsReady?n():this.pluginsInitializedCallbacks.push(n)}},{key:"onAfterPluginsInitialized",value:function(){e.arrayEach(this.pluginsInitializedCallbacks,function(n){return n()});this.pluginsInitializedCallbacks.length=0;this.isPluginsReady=!0}},{key:"onUpdateSettings",value:function(){this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&this.updatePlugin())}},{key:"updatePlugin",value:function(){}},{key:"destroy",value:function(){var n=this;this.eventManager&&this.eventManager.destroy();this.clearHooks();f.objectEach(this,function(t,i){i!=="hot"&&i!=="t"&&(n[i]=null)});delete this.t;delete this.hot}}]),n}();t.default=l},function(n,t,i){"use strict";function r(n){return n&&n.__esModule?n:{"default":n}}t.__esModule=!0;t.Viewport=t.TableRenderer=t.Table=t.Settings=t.Selection=t.Scroll=t.Overlays=t.Event=t.Core=t.default=t.Border=t.TopLeftCornerOverlay=t.TopOverlay=t.LeftOverlay=t.DebugOverlay=t.RowFilter=t.ColumnFilter=t.CellRange=t.CellCoords=t.ViewportRowsCalculator=t.ViewportColumnsCalculator=undefined;i(84);i(93);i(94);i(95);i(96);i(98);i(100);i(101);i(102);i(103);i(104);i(105);i(106);i(107);i(108);i(109);i(110);i(111);i(112);i(113);i(114);i(115);i(116);i(117);i(118);i(121);i(122);i(123);i(124);i(125);i(126);i(127);i(128);i(130);i(131);i(132);i(133);i(134);i(80);i(135);i(136);i(137);i(138);i(139);i(140);i(141);i(142);i(143);i(144);i(145);i(146);i(147);i(148);i(149);var f=i(189),e=r(f),o=i(190),s=r(o),h=i(61),c=r(h),l=i(150),a=r(l),v=i(191),y=r(v),p=i(192),w=r(p),b=i(256),k=r(b),d=i(257),g=r(d),nt=i(258),tt=r(nt),it=i(259),rt=r(it),ut=i(201),ft=r(ut),et=i(193),u=r(et),ot=i(194),st=r(ot),ht=i(195),ct=r(ht),lt=i(196),at=r(lt),vt=i(260),yt=r(vt),pt=i(197),wt=r(pt),bt=i(198),kt=r(bt),dt=i(199),gt=r(dt),ni=i(200),ti=r(ni);t.ViewportColumnsCalculator=e.default;t.ViewportRowsCalculator=s.default;t.CellCoords=c.default;t.CellRange=a.default;t.ColumnFilter=y.default;t.RowFilter=w.default;t.DebugOverlay=k.default;t.LeftOverlay=g.default;t.TopOverlay=tt.default;t.TopLeftCornerOverlay=rt.default;t.Border=ft.default;t.default=u.default;t.Core=u.default;t.Event=st.default;t.Overlays=ct.default;t.Scroll=at.default;t.Selection=yt.default;t.Settings=wt.default;t.Table=kt.default;t.TableRenderer=gt.default;t.Viewport=ti.default},function(n,t,i){"use strict";function c(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function l(n,t){var c="HOT-TABLE",l=void 0,e=void 0,a=void 0,r=void 0,i=void 0,v=void 0;if(t.isTargetWebComponent=!1,t.realTarget=t.target,v=t.stopImmediatePropagation,t.stopImmediatePropagation=function(){v.apply(this);h.stopImmediatePropagation(this)},!f.isHotTableEnv)return t;for(t=u.polymerWrap(t),i=t.path?t.path.length:0;i--;){if(t.path[i].nodeName===c)l=!0;else if(l&&t.path[i].shadowRoot){r=t.path[i];break}i!==0||r||(r=t.path[i])}return r||(r=t.target),t.isTargetWebComponent=!0,s.isWebComponentSupportedNatively()?t.realTarget=t.srcElement||t.toElement:(o.hasOwnProperty(n,"hot")||n.isHotTableEnv||n.wtTable)&&(o.hasOwnProperty(n,"hot")?e=n.hot?n.hot.view.wt.wtTable.TABLE:null:n.isHotTableEnv?e=n.view.activeWt.wtTable.TABLE.parentNode.parentNode:n.wtTable&&(e=n.wtTable.TABLE.parentNode.parentNode),a=u.closest(t.target,[c],e),t.realTarget=a?e.querySelector(c)||t.target:t.target),Object.defineProperty(t,"target",{get:function(){return u.polymerWrap(r)},enumerable:!0,configurable:!0}),t}function a(){return r}var e,r,f;t.__esModule=!0;e=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}();t.getListenersCounter=a;var u=i(2),o=i(1),s=i(43),h=i(11);r=0;f=function(){function n(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;c(this,n);this.context=t||this;this.context.eventListeners||(this.context.eventListeners=[])}return e(n,[{key:"addEventListener",value:function(n,t,i){function u(n){n=l(e,n);i.call(this,n)}var f=this,e=this.context;return this.context.eventListeners.push({element:n,event:t,callback:i,callbackProxy:u}),window.addEventListener?n.addEventListener(t,u,!1):n.attachEvent("on"+t,u),r++,function(){f.removeEventListener(n,t,i)}}},{key:"removeEventListener",value:function(n,t,i){for(var f=this.context.eventListeners.length,u=void 0;f--;)if(u=this.context.eventListeners[f],u.event==t&&u.element==n){if(i&&i!=u.callback)continue;this.context.eventListeners.splice(f,1);u.element.removeEventListener?u.element.removeEventListener(u.event,u.callbackProxy,!1):u.element.detachEvent("on"+u.event,u.callbackProxy);r--}}},{key:"clearEvents",value:function(){var t,n;if(this.context)for(t=this.context.eventListeners.length;t--;)n=this.context.eventListeners[t],n&&this.removeEventListener(n.element,n.event,n.callback)}},{key:"clear",value:function(){this.clearEvents()}},{key:"destroy",value:function(){this.clearEvents();this.context=null}},{key:"fireEvent",value:function(n,t){var i={bubbles:!0,cancelable:t!=="mousemove",view:window,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:undefined},r;document.createEvent?(r=document.createEvent("MouseEvents"),r.initMouseEvent(t,i.bubbles,i.cancelable,i.view,i.detail,i.screenX,i.screenY,i.clientX,i.clientY,i.ctrlKey,i.altKey,i.shiftKey,i.metaKey,i.button,i.relatedTarget||document.body.parentNode)):r=document.createEventObject();n.dispatchEvent?n.dispatchEvent(r):n.fireEvent("on"+t,r)}}]),n}();t.default=f},function(n,t){"use strict";function r(n,t){if(!i[n])throw Error('Filter condition "'+n+'" does not exist.');var r=i[n],f=r.condition,u=r.descriptor;return u.inputValuesDecorator&&(t=u.inputValuesDecorator(t)),function(n){return f.apply(n.meta.instance,[].concat([n],[t]))}}function u(n){if(!i[n])throw Error('Filter condition "'+n+'" does not exist.');return i[n].descriptor}function f(n,t,r){r.key=n;i[n]={condition:t,descriptor:r}}t.__esModule=!0;t.getCondition=r;t.getConditionDescriptor=u;t.registerCondition=f;var i=t.conditions={}},function(n,t,i){"use strict";function u(n){n.isImmediatePropagationEnabled=!1;n.cancelBubble=!0}function f(n){return n.isImmediatePropagationEnabled===!1}function e(n){typeof n.stopPropagation=="function"?n.stopPropagation():n.cancelBubble=!0}function o(n){return n.pageX?n.pageX:n.clientX+r.getWindowScrollLeft()}function s(n){return n.pageY?n.pageY:n.clientY+r.getWindowScrollTop()}function h(n){return n.button===2}function c(n){return n.button===0}t.__esModule=!0;t.stopImmediatePropagation=u;t.isImmediatePropagationStopped=f;t.stopPropagation=e;t.pageX=o;t.pageY=s;t.isRightClick=h;t.isLeftClick=c;var r=i(2)},function(n){n.exports=function(n){return typeof n=="object"?n!==null:typeof n=="function"}},function(n,t,i){"use strict";function v(n){return n&&n.__esModule?n:{"default":n}}function y(n,t){return Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(t)}}))}function p(n){var t=void 0;switch(typeof n=="undefined"?"undefined":o(n)){case"string":case"number":t=""+n;break;case"object":t=n===null?"":n.toString();break;case"undefined":t="";break;default:t=n.toString()}return t}function w(n){return typeof n!="undefined"}function s(n){return typeof n=="undefined"}function b(n){return n===null||n===""||s(n)}function k(n){return Object.prototype.toString.call(n)==="[object RegExp]"}function d(){}var o,l;t.__esModule=!0;o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n};l=y(["\n          Your license key of Handsontable Pro has expired.‌‌‌‌ \n          Renew your maintenance plan at https://handsontable.com or downgrade to the previous version of the software.\n          "],["\n          Your license key of Handsontable Pro has expired.‌‌‌‌\\x20\n          Renew your maintenance plan at https://handsontable.com or downgrade to the previous version of the software.\n          "]);t.stringify=p;t.isDefined=w;t.isUndefined=s;t.isEmpty=b;t.isRegExp=k;t._injectProductInfo=d;var a=i(31),g=v(a),nt=i(34);var r="length",u=function(n){return parseInt(n,16)},h=function(n){return parseInt(n,10)},e=function(n,t,i){return n.substr(t,i)},f=function(n){return n.codePointAt(0)-65},c=function(n){return(""+n).replace(/\-/g,"")},tt=function(n){return u(e(c(n),u("12"),f("F")))/(u(e(c(n),f("B"),~~![][r]))||9)},it=function(){return typeof location!="undefined"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host)}},function(n,t,i){"use strict";function s(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}t.__esModule=!0;var f=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),u=i(0),o=i(1);var r=["afterCellMetaReset","afterChange","afterChangesObserved","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","afterRender","beforeRenderer","afterRenderer","afterScrollHorizontally","afterScrollVertically","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeRender","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyCol","unmodifyCol","unmodifyRow","modifyColHeader","modifyColWidth","modifyRow","modifyRowHeader","modifyRowHeight","modifyData","modifyRowData","modifyGetCellCoords","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnMove","afterColumnMove","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","modifyColumnHeaderHeight","beforeUndo","afterUndo","beforeRedo","afterRedo","modifyRowHeaderWidth","beforeAutofillInsidePopulate","modifyTransformStart","modifyTransformEnd","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","manualRowHeights","skipLengthCache","afterTrimRow","afterUntrimRow","afterDropdownMenuShow","afterDropdownMenuHide","hiddenRow","hiddenColumn","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten"],e=function(){function n(){s(this,n);this.globalBucket=this.createEmptyBucket()}return f(n,null,[{key:"getSingleton",value:function(){return h}}]),f(n,[{key:"createEmptyBucket",value:function(){var n=Object.create(null);return u.arrayEach(r,function(t){return n[t]=[]}),n}},{key:"getBucket",value:function(){var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;return n?(n.pluginHookBucket||(n.pluginHookBucket=this.createEmptyBucket()),n.pluginHookBucket):this.globalBucket}},{key:"add",value:function(n,t){var e=this,f=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null,i,r;return Array.isArray(t)?u.arrayEach(t,function(t){return e.add(n,t,f)}):(i=this.getBucket(f),typeof i[n]=="undefined"&&(this.register(n),i[n]=[]),t.skip=!1,i[n].indexOf(t)===-1&&(r=!1,t.initialHook&&u.arrayEach(i[n],function(u,f){if(u.initialHook)return i[n][f]=t,r=!0,!1}),r||i[n].push(t))),this}},{key:"once",value:function(n,t){var r=this,i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;Array.isArray(t)?u.arrayEach(t,function(t){return r.once(n,t,i)}):(t.runOnce=!0,this.add(n,t,i))}},{key:"remove",value:function(n,t){var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null,i=this.getBucket(r);return typeof i[n]!="undefined"&&i[n].indexOf(t)>=0?(t.skip=!0,!0):!1}},{key:"has",value:function(n){var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null,t=this.getBucket(i);return!!(t[n]!==void 0&&t[n].length)}},{key:"run",value:function(n,t,i,r,u,f,e,o){var s=this.globalBucket[t],c=-1,y=s?s.length:0,a,v;if(y)while(++c<y)s[c]&&!s[c].skip&&(a=s[c].call(n,i,r,u,f,e,o),a!==void 0&&(i=a),s[c]&&s[c].runOnce&&this.remove(t,s[c]));var h=this.getBucket(n)[t],l=-1,p=h?h.length:0;if(p)while(++l<p)h[l]&&!h[l].skip&&(v=h[l].call(n,i,r,u,f,e,o),v!==void 0&&(i=v),h[l]&&h[l].runOnce&&this.remove(t,h[l],n));return i}},{key:"destroy",value:function(){var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;o.objectEach(this.getBucket(n),function(n,t,i){return i[t].length=0})}},{key:"register",value:function(n){this.isRegistered(n)||r.push(n)}},{key:"deregister",value:function(n){this.isRegistered(n)&&r.splice(r.indexOf(n),1)}},{key:"isRegistered",value:function(n){return r.indexOf(n)>=0}},{key:"getRegistered",value:function(){return r}}]),n}(),h=new e;t.default=e},function(n,t,i){"use strict";function r(n){return n&&n.__esModule?n:{"default":n}}function ft(n){if(typeof n=="function")return n;if(!e(n))throw Error('No registered renderer found under "'+n+'" name');return it(n)}t.__esModule=!0;t.getRegisteredRenderers=t.getRegisteredRendererNames=t.hasRenderer=t.getRenderer=t.registerRenderer=undefined;var o=i(48),s=r(o),h=i(270),c=r(h),l=i(271),a=r(l),v=i(272),y=r(v),p=i(273),w=r(p),b=i(274),k=r(b),d=i(276),g=r(d),nt=i(277),tt=r(nt);var f=s.default("renderers"),u=f.register,it=f.getItem,e=f.hasItem,rt=f.getNames,ut=f.getValues;u("base",c.default);u("autocomplete",a.default);u("checkbox",y.default);u("html",w.default);u("numeric",k.default);u("password",g.default);u("text",tt.default);t.registerRenderer=u;t.getRenderer=ft;t.hasRenderer=e;t.getRegisteredRendererNames=rt;t.getRegisteredRenderers=ut},function(n,t,i){var r=i(90)("wks"),e=i(55),u=i(17).Symbol,f=typeof u=="function",o=n.exports=function(n){return r[n]||(r[n]=f&&u[n]||(f?u:e)("Symbol."+n))};o.store=r},function(n){var t=n.exports=typeof window!="undefined"&&window.Math==Math?window:typeof self!="undefined"&&self.Math==Math?self:Function("return this")();typeof __g=="number"&&(__g=t)},function(n,t,i){"use strict";function f(n){return n==32||n>=48&&n<=57||n>=96&&n<=111||n>=186&&n<=192||n>=219&&n<=222||n>=226||n>=65&&n<=90}function e(n){var t=[r.ARROW_DOWN,r.ARROW_UP,r.ARROW_LEFT,r.ARROW_RIGHT,r.HOME,r.END,r.DELETE,r.BACKSPACE,r.F1,r.F2,r.F3,r.F4,r.F5,r.F6,r.F7,r.F8,r.F9,r.F10,r.F11,r.F12,r.TAB,r.PAGE_DOWN,r.PAGE_UP,r.ENTER,r.ESCAPE,r.SHIFT,r.CAPS_LOCK,r.ALT];return t.indexOf(n)!==-1}function o(n){var t=[];return window.navigator.platform.includes("Mac")?t.push(r.COMMAND_LEFT,r.COMMAND_RIGHT,r.COMMAND_FIREFOX):t.push(r.CONTROL),t.includes(n)}function s(n){return[r.CONTROL,r.COMMAND_LEFT,r.COMMAND_RIGHT,r.COMMAND_FIREFOX].includes(n)}function h(n,t){var f=t.split("|"),i=!1;return u.arrayEach(f,function(t){if(n===r[t])return i=!0,!1}),i}t.__esModule=!0;t.KEY_CODES=undefined;t.isPrintableChar=f;t.isMetaKey=e;t.isCtrlKey=o;t.isCtrlMetaKey=s;t.isKey=h;var u=i(0),r=t.KEY_CODES={MOUSE_LEFT:1,MOUSE_RIGHT:3,MOUSE_MIDDLE:2,BACKSPACE:8,COMMA:188,INSERT:45,DELETE:46,END:35,ENTER:13,ESCAPE:27,CONTROL:17,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,ALT:18,HOME:36,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,SPACE:32,SHIFT:16,CAPS_LOCK:20,TAB:9,ARROW_RIGHT:39,ARROW_LEFT:37,ARROW_UP:38,ARROW_DOWN:40,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,A:65,X:88,C:67,V:86}},function(n,t,i){"use strict";function r(n){return n&&n.__esModule?n:{"default":n}}function h(n){var t={},i=n;this.getConstructor=function(){return n};this.getInstance=function(n){return n.guid in t||(t[n.guid]=new i(n)),t[n.guid]};y.default.getSingleton().add("afterDestroy",function(){t={}})}function c(n,t){var i=void 0;if(typeof n=="function")e.get(n)||u(null,n),i=e.get(n);else if(typeof n=="string")i=o(n);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!i)throw Error('No editor registered under name "'+n+'"');return i.getInstance(t)}function bt(n){if(!s(n))throw Error('No registered editor found under "'+n+'" name');return o(n).getConstructor()}function u(n,t){var i=new h(t);typeof n=="string"&&yt(n,i);e.set(t,i)}t.__esModule=!0;t.getRegisteredEditors=t.getRegisteredEditorNames=t.hasEditor=t.getEditorInstance=t.getEditor=t.registerEditor=undefined;t.RegisteredEditor=h;t._getEditorInstance=c;var l=i(48),a=r(l),v=i(14),y=r(v),p=i(60),w=r(p),b=i(202),k=r(b),d=i(262),g=r(d),nt=i(263),tt=r(nt),it=i(266),rt=r(it),ut=i(203),ft=r(ut),et=i(267),ot=r(et),st=i(268),ht=r(st),ct=i(269),lt=r(ct),at=i(62),vt=r(at);var e=new WeakMap,f=a.default("editors"),yt=f.register,o=f.getItem,s=f.hasItem,pt=f.getNames,wt=f.getValues;u("base",w.default);u("autocomplete",k.default);u("checkbox",g.default);u("date",tt.default);u("dropdown",rt.default);u("handsontable",ft.default);u("numeric",ot.default);u("password",ht.default);u("select",lt.default);u("text",vt.default);t.registerEditor=u;t.getEditor=bt;t.getEditorInstance=c;t.hasEditor=s;t.getRegisteredEditorNames=pt;t.getRegisteredEditors=wt},function(n,t,i){var r=i(12);n.exports=function(n){if(!r(n))throw TypeError(n+" is not an object!");return n}},function(n,t,i){"use strict";t.__esModule=!0;var u=i(0),f=i(1),r={_localHooks:Object.create(null),addLocalHook:function(n,t){this._localHooks[n]||(this._localHooks[n]=[]);this._localHooks[n].push(t)},runLocalHooks:function(n){for(var f=this,i=arguments.length,r=Array(i>1?i-1:0),t=1;t<i;t++)r[t-1]=arguments[t];this._localHooks[n]&&u.arrayEach(this._localHooks[n],function(n){return n.apply(f,r)})},clearLocalHooks:function(){this._localHooks={}}};f.defineGetter(r,"MIXIN_NAME","localHooks",{writable:!1,enumerable:!1});t.default=r},function(n,t,i){var r=i(20),u=i(164),f=i(86),e=Object.defineProperty;t.f=i(24)?Object.defineProperty:function(n,t,i){if(r(n),t=f(t,!0),r(i),u)try{return e(n,t,i)}catch(o){}if("get"in i||"set"in i)throw TypeError("Accessors not supported!");return"value"in i&&(n[t]=i.value),n}},function(n,t,i){"use strict";function c(n){return r.arrayMap(n,function(n){return{start:n.getTopLeftCorner(),end:n.getBottomRightCorner()}})}function l(n){return u.hasClass(n,"htSeparator")}function a(n){return u.hasClass(n,"htSubmenu")}function v(n){return u.hasClass(n,"htDisabled")}function y(n){return u.hasClass(n,"htSelectionDisabled")}function p(n){var t=n.getSelected();return t?t[0]<0?null:t:null}function f(n,t){return n.indexOf(t)!=-1?n:(n=n.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ",""),n+(" "+t))}function e(n,t){return n.indexOf(t)!=-1?n:(n=n.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ",""),n+(" "+t))}function w(n,t){var i={};return r.arrayEach(n,function(n){for(var u,f=n.from,e=n.to,r=f.row;r<=e.row;r++)for(u=f.col;u<=e.col;u++)i[r]||(i[r]=[]),i[r][u]=t(r,u)}),i}function b(n,t,i,u,f){r.arrayEach(n,function(n){var r=n.from,e=n.to,s,h;if(r.row==e.row&&r.col==e.col)o(r.row,r.col,t,i,u,f);else for(s=r.row;s<=e.row;s++)for(h=r.col;h<=e.col;h++)o(s,h,t,i,u,f)})}function o(n,t,i,r,u,o){var s=u(n,t),h=r;s.className&&(h=i==="vertical"?f(s.className,r):e(s.className,r));o(n,t,"className",h)}function k(n,t){var i=!1;return Array.isArray(n)&&r.arrayEach(n,function(n){return n.forAll(function(n,r){if(t(n,r))return i=!0,!1}),i}),i}function d(n){return'<span class="selected">'+String.fromCharCode(10003)+"<\/span>"+n}function g(n,t){return!n.hidden||!(typeof n.hidden=="function"&&n.hidden.call(t))}function s(n,t){for(var i=n.slice(0),r=0;r<i.length;)if(i[r].name===t)i.shift();else break;return i}function nt(n,t){var i=n.slice(0);return i.reverse(),i=s(i,t),i.reverse(),i}function tt(n){var t=[];return r.arrayEach(n,function(n,i){i>0?t[t.length-1].name!==n.name&&t.push(n):t.push(n)}),t}function it(n){var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:h.KEY,t=n.slice(0);return t=s(t,i),t=nt(t,i),tt(t)}t.__esModule=!0;t.normalizeSelection=c;t.isSeparator=l;t.hasSubMenu=a;t.isDisabled=v;t.isSelectionDisabled=y;t.getValidSelection=p;t.prepareVerticalAlignClass=f;t.prepareHorizontalAlignClass=e;t.getAlignmentClasses=w;t.align=b;t.checkSelectionConsistency=k;t.markLabelAsSelected=d;t.isItemHidden=g;t.filterSeparators=it;var r=i(0),rt=i(4),u=i(2),h=i(156)},function(n,t,i){n.exports=!i(25)(function(){return Object.defineProperty({},"a",{get:function(){return 7}}).a!=7})},function(n){n.exports=function(n){try{return!!n()}catch(t){return!0}}},function(n,t,i){var r=i(88),u=i(47);n.exports=function(n){return r(u(n))}},function(n,t,i){var r=i(68),u=Math.min;n.exports=function(n){return n>0?u(r(n),9007199254740991):0}},function(n,t,i){var r=i(5),u=i(50),f=i(25);n.exports=function(n,t){var i=(u.Object||{})[n]||Object[n],e={};e[n]=t(i);r(r.S+r.F*f(function(){i(1)}),"Object",e)}},function(n,t,i){"use strict";function e(n){return n&&n.__esModule?n:{"default":n}}function y(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var r,o;t.__esModule=!0;var f=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),u=i(2),s=i(1),h=i(0),c=i(9),l=e(c),a=i(193),v=e(a);r={};o=function(){function n(t){y(this,n);s.defineGetter(this,"wot",t,{writable:!1});this.instance=this.wot;this.type="";this.mainTableScrollableElement=null;this.TABLE=this.wot.wtTable.TABLE;this.hider=this.wot.wtTable.hider;this.spreader=this.wot.wtTable.spreader;this.holder=this.wot.wtTable.holder;this.wtRootElement=this.wot.wtTable.wtRootElement;this.trimmingContainer=u.getTrimmingContainer(this.hider.parentNode.parentNode);this.areElementSizesAdjusted=!1;this.updateStateOfRendering()}return f(n,null,[{key:"registerOverlay",value:function(t,i){if(n.CLONE_TYPES.indexOf(t)===-1)throw new Error("Unsupported overlay ("+t+").");r[t]=i}},{key:"createOverlay",value:function(n,t){return new r[n](t)}},{key:"hasOverlay",value:function(n){return r[n]!==void 0}},{key:"isOverlayTypeOf",value:function(n,t){return!n||!r[t]?!1:n instanceof r[t]}},{key:"CLONE_TOP",get:function(){return"top"}},{key:"CLONE_BOTTOM",get:function(){return"bottom"}},{key:"CLONE_LEFT",get:function(){return"left"}},{key:"CLONE_TOP_LEFT_CORNER",get:function(){return"top_left_corner"}},{key:"CLONE_BOTTOM_LEFT_CORNER",get:function(){return"bottom_left_corner"}},{key:"CLONE_DEBUG",get:function(){return"debug"}},{key:"CLONE_TYPES",get:function(){return[n.CLONE_TOP,n.CLONE_BOTTOM,n.CLONE_LEFT,n.CLONE_TOP_LEFT_CORNER,n.CLONE_BOTTOM_LEFT_CORNER,n.CLONE_DEBUG]}}]),f(n,[{key:"updateStateOfRendering",value:function(){var t=this.needFullRender,n;return this.needFullRender=this.shouldBeRendered(),n=t!==this.needFullRender,n&&!this.needFullRender&&this.reset(),n}},{key:"shouldBeRendered",value:function(){return!0}},{key:"updateTrimmingContainer",value:function(){this.trimmingContainer=u.getTrimmingContainer(this.hider.parentNode.parentNode)}},{key:"updateMainScrollableElement",value:function(){this.mainTableScrollableElement=u.getScrollableElement(this.wot.wtTable.TABLE)}},{key:"makeClone",value:function(t){var i,r,f;if(n.CLONE_TYPES.indexOf(t)===-1)throw new Error('Clone type "'+t+'" is not supported.');return i=document.createElement("DIV"),r=document.createElement("TABLE"),i.className="ht_clone_"+t+" handsontable",i.style.position="absolute",i.style.top=0,i.style.left=0,i.style.overflow="hidden",r.className=this.wot.wtTable.TABLE.className,i.appendChild(r),this.type=t,this.wot.wtTable.wtRootElement.parentNode.appendChild(i),f=this.wot.getSetting("preventOverflow"),this.mainTableScrollableElement=f===!0||f==="horizontal"&&this.type===n.CLONE_TOP||f==="vertical"&&this.type===n.CLONE_LEFT?window:u.getScrollableElement(this.wot.wtTable.TABLE),new v.default({cloneSource:this.wot,cloneOverlay:this,table:r})}},{key:"refresh",value:function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:!1,n=this.shouldBeRendered();this.clone&&(this.needFullRender||n)&&this.clone.draw(t);this.needFullRender=n}},{key:"reset",value:function(){if(this.clone){var n=this.clone.wtTable.holder,t=this.clone.wtTable.hider,i=n.style,r=t.style,u=n.parentNode.style;h.arrayEach([i,r,u],function(n){n.width="";n.height=""})}}},{key:"destroy",value:function(){new l.default(this.clone).destroy()}}]),n}();t.default=o},function(n,t,i){"use strict";function e(n){return n[0].toUpperCase()+n.substr(1)}function o(){for(var u,f,t=[],e=arguments.length,i=Array(e),n=0;n<e;n++)i[n]=arguments[n];for(u=i.length;u--;)f=r.stringify(i[u]).toLowerCase(),t.indexOf(f)===-1&&t.push(f);return t.length===1}function s(){function n(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return n()+n()+n()+n()}function h(n){return/^([0-9][0-9]?%$)|(^100%$)/.test(n)}function c(n){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};return(""+n).replace(/(?:\\)?\[([^[\]]+)]/g,function(n,i){return n.charAt(0)==="\\"?n.substr(1,n.length-1):t[i]===void 0?"":t[i]})}function l(n){return n+="",n.replace(u,"")}var r,f,u;t.__esModule=!0;t.toUpperCaseFirst=e;t.equalsIgnoreCase=o;t.randomString=s;t.isPercentValue=h;t.substitute=c;t.stripTags=l;r=i(13);f=i(4);u=/<\/?\w+\/?>|<\w+[\s|/][^>]*>/gi},function(t){t.exports=n},function(n){var t={}.hasOwnProperty;n.exports=function(n,i){return t.call(n,i)}},function(n,t){"use strict";function e(){return i}function o(){return r}function s(){return u}function h(){return f}function c(n){return n||(n=navigator.userAgent),/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(n)}var i,r,u,f;t.__esModule=!0;t.isIE8=e;t.isIE9=o;t.isSafari=s;t.isChrome=h;t.isMobileBrowser=c;i=!document.createTextNode("test").textContent;r=!!document.documentMode;u=/Safari/.test(navigator.userAgent)&&/Apple Computer/.test(navigator.vendor);f=/Chrome/.test(navigator.userAgent)&&/Google/.test(navigator.vendor)},function(n,t,i){"use strict";function u(n){for(var f,i=arguments.length,u=Array(i>1?i-1:0),t=1;t<i;t++)u[t-1]=arguments[t];return f=r.arrayReduce(n,function(n,t,i){var r=t.replace(/(?:\r?\n\s+)/g,""),f=u[i]?u[i]:"";return n+r+f},""),f.trim()}t.__esModule=!0;t.toSingleLine=u;var r=i(0)},function(n,t,i){"use strict";function f(n){return typeof n=="function"}function r(n){function f(){var h=this,f=arguments,e=Date.now(),o=!1,s;return i.lastCallThrottled=!0,t||(t=e,o=!0),s=u-(e-t),o?(i.lastCallThrottled=!1,n.apply(this,f)):(r&&clearTimeout(r),r=setTimeout(function(){i.lastCallThrottled=!1;n.apply(h,f);t=0;r=void 0},s)),i}var u=arguments.length>1&&arguments[1]!==undefined?arguments[1]:200,t=0,i={lastCallThrottled:!0},r=null;return f}function e(n){function o(){t=i}function u(){return t?(t--,n.apply(this,arguments)):e.apply(this,arguments)}var f=arguments.length>1&&arguments[1]!==undefined?arguments[1]:200,i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:10,e=r(n,f),t=i;return u.clearHits=o,u}function o(n){function u(){var u=this,f=arguments;return t&&clearTimeout(t),t=setTimeout(function(){i=n.apply(u,f)},r),i}var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:200,t=null,i=void 0;return u}function s(){for(var r,f,i=arguments.length,t=Array(i),n=0;n<i;n++)t[n]=arguments[n];return r=t[0],f=t.slice(1),function(){return u.arrayReduce(f,function(n,t){return t(n)},r.apply(this,arguments))}}function h(n){for(var i=arguments.length,r=Array(i>1?i-1:0),t=1;t<i;t++)r[t-1]=arguments[t];return function(){for(var i=arguments.length,u=Array(i),t=0;t<i;t++)u[t]=arguments[t];return n.apply(this,r.concat(u))}}function c(n){function t(r){return function(){for(var f,s,e=arguments.length,o=Array(e),u=0;u<e;u++)o[u]=arguments[u];return f=r.concat(o),s=void 0,f.length>=i?n.apply(this,f):t(f)}}var i=n.length;return t([])}function l(n){function t(r){return function(){for(var f,s,e=arguments.length,o=Array(e),u=0;u<e;u++)o[u]=arguments[u];return f=r.concat(o.reverse()),s=void 0,f.length>=i?n.apply(this,f):t(f)}}var i=n.length;return t([])}t.__esModule=!0;t.isFunction=f;t.throttle=r;t.throttleAfterHits=e;t.debounce=o;t.pipe=s;t.partial=h;t.curry=c;t.curryRight=l;var u=i(0)},function(n,t,i){"use strict";function r(n){return n&&n.__esModule?n:{"default":n}}function g(n){if(typeof n=="function")return n;if(!e(n))throw Error('No registered validator found under "'+n+'" name');return b(n)}t.__esModule=!0;t.getRegisteredValidators=t.getRegisteredValidatorNames=t.hasValidator=t.getValidator=t.registerValidator=undefined;var o=i(48),s=r(o),h=i(278),c=r(h),l=i(279),a=r(l),v=i(280),y=r(v),p=i(281),w=r(p);var u=s.default("validators"),f=u.register,b=u.getItem,e=u.hasItem,k=u.getNames,d=u.getValues;f("autocomplete",c.default);f("date",a.default);f("numeric",y.default);f("time",w.default);t.registerValidator=f;t.getValidator=g;t.hasValidator=e;t.getRegisteredValidatorNames=k;t.getRegisteredValidators=d},function(n,t){"use strict";function r(n){return typeof n=="string"&&n.length>=2&&n.charAt(0)==="="}function i(n){return typeof n=="string"&&n.charAt(0)==="'"&&n.charAt(1)==="="}function u(n){return i(n)?n.substr(1):n}function f(n){var t=/(\\"|"(?:\\"|[^"])*"|(\+))|(\\'|'(?:\\'|[^'])*'|(\+))/g,r=n.match(t)||[],i=-1;return n.toUpperCase().replace(t,function(){return++i,r[i]})}function e(n,t){return function(i){return{row:n==="row"?t:i.row,column:n==="column"?t:i.column}}}t.__esModule=!0;t.isFormulaExpression=r;t.isFormulaExpressionEscaped=i;t.unescapeFormulaExpression=u;t.toUpperCaseFormula=f;t.cellCoordFactory=e},function(n,t,i){var s=i(17),r=i(39),o=i(32),u=i(55)("src"),f="toString",e=Function[f],h=(""+e).split(f);i(50).inspectSource=function(n){return e.call(n)};(n.exports=function(n,t,i,f){var e=typeof i=="function";(e&&(o(i,"name")||r(i,"name",t)),n[t]!==i)&&(e&&(o(i,u)||r(i,u,n[t]?""+n[t]:h.join(String(t)))),n===s?n[t]=i:f?n[t]?n[t]=i:r(n,t,i):(delete n[t],r(n,t,i)))})(Function.prototype,f,function(){return typeof this=="function"&&this[u]||e.call(this)})},function(n,t,i){var r=i(22),u=i(56);n.exports=i(24)?function(n,t,i){return r.f(n,t,u(1,i))}:function(n,t,i){return n[t]=i,n}},function(n,t,i){var r=i(71);n.exports=function(n,t,i){if(r(n),t===undefined)return n;switch(i){case 1:return function(i){return n.call(t,i)};case 2:return function(i,r){return n.call(t,i,r)};case 3:return function(i,r,u){return n.call(t,i,r,u)}}return function(){return n.apply(t,arguments)}}},function(n,t,i){var r=i(47);n.exports=function(n){return Object(r(n))}},function(n,t,i){var r=i(55)("meta"),o=i(12),f=i(32),s=i(22).f,h=0,u=Object.isExtensible||function(){return!0},c=!i(25)(function(){return u(Object.preventExtensions({}))}),e=function(n){s(n,r,{value:{i:"O"+ ++h,w:{}}})},l=function(n,t){if(!o(n))return typeof n=="symbol"?n:(typeof n=="string"?"S":"P")+n;if(!f(n,r)){if(!u(n))return"F";if(!t)return"E";e(n)}return n[r].i},a=function(n,t){if(!f(n,r)){if(!u(n))return!0;if(!t)return!1;e(n)}return n[r].w},v=function(n){return c&&y.NEED&&u(n)&&!f(n,r)&&e(n),n},y=n.exports={KEY:r,NEED:!1,fastKey:l,getWeak:a,onFreeze:v}},function(n,t){"use strict";function c(n){return u.call(window,n)}function l(n){e.call(window,n)}function a(){return"ontouchstart"in window}function v(){var n=document.createElement("div");return!!(n.createShadowRoot&&n.createShadowRoot.toString().match(/\[native code\]/))}function y(){var n=document.createElement("TABLE"),t,i;n.style.borderSpacing=0;n.style.borderWidth=0;n.style.padding=0;t=document.createElement("TBODY");n.appendChild(t);t.appendChild(document.createElement("TR"));t.firstChild.appendChild(document.createElement("TD"));t.firstChild.firstChild.innerHTML="<tr><td>t<br>t<\/td><\/tr>";i=document.createElement("CAPTION");i.innerHTML="c<br>c<br>c<br>c";i.style.padding=0;i.style.margin=0;n.insertBefore(i,t);document.body.appendChild(n);o=n.offsetHeight<2*n.lastChild.offsetHeight;document.body.removeChild(n)}function p(){return o===void 0&&y(),o}function w(n){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};return i?i:i=(typeof Intl=="undefined"?"undefined":s(Intl))==="object"?new Intl.Collator(n,t).compare:typeof String.prototype.localeCompare=="function"?function(n,t){return(""+n).localeCompare(t)}:function(n,t){return n===t?0:n>t?-1:1}}var s,r,o,i;t.__esModule=!0;s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n};t.requestAnimationFrame=c;t.cancelAnimationFrame=l;t.isTouchSupported=a;t.isWebComponentSupportedNatively=v;t.hasCaptionProblem=p;t.getComparisonFunction=w;var h=0,f=["ms","moz","webkit","o"],u=window.requestAnimationFrame,e=window.cancelAnimationFrame;for(r=0;r<f.length&&!u;++r)u=window[f[r]+"RequestAnimationFrame"],e=window[f[r]+"CancelAnimationFrame"]||window[f[r]+"CancelRequestAnimationFrame"];u||(u=function(n){var t=(new Date).getTime(),i=Math.max(0,16-(t-h)),r=window.setTimeout(function(){n(t+i)},i);return h=t+i,r});e||(e=function(n){clearTimeout(n)});i=void 0},function(n,t,i){"use strict";function u(n){return n&&n.__esModule?n:{"default":n}}function f(n,t,i){return t in n?Object.defineProperty(n,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[t]=i,n}function at(){var n={};return g.objectEach(k,function(t,i){n[i]=t()}),n}function vt(n,t){d.indexOf(n)===-1&&(k[n]=t)}var r,e,o,s,h,c,l,a,v,y,p,w,b,d,k;t.__esModule=!0;t.ITEMS=t.UNDO=t.SEPARATOR=t.ROW_BELOW=t.ROW_ABOVE=t.REMOVE_ROW=t.REMOVE_COLUMN=t.REDO=t.READ_ONLY=t.COLUMN_RIGHT=t.COLUMN_LEFT=t.CLEAR_COLUMN=t.ALIGNMENT=undefined;e=i(325);Object.defineProperty(t,"ALIGNMENT",{enumerable:!0,get:function(){return e.KEY}});o=i(326);Object.defineProperty(t,"CLEAR_COLUMN",{enumerable:!0,get:function(){return o.KEY}});s=i(327);Object.defineProperty(t,"COLUMN_LEFT",{enumerable:!0,get:function(){return s.KEY}});h=i(328);Object.defineProperty(t,"COLUMN_RIGHT",{enumerable:!0,get:function(){return h.KEY}});c=i(329);Object.defineProperty(t,"READ_ONLY",{enumerable:!0,get:function(){return c.KEY}});l=i(330);Object.defineProperty(t,"REDO",{enumerable:!0,get:function(){return l.KEY}});a=i(331);Object.defineProperty(t,"REMOVE_COLUMN",{enumerable:!0,get:function(){return a.KEY}});v=i(332);Object.defineProperty(t,"REMOVE_ROW",{enumerable:!0,get:function(){return v.KEY}});y=i(333);Object.defineProperty(t,"ROW_ABOVE",{enumerable:!0,get:function(){return y.KEY}});p=i(334);Object.defineProperty(t,"ROW_BELOW",{enumerable:!0,get:function(){return p.KEY}});w=i(156);Object.defineProperty(t,"SEPARATOR",{enumerable:!0,get:function(){return w.KEY}});b=i(335);Object.defineProperty(t,"UNDO",{enumerable:!0,get:function(){return b.KEY}});t.predefinedItems=at;t.addItem=vt;var g=i(1),nt=u(e),tt=u(o),it=u(s),rt=u(h),ut=u(c),ft=u(l),et=u(a),ot=u(v),st=u(y),ht=u(p),ct=u(w),lt=u(b);d=t.ITEMS=[y.KEY,p.KEY,s.KEY,h.KEY,o.KEY,v.KEY,a.KEY,b.KEY,l.KEY,c.KEY,e.KEY,w.KEY];k=(r={},f(r,w.KEY,ct.default),f(r,y.KEY,st.default),f(r,p.KEY,ht.default),f(r,s.KEY,it.default),f(r,h.KEY,rt.default),f(r,o.KEY,tt.default),f(r,v.KEY,ot.default),f(r,a.KEY,et.default),f(r,b.KEY,lt.default),f(r,l.KEY,ft.default),f(r,c.KEY,ut.default),f(r,e.KEY,nt.default),r)},function(n,t,i){"use strict";function s(n){return n&&n.__esModule?n:{"default":n}}function h(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function c(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function l(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}t.__esModule=!0;var r=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),u=i(66),f=i(0),e=i(229),o=s(e);var a=[1,2,3],v=function(n){function t(n,i){h(this,t);var r=c(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n,i));return r.precedents=[],r.value=null,r.error=null,r.state=t.STATE_UP_TO_DATE,r}return l(t,n),r(t,null,[{key:"STATE_OUT_OFF_DATE",get:function(){return 1}},{key:"STATE_COMPUTING",get:function(){return 2}},{key:"STATE_UP_TO_DATE",get:function(){return 3}}]),r(t,[{key:"setValue",value:function(n){this.value=n}},{key:"getValue",value:function(){return this.value}},{key:"setError",value:function(n){this.error=n}},{key:"getError",value:function(){return this.error}},{key:"hasError",value:function(){return this.error!==null}},{key:"setState",value:function(n){if(a.indexOf(n)===-1)throw Error("Unrecognized state: "+n);this.state=n}},{key:"isState",value:function(n){return this.state===n}},{key:"addPrecedent",value:function(n){if(this.isEqual(n))throw Error(u.ERROR_REF);this.hasPrecedent(n)||this.precedents.push(n)}},{key:"removePrecedent",value:function(n){if(this.isEqual(n))throw Error(u.ERROR_REF);this.precedents=f.arrayFilter(this.precedents,function(t){return!t.isEqual(n)})}},{key:"clearPrecedents",value:function(){this.precedents.length=0}},{key:"getPrecedents",value:function(){return this.precedents}},{key:"hasPrecedents",value:function(){return this.precedents.length>0}},{key:"hasPrecedent",value:function(n){return f.arrayFilter(this.precedents,function(t){return t.isEqual(n)}).length>0}}]),t}(o.default);t.default=v},function(n,t,i){var r=i(165),u=i(91);n.exports=Object.keys||function(n){return r(n,u)}},function(n){n.exports=function(n){if(n==undefined)throw TypeError("Can't call method on  "+n);return n}},function(n,t){"use strict";function r(n){if(Array.isArray(n)){for(var t=0,i=Array(n.length);t<n.length;t++)i[t]=n[t];return i}return Array.from(n)}function u(){function u(t,i){n.set(t,i)}function f(t){return n.get(t)}function e(t){return n.has(t)}function o(){return[].concat(r(n.keys()))}function s(){return[].concat(r(n.values()))}var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"common",n;return i.has(t)||i.set(t,new Map),n=i.get(t),{register:u,getItem:f,hasItem:e,getNames:o,getValues:s}}t.__esModule=!0;t.default=u;var i=t.collection=new Map},function(n){var t={}.toString;n.exports=function(n){return t.call(n).slice(8,-1)}},function(n){var t=n.exports={version:"2.5.3"};typeof __e=="number"&&(__e=t)},function(n,t,i){var r=i(12);n.exports=function(n,t){if(!r(n)||n._t!==t)throw TypeError("Incompatible receiver, "+t+" required!");return n}},function(n,t,i){var r=i(16)("unscopables"),u=Array.prototype;u[r]==undefined&&i(39)(u,r,{});n.exports=function(n){u[r][n]=!0}},function(n,t,i){"use strict";function c(n){return n&&n.__esModule?n:{"default":n}}function l(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function a(n,t){r.set(n,t)}function v(n){var t=void 0;if(!(n instanceof h.default)){if(!r.has(n))throw Error("Record translator was not registered for this object identity");n=r.get(n)}return u.has(n)?t=u.get(n):(t=new f(n),u.set(n,t)),t}var e,f,r,u;t.__esModule=!0;t.RecordTranslator=undefined;e=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}();t.registerIdentity=a;t.getTranslator=v;var s=i(152),h=c(s),o=i(1);f=function(){function n(t){l(this,n);this.hot=t}return e(n,[{key:"toVisualRow",value:function(n){return this.hot.runHooks("unmodifyRow",n)}},{key:"toVisualColumn",value:function(n){return this.hot.runHooks("unmodifyCol",n)}},{key:"toVisual",value:function(n,t){return o.isObject(n)?{row:this.toVisualRow(n.row),column:this.toVisualColumn(n.column)}:[this.toVisualRow(n),this.toVisualColumn(t)]}},{key:"toPhysicalRow",value:function(n){return this.hot.runHooks("modifyRow",n)}},{key:"toPhysicalColumn",value:function(n){return this.hot.runHooks("modifyCol",n)}},{key:"toPhysical",value:function(n,t){return o.isObject(n)?{row:this.toPhysicalRow(n.row),column:this.toPhysicalColumn(n.column)}:[this.toPhysicalRow(n),this.toPhysicalColumn(t)]}}]),n}();t.RecordTranslator=f;r=new WeakMap;u=new WeakMap},function(n,t,i){"use strict";function s(n){if(Array.isArray(n)){for(var t=0,i=Array(n.length);t<n.length;t++)i[t]=n[t];return i}return Array.from(n)}var e,u;t.__esModule=!0;var r=i(0),o=i(1),f=i(4);e="arrayMapper";u={_arrayMap:[],getValueByIndex:function(n){var i=this._arrayMap.length,t=null;return n<i&&(t=this._arrayMap[n]),t},getIndexByValue:function(n){var t=void 0;return(t=this._arrayMap.indexOf(n))===-1?null:t},insertItems:function(n){var i=this,u=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1,e=r.arrayMax(this._arrayMap)+1,t=[];return f.rangeEach(u-1,function(r){t.push(i._arrayMap.splice(n+r,0,e+r))}),t},removeItems:function(n){var u=this,f=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1,t=[],i;return Array.isArray(n)?(i=[].concat(this._arrayMap),n.sort(function(n,t){return t-n}),t=r.arrayReduce(n,function(n,t){return u._arrayMap.splice(t,1),n.concat(i.slice(t,t+1))},[])):t=this._arrayMap.splice(n,f),t},unshiftItems:function(n){function u(n){return r.arrayReduce(i,function(t,i){return n>i&&t++,t},0)}var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1,i=this.removeItems(n,t);this._arrayMap=r.arrayMap(this._arrayMap,function(n){var t=u(n);return t&&(n-=t),n})},shiftItems:function(n){var i=this,t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;this._arrayMap=r.arrayMap(this._arrayMap,function(i){return i>=n&&(i+=t),i});f.rangeEach(t-1,function(t){i._arrayMap.splice(n+t,0,n+t)})},swapIndexes:function(n,t){var i;(i=this._arrayMap).splice.apply(i,[t,0].concat(s(this._arrayMap.splice(n,1))))},clearMap:function(){this._arrayMap.length=0}};o.defineGetter(u,"MIXIN_NAME",e,{writable:!1,enumerable:!1});t.default=u},function(n){var t=0,i=Math.random();n.exports=function(n){return"Symbol(".concat(n===undefined?"":n,")_",(++t+i).toString(36))}},function(n){n.exports=function(n,t){return{enumerable:!(n&1),configurable:!(n&2),writable:!(n&4),value:t}}},function(n){n.exports={}},function(n,t,i){var u=i(22).f,f=i(32),r=i(16)("toStringTag");n.exports=function(n,t,i){n&&!f(n=i?n:n.prototype,r)&&u(n,r,{configurable:!0,value:t})}},function(n,t){t.f={}.propertyIsEnumerable},function(n,t,i){"use strict";function r(n){this.instance=n;this.state=u.VIRGIN;this._opened=!1;this._fullEditMode=!1;this._closeCallback=null;this.init()}t.__esModule=!0;t.EditorState=undefined;var f=i(8),e=i(13),u=t.EditorState={VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"};r.prototype._fireCallbacks=function(n){this._closeCallback&&(this._closeCallback(n),this._closeCallback=null)};r.prototype.init=function(){};r.prototype.getValue=function(){throw Error("Editor getValue() method unimplemented");};r.prototype.setValue=function(){throw Error("Editor setValue() method unimplemented");};r.prototype.open=function(){throw Error("Editor open() method unimplemented");};r.prototype.close=function(){throw Error("Editor close() method unimplemented");};r.prototype.prepare=function(n,t,i,r,f,e){this.TD=r;this.row=n;this.col=t;this.prop=i;this.originalValue=f;this.cellProperties=e;this.state=u.VIRGIN};r.prototype.extend=function(){function t(){n.apply(this,arguments)}function i(n,t){function i(){}return i.prototype=t.prototype,n.prototype=new i,n.prototype.constructor=n,n}var n=this.constructor;return i(t,n)};r.prototype.saveValue=function(n,t){var i=void 0,r=void 0;t?(i=this.instance.getSelectedLast(),i[0]>i[2]&&(r=i[0],i[0]=i[2],i[2]=r),i[1]>i[3]&&(r=i[1],i[1]=i[3],i[3]=r)):i=[this.row,this.col,null,null];this.instance.populateFromArray(i[0],i[1],n,i[2],i[3],"edit")};r.prototype.beginEditing=function(n,t){this.state===u.VIRGIN&&(this.instance.view.scrollViewport(new f.CellCoords(this.row,this.col)),this.instance.view.render(),this.state=u.EDITING,n=typeof n=="string"?n:this.originalValue,this.setValue(e.stringify(n)),this.open(t),this._opened=!0,this.focus(),this.instance.view.render(),this.instance.runHooks("afterBeginEditing",this.row,this.col))};r.prototype.finishEditing=function(n,t,i){var f=this,o,e,r;if(i&&(e=this._closeCallback,this._closeCallback=function(n){e&&e(n);i(n);f.instance.view.render()}),!this.isWaiting()){if(this.state==u.VIRGIN){this.instance._registerTimeout(setTimeout(function(){f._fireCallbacks(!0)},0));return}if(this.state==u.EDITING){if(n){this.cancelChanges();this.instance.view.render();return}r=this.getValue();o=this.instance.getSettings().trimWhitespace?[[typeof r=="string"?String.prototype.trim.call(r||""):r]]:[[r]];this.state=u.WAITING;this.saveValue(o,t);this.instance.getCellValidator(this.cellProperties)?this.instance.addHookOnce("postAfterValidate",function(n){f.state=u.FINISHED;f.discardEditor(n)}):(this.state=u.FINISHED,this.discardEditor(!0))}}};r.prototype.cancelChanges=function(){this.state=u.FINISHED;this.discardEditor()};r.prototype.discardEditor=function(n){this.state===u.FINISHED&&(n===!1&&this.cellProperties.allowInvalid!==!0?(this.instance.selectCell(this.row,this.col),this.focus(),this.state=u.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=u.VIRGIN,this._fireCallbacks(!0)))};r.prototype.enableFullEditMode=function(){this._fullEditMode=!0};r.prototype.isInFullEditMode=function(){return this._fullEditMode};r.prototype.isOpened=function(){return this._opened};r.prototype.isWaiting=function(){return this.state===u.WAITING};r.prototype.checkEditorSection=function(){var t=this.instance.countRows(),n="";return this.row<this.instance.getSettings().fixedRowsTop?n=this.col<this.instance.getSettings().fixedColumnsLeft?"top-left-corner":"top":this.instance.getSettings().fixedRowsBottom&&this.row>=t-this.instance.getSettings().fixedRowsBottom?n=this.col<this.instance.getSettings().fixedColumnsLeft?"bottom-left-corner":"bottom":this.col<this.instance.getSettings().fixedColumnsLeft&&(n="left"),n};t.default=r},function(n,t){"use strict";function u(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var i,r;t.__esModule=!0;i=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}();r=function(){function n(t,i){u(this,n);typeof t!="undefined"&&typeof i!="undefined"?(this.row=t,this.col=i):(this.row=null,this.col=null)}return i(n,[{key:"isValid",value:function(n){return this.row<0||this.col<0?!1:this.row>=n.getSetting("totalRows")||this.col>=n.getSetting("totalColumns")?!1:!0}},{key:"isEqual",value:function(n){return n===this?!0:this.row===n.row&&this.col===n.col}},{key:"isSouthEastOf",value:function(n){return this.row>=n.row&&this.col>=n.col}},{key:"isNorthWestOf",value:function(n){return this.row<=n.row&&this.col<=n.col}},{key:"isSouthWestOf",value:function(n){return this.row>=n.row&&this.col<=n.col}},{key:"isNorthEastOf",value:function(n){return this.row<=n.row&&this.col>=n.col}},{key:"toObject",value:function(){return{row:this.row,col:this.col}}}]),n}();t.default=r},function(n,t,i){"use strict";function o(n){return n&&n.__esModule?n:{"default":n}}var f,s;t.__esModule=!0;var r=i(2),c=i(261),l=o(c),h=i(60),a=o(h),v=i(9),y=o(v),u=i(18),e=i(11);f=a.default.prototype.extend();f.prototype.init=function(){var n=this;this.createElements();this.eventManager=new y.default(this);this.bindEvents();this.autoResize=l.default();this.instance.addHook("afterDestroy",function(){n.destroy()})};f.prototype.getValue=function(){return this.TEXTAREA.value};f.prototype.setValue=function(n){this.TEXTAREA.value=n};s=function(n){var h=this,t=h.getActiveEditor(),i,o;if(i=(n.ctrlKey||n.metaKey)&&!n.altKey,n.target===t.TEXTAREA&&!e.isImmediatePropagationStopped(n)){if(n.keyCode===17||n.keyCode===224||n.keyCode===91||n.keyCode===93){e.stopImmediatePropagation(n);return}switch(n.keyCode){case u.KEY_CODES.ARROW_RIGHT:t.isInFullEditMode()&&((t.isWaiting()||t.allowKeyEventPropagation)&&(t.isWaiting()||!t.allowKeyEventPropagation||t.allowKeyEventPropagation(n.keyCode))||e.stopImmediatePropagation(n));break;case u.KEY_CODES.ARROW_LEFT:t.isInFullEditMode()&&((t.isWaiting()||t.allowKeyEventPropagation)&&(t.isWaiting()||!t.allowKeyEventPropagation||t.allowKeyEventPropagation(n.keyCode))||e.stopImmediatePropagation(n));break;case u.KEY_CODES.ARROW_UP:case u.KEY_CODES.ARROW_DOWN:t.isInFullEditMode()&&((t.isWaiting()||t.allowKeyEventPropagation)&&(t.isWaiting()||!t.allowKeyEventPropagation||t.allowKeyEventPropagation(n.keyCode))||e.stopImmediatePropagation(n));break;case u.KEY_CODES.ENTER:if(o=this.selection.isMultiple(),i&&!o||n.altKey){if(t.isOpened()){var f=r.getCaretPosition(t.TEXTAREA),s=t.getValue(),c=s.slice(0,f)+"\n"+s.slice(f);t.setValue(c);r.setCaretPosition(t.TEXTAREA,f+1)}else t.beginEditing(t.originalValue+"\n");e.stopImmediatePropagation(n)}n.preventDefault();break;case u.KEY_CODES.A:case u.KEY_CODES.X:case u.KEY_CODES.C:case u.KEY_CODES.V:i&&e.stopImmediatePropagation(n);break;case u.KEY_CODES.BACKSPACE:case u.KEY_CODES.DELETE:case u.KEY_CODES.HOME:case u.KEY_CODES.END:e.stopImmediatePropagation(n)}[u.KEY_CODES.ARROW_UP,u.KEY_CODES.ARROW_RIGHT,u.KEY_CODES.ARROW_DOWN,u.KEY_CODES.ARROW_LEFT].indexOf(n.keyCode)===-1&&t.autoResize.resize(String.fromCharCode(n.keyCode))}};f.prototype.open=function(){this.refreshDimensions();this.instance.addHook("beforeKeyDown",s)};f.prototype.close=function(){this.textareaParentStyle.display="none";this.autoResize.unObserve();document.activeElement===this.TEXTAREA&&this.instance.listen();this.instance.removeHook("beforeKeyDown",s)};f.prototype.focus=function(){this.TEXTAREA.focus();r.setCaretPosition(this.TEXTAREA,this.TEXTAREA.value.length)};f.prototype.createElements=function(){this.TEXTAREA=document.createElement("TEXTAREA");r.addClass(this.TEXTAREA,"handsontableInput");this.textareaStyle=this.TEXTAREA.style;this.textareaStyle.width=0;this.textareaStyle.height=0;this.TEXTAREA_PARENT=document.createElement("DIV");r.addClass(this.TEXTAREA_PARENT,"handsontableInputHolder");this.textareaParentStyle=this.TEXTAREA_PARENT.style;this.textareaParentStyle.top=0;this.textareaParentStyle.left=0;this.textareaParentStyle.display="none";this.TEXTAREA_PARENT.appendChild(this.TEXTAREA);this.instance.rootElement.appendChild(this.TEXTAREA_PARENT);var n=this;this.instance._registerTimeout(setTimeout(function(){n.refreshDimensions()},0))};f.prototype.getEditedCell=function(){var t=this.checkEditorSection(),n;switch(t){case"top":n=this.instance.view.wt.wtOverlays.topOverlay.clone.wtTable.getCell({row:this.row,col:this.col});this.textareaParentStyle.zIndex=101;break;case"top-left-corner":n=this.instance.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.getCell({row:this.row,col:this.col});this.textareaParentStyle.zIndex=103;break;case"bottom-left-corner":n=this.instance.view.wt.wtOverlays.bottomLeftCornerOverlay.clone.wtTable.getCell({row:this.row,col:this.col});this.textareaParentStyle.zIndex=103;break;case"left":n=this.instance.view.wt.wtOverlays.leftOverlay.clone.wtTable.getCell({row:this.row,col:this.col});this.textareaParentStyle.zIndex=102;break;case"bottom":n=this.instance.view.wt.wtOverlays.bottomOverlay.clone.wtTable.getCell({row:this.row,col:this.col});this.textareaParentStyle.zIndex=102;break;default:n=this.instance.getCell(this.row,this.col);this.textareaParentStyle.zIndex=""}if(n!=-1&&n!=-2)return n};f.prototype.refreshValue=function(){var n=this.instance.getSourceDataAtCell(this.row,this.prop);this.originalValue=n;this.setValue(n);this.refreshDimensions()};f.prototype.refreshDimensions=function(){if(this.state===h.EditorState.EDITING){if(this.TD=this.getEditedCell(),!this.TD){this.close(!0);return}var i=r.offset(this.TD),u=r.offset(this.instance.rootElement),t=r.getScrollableElement(this.TD),y=this.instance.countRows(),p=i.top===u.top?0:1,f=i.top-u.top-p-(t.scrollTop||0),e=i.left-u.left-1-(t.scrollLeft||0),o=this.instance.getSettings(),ot=this.instance.hasRowHeaders(),w=this.instance.hasColHeaders(),b=this.checkEditorSection(),s=this.TD.style.backgroundColor,n;switch(b){case"top":n=r.getCssTransform(this.instance.view.wt.wtOverlays.topOverlay.clone.wtTable.holder.parentNode);break;case"left":n=r.getCssTransform(this.instance.view.wt.wtOverlays.leftOverlay.clone.wtTable.holder.parentNode);break;case"top-left-corner":n=r.getCssTransform(this.instance.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.holder.parentNode);break;case"bottom-left-corner":n=r.getCssTransform(this.instance.view.wt.wtOverlays.bottomLeftCornerOverlay.clone.wtTable.holder.parentNode);break;case"bottom":n=r.getCssTransform(this.instance.view.wt.wtOverlays.bottomOverlay.clone.wtTable.holder.parentNode)}(w&&this.instance.getSelectedLast()[0]===0||o.fixedRowsBottom&&this.instance.getSelectedLast()[0]===y-o.fixedRowsBottom)&&(f+=1);this.instance.getSelectedLast()[1]===0&&(e+=1);n&&n!=-1?this.textareaParentStyle[n[0]]=n[1]:r.resetCssTransform(this.TEXTAREA_PARENT);this.textareaParentStyle.top=f+"px";this.textareaParentStyle.left=e+"px";var k=this.instance.view.wt.wtViewport.rowsRenderCalculator.startPosition,d=this.instance.view.wt.wtViewport.columnsRenderCalculator.startPosition,g=this.instance.view.wt.wtOverlays.leftOverlay.getScrollPosition(),nt=this.instance.view.wt.wtOverlays.topOverlay.getScrollPosition(),c=r.getScrollbarWidth(),tt=this.TD.offsetTop+k-nt,it=this.TD.offsetLeft+d-g,rt=r.innerWidth(this.TD)-8,ut=r.hasVerticalScrollbar(t)?c:0,ft=r.hasHorizontalScrollbar(t)?c:0,l=this.instance.view.maximumVisibleElementWidth(it)-9-ut,et=this.TD.scrollHeight+1,a=Math.max(this.instance.view.maximumVisibleElementHeight(tt)-ft,23),v=r.getComputedStyle(this.TD);this.TEXTAREA.style.fontSize=v.fontSize;this.TEXTAREA.style.fontFamily=v.fontFamily;this.TEXTAREA.style.backgroundColor="";this.TEXTAREA.style.backgroundColor=s?s:r.getComputedStyle(this.TEXTAREA).backgroundColor;this.autoResize.init(this.TEXTAREA,{minHeight:Math.min(et,a),maxHeight:a,minWidth:Math.min(rt,l),maxWidth:l},!0);this.textareaParentStyle.display="block"}};f.prototype.bindEvents=function(){var n=this;this.eventManager.addEventListener(this.TEXTAREA,"cut",function(n){e.stopPropagation(n)});this.eventManager.addEventListener(this.TEXTAREA,"paste",function(n){e.stopPropagation(n)});this.instance.addHook("afterScrollHorizontally",function(){n.refreshDimensions()});this.instance.addHook("afterScrollVertically",function(){n.refreshDimensions()});this.instance.addHook("afterColumnResize",function(){n.refreshDimensions();n.focus()});this.instance.addHook("afterRowResize",function(){n.refreshDimensions();n.focus()});this.instance.addHook("afterDestroy",function(){n.eventManager.destroy()})};f.prototype.destroy=function(){this.eventManager.destroy()};t.default=f},function(n,t,i){"use strict";function c(n,t){return typeof n=="number"&&typeof t=="number"?n-t:h(n,t)}function f(n,t){return n===""&&(n="("+t+")"),n}function o(n){return r&&(n=new Set(n)),function(t){return r?n.has(t):!!~n.indexOf(t)}}function l(n){return n==null?"":n}function a(n){return n=e?Array.from(new Set(n)):u.arrayUnique(n),n.sort(function(n,t){return typeof n=="number"&&typeof t=="number"?n-t:n===t?0:n>t?1:-1})}function v(n,t,i,r){var e=[],s=n===t,h=void 0;return s||(h=o(t)),u.arrayEach(n,function(n){var u=!1,t;(s||h(n))&&(u=!0);t={checked:u,value:n,visualValue:f(n,i)};r&&r(t);e.push(t)}),e}var r,e;t.__esModule=!0;t.sortComparison=c;t.toVisualValue=f;t.createArrayAssertion=o;t.toEmptyString=l;t.unifyColumnValues=a;t.intersectValues=v;var s=i(43),u=i(0),h=s.getComparisonFunction();r=new Set([1]).has(1);e=r&&typeof Array.from=="function"},function(n,t){"use strict";function r(n){if(!i[n])throw Error('Operation with id "'+n+'" does not exist.');var t=i[n].func;return function(n,i){return t(n,i)}}function u(n){return i[n].name}function f(n,t,r){i[n]={name:t,func:r}}t.__esModule=!0;t.getOperationFunc=r;t.getOperationName=u;t.registerOperation=f;var i=t.operations={}},function(n,t,i){"use strict";function s(n){return n&&n.__esModule?n:{"default":n}}function w(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}t.__esModule=!0;var o=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),r=i(1),l=i(21),a=s(l),v=i(9),y=s(v),p=i(2),u=i(0);var f="built",e="building",h=["click","input","keydown","keypress","keyup","focus","blur","change"],c=function(){function n(t,i){w(this,n);this.hot=t;this.eventManager=new y.default(this);this.options=r.extend(n.DEFAULTS,i);this._element=document.createElement(this.options.wrapIt?"div":this.options.tagName);this.buildState=!1}return o(n,null,[{key:"DEFAULTS",get:function(){return r.clone({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}}]),o(n,[{key:"setValue",value:function(n){this.options.value=n;this.update()}},{key:"getValue",value:function(){return this.options.value}},{key:"isBuilt",value:function(){return this.buildState===f}},{key:"build",value:function(){var n=this,i=function(t,i){n.eventManager.addEventListener(t,i,function(t){return n.runLocalHooks(i,t,n)})},t;this.buildState||(this.buildState=e);this.options.className&&p.addClass(this._element,this.options.className);this.options.children.length?u.arrayEach(this.options.children,function(t){return n._element.appendChild(t.element)}):this.options.wrapIt?(t=document.createElement(this.options.tagName),r.objectEach(this.options,function(n,i){t[i]!==void 0&&i!=="className"&&i!=="tagName"&&i!=="children"&&(t[i]=n)}),this._element.appendChild(t),u.arrayEach(h,function(n){return i(t,n)})):u.arrayEach(h,function(t){return i(n._element,t)})}},{key:"update",value:function(){}},{key:"reset",value:function(){this.options.value="";this.update()}},{key:"show",value:function(){this.element.style.display=""}},{key:"hide",value:function(){this.element.style.display="none"}},{key:"focus",value:function(){}},{key:"destroy",value:function(){this.eventManager.destroy();this.eventManager=null;this.hot=null;this._element.parentNode&&this._element.parentNode.removeChild(this._element);this._element=null}},{key:"element",get:function(){return this.buildState===e?this._element:this.buildState===f?(this.update(),this._element):(this.buildState=e,this.build(),this.buildState=f,this._element)}}]),n}();r.mixin(c,a.default);t.default=c},function(n){n.exports=r},function(n,t,i){"use strict";function a(n){return n&&n.__esModule?n:{"default":n}}function v(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}t.__esModule=!0;var u=function(){function n(n,t){var r=[],u=!0,f=!1,e=undefined,i,o;try{for(i=n[Symbol.iterator]();!(u=(o=i.next()).done);u=!0)if(r.push(o.value),t&&r.length===t)break}catch(s){f=!0;e=s}finally{try{!u&&i["return"]&&i["return"]()}finally{if(f)throw e;}}return r}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return n(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance");}}(),o=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),r=i(66),f=i(0),s=i(1),h=i(21),c=a(h),l=i(37);var y=/^\$?[A-Z]+\$?\d+$/,p=/\$?[A-Z]+\$?\d+/,w=/(?:[^0-9A-Z$: ]|^)\s*(\$?[A-Z]+\$?\d+)\s*(?![0-9A-Z_: ])/g,b=/\$?[A-Z]+\$?\d+\s*:\s*\$?[A-Z]+\$?\d+/g,k=/((?:[^0-9A-Z$: ]|^)\s*(\$?[A-Z]+\$?\d+)\s*(?![0-9A-Z_: ]))|(\$?[A-Z]+\$?\d+\s*:\s*\$?[A-Z]+\$?\d+)/g,e=function(){function n(t){v(this,n);this.expression="";this.cells=[];this.customModifier=null;typeof t=="string"&&this.setExpression(t)}return o(n,[{key:"setExpression",value:function(n){return this.cells.length=0,this.expression=l.toUpperCaseFormula(n),this._extractCells(),this._extractCellsRange(),this}},{key:"useCustomModifier",value:function(n){this.customModifier=n}},{key:"translate",value:function(n){var t=this,i=n.row,r=n.column,u=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};return f.arrayEach(this.cells,function(n){i!=null&&t._translateCell(n,"row",i,u.row);r!=null&&t._translateCell(n,"column",r,u.column)}),this}},{key:"toString",value:function(){var t=this,n=this.expression.replace(k,function(n,i,u){var s=n.indexOf(":")===-1,h=n,e=n,o=null,f;return s&&(e=y.test(i)?i:u),f=t._searchCell(e),f&&(o=f.refError?r.error(r.ERROR_REF):f.toLabel(),h=s?n.replace(e,o):o),h});return n.startsWith("=")||(n="="+n),n}},{key:"_translateCell",value:function(n,t,i,r){var h=n.start,c=n.end,l=h[t].index,a=c[t].index,e=i,o=i,f=!1,v,s;this.customModifier?(v=this.customModifier(n,t,i,r),s=u(v,3),e=s[0],o=s[1],f=s[2]):(h[t].isAbsolute&&(e=0),c[t].isAbsolute&&(o=0));e&&!f&&(l+e<0&&(f=!0),h[t].index=Math.max(l+e,0));o&&!f&&(a+o<0&&(f=!0),c[t].index=Math.max(a+o,0));f&&(n.refError=!0)}},{key:"_extractCells",value:function(){var n=this,t=this.expression.match(w);t&&f.arrayEach(t,function(t){if(t=t.match(p),t){var o=r.extractLabel(t[0]),i=u(o,2),f=i[0],e=i[1];n.cells.push(n._createCell({row:f,column:e},{row:f,column:e},t[0]))}})}},{key:"_extractCellsRange",value:function(){var n=this,t=this.expression.match(b);t&&f.arrayEach(t,function(t){var o=t.split(":"),i=u(o,2),s=i[0],h=i[1],c=r.extractLabel(s),f=u(c,2),l=f[0],a=f[1],v=r.extractLabel(h),e=u(v,2),y=e[0],p=e[1],w={row:l,column:a},b={row:y,column:p};n.cells.push(n._createCell(w,b,t))})}},{key:"_searchCell",value:function(n){var t=f.arrayFilter(this.cells,function(t){return t.origLabel===n}),i=u(t,1),r=i[0];return r||null}},{key:"_createCell",value:function(n,t,i){return{start:n,end:t,origLabel:i,type:i.indexOf(":")===-1?"cell":"range",refError:!1,toLabel:function(){var n=r.toLabel(this.start.row,this.start.column);return this.type==="range"&&(n+=":"+r.toLabel(this.end.row,this.end.column)),n}}}}]),n}();s.mixin(e,c.default);t.default=e},function(n){var t=Math.ceil,i=Math.floor;n.exports=function(n){return isNaN(n=+n)?0:(n>0?i:t)(n)}},function(n,t,i){var r=i(68),u=Math.max,f=Math.min;n.exports=function(n,t){return n=r(n),n<0?u(n+t,0):f(n,t)}},function(n,t,i){var r=i(38);n.exports=function(n,t,i){for(var u in t)r(n,u,t[u],i);return n}},function(n){n.exports=function(n){if(typeof n!="function")throw TypeError(n+" is not a function!");return n}},function(n){n.exports=function(n,t,i,r){if(!(n instanceof t)||r!==undefined&&r in n)throw TypeError(i+": incorrect invocation!");return n}},function(n,t,i){var f=i(40),e=i(168),o=i(169),s=i(20),h=i(27),c=i(170),r={},u={},t=n.exports=function(n,t,i,l,a){var w=a?function(){return n}:c(n),b=f(i,l,t?2:1),y=0,d,p,k,v;if(typeof w!="function")throw TypeError(n+" is not iterable!");if(o(w)){for(d=h(n.length);d>y;y++)if(v=t?b(s(p=n[y])[0],p[1]):b(n[y]),v===r||v===u)return v}else for(k=w.call(n);!(p=k.next()).done;)if(v=e(k,b,p.value,t),v===r||v===u)return v};t.BREAK=r;t.RETURN=u},function(n){n.exports=!1},function(n,t,i){"use strict";var e=i(17),r=i(5),o=i(38),s=i(70),h=i(42),c=i(73),l=i(72),u=i(12),f=i(25),a=i(92),v=i(58),y=i(236);n.exports=function(n,t,i,p,w,b){var tt=e[n],k=tt,g=w?"set":"add",d=k&&k.prototype,rt={},nt=function(n){var t=d[n];o(d,n,n=="delete"?function(n){return b&&!u(n)?!1:t.call(this,n===0?0:n)}:n=="has"?function(n){return b&&!u(n)?!1:t.call(this,n===0?0:n)}:n=="get"?function(n){return b&&!u(n)?undefined:t.call(this,n===0?0:n)}:n=="add"?function(n){return t.call(this,n===0?0:n),this}:function(n,i){return t.call(this,n===0?0:n,i),this})};if(typeof k=="function"&&(b||d.forEach&&!f(function(){(new k).entries().next()}))){var it=new k,ft=it[g](b?{}:-0,1)!=it,et=f(function(){it.has(1)}),ot=a(function(n){new k(n)}),ut=!b&&f(function(){for(var t=new k,n=5;n--;)t[g](n,n);return!t.has(-0)});ot||(k=t(function(t,i){l(t,k,n);var r=y(new tt,t,k);return i!=undefined&&c(i,w,r[g],r),r}),k.prototype=d,d.constructor=k);(et||ut)&&(nt("delete"),nt("has"),w&&nt("get"));(ut||ft)&&nt(g);b&&d.clear&&delete d.clear}else k=p.getConstructor(t,n,w,g),s(k.prototype,i),h.NEED=!0;return v(k,n),rt[n]=k,r(r.G+r.W+r.F*(k!=tt),rt),b||p.setStrong(k,n,w),k}},function(n,t,i){var u=i(59),f=i(56),e=i(26),o=i(86),s=i(32),h=i(164),r=Object.getOwnPropertyDescriptor;t.f=i(24)?r:function(n,t){if(n=e(n),t=o(t,!0),h)try{return r(n,t)}catch(i){}if(s(n,t))return f(!u.f.call(n,t),n[t])}},function(n,t,i){var r=i(40),u=i(88),f=i(41),e=i(27),o=i(237);n.exports=function(n,t){var s=n==1,l=n==2,a=n==3,i=n==4,h=n==6,v=n==5||h,c=t||o;return function(t,o,y){for(var g=f(t),b=u(g),tt=r(o,y,3),nt=e(b.length),p=0,k=s?c(t,nt):l?c(t,0):undefined,w,d;nt>p;p++)if((v||p in b)&&(w=b[p],d=tt(w,p,g),n))if(s)k[p]=d;else if(d)switch(n){case 3:return!0;case 5:return w;case 6:return p;case 2:k.push(w)}else if(i)return!1;return h?-1:a||i?i:k}}},function(n,t){t.f=Object.getOwnPropertySymbols},function(n,t,i){"use strict";var r=i(39),u=i(38),f=i(25),e=i(47),o=i(16);n.exports=function(n,t,i){var s=o(n),h=i(e,s,""[n]),l=h[0],c=h[1];f(function(){var t={};return t[s]=function(){return 7},""[n](t)!=7})&&(u(String.prototype,n,l),r(RegExp.prototype,s,t==2?function(n,t){return c.call(n,this,t)}:function(n){return c.call(n,this)}))}},function(n,t,i){"use strict";var u=i(52),r=i(174),f=i(57),e=i(26);n.exports=i(172)(Array,"Array",function(n,t){this._t=e(n);this._i=0;this._k=t},function(){var t=this._t,i=this._k,n=this._i++;return!t||n>=t.length?(this._t=undefined,r(1)):i=="keys"?r(0,n):i=="values"?r(0,t[n]):r(0,[n,t[n]])},"values");f.Arguments=f.Array;u("keys");u("values");u("entries")},function(n,t,i){"use strict";function f(n){for(var t=n+1,i="",r=void 0;t>0;)r=(t-1)%u,i=String.fromCharCode(65+r)+i,t=parseInt((t-r)/u,10);return i}function s(n){var i=0,t,r;if(n)for(t=0,r=n.length-1;t<n.length;t+=1,r-=1)i+=Math.pow(u,r)*(e.indexOf(n[t])+1);return--i,i}function h(){for(var u=arguments.length>0&&arguments[0]!==undefined?arguments[0]:100,e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:4,r=[],t,i,n=0;n<u;n++){for(i=[],t=0;t<e;t++)i.push(f(t)+(n+1));r.push(i)}return r}function c(){for(var u=arguments.length>0&&arguments[0]!==undefined?arguments[0]:100,e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:4,r=[],n,i,t=0;t<u;t++){for(i={},n=0;n<e;n++)i["prop"+n]=f(n)+(t+1);r.push(i)}return r}function l(n,t){for(var r,u=[],i=void 0,f=0;f<n;f++){for(i=[],r=0;r<t;r++)i.push("");u.push(i)}return u}function a(n){for(var t,f,r=[],e=0,i=0,u=n.length;i<u;i++)for(t=0,f=n[i].length;t<f;t++)t==e&&(r.push([]),e++),r[t].push(n[i][t]);return r}function v(n,t){return t=typeof t=="undefined"?!0:t,function(i,u){return function f(i){if(i){if(r.hasOwnProperty(i,n)&&i[n]!==void 0)return i[n];if(r.hasOwnProperty(i,"type")&&i.type){var u;if(typeof i.type!="string")throw new Error("Cell type must be a string ");if(u=o.getCellType(i.type),r.hasOwnProperty(u,n))return u[n];if(t)return}}else return;return f(Object.getPrototypeOf(i))}(typeof i=="number"?this.getCellMeta(i,u):i)}}t.__esModule=!0;t.spreadsheetColumnLabel=f;t.spreadsheetColumnIndex=s;t.createSpreadsheetData=h;t.createSpreadsheetObjectData=c;t.createEmptySpreadsheetData=l;t.translateRowsToColumns=a;t.cellMethodLookupFactory=v;var o=i(151),r=i(1),e="ABCDEFGHIJKLMNOPQRSTUVWXYZ",u=e.length},function(n,t,i){"use strict";function o(n){return n&&n.__esModule?n:{"default":n}}function h(n,t){var i=n;return r.isObject(n)&&(t=n,i=t.languageCode),g(i,t),p(i,r.deepClone(t)),r.deepClone(t)}function k(n){return c(n)?r.deepClone(s(n)):null}function c(n){return w(n)}function d(){return f.default}function g(n,t){n!==e&&l.extendNotExistingKeys(t,s(e))}function nt(){return b()}t.__esModule=!0;t.DEFAULT_LANGUAGE_CODE=t.getLanguagesDictionaries=t.getDefaultLanguageDictionary=t.hasLanguageDictionary=t.getLanguageDictionary=t.registerLanguageDictionary=undefined;var r=i(1),l=i(209),a=i(48),v=o(a),y=i(297),f=o(y);var e=f.default.languageCode,u=v.default("languagesDictionaries"),p=u.register,s=u.getItem,w=u.hasItem,b=u.getValues;t.registerLanguageDictionary=h;t.getLanguageDictionary=k;t.hasLanguageDictionary=c;t.getDefaultLanguageDictionary=d;t.getLanguagesDictionaries=nt;t.DEFAULT_LANGUAGE_CODE=e;h(f.default)},function(n,t,i){"use strict";function e(n){return n&&n.__esModule?n:{"default":n}}function a(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var r;t.__esModule=!0;var o=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),u=i(0),f=i(1),s=i(21),h=e(s),c=i(394),l=e(c);r=function(){function n(t){a(this,n);this.hot=t;this.elements=[];this.hidden=!1}return o(n,[{key:"reset",value:function(){u.arrayEach(this.elements,function(n){return n.reset()})}},{key:"hide",value:function(){this.hidden=!0}},{key:"show",value:function(){this.hidden=!1}},{key:"isHidden",value:function(){return this.hidden}},{key:"destroy",value:function(){this.clearLocalHooks();u.arrayEach(this.elements,function(n){return n.destroy()});this.elements=null;this.hot=null}}]),n}();f.mixin(r,h.default);f.mixin(r,l.default);t.default=r},function(n,t,i){"use strict";var r=i(163),f=i(51),u="Map";n.exports=i(75)(u,function(n){return function(){return n(this,arguments.length>0?arguments[0]:undefined)}},{get:function(n){var t=r.getEntry(f(this,u),n);return t&&t.v},set:function(n,t){return r.def(f(this,u),n===0?0:n,t)}},r,!0)},function(n,t,i){var u=i(12),r=i(17).document,f=u(r)&&u(r.createElement);n.exports=function(n){return f?r.createElement(n):{}}},function(n,t,i){var r=i(12);n.exports=function(n,t){if(!r(n))return n;var i,u;if(t&&typeof(i=n.toString)=="function"&&!r(u=i.call(n))||typeof(i=n.valueOf)=="function"&&!r(u=i.call(n))||!t&&typeof(i=n.toString)=="function"&&!r(u=i.call(n)))return u;throw TypeError("Can't convert object to primitive value");}},function(n,t,i){var o=i(20),s=i(234),e=i(91),h=i(89)("IE_PROTO"),u=function(){},f="prototype",r=function(){var t=i(85)("iframe"),u=e.length,o="<",s=">",n;for(t.style.display="none",i(167).appendChild(t),t.src="javascript:",n=t.contentWindow.document,n.open(),n.write(o+"script"+s+"document.F=Object"+o+"/script"+s),n.close(),r=n.F;u--;)delete r[f][e[u]];return r()};n.exports=Object.create||function(n,t){var i;return n!==null?(u[f]=o(n),i=new u,u[f]=null,i[h]=n):i=r(),t===undefined?i:s(i,t)}},function(n,t,i){var r=i(49);n.exports=Object("z").propertyIsEnumerable(0)?Object:function(n){return r(n)=="String"?n.split(""):Object(n)}},function(n,t,i){var r=i(90)("keys"),u=i(55);n.exports=function(n){return r[n]||(r[n]=u(n))}},function(n,t,i){var r=i(17),u="__core-js_shared__",f=r[u]||(r[u]={});n.exports=function(n){return f[n]||(f[n]={})}},function(n){n.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(n,t,i){var r=i(16)("iterator"),f=!1,u;try{u=[7][r]();u["return"]=function(){f=!0};Array.from(u,function(){throw 2;})}catch(e){}n.exports=function(n,t){var u,i,e;if(!t&&!f)return!1;u=!1;try{i=[7];e=i[r]();e.next=function(){return{done:u=!0}};i[r]=function(){return e};n(i)}catch(o){}return u}},function(n,t,i){"use strict";var r=i(163),f=i(51),u="Set";n.exports=i(75)(u,function(n){return function(){return n(this,arguments.length>0?arguments[0]:undefined)}},{add:function(n){return r.def(f(this,u),n=n===0?0:n,n)}},r)},function(n,t,i){"use strict";var v=i(77)(0),y=i(38),e=i(42),p=i(178),r=i(179),o=i(12),w=i(25),s=i(51),u="WeakMap",b=e.getWeak,k=Object.isExtensible,d=r.ufstore,h={},f,c=function(n){return function(){return n(this,arguments.length>0?arguments[0]:undefined)}},l={get:function(n){if(o(n)){var t=b(n);return t===!0?d(s(this,u)).get(n):t?t[this._i]:undefined}},set:function(n,t){return r.def(s(this,u),n,t)}},a=n.exports=i(75)(u,c,l,r,!0,!0);w(function(){return(new a).set((Object.freeze||Object)(h),7).get(h)!=7})&&(f=r.getConstructor(c,u),p(f.prototype,l),e.NEED=!0,v(["delete","has","get","set"],function(n){var t=a.prototype,i=t[n];y(t,n,function(t,r){if(o(t)&&!k(t)){this._f||(this._f=new f);var u=this._f[n](t,r);return n=="set"?this:u}return i.call(this,t,r)})}))},function(n,t,i){"use strict";var r=i(179),f=i(51),u="WeakSet";i(75)(u,function(n){return function(){return n(this,arguments.length>0?arguments[0]:undefined)}},{add:function(n){return r.def(f(this,u),n,!0)}},r,!1,!0)},function(n,t,i){"use strict";var d=i(74),f=i(17),o=i(40),st=i(171),r=i(5),ht=i(12),ct=i(71),lt=i(72),g=i(73),at=i(239),nt=i(97).set,tt=i(241)(),it=i(180),p=i(242),vt=i(243),e="Promise",rt=f.TypeError,a=f.process,u=f[e],h=st(a)=="process",v=function(){},y,ut,ft,w,c=ut=it.f,l=!!function(){try{var n=u.resolve(1),t=(n.constructor={})[i(16)("species")]=function(n){n(v,v)};return(h||typeof PromiseRejectionEvent=="function")&&n.then(v)instanceof t}catch(r){}}(),et=function(n){var t;return ht(n)&&typeof(t=n.then)=="function"?t:!1},b=function(n,t){if(!n._n){n._n=!0;var i=n._c;tt(function(){for(var r=n._v,u=n._s==1,f=0,e=function(t){var o=u?t.ok:t.fail,s=t.resolve,f=t.reject,e=t.domain,i,h;try{o?(u||(n._h==2&&pt(n),n._h=1),o===!0?i=r:(e&&e.enter(),i=o(r),e&&e.exit()),i===t.promise?f(rt("Promise-chain cycle")):(h=et(i))?h.call(i,s,f):s(i)):f(r)}catch(c){f(c)}};i.length>f;)e(i[f++]);n._c=[];n._n=!1;t&&!n._h&&yt(n)})}},yt=function(n){nt.call(f,function(){var t=n._v,u=ot(n),i,e,r;if(u&&(i=p(function(){h?a.emit("unhandledRejection",t,n):(e=f.onunhandledrejection)?e({promise:n,reason:t}):(r=f.console)&&r.error&&r.error("Unhandled promise rejection",t)}),n._h=h||ot(n)?2:1),n._a=undefined,u&&i.e)throw i.v;})},ot=function(n){return n._h!==1&&(n._a||n._c).length===0},pt=function(n){nt.call(f,function(){var t;h?a.emit("rejectionHandled",n):(t=f.onrejectionhandled)&&t({promise:n,reason:n._v})})},s=function(n){var t=this;t._d||(t._d=!0,t=t._w||t,t._v=n,t._s=2,t._a||(t._a=t._c.slice()),b(t,!0))},k=function(n){var t=this,i;if(!t._d){t._d=!0;t=t._w||t;try{if(t===n)throw rt("Promise can't be resolved itself");(i=et(n))?tt(function(){var r={_w:t,_d:!1};try{i.call(n,o(k,r,1),o(s,r,1))}catch(u){s.call(r,u)}}):(t._v=n,t._s=1,b(t,!1))}catch(r){s.call({_w:t,_d:!1},r)}}};l||(u=function(n){lt(this,u,e,"_h");ct(n);y.call(this);try{n(o(k,this,1),o(s,this,1))}catch(t){s.call(this,t)}},y=function(){this._c=[];this._a=undefined;this._s=0;this._d=!1;this._v=undefined;this._h=0;this._n=!1},y.prototype=i(70)(u.prototype,{then:function(n,t){var i=c(at(this,u));return i.ok=typeof n=="function"?n:!0,i.fail=typeof t=="function"&&t,i.domain=h?a.domain:undefined,this._c.push(i),this._a&&this._a.push(i),this._s&&b(this,!1),i.promise},"catch":function(n){return this.then(undefined,n)}}),ft=function(){var n=new y;this.promise=n;this.resolve=o(k,n,1);this.reject=o(s,n,1)},it.f=c=function(n){return n===u||n===w?new ft(n):ut(n)});r(r.G+r.W+r.F*!l,{Promise:u});i(58)(u,e);i(175)(e);w=i(50)[e];r(r.S+r.F*!l,e,{reject:function(n){var t=c(this),i=t.reject;return i(n),t.promise}});r(r.S+r.F*(d||!l),e,{resolve:function(n){return vt(d&&this===w?u:this,n)}});r(r.S+r.F*!(l&&i(92)(function(n){u.all(n)["catch"](v)})),e,{all:function(n){var i=this,t=c(i),r=t.resolve,u=t.reject,f=p(function(){var t=[],e=0,f=1;g(n,!1,function(n){var s=e++,o=!1;t.push(undefined);f++;i.resolve(n).then(function(n){o||(o=!0,t[s]=n,--f||r(t))},u)});--f||r(t)});return f.e&&u(f.v),t.promise},race:function(n){var i=this,t=c(i),r=t.reject,u=p(function(){g(n,!1,function(n){i.resolve(n).then(t.resolve,r)})});return u.e&&r(u.v),t.promise}})},function(n,t,i){var o=i(40),g=i(240),y=i(167),p=i(85),r=i(17),w=r.process,s=r.setImmediate,h=r.clearImmediate,b=r.MessageChannel,c=r.Dispatch,l=0,f={},k="onreadystatechange",u,a,v,e=function(){var n=+this,t;f.hasOwnProperty(n)&&(t=f[n],delete f[n],t())},d=function(n){e.call(n.data)};s&&h||(s=function(n){for(var t=[],i=1;arguments.length>i;)t.push(arguments[i++]);return f[++l]=function(){g(typeof n=="function"?n:Function(n),t)},u(l),l},h=function(n){delete f[n]},i(49)(w)=="process"?u=function(n){w.nextTick(o(e,n,1))}:c&&c.now?u=function(n){c.now(o(e,n,1))}:b?(a=new b,v=a.port2,a.port1.onmessage=d,u=o(v.postMessage,v,1)):r.addEventListener&&typeof postMessage=="function"&&!r.importScripts?(u=function(n){r.postMessage(n+"","*")},r.addEventListener("message",d,!1)):u=k in p("script")?function(n){y.appendChild(p("script"))[k]=function(){y.removeChild(this);e.call(n)}}:function(n){setTimeout(o(e,n,1),0)});n.exports={set:s,clear:h}},function(n,t,i){"use strict";var w=i(17),r=i(32),nt=i(24),e=i(5),yt=i(38),oi=i(42).KEY,pt=i(25),tt=i(90),it=i(58),si=i(55),a=i(16),hi=i(181),ci=i(244),li=i(245),ai=i(177),rt=i(20),vi=i(12),b=i(26),ut=i(86),ft=i(56),v=i(87),wt=i(182),bt=i(76),kt=i(22),yi=i(46),dt=bt.f,c=kt.f,gt=wt.f,u=w.Symbol,k=w.JSON,d=k&&k.stringify,h="prototype",f=a("_hidden"),ni=a("toPrimitive"),pi={}.propertyIsEnumerable,y=tt("symbol-registry"),s=tt("symbols"),p=tt("op-symbols"),o=Object[h],l=typeof u=="function",et=w.QObject,ot=!et||!et[h]||!et[h].findChild,st=nt&&pt(function(){return v(c({},"a",{get:function(){return c(this,"a",{value:7}).a}})).a!=7})?function(n,t,i){var r=dt(o,t);r&&delete o[t];c(n,t,i);r&&n!==o&&c(o,t,r)}:c,ti=function(n){var t=s[n]=v(u[h]);return t._k=n,t},ht=l&&typeof u.iterator=="symbol"?function(n){return typeof n=="symbol"}:function(n){return n instanceof u},g=function(n,t,i){return(n===o&&g(p,t,i),rt(n),t=ut(t,!0),rt(i),r(s,t))?(i.enumerable?(r(n,f)&&n[f][t]&&(n[f][t]=!1),i=v(i,{enumerable:ft(0,!1)})):(r(n,f)||c(n,f,ft(1,{})),n[f][t]=!0),st(n,t,i)):c(n,t,i)},ii=function(n,t){rt(n);for(var i=li(t=b(t)),r=0,f=i.length,u;f>r;)g(n,u=i[r++],t[u]);return n},wi=function(n,t){return t===undefined?v(n):ii(v(n),t)},ri=function(n){var t=pi.call(this,n=ut(n,!0));return this===o&&r(s,n)&&!r(p,n)?!1:t||!r(this,n)||!r(s,n)||r(this,f)&&this[f][n]?t:!0},ui=function(n,t){if(n=b(n),t=ut(t,!0),n!==o||!r(s,t)||r(p,t)){var i=dt(n,t);return!i||!r(s,t)||r(n,f)&&n[f][t]||(i.enumerable=!0),i}},fi=function(n){for(var i=gt(b(n)),u=[],e=0,t;i.length>e;)r(s,t=i[e++])||t==f||t==oi||u.push(t);return u},ei=function(n){for(var i=n===o,u=gt(i?p:b(n)),f=[],e=0,t;u.length>e;)r(s,t=u[e++])&&(i?r(o,t):!0)&&f.push(s[t]);return f},ct,lt,at,vt;for(l||(u=function(){if(this instanceof u)throw TypeError("Symbol is not a constructor!");var n=si(arguments.length>0?arguments[0]:undefined),t=function(i){this===o&&t.call(p,i);r(this,f)&&r(this[f],n)&&(this[f][n]=!1);st(this,n,ft(1,i))};return nt&&ot&&st(o,n,{configurable:!0,set:t}),ti(n)},yt(u[h],"toString",function(){return this._k}),bt.f=ui,kt.f=g,i(99).f=wt.f=fi,i(59).f=ri,i(78).f=ei,nt&&!i(74)&&yt(o,"propertyIsEnumerable",ri,!0),hi.f=function(n){return ti(a(n))}),e(e.G+e.W+e.F*!l,{Symbol:u}),ct="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),lt=0;ct.length>lt;)a(ct[lt++]);for(at=yi(a.store),vt=0;at.length>vt;)ci(at[vt++]);e(e.S+e.F*!l,"Symbol",{"for":function(n){return r(y,n+="")?y[n]:y[n]=u(n)},keyFor:function(n){if(!ht(n))throw TypeError(n+" is not a symbol!");for(var t in y)if(y[t]===n)return t},useSetter:function(){ot=!0},useSimple:function(){ot=!1}});e(e.S+e.F*!l,"Object",{create:wi,defineProperty:g,defineProperties:ii,getOwnPropertyDescriptor:ui,getOwnPropertyNames:fi,getOwnPropertySymbols:ei});k&&e(e.S+e.F*(!l||pt(function(){var n=u();return d([n])!="[null]"||d({a:n})!="{}"||d(Object(n))!="{}"})),"JSON",{stringify:function(n){for(var i=[n],u=1,t,r;arguments.length>u;)i.push(arguments[u++]);if(r=t=i[1],(vi(t)||n!==undefined)&&!ht(n))return ai(t)||(t=function(n,t){return typeof r=="function"&&(t=r.call(this,n,t)),ht(t)?void 0:t}),i[1]=t,d.apply(k,i)}});u[h][ni]||i(39)(u[h],ni,u[h].valueOf);it(u,"Symbol");it(Math,"Math",!0);it(w.JSON,"JSON",!0)},function(n,t,i){var r=i(165),u=i(91).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(n){return r(n,u)}},function(n,t,i){var r=i(12),u=i(42).onFreeze;i(28)("freeze",function(n){return function(t){return n&&r(t)?n(u(t)):t}})},function(n,t,i){var r=i(12),u=i(42).onFreeze;i(28)("seal",function(n){return function(t){return n&&r(t)?n(u(t)):t}})},function(n,t,i){var r=i(12),u=i(42).onFreeze;i(28)("preventExtensions",function(n){return function(t){return n&&r(t)?n(u(t)):t}})},function(n,t,i){var r=i(12);i(28)("isFrozen",function(n){return function(t){return r(t)?n?n(t):!1:!0}})},function(n,t,i){var r=i(12);i(28)("isSealed",function(n){return function(t){return r(t)?n?n(t):!1:!0}})},function(n,t,i){var r=i(12);i(28)("isExtensible",function(n){return function(t){return r(t)?n?n(t):!0:!1}})},function(n,t,i){var r=i(26),u=i(76).f;i(28)("getOwnPropertyDescriptor",function(){return function(n,t){return u(r(n),t)}})},function(n,t,i){var r=i(41),u=i(173);i(28)("getPrototypeOf",function(){return function(n){return u(r(n))}})},function(n,t,i){var r=i(41),u=i(46);i(28)("keys",function(){return function(n){return u(r(n))}})},function(n,t,i){i(28)("getOwnPropertyNames",function(){return i(182).f})},function(n,t,i){var r=i(5);r(r.S+r.F,"Object",{assign:i(178)})},function(n,t,i){var r=i(5);r(r.S,"Object",{is:i(246)})},function(n,t,i){var r=i(5);r(r.S,"Object",{setPrototypeOf:i(176).set})},function(n,t,i){var f=i(22).f,r=Function.prototype,e=/^\s*function ([^ (]*)/,u="name";u in r||i(24)&&f(r,u,{configurable:!0,get:function(){try{return(""+this).match(e)[1]}catch(n){return""}}})},function(n,t,i){var r=i(5),u=i(26),f=i(27);r(r.S,"String",{raw:function(n){for(var r=u(n.raw),e=f(r.length),o=arguments.length,i=[],t=0;e>t;)i.push(String(r[t++])),t<o&&i.push(String(arguments[t]));return i.join("")}})},function(n,t,i){var r=i(5),e=i(69),u=String.fromCharCode,f=String.fromCodePoint;r(r.S+r.F*(!!f&&f.length!=1),"String",{fromCodePoint:function(){for(var t=[],r=arguments.length,i=0,n;r>i;){if(n=+arguments[i++],e(n,1114111)!==n)throw RangeError(n+" is not a valid code point");t.push(n<65536?u(n):u(((n-=65536)>>10)+55296,n%1024+56320))}return t.join("")}})},function(n,t,i){"use strict";var r=i(5),u=i(247)(!1);r(r.P,"String",{codePointAt:function(n){return u(this,n)}})},function(n,t,i){var r=i(5);r(r.P,"String",{repeat:i(183)})},function(n,t,i){"use strict";var r=i(5),e=i(27),o=i(119),u="startsWith",f=""[u];r(r.P+r.F*i(120)(u),"String",{startsWith:function(n){var t=o(this,n,u),i=e(Math.min(arguments.length>1?arguments[1]:undefined,t.length)),r=String(n);return f?f.call(t,r,i):t.slice(i,i+r.length)===r}})},function(n,t,i){var r=i(184),u=i(47);n.exports=function(n,t,i){if(r(t))throw TypeError("String#"+i+" doesn't accept regex!");return String(u(n))}},function(n,t,i){var r=i(16)("match");n.exports=function(n){var t=/./;try{"/./"[n](t)}catch(i){try{return t[r]=!1,!"/./"[n](t)}catch(u){}}return!0}},function(n,t,i){"use strict";var r=i(5),f=i(27),o=i(119),u="endsWith",e=""[u];r(r.P+r.F*i(120)(u),"String",{endsWith:function(n){var t=o(this,n,u),s=arguments.length>1?arguments[1]:undefined,h=f(t.length),i=s===undefined?h:Math.min(f(s),h),r=String(n);return e?e.call(t,r,i):t.slice(i-r.length,i)===r}})},function(n,t,i){"use strict";var r=i(5),f=i(119),u="includes";r(r.P+r.F*i(120)(u),"String",{includes:function(n){return!!~f(this,n,u).indexOf(n,arguments.length>1?arguments[1]:undefined)}})},function(n,t,i){i(24)&&/./g.flags!="g"&&i(22).f(RegExp.prototype,"flags",{configurable:!0,get:i(248)})},function(n,t,i){i(79)("match",1,function(n,t,i){return[function(i){"use strict";var r=n(this),u=i==undefined?undefined:i[t];return u!==undefined?u.call(i,r):new RegExp(i)[t](String(r))},i]})},function(n,t,i){i(79)("replace",2,function(n,t,i){return[function(r,u){"use strict";var f=n(this),e=r==undefined?undefined:r[t];return e!==undefined?e.call(r,f,u):i.call(String(f),r,u)},i]})},function(n,t,i){i(79)("split",2,function(n,t,r){"use strict";var h=i(184),o=r,c=[].push,f="split",u="length",s="lastIndex",e;return"abbc"[f](/(b)*/)[1]=="c"||"test"[f](/(?:)/,-1)[u]!=4||"ab"[f](/(?:ab)*/)[u]!=2||"."[f](/(.?)(.?)/)[u]!=4||"."[f](/()()/)[u]>1||""[f](/.?/)[u]?(e=/()??/.exec("")[1]===undefined,r=function(n,t){var f=String(this);if(n===undefined&&t===0)return[];if(!h(n))return o.call(f,n,t);var r=[],w=(n.ignoreCase?"i":"")+(n.multiline?"m":"")+(n.unicode?"u":"")+(n.sticky?"y":""),l=0,y=t===undefined?4294967295:t>>>0,a=new RegExp(n.source,w+"g"),b,i,p,k,v;for(e||(b=new RegExp("^"+a.source+"$(?!\\s)",w));i=a.exec(f);){if(p=i.index+i[0][u],p>l&&(r.push(f.slice(l,i.index)),!e&&i[u]>1&&i[0].replace(b,function(){for(v=1;v<arguments[u]-2;v++)arguments[v]===undefined&&(i[v]=undefined)}),i[u]>1&&i.index<f[u]&&c.apply(r,i.slice(1)),k=i[0][u],l=p,r[u]>=y))break;a[s]===i.index&&a[s]++}return l===f[u]?(k||!a.test(""))&&r.push(""):r.push(f.slice(l)),r[u]>y?r.slice(0,y):r}):"0"[f](undefined,0)[u]&&(r=function(n,t){return n===undefined&&t===0?[]:o.call(this,n,t)}),[function(i,u){var f=n(this),e=i==undefined?undefined:i[t];return e!==undefined?e.call(i,f,u):r.call(String(f),i,u)},r]})},function(n,t,i){i(79)("search",1,function(n,t,i){return[function(i){"use strict";var r=n(this),u=i==undefined?undefined:i[t];return u!==undefined?u.call(i,r):new RegExp(i)[t](String(r))},i]})},function(n,t,i){"use strict";var f=i(40),r=i(5),e=i(41),o=i(168),s=i(169),h=i(27),u=i(129),c=i(170);r(r.S+r.F*!i(92)(function(n){Array.from(n)}),"Array",{from:function(n){var r=e(n),a=typeof this=="function"?this:Array,k=arguments.length,l=k>1?arguments[1]:undefined,v=l!==undefined,t=0,y=c(r),p,i,w,b;if(v&&(l=f(l,k>2?arguments[2]:undefined,2)),y==undefined||a==Array&&s(y))for(p=h(r.length),i=new a(p);p>t;t++)u(i,t,v?l(r[t],t):r[t]);else for(b=y.call(r),i=new a;!(w=b.next()).done;t++)u(i,t,v?o(b,l,[w.value,t],!0):w.value);return i.length=t,i}})},function(n,t,i){"use strict";var r=i(22),u=i(56);n.exports=function(n,t,i){t in n?r.f(n,t,u(0,i)):n[t]=i}},function(n,t,i){"use strict";var r=i(5),u=i(129);r(r.S+r.F*i(25)(function(){function n(){}return!(Array.of.call(n)instanceof n)}),"Array",{of:function(){for(var n=0,t=arguments.length,i=new(typeof this=="function"?this:Array)(t);t>n;)u(i,n,arguments[n++]);return i.length=t,i}})},function(n,t,i){var r=i(5);r(r.P,"Array",{copyWithin:i(249)});i(52)("copyWithin")},function(n,t,i){"use strict";var r=i(5),e=i(77)(5),u="find",f=!0;u in[]&&Array(1)[u](function(){f=!1});r(r.P+r.F*f,"Array",{find:function(n){return e(this,n,arguments.length>1?arguments[1]:undefined)}});i(52)(u)},function(n,t,i){"use strict";var r=i(5),e=i(77)(6),u="findIndex",f=!0;u in[]&&Array(1)[u](function(){f=!1});r(r.P+r.F*f,"Array",{findIndex:function(n){return e(this,n,arguments.length>1?arguments[1]:undefined)}});i(52)(u)},function(n,t,i){var r=i(5);r(r.P,"Array",{fill:i(250)});i(52)("fill")},function(n,t,i){var r=i(5),u=i(17).isFinite;r(r.S,"Number",{isFinite:function(n){return typeof n=="number"&&u(n)}})},function(n,t,i){var r=i(5);r(r.S,"Number",{isInteger:i(185)})},function(n,t,i){var r=i(5),u=i(185),f=Math.abs;r(r.S,"Number",{isSafeInteger:function(n){return u(n)&&f(n)<=9007199254740991}})},function(n,t,i){var r=i(5);r(r.S,"Number",{isNaN:function(n){return n!=n}})},function(n,t,i){var r=i(5);r(r.S,"Number",{EPSILON:Math.pow(2,-52)})},function(n,t,i){var r=i(5);r(r.S,"Number",{MIN_SAFE_INTEGER:-9007199254740991})},function(n,t,i){var r=i(5);r(r.S,"Number",{MAX_SAFE_INTEGER:9007199254740991})},function(n,t,i){"use strict";var r=i(5),u=i(166)(!0);r(r.P,"Array",{includes:function(n){return u(this,n,arguments.length>1?arguments[1]:undefined)}});i(52)("includes")},function(n,t,i){var r=i(5),u=i(186)(!1);r(r.S,"Object",{values:function(n){return u(n)}})},function(n,t,i){var r=i(5),u=i(186)(!0);r(r.S,"Object",{entries:function(n){return u(n)}})},function(n,t,i){var r=i(5),u=i(251),f=i(26),e=i(76),o=i(129);r(r.S,"Object",{getOwnPropertyDescriptors:function(n){for(var i=f(n),l=e.f,r=u(i),s={},h=0,c,t;r.length>h;)t=l(i,c=r[h++]),t!==undefined&&o(s,c,t);return s}})},function(n,t,i){"use strict";var r=i(5),u=i(187),f=i(188);r(r.P+r.F*/Version\/10\.\d+(\.\d+)? Safari\//.test(f),"String",{padStart:function(n){return u(this,n,arguments.length>1?arguments[1]:undefined,!0)}})},function(n,t,i){"use strict";var r=i(5),u=i(187),f=i(188);r(r.P+r.F*/Version\/10\.\d+(\.\d+)? Safari\//.test(f),"String",{padEnd:function(n){return u(this,n,arguments.length>1?arguments[1]:undefined,!1)}})},function(n,t,i){var r=i(5),u=i(97);r(r.G+r.B,{setImmediate:u.set,clearImmediate:u.clear})},function(n,t,i){for(var o=i(80),b=i(46),k=i(38),d=i(17),s=i(39),h=i(57),c=i(16),l=c("iterator"),a=c("toStringTag"),v=h.Array,y={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},p=b(y),e=0;e<p.length;e++){var u=p[e],g=y[u],w=d[u],r=w&&w.prototype,f;if(r&&(r[l]||s(r,l,v),r[a]||s(r,a,u),h[u]=v,g))for(f in o)r[f]||k(r,f,o[f],!0)}},function(n,t,i){"use strict";function o(n){return n&&n.__esModule?n:{"default":n}}function s(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var u;t.__esModule=!0;var f=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),e=i(61),r=o(e);u=function(){function n(t){var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:t,r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:t;s(this,n);this.highlight=t;this.from=i;this.to=r}return f(n,[{key:"setHighlight",value:function(n){return this.highlight=n,this}},{key:"setFrom",value:function(n){return this.from=n,this}},{key:"setTo",value:function(n){return this.to=n,this}},{key:"isValid",value:function(n){return this.from.isValid(n)&&this.to.isValid(n)}},{key:"isSingle",value:function(){return this.from.row===this.to.row&&this.from.col===this.to.col}},{key:"getHeight",value:function(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}},{key:"getWidth",value:function(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}},{key:"includes",value:function(n){var t=n.row,i=n.col,r=this.getTopLeftCorner(),u=this.getBottomRightCorner();return r.row<=t&&u.row>=t&&r.col<=i&&u.col>=i}},{key:"includesRange",value:function(n){return this.includes(n.getTopLeftCorner())&&this.includes(n.getBottomRightCorner())}},{key:"isEqual",value:function(n){return Math.min(this.from.row,this.to.row)===Math.min(n.from.row,n.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(n.from.row,n.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(n.from.col,n.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(n.from.col,n.to.col)}},{key:"overlaps",value:function(n){return n.isSouthEastOf(this.getTopLeftCorner())&&n.isNorthWestOf(this.getBottomRightCorner())}},{key:"isSouthEastOf",value:function(n){return this.getTopLeftCorner().isSouthEastOf(n)||this.getBottomRightCorner().isSouthEastOf(n)}},{key:"isNorthWestOf",value:function(n){return this.getTopLeftCorner().isNorthWestOf(n)||this.getBottomRightCorner().isNorthWestOf(n)}},{key:"isOverlappingHorizontally",value:function(n){return this.getTopRightCorner().col>=n.getTopLeftCorner().col&&this.getTopRightCorner().col<=n.getTopRightCorner().col||this.getTopLeftCorner().col<=n.getTopRightCorner().col&&this.getTopLeftCorner().col>=n.getTopLeftCorner().col}},{key:"isOverlappingVertically",value:function(n){return this.getBottomRightCorner().row>=n.getTopRightCorner().row&&this.getBottomRightCorner().row<=n.getBottomRightCorner().row||this.getTopRightCorner().row<=n.getBottomRightCorner().row&&this.getTopRightCorner().row>=n.getTopRightCorner().row}},{key:"expand",value:function(n){var t=this.getTopLeftCorner(),i=this.getBottomRightCorner();return n.row<t.row||n.col<t.col||n.row>i.row||n.col>i.col?(this.from=new r.default(Math.min(t.row,n.row),Math.min(t.col,n.col)),this.to=new r.default(Math.max(i.row,n.row),Math.max(i.col,n.col)),!0):!1}},{key:"expandByRange",value:function(n){if(this.includesRange(n)||!this.overlaps(n))return!1;var t=this.getTopLeftCorner(),i=this.getBottomRightCorner(),e=this.getDirection(),u=n.getTopLeftCorner(),f=n.getBottomRightCorner(),o=Math.min(t.row,u.row),s=Math.min(t.col,u.col),h=Math.max(i.row,f.row),c=Math.max(i.col,f.col),l=new r.default(o,s),a=new r.default(h,c);return this.from=l,this.to=a,this.setDirection(e),this.highlight.row===this.getBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally(),!0}},{key:"getDirection",value:function(){return this.from.isNorthWestOf(this.to)?"NW-SE":this.from.isNorthEastOf(this.to)?"NE-SW":this.from.isSouthEastOf(this.to)?"SE-NW":this.from.isSouthWestOf(this.to)?"SW-NE":void 0}},{key:"getVerticalDirection",value:function(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}},{key:"getHorizontalDirection",value:function(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}},{key:"setDirection",value:function(n){var t,i,r,u;switch(n){case"NW-SE":t=[this.getTopLeftCorner(),this.getBottomRightCorner()];this.from=t[0];this.to=t[1];break;case"NE-SW":i=[this.getTopRightCorner(),this.getBottomLeftCorner()];this.from=i[0];this.to=i[1];break;case"SE-NW":r=[this.getBottomRightCorner(),this.getTopLeftCorner()];this.from=r[0];this.to=r[1];break;case"SW-NE":u=[this.getBottomLeftCorner(),this.getTopRightCorner()];this.from=u[0];this.to=u[1]}}},{key:"flipDirectionVertically",value:function(){var n=this.getDirection();switch(n){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE")}}},{key:"flipDirectionHorizontally",value:function(){var n=this.getDirection();switch(n){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW")}}},{key:"getTopLeftCorner",value:function(){return new r.default(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"getBottomRightCorner",value:function(){return new r.default(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getTopRightCorner",value:function(){return new r.default(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getBottomLeftCorner",value:function(){return new r.default(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"isCorner",value:function(n,t){return t&&t.includes(n)&&(this.getTopLeftCorner().isEqual(new r.default(t.from.row,t.from.col))||this.getTopRightCorner().isEqual(new r.default(t.from.row,t.to.col))||this.getBottomLeftCorner().isEqual(new r.default(t.to.row,t.from.col))||this.getBottomRightCorner().isEqual(new r.default(t.to.row,t.to.col)))?!0:n.isEqual(this.getTopLeftCorner())||n.isEqual(this.getTopRightCorner())||n.isEqual(this.getBottomLeftCorner())||n.isEqual(this.getBottomRightCorner())}},{key:"getOppositeCorner",value:function(n,t){if(!(n instanceof r.default))return!1;if(t&&t.includes(n)){if(this.getTopLeftCorner().isEqual(new r.default(t.from.row,t.from.col)))return this.getBottomRightCorner();if(this.getTopRightCorner().isEqual(new r.default(t.from.row,t.to.col)))return this.getBottomLeftCorner();if(this.getBottomLeftCorner().isEqual(new r.default(t.to.row,t.from.col)))return this.getTopRightCorner();if(this.getBottomRightCorner().isEqual(new r.default(t.to.row,t.to.col)))return this.getTopLeftCorner()}return n.isEqual(this.getBottomRightCorner())?this.getTopLeftCorner():n.isEqual(this.getTopLeftCorner())?this.getBottomRightCorner():n.isEqual(this.getTopRightCorner())?this.getBottomLeftCorner():n.isEqual(this.getBottomLeftCorner())?this.getTopRightCorner():void 0}},{key:"getBordersSharedWith",value:function(n){if(!this.includesRange(n))return[];var i={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},r={top:Math.min(n.from.row,n.to.row),bottom:Math.max(n.from.row,n.to.row),left:Math.min(n.from.col,n.to.col),right:Math.max(n.from.col,n.to.col)},t=[];return i.top==r.top&&t.push("top"),i.right==r.right&&t.push("right"),i.bottom==r.bottom&&t.push("bottom"),i.left==r.left&&t.push("left"),t}},{key:"getInner",value:function(){for(var n,i=this.getTopLeftCorner(),u=this.getBottomRightCorner(),f=[],t=i.row;t<=u.row;t++)for(n=i.col;n<=u.col;n++)this.from.row===t&&this.from.col===n||this.to.row===t&&this.to.col===n||f.push(new r.default(t,n));return f}},{key:"getAll",value:function(){for(var n,t=this.getTopLeftCorner(),i=this.getBottomRightCorner(),f=[],u=t.row;u<=i.row;u++)for(n=t.col;n<=i.col;n++)t.row===u&&t.col===n?f.push(t):i.row===u&&i.col===n?f.push(i):f.push(new r.default(u,n));return f}},{key:"forAll",value:function(n){for(var t,f,r=this.getTopLeftCorner(),u=this.getBottomRightCorner(),i=r.row;i<=u.row;i++)for(t=r.col;t<=u.col;t++)if(f=n(i,t),f===!1)return}},{key:"toObject",value:function(){return{from:this.from.toObject(),to:this.to.toObject()}}}]),n}();t.default=u},function(n,t,i){"use strict";function r(n){return n&&n.__esModule?n:{"default":n}}function vt(n){if(!e(n))throw Error('You declared cell type "'+n+'" as a string that is not mapped to a known object.\n                 Cell type must be an object or a string mapped to an object registered by "Handsontable.cellTypes.registerCellType" method');return ct(n)}function u(n,t){var i=t.editor,r=t.renderer,u=t.validator;i&&h.registerEditor(n,i);r&&c.registerRenderer(n,r);u&&l.registerValidator(n,u);ht(n,t)}t.__esModule=!0;t.getRegisteredCellTypes=t.getRegisteredCellTypeNames=t.hasCellType=t.getCellType=t.registerCellType=undefined;var o=i(48),s=r(o),h=i(19),c=i(15),l=i(36),a=i(282),v=r(a),y=i(283),p=r(y),w=i(284),b=r(w),k=i(285),d=r(k),g=i(286),nt=r(g),tt=i(287),it=r(tt),rt=i(288),ut=r(rt),ft=i(289),et=r(ft),ot=i(290),st=r(ot);var f=s.default("cellTypes"),ht=f.register,ct=f.getItem,e=f.hasItem,lt=f.getNames,at=f.getValues;u("autocomplete",v.default);u("checkbox",p.default);u("date",b.default);u("dropdown",d.default);u("handsontable",nt.default);u("numeric",it.default);u("password",ut.default);u("text",et.default);u("time",st.default);t.registerCellType=u;t.getCellType=vt;t.hasCellType=e;t.getRegisteredCellTypeNames=lt;t.getRegisteredCellTypes=at},function(n,t,i){"use strict";function v(n){return n&&n.__esModule?n:{"default":n}}function ui(n,t){return Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(t)}}))}function a(n){if(Array.isArray(n)){for(var t=0,i=Array(n.length);t<n.length;t++)i[t]=n[t];return i}return Array.from(n)}function fi(n,t){function pi(n){var t=d.normalizeLanguageCode(n);ii.hasLanguageDictionary(t)?(i.runHooks("beforeLanguageChange",t),vt.prototype.language=t,i.runHooks("afterLanguageChange",t)):d.warnUserAboutLanguageRegistration(n)}function oi(){var n=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue:function(){this.validatorsInQueue++;n=!1},removeValidatorFormQueue:function(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1;this.checkIfQueueIsEmpty()},onQueueEmpty:function(){},checkIfQueueIsEmpty:function(){if(this.validatorsInQueue==0&&n==!1){n=!0;this.onQueueEmpty(this.valid)}}}}function wi(n){var t=n.replace(",",".");return isNaN(parseFloat(t))===!1?parseFloat(t):n}function si(n,t,r){function w(){var u;n.length&&(u=i.runHooks("beforeChange",n,t||"edit"),e.isFunction(u)?console.warn("Your beforeChange callback returns a function. It's not supported since Handsontable 0.12.1 (and the returned function will not be executed)."):u===!1&&n.splice(0,n.length));r()}var f=new oi,a=function(n){return n.length>0&&/^-?[\d\s]*(\.|,)?\d*$/.test(n)},u;for(f.onQueueEmpty=w,u=n.length-1;u>=0;u--)if(n[u]===null)n.splice(u,1);else{var c=h(n[u],4),v=c[0],y=c[1],l=c[3],p=rt.propToCol(y),o=i.getCellMeta(v,p);o.type==="numeric"&&typeof l=="string"&&a(l)&&(n[u][3]=wi(l));i.getCellValidator(o)&&(f.addValidatorToQueue(),i.validateCell(n[u][3],o,function(t,r){return function(u){if(typeof u!="boolean")throw new Error("Validation error: result is not boolean");if(u===!1&&r.allowInvalid===!1){n.splice(t,1);r.valid=!0;var e=i.getCell(r.visualRow,r.visualCol);s.removeClass(e,i.getSettings().invalidCellClassName);--t}f.removeValidatorFormQueue()}}(u,o),t))}f.checkIfQueueIsEmpty()}function hi(n,t){var r=n.length-1,f,e,u;if(!(r<0)){for(;r>=0;r--){if(f=!1,n[r]===null){n.splice(r,1);continue}if(n[r][2]!=null||n[r][3]!=null){if(v.settings.allowInsertRow)while(n[r][0]>i.countRows()-1)if(e=rt.createRow(void 0,void 0,t),e===0){f=!0;break}if(!f){if(i.dataType==="array"&&(!v.settings.columns||v.settings.columns.length===0)&&v.settings.allowInsertColumn)while(rt.propToCol(n[r][1])>i.countCols()-1)rt.createCol(void 0,void 0,t);rt.set(n[r][0],n[r][1],n[r][3])}}}i.forceFullRender=!0;ui.adjustRowsAndCols();i.runHooks("beforeChangeRender",n,t);kt.lockEditor();i._refreshBorders(null);kt.unlockEditor();i.view.wt.wtOverlays.adjustElementsSize();i.runHooks("afterChange",n,t||"edit");u=i.getActiveEditor();u&&o.isDefined(u.refreshValue)&&u.refreshValue()}}function ci(n,t,i){return(typeof n=="undefined"?"undefined":f(n))==="object"?n:[[n,t,i]]}function fi(n){var t,u,i;if(r.hasOwnProperty(n,"type")){u={};f(n.type)==="object"?t=n.type:typeof n.type=="string"&&(t=ni.getCellType(n.type));for(i in t)r.hasOwnProperty(t,i)&&!r.hasOwnProperty(n,i)&&(u[i]=t[i]);return u}}function bi(){throw new Error("This method cannot be called because this Handsontable instance has been destroyed");}var ft=this,vi=arguments.length>2&&arguments[2]!==undefined?arguments[2]:!1,v,rt,pt,ui,kt,ei=!1,i=this,vt=function(){},yi=new g.default(i),dt,ot,li,ai;r.extend(vt.prototype,gt.default.prototype);r.extend(vt.prototype,t);r.extend(vt.prototype,fi(t));d.applyLanguageSetting(vt.prototype,t.language);w.hasValidParameter(vi)&&w.registerAsRootInstance(this);nt.startObserving();this.rootElement=n;this.isHotTableEnv=s.isChildOfWebComponentTable(this.rootElement);g.default.isHotTableEnv=this.isHotTableEnv;this.container=document.createElement("div");this.renderCall=!1;n.insertBefore(this.container,n.firstChild);!0&&w.isRootInstance(this)&&o._injectProductInfo(t.licenseKey,n);this.guid="ht_"+at.randomString();dt=bt.getTranslator(i);pt=new wt.default(i);this.rootElement.id&&this.rootElement.id.substring(0,3)!=="ht_"||(this.rootElement.id=this.guid);v={cellSettings:[],columnSettings:[],columnsSettingConflicts:["data","width","language"],settings:new vt,selRange:null,isPopulated:null,scrollable:null,firstRun:!0};ot=new ri.Selection(v.settings,{countCols:function(){return i.countCols()},countRows:function(){return i.countRows()},propToCol:function(n){return rt.propToCol(n)},isEditorOpened:function(){return i.getActiveEditor()?i.getActiveEditor().isOpened():!1}});this.selection=ot;this.selection.addLocalHook("beforeSetRangeStart",function(n){ft.runHooks("beforeSetRangeStart",n)});this.selection.addLocalHook("beforeSetRangeStartOnly",function(n){ft.runHooks("beforeSetRangeStartOnly",n)});this.selection.addLocalHook("beforeSetRangeEnd",function(n){ft.runHooks("beforeSetRangeEnd",n);n.row<0&&(n.row=ft.view.wt.wtTable.getFirstVisibleRow());n.col<0&&(n.col=ft.view.wt.wtTable.getFirstVisibleColumn())});this.selection.addLocalHook("afterSetRangeEnd",function(n){var t=r.createObjectPropListener(!1),c=ft.selection.getSelectedRange(),l=c.current(),u=l.from,f=l.to,a=c.size()-1,o,h,e;ft.runHooks("afterSelection",u.row,u.col,f.row,f.col,t,a);ft.runHooks("afterSelectionByProp",u.row,i.colToProp(u.col),f.row,i.colToProp(f.col),t,a);o=!1;h=!0;(ft.selection.selectedHeader.cols||ft.selection.selectedHeader.rows)&&(o=!0);(n.row<0||n.col<0)&&(h=!1);e=!0;ei&&(e=!1);t.isTouched()&&(e=!t.value);e!==!1&&!o&&h&&(ft.selection.selectedRange.current().from&&!ft.selection.isMultiple()?ft.view.scrollViewport(ft.selection.selectedRange.current().from):ft.view.scrollViewport(n));ft.selection.selectedHeader.rows&&ft.selection.selectedHeader.cols?s.addClass(ft.rootElement,["ht__selection--rows","ht__selection--columns"]):ft.selection.selectedHeader.rows?(s.removeClass(ft.rootElement,"ht__selection--columns"),s.addClass(ft.rootElement,"ht__selection--rows")):ft.selection.selectedHeader.cols?(s.removeClass(ft.rootElement,"ht__selection--rows"),s.addClass(ft.rootElement,"ht__selection--columns")):s.removeClass(ft.rootElement,["ht__selection--rows","ht__selection--columns"]);ft._refreshBorders(null)});this.selection.addLocalHook("afterSelectionFinished",function(n){var u=n.length-1,f=n[u],t=f.from,r=f.to;ft.runHooks("afterSelectionEnd",t.row,t.col,r.row,r.col,u);ft.runHooks("afterSelectionEndByProp",t.row,i.colToProp(t.col),r.row,i.colToProp(r.col),u)});this.selection.addLocalHook("afterIsMultipleSelection",function(n){var t=ft.runHooks("afterIsMultipleSelection",n.value);n.value&&(n.value=t)});this.selection.addLocalHook("beforeModifyTransformStart",function(n){ft.runHooks("modifyTransformStart",n)});this.selection.addLocalHook("afterModifyTransformStart",function(n,t,i){ft.runHooks("afterModifyTransformStart",n,t,i)});this.selection.addLocalHook("beforeModifyTransformEnd",function(n){ft.runHooks("modifyTransformEnd",n)});this.selection.addLocalHook("afterModifyTransformEnd",function(n,t,i){ft.runHooks("afterModifyTransformEnd",n,t,i)});this.selection.addLocalHook("afterDeselect",function(){kt.destroyEditor();ft._refreshBorders();s.removeClass(ft.rootElement,["ht__selection--rows","ht__selection--columns"]);ft.runHooks("afterDeselect")});this.selection.addLocalHook("insertRowRequire",function(n){ft.alter("insert_row",n,1,"auto")});this.selection.addLocalHook("insertColRequire",function(n){ft.alter("insert_col",n,1,"auto")});ui={alter:function(n,t,r,u,f){function k(n,t,i,r){var f=function(){var n=void 0;return r==="array"?n=[]:r==="object"&&(n={}),n},u=c.arrayMap(new Array(i),function(){return f()});u.unshift(t,0);n.splice.apply(n,a(u))}var e,l,y,s,d,p,w,b;r=r||1;l=function(n){var t;return n.length===0?[]:(t=[].concat(a(n)),t.sort(function(n,t){var u=h(n,1),i=u[0],f=h(t,1),r=f[0];return i===r?0:i>r?1:-1}),c.arrayReduce(t,function(n,t){var r=h(t,2),i=r[0],u=r[1],f=n[n.length-1],e=h(f,2),c=e[0],l=e[1],o=c+l,s;return i<=o?(s=Math.max(u-(o-i),0),f[1]+=s):n.push([i,u]),n},[t[0]]))};switch(n){case"insert_row":if(y=i.countSourceRows(),i.getSettings().maxRows===y)return;t=o.isDefined(t)?t:y;e=rt.createRow(t,r,u);k(v.cellSettings,t,r,"array");e&&(ot.isSelected()&&ot.selectedRange.current().from.row>=t?(ot.selectedRange.current().from.row+=e,ot.transformEnd(e,0)):i._refreshBorders());break;case"insert_col":for(e=rt.createCol(t,r,u),s=0,d=i.countSourceRows();s<d;s++)v.cellSettings[s]&&k(v.cellSettings[s],t,r);e&&(Array.isArray(i.getSettings().colHeaders)&&(p=[t,0],p.length+=e,Array.prototype.splice.apply(i.getSettings().colHeaders,p)),ot.isSelected()&&ot.selectedRange.current().from.col>=t?(ot.selectedRange.current().from.col+=e,ot.transformEnd(0,e)):i._refreshBorders());break;case"remove_row":w=function(n){var t=0;c.arrayEach(n,function(n){var l=h(n,2),r=l[0],f=l[1],e=o.isEmpty(r)?i.countRows()-1:Math.max(r-t,0),a,c,s;Number.isInteger(r)&&(r=Math.max(r-t,0));rt.removeRow(r,f,u);v.cellSettings.splice(e,f);a=i.countRows();c=i.getSettings().fixedRowsTop;c>=e+1&&(i.getSettings().fixedRowsTop-=Math.min(f,c-e));s=i.getSettings().fixedRowsBottom;s&&e>=a-s&&(i.getSettings().fixedRowsBottom-=Math.min(f,s));t+=f})};Array.isArray(t)?w(l(t)):w([[t,r]]);ui.adjustRowsAndCols();i._refreshBorders();break;case"remove_col":b=function(n){var t=0;c.arrayEach(n,function(n){var a=h(n,2),r=a[0],f=a[1],c=o.isEmpty(r)?i.countCols()-1:Math.max(r-t,0),s=dt.toPhysicalColumn(c),e,y,l;for(Number.isInteger(r)&&(r=Math.max(r-t,0)),rt.removeCol(r,f,u),e=0,y=i.countSourceRows();e<y;e++)v.cellSettings[e]&&v.cellSettings[e].splice(s,f);l=i.getSettings().fixedColumnsLeft;l>=c+1&&(i.getSettings().fixedColumnsLeft-=Math.min(f,l-c));Array.isArray(i.getSettings().colHeaders)&&(typeof s=="undefined"&&(s=-1),i.getSettings().colHeaders.splice(s,f));t+=f})};Array.isArray(t)?b(l(t)):b([[t,r]]);ui.adjustRowsAndCols();i._refreshBorders();break;default:throw new Error('There is no such action "'+n+'"');}f||ui.adjustRowsAndCols()},adjustRowsAndCols:function(){var f,e,o,u,n,t,r;if(v.settings.minRows&&(f=i.countRows(),f<v.settings.minRows))for(e=0,o=v.settings.minRows;e<o-f;e++)rt.createRow(i.countRows(),1,"auto");if(v.settings.minSpareRows&&(u=i.countEmptyRows(!0),u<v.settings.minSpareRows))for(;u<v.settings.minSpareRows&&i.countSourceRows()<v.settings.maxRows;u++)rt.createRow(i.countRows(),1,"auto");if(n=void 0,(v.settings.minCols||v.settings.minSpareCols)&&(n=i.countEmptyCols(!0)),v.settings.minCols&&!v.settings.columns&&i.countCols()<v.settings.minCols)for(;i.countCols()<v.settings.minCols;n++)rt.createCol(i.countCols(),1,"auto");if(v.settings.minSpareCols&&!v.settings.columns&&i.dataType==="array"&&n<v.settings.minSpareCols)for(;n<v.settings.minSpareCols&&i.countCols()<v.settings.maxCols;n++)rt.createCol(i.countCols(),1,"auto");t=i.countRows();r=i.countCols();(t===0||r===0)&&ot.deselect();ot.isSelected()&&c.arrayEach(ot.selectedRange,function(n){var s=!1,u=n.from.row,f=n.from.col,e=n.to.row,o=n.to.col;u>t-1?(u=t-1,s=!0,e>u&&(e=u)):e>t-1&&(e=t-1,s=!0,u>e&&(u=e));f>r-1?(f=r-1,s=!0,o>f&&(o=f)):o>r-1&&(o=r-1,s=!0,f>o&&(f=o));s&&i.selectCell(u,f,e,o)});i.view&&i.view.wt.wtOverlays.adjustElementsSize()},populateFromArray:function(n,t,u,e,s,h,c){var y,b,w,k,ht=[],l={},it,rt,ct,lt,ii,at,vt,yt,pt,ut,ni,ti;if(b=t.length,b===0)return!1;ii={row:u===null?null:u.row,col:u===null?null:u.col};switch(s){case"shift_down":for(it=u?u.col-n.col+1:0,rt=u?u.row-n.row+1:0,t=p.translateRowsToColumns(t),w=0,k=t.length,ct=Math.max(k,it);w<ct;w++)if(w<k){for(y=0,b=t[w].length;y<rt-b;y++)t[w].push(t[w][y%b]);t[w].unshift(n.col+w,n.row,0);(at=i).spliceCol.apply(at,a(t[w]))}else t[w%k][0]=n.col+w,(vt=i).spliceCol.apply(vt,a(t[w%k]));break;case"shift_right":for(it=u?u.col-n.col+1:0,rt=u?u.row-n.row+1:0,y=0,b=t.length,lt=Math.max(b,rt);y<lt;y++)if(y<b){for(w=0,k=t[y].length;w<it-k;w++)t[y].push(t[y][w%k]);t[y].unshift(n.row+y,n.col,0);(yt=i).spliceRow.apply(yt,a(t[y]))}else t[y%b][0]=n.row+y,(pt=i).spliceRow.apply(pt,a(t[y%b]));break;case"overwrite":default:l.row=n.row;l.col=n.col;var ri={row:u&&n?u.row-n.row+1:1,col:u&&n?u.col-n.col+1:1},wt=0,ft=0,nt=!0,tt=void 0,bt=function(n){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null,i=t[n%t.length];return r!==null?i[r%i.length]:i},kt=t.length,et=u?u.row-n.row+1:0;for(b=u?et:Math.max(kt,et),y=0;y<b;y++){if(u&&l.row>u.row&&et>kt||!v.settings.allowInsertRow&&l.row>i.countRows()-1||l.row>=v.settings.maxRows)break;var ot=y-wt,dt=bt(ot).length,st=u?u.col-n.col+1:0;if(k=u?st:Math.max(dt,st),l.col=n.col,tt=i.getCellMeta(l.row,l.col),(e==="CopyPaste.paste"||e==="Autofill.autofill")&&tt.skipRowOnPaste){wt++;l.row++;b++;continue}for(ft=0,w=0;w<k;w++){if(u&&l.col>u.col&&st>dt||!v.settings.allowInsertColumn&&l.col>i.countCols()-1||l.col>=v.settings.maxCols)break;if(tt=i.getCellMeta(l.row,l.col),(e==="CopyPaste.paste"||e==="Autofill.fill")&&tt.skipColumnOnPaste){ft++;l.col++;k++;continue}if(tt.readOnly){l.col++;continue}var gt=w-ft,d=bt(ot,gt),g=i.getDataAtCell(l.row,l.col),ui={row:ot,col:gt};e==="Autofill.fill"&&(ut=i.runHooks("beforeAutofillInsidePopulate",ui,h,t,c,{},ri),ut&&(d=o.isUndefined(ut.value)?d:ut.value));d!==null&&(typeof d=="undefined"?"undefined":f(d))==="object"?g===null||(typeof g=="undefined"?"undefined":f(g))!=="object"?nt=!1:(ni=r.duckSchema(g[0]||g),ti=r.duckSchema(d[0]||d),r.isObjectEqual(ni,ti)?d=r.deepClone(d):nt=!1):g!==null&&(typeof g=="undefined"?"undefined":f(g))==="object"&&(nt=!1);nt&&ht.push([l.row,l.col,d]);nt=!0;l.col++}l.row++}i.setDataAtCell(ht,null,null,e||"populateFromArray")}}};this.init=function(){pt.setData(v.settings.data);i.runHooks("beforeInit");it.isMobileBrowser()&&s.addClass(i.rootElement,"mobile");this.updateSettings(v.settings,!0);this.view=new yt.default(this);kt=et.default.getInstance(i,v,ot,rt);this.forceFullRender=!0;i.runHooks("init");this.view.render();f(v.firstRun)==="object"&&(i.runHooks("afterChange",v.firstRun[0],v.firstRun[1]),v.firstRun=!1);i.runHooks("afterInit")};this.validateCell=function(n,t,r,u){function s(n){var o=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!0;if(!o||t.hidden===!0){r(n);return}var f=t.visualCol,e=t.visualRow,u=i.getCell(e,f,!0);u&&u.nodeName!="TH"&&i.view.wt.wtSettings.settings.cellRenderer(e,f,u);r(n)}var f=i.getCellValidator(t);o.isRegExp(f)&&(f=function(n){return function(t,i){i(n.test(t))}}(f));e.isFunction(f)?(n=i.runHooks("beforeValidate",n,t.visualRow,t.prop,u),i._registerTimeout(setTimeout(function(){f.call(t,n,function(r){r=i.runHooks("afterValidate",r,n,t.visualRow,t.prop,u);t.valid=r;s(r);i.runHooks("postAfterValidate",r,n,t.visualRow,t.prop,u)})},0))):i._registerTimeout(setTimeout(function(){t.valid=!0;s(t.valid,!1)},0))};this.setDataAtCell=function(n,t,r,u){for(var o=ci(n,t,r),s=[],c,e=0,h=o.length;e<h;e++){if(f(o[e])!=="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof o[e][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");c=rt.colToProp(o[e][1]);s.push([o[e][0],c,pt.getAtCell(dt.toPhysicalRow(o[e][0]),o[e][1]),o[e][2]])}u||(typeof n=="undefined"?"undefined":f(n))!=="object"||(u=t);i.runHooks("afterSetDataAtCell",s,u);si(s,u,function(){hi(s,u)})};this.setDataAtRowProp=function(n,t,r,u){for(var o=ci(n,t,r),s=[],e=0,h=o.length;e<h;e++)s.push([o[e][0],o[e][1],pt.getAtCell(dt.toPhysicalRow(o[e][0]),o[e][1]),o[e][2]]);u||(typeof n=="undefined"?"undefined":f(n))!=="object"||(u=t);i.runHooks("afterSetDataAtRowProp",s,u);si(s,u,function(){hi(s,u)})};this.listen=function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:!0,n;t&&(n=!document.activeElement||document.activeElement&&document.activeElement.nodeName===void 0,document.activeElement&&document.activeElement!==document.body&&!n?document.activeElement.blur():n&&document.body.focus());i&&!i.isListening()&&(b=i.guid,i.runHooks("afterListen"))};this.unlisten=function(){this.isListening()&&(b=null,i.runHooks("afterUnlisten"))};this.isListening=function(){return b===i.guid};this.destroyEditor=function(n){i._refreshBorders(n)};this.populateFromArray=function(n,t,i,r,e,o,s,h,c){var l;if(!((typeof i=="undefined"?"undefined":f(i))==="object"&&f(i[0])==="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");return l=typeof r=="number"?new u.CellCoords(r,e):null,ui.populateFromArray(new u.CellCoords(n,t),i,l,o,s,h,c)};this.spliceCol=function(){var n;return(n=rt).spliceCol.apply(n,arguments)};this.spliceRow=function(){var n;return(n=rt).spliceRow.apply(n,arguments)};this.getSelected=function(){if(ot.isSelected())return c.arrayMap(ot.getSelectedRange(),function(n){var t=n.from,i=n.to;return[t.row,t.col,i.row,i.col]})};this.getSelectedLast=function(){var n=this.getSelected(),t=void 0;return n&&n.length>0&&(t=n[n.length-1]),t};this.getSelectedRange=function(){if(ot.isSelected())return Array.from(ot.getSelectedRange())};this.getSelectedRangeLast=function(){var n=this.getSelectedRange(),t=void 0;return n&&n.length>0&&(t=n[n.length-1]),t};this.emptySelectedCells=function(){var t=this,n;ot.isSelected()&&(n=[],c.arrayEach(ot.getSelectedRange(),function(i){var r=i.getTopLeftCorner(),u=i.getBottomRightCorner();y.rangeEach(r.row,u.row,function(i){y.rangeEach(r.col,u.col,function(r){t.getCellMeta(i,r).readOnly||n.push([i,r,""])})})}),n.length>0&&this.setDataAtCell(n))};this.render=function(){i.view&&(i.renderCall=!0,i.forceFullRender=!0,kt.lockEditor(),i._refreshBorders(null),kt.unlockEditor())};this.loadData=function(n){function l(){v.cellSettings.length=0}var o,c;if(i.dataType=Array.isArray(v.settings.dataSchema)?"array":e.isFunction(v.settings.dataSchema)?"function":"object",rt&&rt.destroy(),rt=new ut.default(i,v,vt),(typeof n=="undefined"?"undefined":f(n))==="object"&&n!==null)n.push&&n.splice||(n=[n]);else if(n===null){n=[];for(var t,u=0,s=0,h=rt.getSchema(),u=0,s=v.settings.startRows;u<s;u++)if((i.dataType==="object"||i.dataType==="function")&&v.settings.dataSchema)t=r.deepClone(h),n.push(t);else if(i.dataType==="array")t=r.deepClone(h[0]),n.push(t);else{for(t=[],o=0,c=v.settings.startCols;o<c;o++)t.push(null);n.push(t)}}else throw new Error("loadData only accepts array of objects or array of arrays ("+(typeof n=="undefined"?"undefined":f(n))+" given)");v.isPopulated=!1;vt.prototype.data=n;Array.isArray(n[0])&&(i.dataType="array");rt.dataSource=n;pt.data=n;pt.dataType=i.dataType;pt.colToProp=rt.colToProp.bind(rt);pt.propToCol=rt.propToCol.bind(rt);l();ui.adjustRowsAndCols();i.runHooks("afterLoadData",v.firstRun);v.firstRun?v.firstRun=[null,"loadData"]:(i.runHooks("afterChange",null,"loadData"),i.render());v.isPopulated=!0};this.getData=function(n,t,i,r){return o.isUndefined(n)?rt.getAll():rt.getRange(new u.CellCoords(n,t),new u.CellCoords(i,r),rt.DESTINATION_RENDERER)};this.getCopyableText=function(n,t,i,r){return rt.getCopyableText(new u.CellCoords(n,t),new u.CellCoords(i,r))};this.getCopyableData=function(n,t){return rt.getCopyable(n,rt.colToProp(t))};this.getSchema=function(){return rt.getSchema()};this.updateSettings=function(n,t){var nt=!1,u=void 0,c=void 0,b=void 0,h,d,a,tt,g,y,f,it,p,w;if(o.isDefined(n.rows))throw new Error('"rows" setting is no longer supported. do you mean startRows, minRows or maxRows?');if(o.isDefined(n.cols))throw new Error('"cols" setting is no longer supported. do you mean startCols, minCols or maxCols?');for(u in n)if(u==="data")continue;else if(u==="language"){pi(n.language);continue}else l.default.getSingleton().getRegistered().indexOf(u)>-1?(e.isFunction(n[u])||Array.isArray(n[u]))&&(n[u].initialHook=!0,i.addHook(u,n[u])):!t&&r.hasOwnProperty(n,u)&&(vt.prototype[u]=n[u]);if(n.data===void 0&&v.settings.data===void 0?i.loadData(null):n.data!==void 0?i.loadData(n.data):n.columns!==void 0&&rt.createMap(),b=i.countCols(),h=n.columns||vt.prototype.columns,h&&e.isFunction(h)&&(b=i.countSourceCols(),nt=!0),(n.cell!==void 0||n.cells!==void 0||n.columns!==void 0)&&(v.cellSettings.length=0),b>0)for(d=void 0,a=void 0,u=0,c=0;u<b;u++)(!nt||h(u))&&(v.columnSettings[c]=k.columnFactory(vt,v.columnsSettingConflicts),d=v.columnSettings[c].prototype,h&&(a=nt?h(u):h[c],a&&(r.extend(d,a),r.extend(d,fi(a)))),c++);if(o.isDefined(n.cell))for(tt in n.cell)r.hasOwnProperty(n.cell,tt)&&(g=n.cell[tt],i.setCellMetaObject(g.row,g.col,g));i.runHooks("afterCellMetaReset");o.isDefined(n.className)&&(vt.prototype.className&&s.removeClass(i.rootElement,vt.prototype.className),n.className&&s.addClass(i.rootElement,n.className));y=i.rootElement.style.height;y!==""&&(y=parseInt(i.rootElement.style.height,10));f=n.height;e.isFunction(f)&&(f=f());t&&(it=i.rootElement.getAttribute("style"),it&&i.rootElement.setAttribute("data-initialstyle",i.rootElement.getAttribute("style")));f===null?(p=i.rootElement.getAttribute("data-initialstyle"),p&&(p.indexOf("height")>-1||p.indexOf("overflow")>-1)?i.rootElement.setAttribute("style",p):(i.rootElement.style.height="",i.rootElement.style.overflow="")):f!==void 0&&(i.rootElement.style.height=f+"px",i.rootElement.style.overflow="hidden");typeof n.width!="undefined"&&(w=n.width,e.isFunction(w)&&(w=w()),i.rootElement.style.width=w+"px");t||(rt.clearLengthCache(),i.view&&i.view.wt.wtViewport.resetHasOversizedColumnHeadersMarked(),i.runHooks("afterUpdateSettings",n));ui.adjustRowsAndCols();i.view&&!v.firstRun&&(i.forceFullRender=!0,kt.lockEditor(),i._refreshBorders(null),kt.unlockEditor());!t&&i.view&&(y===""||f===""||f===void 0)&&y!==f&&i.view.wt.wtOverlays.updateMainScrollableElements()};this.getValue=function(){var n=i.getSelectedLast();if(vt.prototype.getValue){if(e.isFunction(vt.prototype.getValue))return vt.prototype.getValue.call(i);if(n)return i.getData()[n[0][0]][vt.prototype.getValue]}else if(n)return i.getDataAtCell(n[0],n[1])};this.getSettings=function(){return v.settings};this.clear=function(){ot.selectAll();this.emptySelectedCells()};this.alter=function(n,t,i,r,u){ui.alter(n,t,i,r,u)};this.getCell=function(n,t,r){return i.view.getCellAtCoords(new u.CellCoords(n,t),r)};this.getCoords=function(n){return this.view.wt.wtTable.getCoords.call(this.view.wt.wtTable,n)};this.colToProp=function(n){return rt.colToProp(n)};this.propToCol=function(n){return rt.propToCol(n)};this.toVisualRow=function(n){return dt.toVisualRow(n)};this.toVisualColumn=function(n){return dt.toVisualColumn(n)};this.toPhysicalRow=function(n){return dt.toPhysicalRow(n)};this.toPhysicalColumn=function(n){return dt.toPhysicalColumn(n)};this.getDataAtCell=function(n,t){return rt.get(n,rt.colToProp(t))};this.getDataAtRowProp=function(n,t){return rt.get(n,t)};this.getDataAtCol=function(n){var t=[];return t.concat.apply(t,a(rt.getRange(new u.CellCoords(0,n),new u.CellCoords(v.settings.data.length-1,n),rt.DESTINATION_RENDERER)))};this.getDataAtProp=function(n){var t=[],i;return i=rt.getRange(new u.CellCoords(0,rt.propToCol(n)),new u.CellCoords(v.settings.data.length-1,rt.propToCol(n)),rt.DESTINATION_RENDERER),t.concat.apply(t,a(i))};this.getSourceData=function(n,t,i,r){return n===void 0?pt.getData():pt.getByRange(new u.CellCoords(n,t),new u.CellCoords(i,r))};this.getSourceDataArray=function(n,t,i,r){return n===void 0?pt.getData(!0):pt.getByRange(new u.CellCoords(n,t),new u.CellCoords(i,r),!0)};this.getSourceDataAtCol=function(n){return pt.getAtColumn(n)};this.getSourceDataAtRow=function(n){return pt.getAtRow(n)};this.getSourceDataAtCell=function(n,t){return pt.getAtCell(n,t)};this.getDataAtRow=function(n){var t=rt.getRange(new u.CellCoords(n,0),new u.CellCoords(n,this.countCols()-1),rt.DESTINATION_RENDERER);return t[0]||[]};this.getDataType=function(n,t,i,r){var o=this,f=null,u=null,e;return n===void 0&&(n=0,i=this.countRows(),t=0,r=this.countCols()),i===void 0&&(i=n),r===void 0&&(r=t),e="mixed",y.rangeEach(Math.min(n,i),Math.max(n,i),function(n){var i=!0;return y.rangeEach(Math.min(t,r),Math.max(t,r),function(t){var r=o.getCellMeta(n,t);return u=r.type,f?i=f===u:f=u,i}),e=i?u:"mixed",i}),e};this.removeCellMeta=function(n,t,r){var s=dt.toPhysical(n,t),f=h(s,2),e=f[0],o=f[1],u=v.cellSettings[e][o][r],c=i.runHooks("beforeRemoveCellMeta",n,t,r,u);c!==!1&&(delete v.cellSettings[e][o][r],i.runHooks("afterRemoveCellMeta",n,t,r,u));u=null};this.spliceCellsMeta=function(n,t){for(var u,r=arguments.length,f=Array(r>2?r-2:0),i=2;i<r;i++)f[i-2]=arguments[i];(u=v.cellSettings).splice.apply(u,[n,t].concat(f))};this.setCellMetaObject=function(n,t,i){var u,e;if((typeof i=="undefined"?"undefined":f(i))==="object")for(u in i)r.hasOwnProperty(i,u)&&(e=i[u],this.setCellMeta(n,t,u,e))};this.setCellMeta=function(n,t,r,u){var s=dt.toPhysical(n,t),o=h(s,2),e=o[0],f=o[1];v.columnSettings[f]||(v.columnSettings[f]=k.columnFactory(vt,v.columnsSettingConflicts));v.cellSettings[e]||(v.cellSettings[e]=[]);v.cellSettings[e][f]||(v.cellSettings[e][f]=new v.columnSettings[f]);v.cellSettings[e][f][r]=u;i.runHooks("afterSetCellMeta",n,t,r,u)};this.getCellsMeta=function(){return c.arrayFlatten(v.cellSettings)};this.getCellMeta=function(n,t){var s=rt.colToProp(t),u=void 0,l=dt.toPhysical(n,t),c=h(l,2),f=c[0],e=c[1],o;return f===null&&(f=n),v.columnSettings[e]||(v.columnSettings[e]=k.columnFactory(vt,v.columnsSettingConflicts)),v.cellSettings[f]||(v.cellSettings[f]=[]),v.cellSettings[f][e]||(v.cellSettings[f][e]=new v.columnSettings[e]),u=v.cellSettings[f][e],u.row=f,u.col=e,u.visualRow=n,u.visualCol=t,u.prop=s,u.instance=i,i.runHooks("beforeGetCellMeta",n,t,u),r.extend(u,fi(u)),u.cells&&(o=u.cells.call(u,f,e,s),o&&(r.extend(u,o),r.extend(u,fi(o)))),i.runHooks("afterGetCellMeta",n,t,u),u};this.getCellMetaAtRow=function(n){return v.cellSettings[n]};this.isColumnModificationAllowed=function(){return!(i.dataType==="object"||i.getSettings().columns)};li=p.cellMethodLookupFactory("renderer");this.getCellRenderer=function(n,t){return ct.getRenderer(li.call(this,n,t))};this.getCellEditor=p.cellMethodLookupFactory("editor");ai=p.cellMethodLookupFactory("validator");this.getCellValidator=function(n,t){var i=ai.call(this,n,t);return typeof i=="string"&&(i=lt.getValidator(i)),i};this.validateCells=function(n){this._validateCells(n)};this.validateRows=function(n,t){if(!Array.isArray(n))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(t,n)};this.validateColumns=function(n,t){if(!Array.isArray(n))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(t,undefined,n)};this._validateCells=function(n,t,r){var e=new oi,u,f;for(n&&(e.onQueueEmpty=n),u=i.countRows()-1;u>=0;){if(t!==undefined&&t.indexOf(u)===-1){u--;continue}for(f=i.countCols()-1;f>=0;){if(r!==undefined&&r.indexOf(f)===-1){f--;continue}e.addValidatorToQueue();i.validateCell(i.getDataAtCell(u,f),i.getCellMeta(u,f),function(n){if(typeof n!="boolean")throw new Error("Validation error: result is not boolean");n===!1&&(e.valid=!1);e.removeValidatorFormQueue()},"validateCells");f--}u--}e.checkIfQueueIsEmpty()};this.getRowHeader=function(n){var t=v.settings.rowHeaders;return n!==void 0&&(n=i.runHooks("modifyRowHeader",n)),n===void 0?(t=[],y.rangeEach(i.countRows()-1,function(n){t.push(i.getRowHeader(n))})):Array.isArray(t)&&t[n]!==void 0?t=t[n]:e.isFunction(t)?t=t(n):t&&typeof t!="string"&&typeof t!="number"&&(t=n+1),t};this.hasRowHeaders=function(){return!!v.settings.rowHeaders};this.hasColHeaders=function(){if(v.settings.colHeaders!==void 0&&v.settings.colHeaders!==null)return!!v.settings.colHeaders;for(var n=0,t=i.countCols();n<t;n++)if(i.getColHeader(n))return!0;return!1};this.getColHeader=function(n){var c=v.settings.columns&&e.isFunction(v.settings.columns),t=v.settings.colHeaders,f,o,r,s,h,u;if(n=i.runHooks("modifyColHeader",n),n===void 0){for(f=[],o=c?i.countSourceCols():i.countCols(),r=0;r<o;r++)f.push(i.getColHeader(r));t=f}else s=function(n){for(var r=[],u=i.countSourceCols(),t=0;t<u;t++)e.isFunction(i.getSettings().columns)&&i.getSettings().columns(t)&&r.push(t);return r[n]},h=n,n=i.runHooks("modifyCol",n),u=s(n),v.settings.columns&&e.isFunction(v.settings.columns)&&v.settings.columns(u)&&v.settings.columns(u).title?t=v.settings.columns(u).title:v.settings.columns&&v.settings.columns[n]&&v.settings.columns[n].title?t=v.settings.columns[n].title:Array.isArray(v.settings.colHeaders)&&v.settings.colHeaders[n]!==void 0?t=v.settings.colHeaders[n]:e.isFunction(v.settings.colHeaders)?t=v.settings.colHeaders(n):v.settings.colHeaders&&typeof v.settings.colHeaders!="string"&&typeof v.settings.colHeaders!="number"&&(t=p.spreadsheetColumnLabel(h));return t};this._getColWidthFromSettings=function(n){var r=i.getCellMeta(0,n),t=r.width;if((t===void 0||t===v.settings.width)&&(t=r.colWidths),t!==void 0&&t!==null){switch(typeof t=="undefined"?"undefined":f(t)){case"object":t=t[n];break;case"function":t=t(n)}typeof t=="string"&&(t=parseInt(t,10))}return t};this.getColWidth=function(n){var t=i._getColWidthFromSettings(n);return t=i.runHooks("modifyColWidth",t,n),t===void 0&&(t=u.ViewportColumnsCalculator.DEFAULT_WIDTH),t};this._getRowHeightFromSettings=function(n){var t=v.settings.rowHeights;if(t!==void 0&&t!==null){switch(typeof t=="undefined"?"undefined":f(t)){case"object":t=t[n];break;case"function":t=t(n)}typeof t=="string"&&(t=parseInt(t,10))}return t};this.getRowHeight=function(n){var t=i._getRowHeightFromSettings(n);return i.runHooks("modifyRowHeight",t,n)};this.countSourceRows=function(){var n=i.runHooks("modifySourceLength");return n||(i.getSourceData()?i.getSourceData().length:0)};this.countSourceCols=function(){var n=i.getSourceData()&&i.getSourceData()[0]?i.getSourceData()[0]:[];return r.isObject(n)?r.deepObjectSize(n):n.length||0};this.countRows=function(){return rt.getLength()};this.countCols=function(){var o=this.getSettings().maxCols,u=!1,n=0,f,r,t;if(i.dataType==="array"&&(u=v.settings.data&&v.settings.data[0]&&v.settings.data[0].length),u&&(n=v.settings.data[0].length),v.settings.columns)if(f=e.isFunction(v.settings.columns),f)if(i.dataType==="array"){for(r=0,t=0;t<n;t++)v.settings.columns(t)&&r++;n=r}else(i.dataType==="object"||i.dataType==="function")&&(n=rt.colToPropCache.length);else n=v.settings.columns.length;else(i.dataType==="object"||i.dataType==="function")&&(n=rt.colToPropCache.length);return Math.min(o,n)};this.rowOffset=function(){return i.view.wt.wtTable.getFirstRenderedRow()};this.colOffset=function(){return i.view.wt.wtTable.getFirstRenderedColumn()};this.countRenderedRows=function(){return i.view.wt.drawn?i.view.wt.wtTable.getRenderedRowsCount():-1};this.countVisibleRows=function(){return i.view.wt.drawn?i.view.wt.wtTable.getVisibleRowsCount():-1};this.countRenderedCols=function(){return i.view.wt.drawn?i.view.wt.wtTable.getRenderedColumnsCount():-1};this.countVisibleCols=function(){return i.view.wt.drawn?i.view.wt.wtTable.getVisibleColumnsCount():-1};this.countEmptyRows=function(n){for(var t=i.countRows()-1,r=0,u;t>=0;){if(u=i.runHooks("modifyRow",t),i.isEmptyRow(u))r++;else if(n)break;t--}return r};this.countEmptyCols=function(n){if(i.countRows()<1)return 0;for(var t=i.countCols()-1,r=0;t>=0;){if(i.isEmptyCol(t))r++;else if(n)break;t--}return r};this.isEmptyRow=function(n){return v.settings.isEmptyRow.call(i,n)};this.isEmptyCol=function(n){return v.settings.isEmptyCol.call(i,n)};this.selectCell=function(n,t,i,r){var u=arguments.length>4&&arguments[4]!==undefined?arguments[4]:!0,f=arguments.length>5&&arguments[5]!==undefined?arguments[5]:!0;return o.isUndefined(n)||o.isUndefined(t)?!1:this.selectCells([[n,t,i,r]],u,f)};this.selectCells=function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[[]],r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!0,u=arguments.length>2&&arguments[2]!==undefined?arguments[2]:!0,n;return r===!1&&(ei=!0),n=ot.selectCells(t),n&&u&&i.listen(),ei=!1,n};this.selectCellByProp=function(n,t,i,r){var u=arguments.length>4&&arguments[4]!==undefined?arguments[4]:!0,f=arguments.length>5&&arguments[5]!==undefined?arguments[5]:!0;return console.warn(st.toSingleLine(tt)),this.selectCells([[n,t,i,r]],u,f)};this.selectColumns=function(n){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:n;return ot.selectColumns(n,t)};this.selectRows=function(n){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:n;return ot.selectRows(n,t)};this.deselectCell=function(){ot.deselect()};this.scrollViewportTo=function(n,t){var u=arguments.length>2&&arguments[2]!==undefined?arguments[2]:!1,f=arguments.length>3&&arguments[3]!==undefined?arguments[3]:!1,r;return n!==void 0&&(n<0||n>=i.countRows())?!1:t!==void 0&&(t<0||t>=i.countCols())?!1:(r=!1,n!==void 0&&t!==void 0&&(i.view.wt.wtOverlays.topOverlay.scrollTo(n,u),i.view.wt.wtOverlays.leftOverlay.scrollTo(t,f),r=!0),typeof n=="number"&&typeof t!="number"&&(i.view.wt.wtOverlays.topOverlay.scrollTo(n,u),r=!0),typeof t=="number"&&typeof n!="number"&&(i.view.wt.wtOverlays.leftOverlay.scrollTo(t,f),r=!0),r)};this.destroy=function(){var t,n;i._clearTimeouts();i.view&&i.view.destroy();pt&&pt.destroy();pt=null;nt.stopObserving();!0&&w.isRootInstance(i)&&(t=document.querySelector("#hot-display-license-info"),t&&t.parentNode.removeChild(t));s.empty(i.rootElement);yi.destroy();kt&&kt.destroy();i.runHooks("afterDestroy");l.default.getSingleton().destroy(i);for(n in i)r.hasOwnProperty(i,n)&&(e.isFunction(i[n])?i[n]=bi:n!=="guid"&&(i[n]=null));rt&&rt.destroy();rt=null;v=null;ui=null;ot=null;kt=null;i=null;vt=null};this.getActiveEditor=function(){return kt.getActiveEditor()};this.getPlugin=function(n){return ht.getPlugin(this,n)};this.getInstance=function(){return i};this.addHook=function(n,t){l.default.getSingleton().add(n,t,i)};this.hasHook=function(n){return l.default.getSingleton().has(n,i)};this.addHookOnce=function(n,t){l.default.getSingleton().once(n,t,i)};this.removeHook=function(n,t){l.default.getSingleton().remove(n,t,i)};this.runHooks=function(n,t,r,u,f,e,o){return l.default.getSingleton().run(i,n,t,r,u,f,e,o)};this.getTranslatedPhrase=function(n,t){return ti.getTranslatedPhrase(v.settings.language,n,t)};this.timeouts=[];this._registerTimeout=function(n){this.timeouts.push(n)};this._clearTimeouts=function(){for(var n=0,t=this.timeouts.length;n<t;n++)clearTimeout(this.timeouts[n])};this._refreshBorders=function(n){kt.destroyEditor(n);i.view.render();ot.isSelected()&&kt.prepareEditor()};l.default.getSingleton().run(i,"construct")}var b;t.__esModule=!0;var f=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},h=function(){function n(n,t){var r=[],u=!0,f=!1,e=undefined,i,o;try{for(i=n[Symbol.iterator]();!(u=(o=i.next()).done);u=!0)if(r.push(o.value),t&&r.length===t)break}catch(s){f=!0;e=s}finally{try{!u&&i["return"]&&i["return"]()}finally{if(f)throw e;}}return r}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return n(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance");}}(),tt=ui(["Deprecation warning: This method is going to be removed in the next release. \n      If you want to select a cell using props, please use the `selectCell` method."],["Deprecation warning: This method is going to be removed in the next release.\\x20\n      If you want to select a cell using props, please use the \\`selectCell\\` method."]);t.default=fi;var s=i(2),k=i(153),e=i(35),o=i(13),it=i(33),rt=i(291),ut=v(rt),ft=i(294),et=v(ft),ot=i(9),g=v(ot),r=i(1),c=i(0),st=i(34),ht=i(6),ct=i(15),lt=i(36),at=i(30),y=i(4),vt=i(295),yt=v(vt),pt=i(296),wt=v(pt),p=i(81),bt=i(53),w=i(206),u=i(8),kt=i(14),l=v(kt),dt=i(207),gt=v(dt),ni=i(151),ti=i(208),ii=i(82),d=i(209),nt=i(210),ri=i(300);b=null},function(n,t,i){"use strict";function u(n,t){function i(){}r.inherit(i,n);for(var u=0,f=t.length;u<f;u++)i.prototype[t[u]]=void 0;return i}t.__esModule=!0;t.columnFactory=u;var r=i(1)},function(n,t,i){"use strict";function u(n){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:h,i,c;if(r!==h&&r!==y)throw new Error("The second argument is used internally only and cannot be overwritten.");var a=Array.isArray(n),f=r===h,t=e;return a&&(i=n[0],n.length===0?t=o:f&&i instanceof p.CellRange?t=s:f&&Array.isArray(i)?t=u(i,y):n.length>=2&&n.length<=4&&(c=!n.some(function(n,t){return!b[t].includes(typeof n=="undefined"?"undefined":l(n))}),c&&(t=v))),t}function c(n){var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{},r=i.keepDirection,u=r===undefined?!1:r,t=i.propToCol;if(!w.includes(n))throw new Error("Unsupported selection ranges schema type was provided.");return function(i){var o=n===s,h=o?i.from.row:i[0],f=o?i.from.col:i[1],e=o?i.to.row:i[2],r=o?i.to.col:i[3];if(typeof t=="function"&&(typeof f=="string"&&(f=t(f)),typeof r=="string"&&(r=t(r))),a.isUndefined(e)&&(e=h),a.isUndefined(r)&&(r=f),!u){var c=h,l=f,v=e,y=r;h=Math.min(c,v);f=Math.min(l,y);e=Math.max(c,v);r=Math.max(l,y)}return[h,f,e,r]}}function k(n){var i=u(n),s,t,h,l;return i===e||i===o?[]:(s=c(i),t=new Set,r.arrayEach(n,function(n){var e=s(n),i=f(e,4),u=i[1],o=i[3],h=o-u+1;r.arrayEach(Array.from(new Array(h),function(n,t){return u+t}),function(n){t.has(n)||t.add(n)})}),h=Array.from(t).sort(function(n,t){return n-t}),l=r.arrayReduce(h,function(n,t,i,r){return i!==0&&t===r[i-1]+1?n[n.length-1][1]++:n.push([t,1]),n},[]),l)}function d(n){var i=u(n),s,t,h,l;return i===e||i===o?[]:(s=c(i),t=new Set,r.arrayEach(n,function(n){var e=s(n),i=f(e,3),u=i[0],o=i[2],h=o-u+1;r.arrayEach(Array.from(new Array(h),function(n,t){return u+t}),function(n){t.has(n)||t.add(n)})}),h=Array.from(t).sort(function(n,t){return n-t}),l=r.arrayReduce(h,function(n,t,i,r){return i!==0&&t===r[i-1]+1?n[n.length-1][1]++:n.push([t,1]),n},[]),l)}function g(n){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:Infinity;return typeof n=="number"&&n>=0&&n<t}var f,l;t.__esModule=!0;t.SELECTION_TYPES=t.SELECTION_TYPE_OBJECT=t.SELECTION_TYPE_ARRAY=t.SELECTION_TYPE_EMPTY=t.SELECTION_TYPE_UNRECOGNIZED=undefined;f=function(){function n(n,t){var r=[],u=!0,f=!1,e=undefined,i,o;try{for(i=n[Symbol.iterator]();!(u=(o=i.next()).done);u=!0)if(r.push(o.value),t&&r.length===t)break}catch(s){f=!0;e=s}finally{try{!u&&i["return"]&&i["return"]()}finally{if(f)throw e;}}return r}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return n(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance");}}();l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n};t.detectSelectionType=u;t.normalizeSelectionFactory=c;t.transformSelectionToColumnDistance=k;t.transformSelectionToRowDistance=d;t.isValidCoord=g;var p=i(8),r=i(0),a=i(13),e=t.SELECTION_TYPE_UNRECOGNIZED=0,o=t.SELECTION_TYPE_EMPTY=1,v=t.SELECTION_TYPE_ARRAY=2,s=t.SELECTION_TYPE_OBJECT=3,w=t.SELECTION_TYPES=[s,v],b=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],h=Symbol("root"),y=Symbol("child")},function(n,t,i){"use strict";function o(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var f;t.__esModule=!0;var e=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),u=i(2),r=i(0);f=function(){function n(t){o(this,n);this.hot=t;this.container=null;this.injected=!1;this.rows=[];this.columns=[];this.samples=null;this.settings={useHeaders:!0}}return e(n,[{key:"addRow",value:function(n,t){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));var i={row:n};this.rows.push(i);this.samples=t;this.table=this.createTable(this.hot.table.className);this.table.colGroup.appendChild(this.createColGroupsCol());this.table.tr.appendChild(this.createRow(n));this.container.container.appendChild(this.table.fragment);i.table=this.table.table}},{key:"addColumnHeadersRow",value:function(n){if(this.hot.getColHeader(0)!=null){var t={row:-1};this.rows.push(t);this.container=this.createContainer(this.hot.rootElement.className);this.samples=n;this.table=this.createTable(this.hot.table.className);this.table.colGroup.appendChild(this.createColGroupsCol());this.table.tHead.appendChild(this.createColumnHeadersRow());this.container.container.appendChild(this.table.fragment);t.table=this.table.table}}},{key:"addColumn",value:function(n,t){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));var i={col:n};this.columns.push(i);this.samples=t;this.table=this.createTable(this.hot.table.className);this.getSetting("useHeaders")&&this.hot.getColHeader(n)!==null&&this.hot.view.appendColHeader(n,this.table.th);this.table.tBody.appendChild(this.createCol(n));this.container.container.appendChild(this.table.fragment);i.table=this.table.table}},{key:"getHeights",value:function(n){this.injected||this.injectTable();r.arrayEach(this.rows,function(t){n(t.row,u.outerHeight(t.table)-1)})}},{key:"getWidths",value:function(n){this.injected||this.injectTable();r.arrayEach(this.columns,function(t){n(t.col,u.outerWidth(t.table))})}},{key:"setSettings",value:function(n){this.settings=n}},{key:"setSetting",value:function(n,t){this.settings||(this.settings={});this.settings[n]=t}},{key:"getSettings",value:function(){return this.settings}},{key:"getSetting",value:function(n){return this.settings?this.settings[n]:null}},{key:"createColGroupsCol",value:function(){var t=this,i=document,n=i.createDocumentFragment();return this.hot.hasRowHeaders()&&n.appendChild(this.createColElement(-1)),this.samples.forEach(function(i){r.arrayEach(i.strings,function(i){n.appendChild(t.createColElement(i.col))})}),n}},{key:"createRow",value:function(n){var t=this,i=document,u=i.createDocumentFragment(),f=i.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(n,f),u.appendChild(f)),this.samples.forEach(function(f){r.arrayEach(f.strings,function(r){var f=r.col,e=t.hot.getCellMeta(n,f),s,o;e.col=f;e.row=n;s=t.hot.getCellRenderer(e);o=i.createElement("td");s(t.hot,o,n,f,t.hot.colToProp(f),r.value,e);u.appendChild(o)})}),u}},{key:"createColumnHeadersRow",value:function(){var u=this,n=document,t=n.createDocumentFragment(),i;return this.hot.hasRowHeaders()&&(i=n.createElement("th"),this.hot.view.appendColHeader(-1,i),t.appendChild(i)),this.samples.forEach(function(i){r.arrayEach(i.strings,function(i){var f=i.col,r=n.createElement("th");u.hot.view.appendColHeader(f,r);t.appendChild(r)})}),t}},{key:"createCol",value:function(n){var t=this,i=document,u=i.createDocumentFragment();return this.samples.forEach(function(f){r.arrayEach(f.strings,function(r){var e=r.row,f=t.hot.getCellMeta(e,n);f.col=n;f.row=e;var h=t.hot.getCellRenderer(f),o=i.createElement("td"),s=i.createElement("tr");h(t.hot,o,e,n,t.hot.colToProp(n),r.value,f);s.appendChild(o);u.appendChild(s)})}),u}},{key:"clean",value:function(){this.rows.length=0;this.rows[-1]=void 0;this.columns.length=0;this.samples&&this.samples.clear();this.samples=null;this.removeTable()}},{key:"injectTable",value:function(){var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;this.injected||((n||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}},{key:"removeTable",value:function(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}},{key:"createColElement",value:function(n){var i=document,t=i.createElement("col");return t.style.width=this.hot.view.wt.wtTable.getStretchedColumnWidth(n)+"px",t}},{key:"createTable",value:function(){var h=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"",t=document,e=t.createDocumentFragment(),n=t.createElement("table"),r=t.createElement("thead"),f=t.createElement("tbody"),o=t.createElement("colgroup"),i=t.createElement("tr"),s=t.createElement("th");return this.isVertical()&&n.appendChild(o),this.isHorizontal()&&(i.appendChild(s),r.appendChild(i),n.style.tableLayout="auto",n.style.width="auto"),n.appendChild(r),this.isVertical()&&f.appendChild(i),n.appendChild(f),u.addClass(n,h),e.appendChild(n),{fragment:e,table:n,tHead:r,tBody:f,colGroup:o,tr:i,th:s}}},{key:"createContainer",value:function(){var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"",i=document,r=i.createDocumentFragment(),t=i.createElement("div");return n="htGhostTable htAutoSize "+n.trim(),u.addClass(t,n),r.appendChild(t),{fragment:r,container:t}}},{key:"isVertical",value:function(){return!!(this.rows.length&&!this.columns.length)}},{key:"isHorizontal",value:function(){return!!(this.columns.length&&!this.rows.length)}}]),n}();t.default=f},function(n,t){"use strict";function r(){return{name:i}}t.__esModule=!0;t.default=r;var i=t.KEY="---------"},function(n,t,i){"use strict";function o(n){return n&&n.__esModule?n:{"default":n}}function it(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var h;t.__esModule=!0;var a=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),v=i(152),y=o(v),r=i(2),s=i(0),p=i(336),w=o(p),b=i(9),k=o(b),c=i(1),d=i(13),l=i(35),u=i(23),f=i(18),g=i(21),nt=o(g),e=i(44),tt=i(11);h=function(){function n(t,i){it(this,n);this.hot=t;this.options=i||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1};this.eventManager=new k.default(this);this.container=this.createContainer(this.options.name);this.hotMenu=null;this.hotSubMenus={};this.parentMenu=this.options.parent||null;this.menuItems=null;this.origOutsideClickDeselects=null;this.keyEvent=!1;this.offset={above:0,below:0,left:0,right:0};this._afterScrollCallback=null;this.registerEvents()}return a(n,[{key:"registerEvents",value:function(){var n=this;this.eventManager.addEventListener(document.documentElement,"mousedown",function(t){return n.onDocumentMouseDown(t)})}},{key:"setMenuItems",value:function(n){this.menuItems=n}},{key:"setOffset",value:function(n){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;this.offset[n]=t}},{key:"isSubMenu",value:function(){return this.parentMenu!==null}},{key:"open",value:function(){var n=this,i,t,r;this.container.removeAttribute("style");this.container.style.display="block";i=l.debounce(function(t){return n.openSubMenu(t)},300);t=s.arrayFilter(this.menuItems,function(t){return u.isItemHidden(t,n.hot)});t=u.filterSeparators(t,e.SEPARATOR);r={data:t,colHeaders:!1,colWidths:[215],autoRowSize:!1,readOnly:!0,copyPaste:!1,columns:[{data:"name",renderer:function(t,i,r,u,f,e){return n.menuItemRenderer(t,i,r,u,f,e)}}],renderAllRows:!0,fragmentSelection:"cell",disableVisualSelection:"area",beforeKeyDown:function(t){return n.onBeforeKeyDown(t)},afterOnCellMouseOver:function(t,r){n.isAllSubMenusClosed()?i(r.row):n.openSubMenu(r.row)},rowHeights:function(n){return t[n].name===e.SEPARATOR?1:23}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects;this.hot.getSettings().outsideClickDeselects=!1;this.hotMenu=new y.default(this.container,r);this.hotMenu.addHook("afterInit",function(){return n.onAfterInit()});this.hotMenu.addHook("afterSelection",function(){return n.onAfterSelection.apply(n,arguments)});this.hotMenu.init();this.hotMenu.listen();this.blockMainTableCallbacks();this.runLocalHooks("afterOpen")}},{key:"close",value:function(){var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:!1;this.isOpened()&&(n&&this.parentMenu?this.parentMenu.close():(this.closeAllSubMenus(),this.container.style.display="none",this.releaseMainTableCallbacks(),this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.parentMenu&&this.parentMenu.hotMenu.listen()))}},{key:"openSubMenu",value:function(t){var r,f,i;return this.hotMenu?(r=this.hotMenu.getCell(t,0),this.closeAllSubMenus(),!r||!u.hasSubMenu(r))?!1:(f=this.hotMenu.getSourceDataAtRow(t),i=new n(this.hot,{parent:this,name:f.name,className:this.options.className,keepInViewport:!0}),i.setMenuItems(f.submenu.items),i.open(),i.setPosition(r.getBoundingClientRect()),this.hotSubMenus[f.key]=i,i):!1}},{key:"closeSubMenu",value:function(n){var t=this.hotMenu.getSourceDataAtRow(n),i=this.hotSubMenus[t.key];i&&(i.destroy(),delete this.hotSubMenus[t.key])}},{key:"closeAllSubMenus",value:function(){var n=this;s.arrayEach(this.hotMenu.getData(),function(t,i){return n.closeSubMenu(i)})}},{key:"isAllSubMenusClosed",value:function(){return Object.keys(this.hotSubMenus).length===0}},{key:"destroy",value:function(){this.clearLocalHooks();this.close();this.parentMenu=null;this.eventManager.destroy()}},{key:"isOpened",value:function(){return this.hotMenu!==null}},{key:"executeCommand",value:function(n){var t;if(this.isOpened()&&this.hotMenu.getSelectedLast()&&(t=this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]),this.runLocalHooks("select",t,n),t.isCommand!==!1&&t.name!==e.SEPARATOR)){var i=this.hot.getSelectedRange(),r=i?u.normalizeSelection(i):[],f=!0;(t.disabled===!0||typeof t.disabled=="function"&&t.disabled.call(this.hot)===!0||t.submenu)&&(f=!1);this.runLocalHooks("executeCommand",t.key,r,n);this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",t.key,r,n);f&&this.close(!0)}}},{key:"setPosition",value:function(n){var t=new w.default(n);this.options.keepInViewport?(t.fitsBelow(this.container)?this.setPositionBelowCursor(t):t.fitsAbove(this.container)?this.setPositionAboveCursor(t):this.setPositionBelowCursor(t),t.fitsOnRight(this.container)?this.setPositionOnRightOfCursor(t):this.setPositionOnLeftOfCursor(t)):(this.setPositionBelowCursor(t),this.setPositionOnRightOfCursor(t))}},{key:"setPositionAboveCursor",value:function(n){var t=this.offset.above+n.top-this.container.offsetHeight;this.isSubMenu()&&(t=n.top+n.cellHeight-this.container.offsetHeight+3);this.container.style.top=t+"px"}},{key:"setPositionBelowCursor",value:function(n){var t=this.offset.below+n.top;this.isSubMenu()&&(t=n.top-1);this.container.style.top=t+"px"}},{key:"setPositionOnRightOfCursor",value:function(n){var t=void 0;t=this.isSubMenu()?1+n.left+n.cellWidth:this.offset.right+1+n.left;this.container.style.left=t+"px"}},{key:"setPositionOnLeftOfCursor",value:function(n){var t=this.offset.left+n.left-this.container.offsetWidth+r.getScrollbarWidth()+4;this.container.style.left=t+"px"}},{key:"selectFirstCell",value:function(){var n=this.hotMenu.getCell(0,0);u.isSeparator(n)||u.isDisabled(n)||u.isSelectionDisabled(n)?this.selectNextCell(0,0):this.hotMenu.selectCell(0,0)}},{key:"selectLastCell",value:function(){var n=this.hotMenu.countRows()-1,t=this.hotMenu.getCell(n,0);u.isSeparator(t)||u.isDisabled(t)||u.isSelectionDisabled(t)?this.selectPrevCell(n,0):this.hotMenu.selectCell(n,0)}},{key:"selectNextCell",value:function(n,t){var i=n+1,r=i<this.hotMenu.countRows()?this.hotMenu.getCell(i,t):null;r&&(u.isSeparator(r)||u.isDisabled(r)||u.isSelectionDisabled(r)?this.selectNextCell(i,t):this.hotMenu.selectCell(i,t))}},{key:"selectPrevCell",value:function(n,t){var i=n-1,r=i>=0?this.hotMenu.getCell(i,t):null;r&&(u.isSeparator(r)||u.isDisabled(r)||u.isSelectionDisabled(r)?this.selectPrevCell(i,t):this.hotMenu.selectCell(i,t))}},{key:"menuItemRenderer",value:function(n,t,i,u,f,o){var a=this,s=n.getSourceDataAtRow(i),h=document.createElement("div"),v=function(n){return c.hasOwnProperty(n,"submenu")},y=function(n){return new RegExp(e.SEPARATOR,"i").test(n.name)},p=function(n){return n.disabled===!0||typeof n.disabled=="function"&&n.disabled.call(a.hot)===!0},l=function(n){return n.disableSelection};typeof o=="function"&&(o=o.call(this.hot));r.empty(t);r.addClass(h,"htItemWrapper");t.appendChild(h);y(s)?r.addClass(t,"htSeparator"):typeof s.renderer=="function"?(r.addClass(t,"htCustomMenuRenderer"),t.appendChild(s.renderer(n,h,i,u,f,o))):r.fastInnerHTML(h,o);p(s)?(r.addClass(t,"htDisabled"),this.eventManager.addEventListener(t,"mouseenter",function(){return n.deselectCell()})):l(s)?(r.addClass(t,"htSelectionDisabled"),this.eventManager.addEventListener(t,"mouseenter",function(){return n.deselectCell()})):v(s)?(r.addClass(t,"htSubmenu"),l(s)?this.eventManager.addEventListener(t,"mouseenter",function(){return n.deselectCell()}):this.eventManager.addEventListener(t,"mouseenter",function(){return n.selectCell(i,u,void 0,void 0,!1,!1)})):(r.removeClass(t,"htSubmenu"),r.removeClass(t,"htDisabled"),l(s)?this.eventManager.addEventListener(t,"mouseenter",function(){return n.deselectCell()}):this.eventManager.addEventListener(t,"mouseenter",function(){return n.selectCell(i,u,void 0,void 0,!1,!1)}))}},{key:"createContainer",value:function(){var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null,t=void 0;return n?(l.isFunction(n)&&(n=n.call(this.hot),n=n===null||d.isUndefined(n)?"":n.toString()),n=n.replace(/[^A-z0-9]/g,"_"),n=this.options.className+"Sub_"+n,t=document.querySelector("."+this.options.className+"."+n)):t=document.querySelector("."+this.options.className),t||(t=document.createElement("div"),r.addClass(t,"htMenu "+this.options.className),n&&r.addClass(t,n),document.getElementsByTagName("body")[0].appendChild(t)),t}},{key:"blockMainTableCallbacks",value:function(){this._afterScrollCallback=function(){};this.hot.addHook("afterScrollVertically",this._afterScrollCallback);this.hot.addHook("afterScrollHorizontally",this._afterScrollCallback)}},{key:"releaseMainTableCallbacks",value:function(){this._afterScrollCallback&&(this.hot.removeHook("afterScrollVertically",this._afterScrollCallback),this.hot.removeHook("afterScrollHorizontally",this._afterScrollCallback),this._afterScrollCallback=null)}},{key:"onBeforeKeyDown",value:function(n){var t=this.hotMenu.getSelectedLast(),i=!1,r;this.keyEvent=!0;switch(n.keyCode){case f.KEY_CODES.ESCAPE:this.close();i=!0;break;case f.KEY_CODES.ENTER:t&&(this.hotMenu.getSourceDataAtRow(t[0]).submenu?i=!0:(this.executeCommand(n),this.close(!0)));break;case f.KEY_CODES.ARROW_DOWN:t?this.selectNextCell(t[0],t[1]):this.selectFirstCell();i=!0;break;case f.KEY_CODES.ARROW_UP:t?this.selectPrevCell(t[0],t[1]):this.selectLastCell();i=!0;break;case f.KEY_CODES.ARROW_RIGHT:t&&(r=this.openSubMenu(t[0]),r&&r.selectFirstCell());i=!0;break;case f.KEY_CODES.ARROW_LEFT:t&&this.isSubMenu()&&(this.close(),this.parentMenu&&this.parentMenu.hotMenu.listen(),i=!0)}i&&(n.preventDefault(),tt.stopImmediatePropagation(n));this.keyEvent=!1}},{key:"onAfterInit",value:function(){var i=this.hotMenu.getSettings().data,t=this.hotMenu.view.wt.wtTable.hider.style,n=this.hotMenu.view.wt.wtTable.holder.style,r=parseInt(t.width,10),u=s.arrayReduce(i,function(n,t){return n+(t.name===e.SEPARATOR?1:26)},0);n.width=r+22+"px";n.height=u+4+"px";t.height=n.height}},{key:"onAfterSelection",value:function(n,t,i,r,u){this.keyEvent===!1&&(u.value=!0)}},{key:"onDocumentMouseDown",value:function(n){this.isOpened()&&(this.container&&r.isChildOf(n.target,this.container)&&this.executeCommand(n),this.options.standalone&&this.hotMenu&&!r.isChildOf(n.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!r.isChildOf(n.target,".htMenu")&&r.isChildOf(n.target,document)&&this.close(!0))}}]),n}();c.mixin(h,nt.default);t.default=h},function(n,t,i){"use strict";function f(n,t){return Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(t)}}))}function a(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var e;t.__esModule=!0;var o=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),s=f(["The merged cell declared with {row: ",", col: ",", rowspan: \n    ",", colspan: ","} contains negative values, which is not supported. It \n    will not be added to the collection."],["The merged cell declared with {row: ",", col: ",", rowspan: \n    ",", colspan: ","} contains negative values, which is not supported. It \n    will not be added to the collection."]),h=f(["The merged cell declared at [",", ","] is positioned (or positioned partially) \n       outside of the table range. It was not added to the table, please fix your setup."],["The merged cell declared at [",", ","] is positioned (or positioned partially) \n       outside of the table range. It was not added to the table, please fix your setup."]),c=f(["The merged cell declared at [",", ",'] has both "rowspan" \n     and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.'],["The merged cell declared at [",", ",'] has both "rowspan" \n     and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.']),l=f(["The merged cell declared at [",", ",'] has "rowspan" or "colspan" declared as \n      "0", which is not supported. It cannot be added to the collection.'],["The merged cell declared at [",", ",'] has "rowspan" or "colspan" declared as \n      "0", which is not supported. It cannot be added to the collection.']),r=i(8),u=i(34);e=function(){function n(t,i,r,u){a(this,n);this.row=t;this.col=i;this.rowspan=r;this.colspan=u;this.removed=!1}return o(n,[{key:"normalize",value:function(n){var t=n.countRows(),i=n.countCols();this.row<0?this.row=0:this.row>t-1&&(this.row=t-1);this.col<0?this.col=0:this.col>i-1&&(this.col=i-1);this.row+this.rowspan>t-1&&(this.rowspan=t-this.row);this.col+this.colspan>i-1&&(this.colspan=i-this.col)}},{key:"includes",value:function(n,t){return this.row<=n&&this.col<=t&&this.row+this.rowspan-1>=n&&this.col+this.colspan-1>=t}},{key:"includesHorizontally",value:function(n){return this.col<=n&&this.col+this.colspan-1>=n}},{key:"includesVertically",value:function(n){return this.row<=n&&this.row+this.rowspan-1>=n}},{key:"shift",value:function(n,t){var r=n[0]||n[1],c=t+Math.abs(n[0]||n[1])-1,e=n[0]?"colspan":"rowspan",s=n[0]?"col":"row",u=Math.min(t,c),o=Math.max(t,c),i=this[s],f=this[s]+this[e]-1,h,l,a;if(i>=t&&(this[s]+=r),r>0)t<=f&&t>i&&(this[e]+=r);else if(r<0){if(u<=i&&o>=f)return this.removed=!0,!1;i>=u&&i<=o?(h=o-i+1,l=Math.abs(r)-h,this[s]-=l,this[e]-=h):i<=u&&f>=o?this[e]+=r:i<=u&&f>=u&&f<o&&(a=f-u+1,this[e]-=a)}return!0}},{key:"isFarther",value:function(n,t){return n?t==="down"?n.row+n.rowspan-1<this.row+this.rowspan-1:t==="up"?n.row>this.row:t==="right"?n.col+n.colspan-1<this.col+this.colspan-1:t==="left"?n.col>this.col:null:!0}},{key:"getLastRow",value:function(){return this.row+this.rowspan-1}},{key:"getLastColumn",value:function(){return this.col+this.colspan-1}},{key:"getRange",value:function(){return new r.CellRange(new r.CellCoords(this.row,this.col),new r.CellCoords(this.row,this.col),new r.CellCoords(this.getLastRow(),this.getLastColumn()))}}],[{key:"NEGATIVE_VALUES_WARNING",value:function(n){return u.toSingleLine(s,n.row,n.col,n.rowspan,n.colspan)}},{key:"IS_OUT_OF_BOUNDS_WARNING",value:function(n){return u.toSingleLine(h,n.row,n.col)}},{key:"IS_SINGLE_CELL",value:function(n){return u.toSingleLine(c,n.row,n.col)}},{key:"ZERO_SPAN_WARNING",value:function(n){return u.toSingleLine(l,n.row,n.col)}},{key:"containsNegativeValues",value:function(n){return n.row<0||n.col<0||n.rowspan<0||n.colspan<0}},{key:"isSingleCell",value:function(n){return n.colspan===1&&n.rowspan===1}},{key:"containsZeroSpan",value:function(n){return n.colspan===0||n.rowspan===0}},{key:"isOutOfBounds",value:function(n,t,i){return n.row<0||n.col<0||n.row>=t||n.row+n.rowspan-1>=t||n.col>=i||n.col+n.colspan-1>=i}}]),n}();t.default=e},function(n,t,i){"use strict";function l(n,t,i){return t in n?Object.defineProperty(n,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[t]=i,n}function kt(n){var t=[];return et[n]||(n=ft),st.arrayEach(et[n],function(n){var i=void 0;i=n===r.SEPARATOR?{name:r.SEPARATOR}:ot.clone(ht.getConditionDescriptor(n));t.push(i)}),t}var u;t.__esModule=!0;t.TYPES=t.TYPE_DATE=t.TYPE_TEXT=t.TYPE_NUMERIC=t.OPERATION_OR_THEN_VARIABLE=t.OPERATION_OR=t.OPERATION_AND=t.CONDITION_FALSE=t.CONDITION_TRUE=t.CONDITION_BY_VALUE=t.CONDITION_YESTERDAY=t.CONDITION_TODAY=t.CONDITION_TOMORROW=t.CONDITION_DATE_AFTER=t.CONDITION_DATE_BEFORE=t.CONDITION_NOT_CONTAINS=t.CONDITION_CONTAINS=t.CONDITION_ENDS_WITH=t.CONDITION_BEGINS_WITH=t.CONDITION_NOT_BETWEEN=t.CONDITION_BETWEEN=t.CONDITION_LESS_THAN_OR_EQUAL=t.CONDITION_LESS_THAN=t.CONDITION_GREATER_THAN_OR_EQUAL=t.CONDITION_GREATER_THAN=t.CONDITION_NOT_EQUAL=t.CONDITION_EQUAL=t.CONDITION_NOT_EMPTY=t.CONDITION_EMPTY=t.CONDITION_NONE=undefined;t.default=kt;var ot=i(1),st=i(0),r=i(44),ht=i(10),f=i(395),e=i(219),o=i(396),s=i(220),h=i(397),a=i(398),v=i(399),y=i(400),p=i(401),c=i(221),w=i(402),b=i(403),k=i(404),d=i(224),g=i(405),nt=i(223),tt=i(222),it=i(406),rt=i(407),ut=i(408),ct=i(409),lt=i(410),at=i(411),vt=i(160),yt=i(225),pt=i(226);t.CONDITION_NONE=f.CONDITION_NAME;t.CONDITION_EMPTY=e.CONDITION_NAME;t.CONDITION_NOT_EMPTY=o.CONDITION_NAME;t.CONDITION_EQUAL=s.CONDITION_NAME;t.CONDITION_NOT_EQUAL=h.CONDITION_NAME;t.CONDITION_GREATER_THAN=a.CONDITION_NAME;t.CONDITION_GREATER_THAN_OR_EQUAL=v.CONDITION_NAME;t.CONDITION_LESS_THAN=y.CONDITION_NAME;t.CONDITION_LESS_THAN_OR_EQUAL=p.CONDITION_NAME;t.CONDITION_BETWEEN=c.CONDITION_NAME;t.CONDITION_NOT_BETWEEN=w.CONDITION_NAME;t.CONDITION_BEGINS_WITH=b.CONDITION_NAME;t.CONDITION_ENDS_WITH=k.CONDITION_NAME;t.CONDITION_CONTAINS=d.CONDITION_NAME;t.CONDITION_NOT_CONTAINS=g.CONDITION_NAME;t.CONDITION_DATE_BEFORE=nt.CONDITION_NAME;t.CONDITION_DATE_AFTER=tt.CONDITION_NAME;t.CONDITION_TOMORROW=it.CONDITION_NAME;t.CONDITION_TODAY=rt.CONDITION_NAME;t.CONDITION_YESTERDAY=ut.CONDITION_NAME;t.CONDITION_BY_VALUE=ct.CONDITION_NAME;t.CONDITION_TRUE=lt.CONDITION_NAME;t.CONDITION_FALSE=at.CONDITION_NAME;t.OPERATION_AND=vt.OPERATION_ID;t.OPERATION_OR=yt.OPERATION_ID;t.OPERATION_OR_THEN_VARIABLE=pt.OPERATION_ID;var wt=t.TYPE_NUMERIC="numeric",ft=t.TYPE_TEXT="text",bt=t.TYPE_DATE="date",et=t.TYPES=(u={},l(u,wt,[f.CONDITION_NAME,r.SEPARATOR,e.CONDITION_NAME,o.CONDITION_NAME,r.SEPARATOR,s.CONDITION_NAME,h.CONDITION_NAME,r.SEPARATOR,a.CONDITION_NAME,v.CONDITION_NAME,y.CONDITION_NAME,p.CONDITION_NAME,c.CONDITION_NAME,w.CONDITION_NAME]),l(u,ft,[f.CONDITION_NAME,r.SEPARATOR,e.CONDITION_NAME,o.CONDITION_NAME,r.SEPARATOR,s.CONDITION_NAME,h.CONDITION_NAME,r.SEPARATOR,b.CONDITION_NAME,k.CONDITION_NAME,r.SEPARATOR,d.CONDITION_NAME,g.CONDITION_NAME]),l(u,bt,[f.CONDITION_NAME,r.SEPARATOR,e.CONDITION_NAME,o.CONDITION_NAME,r.SEPARATOR,s.CONDITION_NAME,h.CONDITION_NAME,r.SEPARATOR,nt.CONDITION_NAME,tt.CONDITION_NAME,c.CONDITION_NAME,r.SEPARATOR,it.CONDITION_NAME,rt.CONDITION_NAME,ut.CONDITION_NAME]),u)},function(n,t,i){"use strict";function h(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function f(n,t){return n.every(function(n){return n.func(t)})}var r,u;t.__esModule=!0;t.SHORT_NAME_FOR_COMPONENT=t.OPERATION_ID=undefined;t.operationResult=f;var e=i(3),o=h(e),s=i(64);r=t.OPERATION_ID="conjunction";u=t.SHORT_NAME_FOR_COMPONENT=o.FILTERS_LABELS_CONJUNCTION;s.registerOperation(r,u,f)},function(n,t,i){"use strict";function y(n){return n&&n.__esModule?n:{"default":n}}function p(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function w(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function b(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function k(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var r,o;t.__esModule=!0;var s=function h(n,t,i){var r,u,f;return n===null&&(n=Function.prototype),r=Object.getOwnPropertyDescriptor(n,t),r===undefined?(u=Object.getPrototypeOf(n),u===null?undefined:h(u,t,i)):"value"in r?r.value:(f=r.get,f===undefined)?undefined:f.call(i)},u=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),f=i(2),e=i(1),c=i(3),l=p(c),a=i(65),v=y(a);r=new WeakMap;o=function(n){function t(n,i){w(this,t);var u=b(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n,e.extend(t.DEFAULTS,i)));return r.set(u,{}),u.registerHooks(),u}return k(t,n),u(t,null,[{key:"DEFAULTS",get:function(){return e.clone({placeholder:"",type:"text",tagName:"input"})}}]),u(t,[{key:"registerHooks",value:function(){var n=this;this.addLocalHook("click",function(t){return n.onClick(t)});this.addLocalHook("keyup",function(t){return n.onKeyup(t)})}},{key:"build",value:function(){s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"build",this).call(this);var i=r.get(this),n=document.createElement("div");i.input=this._element.firstChild;f.addClass(this._element,"htUIInput");f.addClass(n,"htUIInputIcon");this._element.appendChild(n);this.update()}},{key:"update",value:function(){if(this.isBuilt()){var n=r.get(this).input;n.type=this.options.type;n.placeholder=this.hot.getTranslatedPhrase(this.options.placeholder);n.value=typeof this.options.value=="string"&&this.options.value.startsWith(l.FILTERS_NAMESPACE)?this.hot.getTranslatedPhrase(this.options.value):this.options.value}}},{key:"focus",value:function(){this.isBuilt()&&r.get(this).input.focus()}},{key:"onClick",value:function(){}},{key:"onKeyup",value:function(n){this.options.value=n.target.value}}]),t}(v.default);t.default=o},function(n,t){"use strict";function r(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}t.__esModule=!0;var i=function i(n,t){r(this,i);this.hot=t;this.plugin=n};t.default=i},function(n,t,i){"use strict";var h=i(22).f,c=i(87),l=i(70),a=i(40),v=i(72),y=i(73),p=i(172),f=i(174),w=i(175),o=i(24),s=i(42).fastKey,r=i(51),u=o?"_s":"size",e=function(n,t){var r=s(t),i;if(r!=="F")return n._i[r];for(i=n._f;i;i=i.n)if(i.k==t)return i};n.exports={getConstructor:function(n,t,i,f){var s=n(function(n,r){v(n,s,t,"_i");n._t=t;n._i=c(null);n._f=undefined;n._l=undefined;n[u]=0;r!=undefined&&y(r,i,n[f],n)});return l(s.prototype,{clear:function(){for(var i=r(this,t),f=i._i,n=i._f;n;n=n.n)n.r=!0,n.p&&(n.p=n.p.n=undefined),delete f[n.i];i._f=i._l=undefined;i[u]=0},"delete":function(n){var f=r(this,t),i=e(f,n),o,s;return i&&(o=i.n,s=i.p,delete f._i[i.i],i.r=!0,s&&(s.n=o),o&&(o.p=s),f._f==i&&(f._f=o),f._l==i&&(f._l=s),f[u]--),!!i},forEach:function(n){r(this,t);for(var u=a(n,arguments.length>1?arguments[1]:undefined,3),i;i=i?i.n:this._f;)for(u(i.v,i.k,this);i&&i.r;)i=i.p},has:function(n){return!!e(r(this,t),n)}}),o&&h(s.prototype,"size",{get:function(){return r(this,t)[u]}}),s},def:function(n,t,i){var r=e(n,t),f,o;return r?r.v=i:(n._l=r={i:o=s(t,!0),k:t,v:i,p:f=n._l,n:undefined,r:!1},n._f||(n._f=r),f&&(f.n=r),n[u]++,o!=="F"&&(n._i[o]=r)),n},getEntry:e,setStrong:function(n,t,i){p(n,t,function(n,i){this._t=r(n,t);this._k=i;this._l=undefined},function(){for(var t=this,i=t._k,n=t._l;n&&n.r;)n=n.p;return!t._t||!(t._l=n=n?n.n:t._t._f)?(t._t=undefined,f(1)):i=="keys"?f(0,n.k):i=="values"?f(0,n.v):f(0,[n.k,n.v])},i?"entries":"values",!i,!0);w(t)}}},function(n,t,i){n.exports=!i(24)&&!i(25)(function(){return Object.defineProperty(i(85)("div"),"a",{get:function(){return 7}}).a!=7})},function(n,t,i){var r=i(32),u=i(26),f=i(166)(!1),e=i(89)("IE_PROTO");n.exports=function(n,t){var s=u(n),h=0,o=[];for(var i in s)i!=e&&r(s,i)&&o.push(i);while(t.length>h)r(s,i=t[h++])&&(~f(o,i)||o.push(i));return o}},function(n,t,i){var r=i(26),u=i(27),f=i(69);n.exports=function(n){return function(t,i,e){var s=r(t),h=u(s.length),o=f(e,h),c;if(n&&i!=i){while(h>o)if(c=s[o++],c!=c)return!0}else for(;h>o;o++)if((n||o in s)&&s[o]===i)return n||o||0;return!n&&-1}}},function(n,t,i){var r=i(17).document;n.exports=r&&r.documentElement},function(n,t,i){var r=i(20);n.exports=function(n,t,i,u){try{return u?t(r(i)[0],i[1]):t(i)}catch(e){var f=n["return"];f!==undefined&&r(f.call(n));throw e;}}},function(n,t,i){var r=i(57),u=i(16)("iterator"),f=Array.prototype;n.exports=function(n){return n!==undefined&&(r.Array===n||f[u]===n)}},function(n,t,i){var r=i(171),u=i(16)("iterator"),f=i(57);n.exports=i(50).getIteratorMethod=function(n){if(n!=undefined)return n[u]||n["@@iterator"]||f[r(n)]}},function(n,t,i){var r=i(49),u=i(16)("toStringTag"),f=r(function(){return arguments}())=="Arguments",e=function(n,t){try{return n[t]}catch(i){}};n.exports=function(n){var t,i,o;return n===undefined?"Undefined":n===null?"Null":typeof(i=e(t=Object(n),u))=="string"?i:f?r(t):(o=r(t))=="Object"&&typeof t.callee=="function"?"Arguments":o}},function(n,t,i){"use strict";var o=i(74),e=i(5),a=i(38),s=i(39),v=i(32),h=i(57),y=i(235),p=i(58),w=i(173),r=i(16)("iterator"),u=!([].keys&&"next"in[].keys()),b="@@iterator",c="keys",f="values",l=function(){return this};n.exports=function(n,t,i,k,d,g,nt){y(i,t,k);var et=function(n){if(!u&&n in tt)return tt[n];switch(n){case c:return function(){return new i(this,n)};case f:return function(){return new i(this,n)}}return function(){return new i(this,n)}},ct=t+" Iterator",st=d==f,ht=!1,tt=n.prototype,it=tt[r]||tt[b]||d&&tt[d],rt=!u&&it||et(d),at=d?st?et("entries"):rt:undefined,lt=t=="Array"?tt.entries||it:it,ft,ot,ut;if(lt&&(ut=w(lt.call(new n)),ut!==Object.prototype&&ut.next&&(p(ut,ct,!0),o||v(ut,r)||s(ut,r,l))),st&&it&&it.name!==f&&(ht=!0,rt=function(){return it.call(this)}),(!o||nt)&&(u||ht||!tt[r])&&s(tt,r,rt),h[t]=rt,h[ct]=l,d)if(ft={values:st?rt:et(f),keys:g?rt:et(c),entries:at},nt)for(ot in ft)ot in tt||a(tt,ot,ft[ot]);else e(e.P+e.F*(u||ht),t,ft);return ft}},function(n,t,i){var u=i(32),f=i(41),r=i(89)("IE_PROTO"),e=Object.prototype;n.exports=Object.getPrototypeOf||function(n){return(n=f(n),u(n,r))?n[r]:typeof n.constructor=="function"&&n instanceof n.constructor?n.constructor.prototype:n instanceof Object?e:null}},function(n){n.exports=function(n,t){return{value:t,done:!!n}}},function(n,t,i){"use strict";var u=i(17),f=i(22),e=i(24),r=i(16)("species");n.exports=function(n){var t=u[n];e&&t&&!t[r]&&f.f(t,r,{configurable:!0,get:function(){return this}})}},function(n,t,i){var u=i(12),f=i(20),r=function(n,t){if(f(n),!u(t)&&t!==null)throw TypeError(t+": can't set as prototype!");};n.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(n,t,u){try{u=i(40)(Function.call,i(76).f(Object.prototype,"__proto__").set,2);u(n,[]);t=!(n instanceof Array)}catch(f){t=!0}return function(n,i){return r(n,i),t?n.__proto__=i:u(n,i),n}}({},!1):undefined),check:r}},function(n,t,i){var r=i(49);n.exports=Array.isArray||function(n){return r(n)=="Array"}},function(n,t,i){"use strict";var u=i(46),f=i(78),e=i(59),o=i(41),s=i(88),r=Object.assign;n.exports=!r||i(25)(function(){var n={},t={},i=Symbol(),u="abcdefghijklmnopqrst";return n[i]=7,u.split("").forEach(function(n){t[n]=n}),r({},n)[i]!=7||Object.keys(r({},t)).join("")!=u})?function(n){for(var r=o(n),v=arguments.length,h=1,c=f.f,y=e.f;v>h;)for(var t=s(arguments[h++]),l=c?u(t).concat(c(t)):u(t),p=l.length,a=0,i;p>a;)y.call(t,i=l[a++])&&(r[i]=t[i]);return r}:r},function(n,t,i){"use strict";var l=i(70),u=i(42).getWeak,a=i(20),e=i(12),v=i(72),y=i(73),o=i(77),s=i(32),h=i(51),p=o(5),w=o(6),b=0,r=function(n){return n._l||(n._l=new c)},c=function(){this.a=[]},f=function(n,t){return p(n.a,function(n){return n[0]===t})};c.prototype={get:function(n){var t=f(this,n);if(t)return t[1]},has:function(n){return!!f(this,n)},set:function(n,t){var i=f(this,n);i?i[1]=t:this.a.push([n,t])},"delete":function(n){var t=w(this.a,function(t){return t[0]===n});return~t&&this.a.splice(t,1),!!~t}};n.exports={getConstructor:function(n,t,i,f){var o=n(function(n,r){v(n,o,t,"_i");n._t=t;n._i=b++;n._l=undefined;r!=undefined&&y(r,i,n[f],n)});return l(o.prototype,{"delete":function(n){if(!e(n))return!1;var i=u(n);return i===!0?r(h(this,t))["delete"](n):i&&s(i,this._i)&&delete i[this._i]},has:function(n){if(!e(n))return!1;var i=u(n);return i===!0?r(h(this,t)).has(n):i&&s(i,this._i)}}),o},def:function(n,t,i){var f=u(a(t),!0);return f===!0?r(n).set(t,i):f[n._i]=i,n},ufstore:r}},function(n,t,i){"use strict";function u(n){var t,i;this.promise=new n(function(n,r){if(t!==undefined||i!==undefined)throw TypeError("Bad Promise constructor");t=n;i=r});this.resolve=r(t);this.reject=r(i)}var r=i(71);n.exports.f=function(n){return new u(n)}},function(n,t,i){t.f=i(16)},function(n,t,i){var f=i(26),r=i(99).f,e={}.toString,u=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],o=function(n){try{return r(n)}catch(t){return u.slice()}};n.exports.f=function(n){return u&&e.call(n)=="[object Window]"?o(n):r(f(n))}},function(n,t,i){"use strict";var r=i(68),u=i(47);n.exports=function(n){var i=String(u(this)),f="",t=r(n);if(t<0||t==Infinity)throw RangeError("Count can't be negative");for(;t>0;(t>>>=1)&&(i+=i))t&1&&(f+=i);return f}},function(n,t,i){var r=i(12),u=i(49),f=i(16)("match");n.exports=function(n){var t;return r(n)&&((t=n[f])!==undefined?!!t:u(n)=="RegExp")}},function(n,t,i){var r=i(12),u=Math.floor;n.exports=function(n){return!r(n)&&isFinite(n)&&u(n)===n}},function(n,t,i){var r=i(46),u=i(26),f=i(59).f;n.exports=function(n){return function(t){for(var i=u(t),o=r(i),c=o.length,s=0,h=[],e;c>s;)f.call(i,e=o[s++])&&h.push(n?[e,i[e]]:i[e]);return h}}},function(n,t,i){var r=i(27),u=i(183),f=i(47);n.exports=function(n,t,i,e){var s=String(f(n)),l=s.length,c=i===undefined?" ":String(i),a=r(t),h,o;return a<=l||c==""?s:(h=a-l,o=u.call(c,Math.ceil(h/c.length)),o.length>h&&(o=o.slice(0,h)),e?o+s:s+o)}},function(n,t,i){var u=i(17),r=u.navigator;n.exports=r&&r.userAgent||""},function(n,t){"use strict";function f(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var r,i,u;t.__esModule=!0;r=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}();i=new WeakMap;u=function(){function n(t,r,u,e,o,s,h){var c=arguments.length>7&&arguments[7]!==undefined?arguments[7]:function(n){return n};f(this,n);i.set(this,{viewportWidth:t,scrollOffset:r,totalColumns:u,columnWidthFn:e,overrideFn:o,onlyFullyVisible:s,stretchingColumnWidthFn:c});this.count=0;this.startColumn=null;this.endColumn=null;this.startPosition=null;this.stretchAllRatio=0;this.stretchLastWidth=0;this.stretch=h;this.totalTargetWidth=0;this.needVerifyLastColumnWidth=!0;this.stretchAllColumnsWidth=[];this.calculate()}return r(n,null,[{key:"DEFAULT_WIDTH",get:function(){return 50}}]),r(n,[{key:"calculate",value:function(){for(var v,h,t=0,c=!0,e=[],o=void 0,r=i.get(this),s=r.onlyFullyVisible,l=r.overrideFn,u=r.scrollOffset,a=r.totalColumns,f=r.viewportWidth,n=0;n<a;n++)if(o=this._getColumnWidth(n),t<=u&&!s&&(this.startColumn=n),v=u>0?f+1:f,t>=u&&t+o<=u+v&&(this.startColumn==null&&(this.startColumn=n),this.endColumn=n),e.push(t),t+=o,s||(this.endColumn=n),t>=u+f){c=!1;break}if(this.endColumn===a-1&&c)for(this.startColumn=this.endColumn;this.startColumn>0;)if(h=e[this.endColumn]+o-e[this.startColumn-1],(h<=f||!s)&&this.startColumn--,h>f)break;this.startColumn!==null&&l&&l(this);this.startPosition=e[this.startColumn];this.startPosition==void 0&&(this.startPosition=null);this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}},{key:"refreshStretching",value:function(n){var t,c,u,f,e,o;if(this.stretch!=="none"){this.totalTargetWidth=n;var s=i.get(this),h=s.totalColumns,r=0;for(t=0;t<h;t++)c=this._getColumnWidth(t),u=s.stretchingColumnWidthFn(void 0,t),typeof u=="number"?n-=u:r+=c;f=n-r;this.stretch==="all"&&f>0?(this.stretchAllRatio=n/r,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0):this.stretch==="last"&&n!==Infinity&&(e=this._getColumnWidth(h-1),o=f+e,this.stretchLastWidth=o>=0?o:e)}}},{key:"getStretchedColumnWidth",value:function(n,t){var i=null;return this.stretch==="all"&&this.stretchAllRatio!==0?i=this._getStretchedAllColumnWidth(n,t):this.stretch==="last"&&this.stretchLastWidth!==0&&(i=this._getStretchedLastColumnWidth(n)),i}},{key:"_getStretchedAllColumnWidth",value:function(n,t){var f=0,o=i.get(this),s=o.totalColumns,e,r,u;if(this.stretchAllColumnsWidth[n]||(e=Math.round(t*this.stretchAllRatio),r=o.stretchingColumnWidthFn(e,n),this.stretchAllColumnsWidth[n]=r===void 0?e:isNaN(r)?this._getColumnWidth(n):r),this.stretchAllColumnsWidth.length===s&&this.needVerifyLastColumnWidth){for(this.needVerifyLastColumnWidth=!1,u=0;u<this.stretchAllColumnsWidth.length;u++)f+=this.stretchAllColumnsWidth[u];f!==this.totalTargetWidth&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=this.totalTargetWidth-f)}return this.stretchAllColumnsWidth[n]}},{key:"_getStretchedLastColumnWidth",value:function(n){var t=i.get(this),r=t.totalColumns;return n===r-1?this.stretchLastWidth:null}},{key:"_getColumnWidth",value:function(t){var r=i.get(this).columnWidthFn(t);return r===void 0&&(r=n.DEFAULT_WIDTH),r}}]),n}();t.default=u},function(n,t){"use strict";function f(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var i,r,u;t.__esModule=!0;i=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}();r=new WeakMap;u=function(){function n(t,i,u,e,o,s,h){f(this,n);r.set(this,{viewportHeight:t,scrollOffset:i,totalRows:u,rowHeightFn:e,overrideFn:o,onlyFullyVisible:s,horizontalScrollbarHeight:h});this.count=0;this.startRow=null;this.endRow=null;this.startPosition=null;this.calculate()}return i(n,null,[{key:"DEFAULT_HEIGHT",get:function(){return 23}}]),i(n,[{key:"calculate",value:function(){for(var l,u=0,a=!0,e=[],t=r.get(this),c=t.onlyFullyVisible,v=t.overrideFn,p=t.rowHeightFn,o=t.scrollOffset,y=t.totalRows,s=t.viewportHeight,h=t.horizontalScrollbarHeight||0,f=void 0,i=0;i<y;i++)if(f=p(i),f===undefined&&(f=n.DEFAULT_HEIGHT),u<=o&&!c&&(this.startRow=i),u>=o&&u+f<=o+s-h&&(this.startRow===null&&(this.startRow=i),this.endRow=i),e.push(u),u+=f,c||(this.endRow=i),u>=o+s-h){a=!1;break}if(this.endRow===y-1&&a)for(this.startRow=this.endRow;this.startRow>0;)if(l=e[this.endRow]+f-e[this.startRow-1],(l<=s-h||!c)&&this.startRow--,l>=s-h)break;this.startRow!==null&&v&&v(this);this.startPosition=e[this.startRow];this.startPosition==void 0&&(this.startPosition=null);this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}]),n}();t.default=u},function(n,t){"use strict";function u(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var i,r;t.__esModule=!0;i=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}();r=function(){function n(t,i,r){u(this,n);this.offset=t;this.total=i;this.countTH=r}return i(n,[{key:"offsetted",value:function(n){return n+this.offset}},{key:"unOffsetted",value:function(n){return n-this.offset}},{key:"renderedToSource",value:function(n){return this.offsetted(n)}},{key:"sourceToRendered",value:function(n){return this.unOffsetted(n)}},{key:"offsettedTH",value:function(n){return n-this.countTH}},{key:"unOffsettedTH",value:function(n){return n+this.countTH}},{key:"visibleRowHeadedColumnToSourceColumn",value:function(n){return this.renderedToSource(this.offsettedTH(n))}},{key:"sourceColumnToVisibleRowHeadedColumn",value:function(n){return this.unOffsettedTH(this.sourceToRendered(n))}}]),n}();t.default=r},function(n,t){"use strict";function u(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var i,r;t.__esModule=!0;i=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}();r=function(){function n(t,i,r){u(this,n);this.offset=t;this.total=i;this.countTH=r}return i(n,[{key:"offsetted",value:function(n){return n+this.offset}},{key:"unOffsetted",value:function(n){return n-this.offset}},{key:"renderedToSource",value:function(n){return this.offsetted(n)}},{key:"sourceToRendered",value:function(n){return this.unOffsetted(n)}},{key:"offsettedTH",value:function(n){return n-this.countTH}},{key:"unOffsettedTH",value:function(n){return n+this.countTH}},{key:"visibleColHeadedRowToSourceRow",value:function(n){return this.renderedToSource(this.offsettedTH(n))}},{key:"sourceRowToVisibleColHeadedRow",value:function(n){return this.unOffsettedTH(this.sourceToRendered(n))}}]),n}();t.default=r},function(n,t,i){"use strict";function r(n){return n&&n.__esModule?n:{"default":n}}function nt(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var h;t.__esModule=!0;var c=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),u=i(2),l=i(1),f=i(30),a=i(194),e=r(a),v=i(195),y=r(v),p=i(196),o=r(p),w=i(197),b=r(w),k=i(198),s=r(k),d=i(200),g=r(d);h=function(){function n(t){var r,i,h;if(nt(this,n),r=[],this.guid="wt_"+f.randomString(),t.cloneSource?(this.cloneSource=t.cloneSource,this.cloneOverlay=t.cloneOverlay,this.wtSettings=t.cloneSource.wtSettings,this.wtTable=new s.default(this,t.table,t.wtRootElement),this.wtScroll=new o.default(this),this.wtViewport=t.cloneSource.wtViewport,this.wtEvent=new e.default(this),this.selections=this.cloneSource.selections):(this.wtSettings=new b.default(this,t),this.wtTable=new s.default(this,t.table),this.wtScroll=new o.default(this),this.wtViewport=new g.default(this),this.wtEvent=new e.default(this),this.selections=this.getSetting("selections"),this.wtOverlays=new y.default(this),this.exportSettingsAsClassNames()),this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(i=0,h=this.wtTable.THEAD.childNodes[0].childNodes.length;i<h;i++)r.push(this.wtTable.THEAD.childNodes[0].childNodes[i].innerHTML);this.getSetting("columnHeaders").length||this.update("columnHeaders",[function(n,t){u.fastInnerText(t,r[n])}])}this.drawn=!1;this.drawInterrupted=!1}return c(n,[{key:"draw",value:function(){var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:!1;return this.drawInterrupted=!1,n||u.isVisible(this.wtTable.TABLE)?this.wtTable.draw(n):this.drawInterrupted=!0,this}},{key:"getCell",value:function(n){var f=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!1;if(!f)return this.wtTable.getCell(n);var t=this.wtSettings.getSetting("totalRows"),r=this.wtSettings.getSetting("fixedRowsTop"),u=this.wtSettings.getSetting("fixedRowsBottom"),i=this.wtSettings.getSetting("fixedColumnsLeft");if(n.row<r&&n.col<i)return this.wtOverlays.topLeftCornerOverlay.clone.wtTable.getCell(n);if(n.row<r)return this.wtOverlays.topOverlay.clone.wtTable.getCell(n);if(n.col<i&&n.row>=t-u){if(this.wtOverlays.bottomLeftCornerOverlay&&this.wtOverlays.bottomLeftCornerOverlay.clone)return this.wtOverlays.bottomLeftCornerOverlay.clone.wtTable.getCell(n)}else{if(n.col<i)return this.wtOverlays.leftOverlay.clone.wtTable.getCell(n);if(n.row<t&&n.row>t-u&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(n)}return this.wtTable.getCell(n)}},{key:"update",value:function(n,t){return this.wtSettings.update(n,t)}},{key:"scrollVertical",value:function(n){return this.wtOverlays.topOverlay.scrollTo(n),this.getSetting("onScrollVertically"),this}},{key:"scrollHorizontal",value:function(n){return this.wtOverlays.leftOverlay.scrollTo(n),this.getSetting("onScrollHorizontally"),this}},{key:"scrollViewport",value:function(n){return this.wtScroll.scrollViewport(n),this}},{key:"getViewport",value:function(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}},{key:"getOverlayName",value:function(){return this.cloneOverlay?this.cloneOverlay.type:"master"}},{key:"isOverlayName",value:function(n){return this.cloneOverlay?this.cloneOverlay.type===n:!1}},{key:"exportSettingsAsClassNames",value:function(){var i=this,n=[],t=[];l.objectEach({rowHeaders:["array"],columnHeaders:["array"]},function(r,u){r.indexOf("array")>-1&&i.getSetting(u).length&&t.push("ht"+f.toUpperCaseFirst(u));n.push("ht"+f.toUpperCaseFirst(u))});u.removeClass(this.wtTable.wtRootElement.parentNode,n);u.addClass(this.wtTable.wtRootElement.parentNode,t)}},{key:"getSetting",value:function(n,t,i,r,u){return this.wtSettings.getSetting(n,t,i,r,u)}},{key:"hasSetting",value:function(n){return this.wtSettings.has(n)}},{key:"destroy",value:function(){this.wtOverlays.destroy();this.wtEvent.destroy()}}]),n}();t.default=h},function(n,t,i){"use strict";function h(n){return n&&n.__esModule?n:{"default":n}}function u(n){var t=this,i=new s.default(n),u,o;this.instance=n;u=[null,null];this.dblClickTimeout=[null,null];var h=function(n){var o=document.activeElement,s=f.partial(r.getParent,n.realTarget),e=n.realTarget,i;e!==o&&s(0)!==o&&s(1)!==o&&(i=t.parentCell(e),r.hasClass(e,"corner")?t.instance.getSetting("onCellCornerMouseDown",n,e):i.TD&&t.instance.hasSetting("onCellMouseDown")&&t.instance.getSetting("onCellMouseDown",n,i.coords,i.TD,t.instance),n.button!==2&&i.TD&&(u[0]=i.TD,clearTimeout(t.dblClickTimeout[0]),t.dblClickTimeout[0]=setTimeout(function(){u[0]=null},1e3)))},c=function(){t.instance.touchMoving=!0},a,v=function(n){var r=this;i.addEventListener(this,"touchmove",c);t.checkIfTouchMove=setTimeout(function(){t.instance.touchMoving===!0&&(t.instance.touchMoving=void 0,i.removeEventListener("touchmove",c,!1));h(n)},30)},y=function(n){var u,i,f;t.instance.hasSetting("onCellMouseOver")&&(u=t.instance.wtTable.TABLE,i=r.closestDown(n.realTarget,["TD","TH"],u),f=t.instance.cloneSource||t.instance,i&&i!==f.lastMouseOver&&r.isChildOf(i,u)&&(f.lastMouseOver=i,t.instance.getSetting("onCellMouseOver",n,t.instance.wtTable.getCoords(i),i,t.instance)))},p=function(n){var u=void 0,i=void 0,f=void 0;t.instance.hasSetting("onCellMouseOut")&&(u=t.instance.wtTable.TABLE,i=r.closestDown(n.realTarget,["TD","TH"],u),f=r.closestDown(n.relatedTarget,["TD","TH"],u),i&&i!==f&&r.isChildOf(i,u)&&t.instance.getSetting("onCellMouseOut",n,t.instance.wtTable.getCoords(i),i,t.instance))},l=function(n){if(n.button!==2){var i=t.parentCell(n.realTarget);i.TD===u[0]&&i.TD===u[1]?(r.hasClass(n.realTarget,"corner")?t.instance.getSetting("onCellCornerDblClick",n,i.coords,i.TD,t.instance):t.instance.getSetting("onCellDblClick",n,i.coords,i.TD,t.instance),u[0]=null,u[1]=null):i.TD===u[0]?(t.instance.getSetting("onCellMouseUp",n,i.coords,i.TD,t.instance),u[1]=i.TD,clearTimeout(t.dblClickTimeout[1]),t.dblClickTimeout[1]=setTimeout(function(){u[1]=null},500)):i.TD&&t.instance.hasSetting("onCellMouseUp")&&t.instance.getSetting("onCellMouseUp",n,i.coords,i.TD,t.instance)}},w=function(n){clearTimeout(a);n.preventDefault();l(n)};i.addEventListener(this.instance.wtTable.holder,"mousedown",h);i.addEventListener(this.instance.wtTable.TABLE,"mouseover",y);i.addEventListener(this.instance.wtTable.TABLE,"mouseout",p);i.addEventListener(this.instance.wtTable.holder,"mouseup",l);this.instance.wtTable.holder.parentNode.parentNode&&e.isMobileBrowser()&&!t.instance.wtTable.isWorkingOnClone()&&(o="."+this.instance.wtTable.holder.parentNode.className.split(" ").join("."),i.addEventListener(this.instance.wtTable.holder,"touchstart",function(n){t.instance.touchApplied=!0;r.isChildOf(n.target,o)&&v.call(n.target,n)}),i.addEventListener(this.instance.wtTable.holder,"touchend",function(n){t.instance.touchApplied=!1;r.isChildOf(n.target,o)&&w.call(n.target,n)}),t.instance.momentumScrolling||(t.instance.momentumScrolling={}),i.addEventListener(this.instance.wtTable.holder,"scroll",function(){clearTimeout(t.instance.momentumScrolling._timeout);t.instance.momentumScrolling.ongoing||t.instance.getSetting("onBeforeTouchScroll");t.instance.momentumScrolling.ongoing=!0;t.instance.momentumScrolling._timeout=setTimeout(function(){t.instance.touchApplied||(t.instance.momentumScrolling.ongoing=!1,t.instance.getSetting("onAfterMomentumScroll"))},200)}));i.addEventListener(window,"resize",function(){t.instance.getSetting("stretchH")!=="none"&&t.instance.draw()});this.destroy=function(){clearTimeout(this.dblClickTimeout[0]);clearTimeout(this.dblClickTimeout[1]);i.destroy()}}t.__esModule=!0;var r=i(2),f=i(35),e=i(33),o=i(9),s=h(o);u.prototype.parentCell=function(n){var t={},u=this.instance.wtTable.TABLE,i=r.closestDown(n,["TD","TH"],u);return i?(t.coords=this.instance.wtTable.getCoords(i),t.TD=i):r.hasClass(n,"wtBorder")&&r.hasClass(n,"current")?(t.coords=this.instance.selections.getCell().cellRange.highlight,t.TD=this.instance.wtTable.getCell(t.coords)):r.hasClass(n,"wtBorder")&&r.hasClass(n,"area")&&this.instance.selections.createOrGetArea().cellRange&&(t.coords=this.instance.selections.createOrGetArea().cellRange.to,t.TD=this.instance.wtTable.getCell(t.coords)),t};t.default=u},function(n,t,i){"use strict";function f(n){return n&&n.__esModule?n:{"default":n}}function v(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var e;t.__esModule=!0;var o=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),u=i(2),s=i(0),h=i(18),y=i(33),c=i(9),l=f(c),a=i(29),r=f(a);e=function(){function n(t){v(this,n);this.wot=t;this.instance=this.wot;this.eventManager=new l.default(this.wot);this.wot.update("scrollbarWidth",u.getScrollbarWidth());this.wot.update("scrollbarHeight",u.getScrollbarWidth());this.scrollableElement=u.getScrollableElement(this.wot.wtTable.TABLE);this.prepareOverlays();this.destroyed=!1;this.keyPressed=!1;this.spreaderLastSize={width:null,height:null};this.overlayScrollPositions={master:{top:0,left:0},top:{top:null,left:0},bottom:{top:null,left:0},left:{top:0,left:null}};this.pendingScrollCallbacks={master:{top:0,left:0},top:{left:0},bottom:{left:0},left:{top:0}};this.verticalScrolling=!1;this.horizontalScrolling=!1;this.delegatedScrollCallback=!1;this.registeredListeners=[];this.registerListeners()}return o(n,[{key:"prepareOverlays",value:function(){var n=!1;return this.topOverlay?n=this.topOverlay.updateStateOfRendering()||n:this.topOverlay=r.default.createOverlay(r.default.CLONE_TOP,this.wot),r.default.hasOverlay(r.default.CLONE_BOTTOM)||(this.bottomOverlay={needFullRender:!1,updateStateOfRendering:function(){return!1}}),r.default.hasOverlay(r.default.CLONE_BOTTOM_LEFT_CORNER)||(this.bottomLeftCornerOverlay={needFullRender:!1,updateStateOfRendering:function(){return!1}}),this.bottomOverlay?n=this.bottomOverlay.updateStateOfRendering()||n:this.bottomOverlay=r.default.createOverlay(r.default.CLONE_BOTTOM,this.wot),this.leftOverlay?n=this.leftOverlay.updateStateOfRendering()||n:this.leftOverlay=r.default.createOverlay(r.default.CLONE_LEFT,this.wot),this.topOverlay.needFullRender&&this.leftOverlay.needFullRender&&(this.topLeftCornerOverlay?n=this.topLeftCornerOverlay.updateStateOfRendering()||n:this.topLeftCornerOverlay=r.default.createOverlay(r.default.CLONE_TOP_LEFT_CORNER,this.wot)),this.bottomOverlay.needFullRender&&this.leftOverlay.needFullRender&&(this.bottomLeftCornerOverlay?n=this.bottomLeftCornerOverlay.updateStateOfRendering()||n:this.bottomLeftCornerOverlay=r.default.createOverlay(r.default.CLONE_BOTTOM_LEFT_CORNER,this.wot)),this.wot.getSetting("debug")&&!this.debug&&(this.debug=r.default.createOverlay(r.default.CLONE_DEBUG,this.wot)),n}},{key:"refreshAll",value:function(){if(this.wot.drawn){if(!this.wot.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0);this.verticalScrolling&&this.leftOverlay.onScroll();this.horizontalScrolling&&this.topOverlay.onScroll();this.verticalScrolling=!1;this.horizontalScrolling=!1}}},{key:"registerListeners",value:function(){var n=this,r=this.topOverlay.mainTableScrollableElement,u=this.leftOverlay.mainTableScrollableElement,t=[],i;for(t.push([document.documentElement,"keydown",function(t){return n.onKeyDown(t)}]),t.push([document.documentElement,"keyup",function(){return n.onKeyUp()}]),t.push([document,"visibilitychange",function(){return n.onKeyUp()}]),t.push([r,"scroll",function(t){return n.onTableScroll(t)}]),r!==u&&t.push([u,"scroll",function(t){return n.onTableScroll(t)}]),this.topOverlay.needFullRender&&(t.push([this.topOverlay.clone.wtTable.holder,"scroll",function(t){return n.onTableScroll(t)}]),t.push([this.topOverlay.clone.wtTable.holder,"wheel",function(t){return n.onTableScroll(t)}])),this.bottomOverlay.needFullRender&&(t.push([this.bottomOverlay.clone.wtTable.holder,"scroll",function(t){return n.onTableScroll(t)}]),t.push([this.bottomOverlay.clone.wtTable.holder,"wheel",function(t){return n.onTableScroll(t)}])),this.leftOverlay.needFullRender&&(t.push([this.leftOverlay.clone.wtTable.holder,"scroll",function(t){return n.onTableScroll(t)}]),t.push([this.leftOverlay.clone.wtTable.holder,"wheel",function(t){return n.onTableScroll(t)}])),this.topLeftCornerOverlay&&this.topLeftCornerOverlay.needFullRender&&t.push([this.topLeftCornerOverlay.clone.wtTable.holder,"wheel",function(t){return n.onTableScroll(t)}]),this.bottomLeftCornerOverlay&&this.bottomLeftCornerOverlay.needFullRender&&t.push([this.bottomLeftCornerOverlay.clone.wtTable.holder,"wheel",function(t){return n.onTableScroll(t)}]),this.topOverlay.trimmingContainer!==window&&this.leftOverlay.trimmingContainer!==window&&t.push([window,"wheel",function(t){var i=void 0,r=t.wheelDeltaY||t.deltaY,u=t.wheelDeltaX||t.deltaX;n.topOverlay.clone.wtTable.holder.contains(t.realTarget)?i="top":n.bottomOverlay.clone&&n.bottomOverlay.clone.wtTable.holder.contains(t.realTarget)?i="bottom":n.leftOverlay.clone.wtTable.holder.contains(t.realTarget)?i="left":n.topLeftCornerOverlay&&n.topLeftCornerOverlay.clone&&n.topLeftCornerOverlay.clone.wtTable.holder.contains(t.realTarget)?i="topLeft":n.bottomLeftCornerOverlay&&n.bottomLeftCornerOverlay.clone&&n.bottomLeftCornerOverlay.clone.wtTable.holder.contains(t.realTarget)&&(i="bottomLeft");(i=="top"&&r!==0||i=="left"&&u!==0||i=="bottom"&&r!==0||(i==="topLeft"||i==="bottomLeft")&&(r!==0||u!==0))&&t.preventDefault()}]);t.length;)i=t.pop(),this.eventManager.addEventListener(i[0],i[1],i[2]),this.registeredListeners.push(i)}},{key:"deregisterListeners",value:function(){while(this.registeredListeners.length){var n=this.registeredListeners.pop();this.eventManager.removeEventListener(n[0],n[1],n[2])}}},{key:"onTableScroll",value:function(n){var t=this.leftOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,r=n.target;(!this.keyPressed||(i===window||r===window||n.target.contains(i))&&(t===window||r===window||n.target.contains(t)))&&(n.type==="scroll"?this.syncScrollPositions(n):this.translateMouseWheelToScroll(n))}},{key:"onKeyDown",value:function(n){this.keyPressed=h.isKey(n.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}},{key:"onKeyUp",value:function(){this.keyPressed=!1}},{key:"translateMouseWheelToScroll",value:function(n){var s=this.topOverlay.clone.wtTable.holder,h=this.bottomOverlay.clone?this.bottomOverlay.clone.wtTable.holder:null,c=this.leftOverlay.clone.wtTable.holder,l=this.topLeftCornerOverlay&&this.topLeftCornerOverlay.clone?this.topLeftCornerOverlay.clone.wtTable.holder:null,a=this.bottomLeftCornerOverlay&&this.bottomLeftCornerOverlay.clone?this.bottomLeftCornerOverlay.clone.wtTable.holder:null,u=-.2,f=n.wheelDeltaY||-1*n.deltaY,e=n.wheelDeltaX||-1*n.deltaX,t=null,r={type:"wheel"},i=n.target,o=null;for(n.deltaMode===1&&(f*=120,e*=120);i!=document&&i!=null;){if(i.className.indexOf("wtHolder")>-1){t=i;break}i=i.parentNode}return r.target=t,t===l||t===a?(this.syncScrollPositions(r,u*e,"x"),this.syncScrollPositions(r,u*f,"y")):(t===s||t===h?o=f:t===c&&(o=e),this.syncScrollPositions(r,u*o)),!1}},{key:"syncScrollPositions",value:function(n){var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null,a=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;if(!this.destroyed){if(arguments.length===0){this.syncScrollWithMaster();return}var c=this.leftOverlay.mainTableScrollableElement,f=this.topOverlay.mainTableScrollableElement,r=n.target,t=0,e=!1,o=void 0,l=void 0,v=void 0,y=void 0,s=void 0,h=!1,p=this.wot.getSetting("preventOverflow");this.topOverlay.needFullRender&&(o=this.topOverlay.clone.wtTable.holder);this.bottomOverlay.needFullRender&&(s=this.bottomOverlay.clone.wtTable.holder);this.leftOverlay.needFullRender&&(l=this.leftOverlay.clone.wtTable.holder);this.leftOverlay.needFullRender&&this.topOverlay.needFullRender&&(v=this.topLeftCornerOverlay.clone.wtTable.holder);this.leftOverlay.needFullRender&&this.bottomOverlay.needFullRender&&(y=this.bottomLeftCornerOverlay.clone.wtTable.holder);r===document&&(r=window);r===c||r===f?(t=p?u.getScrollLeft(this.scrollableElement):u.getScrollLeft(r),this.horizontalScrolling=this.overlayScrollPositions.master.left!==t,this.overlayScrollPositions.master.left=t,e=!0,this.pendingScrollCallbacks.master.left>0?this.pendingScrollCallbacks.master.left--:(o&&o.scrollLeft!==t&&(i==null&&this.pendingScrollCallbacks.top.left++,o.scrollLeft=t,h=c!==window),s&&s.scrollLeft!==t&&(i==null&&this.pendingScrollCallbacks.bottom.left++,s.scrollLeft=t,h=c!==window)),t=u.getScrollTop(r),this.verticalScrolling=this.overlayScrollPositions.master.top!==t,this.overlayScrollPositions.master.top=t,e=!0,this.pendingScrollCallbacks.master.top>0?this.pendingScrollCallbacks.master.top--:l&&l.scrollTop!==t&&(i==null&&this.pendingScrollCallbacks.left.top++,l.scrollTop=t,h=f!==window)):r===s?(t=u.getScrollLeft(r),this.overlayScrollPositions.bottom.left=t,e=!0,this.pendingScrollCallbacks.bottom.left>0?this.pendingScrollCallbacks.bottom.left--:(i==null&&this.pendingScrollCallbacks.master.left++,c.scrollLeft=t,o&&o.scrollLeft!==t&&(i==null&&this.pendingScrollCallbacks.top.left++,o.scrollLeft=t,h=f!==window)),i!==null&&(e=!0,f.scrollTop+=i)):r===o?(t=u.getScrollLeft(r),this.overlayScrollPositions.top.left=t,e=!0,this.pendingScrollCallbacks.top.left>0?this.pendingScrollCallbacks.top.left--:(i==null&&this.pendingScrollCallbacks.master.left++,c.scrollLeft=t),i!==null&&(e=!0,f.scrollTop+=i),s&&s.scrollLeft!==t&&(i==null&&this.pendingScrollCallbacks.bottom.left++,s.scrollLeft=t,h=f!==window)):r===l?(t=u.getScrollTop(r),this.overlayScrollPositions.left.top!==t&&(this.overlayScrollPositions.left.top=t,e=!0,this.pendingScrollCallbacks.left.top>0?this.pendingScrollCallbacks.left.top--:(i==null&&this.pendingScrollCallbacks.master.top++,f.scrollTop=t)),i!==null&&(e=!0,f.scrollLeft+=i)):(r===v||r===y)&&i!==null&&(e=!0,a==="x"?f.scrollLeft+=i:a==="y"&&(f.scrollTop+=i));!this.keyPressed&&e&&n.type==="scroll"&&(this.delegatedScrollCallback?this.delegatedScrollCallback=!1:this.refreshAll(),h&&(this.delegatedScrollCallback=!0))}}},{key:"syncScrollWithMaster",value:function(){var n=this.topOverlay.mainTableScrollableElement,t=n.scrollLeft,i=n.scrollTop;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=t);this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=t);this.leftOverlay.needFullRender&&(this.leftOverlay.clone.wtTable.holder.scrollTop=i)}},{key:"updateMainScrollableElements",value:function(){this.deregisterListeners();this.leftOverlay.updateMainScrollableElement();this.topOverlay.updateMainScrollableElement();this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();this.scrollableElement=u.getScrollableElement(this.wot.wtTable.TABLE);this.registerListeners()}},{key:"destroy",value:function(){this.eventManager.destroy();this.topOverlay.destroy();this.bottomOverlay.clone&&this.bottomOverlay.destroy();this.leftOverlay.destroy();this.topLeftCornerOverlay&&this.topLeftCornerOverlay.destroy();this.bottomLeftCornerOverlay&&this.bottomLeftCornerOverlay.clone&&this.bottomLeftCornerOverlay.destroy();this.debug&&this.debug.destroy();this.destroyed=!0}},{key:"refresh",value:function(){var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:!1;if(this.topOverlay.areElementSizesAdjusted&&this.leftOverlay.areElementSizesAdjusted){var t=this.wot.wtTable.wtRootElement.parentNode||this.wot.wtTable.wtRootElement,i=t.clientWidth,r=t.clientHeight;(i!==this.spreaderLastSize.width||r!==this.spreaderLastSize.height)&&(this.spreaderLastSize.width=i,this.spreaderLastSize.height=r,this.adjustElementsSize())}this.bottomOverlay.clone&&this.bottomOverlay.refresh(n);this.leftOverlay.refresh(n);this.topOverlay.refresh(n);this.topLeftCornerOverlay&&this.topLeftCornerOverlay.refresh(n);this.bottomLeftCornerOverlay&&this.bottomLeftCornerOverlay.clone&&this.bottomLeftCornerOverlay.refresh(n);this.debug&&this.debug.refresh(n)}},{key:"adjustElementsSize",value:function(){var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:!1,i=this.wot.getSetting("totalColumns"),r=this.wot.getSetting("totalRows"),u=this.wot.wtViewport.getRowHeaderWidth(),f=this.wot.wtViewport.getColumnHeaderHeight(),t=this.wot.wtTable.hider.style;t.width=u+this.leftOverlay.sumCellSizes(0,i)+"px";t.height=f+this.topOverlay.sumCellSizes(0,r)+1+"px";this.topOverlay.adjustElementsSize(n);this.leftOverlay.adjustElementsSize(n);this.bottomOverlay.clone&&this.bottomOverlay.adjustElementsSize(n)}},{key:"applyToDOM",value:function(){this.topOverlay.areElementSizesAdjusted&&this.leftOverlay.areElementSizesAdjusted||this.adjustElementsSize();this.topOverlay.applyToDOM();this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM();this.leftOverlay.applyToDOM()}},{key:"getParentOverlay",value:function(n){if(!n)return null;var i=[this.topOverlay,this.leftOverlay,this.bottomOverlay,this.topLeftCornerOverlay,this.bottomLeftCornerOverlay],t=null;return s.arrayEach(i,function(i){i&&i.clone&&i.clone.wtTable.TABLE.contains(n)&&(t=i.clone)}),t}}]),n}();t.default=e},function(n,t,i){"use strict";function o(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var f;t.__esModule=!0;var e=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),r=i(2),u=i(4);f=function(){function n(t){o(this,n);this.wot=t;this.instance=t}return e(n,[{key:"scrollViewport",value:function(n){if(this.wot.drawn){var t=this._getVariables(),i=t.topOverlay,r=t.leftOverlay,u=t.totalRows,f=t.totalColumns,e=t.fixedRowsTop,o=t.fixedRowsBottom,s=t.fixedColumnsLeft;if(n.row<0||n.row>Math.max(u-1,0))throw new Error("row "+n.row+" does not exist");if(n.col<0||n.col>Math.max(f-1,0))throw new Error("column "+n.col+" does not exist");n.row>=e&&n.row<this.getFirstVisibleRow()?i.scrollTo(n.row):n.row>this.getLastVisibleRow()&&n.row<u-o&&i.scrollTo(n.row,!0);n.col>=s&&n.col<this.getFirstVisibleColumn()?r.scrollTo(n.col):n.col>this.getLastVisibleColumn()&&r.scrollTo(n.col,!0)}}},{key:"getFirstVisibleRow",value:function(){var n=this._getVariables(),i=n.topOverlay,f=n.wtTable,c=n.wtViewport,l=n.totalRows,a=n.fixedRowsTop,e=f.getFirstVisibleRow(),t;if(i.mainTableScrollableElement===window){var o=r.offset(f.wtRootElement),s=r.innerHeight(f.hider),v=r.innerHeight(window),h=r.getScrollTop(window);o.top+s-v<=h&&(t=c.getColumnHeaderHeight(),t+=i.sumCellSizes(0,a),u.rangeEachReverse(l,1,function(n){return t+=i.sumCellSizes(n-1,n),o.top+s-t<=h?(e=n,!1):void 0}))}return e}},{key:"getLastVisibleRow",value:function(){var n=this._getVariables(),i=n.topOverlay,f=n.wtTable,h=n.wtViewport,c=n.totalRows,e=f.getLastVisibleRow(),t;if(i.mainTableScrollableElement===window){var o=r.offset(f.wtRootElement),l=r.innerHeight(window),s=r.getScrollTop(window);o.top>s&&(t=h.getColumnHeaderHeight(),u.rangeEach(1,c,function(n){return t+=i.sumCellSizes(n-1,n),o.top+t-s>=l?(e=n-2,!1):void 0}))}return e}},{key:"getFirstVisibleColumn",value:function(){var n=this._getVariables(),f=n.leftOverlay,t=n.wtTable,c=n.wtViewport,l=n.totalColumns,v=n.fixedColumnsLeft,e=t.getFirstVisibleColumn(),i;if(f.mainTableScrollableElement===window){var o=r.offset(t.wtRootElement),s=r.innerWidth(t.hider),a=r.innerWidth(window),h=r.getScrollLeft(window);o.left+s-a<=h&&(i=c.getRowHeaderWidth(),u.rangeEachReverse(l,1,function(n){return i+=f.sumCellSizes(n-1,n),o.left+s-i<=h?(e=n,!1):void 0}))}return e}},{key:"getLastVisibleColumn",value:function(){var n=this._getVariables(),i=n.leftOverlay,f=n.wtTable,h=n.wtViewport,c=n.totalColumns,e=f.getLastVisibleColumn(),t;if(i.mainTableScrollableElement===window){var o=r.offset(f.wtRootElement),l=r.innerWidth(window),s=r.getScrollLeft(window);o.left>s&&(t=h.getRowHeaderWidth(),u.rangeEach(1,c,function(n){return t+=i.sumCellSizes(n-1,n),o.left+t-s>=l?(e=n-2,!1):void 0}))}return e}},{key:"_getVariables",value:function(){var n=this.wot,t=n.wtOverlays.topOverlay,i=n.wtOverlays.leftOverlay,r=n.wtTable,u=n.wtViewport,f=n.getSetting("totalRows"),e=n.getSetting("totalColumns"),o=n.getSetting("fixedRowsTop"),s=n.getSetting("fixedRowsBottom"),h=n.getSetting("fixedColumnsLeft");return{topOverlay:t,leftOverlay:i,wtTable:r,wtViewport:u,totalRows:f,totalColumns:e,fixedRowsTop:o,fixedRowsBottom:s,fixedColumnsLeft:h}}}]),n}();t.default=f},function(n,t,i){"use strict";function o(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var u;t.__esModule=!0;var f=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),e=i(2),r=i(1);u=function(){function n(t,i){var f=this,u;o(this,n);this.wot=t;this.instance=t;this.defaults={table:void 0,debug:!1,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow:function(){return!1},data:void 0,freezeOverlays:!1,fixedColumnsLeft:0,fixedRowsTop:0,fixedRowsBottom:0,minSpareRows:0,rowHeaders:function(){return[]},columnHeaders:function(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:function(n,t,i){var r=f.getSetting("data",n,t);e.fastInnerText(i,r===void 0||r===null?"":r)},columnWidth:function(){},rowHeight:function(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeDrawBorders:null,onScrollVertically:null,onScrollHorizontally:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:function(n){return n},onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,scrollbarWidth:10,scrollbarHeight:10,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null};this.settings={};for(u in this.defaults)if(r.hasOwnProperty(this.defaults,u))if(i[u]!==void 0)this.settings[u]=i[u];else if(this.defaults[u]===void 0)throw new Error('A required setting "'+u+'" was not provided');else this.settings[u]=this.defaults[u]}return f(n,[{key:"update",value:function(n,t){if(t===void 0)for(var i in n)r.hasOwnProperty(n,i)&&(this.settings[i]=n[i]);else this.settings[n]=t;return this.wot}},{key:"getSetting",value:function(n,t,i,r,u){return typeof this.settings[n]=="function"?this.settings[n](t,i,r,u):t!==void 0&&Array.isArray(this.settings[n])?this.settings[n][t]:this.settings[n]}},{key:"has",value:function(n){return!!this.settings[n]}}]),n}();t.default=u},function(n,t,i){"use strict";function f(n){return n&&n.__esModule?n:{"default":n}}function nt(n){if(Array.isArray(n)){for(var t=0,i=Array(n.length);t<n.length;t++)i[t]=n[t];return i}return Array.from(n)}function tt(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var e;t.__esModule=!0;var o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},s=function(){function n(n,t){var r=[],u=!0,f=!1,e=undefined,i,o;try{for(i=n[Symbol.iterator]();!(u=(o=i.next()).done);u=!0)if(r.push(o.value),t&&r.length===t)break}catch(s){f=!0;e=s}finally{try{!u&&i["return"]&&i["return"]()}finally{if(f)throw e;}}return r}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return n(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance");}}(),h=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),u=i(2),c=i(35),l=i(61),a=f(l),v=i(150),it=f(v),y=i(191),p=f(y),w=i(192),b=f(w),k=i(199),d=f(k),g=i(29),r=f(g);e=function(){function n(t,i){var f=this,r;tt(this,n);this.wot=t;this.instance=this.wot;this.TABLE=i;this.TBODY=null;this.THEAD=null;this.COLGROUP=null;this.tableOffset=0;this.holderOffset=0;u.removeTextNodes(this.TABLE);this.spreader=this.createSpreader(this.TABLE);this.hider=this.createHider(this.spreader);this.holder=this.createHolder(this.hider);this.wtRootElement=this.holder.parentNode;this.alignOverlaysWithTrimmingContainer();this.fixTableDomTree();this.colgroupChildrenLength=this.COLGROUP.childNodes.length;this.theadChildrenLength=this.THEAD.firstChild?this.THEAD.firstChild.childNodes.length:0;this.tbodyChildrenLength=this.TBODY.childNodes.length;this.rowFilter=null;this.columnFilter=null;this.correctHeaderWidth=!1;r=this.wot.wtSettings.settings.rowHeaderWidth;this.wot.wtSettings.settings.rowHeaderWidth=function(){return f._modifyRowHeaderWidth(r)}}return h(n,[{key:"fixTableDomTree",value:function(){this.TBODY=this.TABLE.querySelector("tbody");this.TBODY||(this.TBODY=document.createElement("tbody"),this.TABLE.appendChild(this.TBODY));this.THEAD=this.TABLE.querySelector("thead");this.THEAD||(this.THEAD=document.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY));this.COLGROUP=this.TABLE.querySelector("colgroup");this.COLGROUP||(this.COLGROUP=document.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD));this.wot.getSetting("columnHeaders").length&&!this.THEAD.childNodes.length&&this.THEAD.appendChild(document.createElement("TR"))}},{key:"createSpreader",value:function(n){var i=n.parentNode,t=void 0;return i&&i.nodeType===1&&u.hasClass(i,"wtHolder")||(t=document.createElement("div"),t.className="wtSpreader",i&&i.insertBefore(t,n),t.appendChild(n)),t.style.position="relative",t}},{key:"createHider",value:function(n){var t=n.parentNode,i=void 0;return t&&t.nodeType===1&&u.hasClass(t,"wtHolder")||(i=document.createElement("div"),i.className="wtHider",t&&t.insertBefore(i,n),i.appendChild(n)),i}},{key:"createHolder",value:function(n){var i=n.parentNode,t=void 0;return i&&i.nodeType===1&&u.hasClass(i,"wtHolder")||(t=document.createElement("div"),t.style.position="relative",t.className="wtHolder",i&&i.insertBefore(t,n),this.isWorkingOnClone()||(t.parentNode.className+="ht_master handsontable"),t.appendChild(n)),t}},{key:"alignOverlaysWithTrimmingContainer",value:function(){var n=u.getTrimmingContainer(this.wtRootElement),t;this.isWorkingOnClone()||(this.holder.parentNode.style.position="relative",n===window?(t=this.wot.getSetting("preventOverflow"),t||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible")):(this.holder.style.width=u.getStyle(n,"width"),this.holder.style.height=u.getStyle(n,"height"),this.holder.style.overflow=""))}},{key:"isWorkingOnClone",value:function(){return!!this.wot.cloneSource}},{key:"draw",value:function(n){var o=this.wot,t=o.wtOverlays,i=o.wtViewport,s=this.instance.getSetting("totalRows"),h=this.wot.getSetting("rowHeaders").length,v=this.wot.getSetting("columnHeaders").length,c=!1,l,a,f,e;return this.isWorkingOnClone()||(this.holderOffset=u.offset(this.holder),n=i.createRenderCalculators(n),h&&!this.wot.getSetting("fixedColumnsLeft")&&(l=t.leftOverlay.getScrollPosition(),a=this.correctHeaderWidth,this.correctHeaderWidth=l>0,a!==this.correctHeaderWidth&&(n=!1))),this.isWorkingOnClone()||(c=t.prepareOverlays()),n?(this.isWorkingOnClone()||i.createVisibleCalculators(),t&&t.refresh(!0)):(this.tableOffset=this.isWorkingOnClone()?this.wot.cloneSource.wtTable.tableOffset:u.offset(this.TABLE),f=void 0,f=r.default.isOverlayTypeOf(this.wot.cloneOverlay,r.default.CLONE_DEBUG)||r.default.isOverlayTypeOf(this.wot.cloneOverlay,r.default.CLONE_TOP)||r.default.isOverlayTypeOf(this.wot.cloneOverlay,r.default.CLONE_TOP_LEFT_CORNER)?0:r.default.isOverlayTypeOf(this.instance.cloneOverlay,r.default.CLONE_BOTTOM)||r.default.isOverlayTypeOf(this.instance.cloneOverlay,r.default.CLONE_BOTTOM_LEFT_CORNER)?Math.max(s-this.wot.getSetting("fixedRowsBottom"),0):i.rowsRenderCalculator.startRow,e=void 0,e=r.default.isOverlayTypeOf(this.wot.cloneOverlay,r.default.CLONE_DEBUG)||r.default.isOverlayTypeOf(this.wot.cloneOverlay,r.default.CLONE_LEFT)||r.default.isOverlayTypeOf(this.wot.cloneOverlay,r.default.CLONE_TOP_LEFT_CORNER)||r.default.isOverlayTypeOf(this.wot.cloneOverlay,r.default.CLONE_BOTTOM_LEFT_CORNER)?0:i.columnsRenderCalculator.startColumn,this.rowFilter=new b.default(f,s,v),this.columnFilter=new p.default(e,this.wot.getSetting("totalColumns"),h),this.alignOverlaysWithTrimmingContainer(),this._doDraw()),this.refreshSelections(n),this.isWorkingOnClone()||(t.topOverlay.resetFixedPosition(),t.bottomOverlay.clone&&t.bottomOverlay.resetFixedPosition(),t.leftOverlay.resetFixedPosition(),t.topLeftCornerOverlay&&t.topLeftCornerOverlay.resetFixedPosition(),t.bottomLeftCornerOverlay&&t.bottomLeftCornerOverlay.clone&&t.bottomLeftCornerOverlay.resetFixedPosition()),c&&t.syncScrollWithMaster(),this.wot.drawn=!0,this}},{key:"_doDraw",value:function(){var n=new d.default(this);n.render()}},{key:"removeClassFromCells",value:function(n){for(var i=this.TABLE.querySelectorAll("."+n),t=0,r=i.length;t<r;t++)u.removeClass(i[t],n)}},{key:"refreshSelections",value:function(n){var i,o,t,r,u,v,f,e;if(this.wot.selections){if(i=Array.from(this.wot.selections),o=i.length,n){for(t=[],r=0;r<o;r++){var s=i[r].settings,h=s.highlightHeaderClassName,c=s.highlightRowClassName,l=s.highlightColumnClassName,a=i[r].classNames,y=a.length;for(u=0;u<y;u++)t.includes(a[u])||t.push(a[u]);h&&!t.includes(h)&&t.push(h);c&&!t.includes(c)&&t.push(c);l&&!t.includes(l)&&t.push(l)}for(v=t.length,f=0;f<v;f++)this.removeClassFromCells(t[f])}for(e=0;e<o;e++)i[e].draw(this.wot,n)}}},{key:"getCell",value:function(n){var t=n.row,i=n.col,r=this.wot.getSetting("onModifyGetCellCoords",t,i),u,f;return(r&&Array.isArray(r)&&(u=s(r,2),t=u[0],i=u[1]),this.isRowBeforeRenderedRows(t))?-1:this.isRowAfterRenderedRows(t)?-2:(f=this.TBODY.childNodes[this.rowFilter.sourceToRendered(t)],f?f.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(i)]:void 0)}},{key:"getColumnHeader",value:function(n){var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0,t=this.THEAD.childNodes[i];if(t)return t.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(n)]}},{key:"getRowHeader",value:function(n){if(this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0)===0)return null;var t=this.TBODY.childNodes[this.rowFilter.sourceToRendered(n)];if(t)return t.childNodes[0]}},{key:"getCoords",value:function(n){if(n.nodeName!=="TD"&&n.nodeName!=="TH"&&(n=u.closest(n,["TD","TH"])),n===null)return null;var e=n.parentNode,f=e.parentNode,t=u.index(e),i=n.cellIndex;return u.overlayContainsElement(r.default.CLONE_TOP_LEFT_CORNER,n)||u.overlayContainsElement(r.default.CLONE_TOP,n)?f.nodeName==="THEAD"&&(t-=f.childNodes.length):t=f===this.THEAD?this.rowFilter.visibleColHeadedRowToSourceRow(t):this.rowFilter.renderedToSource(t),i=u.overlayContainsElement(r.default.CLONE_TOP_LEFT_CORNER,n)||u.overlayContainsElement(r.default.CLONE_LEFT,n)?this.columnFilter.offsettedTH(i):this.columnFilter.visibleRowHeadedColumnToSourceColumn(i),new a.default(t,i)}},{key:"getTrForRow",value:function(n){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(n)]}},{key:"getFirstRenderedRow",value:function(){return this.wot.wtViewport.rowsRenderCalculator.startRow}},{key:"getFirstVisibleRow",value:function(){return this.wot.wtViewport.rowsVisibleCalculator.startRow}},{key:"getFirstRenderedColumn",value:function(){return this.wot.wtViewport.columnsRenderCalculator.startColumn}},{key:"getFirstVisibleColumn",value:function(){return this.wot.wtViewport.columnsVisibleCalculator.startColumn}},{key:"getLastRenderedRow",value:function(){return this.wot.wtViewport.rowsRenderCalculator.endRow}},{key:"getLastVisibleRow",value:function(){return this.wot.wtViewport.rowsVisibleCalculator.endRow}},{key:"getLastRenderedColumn",value:function(){return this.wot.wtViewport.columnsRenderCalculator.endColumn}},{key:"getLastVisibleColumn",value:function(){return this.wot.wtViewport.columnsVisibleCalculator.endColumn}},{key:"isRowBeforeRenderedRows",value:function(n){return this.rowFilter&&this.rowFilter.sourceToRendered(n)<0&&n>=0}},{key:"isRowAfterViewport",value:function(n){return this.rowFilter&&this.rowFilter.sourceToRendered(n)>this.getLastVisibleRow()}},{key:"isRowAfterRenderedRows",value:function(n){return this.rowFilter&&this.rowFilter.sourceToRendered(n)>this.getLastRenderedRow()}},{key:"isColumnBeforeViewport",value:function(n){return this.columnFilter&&this.columnFilter.sourceToRendered(n)<0&&n>=0}},{key:"isColumnAfterViewport",value:function(n){return this.columnFilter&&this.columnFilter.sourceToRendered(n)>this.getLastVisibleColumn()}},{key:"isLastRowFullyVisible",value:function(){return this.getLastVisibleRow()===this.getLastRenderedRow()}},{key:"isLastColumnFullyVisible",value:function(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}},{key:"getRenderedColumnsCount",value:function(){var n=this.wot.wtViewport.columnsRenderCalculator.count,t=this.wot.getSetting("totalColumns");if(this.wot.isOverlayName(r.default.CLONE_DEBUG))n=t;else if(this.wot.isOverlayName(r.default.CLONE_LEFT)||this.wot.isOverlayName(r.default.CLONE_TOP_LEFT_CORNER)||this.wot.isOverlayName(r.default.CLONE_BOTTOM_LEFT_CORNER))return Math.min(this.wot.getSetting("fixedColumnsLeft"),t);return n}},{key:"getRenderedRowsCount",value:function(){var n=this.wot.wtViewport.rowsRenderCalculator.count,t=this.wot.getSetting("totalRows");return this.wot.isOverlayName(r.default.CLONE_DEBUG)?n=t:this.wot.isOverlayName(r.default.CLONE_TOP)||this.wot.isOverlayName(r.default.CLONE_TOP_LEFT_CORNER)?n=Math.min(this.wot.getSetting("fixedRowsTop"),t):(this.wot.isOverlayName(r.default.CLONE_BOTTOM)||this.wot.isOverlayName(r.default.CLONE_BOTTOM_LEFT_CORNER))&&(n=Math.min(this.wot.getSetting("fixedRowsBottom"),t)),n}},{key:"getVisibleRowsCount",value:function(){return this.wot.wtViewport.rowsVisibleCalculator.count}},{key:"allRowsInViewport",value:function(){return this.wot.getSetting("totalRows")==this.getVisibleRowsCount()}},{key:"getRowHeight",value:function(n){var t=this.wot.wtSettings.settings.rowHeight(n),i=this.wot.wtViewport.oversizedRows[n];return i!==void 0&&(t=t===void 0?i:Math.max(t,i)),t}},{key:"getColumnHeaderHeight",value:function(n){var t=this.wot.wtSettings.settings.defaultRowHeight,i=this.wot.wtViewport.oversizedColumnHeaders[n];return i!==void 0&&(t=t?Math.max(t,i):i),t}},{key:"getVisibleColumnsCount",value:function(){return this.wot.wtViewport.columnsVisibleCalculator.count}},{key:"allColumnsInViewport",value:function(){return this.wot.getSetting("totalColumns")==this.getVisibleColumnsCount()}},{key:"getColumnWidth",value:function(n){var t=this.wot.wtSettings.settings.columnWidth;return typeof t=="function"?t=t(n):(typeof t=="undefined"?"undefined":o(t))==="object"&&(t=t[n]),t||this.wot.wtSettings.settings.defaultColumnWidth}},{key:"getStretchedColumnWidth",value:function(n){var r=this.getColumnWidth(n),t=r==null?this.instance.wtSettings.settings.defaultColumnWidth:r,u=this.wot.wtViewport.columnsRenderCalculator,i;return u&&(i=u.getStretchedColumnWidth(n,t),i&&(t=i)),t}},{key:"_modifyRowHeaderWidth",value:function(n){var t=c.isFunction(n)?n():null;return Array.isArray(t)?(t=[].concat(nt(t)),t[t.length-1]=this._correctRowHeaderWidth(t[t.length-1])):t=this._correctRowHeaderWidth(t),t}},{key:"_correctRowHeaderWidth",value:function(n){return typeof n!="number"&&(n=this.wot.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&n++,n}}]),n}();t.default=e},function(n,t,i){"use strict";function h(n){return n&&n.__esModule?n:{"default":n}}function c(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function l(n,t){var i=document.createElement("TH");return t.insertBefore(i,n),t.removeChild(n),i}function a(n,t){var i=document.createElement("TD");return t.insertBefore(i,n),t.removeChild(n),i}var f,e;t.__esModule=!0;var o=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),r=i(2),s=i(29),u=h(s);f=!1;e=function(){function n(t){c(this,n);this.wtTable=t;this.wot=t.instance;this.instance=t.instance;this.rowFilter=t.rowFilter;this.columnFilter=t.columnFilter;this.TABLE=t.TABLE;this.THEAD=t.THEAD;this.TBODY=t.TBODY;this.COLGROUP=t.COLGROUP;this.rowHeaders=[];this.rowHeaderCount=0;this.columnHeaders=[];this.columnHeaderCount=0;this.fixedRowsTop=0;this.fixedRowsBottom=0}return o(n,[{key:"render",value:function(){var e,s,a,t,i,f,v,y;if(this.wtTable.isWorkingOnClone()||(e={},this.wot.getSetting("beforeDraw",!0,e),e.skipRender!==!0)){this.rowHeaders=this.wot.getSetting("rowHeaders");this.rowHeaderCount=this.rowHeaders.length;this.fixedRowsTop=this.wot.getSetting("fixedRowsTop");this.fixedRowsBottom=this.wot.getSetting("fixedRowsBottom");this.columnHeaders=this.wot.getSetting("columnHeaders");this.columnHeaderCount=this.columnHeaders.length;var o=this.wtTable.getRenderedColumnsCount(),h=this.wtTable.getRenderedRowsCount(),p=this.wot.getSetting("totalColumns"),w=this.wot.getSetting("totalRows"),c=void 0,l=!1;if((u.default.isOverlayTypeOf(this.wot.cloneOverlay,u.default.CLONE_BOTTOM)||u.default.isOverlayTypeOf(this.wot.cloneOverlay,u.default.CLONE_BOTTOM_LEFT_CORNER))&&(this.columnHeaders=[],this.columnHeaderCount=0),p>=0&&(this.adjustAvailableNodes(),l=!0,this.renderColumnHeaders(),this.renderRows(w,h,o),this.wtTable.isWorkingOnClone()||(c=this.wot.wtViewport.getWorkspaceWidth(),this.wot.wtViewport.containerWidth=null),this.adjustColumnWidths(o),this.markOversizedColumnHeaders(),this.adjustColumnHeaderHeights()),l||this.adjustAvailableNodes(),this.removeRedundantRows(h),(!this.wtTable.isWorkingOnClone()||this.wot.isOverlayName(u.default.CLONE_BOTTOM))&&this.markOversizedRows(),this.wtTable.isWorkingOnClone())this.wot.isOverlayName(u.default.CLONE_BOTTOM)&&this.wot.cloneSource.wtOverlays.adjustElementsSize();else{if(this.wot.wtViewport.createVisibleCalculators(),this.wot.wtOverlays.refresh(!1),this.wot.wtOverlays.applyToDOM(),s=r.outerWidth(this.wtTable.hider),a=r.outerWidth(this.wtTable.TABLE),s!==0&&a!==s&&this.adjustColumnWidths(o),c!==this.wot.wtViewport.getWorkspaceWidth()){this.wot.wtViewport.containerWidth=null;var b=this.wtTable.getFirstRenderedColumn(),k=this.wtTable.getLastRenderedColumn(),d=this.wot.getSetting("defaultColumnWidth"),n=this.wot.getSetting("rowHeaderWidth");if(n=this.instance.getSetting("onModifyRowHeaderWidth",n),n!=null)for(t=0;t<this.rowHeaderCount;t++)i=Array.isArray(n)?n[t]:n,i=i==null?d:i,this.COLGROUP.childNodes[t].style.width=i+"px";for(f=b;f<k;f++)v=this.wtTable.getStretchedColumnWidth(f),y=this.columnFilter.sourceToRendered(f),this.COLGROUP.childNodes[y+this.rowHeaderCount].style.width=v+"px"}this.wot.getSetting("onDraw",!0)}}}},{key:"removeRedundantRows",value:function(n){while(this.wtTable.tbodyChildrenLength>n)this.TBODY.removeChild(this.TBODY.lastChild),this.wtTable.tbodyChildrenLength--}},{key:"renderRows",value:function(n,t,i){for(var h=void 0,r=void 0,o=0,e=this.rowFilter.renderedToSource(o),c=this.wtTable.isWorkingOnClone(),s;e<n&&e>=0;){if(!f&&o>1e3&&(f=!0,console.warn('Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.')),t!==void 0&&o===t)break;r=this.getOrCreateTrForRow(o,r);this.renderRowHeaders(e,r);this.adjustColumns(r,i+this.rowHeaderCount);h=this.renderCells(e,r,i);(!c||this.wot.isOverlayName(u.default.CLONE_BOTTOM))&&this.resetOversizedRow(e);r.firstChild&&(s=this.wot.wtTable.getRowHeight(e),s?(s--,r.firstChild.style.height=s+"px"):r.firstChild.style.height="");o++;e=this.rowFilter.renderedToSource(o)}}},{key:"resetOversizedRow",value:function(n){this.wot.getSetting("externalRowCalculator")||this.wot.wtViewport.oversizedRows&&this.wot.wtViewport.oversizedRows[n]&&(this.wot.wtViewport.oversizedRows[n]=void 0)}},{key:"markOversizedRows",value:function(){if(!this.wot.getSetting("externalRowCalculator")){var n=this.instance.wtTable.TBODY.childNodes.length,o=n*this.instance.wtSettings.settings.defaultRowHeight,s=r.innerHeight(this.instance.wtTable.TBODY)-1,u=void 0,t=void 0,i=void 0,f=void 0,e=void 0,h=this.instance.getSetting("totalRows");if(o!==s||this.instance.getSetting("fixedRowsBottom"))while(n)n--,i=this.instance.wtTable.rowFilter.renderedToSource(n),u=this.instance.wtTable.getRowHeight(i),f=this.instance.wtTable.getTrForRow(i),e=f.querySelector("th"),t=e?r.innerHeight(e):r.innerHeight(f)-1,(!u&&this.instance.wtSettings.settings.defaultRowHeight<t||u<t)&&(this.instance.wtViewport.oversizedRows[i]=++t)}}},{key:"markOversizedColumnHeaders",value:function(){var i=this.wot.getOverlayName(),r,t,n;if(this.columnHeaderCount&&!this.wot.wtViewport.hasOversizedColumnHeadersMarked[i]&&!this.wtTable.isWorkingOnClone()){for(r=this.wtTable.getRenderedColumnsCount(),t=0;t<this.columnHeaderCount;t++)for(n=-1*this.rowHeaderCount;n<r;n++)this.markIfOversizedColumnHeader(n);this.wot.wtViewport.hasOversizedColumnHeadersMarked[i]=!0}}},{key:"adjustColumnHeaderHeights",value:function(){for(var r=this.wot.getSetting("columnHeaders"),t=this.wot.wtTable.THEAD.childNodes,i=this.wot.wtViewport.oversizedColumnHeaders,n=0,u=r.length;n<u;n++)if(i[n]){if(!t[n]||t[n].childNodes.length===0)return;t[n].childNodes[0].style.height=i[n]+"px"}}},{key:"markIfOversizedColumnHeader",value:function(n){for(var o=this.wot.wtTable.columnFilter.renderedToSource(n),t=this.columnHeaderCount,s=this.wot.wtSettings.settings.defaultRowHeight,f=void 0,e=void 0,u=void 0,i=this.wot.getSetting("columnHeaderHeight")||[];t;)(t--,f=this.wot.wtTable.getColumnHeaderHeight(t),e=this.wot.wtTable.getColumnHeader(o,t),e)&&(u=r.innerHeight(e),(!f&&s<u||f<u)&&(this.wot.wtViewport.oversizedColumnHeaders[t]=u),Array.isArray(i)?i[t]!=null&&(this.wot.wtViewport.oversizedColumnHeaders[t]=i[t]):isNaN(i)||(this.wot.wtViewport.oversizedColumnHeaders[t]=i),this.wot.wtViewport.oversizedColumnHeaders[t]<(i[t]||i)&&(this.wot.wtViewport.oversizedColumnHeaders[t]=i[t]||i))}},{key:"renderCells",value:function(n,t,i){for(var u=void 0,e=void 0,f=0;f<i;f++)e=this.columnFilter.renderedToSource(f),u=f===0?t.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]:u.nextSibling,u.nodeName=="TH"&&(u=a(u,t)),r.hasClass(u,"hide")||(u.className=""),u.removeAttribute("style"),this.wot.wtSettings.settings.cellRenderer(n,e,u);return u}},{key:"adjustColumnWidths",value:function(n){var e=0,h=this.wot.cloneSource?this.wot.cloneSource:this.wot,o=h.wtTable.holder,c=this.wot.getSetting("defaultColumnWidth"),t=this.wot.getSetting("rowHeaderWidth"),i,u,f,s;if(o.offsetHeight<o.scrollHeight&&(e=r.getScrollbarWidth()),this.wot.wtViewport.columnsRenderCalculator.refreshStretching(this.wot.wtViewport.getViewportWidth()-e),t=this.instance.getSetting("onModifyRowHeaderWidth",t),t!=null)for(i=0;i<this.rowHeaderCount;i++)u=Array.isArray(t)?t[i]:t,u=u==null?c:u,this.COLGROUP.childNodes[i].style.width=u+"px";for(f=0;f<n;f++)s=this.wtTable.getStretchedColumnWidth(this.columnFilter.renderedToSource(f)),this.COLGROUP.childNodes[f+this.rowHeaderCount].style.width=s+"px"}},{key:"appendToTbody",value:function(n){this.TBODY.appendChild(n);this.wtTable.tbodyChildrenLength++}},{key:"getOrCreateTrForRow",value:function(n,t){var i=void 0;return n>=this.wtTable.tbodyChildrenLength?(i=this.createRow(),this.appendToTbody(i)):i=n===0?this.TBODY.firstChild:t.nextSibling,i.className&&i.removeAttribute("class"),i}},{key:"createRow",value:function(){for(var n=document.createElement("TR"),t=0;t<this.rowHeaderCount;t++)n.appendChild(document.createElement("TH"));return n}},{key:"renderRowHeader",value:function(n,t,i){i.className="";i.removeAttribute("style");this.rowHeaders[t](n,i,t)}},{key:"renderRowHeaders",value:function(n,t){for(var i=t.firstChild,r=0;r<this.rowHeaderCount;r++)i?i.nodeName=="TD"&&(i=l(i,t)):(i=document.createElement("TH"),t.appendChild(i)),this.renderRowHeader(n,r,i),i=i.nextSibling}},{key:"adjustAvailableNodes",value:function(){this.adjustColGroups();this.adjustThead()}},{key:"renderColumnHeaders",value:function(){var i,n,r,t,u;if(this.columnHeaderCount)for(i=this.wtTable.getRenderedColumnsCount(),n=0;n<this.columnHeaderCount;n++)for(r=this.getTrForColumnHeaders(n),t=-1*this.rowHeaderCount;t<i;t++)u=this.columnFilter.renderedToSource(t),this.renderColumnHeader(n,u,r.childNodes[t+this.rowHeaderCount])}},{key:"adjustColGroups",value:function(){for(var n=this.wtTable.getRenderedColumnsCount();this.wtTable.colgroupChildrenLength<n+this.rowHeaderCount;)this.COLGROUP.appendChild(document.createElement("COL")),this.wtTable.colgroupChildrenLength++;while(this.wtTable.colgroupChildrenLength>n+this.rowHeaderCount)this.COLGROUP.removeChild(this.COLGROUP.lastChild),this.wtTable.colgroupChildrenLength--;this.rowHeaderCount&&r.addClass(this.COLGROUP.childNodes[0],"rowHeader")}},{key:"adjustThead",value:function(){var f=this.wtTable.getRenderedColumnsCount(),n=this.THEAD.firstChild,t,e,i,u;if(this.columnHeaders.length){for(t=0,e=this.columnHeaders.length;t<e;t++){for(n=this.THEAD.childNodes[t],n||(n=document.createElement("TR"),this.THEAD.appendChild(n)),this.theadChildrenLength=n.childNodes.length;this.theadChildrenLength<f+this.rowHeaderCount;)n.appendChild(document.createElement("TH")),this.theadChildrenLength++;while(this.theadChildrenLength>f+this.rowHeaderCount)n.removeChild(n.lastChild),this.theadChildrenLength--}if(i=this.THEAD.childNodes.length,i>this.columnHeaders.length)for(u=this.columnHeaders.length;u<i;u++)this.THEAD.removeChild(this.THEAD.lastChild)}else n&&r.empty(n)}},{key:"getTrForColumnHeaders",value:function(n){return this.THEAD.childNodes[n]}},{key:"renderColumnHeader",value:function(n,t,i){return i.className="",i.removeAttribute("style"),this.columnHeaders[n](t,i,n)}},{key:"adjustColumns",value:function(n,t){for(var i=n.childNodes.length,r;i<t;)r=document.createElement("TD"),n.appendChild(r),i++;while(i>t)n.removeChild(n.lastChild),i--}},{key:"removeRedundantColumns",value:function(n){while(this.wtTable.tbodyChildrenLength>n)this.TBODY.removeChild(this.TBODY.lastChild),this.wtTable.tbodyChildrenLength--}}]),n}();t.default=e},function(n,t,i){"use strict";function u(n){return n&&n.__esModule?n:{"default":n}}function y(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var f;t.__esModule=!0;var e=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),r=i(2),o=i(1),s=i(9),h=u(s),c=i(189),l=u(c),a=i(190),v=u(a);f=function(){function n(t){var i=this;y(this,n);this.wot=t;this.instance=this.wot;this.oversizedRows=[];this.oversizedColumnHeaders=[];this.hasOversizedColumnHeadersMarked={};this.clientHeight=0;this.containerWidth=NaN;this.rowHeaderWidth=NaN;this.rowsVisibleCalculator=null;this.columnsVisibleCalculator=null;this.eventManager=new h.default(this.wot);this.eventManager.addEventListener(window,"resize",function(){i.clientHeight=i.getWorkspaceHeight()})}return e(n,[{key:"getWorkspaceHeight",value:function(){var n=this.instance.wtOverlays.topOverlay.trimmingContainer,i=void 0,t=0;return n===window?t=document.documentElement.clientHeight:(i=r.outerHeight(n),t=i>0&&n.clientHeight>0?n.clientHeight:Infinity),t}},{key:"getWorkspaceWidth",value:function(){var n=void 0,f=this.wot.getSetting("totalColumns"),u=this.instance.wtOverlays.leftOverlay.trimmingContainer,t=void 0,e=this.wot.getSetting("stretchH"),i=document.documentElement.offsetWidth,o=this.wot.getSetting("preventOverflow");return o?r.outerWidth(this.instance.wtTable.wtRootElement):(n=this.wot.getSetting("freezeOverlays")?Math.min(i-this.getWorkspaceOffset().left,i):Math.min(this.getContainerFillWidth(),i-this.getWorkspaceOffset().left,i),u===window&&f>0&&this.sumColumnWidths(0,f-1)>n)?document.documentElement.clientWidth:u!==window&&(t=r.getStyle(this.instance.wtOverlays.leftOverlay.trimmingContainer,"overflow"),t=="scroll"||t=="hidden"||t=="auto")?Math.max(n,u.clientWidth):e==="none"||!e?Math.max(n,r.outerWidth(this.instance.wtTable.TABLE)):n}},{key:"hasVerticalScroll",value:function(){return this.getWorkspaceActualHeight()>this.getWorkspaceHeight()}},{key:"hasHorizontalScroll",value:function(){return this.getWorkspaceActualWidth()>this.getWorkspaceWidth()}},{key:"sumColumnWidths",value:function(n,t){for(var i=0;n<t;)i+=this.wot.wtTable.getColumnWidth(n),n++;return i}},{key:"getContainerFillWidth",value:function(){if(this.containerWidth)return this.containerWidth;var i=this.instance.wtTable.holder,t=void 0,n=void 0;return n=document.createElement("div"),n.style.width="100%",n.style.height="1px",i.appendChild(n),t=n.offsetWidth,this.containerWidth=t,i.removeChild(n),t}},{key:"getWorkspaceOffset",value:function(){return r.offset(this.wot.wtTable.TABLE)}},{key:"getWorkspaceActualHeight",value:function(){return r.outerHeight(this.wot.wtTable.TABLE)}},{key:"getWorkspaceActualWidth",value:function(){return r.outerWidth(this.wot.wtTable.TABLE)||r.outerWidth(this.wot.wtTable.TBODY)||r.outerWidth(this.wot.wtTable.THEAD)}},{key:"getColumnHeaderHeight",value:function(){return isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=r.outerHeight(this.wot.wtTable.THEAD)),this.columnHeaderHeight}},{key:"getViewportHeight",value:function(){var n=this.getWorkspaceHeight(),t=void 0;return n===Infinity?n:(t=this.getColumnHeaderHeight(),t>0&&(n-=t),n)}},{key:"getRowHeaderWidth",value:function(){var i=this.instance.getSetting("rowHeaderWidth"),u=this.instance.getSetting("rowHeaders"),t,e,n,f,o;if(i)for(this.rowHeaderWidth=0,t=0,e=u.length;t<e;t++)this.rowHeaderWidth+=i[t]||i;if(this.wot.cloneSource)return this.wot.cloneSource.wtViewport.getRowHeaderWidth();if(isNaN(this.rowHeaderWidth))if(u.length)for(n=this.instance.wtTable.TABLE.querySelector("TH"),this.rowHeaderWidth=0,f=0,o=u.length;f<o;f++)n?(this.rowHeaderWidth+=r.outerWidth(n),n=n.nextSibling):this.rowHeaderWidth+=50;else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.instance.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}},{key:"getViewportWidth",value:function(){var n=this.getWorkspaceWidth(),t=void 0;return n===Infinity?n:(t=this.getRowHeaderWidth(),t>0)?n-t:n}},{key:"createRowsCalculator",value:function(){var h=this,u=arguments.length>0&&arguments[0]!==undefined?arguments[0]:!1,i=void 0,n=void 0,f=void 0,s=void 0,e=void 0,t=void 0,o=void 0;return this.rowHeaderWidth=NaN,i=this.wot.wtSettings.settings.renderAllRows&&!u?Infinity:this.getViewportHeight(),n=this.wot.wtOverlays.topOverlay.getScrollPosition()-this.wot.wtOverlays.topOverlay.getTableParentOffset(),n<0&&(n=0),f=this.wot.getSetting("fixedRowsTop"),e=this.wot.getSetting("fixedRowsBottom"),o=this.wot.getSetting("totalRows"),f&&(t=this.wot.wtOverlays.topOverlay.sumCellSizes(0,f),n+=t,i-=t),e&&this.wot.wtOverlays.bottomOverlay.clone&&(t=this.wot.wtOverlays.bottomOverlay.sumCellSizes(o-e,o),i-=t),s=this.wot.wtTable.holder.clientHeight===this.wot.wtTable.holder.offsetHeight?0:r.getScrollbarWidth(),new v.default(i,n,this.wot.getSetting("totalRows"),function(n){return h.wot.wtTable.getRowHeight(n)},u?null:this.wot.wtSettings.settings.viewportRowCalculatorOverride,u,s)}},{key:"createColumnsCalculator",value:function(){var f=this,e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:!1,t=this.getViewportWidth(),n=void 0,i=void 0,u;return this.columnHeaderHeight=NaN,n=this.wot.wtOverlays.leftOverlay.getScrollPosition()-this.wot.wtOverlays.leftOverlay.getTableParentOffset(),n<0&&(n=0),i=this.wot.getSetting("fixedColumnsLeft"),i&&(u=this.wot.wtOverlays.leftOverlay.sumCellSizes(0,i),n+=u,t-=u),this.wot.wtTable.holder.clientWidth!==this.wot.wtTable.holder.offsetWidth&&(t-=r.getScrollbarWidth()),new l.default(t,n,this.wot.getSetting("totalColumns"),function(n){return f.wot.wtTable.getColumnWidth(n)},e?null:this.wot.wtSettings.settings.viewportColumnCalculatorOverride,e,this.wot.getSetting("stretchH"),function(n,t){return f.wot.getSetting("onBeforeStretchingColumnWidth",n,t)})}},{key:"createRenderCalculators",value:function(){var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:!1,t,i;return n&&(t=this.createRowsCalculator(!0),i=this.createColumnsCalculator(!0),this.areAllProposedVisibleRowsAlreadyRendered(t)&&this.areAllProposedVisibleColumnsAlreadyRendered(i)||(n=!1)),n||(this.rowsRenderCalculator=this.createRowsCalculator(),this.columnsRenderCalculator=this.createColumnsCalculator()),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,n}},{key:"createVisibleCalculators",value:function(){this.rowsVisibleCalculator=this.createRowsCalculator(!0);this.columnsVisibleCalculator=this.createColumnsCalculator(!0)}},{key:"areAllProposedVisibleRowsAlreadyRendered",value:function(n){return this.rowsVisibleCalculator?n.startRow<this.rowsRenderCalculator.startRow||n.startRow===this.rowsRenderCalculator.startRow&&n.startRow>0?!1:n.endRow>this.rowsRenderCalculator.endRow||n.endRow===this.rowsRenderCalculator.endRow&&n.endRow<this.wot.getSetting("totalRows")-1?!1:!0:!1}},{key:"areAllProposedVisibleColumnsAlreadyRendered",value:function(n){return this.columnsVisibleCalculator?n.startColumn<this.columnsRenderCalculator.startColumn||n.startColumn===this.columnsRenderCalculator.startColumn&&n.startColumn>0?!1:n.endColumn>this.columnsRenderCalculator.endColumn||n.endColumn===this.columnsRenderCalculator.endColumn&&n.endColumn<this.wot.getSetting("totalColumns")-1?!1:!0:!1}},{key:"resetHasOversizedColumnHeadersMarked",value:function(){o.objectEach(this.hasOversizedColumnHeadersMarked,function(n,t,i){i[t]=void 0})}}]),n}();t.default=f},function(n,t,i){"use strict";function e(n){return n&&n.__esModule?n:{"default":n}}function w(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var h;t.__esModule=!0;var f=function(){function n(n,t){var r=[],u=!0,f=!1,e=undefined,i,o;try{for(i=n[Symbol.iterator]();!(u=(o=i.next()).done);u=!0)if(r.push(o.value),t&&r.length===t)break}catch(s){f=!0;e=s}finally{try{!u&&i["return"]&&i["return"]()}finally{if(f)throw e;}}return r}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return n(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance");}}(),c=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),r=i(2),l=i(11),o=i(1),u=i(33),a=i(9),v=e(a),y=i(61),s=e(y),p=i(29),b=e(p);h=function(){function n(t,i){(w(this,n),i)&&(this.eventManager=new v.default(t),this.instance=t,this.wot=t,this.settings=i,this.mouseDown=!1,this.main=null,this.top=null,this.left=null,this.bottom=null,this.right=null,this.topStyle=null,this.leftStyle=null,this.bottomStyle=null,this.rightStyle=null,this.cornerDefaultStyle={width:"5px",height:"5px",borderWidth:"2px",borderStyle:"solid",borderColor:"#FFF"},this.corner=null,this.cornerStyle=null,this.createBorders(i),this.registerListeners())}return c(n,[{key:"registerListeners",value:function(){var n=this,r,t,i;for(this.eventManager.addEventListener(document.body,"mousedown",function(){return n.onMouseDown()}),this.eventManager.addEventListener(document.body,"mouseup",function(){return n.onMouseUp()}),r=function(t){n.eventManager.addEventListener(n.main.childNodes[t],"mouseenter",function(i){return n.onMouseEnter(i,n.main.childNodes[t])})},t=0,i=this.main.childNodes.length;t<i;t++)r(t,i)}},{key:"onMouseDown",value:function(){this.mouseDown=!0}},{key:"onMouseUp",value:function(){this.mouseDown=!1}},{key:"onMouseEnter",value:function(n,t){function f(n){return n.clientY<Math.floor(i.top)?!0:n.clientY>Math.ceil(i.top+i.height)?!0:n.clientX<Math.floor(i.left)?!0:n.clientX>Math.ceil(i.left+i.width)?!0:void 0}function r(n){f(n)&&(u.eventManager.removeEventListener(document.body,"mousemove",r),t.style.display="block")}if(this.mouseDown&&this.wot.getSetting("hideBorderOnMouseDownOver")){n.preventDefault();l.stopImmediatePropagation(n);var u=this,i=t.getBoundingClientRect();t.style.display="none";this.eventManager.addEventListener(document.body,"mousemove",r)}}},{key:"createBorders",value:function(n){var e,i,f,t,r;for(this.main=document.createElement("div"),e=["top","left","bottom","right","corner"],i=this.main.style,i.position="absolute",i.top=0,i.left=0,f=0;f<5;f++)t=e[f],r=document.createElement("div"),r.className="wtBorder "+(this.settings.className||""),this.settings[t]&&this.settings[t].hide&&(r.className+=" hidden"),i=r.style,i.backgroundColor=this.settings[t]&&this.settings[t].color?this.settings[t].color:n.border.color,i.height=this.settings[t]&&this.settings[t].width?this.settings[t].width+"px":n.border.width+"px",i.width=this.settings[t]&&this.settings[t].width?this.settings[t].width+"px":n.border.width+"px",this.main.appendChild(r);this.top=this.main.childNodes[0];this.left=this.main.childNodes[1];this.bottom=this.main.childNodes[2];this.right=this.main.childNodes[3];this.topStyle=this.top.style;this.leftStyle=this.left.style;this.bottomStyle=this.bottom.style;this.rightStyle=this.right.style;this.corner=this.main.childNodes[4];this.corner.className+=" corner";this.cornerStyle=this.corner.style;this.cornerStyle.width=this.cornerDefaultStyle.width;this.cornerStyle.height=this.cornerDefaultStyle.height;this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" ");u.isMobileBrowser()&&this.createMultipleSelectorHandles();this.disappear();this.wot.wtTable.bordersHolder||(this.wot.wtTable.bordersHolder=document.createElement("div"),this.wot.wtTable.bordersHolder.className="htBorders",this.wot.wtTable.spreader.appendChild(this.wot.wtTable.bordersHolder));this.wot.wtTable.bordersHolder.insertBefore(this.main,this.wot.wtTable.bordersHolder.firstChild)}},{key:"createMultipleSelectorHandles",value:function(){var u,f,i,n,r,t;this.selectionHandles={topLeft:document.createElement("DIV"),topLeftHitArea:document.createElement("DIV"),bottomRight:document.createElement("DIV"),bottomRightHitArea:document.createElement("DIV")};u=10;f=40;this.selectionHandles.topLeft.className="topLeftSelectionHandle";this.selectionHandles.topLeftHitArea.className="topLeftSelectionHandle-HitArea";this.selectionHandles.bottomRight.className="bottomRightSelectionHandle";this.selectionHandles.bottomRightHitArea.className="bottomRightSelectionHandle-HitArea";this.selectionHandles.styles={topLeft:this.selectionHandles.topLeft.style,topLeftHitArea:this.selectionHandles.topLeftHitArea.style,bottomRight:this.selectionHandles.bottomRight.style,bottomRightHitArea:this.selectionHandles.bottomRightHitArea.style};i={position:"absolute",height:f+"px",width:f+"px","border-radius":parseInt(f/1.5,10)+"px"};for(n in i)o.hasOwnProperty(i,n)&&(this.selectionHandles.styles.bottomRightHitArea[n]=i[n],this.selectionHandles.styles.topLeftHitArea[n]=i[n]);r={position:"absolute",height:u+"px",width:u+"px","border-radius":parseInt(u/1.5,10)+"px",background:"#F5F5FF",border:"1px solid #4285c8"};for(t in r)o.hasOwnProperty(r,t)&&(this.selectionHandles.styles.bottomRight[t]=r[t],this.selectionHandles.styles.topLeft[t]=r[t]);this.main.appendChild(this.selectionHandles.topLeft);this.main.appendChild(this.selectionHandles.bottomRight);this.main.appendChild(this.selectionHandles.topLeftHitArea);this.main.appendChild(this.selectionHandles.bottomRightHitArea)}},{key:"isPartRange",value:function(n,t){var i=this.wot.selections.createOrGetArea();return i.cellRange&&(n!=i.cellRange.to.row||t!=i.cellRange.to.col)?!0:!1}},{key:"updateMultipleSelectionHandlesPosition",value:function(n,t,i,r,u,f){var o=parseInt(this.selectionHandles.styles.topLeft.width,10),e=parseInt(this.selectionHandles.styles.topLeftHitArea.width,10);this.selectionHandles.styles.topLeft.top=parseInt(i-o,10)+"px";this.selectionHandles.styles.topLeft.left=parseInt(r-o,10)+"px";this.selectionHandles.styles.topLeftHitArea.top=parseInt(i-e/4*3,10)+"px";this.selectionHandles.styles.topLeftHitArea.left=parseInt(r-e/4*3,10)+"px";this.selectionHandles.styles.bottomRight.top=parseInt(i+f,10)+"px";this.selectionHandles.styles.bottomRight.left=parseInt(r+u,10)+"px";this.selectionHandles.styles.bottomRightHitArea.top=parseInt(i+f-e/4,10)+"px";this.selectionHandles.styles.bottomRightHitArea.left=parseInt(r+u-e/4,10)+"px";this.settings.border.multipleSelectionHandlesVisible&&this.settings.border.multipleSelectionHandlesVisible()?(this.selectionHandles.styles.topLeft.display="block",this.selectionHandles.styles.topLeftHitArea.display="block",this.isPartRange(n,t)?(this.selectionHandles.styles.bottomRight.display="none",this.selectionHandles.styles.bottomRightHitArea.display="none"):(this.selectionHandles.styles.bottomRight.display="block",this.selectionHandles.styles.bottomRightHitArea.display="block")):(this.selectionHandles.styles.topLeft.display="none",this.selectionHandles.styles.bottomRight.display="none",this.selectionHandles.styles.topLeftHitArea.display="none",this.selectionHandles.styles.bottomRightHitArea.display="none");n==this.wot.wtSettings.getSetting("fixedRowsTop")||t==this.wot.wtSettings.getSetting("fixedColumnsLeft")?(this.selectionHandles.styles.topLeft.zIndex="9999",this.selectionHandles.styles.topLeftHitArea.zIndex="9999"):(this.selectionHandles.styles.topLeft.zIndex="",this.selectionHandles.styles.topLeftHitArea.zIndex="")}},{key:"appear",value:function(n){var w,b,k,d,st,g,nt,tt,it,ct,ut,ft,e,t,lt,et,ot,at,vt,y,pt,wt,ri,ui;if(!this.disabled){var l=void 0,h=void 0,a=void 0,c=void 0,bt=this.wot.wtTable.getRenderedRowsCount();for(w=0;w<bt;w+=1)if(b=this.wot.wtTable.rowFilter.renderedToSource(w),b>=n[0]&&b<=n[2]){l=b;break}for(k=bt-1;k>=0;k-=1)if(d=this.wot.wtTable.rowFilter.renderedToSource(k),d>=n[0]&&d<=n[2]){h=d;break}for(st=this.wot.wtTable.getRenderedColumnsCount(),g=0;g<st;g+=1)if(nt=this.wot.wtTable.columnFilter.renderedToSource(g),nt>=n[1]&&nt<=n[3]){a=nt;break}for(tt=st-1;tt>=0;tt-=1)if(it=this.wot.wtTable.columnFilter.renderedToSource(tt),it>=n[1]&&it<=n[3]){c=it;break}if(l===void 0||a===void 0){this.disappear();return}var p=this.wot.wtTable.getCell(new s.default(l,a)),kt=l!==h||a!==c,v=kt?this.wot.wtTable.getCell(new s.default(h,c)):p,ht=r.offset(p),dt=kt?r.offset(v):ht,rt=r.offset(this.wot.wtTable.TABLE),gt=ht.top,ni=ht.left,o=ni-rt.left-1,i=dt.left+r.outerWidth(v)-ni;this.isEntireColumnSelected(l,h)&&(ct=this.getDimensionsFromHeader("columns",a,c,rt),ut=null,ct&&(ft=f(ct,3),ut=ft[0],o=ft[1],i=ft[2]),ut&&(p=ut));e=gt-rt.top-1;t=dt.top+r.outerHeight(v)-gt;this.isEntireRowSelected(a,c)&&(lt=this.getDimensionsFromHeader("rows",l,h,rt),et=null,lt&&(ot=f(lt,3),et=ot[0],e=ot[1],t=ot[2]),et&&(p=et));at=r.getComputedStyle(p);parseInt(at.borderTopWidth,10)>0&&(e+=1,t=t>0?t-1:0);parseInt(at.borderLeftWidth,10)>0&&(o+=1,i=i>0?i-1:0);this.topStyle.top=e+"px";this.topStyle.left=o+"px";this.topStyle.width=i+"px";this.topStyle.display="block";this.leftStyle.top=e+"px";this.leftStyle.left=o+"px";this.leftStyle.height=t+"px";this.leftStyle.display="block";vt=Math.floor(this.settings.border.width/2);this.bottomStyle.top=e+t-vt+"px";this.bottomStyle.left=o+"px";this.bottomStyle.width=i+"px";this.bottomStyle.display="block";this.rightStyle.top=e+"px";this.rightStyle.left=o+i-vt+"px";this.rightStyle.height=t+1+"px";this.rightStyle.display="block";y=this.settings.border.cornerVisible;y=typeof y=="function"?y(this.settings.layerLevel):y;var yt=this.wot.getSetting("onModifyGetCellCoords",h,c),ti=h,ii=c;yt&&Array.isArray(yt)&&(pt=f(yt,4),ti=pt[2],ii=pt[3]);u.isMobileBrowser()||!y||this.isPartRange(ti,ii)?this.cornerStyle.display="none":(this.cornerStyle.top=e+t-4+"px",this.cornerStyle.left=o+i-4+"px",this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none",wt=r.getTrimmingContainer(this.wot.wtTable.TABLE),c===this.wot.getSetting("totalColumns")-1&&(ri=v.offsetLeft+r.outerWidth(v)+parseInt(this.cornerDefaultStyle.width,10)/2>=r.innerWidth(wt),ri&&(this.cornerStyle.left=Math.floor(o+i-3-parseInt(this.cornerDefaultStyle.width,10)/2)+"px",this.cornerStyle.borderRightWidth=0)),h===this.wot.getSetting("totalRows")-1&&(ui=v.offsetTop+r.outerHeight(v)+parseInt(this.cornerDefaultStyle.height,10)/2>=r.innerHeight(wt),ui&&(this.cornerStyle.top=Math.floor(e+t-3-parseInt(this.cornerDefaultStyle.height,10)/2)+"px",this.cornerStyle.borderBottomWidth=0)),this.cornerStyle.display="block");u.isMobileBrowser()&&this.updateMultipleSelectionHandlesPosition(l,a,e,o,i,t)}}},{key:"isEntireColumnSelected",value:function(n,t){return n===this.wot.wtTable.getFirstRenderedRow()&&t===this.wot.wtTable.getLastRenderedRow()}},{key:"isEntireRowSelected",value:function(n,t){return n===this.wot.wtTable.getFirstRenderedColumn()&&t===this.wot.wtTable.getLastRenderedColumn()}},{key:"getDimensionsFromHeader",value:function(n,t,i,u){var a=this,w=this.wot.wtTable.wtRootElement.parentNode,s=null,h=null,c=null,v=null,y=null,f=null,e=null,o=null,l,p;switch(n){case"rows":s=function(){var n;return(n=a.wot.wtTable).getRowHeader.apply(n,arguments)};h=function(){return r.outerHeight.apply(undefined,arguments)};c="ht__selection--rows";f="top";break;case"columns":s=function(){var n;return(n=a.wot.wtTable).getColumnHeader.apply(n,arguments)};h=function(){return r.outerWidth.apply(undefined,arguments)};c="ht__selection--columns";f="left"}return w.className.includes(c)?(e=s(t,0),o=s(i,0),!e||!o)?!1:(l=r.offset(e),p=r.offset(o),e&&o&&(v=l[f]-u[f]-1,y=p[f]+h(o)-l[f]),[e,v,y]):!1}},{key:"disappear",value:function(){this.topStyle.display="none";this.leftStyle.display="none";this.bottomStyle.display="none";this.rightStyle.display="none";this.cornerStyle.display="none";u.isMobileBrowser()&&(this.selectionHandles.styles.topLeft.display="none",this.selectionHandles.styles.bottomRight.display="none")}}]),n}();t.default=h},function(n,t,i){"use strict";function v(n){return n&&n.__esModule?n:{"default":n}}function l(n){var t,i;if(o=!1,t=this.getActiveEditor(),e.isPrintableChar(n.keyCode)||n.keyCode===e.KEY_CODES.BACKSPACE||n.keyCode===e.KEY_CODES.DELETE||n.keyCode===e.KEY_CODES.INSERT){if(i=0,n.keyCode===e.KEY_CODES.C&&(n.ctrlKey||n.metaKey))return;t.isOpened()||(i+=10);t.htEditor&&t.instance._registerTimeout(setTimeout(function(){t.queryChoices(t.TEXTAREA.value);o=!0},i))}}var r,o;t.__esModule=!0;var e=i(18),s=i(13),c=i(30),h=i(0),u=i(2),a=i(203),f=v(a);r=f.default.prototype.extend();r.prototype.init=function(){f.default.prototype.init.apply(this,arguments);this.query=null;this.strippedChoices=[];this.rawChoices=[]};r.prototype.getValue=function(){var n=this,t=this.rawChoices.find(function(t){var i=n.stripValueIfNeeded(t);return i===n.TEXTAREA.value});return s.isDefined(t)?t:this.TEXTAREA.value};r.prototype.createElements=function(){f.default.prototype.createElements.apply(this,arguments);u.addClass(this.htContainer,"autocompleteEditor");u.addClass(this.htContainer,window.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll")};o=!1;r.prototype.prepare=function(){this.instance.addHook("beforeKeyDown",l);f.default.prototype.prepare.apply(this,arguments)};r.prototype.open=function(){this.TEXTAREA_PARENT.style.overflow="auto";f.default.prototype.open.apply(this,arguments);this.TEXTAREA_PARENT.style.overflow="";var i=this.htEditor.getInstance(),n=this,t=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown;this.TEXTAREA.style.visibility="visible";this.focus();i.updateSettings({colWidths:t?[u.outerWidth(this.TEXTAREA)-2]:void 0,width:t?u.outerWidth(this.TEXTAREA)+u.getScrollbarWidth()+2:void 0,afterRenderer:function(t,i,r,u,f){var h=n.cellProperties,c=h.filteringCaseSensitive,l=h.allowHtml,e=void 0,o=void 0;f=s.stringify(f);f&&!l&&(e=c===!0?f.indexOf(this.query):f.toLowerCase().indexOf(n.query.toLowerCase()),e!==-1&&(o=f.substr(e,n.query.length),f=f.replace(o,"<strong>"+o+"<\/strong>")));t.innerHTML=f},autoColumnSize:!0,modifyColWidth:function(n,i){var r=this.getPlugin("autoColumnSize").widths;return r[i]&&(n=r[i]),t?n:n+15}});this.htEditor.view.wt.wtTable.holder.parentNode.style["padding-right"]=u.getScrollbarWidth()+2+"px";o&&(o=!1);n.instance._registerTimeout(setTimeout(function(){n.queryChoices(n.TEXTAREA.value)},0))};r.prototype.close=function(){f.default.prototype.close.apply(this,arguments)};r.prototype.queryChoices=function(n){var i=this,t;this.query=n;t=this.cellProperties.source;typeof t=="function"?t.call(this.cellProperties,n,function(n){i.rawChoices=n;i.updateChoicesList(i.stripValuesIfNeeded(n))}):Array.isArray(t)?(this.rawChoices=t,this.updateChoicesList(this.stripValuesIfNeeded(t))):this.updateChoicesList([])};r.prototype.updateChoicesList=function(n){var s=u.getCaretPosition(this.TEXTAREA),c=u.getSelectionEndPosition(this.TEXTAREA),l=this.cellProperties.sortByRelevance,v=this.cellProperties.filter,i=null,o=null,f,e,t,a;if(l&&(i=r.sortByRelevance(this.stripValueIfNeeded(this.getValue()),n,this.cellProperties.filteringCaseSensitive)),f=Array.isArray(i)?i.length:0,v===!1)f&&(o=i[0]);else{for(e=[],t=0,a=n.length;t<a;t++){if(l&&f<=t)break;f?e.push(n[i[t]]):e.push(n[t])}o=0;n=e}this.strippedChoices=n;this.htEditor.loadData(h.pivot([n]));this.updateDropdownHeight();this.flipDropdownIfNeeded();this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(o);this.instance.listen(!1);u.setCaretPosition(this.TEXTAREA,s,s===c?void 0:c)};r.prototype.flipDropdownIfNeeded=function(){var s=u.offset(this.TEXTAREA),h=u.outerHeight(this.TEXTAREA),t=this.getDropdownHeight(),n=u.getTrimmingContainer(this.instance.view.wt.wtTable.TABLE),c=n.scrollTop,e=u.outerHeight(this.instance.view.wt.wtTable.THEAD),o={row:0,col:0};n!==window&&(o=u.offset(n));var i=s.top-o.top-e+c,r=n.scrollHeight-i-e-h,f=t>r&&i>r;return f?this.flipDropdown(t):this.unflipDropdown(),this.limitDropdownIfNeeded(f?i:r,t),f};r.prototype.limitDropdownIfNeeded=function(n,t){if(t>n){var i=0,u=0,r=0,f=null;do r=this.htEditor.getRowHeight(u)||this.htEditor.view.wt.wtSettings.settings.defaultRowHeight,i+=r,u++;while(i<n);f=i-r;this.htEditor.flipped&&(this.htEditor.rootElement.style.top=parseInt(this.htEditor.rootElement.style.top,10)+t-f+"px");this.setDropdownHeight(i-r)}};r.prototype.flipDropdown=function(n){var t=this.htEditor.rootElement.style;t.position="absolute";t.top=-n+"px";this.htEditor.flipped=!0};r.prototype.unflipDropdown=function(){var n=this.htEditor.rootElement.style;n.position==="absolute"&&(n.position="",n.top="");this.htEditor.flipped=void 0};r.prototype.updateDropdownHeight=function(){var n=this.htEditor.getColWidth(0)+u.getScrollbarWidth()+2,t=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:t?void 0:n});this.htEditor.view.wt.wtTable.alignOverlaysWithTrimmingContainer()};r.prototype.setDropdownHeight=function(n){this.htEditor.updateSettings({height:n})};r.prototype.finishEditing=function(n){n||this.instance.removeHook("beforeKeyDown",l);f.default.prototype.finishEditing.apply(this,arguments)};r.prototype.highlightBestMatchingChoice=function(n){typeof n=="number"?this.htEditor.selectCell(n,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()};r.sortByRelevance=function(n,t,i){var f=[],u=void 0,l=n.length,e=void 0,a=void 0,o=[],r=void 0,h=t.length;if(l===0){for(r=0;r<h;r++)o.push(r);return o}for(r=0;r<h;r++)u=c.stripTags(s.stringify(t[r])),e=i?u.indexOf(n):u.toLowerCase().indexOf(n.toLowerCase()),e!==-1&&(a=u.length-e-l,f.push({baseIndex:r,index:e,charsLeft:a,value:u}));for(f.sort(function(n,t){if(t.index===-1)return-1;if(n.index===-1)return 1;if(n.index<t.index)return-1;if(t.index<n.index)return 1;if(n.index===t.index){if(n.charsLeft<t.charsLeft)return-1;if(n.charsLeft>t.charsLeft)return 1}return 0}),r=0,h=f.length;r<h;r++)o.push(f[r].baseIndex);return o};r.prototype.getDropdownHeight=function(){var n=this.htEditor.getInstance().getRowHeight(0)||23,t=this.cellProperties.visibleRows;return this.strippedChoices.length>=t?t*n:this.strippedChoices.length*n+8};r.prototype.stripValueIfNeeded=function(n){return this.stripValuesIfNeeded([n])[0]};r.prototype.stripValuesIfNeeded=function(n){var t=this.cellProperties.allowHtml,i=h.arrayMap(n,function(n){return s.stringify(n)});return h.arrayMap(i,function(n){return t?n:c.stripTags(n)})};r.prototype.allowKeyEventPropagation=function(n){var r=this.htEditor.getSelectedRangeLast(),t={row:r?r.from.row:-1},i=!1;return n===e.KEY_CODES.ARROW_DOWN&&t.row>0&&t.row<this.htEditor.countRows()-1&&(i=!0),n===e.KEY_CODES.ARROW_UP&&t.row>-1&&(i=!0),i};r.prototype.discardEditor=function(){f.default.prototype.discardEditor.apply(this,arguments);this.instance.view.render()};t.default=r},function(n,t,i){"use strict";function l(n){return n&&n.__esModule?n:{"default":n}}var r,f;t.__esModule=!0;var e=i(18),s=i(1),h=i(2),o=i(11),c=i(62),u=l(c);r=u.default.prototype.extend();r.prototype.createElements=function(){u.default.prototype.createElements.apply(this,arguments);var n=document.createElement("DIV");n.className="handsontableEditor";this.TEXTAREA_PARENT.appendChild(n);this.htContainer=n;this.assignHooks()};r.prototype.prepare=function(n,t,i,r,f,e){u.default.prototype.prepare.apply(this,arguments);var o=this,h={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,afterOnCellMouseDown:function(n,t){var i=this.getSourceData(t.row,t.col);i!==void 0&&o.setValue(i);o.instance.destroyEditor()}};this.cellProperties.handsontable&&s.extend(h,e.handsontable);this.htOptions=h};f=function(n){var u,t,i,r,f;o.isImmediatePropagationStopped(n)||(u=this.getActiveEditor(),t=u.htEditor.getInstance(),n.keyCode==e.KEY_CODES.ARROW_DOWN?t.getSelectedLast()||t.flipped?t.getSelectedLast()&&(t.flipped?i=t.getSelectedLast()[0]+1:t.flipped||(r=t.getSelectedLast()[0],f=t.countRows()-1,i=Math.min(f,r+1))):i=0:n.keyCode==e.KEY_CODES.ARROW_UP&&(!t.getSelectedLast()&&t.flipped?i=t.countRows()-1:t.getSelectedLast()&&(t.flipped?(r=t.getSelectedLast()[0],i=Math.max(0,r-1)):(r=t.getSelectedLast()[0],i=r-1))),i!==void 0&&(i<0||t.flipped&&i>t.countRows()-1?t.deselectCell():t.selectCell(i,0),t.getData().length&&(n.preventDefault(),o.stopImmediatePropagation(n),u.instance.listen(),u.TEXTAREA.focus())))};r.prototype.open=function(){this.instance.addHook("beforeKeyDown",f);u.default.prototype.open.apply(this,arguments);this.htEditor&&this.htEditor.destroy();this.htEditor=new this.instance.constructor(this.htContainer,this.htOptions);this.htEditor.init();this.cellProperties.strict?(this.htEditor.selectCell(0,0),this.TEXTAREA.style.visibility="hidden"):(this.htEditor.deselectCell(),this.TEXTAREA.style.visibility="visible");h.setCaretPosition(this.TEXTAREA,0,this.TEXTAREA.value.length)};r.prototype.close=function(){this.instance.removeHook("beforeKeyDown",f);this.instance.listen();u.default.prototype.close.apply(this,arguments)};r.prototype.focus=function(){this.instance.listen();u.default.prototype.focus.apply(this,arguments)};r.prototype.beginEditing=function(){var n=this.instance.getSettings().onBeginEditing;n&&n()===!1||u.default.prototype.beginEditing.apply(this,arguments)};r.prototype.finishEditing=function(){if(this.htEditor&&this.htEditor.isListening()&&this.instance.listen(),this.htEditor&&this.htEditor.getSelectedLast()){var n=this.htEditor.getInstance().getValue();n!==void 0&&this.setValue(n)}return u.default.prototype.finishEditing.apply(this,arguments)};r.prototype.assignHooks=function(){var n=this;this.instance.addHook("afterDestroy",function(){n.htEditor&&n.htEditor.destroy()})};t.default=r},function(n,t){"use strict";function i(n){var t=new Date(n);return isNaN(new Date(n+"T00:00").getDate())?t:new Date(t.getTime()+t.getTimezoneOffset()*6e4)}t.__esModule=!0;t.getNormalizedDate=i},function(n,t){"use strict";(function(n){function r(n){return n.split('"').length-1}var i={parse:function(n){var i,c,t,u=[],f=0,e,h,o,s;for(t=n.split("\n"),t.length>1&&t[t.length-1]===""&&t.pop(),i=0,c=t.length;i<c;i+=1){for(t[i]=t[i].split("\t"),e=0,h=t[i].length;e<h;e+=1)u[f]||(u[f]=[]),o&&e===0?(s=u[f].length-1,u[f][s]=u[f][s]+"\n"+t[i][0],o&&r(t[i][0])&1&&(o=!1,u[f][s]=u[f][s].substring(0,u[f][s].length-1).replace(/""/g,'"'))):e===h-1&&t[i][e].indexOf('"')===0&&r(t[i][e])&1?(u[f].push(t[i][e].substring(1).replace(/""/g,'"')),o=!0):(u[f].push(t[i][e].replace(/""/g,'"')),o=!1);o||(f+=1)}return u},stringify:function(n){for(var r,e,u="",t,i=0,f=n.length;i<f;i+=1){for(e=n[i].length,r=0;r<e;r+=1)r>0&&(u+="\t"),t=n[i][r],u+=typeof t=="string"?t.indexOf("\n")>-1?'"'+t.replace(/"/g,'""')+'"':t:t===null||t===void 0?"":t;i!==f-1&&(u+="\n")}return u}};t.parse=i.parse;t.stringify=i.stringify})(window)},function(n,t){"use strict";function u(n){i.set(n,!0)}function f(n){return n===r}function e(n){return i.has(n)}t.__esModule=!0;t.registerAsRootInstance=u;t.hasValidParameter=f;t.isRootInstance=e;var i=t.holder=new WeakMap,r=t.rootInstanceSymbol=Symbol("rootInstance")},function(n,t,i){"use strict";function u(){}t.__esModule=!0;var f=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},r=i(13),e=i(1);u.prototype={licenseKey:"trial",data:void 0,dataSchema:void 0,width:void 0,height:void 0,startRows:5,startCols:5,rowHeaders:void 0,colHeaders:null,colWidths:void 0,rowHeights:void 0,columns:void 0,cells:void 0,cell:[],comments:!1,customBorders:!1,minRows:0,minCols:0,maxRows:Infinity,maxCols:Infinity,minSpareRows:0,minSpareCols:0,allowInsertRow:!0,allowInsertColumn:!0,allowRemoveRow:!0,allowRemoveColumn:!0,selectionMode:"multiple",fillHandle:!0,fixedRowsTop:0,fixedRowsBottom:0,fixedColumnsLeft:0,outsideClickDeselects:!0,enterBeginsEditing:!0,enterMoves:{row:1,col:0},tabMoves:{row:0,col:1},autoWrapRow:!1,autoWrapCol:!1,persistentState:void 0,currentRowClassName:void 0,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",className:void 0,tableClassName:void 0,stretchH:"none",isEmptyRow:function(n){for(var t,o,i=0,u=this.countCols();i<u;i++)if(t=this.getDataAtCell(n,i),t!==""&&t!==null&&r.isDefined(t))return(typeof t=="undefined"?"undefined":f(t))==="object"?(o=this.getCellMeta(n,i),e.isObjectEqual(this.getSchema()[o.prop],t)):!1;return!0},isEmptyCol:function(n){for(var i,t=0,u=this.countRows();t<u;t++)if(i=this.getDataAtCell(t,n),i!==""&&i!==null&&r.isDefined(i))return!1;return!0},observeDOMVisibility:!0,allowInvalid:!0,allowEmpty:!0,invalidCellClassName:"htInvalid",placeholder:!1,placeholderCellClassName:"htPlaceholder",readOnlyCellClassName:"htDimmed",renderer:void 0,commentedCellClassName:"htCommentCell",fragmentSelection:!1,readOnly:!1,skipColumnOnPaste:!1,search:!1,type:"text",copyable:!0,editor:void 0,autoComplete:void 0,visibleRows:10,trimDropdown:!0,debug:!1,wordWrap:!0,noWordWrapClassName:"htNoWrap",contextMenu:void 0,copyPaste:!0,undo:void 0,columnSorting:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,mergeCells:!1,viewportRowRenderingOffset:"auto",viewportColumnRenderingOffset:"auto",validator:void 0,disableVisualSelection:!1,sortIndicator:void 0,manualColumnFreeze:void 0,trimWhitespace:!0,settings:void 0,source:void 0,title:void 0,checkedTemplate:void 0,uncheckedTemplate:void 0,label:void 0,numericFormat:void 0,language:void 0,selectOptions:void 0,autoColumnSize:void 0,autoRowSize:void 0,dateFormat:void 0,correctFormat:!1,defaultDate:void 0,strict:void 0,allowHtml:!1,renderAllRows:void 0,preventOverflow:!1,bindRowsWithHeaders:void 0,collapsibleColumns:void 0,columnSummary:void 0,dropdownMenu:void 0,filters:void 0,formulas:void 0,ganttChart:void 0,headerTooltips:void 0,hiddenColumns:void 0,hiddenRows:void 0,nestedHeaders:void 0,trimRows:void 0,rowHeaderWidth:void 0,columnHeaderHeight:void 0,observeChanges:void 0,sortFunction:void 0,sortByRelevance:!0,filter:!0,filteringCaseSensitive:!1,dragToScroll:!0};t.default=u},function(n,t,i){"use strict";function o(n,t,i){var o=u.getLanguageDictionary(n),f,r;return o===null?null:(f=o[t],e.isUndefined(f))?null:(r=s(f,i),Array.isArray(r))?r[0]:r}function s(n,t){var i=n;return r.arrayEach(f.getPhraseFormatters(),function(r){i=r(n,t)}),i}t.__esModule=!0;t.getTranslatedPhrase=o;var r=i(0),u=i(82),f=i(298),e=i(13)},function(n,t,i){"use strict";function c(n,t){return Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(t)}}))}function l(n,t){return s.objectEach(t,function(t,i){u.isUndefined(n[i])&&(n[i]=t)}),n}function a(n,t){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:n,r=arguments.length>3&&arguments[3]!==undefined?arguments[3]:t,u;return n>t&&(u=[r,i],i=u[0],r=u[1]),i+"-"+r}function e(n){var t=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(n);return t?t[1].toLowerCase()+"-"+t[2].toUpperCase():n}function v(n,t){var i=e(t);f.hasLanguageDictionary(i)?n.language=i:(n.language=f.DEFAULT_LANGUAGE_CODE,o(t))}function o(n){u.isDefined(n)&&console.error(h.toSingleLine(r,n))}var r;t.__esModule=!0;r=c(['Language with code "','" was not found. You should register particular language \n    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.'],['Language with code "','" was not found. You should register particular language \n    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.']);t.extendNotExistingKeys=l;t.createCellHeadersRange=a;t.normalizeLanguageCode=e;t.applyLanguageSetting=v;t.warnUserAboutLanguageRegistration=o;var u=i(13),s=i(1),h=i(34),f=i(82)},function(n,t,i){"use strict";function c(n){return n&&n.__esModule?n:{"default":n}}function l(){u===0&&(f.addEventListener(document,"keydown",function(n){r.has(n.keyCode)||r.add(n.keyCode)}),f.addEventListener(document,"keyup",function(n){r.has(n.keyCode)&&r.delete(n.keyCode)}),f.addEventListener(document,"visibilitychange",function(){document.hidden&&r.clear()}));u+=1}function a(){u>0&&(u-=1);u===0&&o()}function o(){f.clearEvents();r.clear();u=0}function v(n){return Array.from(r.values()).some(function(t){return e.isKey(t,n)})}function y(){return Array.from(r.values()).some(function(n){return e.isCtrlMetaKey(n)})}function p(){return u}t.__esModule=!0;t.stopObserving=t.startObserving=t.isPressedCtrlKey=t.isPressed=t._resetState=t._getRefCount=undefined;var s=i(9),h=c(s),e=i(18),w=i(0);var f=new h.default,r=new Set,u=0;t._getRefCount=p;t._resetState=o;t.isPressed=v;t.isPressedCtrlKey=y;t.startObserving=l;t.stopObserving=a},function(n,t,i){"use strict";function r(n){if(Array.isArray(n)){for(var t=0,i=Array(n.length);t<n.length;t++)i[t]=n[t];return i}return Array.from(n)}function s(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}t.__esModule=!0;t.HEADER_TYPE=t.AREA_TYPE=t.FILL_TYPE=t.CELL_TYPE=undefined;var o=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),u=i(301),f=i(0);var e=t.CELL_TYPE="cell",h=t.FILL_TYPE="fill",c=t.AREA_TYPE="area",l=t.HEADER_TYPE="header",a=function(){function n(t){s(this,n);this.options=t;this.layerLevel=0;this.cell=u.createHighlight(e,t);this.fill=u.createHighlight(h,t);this.areas=new Map;this.headers=new Map;this.borders=[]}return o(n,[{key:"isEnabledFor",value:function(n){var t=this.options.disableHighlight;return n==="current"&&(n=e),typeof t=="string"&&(t=[t]),t===!1||Array.isArray(t)&&!t.includes(n)}},{key:"useLayerLevel",value:function(){var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;return this.layerLevel=n,this}},{key:"getCell",value:function(){return this.cell}},{key:"getFill",value:function(){return this.fill}},{key:"createOrGetArea",value:function(){var n=this.layerLevel,t=void 0;return this.areas.has(n)?t=this.areas.get(n):(t=u.createHighlight(c,Object.assign({layerLevel:n},this.options)),this.areas.set(n,t)),t}},{key:"getAreas",value:function(){return[].concat(r(this.areas.values()))}},{key:"createOrGetHeader",value:function(){var n=void 0,t=this.layerLevel;return this.headers.has(t)?n=this.headers.get(t):(n=u.createHighlight(l,Object.assign({},this.options)),this.headers.set(t,n)),n}},{key:"getHeaders",value:function(){return[].concat(r(this.headers.values()))}},{key:"clear",value:function(){this.cell.clear();this.fill.clear();f.arrayEach(this.areas.values(),function(n){n.clear()});f.arrayEach(this.headers.values(),function(n){n.clear()})}},{key:Symbol.iterator,value:function(){return[this.cell].concat(r(this.areas.values()),r(this.headers.values()),[this.fill],r(this.borders))[Symbol.iterator]()}}]),n}();t.default=a},function(n,t,i){"use strict";function s(n,t,i){return t in n?Object.defineProperty(n,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[t]=i,n}function h(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var f;t.__esModule=!0;var r=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),e=i(1),u=i(4),o=i(13);f=function(){function n(t){h(this,n);this.samples=null;this.dataFactory=t;this.customSampleCount=null;this.allowDuplicates=!1}return r(n,null,[{key:"SAMPLE_COUNT",get:function(){return 3}}]),r(n,[{key:"getSampleCount",value:function(){return this.customSampleCount?this.customSampleCount:n.SAMPLE_COUNT}},{key:"setSampleCount",value:function(n){this.customSampleCount=n}},{key:"setAllowDuplicates",value:function(n){this.allowDuplicates=n}},{key:"generateRowSamples",value:function(n,t){return this.generateSamples("row",t,n)}},{key:"generateColumnSamples",value:function(n,t){return this.generateSamples("col",t,n)}},{key:"generateSamples",value:function(n,t,i){var f=this,r=new Map;return typeof i=="number"&&(i={from:i,to:i}),u.rangeEach(i.from,i.to,function(i){var u=f.generateSample(n,t,i);r.set(i,u)}),r}},{key:"generateSample",value:function(n,t,i){var f=this,h=new Map,c=[],r=void 0;return u.rangeEach(t.from,t.to,function(t){var u=void 0,l,a,v;if(n==="row")u=f.dataFactory(i,t);else if(n==="col")u=f.dataFactory(t,i);else throw new Error("Unsupported sample type");r=e.isObject(u)?Object.keys(u).length:Array.isArray(u)?u.length:o.stringify(u).length;h.has(r)||h.set(r,{needed:f.getSampleCount(),strings:[]});l=h.get(r);l.needed&&(a=c.indexOf(u)>-1,(!a||f.allowDuplicates)&&(v=n==="row"?"col":"row",l.strings.push(s({value:u},v,t)),c.push(u),l.needed--))}),h}}]),n}();t.default=f},function(n,t,i){"use strict";function o(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function s(n,t){var i=void 0;return r.arrayEach(t,function(t){var r=t.key?t.key.split(":"):null;if(Array.isArray(r)&&r[1]===n)return i=t,!1}),i}var u;t.__esModule=!0;var f=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),r=i(0),e=i(1);u=function(){function n(t){o(this,n);this.hot=t;this.commands={};this.commonCallback=null}return f(n,[{key:"registerCommand",value:function(n,t){this.commands[n]=t}},{key:"setCommonCallback",value:function(n){this.commonCallback=n}},{key:"execute",value:function(n){for(var i,c,t,f,l=this,o=arguments.length,h=Array(o>1?o-1:0),u=1;u<o;u++)h[u-1]=arguments[u];if(i=n.split(":"),n=i[0],c=i.length===2?i[1]:null,t=this.commands[n],!t)throw new Error("Menu command '"+n+"' not exists.");(c&&t.submenu&&(t=s(c,t.submenu.items)),t.disabled!==!0)&&(typeof t.disabled!="function"||t.disabled.call(this.hot)!==!0)&&(e.hasOwnProperty(t,"submenu")||(f=[],typeof t.callback=="function"&&f.push(t.callback),typeof this.commonCallback=="function"&&f.push(this.commonCallback),h.unshift(i.join(":")),r.arrayEach(f,function(n){return n.apply(l.hot,h)})))}}]),n}();t.default=u},function(n,t,i){"use strict";function s(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function h(){var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null,f=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[],i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{},t=[];return n&&n.items?n=n.items:Array.isArray(n)||(n=f),r.isObject(n)?r.objectEach(n,function(n,u){var f=i[typeof n=="string"?n:u];f||(f=n);r.isObject(n)?r.extend(f,n):typeof f=="string"&&(f={name:f});f.key===void 0&&(f.key=u);t.push(f)}):o.arrayEach(n,function(n,f){var e=i[n];!e&&u.ITEMS.indexOf(n)>=0||(e||(e={name:n,key:""+f}),r.isObject(n)&&r.extend(e,n),e.key===void 0&&(e.key=f),t.push(e))}),t}var f;t.__esModule=!0;var e=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),r=i(1),o=i(0),u=i(44);f=function(){function n(t){var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;s(this,n);this.hot=t;this.predefinedItems=u.predefinedItems();this.defaultOrderPattern=i}return e(n,[{key:"setPredefinedItems",value:function(n){var i=this,t={};this.defaultOrderPattern.length=0;r.objectEach(n,function(n,r){var f="";n.name===u.SEPARATOR?(t[u.SEPARATOR]=n,f=u.SEPARATOR):isNaN(parseInt(r,10))?(n.key=n.key===void 0?r:n.key,t[r]=n,f=n.key):(t[n.key]=n,f=n.key);i.defaultOrderPattern.push(f)});this.predefinedItems=t}},{key:"getItems",value:function(){var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;return h(n,this.defaultOrderPattern,this.predefinedItems)}}]),n}();t.default=f},function(n,t,i){"use strict";function h(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var f,r;t.__esModule=!0;f=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}();r=i(4);var e=0,o=1,s=2,u="px",c=function(){function n(t){h(this,n);this.hot=t;this._element=null;this.state=e}return f(n,[{key:"appendTo",value:function(n){n.appendChild(this._element);this.state=s}},{key:"build",value:function(){this._element=document.createElement("div");this.state=o}},{key:"destroy",value:function(){this.isAppended()&&this._element.parentElement.removeChild(this._element);this._element=null;this.state=e}},{key:"isAppended",value:function(){return this.state===s}},{key:"isBuilt",value:function(){return this.state>=o}},{key:"setPosition",value:function(n,t){r.isNumeric(n)&&(this._element.style.top=n+u);r.isNumeric(t)&&(this._element.style.left=t+u)}},{key:"getPosition",value:function(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}},{key:"setSize",value:function(n,t){r.isNumeric(n)&&(this._element.style.width=n+u);r.isNumeric(t)&&(this._element.style.height=t+u)}},{key:"getSize",value:function(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}},{key:"setOffset",value:function(n,t){r.isNumeric(n)&&(this._element.style.marginTop=n+u);r.isNumeric(t)&&(this._element.style.marginLeft=t+u)}},{key:"getOffset",value:function(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}}]),n}();t.default=c},function(n,t){"use strict";function o(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var r;t.__esModule=!0;r=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}();var u=0,f=1,e=2,i="px",s=function(){function n(t){o(this,n);this.hot=t;this._element=null;this.state=u}return r(n,[{key:"appendTo",value:function(n){n.appendChild(this._element);this.state=e}},{key:"build",value:function(){this._element=document.createElement("div");this.state=f}},{key:"destroy",value:function(){this.isAppended()&&this._element.parentElement.removeChild(this._element);this._element=null;this.state=u}},{key:"isAppended",value:function(){return this.state===e}},{key:"isBuilt",value:function(){return this.state>=f}},{key:"setPosition",value:function(n,t){n!==void 0&&(this._element.style.top=n+i);t!==void 0&&(this._element.style.left=t+i)}},{key:"getPosition",value:function(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}},{key:"setSize",value:function(n,t){n&&(this._element.style.width=n+i);t&&(this._element.style.height=t+i)}},{key:"getSize",value:function(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}},{key:"setOffset",value:function(n,t){n&&(this._element.style.marginTop=n+i);t&&(this._element.style.marginLeft=t+i)}},{key:"getOffset",value:function(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}}]),n}();t.default=s},function(n,t){"use strict";function i(n,t,i,r){t?t.row===i&&t.col===r?(n.setAttribute("rowspan",t.rowspan.toString()),n.setAttribute("colspan",t.colspan.toString())):(n.removeAttribute("rowspan"),n.removeAttribute("colspan"),n.style.display="none"):(n.removeAttribute("rowspan"),n.removeAttribute("colspan"),n.style.display="")}t.__esModule=!0;t.applySpanProperties=i},function(n,t){"use strict";var r=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},f,u,i;
/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * json-patch-duplex.js version: 0.5.7
 * (c) 2013 Joachim Wester
 * MIT license
 */
f=undefined&&undefined.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);n.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)};u=Error,function(n){function l(n,t){var f,e,u,i;switch(typeof n=="undefined"?"undefined":r(n)){case"undefined":case"boolean":case"string":case"number":return n===t;case"object":if(n===null)return t===null;if(h(n)){if(!h(t)||n.length!==t.length)return!1;for(i=0,f=n.length;i<f;i++)if(!l(n[i],t[i]))return!1;return!0}if(e=c(t),u=e.length,c(n).length!==u)return!1;for(i=0;i<u;i++)if(!l(n[i],t[i]))return!1;return!0;default:return!1}}function o(n){return n.indexOf("/")===-1&&n.indexOf("~")===-1?n:n.replace(/~/g,"~0").replace(/\//g,"~1")}function nt(n){for(var t=0,i=s.length;t<i;t++)if(s[t].obj===n)return s[t]}function tt(n,t){for(var i=0,r=n.observers.length;i<r;i++)if(n.observers[i].callback===t)return n.observers[i].observer}function it(n,t){for(var i=0,r=n.observers.length;i<r;i++)if(n.observers[i].observer===t){n.observers.splice(i,1);return}}function rt(n,t){t.unobserve()}function a(n){return(typeof n=="undefined"?"undefined":r(n))==="object"?JSON.parse(JSON.stringify(n)):n}function ut(n,t){var l=n,i,f=nt(n),e;if(f?i=tt(f,t):(f=new d(n),s.push(f)),i)return i;if(i={},f.value=a(n),t){if(i.callback=t,i.next=null,e=this.intervals||[100,1e3,1e4,6e4],e.push===void 0)throw new u("jsonpatch.intervals must be an array");var o=0,c=function(){v(i)},r=function(){clearTimeout(i.next);i.next=setTimeout(function(){c();o=0;i.next=setTimeout(h,e[o++])},0)},h=function h(){c();o==e.length&&(o=e.length-1);i.next=setTimeout(h,e[o++])};typeof window!="undefined"&&(window.addEventListener?(window.addEventListener("mousedown",r),window.addEventListener("mouseup",r),window.addEventListener("keydown",r)):(document.documentElement.attachEvent("onmousedown",r),document.documentElement.attachEvent("onmouseup",r),document.documentElement.attachEvent("onkeydown",r)));i.next=setTimeout(h,e[o++])}return i.patches=[],i.object=n,i.unobserve=function(){v(i);clearTimeout(i.next);it(f,i);typeof window!="undefined"&&(window.removeEventListener?(window.removeEventListener("mousedown",r),window.removeEventListener("mouseup",r),window.removeEventListener("keydown",r)):(document.documentElement.detachEvent("onmousedown",r),document.documentElement.detachEvent("onmouseup",r),document.documentElement.detachEvent("onkeydown",r)))},f.observers.push(new g(t,i)),i}function v(n){for(var r,u,t=0,f=s.length;t<f;t++)if(s[t].obj===n.object){u=s[t];break}return y(u.value,n.object,n.patches,""),n.patches.length&&i(u.value,n.patches),r=n.patches,r.length>0&&(n.patches=[],n.callback&&n.callback(r)),r}function y(n,t,i,u){for(var h,s,f,l=c(t),v=c(n),w=!1,p=!1,e=v.length-1;e>=0;e--)f=v[e],h=n[f],t.hasOwnProperty(f)?(s=t[f],(typeof h=="undefined"?"undefined":r(h))=="object"&&h!=null&&(typeof s=="undefined"?"undefined":r(s))=="object"&&s!=null?y(h,s,i,u+"/"+o(f)):h!=s&&(w=!0,i.push({op:"replace",path:u+"/"+o(f),value:a(s)}))):(i.push({op:"remove",path:u+"/"+o(f)}),p=!0);if(p||l.length!=v.length)for(e=0;e<l.length;e++)f=l[e],n.hasOwnProperty(f)||i.push({op:"add",path:u+"/"+o(f),value:a(t[f])})}function ft(n){for(var t=0,r=n.length,i;t<r;){if(i=n.charCodeAt(t),i>=48&&i<=57){t++;continue}return!1}return!0}function i(n,i,r){for(var a=!1,c=0,w=i.length,f,u;c<w;){f=i[c];c++;for(var b=f.path||"",y=b.split("/"),o=n,s=1,v=y.length,l=undefined;;){if(u=y[s],r&&l===undefined&&(o[u]===undefined?l=y.slice(0,s).join("/"):s==v-1&&(l=f.path),l!==undefined&&this.validator(f,c-1,n,l)),s++,u===undefined&&s>=v){a=p[f.op].call(f,o,u,n);break}if(h(o)){if(u==="-")u=o.length;else{if(r&&!ft(u))throw new t("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",c-1,f.path,f);u=parseInt(u,10)}if(s>=v){if(r&&f.op==="add"&&u>o.length)throw new t("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",c-1,f.path,f);a=k[f.op].call(f,o,u,n);break}}else if(u&&u.indexOf("~")!=-1&&(u=u.replace(/~1/g,"/").replace(/~0/g,"~")),s>=v){a=e[f.op].call(f,o,u,n);break}o=o[u]}}return a}function et(n,t){var i=[];return y(n,t,i,""),i}function b(n){if(n===undefined)return!0;if(typeof n=="array"||(typeof n=="undefined"?"undefined":r(n))=="object")for(var t in n)if(b(n[t]))return!0;return!1}function ot(i,u,f,o){var s,c,a,l;if((typeof i=="undefined"?"undefined":r(i))!=="object"||i===null||h(i))throw new t("Operation is not an object","OPERATION_NOT_AN_OBJECT",u,i,f);else if(e[i.op]){if(typeof i.path!="string")throw new t("Operation `path` property is not a string","OPERATION_PATH_INVALID",u,i,f);else if((i.op==="move"||i.op==="copy")&&typeof i.from!="string")throw new t("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",u,i,f);else if((i.op==="add"||i.op==="replace"||i.op==="test")&&i.value===undefined)throw new t("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",u,i,f);else if((i.op==="add"||i.op==="replace"||i.op==="test")&&b(i.value))throw new t("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",u,i,f);else if(f)if(i.op=="add"){if(s=i.path.split("/").length,c=o.split("/").length,s!==c+1&&s!==c)throw new t("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",u,i,f);}else if(i.op==="replace"||i.op==="remove"||i.op==="_get"){if(i.path!==o)throw new t("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",u,i,f);}else if((i.op==="move"||i.op==="copy")&&(a={op:"_get",path:i.from,value:undefined},l=n.validate([a],f),l&&l.name==="OPERATION_PATH_UNRESOLVABLE"))throw new t("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",u,i,f);}else throw new t("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",u,i,f);}function st(n,r){try{if(!h(n))throw new t("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(r)r=JSON.parse(JSON.stringify(r)),i.call(this,r,n,!0);else for(var u=0;u<n.length;u++)this.validator(n[u],u)}catch(f){if(f instanceof t)return f;throw f;}}var c=function(n){var i,t,r;if(h(n)){for(t=new Array(n.length),i=0;i<t.length;i++)t[i]=""+i;return t}if(Object.keys)return Object.keys(n);t=[];for(r in n)n.hasOwnProperty(r)&&t.push(r);return t},e={add:function(n,t){return n[t]=this.value,!0},remove:function(n,t){return delete n[t],!0},replace:function(n,t){return n[t]=this.value,!0},move:function(n,t,r){var u={op:"_get",path:this.from};return i(r,[u]),i(r,[{op:"remove",path:this.from}]),i(r,[{op:"add",path:this.path,value:u.value}]),!0},copy:function(n,t,r){var u={op:"_get",path:this.from};return i(r,[u]),i(r,[{op:"add",path:this.path,value:u.value}]),!0},test:function(n,t){return l(n[t],this.value)},_get:function(n,t){this.value=n[t]}},k={add:function(n,t){return n.splice(t,0,this.value),!0},remove:function(n,t){return n.splice(t,1),!0},replace:function(n,t){return n[t]=this.value,!0},move:e.move,copy:e.copy,test:e.test,_get:e._get},p={add:function(n){p.remove.call(this,n);for(var t in this.value)this.value.hasOwnProperty(t)&&(n[t]=this.value[t]);return!0},remove:function(n){for(var t in n)n.hasOwnProperty(t)&&e.remove.call(this,n,t);return!0},replace:function(n){return i(n,[{op:"remove",path:this.path}]),i(n,[{op:"add",path:this.path,value:this.value}]),!0},move:e.move,copy:e.copy,test:function(n){return JSON.stringify(n)===JSON.stringify(this.value)},_get:function(n){this.value=n}},wt={add:function(n,t){var i={op:"add",path:t+o(this.name),value:this.object[this.name]};n.push(i)},"delete":function(n,t){var i={op:"remove",path:t+o(this.name)};n.push(i)},update:function(n,t){var i={op:"replace",path:t+o(this.name),value:this.object[this.name]};n.push(i)}},s=[],d=function(){function n(n){this.observers=[];this.obj=n}return n}(),g=function(){function n(n,t){this.callback=n;this.observer=t}return n}(),h,t;n.unobserve=rt;n.observe=ut;n.generate=v;h=Array.isArray?Array.isArray:function(n){return n.push&&typeof n.length=="number"};n.apply=i;n.compare=et;t=function(n){function t(t,i,r,u,f){n.call(this,t);this.message=t;this.name=i;this.index=r;this.operation=u;this.tree=f}return f(t,n),t}(u);n.JsonPatchError=t;n.Error=t;n.validator=ot;n.validate=st}(i||(i={}));!0&&(t.apply=i.apply,t.observe=i.observe,t.unobserve=i.unobserve,t.generate=i.generate,t.compare=i.compare,t.validate=i.validate,t.validator=i.validator,t.JsonPatchError=i.JsonPatchError,t.Error=i.Error)},function(n,t,i){"use strict";function s(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function u(n){return n.value===""||n.value===null||n.value===void 0}var r;t.__esModule=!0;t.CONDITION_NAME=undefined;t.condition=u;var f=i(3),e=s(f),o=i(10);r=t.CONDITION_NAME="empty";o.registerCondition(r,u,{name:e.FILTERS_CONDITIONS_EMPTY,inputsCount:0,showOperators:!0})},function(n,t,i){"use strict";function c(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function e(n){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:inputValues,i=r(t,1),f=i[0];return u.stringify(n.value).toLowerCase()===u.stringify(f)}var r,f;t.__esModule=!0;t.CONDITION_NAME=undefined;r=function(){function n(n,t){var r=[],u=!0,f=!1,e=undefined,i,o;try{for(i=n[Symbol.iterator]();!(u=(o=i.next()).done);u=!0)if(r.push(o.value),t&&r.length===t)break}catch(s){f=!0;e=s}finally{try{!u&&i["return"]&&i["return"]()}finally{if(f)throw e;}}return r}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return n(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance");}}();t.condition=e;var o=i(3),s=c(o),u=i(13),h=i(10);f=t.CONDITION_NAME="eq";h.registerCondition(f,e,{name:s.FILTERS_CONDITIONS_EQUAL,inputsCount:1,showOperators:!0})},function(n,t,i){"use strict";function l(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function e(n){var a=arguments.length>1&&arguments[1]!==undefined?arguments[1]:inputValues,o=u(a,2),t=o[0],i=o[1],f,e,s,l;if(n.meta.type==="numeric")f=parseFloat(t,10),e=parseFloat(i,10),t=Math.min(f,e),i=Math.max(f,e);else if(n.meta.type==="date")return s=r.getCondition(c.CONDITION_NAME,[i]),l=r.getCondition(h.CONDITION_NAME,[t]),s(n)&&l(n);return n.value>=t&&n.value<=i}var u,f;t.__esModule=!0;t.CONDITION_NAME=undefined;u=function(){function n(n,t){var r=[],u=!0,f=!1,e=undefined,i,o;try{for(i=n[Symbol.iterator]();!(u=(o=i.next()).done);u=!0)if(r.push(o.value),t&&r.length===t)break}catch(s){f=!0;e=s}finally{try{!u&&i["return"]&&i["return"]()}finally{if(f)throw e;}}return r}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return n(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance");}}();t.condition=e;var o=i(3),s=l(o),r=i(10),h=i(222),c=i(223);f=t.CONDITION_NAME="between";r.registerCondition(f,e,{name:s.FILTERS_CONDITIONS_BETWEEN,inputsCount:2,showOperators:!0})},function(n,t,i){"use strict";function l(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function a(n){return n&&n.__esModule?n:{"default":n}}function e(n){var f=arguments.length>1&&arguments[1]!==undefined?arguments[1]:inputValues,e=r(f,1),o=e[0],t=u.default(n.value,n.meta.dateFormat),i=u.default(o,n.meta.dateFormat);return!t.isValid()||!i.isValid()?!1:t.diff(i)>=0}var r,f;t.__esModule=!0;t.CONDITION_NAME=undefined;r=function(){function n(n,t){var r=[],u=!0,f=!1,e=undefined,i,o;try{for(i=n[Symbol.iterator]();!(u=(o=i.next()).done);u=!0)if(r.push(o.value),t&&r.length===t)break}catch(s){f=!0;e=s}finally{try{!u&&i["return"]&&i["return"]()}finally{if(f)throw e;}}return r}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return n(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance");}}();t.condition=e;var o=i(31),u=a(o),s=i(3),h=l(s),c=i(10);f=t.CONDITION_NAME="date_after";c.registerCondition(f,e,{name:h.FILTERS_CONDITIONS_AFTER,inputsCount:1,showOperators:!0})},function(n,t,i){"use strict";function l(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function a(n){return n&&n.__esModule?n:{"default":n}}function e(n){var f=arguments.length>1&&arguments[1]!==undefined?arguments[1]:inputValues,e=r(f,1),o=e[0],t=u.default(n.value,n.meta.dateFormat),i=u.default(o,n.meta.dateFormat);return!t.isValid()||!i.isValid()?!1:t.diff(i)<=0}var r,f;t.__esModule=!0;t.CONDITION_NAME=undefined;r=function(){function n(n,t){var r=[],u=!0,f=!1,e=undefined,i,o;try{for(i=n[Symbol.iterator]();!(u=(o=i.next()).done);u=!0)if(r.push(o.value),t&&r.length===t)break}catch(s){f=!0;e=s}finally{try{!u&&i["return"]&&i["return"]()}finally{if(f)throw e;}}return r}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return n(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance");}}();t.condition=e;var o=i(31),u=a(o),s=i(3),h=l(s),c=i(10);f=t.CONDITION_NAME="date_before";c.registerCondition(f,e,{name:h.FILTERS_CONDITIONS_BEFORE,inputsCount:1,showOperators:!0})},function(n,t,i){"use strict";function c(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function e(n){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:inputValues,i=r(t,1),f=i[0];return u.stringify(n.value).toLowerCase().indexOf(u.stringify(f))>=0}var r,f;t.__esModule=!0;t.CONDITION_NAME=undefined;r=function(){function n(n,t){var r=[],u=!0,f=!1,e=undefined,i,o;try{for(i=n[Symbol.iterator]();!(u=(o=i.next()).done);u=!0)if(r.push(o.value),t&&r.length===t)break}catch(s){f=!0;e=s}finally{try{!u&&i["return"]&&i["return"]()}finally{if(f)throw e;}}return r}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return n(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance");}}();t.condition=e;var o=i(3),s=c(o),u=i(13),h=i(10);f=t.CONDITION_NAME="contains";h.registerCondition(f,e,{name:s.FILTERS_CONDITIONS_CONTAINS,inputsCount:1,showOperators:!0})},function(n,t,i){"use strict";function h(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function f(n,t){return n.some(function(n){return n.func(t)})}var r,u;t.__esModule=!0;t.SHORT_NAME_FOR_COMPONENT=t.OPERATION_ID=undefined;t.operationResult=f;var e=i(3),o=h(e),s=i(64);r=t.OPERATION_ID="disjunction";u=t.SHORT_NAME_FOR_COMPONENT=o.FILTERS_LABELS_DISJUNCTION;s.registerOperation(r,u,f)},function(n,t,i){"use strict";function h(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function f(n,t){if(n.length<3)throw Error("Operation doesn't work on less then three conditions.");return n.slice(0,n.length-1).some(function(n){return n.func(t)})&&n[n.length-1].func(t)}var r,u;t.__esModule=!0;t.SHORT_NAME_FOR_COMPONENT=t.OPERATION_ID=undefined;t.operationResult=f;var e=i(3),o=h(e),s=i(64);r=t.OPERATION_ID="disjunctionAndVariable";u=t.SHORT_NAME_FOR_COMPONENT=o.FILTERS_LABELS_DISJUNCTION;s.registerOperation(r,u,f)},function(n,t,i){"use strict";function y(n){return n&&n.__esModule?n:{"default":n}}function p(n,t){return Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(t)}}))}function w(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var f;t.__esModule=!0;var s=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),h=p(["The column of index "," has been already applied with a `","` \n        filter operation. Use `removeConditions` to clear the current conditions and then add new ones. \n        Mind that you cannot mix different types of operations (for instance, if you use `conjunction`, \n        use it consequently for a particular column)."],["The column of index "," has been already applied with a \\`","\\` \n        filter operation. Use \\`removeConditions\\` to clear the current conditions and then add new ones. \n        Mind that you cannot mix different types of operations (for instance, if you use \\`conjunction\\`, \n        use it consequently for a particular column)."]),r=i(0),u=i(1),c=i(34),l=i(21),a=y(l),v=i(10),e=i(160),o=i(64);f=function(){function n(){w(this,n);this.conditions=this.initConditionsCollection();this.columnTypes={};this.orderStack=[]}return s(n,[{key:"isEmpty",value:function(){return!this.orderStack.length}},{key:"isMatch",value:function(n,t){var r=this,i=!0,f;return t===void 0?u.objectEach(this.columnTypes,function(t,u){return i=r.isMatchInConditions(r.conditions[t][u],n,t)}):(f=this.columnTypes[t],i=this.isMatchInConditions(this.getConditions(t),n,f)),i}},{key:"isMatchInConditions",value:function(n,t){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:e.OPERATION_ID;return n.length?o.getOperationFunc(i)(n,t):!0}},{key:"addCondition",value:function(n,t){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:e.OPERATION_ID,f=r.arrayMap(t.args,function(n){return typeof n=="string"?n.toLowerCase():n}),o=t.name||t.command.key,u;if(this.runLocalHooks("beforeAdd",n),this.orderStack.indexOf(n)===-1&&this.orderStack.push(n),u=this.columnTypes[n],u){if(u!==i)throw Error(c.toSingleLine(h,n,u));}else{if(!this.conditions[i])throw new Error("Unexpected operation named `"+i+"`. Possible ones are `disjunction` and `conjunction`.");this.columnTypes[n]=i}this.getConditions(n).push({name:o,args:f,func:v.getCondition(o,f)});this.runLocalHooks("afterAdd",n)}},{key:"getConditions",value:function(n){var t=this.columnTypes[n];return t?(this.conditions[t][n]||(this.conditions[t][n]=[]),this.conditions[t][n]):[]}},{key:"exportAllConditions",value:function(){var t=this,n=[];return r.arrayEach(this.orderStack,function(i){var u=r.arrayMap(t.getConditions(i),function(){var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:condition,t=n.name,i=n.args;return{name:t,args:i}});n.push({column:i,conditions:u})}),n}},{key:"importAllConditions",value:function(n){var t=this;this.clean();r.arrayEach(n,function(n){t.orderStack.push(n.column);r.arrayEach(n.conditions,function(i){return t.addCondition(n.column,i)})})}},{key:"removeConditions",value:function(n){this.runLocalHooks("beforeRemove",n);this.orderStack.indexOf(n)>=0&&this.orderStack.splice(this.orderStack.indexOf(n),1);this.clearConditions(n);this.runLocalHooks("afterRemove",n)}},{key:"clearConditions",value:function(n){this.runLocalHooks("beforeClear",n);this.getConditions(n).length=0;delete this.columnTypes[n];this.runLocalHooks("afterClear",n)}},{key:"hasConditions",value:function(n,t){var u=this.columnTypes[n],i;return u?(i=this.getConditions(n),t?r.arrayFilter(i,function(n){return n.name===t}).length>0:i.length>0):!1}},{key:"clean",value:function(){this.runLocalHooks("beforeClean");this.columnTypes=Object.create(null);this.orderStack.length=0;this.conditions=this.initConditionsCollection();this.runLocalHooks("afterClean")}},{key:"destroy",value:function(){this.clearLocalHooks();this.conditions=null;this.orderStack=null;this.columnTypes=null}},{key:"initConditionsCollection",value:function(){var n=Object.create(null);return u.objectEach(o.operations,function(t,i){n[i]=Object.create(null)}),n}}]),n}();u.mixin(f,a.default);t.default=f},function(n,t,i){"use strict";function e(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var u,r,f;t.__esModule=!0;u=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}();r=i(0);f=function(){function n(t){var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:function(){return[]};e(this,n);this.conditionCollection=t;this.columnDataFactory=i}return u(n,[{key:"filter",value:function(){var n=this,t=[];return this.conditionCollection.isEmpty()||r.arrayEach(this.conditionCollection.orderStack,function(i,r){var u=n.columnDataFactory(i);r&&(u=n._getIntersectData(u,t));t=n.filterByColumn(i,u)}),t}},{key:"filterByColumn",value:function(n){var i=this,u=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[],t=[];return r.arrayEach(u,function(r){r!==void 0&&i.conditionCollection.isMatch(r,n)&&t.push(r)}),t}},{key:"_getIntersectData",value:function(n,t){var i=[];return r.arrayEach(t,function(t){var r=t.meta.visualRow;n[r]!==void 0&&(i[r]=n[r])}),i}}]),n}();t.default=f},function(n,t,i){"use strict";function o(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var u;t.__esModule=!0;var f=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),r=i(1),e=i(66);u=function(){function n(t,i){o(this,n);var u=r.isObject(t),f=r.isObject(i);this._row=u?t.index:t;this.rowAbsolute=u?t.isAbsolute:!0;this._column=f?i.index:i;this.columnAbsolute=f?i.isAbsolute:!0;this.rowOffset=0;this.columnOffset=0;Object.defineProperty(this,"row",{get:function(){return this.rowOffset+this._row},set:function(n){this._row=n},enumerable:!0,configurable:!0});Object.defineProperty(this,"column",{get:function(){return this.columnOffset+this._column},set:function(n){this._column=n},enumerable:!0,configurable:!0})}return f(n,[{key:"translateTo",value:function(n,t){this.row=this.row+n;this.column=this.column+t}},{key:"isEqual",value:function(n){return n.row===this.row&&n.column===this.column}},{key:"toString",value:function(){return e.toLabel({index:this.row,isAbsolute:this.rowAbsolute},{index:this.column,isAbsolute:this.columnAbsolute})}}]),n}();t.default=u},function(n,t,i){"use strict";function s(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var e;t.__esModule=!0;var o=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),r=i(0),u=i(1),f=i(231);e=function(){function n(t,i){s(this,n);this.year=t;this.firstWeekDay="monday";this.allowSplitWeeks=i===void 0?!0:i;this.weekSectionCount=0;this.monthList=this.calculateMonthData();this.daysInColumns={};this.calculateWeekStructure()}return o(n,[{key:"setYear",value:function(n){this.year=n;this.monthList=this.calculateMonthData();this.calculateWeekStructure()}},{key:"setFirstWeekDay",value:function(n){var t=n.toLowerCase();t!=="monday"&&t!=="sunday"&&console.warn("First day of the week must be set to either Monday or Sunday");this.firstWeekDay=t;this.calculateWeekStructure()}},{key:"countWeekSections",value:function(){return this.weekSectionCount}},{key:"getFirstWeekDay",value:function(){return this.firstWeekDay}},{key:"getYear",value:function(){return this.year}},{key:"getMonthList",value:function(){return this.monthList}},{key:"parseDate",value:function(n){return!(n instanceof Date)&&(n=new Date(n),n.toString()==="Invalid Date")?null:n}},{key:"dateToColumn",value:function(n){if(n=this.parseDate(n),!n||n.getFullYear()!==this.year)return!1;var t=n.getMonth(),i=n.getDate()-1;return this.getWeekColumn(i,t)}},{key:"getWeekColumn",value:function(n,t){var i=null,f=this.getMonthCacheArray(t);return r.arrayEach(f,function(t){return u.objectEach(t,function(t,r){if(t.indexOf(n+1)>-1)return i=parseInt(r,10),!1}),i?!1:void 0}),i}},{key:"getMonthCacheArray",value:function(n){var r=this,f=this.getMonthList(),t=[],i;return this.allowSplitWeeks?t.push(this.daysInColumns[n]):(i=-1,u.objectEach(this.daysInColumns,function(u,e){var o=f[e];return Object.keys(u).length>1&&i++,i===n?(o.daysBeforeFullWeeks>0&&t.push(r.daysInColumns[parseInt(e,10)-1]),t.push(u),o.daysAfterFullWeeks>0&&t.push(r.daysInColumns[parseInt(e,10)+1]),!1):void 0})),t}},{key:"columnToDate",value:function(n){var t=null;return(u.objectEach(this.daysInColumns,function(i,r){if(i[n])return t=r,!1}),this.daysInColumns[t][n].length===1)?new Date(this.year,t,this.daysInColumns[t][n][0]):this.daysInColumns[t][n]}},{key:"isOnTheEdgeOfWeek",value:function(n){var f=this;if(n=this.parseDate(n),!n)return null;var e=n.getMonth(),i=n.getDate()-1,o=this.getMonthCacheArray(e),t=!1;return r.arrayEach(o,function(r){return u.objectEach(r,function(r){if(!f.allowSplitWeeks&&r.length!==7&&(i===0||i===new Date(n.getYear(),n.getMonth()+1,0).getDate()-1))return!0;var u=r.indexOf(i+1);return u===0?(t=[1,0],!1):u===r.length-1?(t=[0,1],!1):void 0}),t?!1:void 0}),t}},{key:"addDaysToCache",value:function(n,t,i,r){var u,o,f,e;if(this.daysInColumns[n]||(this.daysInColumns[n]={}),this.daysInColumns[n][t]||(this.daysInColumns[n][t]=[]),i<=r)for(u=i;u<=r;u++)this.daysInColumns[n][t].push(u);else{for(o=n-1>=0?this.countMonthDays(n):31,f=i;f<=o;f++)this.daysInColumns[n][t].push(f);for(e=1;e<=r;e++)this.daysInColumns[n][t].push(e)}}},{key:"isValidRangeBarData",value:function(n,t){var i=this.parseDate(n),r=this.parseDate(t);return i&&r&&i.getTime()<=r.getTime()}},{key:"calculateMonthData",value:function(){return[{name:"January",days:31},{name:"February",days:new Date(this.year,2,0).getDate()},{name:"March",days:31},{name:"April",days:30},{name:"May",days:31},{name:"June",days:30},{name:"July",days:31},{name:"August",days:31},{name:"September",days:30},{name:"October",days:31},{name:"November",days:30},{name:"December",days:31}].slice(0)}},{key:"countMonths",value:function(){return this.monthList.length}},{key:"countMonthDays",value:function(n){return this.monthList[n-1].days}},{key:"countMonthFullWeeks",value:function(n){return this.monthList[n-1].fullWeeks}},{key:"calculateWeekStructure",value:function(){var t=this;this.monthList=this.calculateMonthData();var o=this.getFirstWeekDay(),n=this.getMonthList(),s=this.getYear(),i=[],e=0,u=0;o==="monday"&&(e=1);r.arrayEach(n,function(r,o){var l=new Date(s,o,1).getDay(),c=0,h=null;r.daysBeforeFullWeeks=(7-l+e)%7;!t.allowSplitWeeks&&r.daysBeforeFullWeeks&&(h=f.getMixedMonthName(o,n),i.push(f.getMixedMonthObject(h,o)),c++);r.fullWeeks=Math.floor((r.days-r.daysBeforeFullWeeks)/7);r.daysAfterFullWeeks=r.days-r.daysBeforeFullWeeks-7*r.fullWeeks;t.allowSplitWeeks?u+=r.fullWeeks+(r.daysBeforeFullWeeks?1:0)+(r.daysAfterFullWeeks?1:0):(o===n.length-1&&r.daysAfterFullWeeks&&(h=f.getMixedMonthName(o,n),i.push(f.getMixedMonthObject(h,null)),c++),u+=r.fullWeeks+c)});r.arrayEach(i,function(n,i){var r=n.index;delete n.index;t.addMixedMonth(r===null?r:i+r,n)});this.weekSectionCount=u}},{key:"addMixedMonth",value:function(n,t){n===null?this.monthList.push(t):this.monthList.splice(n,0,t)}}]),n}();t.default=e},function(n,t){"use strict";function u(n,t){return{name:n,days:r,daysBeforeFullWeeks:0,daysAfterFullWeeks:0,fullWeeks:1,index:t}}function f(n,t){var r=i(t[n].name),u=n>0?i(t[n-1].name):null,f=i(t[0].name),e=i(t[t.length-1].name);return n>0?u+"/"+r:n===t.length-1?r+"/"+f:e+"/"+r}function i(n){return n.substring(0,3)}t.__esModule=!0;t.getMixedMonthObject=u;t.getMixedMonthName=f;t.getShorthand=i;var e=t.DEC_LENGTH=31,r=t.WEEK_LENGTH=7},function(n,t,i){"use strict";function c(n){return n&&n.__esModule?n:{"default":n}}function l(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function a(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function v(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var f;t.__esModule=!0;var u=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),e=i(0),o=i(4),r=i(2),s=i(162),h=c(s);f=function(n){function t(n,i){l(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n,i));return r.dataManager=r.plugin.dataManager,r.collapsingUI=r.plugin.collapsingUI,r.rowHeaderWidthCache=null,r.trimRowsPlugin=n.trimRowsPlugin,r}return v(t,n),u(t,null,[{key:"CSS_CLASSES",get:function(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}}]),u(t,[{key:"appendLevelIndicators",value:function(n,i){var h,f;n=this.trimRowsPlugin.rowsMapper.getValueByIndex(n);var s=this.dataManager.getRowLevel(n),c=this.dataManager.getDataObject(n),u=i.getElementsByTagName("DIV")[0],l=u.querySelector("span.rowHeader"),a=u.querySelectorAll('[class^="ht_nesting"]');e.arrayEach(a,function(n){n&&u.removeChild(n)});r.addClass(i,t.CSS_CLASSES.indicatorContainer);s&&(h=l.cloneNode(!0),u.innerHTML="",o.rangeEach(0,s-1,function(){var n=document.createElement("SPAN");r.addClass(n,t.CSS_CLASSES.emptyIndicator);u.appendChild(n)}),u.appendChild(h));this.dataManager.hasChildren(c)&&(f=document.createElement("DIV"),r.addClass(i,t.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(n)?r.addClass(f,t.CSS_CLASSES.button+" "+t.CSS_CLASSES.expandButton):r.addClass(f,t.CSS_CLASSES.button+" "+t.CSS_CLASSES.collapseButton),u.appendChild(f))}},{key:"updateRowHeaderWidth",value:function(n){n||(n=this.dataManager.cache.levelCount);this.rowHeaderWidthCache=Math.max(50,11+10*n+25);this.hot.render()}}]),t}(h.default);t.default=f},function(n,t,i){"use strict";function h(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function r(n){return n&&n.__esModule?n:{"default":n}}t.__esModule=!0;i(84);i(93);i(94);i(95);i(96);i(98);i(100);i(101);i(102);i(103);i(104);i(105);i(106);i(107);i(108);i(109);i(110);i(111);i(112);i(113);i(114);i(115);i(116);i(117);i(118);i(121);i(122);i(123);i(124);i(125);i(126);i(127);i(128);i(130);i(131);i(132);i(133);i(134);i(80);i(135);i(136);i(137);i(138);i(139);i(140);i(141);i(142);i(143);i(144);i(145);i(146);i(147);i(148);i(149);var f=i(252),u=r(f),e=i(376),c=h(e),o=i(456),l=r(o),s=i(457),a=r(s);u.default.baseVersion="0.38.1";t.default=u.default},function(n,t,i){var r=i(22),u=i(20),f=i(46);n.exports=i(24)?Object.defineProperties:function(n,t){u(n);for(var i=f(t),s=i.length,e=0,o;s>e;)r.f(n,o=i[e++],t[o]);return n}},function(n,t,i){"use strict";var u=i(87),f=i(56),e=i(58),r={};i(39)(r,i(16)("iterator"),function(){return this});n.exports=function(n,t,i){n.prototype=u(r,{next:f(1,i)});e(n,t+" Iterator")}},function(n,t,i){var u=i(12),r=i(176).set;n.exports=function(n,t,i){var f=t.constructor,e;return f!==i&&typeof f=="function"&&(e=f.prototype)!==i.prototype&&u(e)&&r&&r(n,e),n}},function(n,t,i){var r=i(238);n.exports=function(n,t){return new(r(n))(t)}},function(n,t,i){var u=i(12),r=i(177),f=i(16)("species");n.exports=function(n){var t;return r(n)&&(t=n.constructor,typeof t=="function"&&(t===Array||r(t.prototype))&&(t=undefined),u(t)&&(t=t[f],t===null&&(t=undefined))),t===undefined?Array:t}},function(n,t,i){var r=i(20),u=i(71),f=i(16)("species");n.exports=function(n,t){var i=r(n).constructor,e;return i===undefined||(e=r(i)[f])==undefined?t:u(e)}},function(n){n.exports=function(n,t,i){var r=i===undefined;switch(t.length){case 0:return r?n():n.call(i);case 1:return r?n(t[0]):n.call(i,t[0]);case 2:return r?n(t[0],t[1]):n.call(i,t[0],t[1]);case 3:return r?n(t[0],t[1],t[2]):n.call(i,t[0],t[1],t[2]);case 4:return r?n(t[0],t[1],t[2],t[3]):n.call(i,t[0],t[1],t[2],t[3])}return n.apply(i,t)}},function(n,t,i){var r=i(17),s=i(97).set,e=r.MutationObserver||r.WebKitMutationObserver,u=r.process,f=r.Promise,o=i(49)(u)=="process";n.exports=function(){var n,i,t,h=function(){var r,f;for(o&&(r=u.domain)&&r.exit();n;){f=n.fn;n=n.next;try{f()}catch(e){n?t():i=undefined;throw e;}}i=undefined;r&&r.enter()},c,l,a;return o?t=function(){u.nextTick(h)}:!e||r.navigator&&r.navigator.standalone?f&&f.resolve?(a=f.resolve(),t=function(){a.then(h)}):t=function(){s.call(r,h)}:(c=!0,l=document.createTextNode(""),new e(h).observe(l,{characterData:!0}),t=function(){l.data=c=!c}),function(r){var u={fn:r,next:undefined};i&&(i.next=u);n||(n=u,t());i=u}}},function(n){n.exports=function(n){try{return{e:!1,v:n()}}catch(t){return{e:!0,v:t}}}},function(n,t,i){var r=i(20),u=i(12),f=i(180);n.exports=function(n,t){if(r(n),u(t)&&t.constructor===n)return t;var i=f.f(n),e=i.resolve;return e(t),i.promise}},function(n,t,i){var u=i(17),r=i(50),f=i(74),e=i(181),o=i(22).f;n.exports=function(n){var t=r.Symbol||(r.Symbol=f?{}:u.Symbol||{});n.charAt(0)=="_"||n in t||o(t,n,{value:e.f(n)})}},function(n,t,i){var r=i(46),u=i(78),f=i(59);n.exports=function(n){var t=r(n),i=u.f;if(i)for(var e=i(n),h=f.f,o=0,s;e.length>o;)h.call(n,s=e[o++])&&t.push(s);return t}},function(n){n.exports=Object.is||function(n,t){return n===t?n!==0||1/n==1/t:n!=n&&t!=t}},function(n,t,i){var r=i(68),u=i(47);n.exports=function(n){return function(t,i){var e=String(u(t)),f=r(i),h=e.length,o,s;return f<0||f>=h?n?"":undefined:(o=e.charCodeAt(f),o<55296||o>56319||f+1===h||(s=e.charCodeAt(f+1))<56320||s>57343?n?e.charAt(f):o:n?e.slice(f,f+2):(o-55296<<10)+(s-56320)+65536)}}},function(n,t,i){"use strict";var r=i(20);n.exports=function(){var t=r(this),n="";return t.global&&(n+="g"),t.ignoreCase&&(n+="i"),t.multiline&&(n+="m"),t.unicode&&(n+="u"),t.sticky&&(n+="y"),n}},function(n,t,i){"use strict";var u=i(41),r=i(69),f=i(27);n.exports=[].copyWithin||function(n,t){var o=u(this),s=f(o.length),i=r(n,s),e=r(t,s),l=arguments.length>2?arguments[2]:undefined,h=Math.min((l===undefined?s:r(l,s))-e,s-i),c=1;for(e<i&&i<e+h&&(c=-1,e+=h-1,i+=h-1);h-->0;)e in o?o[i]=o[e]:delete o[i],i+=c,e+=c;return o}},function(n,t,i){"use strict";var u=i(41),r=i(69),f=i(27);n.exports=function(n){for(var t=u(this),i=f(t.length),e=arguments.length,o=r(e>1?arguments[1]:undefined,i),s=e>2?arguments[2]:undefined,h=s===undefined?i:r(s,i);h>o;)t[o++]=n;return t}},function(n,t,i){var u=i(99),f=i(78),e=i(20),r=i(17).Reflect;n.exports=r&&r.ownKeys||function(n){var t=u.f(e(n)),i=f.f;return i?t.concat(i(n)):t}},function(n,t,i){"use strict";function u(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function e(n){return n&&n.__esModule?n:{"default":n}}function r(n,t){var i=new y.default(n,t||{},pi.rootInstanceSymbol);return i.init(),i}var v,b,k;t.__esModule=!0;i(84);i(93);i(94);i(95);i(96);i(98);i(100);i(101);i(102);i(103);i(104);i(105);i(106);i(107);i(108);i(109);i(110);i(111);i(112);i(113);i(114);i(115);i(116);i(117);i(118);i(121);i(122);i(123);i(124);i(125);i(126);i(127);i(128);i(130);i(131);i(132);i(133);i(134);i(80);i(135);i(136);i(137);i(138);i(139);i(140);i(141);i(142);i(143);i(144);i(145);i(146);i(147);i(148);i(149);i(253);i(254);i(255);var o=i(19),s=i(15),h=i(36),c=i(151),d=i(152),y=e(d),g=i(309),nt=e(g),p=i(9),tt=e(p),it=i(14),rt=e(it),ut=i(155),ft=e(ut),et=i(0),f=u(et),ot=i(33),st=u(ot),ht=i(81),ct=u(ht),lt=i(204),at=u(lt),vt=i(43),yt=u(vt),pt=i(35),wt=u(pt),bt=i(13),kt=u(bt),dt=i(4),gt=u(dt),ni=i(1),ti=u(ni),ii=i(153),ri=u(ii),ui=i(30),l=u(ui),fi=i(18),ei=u(fi),oi=i(2),si=u(oi),hi=i(11),ci=u(hi),li=i(310),w=u(li),ai=i(6),vi=i(207),yi=e(vi),pi=i(206),wi=i(208),bi=i(3),ki=u(bi),a=i(82);nt.default(r);r.Core=y.default;r.DefaultSettings=yi.default;r.EventManager=tt.default;r._getListenersCounter=p.getListenersCounter;r.buildDate="20/03/2018 10:43:43";r.packageName="handsontable-pro";r.version="1.18.1";v="0.38.1";v&&(r.baseVersion=v);r.hooks=rt.default.getSingleton();r.__GhostTable=ft.default;b=[f,st,ct,at,yt,wt,kt,gt,ti,ri,l,ei];k=[si,ci];r.helper={};r.dom={};f.arrayEach(b,function(n){f.arrayEach(Object.getOwnPropertyNames(n),function(t){t.charAt(0)!=="_"&&(r.helper[t]=n[t])})});f.arrayEach(k,function(n){f.arrayEach(Object.getOwnPropertyNames(n),function(t){t.charAt(0)!=="_"&&(r.dom[t]=n[t])})});r.cellTypes={};f.arrayEach(c.getRegisteredCellTypeNames(),function(n){r.cellTypes[n]=c.getCellType(n)});r.cellTypes.registerCellType=c.registerCellType;r.cellTypes.getCellType=c.getCellType;r.editors={};f.arrayEach(o.getRegisteredEditorNames(),function(n){r.editors[l.toUpperCaseFirst(n)+"Editor"]=o.getEditor(n)});r.editors.registerEditor=o.registerEditor;r.editors.getEditor=o.getEditor;r.renderers={};f.arrayEach(s.getRegisteredRendererNames(),function(n){var t=s.getRenderer(n);n==="base"&&(r.renderers.cellDecorator=t);r.renderers[l.toUpperCaseFirst(n)+"Renderer"]=t});r.renderers.registerRenderer=s.registerRenderer;r.renderers.getRenderer=s.getRenderer;r.validators={};f.arrayEach(h.getRegisteredValidatorNames(),function(n){r.validators[l.toUpperCaseFirst(n)+"Validator"]=h.getValidator(n)});r.validators.registerValidator=h.registerValidator;r.validators.getValidator=h.getValidator;r.plugins={};f.arrayEach(Object.getOwnPropertyNames(w),function(n){var t=w[n];n==="Base"?r.plugins[n+"Plugin"]=t:r.plugins[n]=t});r.plugins.registerPlugin=ai.registerPlugin;r.languages={};r.languages.dictionaryKeys=ki;r.languages.getLanguageDictionary=a.getLanguageDictionary;r.languages.getLanguagesDictionaries=a.getLanguagesDictionaries;r.languages.registerLanguageDictionary=a.registerLanguageDictionary;r.languages.getTranslatedPhrase=function(){return wi.getTranslatedPhrase.apply(undefined,arguments)};t.default=r},function(){},function(){},function(){},function(n,t,i){"use strict";function o(n){return n&&n.__esModule?n:{"default":n}}function s(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function h(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function c(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var u;t.__esModule=!0;var f=i(2),e=i(29),r=o(e);u=function(n){function t(n){s(this,t);var i=h(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return i.clone=i.makeClone(r.default.CLONE_DEBUG),i.clone.wtTable.holder.style.opacity=.4,i.clone.wtTable.holder.style.textShadow="0 0 2px #ff0000",f.addClass(i.clone.wtTable.holder.parentNode,"wtDebugVisible"),i}return c(t,n),t}(r.default);r.default.registerOverlay(r.default.CLONE_DEBUG,u);t.default=u},function(n,t,i){"use strict";function s(n){return n&&n.__esModule?n:{"default":n}}function h(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function c(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function l(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var f;t.__esModule=!0;var e=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),r=i(2),o=i(29),u=s(o);f=function(n){function t(n){h(this,t);var i=c(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return i.clone=i.makeClone(u.default.CLONE_LEFT),i}return l(t,n),e(t,[{key:"shouldBeRendered",value:function(){return!!(this.wot.getSetting("fixedColumnsLeft")||this.wot.getSetting("rowHeaders").length)}},{key:"resetFixedPosition",value:function(){if(this.needFullRender&&this.wot.wtTable.holder.parentNode){var i=this.clone.wtTable.holder.parentNode,u=0,f=this.wot.getSetting("preventOverflow");if(this.trimmingContainer!==window||f&&f==="horizontal")u=this.getScrollPosition(),r.resetCssTransform(i);else{var e=this.wot.wtTable.hider.getBoundingClientRect(),o=Math.ceil(e.left),s=Math.ceil(e.right),t=void 0,n=void 0;n=this.wot.wtTable.hider.style.top;n=n===""?0:n;t=o<0&&s-i.offsetWidth>0?-o:0;u=t;t+="px";r.setOverlayPosition(i,t,n)}this.adjustHeaderBordersPosition(u);this.adjustElementsSize()}}},{key:"setScrollPosition",value:function(n){this.mainTableScrollableElement===window?window.scrollTo(n,r.getWindowScrollTop()):this.mainTableScrollableElement.scrollLeft=n}},{key:"onScroll",value:function(){this.wot.getSetting("onScrollVertically")}},{key:"sumCellSizes",value:function(n,t){for(var i=0,r=this.wot.wtSettings.defaultColumnWidth;n<t;)i+=this.wot.wtTable.getStretchedColumnWidth(n)||r,n++;return i}},{key:"adjustElementsSize",value:function(){var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:!1;this.updateTrimmingContainer();(this.needFullRender||n)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize(),n||(this.areElementSizesAdjusted=!0))}},{key:"adjustRootElementSize",value:function(){var u=this.wot.wtTable.holder,f=u.clientHeight===u.offsetHeight?0:r.getScrollbarWidth(),e=this.clone.wtTable.holder.parentNode,n=e.style,o=this.wot.getSetting("preventOverflow"),t=void 0,i;this.trimmingContainer!==window||o==="vertical"?(i=this.wot.wtViewport.getWorkspaceHeight()-f,i=Math.min(i,r.innerHeight(this.wot.wtTable.wtRootElement)),n.height=i+"px"):n.height="";this.clone.wtTable.holder.style.height=n.height;t=r.outerWidth(this.clone.wtTable.TABLE);n.width=(t===0?t:t+4)+"px"}},{key:"adjustRootChildrenSize",value:function(){var n=r.getScrollbarWidth();this.clone.wtTable.hider.style.height=this.hider.style.height;this.clone.wtTable.holder.style.height=this.clone.wtTable.holder.parentNode.style.height;n===0&&(n=30);this.clone.wtTable.holder.style.width=parseInt(this.clone.wtTable.holder.parentNode.style.width,10)+n+"px"}},{key:"applyToDOM",value:function(){var n=this.wot.getSetting("totalColumns");if(this.areElementSizesAdjusted||this.adjustElementsSize(),typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style.left=this.wot.wtViewport.columnsRenderCalculator.startPosition+"px";else if(n===0)this.spreader.style.left="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.spreader.style.right="";this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){this.clone.wtTable.spreader.style.top=typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.wot.wtViewport.rowsRenderCalculator.startPosition+"px":""}},{key:"scrollTo",value:function(n,t){var i=this.getTableParentOffset(),e=this.wot.cloneSource?this.wot.cloneSource:this.wot,u=e.wtTable.holder,f=0;t&&u.offsetWidth!==u.clientWidth&&(f=r.getScrollbarWidth());t?(i+=this.sumCellSizes(0,n+1),i-=this.wot.wtViewport.getViewportWidth()):i+=this.sumCellSizes(this.wot.getSetting("fixedColumnsLeft"),n);i+=f;this.setScrollPosition(i)}},{key:"getTableParentOffset",value:function(){var t=this.wot.getSetting("preventOverflow"),n=0;return t||this.trimmingContainer!==window||(n=this.wot.wtTable.holderOffset.left),n}},{key:"getScrollPosition",value:function(){return r.getScrollLeft(this.mainTableScrollableElement)}},{key:"adjustHeaderBordersPosition",value:function(n){var t=this.wot.wtTable.holder.parentNode,u=this.wot.getSetting("rowHeaders"),f=this.wot.getSetting("fixedColumnsLeft"),e=this.wot.getSetting("totalRows"),i;e?r.removeClass(t,"emptyRows"):r.addClass(t,"emptyRows");f&&!u.length?r.addClass(t,"innerBorderLeft"):!f&&u.length&&(i=r.hasClass(t,"innerBorderLeft"),n?r.addClass(t,"innerBorderLeft"):r.removeClass(t,"innerBorderLeft"),(!i&&n||i&&!n)&&this.wot.wtOverlays.adjustElementsSize())}}]),t}(u.default);u.default.registerOverlay(u.default.CLONE_LEFT,f);t.default=f},function(n,t,i){"use strict";function h(n){return n&&n.__esModule?n:{"default":n}}function c(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function l(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function a(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var f;t.__esModule=!0;var e=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),r=i(2),o=i(0),s=i(29),u=h(s);f=function(n){function t(n){c(this,t);var i=l(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return i.clone=i.makeClone(u.default.CLONE_TOP),i}return a(t,n),e(t,[{key:"shouldBeRendered",value:function(){return!!(this.wot.getSetting("fixedRowsTop")||this.wot.getSetting("columnHeaders").length)}},{key:"resetFixedPosition",value:function(){if(this.needFullRender&&this.wot.wtTable.holder.parentNode){var i=this.clone.wtTable.holder.parentNode,u=0,f=this.wot.getSetting("preventOverflow");if(this.trimmingContainer!==window||f&&f==="vertical")u=this.getScrollPosition(),r.resetCssTransform(i);else{var e=this.wot.wtTable.hider.getBoundingClientRect(),o=Math.ceil(e.top),s=Math.ceil(e.bottom),n=void 0,t=void 0;n=this.wot.wtTable.hider.style.left;n=n===""?0:n;t=o<0&&s-i.offsetHeight>0?-o:0;u=t;t+="px";r.setOverlayPosition(i,n,t)}this.adjustHeaderBordersPosition(u);this.adjustElementsSize()}}},{key:"setScrollPosition",value:function(n){this.mainTableScrollableElement===window?window.scrollTo(r.getWindowScrollLeft(),n):this.mainTableScrollableElement.scrollTop=n}},{key:"onScroll",value:function(){this.wot.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function(n,t){for(var r=0,u=this.wot.wtSettings.settings.defaultRowHeight,i;n<t;)i=this.wot.wtTable.getRowHeight(n),r+=i===void 0?u:i,n++;return r}},{key:"adjustElementsSize",value:function(){var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:!1;this.updateTrimmingContainer();(this.needFullRender||n)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize(),n||(this.areElementSizesAdjusted=!0))}},{key:"adjustRootElementSize",value:function(){var u=this.wot.wtTable.holder,f=u.clientWidth===u.offsetWidth?0:r.getScrollbarWidth(),e=this.clone.wtTable.holder.parentNode,n=e.style,o=this.wot.getSetting("preventOverflow"),t=void 0,i;this.trimmingContainer!==window||o==="horizontal"?(i=this.wot.wtViewport.getWorkspaceWidth()-f,i=Math.min(i,r.innerWidth(this.wot.wtTable.wtRootElement)),n.width=i+"px"):n.width="";this.clone.wtTable.holder.style.width=n.width;t=r.outerHeight(this.clone.wtTable.TABLE);n.height=(t===0?t:t+4)+"px"}},{key:"adjustRootChildrenSize",value:function(){var n=r.getScrollbarWidth();this.clone.wtTable.hider.style.width=this.hider.style.width;this.clone.wtTable.holder.style.width=this.clone.wtTable.holder.parentNode.style.width;n===0&&(n=30);this.clone.wtTable.holder.style.height=parseInt(this.clone.wtTable.holder.parentNode.style.height,10)+n+"px"}},{key:"applyToDOM",value:function(){var n=this.wot.getSetting("totalRows");if(this.areElementSizesAdjusted||this.adjustElementsSize(),typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=this.wot.wtViewport.rowsRenderCalculator.startPosition+"px";else if(n===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="";this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){this.clone.wtTable.spreader.style.left=typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?this.wot.wtViewport.columnsRenderCalculator.startPosition+"px":""}},{key:"scrollTo",value:function(n,t){var i=this.getTableParentOffset(),o=this.wot.cloneSource?this.wot.cloneSource:this.wot,u=o.wtTable.holder,f=0;if(t&&u.offsetHeight!==u.clientHeight&&(f=r.getScrollbarWidth()),t){var s=this.wot.getSetting("fixedRowsBottom"),h=this.wot.getSetting("fixedRowsTop"),e=this.wot.getSetting("totalRows");i+=this.sumCellSizes(0,n+1);i-=this.wot.wtViewport.getViewportHeight()-this.sumCellSizes(e-s,e);i+=1}else i+=this.sumCellSizes(this.wot.getSetting("fixedRowsTop"),n);i+=f;this.setScrollPosition(i)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===window?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return r.getScrollTop(this.mainTableScrollableElement)}},{key:"redrawSelectionBorders",value:function(n){if(n&&n.cellRange){var t=n.getBorder(this.wot),i=n.getCorners();t.disappear();t.appear(i)}}},{key:"redrawAllSelectionsBorders",value:function(){var t=this,n=this.wot.selections;this.redrawSelectionBorders(n.getCell());o.arrayEach(n.getAreas(),function(n){t.redrawSelectionBorders(n)});this.redrawSelectionBorders(n.getFill());this.wot.wtTable.wot.wtOverlays.leftOverlay.refresh()}},{key:"adjustHeaderBordersPosition",value:function(n){var t=this.wot.wtTable.holder.parentNode,e=this.wot.getSetting("totalColumns"),f,i,u;if(e?r.removeClass(t,"emptyColumns"):r.addClass(t,"emptyColumns"),this.wot.getSetting("fixedRowsTop")===0&&this.wot.getSetting("columnHeaders").length>0&&(f=r.hasClass(t,"innerBorderTop"),n||this.wot.getSetting("totalRows")===0?r.addClass(t,"innerBorderTop"):r.removeClass(t,"innerBorderTop"),(!f&&n||f&&!n)&&(this.wot.wtOverlays.adjustElementsSize(),this.redrawAllSelectionsBorders())),this.wot.getSetting("rowHeaders").length===0&&(i=this.clone.wtTable.THEAD.querySelectorAll("th:nth-of-type(2)"),i))for(u=0;u<i.length;u++)i[u].style["border-left-width"]=0}}]),t}(u.default);u.default.registerOverlay(u.default.CLONE_TOP,f);t.default=f},function(n,t,i){"use strict";function s(n){return n&&n.__esModule?n:{"default":n}}function h(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function c(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function l(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var f;t.__esModule=!0;var e=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),r=i(2),o=i(29),u=s(o);f=function(n){function t(n){h(this,t);var i=c(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return i.clone=i.makeClone(u.default.CLONE_TOP_LEFT_CORNER),i}return l(t,n),e(t,[{key:"shouldBeRendered",value:function(){return!!((this.wot.getSetting("fixedRowsTop")||this.wot.getSetting("columnHeaders").length)&&(this.wot.getSetting("fixedColumnsLeft")||this.wot.getSetting("rowHeaders").length))}},{key:"resetFixedPosition",value:function(){if(this.updateTrimmingContainer(),this.wot.wtTable.holder.parentNode){var n=this.clone.wtTable.holder.parentNode,u=r.outerHeight(this.clone.wtTable.TABLE),f=r.outerWidth(this.clone.wtTable.TABLE),t=this.wot.getSetting("preventOverflow");if(this.trimmingContainer===window){var i=this.wot.wtTable.hider.getBoundingClientRect(),e=Math.ceil(i.top),o=Math.ceil(i.left),c=Math.ceil(i.bottom),l=Math.ceil(i.right),s="0",h="0";t&&t!=="vertical"||o<0&&l-n.offsetWidth>0&&(s=-o+"px");t&&t!=="horizontal"||e<0&&c-n.offsetHeight>0&&(h=-e+"px");r.setOverlayPosition(n,s,h)}else r.resetCssTransform(n);n.style.height=(u===0?u:u+4)+"px";n.style.width=(f===0?f:f+4)+"px"}}}]),t}(u.default);u.default.registerOverlay(u.default.CLONE_TOP_LEFT_CORNER,f);t.default=f},function(n,t,i){"use strict";function u(n){return n&&n.__esModule?n:{"default":n}}function y(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var f;t.__esModule=!0;var e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},o=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),r=i(2),s=i(201),h=u(s),c=i(61),l=u(c),a=i(150),v=u(a);f=function(){function n(t,i){y(this,n);this.settings=t;this.cellRange=i||null;this.instanceBorders={};this.classNames=[this.settings.className];this.classNameGenerator=this.linearClassNameGenerator(this.settings.className,this.settings.layerLevel)}return o(n,[{key:"getBorder",value:function(n){return this.instanceBorders[n.guid]||(this.instanceBorders[n.guid]=new h.default(n,this.settings)),this.instanceBorders[n.guid]}},{key:"isEmpty",value:function(){return this.cellRange===null}},{key:"add",value:function(n){return this.isEmpty()?this.cellRange=new v.default(n,n,n):this.cellRange.expand(n),this}},{key:"replace",value:function(n,t){if(!this.isEmpty()){if(this.cellRange.from.isEqual(n))return this.cellRange.from=t,!0;if(this.cellRange.to.isEqual(n))return this.cellRange.to=t,!0}return!1}},{key:"clear",value:function(){return this.cellRange=null,this}},{key:"getCorners",value:function(){var n=this.cellRange.getTopLeftCorner(),t=this.cellRange.getBottomRightCorner();return[n.row,n.col,t.row,t.col]}},{key:"addClassAtCoords",value:function(n,t,i,u){var o=arguments.length>4&&arguments[4]!==undefined?arguments[4]:!1,f=n.wtTable.getCell(new l.default(t,i));return(typeof f=="undefined"?"undefined":e(f))==="object"&&(o&&(u=this.classNameGenerator(f),this.classNames.includes(u)||this.classNames.push(u)),r.addClass(f,u)),this}},{key:"linearClassNameGenerator",value:function(n,t){return function i(u){var o=arguments.length>1&&arguments[1]!==undefined?arguments[1]:-1,f,e,s,h;return t===0||o===0?n:(f=o>=0?o:t,e=n,f-=1,s=f===0?n:n+"-"+f,r.hasClass(u,s)?(h=f+1,e=n+"-"+h):e=i(u,f),e)}}},{key:"draw",value:function(n){var e,o,s,h,c;if(this.isEmpty()){this.settings.border&&this.getBorder(n).disappear();return}var a=n.wtTable.getRenderedRowsCount(),l=n.wtTable.getRenderedColumnsCount(),t=this.getCorners(),u=void 0,i=void 0,f=void 0;for(e=0;e<l;e++)i=n.wtTable.columnFilter.renderedToSource(e),i>=t[1]&&i<=t[3]&&(f=n.wtTable.getColumnHeader(i),f&&(o=[],this.settings.highlightHeaderClassName&&o.push(this.settings.highlightHeaderClassName),this.settings.highlightColumnClassName&&o.push(this.settings.highlightColumnClassName),r.addClass(f,o)));for(s=0;s<a;s++)for(u=n.wtTable.rowFilter.renderedToSource(s),u>=t[0]&&u<=t[2]&&(f=n.wtTable.getRowHeader(u),f&&(h=[],this.settings.highlightHeaderClassName&&h.push(this.settings.highlightHeaderClassName),this.settings.highlightRowClassName&&h.push(this.settings.highlightRowClassName),r.addClass(f,h))),c=0;c<l;c++)i=n.wtTable.columnFilter.renderedToSource(c),u>=t[0]&&u<=t[2]&&i>=t[1]&&i<=t[3]?this.settings.className&&this.addClassAtCoords(n,u,i,this.settings.className,this.settings.markIntersections):u>=t[0]&&u<=t[2]?this.settings.highlightRowClassName&&this.addClassAtCoords(n,u,i,this.settings.highlightRowClassName):i>=t[1]&&i<=t[3]&&this.settings.highlightColumnClassName&&this.addClassAtCoords(n,u,i,this.settings.highlightColumnClassName);n.getSetting("onBeforeDrawBorders",t,this.settings.className);this.settings.border&&this.getBorder(n).appear(t)}}]),n}();t.default=f},function(n){"use strict";function t(){function h(n){return n.currentStyle||document.defaultView.getComputedStyle(n)}var t={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},n,s=document.body,o=document.createTextNode(""),i=document.createElement("SPAN"),f=function(n,t,i){n.attachEvent?n.attachEvent("on"+t,i):n.addEventListener(t,i,!1)},e=function(n,t,i){n.removeEventListener?n.removeEventListener(t,i,!1):n.detachEvent("on"+t,i)},u=function(r){var u,f;r?/^[a-zA-Z \.,\\\/\|0-9]$/.test(r)||(r="."):r="";o.textContent!==void 0?o.textContent=n.value+r:o.data=n.value+r;i.style.fontSize=h(n).fontSize;i.style.fontFamily=h(n).fontFamily;i.style.whiteSpace="pre";s.appendChild(i);u=i.clientWidth+2;s.removeChild(i);n.style.height=t.minHeight+"px";n.style.width=t.minWidth>u?t.minWidth+"px":u>t.maxWidth?t.maxWidth+"px":u+"px";f=n.scrollHeight?n.scrollHeight-1:0;t.minHeight>f?n.style.height=t.minHeight+"px":t.maxHeight<f?(n.style.height=t.maxHeight+"px",n.style.overflowY="visible"):n.style.height=f+"px"},r=function(){window.setTimeout(u,0)},c=function(r){var u,f,e,s;r&&r.minHeight&&(r.minHeight=="inherit"?t.minHeight=n.clientHeight:(u=parseInt(r.minHeight),isNaN(u)||(t.minHeight=u)));r&&r.maxHeight&&(r.maxHeight=="inherit"?t.maxHeight=n.clientHeight:(f=parseInt(r.maxHeight),isNaN(f)||(t.maxHeight=f)));r&&r.minWidth&&(r.minWidth=="inherit"?t.minWidth=n.clientWidth:(e=parseInt(r.minWidth),isNaN(e)||(t.minWidth=e)));r&&r.maxWidth&&(r.maxWidth=="inherit"?t.maxWidth=n.clientWidth:(s=parseInt(r.maxWidth),isNaN(s)||(t.maxWidth=s)));i.firstChild||(i.className="autoResize",i.style.display="inline-block",i.appendChild(o))},l=function(i,e,o){n=i;c(e);n.nodeName=="TEXTAREA"&&(n.style.resize="none",n.style.overflowY="",n.style.height=t.minHeight+"px",n.style.minWidth=t.minWidth+"px",n.style.maxWidth=t.maxWidth+"px",n.style.overflowY="hidden");o&&(f(n,"change",u),f(n,"cut",r),f(n,"paste",r),f(n,"drop",r),f(n,"keydown",r),f(n,"focus",u));u()};return{init:function(n,t,i){l(n,t,i)},unObserve:function(){e(n,"change",u);e(n,"cut",r);e(n,"paste",r);e(n,"drop",r);e(n,"keydown",r);e(n,"focus",u)},resize:u}}!0&&(n.exports=t)},function(n,t,i){"use strict";function s(n){return n&&n.__esModule?n:{"default":n}}function h(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function c(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function l(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var r;t.__esModule=!0;var u=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),f=i(60),e=s(f),o=i(2);r=function(n){function t(){return h(this,t),c(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return l(t,n),u(t,[{key:"beginEditing",value:function(n,t){if(t.type==="mouseup"){var i=this.TD.querySelector('input[type="checkbox"]');o.hasClass(i,"htBadValue")||i.click()}}},{key:"finishEditing",value:function(){}},{key:"init",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"focus",value:function(){}}]),t}(e.default);t.default=r},function(n,t,i){"use strict";function f(n){return n&&n.__esModule?n:{"default":n}}function g(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function nt(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function tt(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var s;t.__esModule=!0;var h=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),r=function c(n,t,i){var r,u,f;return n===null&&(n=Function.prototype),r=Object.getOwnPropertyDescriptor(n,t),r===undefined?(u=Object.getPrototypeOf(n),u===null?undefined:c(u,t,i)):"value"in r?r.value:(f=r.get,f===undefined)?undefined:f.call(i)},l=i(31),u=f(l),a=i(264),e=f(a);i(265);var o=i(2),v=i(1),y=i(9),p=f(y),w=i(18),b=i(11),k=i(62),d=f(k);s=function(n){function t(n){g(this,t);var i=nt(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return i.defaultDateFormat="DD/MM/YYYY",i.isCellEdited=!1,i.parentDestroyed=!1,i}return tt(t,n),h(t,[{key:"init",value:function(){var n=this;if(typeof u.default!="function")throw new Error("You need to include moment.js to your project.");if(typeof e.default!="function")throw new Error("You need to include Pikaday to your project.");r(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"init",this).call(this);this.instance.addHook("afterDestroy",function(){n.parentDestroyed=!0;n.destroyElements()})}},{key:"createElements",value:function(){r(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"createElements",this).call(this);this.datePicker=document.createElement("DIV");this.datePickerStyle=this.datePicker.style;this.datePickerStyle.position="absolute";this.datePickerStyle.top=0;this.datePickerStyle.left=0;this.datePickerStyle.zIndex=9999;o.addClass(this.datePicker,"htDatepickerHolder");document.body.appendChild(this.datePicker);this.$datePicker=new e.default(this.getDatePickerConfig());var n=new p.default(this);n.addEventListener(this.datePicker,"mousedown",function(n){return b.stopPropagation(n)});this.hideDatepicker()}},{key:"destroyElements",value:function(){this.$datePicker.destroy()}},{key:"prepare",value:function(n,i,u,f,e,o){this._opened=!1;r(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"prepare",this).call(this,n,i,u,f,e,o)}},{key:"open",value:function(){var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;r(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"open",this).call(this);this.showDatepicker(n)}},{key:"close",value:function(){var n=this;this._opened=!1;this.instance._registerTimeout(setTimeout(function(){n.instance._refreshBorders()},0));r(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"close",this).call(this)}},{key:"finishEditing",value:function(){var i=arguments.length>0&&arguments[0]!==undefined?arguments[0]:!1,u=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!1,n;i&&(n=this.originalValue,n!==void 0&&this.setValue(n));this.hideDatepicker();r(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"finishEditing",this).call(this,i,u)}},{key:"showDatepicker",value:function(n){this.$datePicker.config(this.getDatePickerConfig());var r=this.TD.getBoundingClientRect(),i=this.cellProperties.dateFormat||this.defaultDateFormat,f=this.$datePicker.config(),t=void 0,e=this.instance.view.isMouseDown(),s=n?w.isMetaKey(n.keyCode):!1;this.datePickerStyle.top=window.pageYOffset+r.top+o.outerHeight(this.TD)+"px";this.datePickerStyle.left=window.pageXOffset+r.left+"px";this.$datePicker._onInputFocus=function(){};f.format=i;this.originalValue?(t=this.originalValue,u.default(t,i,!0).isValid()&&this.$datePicker.setMoment(u.default(t,i),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),s||e||this.setValue("")):this.cellProperties.defaultDate?(t=this.cellProperties.defaultDate,f.defaultDate=t,u.default(t,i,!0).isValid()&&this.$datePicker.setMoment(u.default(t,i),!0),s||e||this.setValue("")):this.$datePicker.gotoToday();this.datePickerStyle.display="block";this.$datePicker.show()}},{key:"hideDatepicker",value:function(){this.datePickerStyle.display="none";this.$datePicker.hide()}},{key:"getDatePickerConfig",value:function(){var t=this,f=this.TEXTAREA,n={},i,r;return this.cellProperties&&this.cellProperties.datePickerConfig&&v.deepExtend(n,this.cellProperties.datePickerConfig),i=n.onSelect,r=n.onClose,n.field=f,n.trigger=f,n.container=this.datePicker,n.bound=!1,n.format=n.format||this.defaultDateFormat,n.reposition=n.reposition||!1,n.onSelect=function(n){isNaN(n.getTime())||(n=u.default(n).format(t.cellProperties.dateFormat||t.defaultDateFormat));t.setValue(n);t.hideDatepicker();i&&i()},n.onClose=function(){t.parentDestroyed||t.finishEditing(!1);r&&r()},n}}]),t}(d.default);t.default=s},function(n){n.exports=t},function(){},function(n,t,i){"use strict";function u(n){return n&&n.__esModule?n:{"default":n}}function a(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function v(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function y(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var r;t.__esModule=!0;var f=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),e=function o(n,t,i){var r,u,f;return n===null&&(n=Function.prototype),r=Object.getOwnPropertyDescriptor(n,t),r===undefined?(u=Object.getPrototypeOf(n),u===null?undefined:o(u,t,i)):"value"in r?r.value:(f=r.get,f===undefined)?undefined:f.call(i)},s=i(202),h=u(s),c=i(14),l=u(c);r=function(n){function t(){return a(this,t),v(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return y(t,n),f(t,[{key:"prepare",value:function(n,i,r,u,f,o){e(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"prepare",this).call(this,n,i,r,u,f,o);this.cellProperties.filter=!1;this.cellProperties.strict=!0}}]),t}(h.default);l.default.getSingleton().add("beforeValidate",function(n,t,i){var u=this.getCellMeta(t,this.propToCol(i));u.editor===r&&u.strict===void 0&&(u.filter=!1,u.strict=!0)});t.default=r},function(n,t,i){"use strict";function e(n){return n&&n.__esModule?n:{"default":n}}function o(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function s(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function h(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var r,u,f;t.__esModule=!0;r=i(62);u=e(r);f=function(n){function t(){return o(this,t),s(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return h(t,n),t}(u.default);t.default=f},function(n,t,i){"use strict";function c(n){return n&&n.__esModule?n:{"default":n}}function l(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function a(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function v(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var r;t.__esModule=!0;var u=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),f=function e(n,t,i){var r,u,f;return n===null&&(n=Function.prototype),r=Object.getOwnPropertyDescriptor(n,t),r===undefined?(u=Object.getPrototypeOf(n),u===null?undefined:e(u,t,i)):"value"in r?r.value:(f=r.get,f===undefined)?undefined:f.call(i)},o=i(2),s=i(62),h=c(s);r=function(n){function t(){return l(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return v(t,n),u(t,[{key:"createElements",value:function(){f(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"createElements",this).call(this);this.TEXTAREA=document.createElement("input");this.TEXTAREA.setAttribute("type","password");this.TEXTAREA.className="handsontableInput";this.textareaStyle=this.TEXTAREA.style;this.textareaStyle.width=0;this.textareaStyle.height=0;o.empty(this.TEXTAREA_PARENT);this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}]),t}(h.default);t.default=r},function(n,t,i){"use strict";function l(n){return n&&n.__esModule?n:{"default":n}}var u,f;t.__esModule=!0;var c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},r=i(2),e=i(11),o=i(18),s=i(60),h=l(s);u=h.default.prototype.extend();u.prototype.init=function(){this.select=document.createElement("SELECT");r.addClass(this.select,"htSelectEditor");this.select.style.display="none";this.instance.rootElement.appendChild(this.select);this.registerHooks()};u.prototype.registerHooks=function(){var n=this;this.instance.addHook("afterScrollHorizontally",function(){return n.refreshDimensions()});this.instance.addHook("afterScrollVertically",function(){return n.refreshDimensions()});this.instance.addHook("afterColumnResize",function(){return n.refreshDimensions()});this.instance.addHook("afterRowResize",function(){return n.refreshDimensions()})};u.prototype.prepare=function(){var n,t,i,u;h.default.prototype.prepare.apply(this,arguments);n=this.cellProperties.selectOptions;t=typeof n=="function"?this.prepareOptions(n(this.row,this.col,this.prop)):this.prepareOptions(n);r.empty(this.select);for(i in t)Object.prototype.hasOwnProperty.call(t,i)&&(u=document.createElement("OPTION"),u.value=i,r.fastInnerHTML(u,t[i]),this.select.appendChild(u))};u.prototype.prepareOptions=function(n){var i={},t,r;if(Array.isArray(n))for(t=0,r=n.length;t<r;t++)i[n[t]]=n[t];else(typeof n=="undefined"?"undefined":c(n))=="object"&&(i=n);return i};u.prototype.getValue=function(){return this.select.value};u.prototype.setValue=function(n){this.select.value=n};f=function(n){var u=this,t=u.getActiveEditor(),i,r;switch(n.keyCode){case o.KEY_CODES.ARROW_UP:i=t.select.selectedIndex-1;i>=0&&(t.select[i].selected=!0);e.stopImmediatePropagation(n);n.preventDefault();break;case o.KEY_CODES.ARROW_DOWN:r=t.select.selectedIndex+1;r<=t.select.length-1&&(t.select[r].selected=!0);e.stopImmediatePropagation(n);n.preventDefault()}};u.prototype.open=function(){this._opened=!0;this.refreshDimensions();this.select.style.display="";this.instance.addHook("beforeKeyDown",f)};u.prototype.close=function(){this._opened=!1;this.select.style.display="none";this.instance.removeHook("beforeKeyDown",f)};u.prototype.focus=function(){this.select.focus()};u.prototype.refreshValue=function(){var n=this.instance.getSourceDataAtCell(this.row,this.prop);this.originalValue=n;this.setValue(n);this.refreshDimensions()};u.prototype.refreshDimensions=function(){var t,i;if(this.state===s.EditorState.EDITING){if(this.TD=this.getEditedCell(),!this.TD){this.close();return}var u=r.outerWidth(this.TD)+1,f=r.outerHeight(this.TD)+1,e=r.offset(this.TD),o=r.offset(this.instance.rootElement),h=r.getScrollableElement(this.TD),c=e.top-o.top-1-(h.scrollTop||0),l=e.left-o.left-1-(h.scrollLeft||0),v=this.checkEditorSection(),n,a=this.instance.getSettings(),y=a.rowHeaders?1:0,p=a.colHeaders?1:0;switch(v){case"top":n=r.getCssTransform(this.instance.view.wt.wtOverlays.topOverlay.clone.wtTable.holder.parentNode);break;case"left":n=r.getCssTransform(this.instance.view.wt.wtOverlays.leftOverlay.clone.wtTable.holder.parentNode);break;case"top-left-corner":n=r.getCssTransform(this.instance.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.holder.parentNode);break;case"bottom-left-corner":n=r.getCssTransform(this.instance.view.wt.wtOverlays.bottomLeftCornerOverlay.clone.wtTable.holder.parentNode);break;case"bottom":n=r.getCssTransform(this.instance.view.wt.wtOverlays.bottomOverlay.clone.wtTable.holder.parentNode)}this.instance.getSelectedLast()[0]===0&&(c+=1);this.instance.getSelectedLast()[1]===0&&(l+=1);t=this.select.style;n&&n!=-1?t[n[0]]=n[1]:r.resetCssTransform(this.select);i=r.getComputedStyle(this.TD);parseInt(i.borderTopWidth,10)>0&&(f-=1);parseInt(i.borderLeftWidth,10)>0&&(u-=1);t.height=f+"px";t.minWidth=u+"px";t.top=c+"px";t.left=l+"px";t.margin="0px"}};u.prototype.getEditedCell=function(){var t=this.checkEditorSection(),n;switch(t){case"top":n=this.instance.view.wt.wtOverlays.topOverlay.clone.wtTable.getCell({row:this.row,col:this.col});this.select.style.zIndex=101;break;case"corner":n=this.instance.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.getCell({row:this.row,col:this.col});this.select.style.zIndex=103;break;case"left":n=this.instance.view.wt.wtOverlays.leftOverlay.clone.wtTable.getCell({row:this.row,col:this.col});this.select.style.zIndex=102;break;default:n=this.instance.getCell(this.row,this.col);this.select.style.zIndex=""}if(n!=-1&&n!=-2)return n};t.default=u},function(n,t,i){"use strict";function u(n,t,i,u,f,e,o){o.className&&(t.className=t.className?t.className+" "+o.className:o.className);o.readOnly&&r.addClass(t,o.readOnlyCellClassName);o.valid===!1&&o.invalidCellClassName?r.addClass(t,o.invalidCellClassName):r.removeClass(t,o.invalidCellClassName);o.wordWrap===!1&&o.noWordWrapClassName&&r.addClass(t,o.noWordWrapClassName);!e&&o.placeholder&&r.addClass(t,o.placeholderCellClassName)}t.__esModule=!0;var r=i(2);t.default=u},function(n,t,i){"use strict";function c(n){return n&&n.__esModule?n:{"default":n}}function a(n,t,i,o,c,l,a){var p=f.cloneNode(!0),y=r.cloneNode(!0),v;a.allowHtml?e.getRenderer("html").apply(this,arguments):e.getRenderer("text").apply(this,arguments);t.appendChild(y);u.addClass(t,"htAutocomplete");t.firstChild||t.appendChild(document.createTextNode(String.fromCharCode(160)));n.acArrowListener||(v=new s.default(n),n.acArrowListener=function(r){u.hasClass(r.target,"htAutocompleteArrow")&&n.view.wt.getSetting("onCellDblClick",null,new h.CellCoords(i,o),t)},v.addEventListener(n.rootElement,"mousedown",n.acArrowListener),n.addHookOnce("afterDestroy",function(){v.destroy()}))}var f,r,l;t.__esModule=!0;var u=i(2),o=i(9),s=c(o),h=i(8),e=i(15);f=document.createElement("DIV");f.className="htAutocompleteWrapper";r=document.createElement("DIV");r.className="htAutocompleteArrow";r.appendChild(document.createTextNode(String.fromCharCode(9660)));l=function(n,t){t.innerHTML=n.innerHTML;u.empty(n);n.appendChild(t)};t.default=a},function(n,t,i){"use strict";function y(n){return n&&n.__esModule?n:{"default":n}}function w(n,t,i,u,s,h,c){function rt(n){var i="SPACE|ENTER",r="DELETE|BACKSPACE",t=a.partial(l.isKey,n.keyCode);t(i+"|"+r)&&!e.isImmediatePropagationStopped(n)&&ut(function(){e.stopImmediatePropagation(n);n.preventDefault()});t(i)&&it();t(r)&&it(!0)}function it(){var h=arguments.length>0&&arguments[0]!==undefined?arguments[0]:!1,f=n.getSelectedRangeLast(),i,r,t,e;if(f){var o=f.getTopLeftCorner(),c=o.row,l=o.col,s=f.getBottomRightCorner(),a=s.row,v=s.col,u=[];for(i=c;i<=a;i+=1)for(r=l;r<=v;r+=1){if(t=n.getCellMeta(i,r),t.type!=="checkbox")return;t.readOnly!==!0&&(typeof t.checkedTemplate=="undefined"&&(t.checkedTemplate=!0),typeof t.uncheckedTemplate=="undefined"&&(t.uncheckedTemplate=!1),e=n.getDataAtCell(i,r),h===!1?[t.checkedTemplate,t.checkedTemplate.toString()].includes(e)?u.push([i,r,t.uncheckedTemplate]):[t.uncheckedTemplate,t.uncheckedTemplate.toString(),null,void 0].includes(e)&&u.push([i,r,t.checkedTemplate]):u.push([i,r,t.uncheckedTemplate]))}u.length>0&&n.setDataAtCell(u)}}function ut(t){var f=n.getSelectedRangeLast(),e,o,i,r,u,s,h;if(f)for(e=f.getTopLeftCorner(),o=f.getBottomRightCorner(),i=e.row;i<=o.row;i++)for(r=e.col;r<=o.col;r++){if(u=n.getCellMeta(i,r),u.type!=="checkbox")return;s=n.getCell(i,r);s==null?t(i,r,u):(h=s.querySelectorAll("input[type=checkbox]"),h.length>0&&!u.readOnly&&t(h))}}var nt,g;v.getRenderer("base").apply(this,arguments);var ft=b(n),y=k(),w=c.label,tt=!1;typeof c.checkedTemplate=="undefined"&&(c.checkedTemplate=!0);typeof c.uncheckedTemplate=="undefined"&&(c.uncheckedTemplate=!1);r.empty(t);h===c.checkedTemplate||f.equalsIgnoreCase(h,c.checkedTemplate)?y.checked=!0:h===c.uncheckedTemplate||f.equalsIgnoreCase(h,c.uncheckedTemplate)?y.checked=!1:h===null?r.addClass(y,"noValue"):(y.style.display="none",r.addClass(y,p),tt=!0);y.setAttribute("data-row",i);y.setAttribute("data-col",u);!tt&&w&&(nt="",w.value?nt=typeof w.value=="function"?w.value.call(this,i,u,s,h):w.value:w.property&&(nt=n.getDataAtRowProp(i,w.property)),g=d(nt),w.position==="before"?g.appendChild(y):g.insertBefore(y,g.firstChild),y=g);t.appendChild(y);tt&&t.appendChild(document.createTextNode("#bad-value#"));o.has(n)||(o.set(n,!0),n.addHook("beforeKeyDown",rt))}function b(n){var t=s.get(n);return t||(t=new c.default(n),t.addEventListener(n.rootElement,"click",function(t){return nt(t,n)}),t.addEventListener(n.rootElement,"mouseup",function(t){return g(t,n)}),t.addEventListener(n.rootElement,"change",function(t){return tt(t,n)}),s.set(n,t)),t}function k(){var n=document.createElement("input");return n.className="htCheckboxRendererInput",n.type="checkbox",n.setAttribute("autocomplete","off"),n.setAttribute("tabindex","-1"),n.cloneNode(!1)}function d(n){var t=document.createElement("label");return t.className="htCheckboxRendererLabel",t.appendChild(document.createTextNode(n)),t.cloneNode(!0)}function g(n,t){u(n.target)&&setTimeout(t.listen,10)}function nt(n,t){if(!u(n.target))return!1;var i=parseInt(n.target.getAttribute("data-row"),10),r=parseInt(n.target.getAttribute("data-col"),10),f=t.getCellMeta(i,r);f.readOnly&&n.preventDefault()}function tt(n,t){var r;if(!u(n.target))return!1;var f=parseInt(n.target.getAttribute("data-row"),10),e=parseInt(n.target.getAttribute("data-col"),10),i=t.getCellMeta(f,e);i.readOnly||(r=null,r=n.target.checked?i.uncheckedTemplate===void 0?!0:i.checkedTemplate:i.uncheckedTemplate===void 0?!1:i.uncheckedTemplate,t.setDataAtCell(f,e,r))}function u(n){return n.tagName==="INPUT"&&n.getAttribute("type")==="checkbox"}t.__esModule=!0;var r=i(2),f=i(30),h=i(9),c=y(h),l=i(18),a=i(35),e=i(11),v=i(15);var o=new WeakMap,s=new WeakMap,p="htBadValue";t.default=w},function(n,t,i){"use strict";function f(n,t,i,f,e,o){u.getRenderer("base").apply(this,arguments);(o===null||o===void 0)&&(o="");r.fastInnerHTML(t,o)}t.__esModule=!0;var r=i(2),u=i(15);t.default=f},function(n,t,i){"use strict";function o(n){return n&&n.__esModule?n:{"default":n}}function s(n,t,i,u,o,s,h){if(e.isNumeric(s)){var l=h.numericFormat,a=l&&l.culture,y=l&&l.pattern,v=h.className||"",c=v.length?v.split(" "):[];typeof a!="undefined"&&r.default.culture(a);s=r.default(s).format(y||"0");c.indexOf("htLeft")<0&&c.indexOf("htCenter")<0&&c.indexOf("htRight")<0&&c.indexOf("htJustify")<0&&c.push("htRight");c.indexOf("htNumeric")<0&&c.push("htNumeric");h.className=c.join(" ")}f.getRenderer("text")(n,t,i,u,o,s,h)}t.__esModule=!0;var u=i(275),r=o(u),f=i(15),e=i(4);t.default=s},function(n){n.exports=i},function(n,t,i){"use strict";function e(n,t,i,e,o,s,h){u.getRenderer("text").apply(this,arguments);s=t.innerHTML;var l=h.hashLength||s.length,a=h.hashSymbol||"*",c="";f.rangeEach(l-1,function(){c+=a});r.fastInnerHTML(t,c)}t.__esModule=!0;var r=i(2),u=i(15),f=i(4);t.default=e},function(n,t,i){"use strict";function e(n,t,i,e,o,s,h){var l,c;f.getRenderer("base").apply(this,arguments);!s&&h.placeholder&&(s=h.placeholder);l=u.stringify(s);n.getSettings().trimWhitespace||(l=l.replace(/ /g,String.fromCharCode(160)));h.rendererTemplate?(r.empty(t),c=document.createElement("TEMPLATE"),c.setAttribute("bind","{{}}"),c.innerHTML=h.rendererTemplate,HTMLTemplateElement.decorate(c),c.model=n.getSourceDataAtRow(i),t.appendChild(c)):r.fastInnerText(t,l)}t.__esModule=!0;var r=i(2),u=i(13),f=i(15);t.default=e},function(n,t){"use strict";function r(n,t){if(n==null&&(n=""),this.allowEmpty&&n===""){t(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(n,i(n,t)):i(n,t)(this.source):t(!0)}function i(n,t){var i=n;return function(n){for(var u=!1,r=0,f=n.length;r<f;r++)if(i===n[r]){u=!0;break}t(u)}}t.__esModule=!0;t.default=r},function(n,t,i){"use strict";function s(n){return n&&n.__esModule?n:{"default":n}}function h(n,t){var i=!0,s=o.getEditorInstance("date",this.instance),f,e;if(n==null&&(n=""),f=r.default(new Date(n)).isValid()||r.default(n,s.defaultDateFormat).isValid(),e=r.default(n,this.dateFormat||s.defaultDateFormat,!0).isValid(),this.allowEmpty&&n===""&&(f=!0,e=!0),f||(i=!1),!f&&e&&(i=!0),f&&!e)if(this.correctFormat===!0){var h=u(n,this.dateFormat),c=this.instance.runHooks("unmodifyRow",this.row),l=this.instance.runHooks("unmodifyCol",this.col);this.instance.setDataAtCell(c,l,h,"dateValidator");i=!0}else i=!1;t(i)}function u(n,t){var i=r.default(e.getNormalizedDate(n)),u=r.default(n,t),o=n.search(/[A-z]/g)>-1,f=void 0;return f=i.isValid()&&i.format("x")===u.format("x")||!u.isValid()||o?i:u,f.format(t)}t.__esModule=!0;t.default=h;t.correctFormat=u;var f=i(31),r=s(f),e=i(204),o=i(19)},function(n,t){"use strict";function i(n,t){n==null&&(n="");this.allowEmpty&&n===""?t(!0):n===""?t(!1):t(/^-?\d*(\.|,)?\d*$/.test(n))}t.__esModule=!0;t.default=i},function(n,t,i){"use strict";function e(n){return n&&n.__esModule?n:{"default":n}}function o(n,t){var i=!0,e=this.timeFormat||"h:mm:ss a",o;n===null&&(n="");n=/^\d{3,}$/.test(n)?parseInt(n,10):n;o=/^\d{1,2}$/.test(n);o&&(n+=":00");var h=r.default(n,f,!0).isValid()?r.default(n):r.default(n,e),u=h.isValid(),s=r.default(n,e,!0).isValid()&&!o;if(this.allowEmpty&&n===""&&(u=!0,s=!0),u||(i=!1),!u&&s&&(i=!0),u&&!s)if(this.correctFormat===!0){var c=h.format(e),l=this.instance.runHooks("unmodifyRow",this.row),a=this.instance.runHooks("unmodifyCol",this.col);this.instance.setDataAtCell(l,a,c,"timeValidator");i=!0}else i=!1;t(i)}var u,r,f;t.__esModule=!0;t.default=o;u=i(31);r=e(u);f=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"]},function(n,t,i){"use strict";t.__esModule=!0;var u=i(19),f=i(15),e=i(36),r="autocomplete";t.default={editor:u.getEditor(r),renderer:f.getRenderer(r),validator:e.getValidator(r)}},function(n,t,i){"use strict";t.__esModule=!0;var u=i(19),f=i(15),r="checkbox";t.default={editor:u.getEditor(r),renderer:f.getRenderer(r)}},function(n,t,i){"use strict";t.__esModule=!0;var u=i(19),f=i(15),e=i(36),r="date";t.default={editor:u.getEditor(r),renderer:f.getRenderer("autocomplete"),validator:e.getValidator(r)}},function(n,t,i){"use strict";t.__esModule=!0;var r=i(19),u=i(15),f=i(36);t.default={editor:r.getEditor("dropdown"),renderer:u.getRenderer("autocomplete"),validator:f.getValidator("autocomplete")}},function(n,t,i){"use strict";t.__esModule=!0;var r=i(19),u=i(15);t.default={editor:r.getEditor("handsontable"),renderer:u.getRenderer("autocomplete")}},function(n,t,i){"use strict";t.__esModule=!0;var u=i(19),f=i(15),e=i(36),r="numeric";t.default={editor:u.getEditor(r),renderer:f.getRenderer(r),validator:e.getValidator(r),dataType:"number"}},function(n,t,i){"use strict";t.__esModule=!0;var u=i(19),f=i(15),e=i(36),r="password";t.default={editor:u.getEditor(r),renderer:f.getRenderer(r),copyable:!1}},function(n,t,i){"use strict";t.__esModule=!0;var e=i(33),u=i(19),f=i(15),r="text";t.default={editor:u.getEditor(r),renderer:f.getRenderer(r)}},function(n,t,i){"use strict";t.__esModule=!0;var r=i(19),u=i(15),f=i(36);t.default={editor:r.getEditor("text"),renderer:u.getRenderer("text"),validator:f.getValidator("time")}},function(n,t,i){"use strict";function f(n){return n&&n.__esModule?n:{"default":n}}function r(n,t,i){var r=this;this.instance=n;this.priv=t;this.GridSettings=i;this.dataSource=this.instance.getSettings().data;this.cachedLength=null;this.skipCache=!1;this.latestSourceRowsCount=0;this.duckSchema=this.dataSource&&this.dataSource[0]?this.recursiveDuckSchema(this.dataSource[0]):{};this.createMap();this.interval=p.default.create(function(){return r.clearLengthCache()},"15fps");this.instance.addHook("skipLengthCache",function(n){return r.onSkipLengthCache(n)});this.onSkipLengthCache(500)}var h;t.__esModule=!0;var c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},l=i(205),o=f(l),a=i(81),v=i(153),u=i(1),e=i(0),y=i(292),p=f(y),s=i(4),w=i(293),b=f(w),k=i(14),d=f(k);r.prototype.DESTINATION_RENDERER=1;r.prototype.DESTINATION_CLIPBOARD_GENERATOR=2;r.prototype.recursiveDuckSchema=function(n){return u.duckSchema(n)};r.prototype.recursiveDuckColumns=function(n,t,i){var f,r;if(typeof t=="undefined"&&(t=0,i=""),(typeof n=="undefined"?"undefined":c(n))==="object"&&!Array.isArray(n))for(r in n)u.hasOwnProperty(n,r)&&(n[r]===null?(f=i+r,this.colToPropCache.push(f),this.propToColCache.set(f,t),t++):t=this.recursiveDuckColumns(n[r],t,r+"."));return t};r.prototype.createMap=function(){var n=void 0,r=this.getSchema(),t,i,e;if(typeof r=="undefined")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");if(this.colToPropCache=[],this.propToColCache=new b.default,t=this.instance.getSettings().columns,t){var c=this.instance.getSettings().maxCols,o=Math.min(c,t.length),s=0,f=!1,h=u.deepObjectSize(r);for(typeof t=="function"&&(o=h>0?h:this.instance.countSourceCols(),f=!0),n=0;n<o;n++)i=f?t(n):t[n],u.isObject(i)&&(typeof i.data!="undefined"&&(e=f?s:n,this.colToPropCache[e]=i.data,this.propToColCache.set(i.data,e)),s++)}else this.recursiveDuckColumns(r)};r.prototype.colToProp=function(n){return(n=this.instance.runHooks("modifyCol",n),!isNaN(n)&&this.colToPropCache&&typeof this.colToPropCache[n]!="undefined")?this.colToPropCache[n]:n};r.prototype.propToCol=function(n){var t;return t=typeof this.propToColCache.get(n)=="undefined"?n:this.propToColCache.get(n),this.instance.runHooks("unmodifyCol",t)};r.prototype.getSchema=function(){var n=this.instance.getSettings().dataSchema;return n?typeof n=="function"?n():n:this.duckSchema};r.prototype.createRow=function(n){var t=this,r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1,f=arguments[2],i=0,e;if((typeof n!="number"||n>=this.instance.countSourceRows())&&(n=this.instance.countSourceRows()),e=this.instance.runHooks("beforeCreateRow",n,r,f),e===!1)return 0;for(var o=this.instance.getSettings().maxRows,h=this.instance.countCols(),c=function(){var r=null;t.instance.dataType==="array"?t.instance.getSettings().dataSchema?r=u.deepClone(t.getSchema()):(r=[],s.rangeEach(h-1,function(){return r.push(null)})):t.instance.dataType==="function"?r=t.instance.getSettings().dataSchema(n):(r={},u.deepExtend(r,t.getSchema()));n===t.instance.countSourceRows()?t.dataSource.push(r):t.spliceData(n,0,r);i++};i<r&&this.instance.countSourceRows()<o;)c();return this.instance.runHooks("afterCreateRow",n,i,f),this.instance.forceFullRender=!0,i};r.prototype.createCol=function(n,t,i){var c,r,o;if(!this.instance.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");var s=this.instance.countSourceRows(),u=this.dataSource,h,f=0,e;for(t||(t=1),(typeof n!="number"||n>=this.instance.countCols())&&(n=this.instance.countCols()),this.instance.runHooks("beforeCreateCol",n,t,i),e=n,c=this.instance.getSettings().maxCols;f<t&&this.instance.countCols()<c;){if(h=v.columnFactory(this.GridSettings,this.priv.columnsSettingConflicts),typeof n!="number"||n>=this.instance.countCols()){if(s>0)for(r=0;r<s;r++)typeof u[r]=="undefined"&&(u[r]=[]),u[r].push(null);else u.push([null]);this.priv.columnSettings.push(h)}else{for(o=0;o<s;o++)u[o].splice(e,0,null);this.priv.columnSettings.splice(e,0,h)}f++;e++}return this.instance.runHooks("afterCreateCol",n,f,i),this.instance.forceFullRender=!0,f};r.prototype.removeRow=function(n,t,i){var u,e,f,r;(t||(t=1),typeof n!="number"&&(n=-t),t=this.instance.runHooks("modifyRemovedAmount",t,n),n=(this.instance.countSourceRows()+n)%this.instance.countSourceRows(),u=this.visualRowsToPhysical(n,t),e=this.instance.runHooks("beforeRemoveRow",n,t,u,i),e!==!1)&&(f=this.dataSource,r=void 0,r=this.filterData(n,t),r&&(f.length=0,Array.prototype.push.apply(f,r)),this.instance.runHooks("afterRemoveRow",n,t,u,i),this.instance.forceFullRender=!0)};r.prototype.removeCol=function(n,t,i){var u,f,v,e,y,o,s;if(this.instance.dataType==="object"||this.instance.getSettings().columns)throw new Error("cannot remove column with object data source or columns option specified");t||(t=1);typeof n!="number"&&(n=-t);n=(this.instance.countCols()+n)%this.instance.countCols();var r=this.visualColumnsToPhysical(n,t),l=r.slice(0).sort(function(n,t){return t-n}),p=this.instance.runHooks("beforeRemoveCol",n,t,r,i);if(p!==!1){var h=!0,c=l.length,a=this.dataSource;for(u=0;u<c;u++)h&&r[0]!==r[u]-u&&(h=!1);if(h)for(f=0,v=this.instance.countSourceRows();f<v;f++)a[f].splice(r[0],t);else{for(e=0,y=this.instance.countSourceRows();e<y;e++)for(o=0;o<c;o++)a[e].splice(l[o],1);for(s=0;s<c;s++)this.priv.columnSettings.splice(r[s],1)}this.instance.runHooks("afterRemoveCol",n,t,r,i);this.instance.forceFullRender=!0}};r.prototype.spliceCol=function(n,t,i){var r=arguments.length>=4?[].slice.call(arguments,3):[],f=this.instance.getDataAtCol(n),o=f.slice(t,t+i),s=f.slice(t+i),u;for(e.extendArray(r,s),u=0;u<i;)r.push(null),u++;return e.to2dArray(r),this.instance.populateFromArray(t,n,r,null,null,"spliceCol"),o};r.prototype.spliceRow=function(n,t,i){var r=arguments.length>=4?[].slice.call(arguments,3):[],f=this.instance.getSourceDataAtRow(n),o=f.slice(t,t+i),s=f.slice(t+i),u;for(e.extendArray(r,s),u=0;u<i;)r.push(null),u++;return this.instance.populateFromArray(n,t,[r],null,null,"spliceRow"),o};r.prototype.spliceData=function(n,t,i){var r=this.instance.runHooks("beforeDataSplice",n,t,i);r!==!1&&this.dataSource.splice(n,t,i)};r.prototype.filterData=function(n,t){var i=this.visualRowsToPhysical(n,t),r=this.instance.runHooks("beforeDataFilter",n,t,i);if(r!==!1)return this.dataSource.filter(function(n,t){return i.indexOf(t)==-1})};r.prototype.get=function(n,t){var i,s,r,h,f,e,c,o;if(n=this.instance.runHooks("modifyRow",n),i=this.dataSource[n],s=this.instance.runHooks("modifyRowData",n),i=isNaN(s)?s:i,r=null,i&&i.hasOwnProperty&&u.hasOwnProperty(i,t))r=i[t];else if(typeof t=="string"&&t.indexOf(".")>-1){if(h=t.split("."),f=i,!f)return null;for(e=0,c=h.length;e<c;e++)if(f=f[h[e]],typeof f=="undefined")return null;r=f}else typeof t=="function"&&(r=t(this.dataSource.slice(n,n+1)[0]));return this.instance.hasHook("modifyData")&&(o=u.createObjectPropListener(r),this.instance.runHooks("modifyData",n,this.propToCol(t),o,"get"),o.isTouched()&&(r=o.value)),r};h=a.cellMethodLookupFactory("copyable",!1);r.prototype.getCopyable=function(n,t){return h.call(this.instance,n,this.propToCol(t))?this.get(n,t):""};r.prototype.set=function(n,t,i,r){var f,c,h;if(n=this.instance.runHooks("modifyRow",n,r||"datamapGet"),f=this.dataSource[n],c=this.instance.runHooks("modifyRowData",n),f=isNaN(c)?c:f,this.instance.hasHook("modifyData")&&(h=u.createObjectPropListener(i),this.instance.runHooks("modifyData",n,this.propToCol(t),h,"set"),h.isTouched()&&(i=h.value)),f&&f.hasOwnProperty&&u.hasOwnProperty(f,t))f[t]=i;else if(typeof t=="string"&&t.indexOf(".")>-1){for(var o=t.split("."),s=f,e=0,l=void 0,e=0,l=o.length-1;e<l;e++)typeof s[o[e]]=="undefined"&&(s[o[e]]={}),s=s[o[e]];s[o[e]]=i}else typeof t=="function"?t(this.dataSource.slice(n,n+1)[0],i):f[t]=i};r.prototype.visualRowsToPhysical=function(n,t){for(var i=this.instance.countSourceRows(),r=(i+n)%i,u=[],f=t,e;r<i&&f;)e=this.instance.runHooks("modifyRow",r),u.push(e),f--,r++;return u};r.prototype.visualColumnsToPhysical=function(n,t){for(var i=this.instance.countCols(),r=(i+n)%i,u=[],f=t,e;r<i&&f;)e=this.instance.runHooks("modifyCol",r),u.push(e),f--,r++;return u};r.prototype.clear=function(){for(var t,n=0;n<this.instance.countSourceRows();n++)for(t=0;t<this.instance.countCols();t++)this.set(n,this.colToProp(t),"")};r.prototype.clearLengthCache=function(){this.cachedLength=null};r.prototype.getLength=function(){var u=this,r=void 0,t=this.instance.getSettings().maxRows,n,i;return r=t<0||t===0?0:t||Infinity,n=this.instance.countSourceRows(),this.instance.hasHook("modifyRow")?(i=this.skipCache,this.interval.start(),n!==this.latestSourceRowsCount&&(i=!0),this.latestSourceRowsCount=n,this.cachedLength===null||i?(s.rangeEach(n-1,function(t){t=u.instance.runHooks("modifyRow",t);t===null&&--n}),this.cachedLength=n):n=this.cachedLength):this.interval.stop(),Math.min(n,r)};r.prototype.getAll=function(){var n={row:0,col:0},t={row:Math.max(this.instance.countSourceRows()-1,0),col:Math.max(this.instance.countCols()-1,0)};return n.row-t.row==0&&!this.instance.countSourceRows()?[]:this.getRange(n,t,r.prototype.DESTINATION_RENDERER)};r.prototype.getRange=function(n,t,i){var r,o,u,s,h=[],f,c=this.instance.getSettings().maxRows,l=this.instance.getSettings().maxCols,a,e;if(c===0||l===0)return[];for(a=i===this.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,o=Math.min(Math.max(c-1,0),Math.max(n.row,t.row)),s=Math.min(Math.max(l-1,0),Math.max(n.col,t.col)),r=Math.min(n.row,t.row);r<=o;r++){for(f=[],e=this.instance.runHooks("modifyRow",r),u=Math.min(n.col,t.col);u<=s;u++){if(e===null)break;f.push(a.call(this,r,this.colToProp(u)))}e!==null&&h.push(f)}return h};r.prototype.getText=function(n,t){return o.default.stringify(this.getRange(n,t,this.DESTINATION_RENDERER))};r.prototype.getCopyableText=function(n,t){return o.default.stringify(this.getRange(n,t,this.DESTINATION_CLIPBOARD_GENERATOR))};r.prototype.onSkipLengthCache=function(n){var t=this;this.skipCache=!0;setTimeout(function(){t.skipCache=!1},n)};r.prototype.destroy=function(){this.interval.stop();this.interval=null;this.instance=null;this.priv=null;this.GridSettings=null;this.dataSource=null;this.cachedLength=null;this.duckSchema=null};t.default=r},function(n,t,i){"use strict";function o(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function e(n){return typeof n=="string"&&/fps$/.test(n)&&(n=1e3/parseInt(n.replace("fps","")||0,10)),n}var u,r,f;t.__esModule=!0;u=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}();t.parseDelay=e;r=i(43);f=function(){function n(t,i){var r=this;o(this,n);this.timer=null;this.func=t;this.delay=e(i);this.stopped=!0;this._then=null;this._callback=function(){return r.__callback()}}return u(n,null,[{key:"create",value:function(t,i){return new n(t,i)}}]),u(n,[{key:"start",value:function(){return this.stopped&&(this._then=Date.now(),this.stopped=!1,this.timer=r.requestAnimationFrame(this._callback)),this}},{key:"stop",value:function(){return this.stopped||(this.stopped=!0,r.cancelAnimationFrame(this.timer),this.timer=null),this}},{key:"__callback",value:function(){if(this.timer=r.requestAnimationFrame(this._callback),this.delay){var n=Date.now(),t=n-this._then;t>this.delay&&(this._then=n-t%this.delay,this.func())}else this.func()}}]),n}();t.default=f},function(n,t){"use strict";function r(){function t(n){return n!==null&&!u(n)&&(typeof n=="string"||typeof n=="number")}function r(n){return n!==null&&((typeof n=="undefined"?"undefined":i(n))=="object"||typeof n=="function")}function u(n){return n!==n}var n={arrayMap:[],weakMap:new WeakMap};return{get:function(i){return t(i)?n.arrayMap[i]:r(i)?n.weakMap.get(i):void 0},set:function(i,u){if(t(i))n.arrayMap[i]=u;else if(r(i))n.weakMap.set(i,u);else throw new Error("Invalid key type");},"delete":function(i){t(i)?delete n.arrayMap[i]:r(i)&&n.weakMap.delete(i)}}}t.__esModule=!0;var i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n};t.default=r},function(n,t,i){"use strict";function a(n){return n&&n.__esModule?n:{"default":n}}function e(n,t,i){function v(n){i.setSelectedHeaders(!1,!1,!1);var r=typeof t.settings.enterMoves=="function"?t.settings.enterMoves(event):t.settings.enterMoves;n?i.transformStart(-r.row,-r.col):i.transformStart(r.row,r.col,!0)}function p(n){n?(i.selectedHeader.cols&&i.setSelectedHeaders(i.selectedHeader.rows,!1,!1),i.transformEnd(-1,0)):(i.setSelectedHeaders(!1,!1,!1),i.transformStart(-1,0))}function w(n){n?i.transformEnd(1,0):(i.setSelectedHeaders(!1,!1,!1),i.transformStart(1,0))}function b(n){n?i.transformEnd(0,1):(i.setSelectedHeaders(!1,!1,!1),i.transformStart(0,1))}function k(n){n?(i.selectedHeader.rows&&i.setSelectedHeaders(!1,i.selectedHeader.cols,!1),i.transformEnd(0,-1)):(i.setSelectedHeaders(!1,!1,!1),i.transformStart(0,-1))}function d(s){var h,c,y;if(n.isListening()&&(n.runHooks("beforeKeyDown",s),!a)&&!u.isImmediatePropagationStopped(s)&&(t.lastKeyCode=s.keyCode,i.isSelected())){if(h=(s.ctrlKey||s.metaKey)&&!s.altKey,e&&!e.isWaiting()&&!r.isMetaKey(s.keyCode)&&!r.isCtrlMetaKey(s.keyCode)&&!h&&!o.isEditorOpened()){o.openEditor("",s);return}c=s.shiftKey?i.setRangeEnd:i.setRangeStart;switch(s.keyCode){case r.KEY_CODES.A:!o.isEditorOpened()&&h&&(i.selectAll(),s.preventDefault(),u.stopPropagation(s));break;case r.KEY_CODES.ARROW_UP:o.isEditorOpened()&&!e.isWaiting()&&o.closeEditorAndSaveChanges(h);p(s.shiftKey);s.preventDefault();u.stopPropagation(s);break;case r.KEY_CODES.ARROW_DOWN:o.isEditorOpened()&&!e.isWaiting()&&o.closeEditorAndSaveChanges(h);w(s.shiftKey);s.preventDefault();u.stopPropagation(s);break;case r.KEY_CODES.ARROW_RIGHT:o.isEditorOpened()&&!e.isWaiting()&&o.closeEditorAndSaveChanges(h);b(s.shiftKey);s.preventDefault();u.stopPropagation(s);break;case r.KEY_CODES.ARROW_LEFT:o.isEditorOpened()&&!e.isWaiting()&&o.closeEditorAndSaveChanges(h);k(s.shiftKey);s.preventDefault();u.stopPropagation(s);break;case r.KEY_CODES.TAB:i.setSelectedHeaders(!1,!1,!1);y=typeof t.settings.tabMoves=="function"?t.settings.tabMoves(s):t.settings.tabMoves;s.shiftKey?i.transformStart(-y.row,-y.col):i.transformStart(y.row,y.col,!0);s.preventDefault();u.stopPropagation(s);break;case r.KEY_CODES.BACKSPACE:case r.KEY_CODES.DELETE:n.emptySelectedCells();o.prepareEditor();s.preventDefault();break;case r.KEY_CODES.F2:o.openEditor(null,s);e&&e.enableFullEditMode();s.preventDefault();break;case r.KEY_CODES.ENTER:o.isEditorOpened()?(e&&e.state!==l.EditorState.WAITING&&o.closeEditorAndSaveChanges(h),v(s.shiftKey)):n.getSettings().enterBeginsEditing?(o.openEditor(null,s),e&&e.enableFullEditMode()):v(s.shiftKey);s.preventDefault();u.stopImmediatePropagation(s);break;case r.KEY_CODES.ESCAPE:o.isEditorOpened()&&o.closeEditorAndRestoreOriginalValue(h);s.preventDefault();break;case r.KEY_CODES.HOME:i.setSelectedHeaders(!1,!1,!1);s.ctrlKey||s.metaKey?c.call(i,new f.CellCoords(0,i.selectedRange.current().from.col)):c.call(i,new f.CellCoords(i.selectedRange.current().from.row,0));s.preventDefault();u.stopPropagation(s);break;case r.KEY_CODES.END:i.setSelectedHeaders(!1,!1,!1);s.ctrlKey||s.metaKey?c.call(i,new f.CellCoords(n.countRows()-1,i.selectedRange.current().from.col)):c.call(i,new f.CellCoords(i.selectedRange.current().from.row,n.countCols()-1));s.preventDefault();u.stopPropagation(s);break;case r.KEY_CODES.PAGE_UP:i.setSelectedHeaders(!1,!1,!1);i.transformStart(-n.countVisibleRows(),0);s.preventDefault();u.stopPropagation(s);break;case r.KEY_CODES.PAGE_DOWN:i.setSelectedHeaders(!1,!1,!1);i.transformStart(n.countVisibleRows(),0);s.preventDefault();u.stopPropagation(s)}}}function g(){function t(n,t,i){i.nodeName==="TD"&&(o.openEditor(null,n),e&&e.enableFullEditMode())}n.addHook("afterDocumentKeyDown",d);y.addEventListener(document.documentElement,"keydown",function(t){a||n.runHooks("afterDocumentKeyDown",t)});n.view.wt.update("onCellDblClick",t)}var o=this,a=!1,h=!1,y,e;y=new c.default(n);this.lockEditor=function(){h=!0};this.unlockEditor=function(){h=!1};this.destroyEditor=function(n){h||this.closeEditor(n)};this.getActiveEditor=function(){return e};this.prepareEditor=function(){if(!h){var i,t,f,c,l,r,u;if(e&&e.isWaiting()){this.closeEditor(!1,!1,function(n){n&&o.prepareEditor()});return}i=n.selection.selectedRange.current().highlight.row;t=n.selection.selectedRange.current().highlight.col;f=n.colToProp(t);c=n.getCell(i,t);l=n.getSourceDataAtCell(n.runHooks("modifyRow",i),t);r=n.getCellMeta(i,t);u=n.getCellEditor(r);u?(e=s.getEditorInstance(u,n),e.prepare(i,t,f,c,l,r)):e=void 0}};this.isEditorOpened=function(){return e&&e.isOpened()};this.openEditor=function(n,t){e&&!e.cellProperties.readOnly?e.beginEditing(n,t):e&&e.cellProperties.readOnly&&t&&t.keyCode===r.KEY_CODES.ENTER&&v()};this.closeEditor=function(n,t,i){e?e.finishEditing(n,t,i):i&&i(!1)};this.closeEditorAndSaveChanges=function(n){return this.closeEditor(!1,n)};this.closeEditorAndRestoreOriginalValue=function(n){return this.closeEditor(!0,n)};this.destroy=function(){a=!0};g()}var o;t.__esModule=!0;var f=i(8),r=i(18),u=i(11),s=i(19),h=i(9),c=a(h),l=i(60);o=new WeakMap;e.getInstance=function(n,t,i,r){var u=o.get(n);return u||(u=new e(n,t,i,r),o.set(n,u)),u};t.default=e},function(n,t,i){"use strict";function s(n){return n&&n.__esModule?n:{"default":n}}function u(n){var v=this,t=this,s,i,u,h,c;this.eventManager=new l.default(n);this.instance=n;this.settings=n.getSettings();this.selectionMouseDown=!1;s=n.rootElement.getAttribute("style");s&&n.rootElement.setAttribute("data-originalstyle",s);r.addClass(n.rootElement,"handsontable");i=document.createElement("TABLE");r.addClass(i,"htCore");n.getSettings().tableClassName&&r.addClass(i,n.getSettings().tableClassName);this.THEAD=document.createElement("THEAD");i.appendChild(this.THEAD);this.TBODY=document.createElement("TBODY");i.appendChild(this.TBODY);n.table=i;n.container.insertBefore(i,n.container.firstChild);this.eventManager.addEventListener(n.rootElement,"mousedown",function(n){this.selectionMouseDown=!0;t.isTextSelectionAllowed(n.target)||(h(),n.preventDefault(),window.focus())});this.eventManager.addEventListener(n.rootElement,"mouseup",function(){this.selectionMouseDown=!1});this.eventManager.addEventListener(n.rootElement,"mousemove",function(n){this.selectionMouseDown&&!t.isTextSelectionAllowed(n.target)&&(h(),n.preventDefault())});this.eventManager.addEventListener(document.documentElement,"keyup",function(t){n.selection.isInProgress()&&!t.shiftKey&&n.selection.finish()});this.isMouseDown=function(){return u};this.eventManager.addEventListener(document.documentElement,"mouseup",function(t){n.selection.isInProgress()&&e.isLeftClick(t)&&n.selection.finish();u=!1;!r.isOutsideInput(document.activeElement)&&(n.selection.isSelected()||e.isRightClick(t))||n.unlisten()});this.eventManager.addEventListener(document.documentElement,"mousedown",function(i){var c=i.target,f=i.target,o=i.x||i.clientX,s=i.y||i.clientY,e,h;if(!u&&n.rootElement){if(f===n.view.wt.wtTable.holder){if(e=r.getScrollbarWidth(),document.elementFromPoint(o+e,s)!==n.view.wt.wtTable.holder||document.elementFromPoint(o,s+e)!==n.view.wt.wtTable.holder)return}else while(f!==document.documentElement){if(f===null){if(i.isTargetWebComponent)break;return}if(f===n.rootElement)return;f=f.parentNode}h=typeof t.settings.outsideClickDeselects=="function"?t.settings.outsideClickDeselects(c):t.settings.outsideClickDeselects;h?n.deselectCell():n.destroyEditor()}});this.eventManager.addEventListener(i,"selectstart",function(n){t.settings.fragmentSelection||r.isInput(n.target)||n.preventDefault()});h=function(){window.getSelection?window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&window.getSelection().removeAllRanges():document.selection&&document.selection.empty()};c={debug:function(){return t.settings.debug},externalRowCalculator:this.instance.getPlugin("autoRowSize")&&this.instance.getPlugin("autoRowSize").isEnabled(),table:i,preventOverflow:function(){return v.settings.preventOverflow},stretchH:function(){return t.settings.stretchH},data:n.getDataAtCell,totalRows:function(){return n.countRows()},totalColumns:function(){return n.countCols()},fixedColumnsLeft:function(){return t.settings.fixedColumnsLeft},fixedRowsTop:function(){return t.settings.fixedRowsTop},fixedRowsBottom:function(){return t.settings.fixedRowsBottom},minSpareRows:function(){return t.settings.minSpareRows},renderAllRows:t.settings.renderAllRows,rowHeaders:function(){var i=[];return n.hasRowHeaders()&&i.push(function(n,i){t.appendRowHeader(n,i)}),n.runHooks("afterGetRowHeaderRenderers",i),i},columnHeaders:function(){var i=[];return n.hasColHeaders()&&i.push(function(n,i){t.appendColHeader(n,i)}),n.runHooks("afterGetColumnHeaderRenderers",i),i},columnWidth:n.getColWidth,rowHeight:n.getRowHeight,cellRenderer:function(n,i,r){var u=t.instance.getCellMeta(n,i),e=t.instance.colToProp(i),f=t.instance.getDataAtRowProp(n,e);t.instance.hasHook("beforeValueRender")&&(f=t.instance.runHooks("beforeValueRender",f,u));t.instance.runHooks("beforeRenderer",r,n,i,e,f,u);t.instance.getCellRenderer(u)(t.instance,r,n,i,e,f,u);t.instance.runHooks("afterRenderer",r,n,i,e,f,u)},selections:t.instance.selection.highlight,hideBorderOnMouseDownOver:function(){return t.settings.fragmentSelection},onCellMouseDown:function(i,r,o,s){var l={row:!1,column:!1,cells:!1},v,k,d,g,nt,w,b;if(n.listen(),t.activeWt=s,u=!0,n.runHooks("beforeOnCellMouseDown",i,r,o,l),!e.isImmediatePropagationStopped(i)){var a=n.getSelectedRangeLast(),h=n.selection,c=h.selectedHeader;if(i.shiftKey&&a)r.row>=0&&r.col>=0&&!l.cells?(h.setSelectedHeaders(!1,!1),h.setRangeEnd(r)):(c.cols||c.rows)&&r.row>=0&&r.col>=0&&!l.cells?(h.setSelectedHeaders(!1,!1),h.setRangeEnd(new f.CellCoords(r.row,r.col))):c.cols&&r.row<0&&!l.column?h.setRangeEnd(new f.CellCoords(a.to.row,r.col)):c.rows&&r.col<0&&!l.row?h.setRangeEnd(new f.CellCoords(r.row,a.to.col)):(!c.cols&&!c.rows&&r.col<0||c.cols&&r.col<0)&&!l.row?(h.setSelectedHeaders(!0,!1),h.selectRows(a.from.row,r.row)):(!c.cols&&!c.rows&&r.row<0||c.rows&&r.row<0)&&!l.column&&(h.setSelectedHeaders(!1,!0),h.selectColumns(a.from.col,r.col));else{if(v=!0,a){var y=a.from,p=a.to,tt=!h.inInSelection(r);r.row<0&&c.cols?(k=Math.min(y.col,p.col),d=Math.max(y.col,p.col),v=r.col<k||r.col>d):r.col<0&&c.rows?(g=Math.min(y.row,p.row),nt=Math.max(y.row,p.row),v=r.row<g||r.row>nt):v=tt}w=e.isRightClick(i);b=e.isLeftClick(i)||i.type==="touchstart";r.row<0&&r.col>=0&&!l.column?(h.setSelectedHeaders(!1,!0),(b||w&&v)&&(h.setRangeStartOnly(new f.CellCoords(0,r.col)),h.setRangeEnd(new f.CellCoords(Math.max(n.countRows()-1,0),r.col)))):r.col<0&&r.row>=0&&!l.row?(h.setSelectedHeaders(!0,!1),(b||w&&v)&&(h.setRangeStartOnly(new f.CellCoords(r.row,0)),h.setRangeEnd(new f.CellCoords(r.row,Math.max(n.countCols()-1,0))))):r.col>=0&&r.row>=0&&!l.cells?(b||w&&v)&&(h.setSelectedHeaders(!1,!1),h.setRangeStart(r)):r.col<0&&r.row<0&&(r.row=0,r.col=0,h.setSelectedHeaders(!1,!1,!0),h.setRangeStart(r))}n.runHooks("afterOnCellMouseDown",i,r,o);t.activeWt=t.wt}},onCellMouseOut:function(i,r,u,f){(t.activeWt=f,n.runHooks("beforeOnCellMouseOut",i,r,u),e.isImmediatePropagationStopped(i))||(n.runHooks("afterOnCellMouseOut",i,r,u),t.activeWt=t.wt)},onCellMouseOver:function(i,r,o,s){var h={row:!1,column:!1,cell:!1};(t.activeWt=s,n.runHooks("beforeOnCellMouseOver",i,r,o,h),e.isImmediatePropagationStopped(i))||(e.isLeftClick(i)&&u&&(r.row>=0&&r.col>=0?n.selection.selectedHeader.cols&&!h.column?n.selection.setRangeEnd(new f.CellCoords(n.countRows()-1,r.col)):n.selection.selectedHeader.rows&&!h.row?n.selection.setRangeEnd(new f.CellCoords(r.row,n.countCols()-1)):h.cell||n.selection.setRangeEnd(r):n.selection.selectedHeader.cols&&!h.column?n.selection.setRangeEnd(new f.CellCoords(n.countRows()-1,r.col)):n.selection.selectedHeader.rows&&!h.row?n.selection.setRangeEnd(new f.CellCoords(r.row,n.countCols()-1)):h.cell||n.selection.setRangeEnd(r)),n.runHooks("afterOnCellMouseOver",i,r,o),t.activeWt=t.wt)},onCellMouseUp:function(i,r,u,f){t.activeWt=f;n.runHooks("beforeOnCellMouseUp",i,r,u);n.runHooks("afterOnCellMouseUp",i,r,u);t.activeWt=t.wt},onCellCornerMouseDown:function(t){t.preventDefault();n.runHooks("afterOnCellCornerMouseDown",t)},onCellCornerDblClick:function(t){t.preventDefault();n.runHooks("afterOnCellCornerDblClick",t)},beforeDraw:function(n,i){t.beforeRender(n,i)},onDraw:function(n){t.onDraw(n)},onScrollVertically:function(){n.runHooks("afterScrollVertically")},onScrollHorizontally:function(){n.runHooks("afterScrollHorizontally")},onBeforeDrawBorders:function(t,i){n.runHooks("beforeDrawBorders",t,i)},onBeforeTouchScroll:function(){n.runHooks("beforeTouchScroll")},onAfterMomentumScroll:function(){n.runHooks("afterMomentumScroll")},onBeforeStretchingColumnWidth:function(t,i){return n.runHooks("beforeStretchingColumnWidth",t,i)},onModifyRowHeaderWidth:function(t){return n.runHooks("modifyRowHeaderWidth",t)},onModifyGetCellCoords:function(t,i,r){return n.runHooks("modifyGetCellCoords",t,i,r)},viewportRowCalculatorOverride:function(i){var u=n.countRows(),r=t.settings.viewportRowRenderingOffset,e,f;r==="auto"&&t.settings.fixedRowsTop&&(r=10);typeof r=="number"&&(i.startRow=Math.max(i.startRow-r,0),i.endRow=Math.min(i.endRow+r,u-1));r==="auto"&&(e=i.startRow+i.endRow-i.startRow,f=Math.ceil(e/u*12),i.startRow=Math.max(i.startRow-f,0),i.endRow=Math.min(i.endRow+f,u-1));n.runHooks("afterViewportRowCalculatorOverride",i)},viewportColumnCalculatorOverride:function(i){var u=n.countCols(),r=t.settings.viewportColumnRenderingOffset,e,f;r==="auto"&&t.settings.fixedColumnsLeft&&(r=10);typeof r=="number"&&(i.startColumn=Math.max(i.startColumn-r,0),i.endColumn=Math.min(i.endColumn+r,u-1));r==="auto"&&(e=i.startColumn+i.endColumn-i.startColumn,f=Math.ceil(e/u*12),i.startRow=Math.max(i.startColumn-f,0),i.endColumn=Math.min(i.endColumn+f,u-1));n.runHooks("afterViewportColumnCalculatorOverride",i)},rowHeaderWidth:function(){return t.settings.rowHeaderWidth},columnHeaderHeight:function(){var i=n.runHooks("modifyColumnHeaderHeight");return t.settings.columnHeaderHeight||i}};n.runHooks("beforeInitWalkontable",c);this.wt=new a.default(c);this.activeWt=this.wt;o.isChrome()||o.isSafari()||this.eventManager.addEventListener(n.rootElement,"wheel",function(n){var e=parseInt(r.getComputedStyle(document.body)["font-size"],10),i=t.wt.wtOverlays.scrollableElement,u,f;i!==window&&n.preventDefault();u=-1*n.wheelDeltaY||n.deltaY;f=-1*n.wheelDeltaX||n.deltaX;switch(n.deltaMode){case 0:i.scrollLeft+=f;i.scrollTop+=u;break;case 1:i.scrollLeft+=f*e;i.scrollTop+=u*e}});this.eventManager.addEventListener(t.wt.wtTable.spreader,"mousedown",function(n){n.target===t.wt.wtTable.spreader&&n.which===3&&e.stopPropagation(n)});this.eventManager.addEventListener(t.wt.wtTable.spreader,"contextmenu",function(n){n.target===t.wt.wtTable.spreader&&n.which===3&&e.stopPropagation(n)});this.eventManager.addEventListener(document.documentElement,"click",function(){t.settings.observeDOMVisibility&&t.wt.drawInterrupted&&(t.instance.forceFullRender=!0,t.render())})}t.__esModule=!0;var h=function(){function n(n,t){var r=[],u=!0,f=!1,e=undefined,i,o;try{for(i=n[Symbol.iterator]();!(u=(o=i.next()).done);u=!0)if(r.push(o.value),t&&r.length===t)break}catch(s){f=!0;e=s}finally{try{!u&&i["return"]&&i["return"]()}finally{if(f)throw e;}}return r}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return n(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance");}}(),r=i(2),o=i(33),c=i(9),l=s(c),e=i(11),f=i(8),a=s(f);u.prototype.isTextSelectionAllowed=function(n){if(r.isInput(n))return!0;var t=r.isChildOf(n,this.instance.view.wt.wtTable.spreader);return this.settings.fragmentSelection===!0&&t?!0:this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&t?!0:!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell()?!0:!1};u.prototype.isSelectedOnlyCell=function(){var i=this.instance.getSelectedLast()||[],n=h(i,4),t=n[0],r=n[1],u=n[2],f=n[3];return t!==void 0&&t===u&&r===f};u.prototype.isCellEdited=function(){var n=this.instance.getActiveEditor();return n&&n.isOpened()};u.prototype.beforeRender=function(n,t){n&&this.instance.runHooks("beforeRender",this.instance.forceFullRender,t)};u.prototype.onDraw=function(n){n&&this.instance.runHooks("afterRender",this.instance.forceFullRender)};u.prototype.render=function(){this.wt.draw(!this.instance.forceFullRender);this.instance.forceFullRender=!1;this.instance.renderCall=!1};u.prototype.getCellAtCoords=function(n,t){var i=this.wt.getCell(n,t);return i<0?null:i};u.prototype.scrollViewport=function(n){this.wt.scrollViewport(n)};u.prototype.appendRowHeader=function(n,t){var f,i,u;if(t.firstChild){if(f=t.firstChild,!r.hasClass(f,"relative")){r.empty(t);this.appendRowHeader(n,t);return}this.updateCellHeader(f.querySelector(".rowHeader"),n,this.instance.getRowHeader)}else i=document.createElement("div"),u=document.createElement("span"),i.className="relative",u.className="rowHeader",this.updateCellHeader(u,n,this.instance.getRowHeader),i.appendChild(u),t.appendChild(i);this.instance.runHooks("afterGetRowHeader",n,t)};u.prototype.appendColHeader=function(n,t){var f,i,u;t.firstChild?(f=t.firstChild,r.hasClass(f,"relative")?this.updateCellHeader(f.querySelector(".colHeader"),n,this.instance.getColHeader):(r.empty(t),this.appendColHeader(n,t))):(i=document.createElement("div"),u=document.createElement("span"),i.className="relative",u.className="colHeader",this.updateCellHeader(u,n,this.instance.getColHeader),i.appendChild(u),t.appendChild(i));this.instance.runHooks("afterGetColHeader",n,t)};u.prototype.updateCellHeader=function(n,t,i){var u=t,f=this.wt.wtOverlays.getParentOverlay(n)||this.wt;n.parentNode&&(r.hasClass(n,"colHeader")?u=f.wtTable.columnFilter.sourceToRendered(t):r.hasClass(n,"rowHeader")&&(u=f.wtTable.rowFilter.sourceToRendered(t)));u>-1?r.fastInnerHTML(n,i(t)):(r.fastInnerText(n,String.fromCharCode(160)),r.addClass(n,"cornerHeader"))};u.prototype.maximumVisibleElementWidth=function(n){var i=this.wt.wtViewport.getWorkspaceWidth(),t=i-n;return t>0?t:0};u.prototype.maximumVisibleElementHeight=function(n){var i=this.wt.wtViewport.getWorkspaceHeight(),t=i-n;return t>0?t:0};u.prototype.mainViewIsActive=function(){return this.wt===this.activeWt};u.prototype.destroy=function(){this.wt.destroy();this.eventManager.destroy()};t.default=u},function(n,t,i){"use strict";function s(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var f;t.__esModule=!0;var e=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),r=i(1),o=i(0),u=i(4);f=function(){function n(t){var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];s(this,n);this.hot=t;this.data=i;this.dataType="array";this.colToProp=function(){};this.propToCol=function(){}}return e(n,[{key:"getData",value:function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:!1,n=this.data;return t&&(n=this.getByRange({row:0,col:0},{row:Math.max(this.countRows()-1,0),col:Math.max(this.countColumns()-1,0)},!0)),n}},{key:"setData",value:function(n){this.data=n}},{key:"getAtColumn",value:function(n){var i=this,t=[];return o.arrayEach(this.data,function(u){var f=i.colToProp(n);u=typeof f=="string"?r.getProperty(u,f):u[f];t.push(u)}),t}},{key:"getAtRow",value:function(n){return this.data[n]}},{key:"getAtCell",value:function(n,t){var f=null,e=this.hot.runHooks("modifyRowData",n),u=isNaN(e)?e:this.data[n],i;return u&&(i=this.colToProp(t),f=typeof i=="string"?r.getProperty(u,i):typeof i=="function"?i(this.data.slice(n,n+1)[0]):u[i]),f}},{key:"getByRange",value:function(n,t){var i=this,r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:!1,s=Math.min(n.row,t.row),f=Math.min(n.col,t.col),h=Math.max(n.row,t.row),e=Math.max(n.col,t.col),o=[];return u.rangeEach(s,h,function(n){var s=i.getAtRow(n),t=void 0;i.dataType==="array"?t=s.slice(f,e+1):i.dataType==="object"&&(t=r?[]:{},u.rangeEach(f,e,function(n){var u=i.colToProp(n);r?t.push(s[u]):t[u]=s[u]}));o.push(t)}),o}},{key:"countRows",value:function(){return Array.isArray(this.data)?this.data.length:0}},{key:"countColumns",value:function(){var n=0;return Array.isArray(this.data)&&(this.dataType==="array"?n=this.data[0].length:this.dataType==="object"&&(n=Object.keys(this.data[0]).length)),n}},{key:"destroy",value:function(){this.data=null;this.hot=null}}]),n}();t.default=f},function(n,t,i){"use strict";function s(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function f(n,t,i){return t in n?Object.defineProperty(n,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[t]=i,n}var r,e,u,o;t.__esModule=!0;e=i(3);u=s(e);
/**
                                                                                                                                                                                                                   * @preserve
                                                                                                                                                                                                                   * Authors: Handsoncode
                                                                                                                                                                                                                   * Last updated: Nov 15, 2017
                                                                                                                                                                                                                   *
                                                                                                                                                                                                                   * Description: Definition file for English - United States language-country.
                                                                                                                                                                                                                   */
o=(r={languageCode:"en-US"},f(r,u.CONTEXTMENU_ITEMS_ROW_ABOVE,"Insert row above"),f(r,u.CONTEXTMENU_ITEMS_ROW_BELOW,"Insert row below"),f(r,u.CONTEXTMENU_ITEMS_INSERT_LEFT,"Insert column left"),f(r,u.CONTEXTMENU_ITEMS_INSERT_RIGHT,"Insert column right"),f(r,u.CONTEXTMENU_ITEMS_REMOVE_ROW,["Remove row","Remove rows"]),f(r,u.CONTEXTMENU_ITEMS_REMOVE_COLUMN,["Remove column","Remove columns"]),f(r,u.CONTEXTMENU_ITEMS_UNDO,"Undo"),f(r,u.CONTEXTMENU_ITEMS_REDO,"Redo"),f(r,u.CONTEXTMENU_ITEMS_READ_ONLY,"Read only"),f(r,u.CONTEXTMENU_ITEMS_CLEAR_COLUMN,"Clear column"),f(r,u.CONTEXTMENU_ITEMS_ALIGNMENT,"Alignment"),f(r,u.CONTEXTMENU_ITEMS_ALIGNMENT_LEFT,"Left"),f(r,u.CONTEXTMENU_ITEMS_ALIGNMENT_CENTER,"Center"),f(r,u.CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT,"Right"),f(r,u.CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY,"Justify"),f(r,u.CONTEXTMENU_ITEMS_ALIGNMENT_TOP,"Top"),f(r,u.CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE,"Middle"),f(r,u.CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM,"Bottom"),f(r,u.CONTEXTMENU_ITEMS_FREEZE_COLUMN,"Freeze column"),f(r,u.CONTEXTMENU_ITEMS_UNFREEZE_COLUMN,"Unfreeze column"),f(r,u.CONTEXTMENU_ITEMS_BORDERS,"Borders"),f(r,u.CONTEXTMENU_ITEMS_BORDERS_TOP,"Top"),f(r,u.CONTEXTMENU_ITEMS_BORDERS_RIGHT,"Right"),f(r,u.CONTEXTMENU_ITEMS_BORDERS_BOTTOM,"Bottom"),f(r,u.CONTEXTMENU_ITEMS_BORDERS_LEFT,"Left"),f(r,u.CONTEXTMENU_ITEMS_REMOVE_BORDERS,"Remove border(s)"),f(r,u.CONTEXTMENU_ITEMS_ADD_COMMENT,"Add comment"),f(r,u.CONTEXTMENU_ITEMS_EDIT_COMMENT,"Edit comment"),f(r,u.CONTEXTMENU_ITEMS_REMOVE_COMMENT,"Delete comment"),f(r,u.CONTEXTMENU_ITEMS_READ_ONLY_COMMENT,"Read-only comment"),f(r,u.CONTEXTMENU_ITEMS_MERGE_CELLS,"Merge cells"),f(r,u.CONTEXTMENU_ITEMS_UNMERGE_CELLS,"Unmerge cells"),f(r,u.CONTEXTMENU_ITEMS_COPY,"Copy"),f(r,u.CONTEXTMENU_ITEMS_CUT,"Cut"),f(r,u.CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD,"Insert child row"),f(r,u.CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD,"Detach from parent"),f(r,u.CONTEXTMENU_ITEMS_HIDE_COLUMN,["Hide column","Hide columns"]),f(r,u.CONTEXTMENU_ITEMS_SHOW_COLUMN,["Show column","Show columns"]),f(r,u.CONTEXTMENU_ITEMS_HIDE_ROW,["Hide row","Hide rows"]),f(r,u.CONTEXTMENU_ITEMS_SHOW_ROW,["Show row","Show rows"]),f(r,u.FILTERS_CONDITIONS_NONE,"None"),f(r,u.FILTERS_CONDITIONS_EMPTY,"Is empty"),f(r,u.FILTERS_CONDITIONS_NOT_EMPTY,"Is not empty"),f(r,u.FILTERS_CONDITIONS_EQUAL,"Is equal to"),f(r,u.FILTERS_CONDITIONS_NOT_EQUAL,"Is not equal to"),f(r,u.FILTERS_CONDITIONS_BEGINS_WITH,"Begins with"),f(r,u.FILTERS_CONDITIONS_ENDS_WITH,"Ends with"),f(r,u.FILTERS_CONDITIONS_CONTAINS,"Contains"),f(r,u.FILTERS_CONDITIONS_NOT_CONTAIN,"Does not contain"),f(r,u.FILTERS_CONDITIONS_GREATER_THAN,"Greater than"),f(r,u.FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL,"Greater than or equal to"),f(r,u.FILTERS_CONDITIONS_LESS_THAN,"Less than"),f(r,u.FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL,"Less than or equal to"),f(r,u.FILTERS_CONDITIONS_BETWEEN,"Is between"),f(r,u.FILTERS_CONDITIONS_NOT_BETWEEN,"Is not between"),f(r,u.FILTERS_CONDITIONS_AFTER,"After"),f(r,u.FILTERS_CONDITIONS_BEFORE,"Before"),f(r,u.FILTERS_CONDITIONS_TODAY,"Today"),f(r,u.FILTERS_CONDITIONS_TOMORROW,"Tomorrow"),f(r,u.FILTERS_CONDITIONS_YESTERDAY,"Yesterday"),f(r,u.FILTERS_VALUES_BLANK_CELLS,"Blank cells"),f(r,u.FILTERS_DIVS_FILTER_BY_CONDITION,"Filter by condition"),f(r,u.FILTERS_DIVS_FILTER_BY_VALUE,"Filter by value"),f(r,u.FILTERS_LABELS_CONJUNCTION,"And"),f(r,u.FILTERS_LABELS_DISJUNCTION,"Or"),f(r,u.FILTERS_BUTTONS_SELECT_ALL,"Select all"),f(r,u.FILTERS_BUTTONS_CLEAR,"Clear"),f(r,u.FILTERS_BUTTONS_OK,"OK"),f(r,u.FILTERS_BUTTONS_CANCEL,"Cancel"),f(r,u.FILTERS_BUTTONS_PLACEHOLDER_SEARCH,"Search"),f(r,u.FILTERS_BUTTONS_PLACEHOLDER_VALUE,"Value"),f(r,u.FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE,"Second value"),r);t.default=o},function(n,t,i){"use strict";function u(n){return n&&n.__esModule?n:{"default":n}}function r(n,t){l(n,t)}function e(){return a()}t.__esModule=!0;t.getPhraseFormatters=t.registerPhraseFormatter=undefined;t.register=r;t.getAll=e;var o=i(48),s=u(o),h=i(299),c=u(h);var f=s.default("phraseFormatters"),l=f.register,a=f.getValues;t.registerPhraseFormatter=r;t.getPhraseFormatters=e;r("pluralize",c.default)},function(n,t){"use strict";function i(n,t){var i=Array.isArray(n)&&Number.isInteger(t);return i?n[t]:n}t.__esModule=!0;t.default=i},function(n,t,i){"use strict";function r(n){return n&&n.__esModule?n:{"default":n}}t.__esModule=!0;t.Selection=t.Highlight=undefined;var u=i(211),f=r(u),e=i(306),o=r(e);t.Highlight=f.default;t.Selection=o.default},function(n,t,i){"use strict";function r(n){return n&&n.__esModule?n:{"default":n}}function b(n,t){return w(n)(t)}t.__esModule=!0;t.createHighlight=undefined;var e=i(48),o=r(e),s=i(302),h=r(s),c=i(303),l=r(c),a=i(304),v=r(a),y=i(305),p=r(y);var u=o.default("highlight/types"),f=u.register,w=u.getItem,k=u.hasItem,d=u.getNames,g=u.getValues;f("area",h.default);f("cell",l.default);f("fill",v.default);f("header",p.default);t.createHighlight=b},function(n,t,i){"use strict";function u(n){var t=n.layerLevel,f=n.cornerVisible,i=n.multipleSelectionHandlesVisible,u=n.areaCornerVisible;return new r.Selection({className:"area",markIntersections:!0,layerLevel:Math.min(t,7),border:{width:1,color:"#4b89ff",cornerVisible:u,multipleSelectionHandlesVisible:i}})}t.__esModule=!0;var r=i(8);t.default=u},function(n,t,i){"use strict";function u(n){var u=n.cornerVisible,t=n.multipleSelectionHandlesVisible,i=n.cellCornerVisible;return new r.Selection({className:"current",border:{width:2,color:"#4b89ff",cornerVisible:i,multipleSelectionHandlesVisible:t}})}t.__esModule=!0;var r=i(8);t.default=u},function(n,t,i){"use strict";function u(){return new r.Selection({className:"fill",border:{width:1,color:"#ff0000"}})}t.__esModule=!0;var r=i(8);t.default=u},function(n,t,i){"use strict";function u(n){var t=n.headerClassName,i=n.rowClassName,u=n.columnClassName;return new r.Selection({className:"highlight",highlightHeaderClassName:t,highlightRowClassName:i,highlightColumnClassName:u})}t.__esModule=!0;var r=i(8);t.default=u},function(n,t,i){"use strict";function o(n){return n&&n.__esModule?n:{"default":n}}function it(n,t){return Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(t)}}))}function rt(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var h;t.__esModule=!0;var c=function(){function n(n,t){var r=[],u=!0,f=!1,e=undefined,i,o;try{for(i=n[Symbol.iterator]();!(u=(o=i.next()).done);u=!0)if(r.push(o.value),t&&r.length===t)break}catch(s){f=!0;e=s}finally{try{!u&&i["return"]&&i["return"]()}finally{if(f)throw e;}}return r}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return n(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance");}}(),v=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),y=it(["Unsupported format of the selection ranges was passed. To select cells pass \n        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd, columnEnd/columnPropEnd]]) \n        or as an array of CellRange objects."],["Unsupported format of the selection ranges was passed. To select cells pass\\x20\n        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd, columnEnd/columnPropEnd]])\\x20\n        or as an array of CellRange objects."]),f=i(211),p=o(f),w=i(307),b=o(w),u=i(8),l=i(210),a=i(1),e=i(13),s=i(0),k=i(21),d=o(k),g=i(308),nt=o(g),r=i(154),tt=i(34);h=function(){function n(t,i){var r=this;rt(this,n);this.settings=t;this.tableProps=i;this.inProgress=!1;this.selectedHeader={cols:!1,rows:!1,corner:!1};this.selectedRange=new b.default;this.highlight=new p.default({headerClassName:t.currentHeaderClassName,rowClassName:t.currentRowClassName,columnClassName:t.currentColClassName,disableHighlight:this.settings.disableVisualSelection,cellCornerVisible:function(){return r.isCellCornerVisible.apply(r,arguments)},areaCornerVisible:function(){return r.isAreaCornerVisible.apply(r,arguments)}});this.transformation=new nt.default(this.selectedRange,{countRows:function(){return r.tableProps.countRows()},countCols:function(){return r.tableProps.countCols()},fixedRowsBottom:function(){return t.fixedRowsBottom},minSpareRows:function(){return t.minSpareRows},minSpareCols:function(){return t.minSpareCols},autoWrapRow:function(){return t.autoWrapRow},autoWrapCol:function(){return t.autoWrapCol}});this.transformation.addLocalHook("beforeTransformStart",function(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];return r.runLocalHooks.apply(r,["beforeModifyTransformStart"].concat(i))});this.transformation.addLocalHook("afterTransformStart",function(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];return r.runLocalHooks.apply(r,["afterModifyTransformStart"].concat(i))});this.transformation.addLocalHook("beforeTransformEnd",function(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];return r.runLocalHooks.apply(r,["beforeModifyTransformEnd"].concat(i))});this.transformation.addLocalHook("afterTransformEnd",function(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];return r.runLocalHooks.apply(r,["afterModifyTransformEnd"].concat(i))});this.transformation.addLocalHook("insertRowRequire",function(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];return r.runLocalHooks.apply(r,["insertRowRequire"].concat(i))});this.transformation.addLocalHook("insertColRequire",function(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];return r.runLocalHooks.apply(r,["insertColRequire"].concat(i))})}return v(n,[{key:"getSelectedRange",value:function(){return this.selectedRange}},{key:"setSelectedHeaders",value:function(){var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:!1,t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!1,i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:!1;this.selectedHeader.rows=n;this.selectedHeader.cols=t;this.selectedHeader.corner=i}},{key:"begin",value:function(){this.inProgress=!0}},{key:"finish",value:function(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange));this.inProgress=!1}},{key:"isInProgress",value:function(){return this.inProgress}},{key:"setRangeStart",value:function(n,t){var i=this.settings.selectionMode==="multiple",r=e.isUndefined(t)?l.isPressedCtrlKey():t;this.runLocalHooks("beforeSetRangeStart",n);(!i||i&&!r&&e.isUndefined(t))&&this.selectedRange.clear();this.selectedRange.add(n);this.setRangeEnd(n)}},{key:"setRangeStartOnly",value:function(n,t){var i=this.settings.selectionMode==="multiple",r=e.isUndefined(t)?l.isPressedCtrlKey():t;this.runLocalHooks("beforeSetRangeStartOnly",n);(!i||i&&!r&&e.isUndefined(t))&&this.selectedRange.clear();this.selectedRange.add(n)}},{key:"setRangeEnd",value:function(n){var t,i,e,r;this.selectedRange.isEmpty()||(this.runLocalHooks("beforeSetRangeEnd",n),this.begin(),t=this.selectedRange.current(),this.settings.selectionMode!=="single"&&t.setTo(new u.CellCoords(n.row,n.col)),this.highlight.getCell().clear(),this.highlight.isEnabledFor(f.CELL_TYPE)&&this.highlight.getCell().add(this.selectedRange.current().highlight),i=this.selectedRange.size()-1,i<this.highlight.layerLevel&&(s.arrayEach(this.highlight.getAreas(),function(n){n.clear()}),s.arrayEach(this.highlight.getHeaders(),function(n){n.clear()})),this.highlight.useLayerLevel(i),e=this.highlight.createOrGetArea(),r=this.highlight.createOrGetHeader(),e.clear(),r.clear(),this.highlight.isEnabledFor(f.AREA_TYPE)&&(this.isMultiple()||i>=1)&&(e.add(t.from).add(t.to),i===1&&(this.highlight.useLayerLevel(i-1).createOrGetArea().add(this.selectedRange.previous().from),this.highlight.useLayerLevel(i))),this.highlight.isEnabledFor(f.HEADER_TYPE)&&(this.settings.selectionMode==="single"?r.add(t.highlight):r.add(t.from).add(t.to)),this.runLocalHooks("afterSetRangeEnd",n))}},{key:"isMultiple",value:function(){var n=a.createObjectPropListener(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",n),n.value}},{key:"transformStart",value:function(n,t,i){var r=this.transformation.transformStart(n,t,i);this.setRangeStart(r)}},{key:"transformEnd",value:function(n,t){var i=this.transformation.transformEnd(n,t);this.setRangeEnd(i)}},{key:"isSelected",value:function(){return!this.selectedRange.isEmpty()}},{key:"inInSelection",value:function(n){return this.selectedRange.includes(n)}},{key:"isCellCornerVisible",value:function(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}},{key:"isAreaCornerVisible",value:function(n){return n!==this.selectedRange.ranges.length-1?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}},{key:"clear",value:function(){this.selectedRange.clear();this.highlight.clear()}},{key:"deselect",value:function(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}},{key:"selectAll",value:function(){this.settings.selectionMode!=="single"&&(this.clear(),this.setSelectedHeaders(!0,!0,!0),this.setRangeStart(new u.CellCoords(0,0)),this.setRangeEnd(new u.CellCoords(this.tableProps.countRows()-1,this.tableProps.countCols()-1)))}},{key:"selectCells",value:function(n){var t=this,i=r.detectSelectionType(n);if(i===r.SELECTION_TYPE_EMPTY)return!1;if(i===r.SELECTION_TYPE_UNRECOGNIZED)throw new Error(tt.toSingleLine(y));var f=r.normalizeSelectionFactory(i,{propToCol:function(n){return t.tableProps.propToCol(n)},keepDirection:!0}),e=this.tableProps.countRows(),o=this.tableProps.countCols(),h=!n.some(function(n){var i=f(n),t=c(i,4),u=t[0],s=t[1],h=t[2],l=t[3],a=r.isValidCoord(u,e)&&r.isValidCoord(s,o)&&r.isValidCoord(h,e)&&r.isValidCoord(l,o);return!a});return h&&(this.clear(),s.arrayEach(n,function(n){var r=f(n),i=c(r,4),e=i[0],o=i[1],s=i[2],h=i[3];t.setRangeStartOnly(new u.CellCoords(e,o),!1);t.setRangeEnd(new u.CellCoords(s,h));t.finish()})),h}},{key:"selectColumns",value:function(n){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:n,i,f;return n=typeof n=="string"?this.tableProps.propToCol(n):n,t=typeof t=="string"?this.tableProps.propToCol(t):t,i=this.tableProps.countCols(),f=r.isValidCoord(n,i)&&r.isValidCoord(t,i),f&&(this.clear(),this.setSelectedHeaders(!1,!0,!1),this.setRangeStartOnly(new u.CellCoords(0,n)),this.setRangeEnd(new u.CellCoords(this.tableProps.countRows()-1,t)),this.finish()),f}},{key:"selectRows",value:function(n){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:n,i=this.tableProps.countRows(),f=r.isValidCoord(n,i)&&r.isValidCoord(t,i);return f&&(this.clear(),this.setSelectedHeaders(!0,!1,!1),this.setRangeStartOnly(new u.CellCoords(n,0)),this.setRangeEnd(new u.CellCoords(t,this.tableProps.countCols()-1)),this.finish()),f}}]),n}();a.mixin(h,d.default);t.default=h},function(n,t,i){"use strict";function e(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var u,r,f;t.__esModule=!0;u=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}();r=i(8);f=function(){function n(){e(this,n);this.ranges=[]}return u(n,[{key:"isEmpty",value:function(){return this.size()===0}},{key:"set",value:function(n){return this.clear(),this.ranges.push(new r.CellRange(n)),this}},{key:"add",value:function(n){return this.ranges.push(new r.CellRange(n)),this}},{key:"current",value:function(){return this.peekByIndex(0)}},{key:"previous",value:function(){return this.peekByIndex(-1)}},{key:"includes",value:function(n){return this.ranges.some(function(t){return t.includes(n)})}},{key:"clear",value:function(){return this.ranges.length=0,this}},{key:"size",value:function(){return this.ranges.length}},{key:"peekByIndex",value:function(){var i=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0,n=this.size()+i-1,t=void 0;return n>=0&&(t=this.ranges[n]),t}},{key:Symbol.iterator,value:function(){return this.ranges[Symbol.iterator]()}}]),n}();t.default=f},function(n,t,i){"use strict";function h(n){return n&&n.__esModule?n:{"default":n}}function c(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var u;t.__esModule=!0;var f=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),r=i(8),e=i(1),o=i(21),s=h(o);u=function(){function n(t,i){c(this,n);this.range=t;this.options=i}return f(n,[{key:"transformStart",value:function(n,t,i){var u=new r.CellCoords(n,t);this.runLocalHooks("beforeTransformStart",u);var e=this.options.countRows(),s=this.options.countCols(),l=this.options.fixedRowsBottom(),y=this.options.minSpareRows(),p=this.options.minSpareCols(),a=this.options.autoWrapRow(),v=this.options.autoWrapCol(),f=this.range.current().highlight;f.row+n>e-1?i&&y>0&&!(l&&f.row>=e-l-1)?(this.runLocalHooks("insertRowRequire",e),e=this.options.countRows()):v&&(u.row=1-e,u.col=f.col+u.col==s-1?1-s:1):v&&f.row+u.row<0&&f.col+u.col>=0&&(u.row=e-1,u.col=f.col+u.col==0?s-1:-1);f.col+u.col>s-1?i&&p>0?(this.runLocalHooks("insertColRequire",e),s=this.options.countCols()):a&&(u.row=f.row+u.row==e-1?1-e:1,u.col=1-s):a&&f.col+u.col<0&&f.row+u.row>=0&&(u.row=f.row+u.row==0?e-1:-1,u.col=s-1);var o=new r.CellCoords(f.row+u.row,f.col+u.col),h=0,c=0;return o.row<0?(h=-1,o.row=0):o.row>0&&o.row>=e&&(h=1,o.row=e-1),o.col<0?(c=-1,o.col=0):o.col>0&&o.col>=s&&(c=1,o.col=s-1),this.runLocalHooks("afterTransformStart",o,h,c),o}},{key:"transformEnd",value:function(n,t){var u=new r.CellCoords(n,t);this.runLocalHooks("beforeTransformEnd",u);var o=this.options.countRows(),s=this.options.countCols(),h=this.range.current(),i=new r.CellCoords(h.to.row+u.row,h.to.col+u.col),f=0,e=0;return i.row<0?(f=-1,i.row=0):i.row>0&&i.row>=o&&(f=1,i.row=o-1),i.col<0?(e=-1,i.col=0):i.col>0&&i.col>=s&&(e=1,i.col=s-1),this.runLocalHooks("afterTransformEnd",i,f,e),i}}]),n}();e.mixin(u,s.default);t.default=u},function(n,t){"use strict";function i(n){var t=typeof window=="undefined"?!1:window.jQuery;t&&(t.fn.handsontable=function(t){var r=this.first(),i=r.data("handsontable"),f,e,o,u,s;if(typeof t!="string")return f=t||{},i?i.updateSettings(f):(i=new n.Core(r[0],f),r.data("handsontable",i),i.init()),r;if(e=[],o=void 0,arguments.length>1)for(u=1,s=arguments.length;u<s;u++)e.push(arguments[u]);if(i)if(typeof i[t]!="undefined")o=i[t].apply(i,e),t==="destroy"&&r.removeData();else throw new Error("Handsontable do not provide action: "+t);return o})}t.__esModule=!0;t.default=i},function(n,t,i){"use strict";function r(n){return n&&n.__esModule?n:{"default":n}}t.__esModule=!0;t.Base=t.UndoRedo=t.TouchScroll=t.Search=t.PersistentState=t.ObserveChanges=t.MultipleSelectionHandles=t.MergeCells=t.ManualRowResize=t.ManualRowMove=t.ManualColumnResize=t.ManualColumnMove=t.ManualColumnFreeze=t.DragToScroll=t.CustomBorders=t.CopyPaste=t.ContextMenu=t.Comments=t.ColumnSorting=t.AutoRowSize=t.AutoFill=t.AutoColumnSize=undefined;var u=i(311),f=r(u),e=i(313),o=r(e),s=i(314),h=r(s),c=i(316),l=r(c),a=i(317),v=r(a),y=i(320),p=r(y),w=i(324),b=r(w),k=i(338),d=r(k),g=i(345),nt=r(g),tt=i(346),it=r(tt),rt=i(347),ut=r(rt),ft=i(351),et=r(ft),ot=i(356),st=r(ot),ht=i(357),ct=r(ht),lt=i(362),at=r(lt),vt=i(363),yt=r(vt),pt=i(369),wt=r(pt),bt=i(370),kt=r(bt),dt=i(373),gt=r(dt),ni=i(374),ti=r(ni),ii=i(375),ri=r(ii),ui=i(7),fi=r(ui);t.AutoColumnSize=o.default;t.AutoFill=h.default;t.AutoRowSize=l.default;t.ColumnSorting=v.default;t.Comments=p.default;t.ContextMenu=b.default;t.CopyPaste=d.default;t.CustomBorders=nt.default;t.DragToScroll=it.default;t.ManualColumnFreeze=ut.default;t.ManualColumnMove=et.default;t.ManualColumnResize=st.default;t.ManualRowMove=ct.default;t.ManualRowResize=at.default;t.MergeCells=yt.default;t.MultipleSelectionHandles=wt.default;t.ObserveChanges=kt.default;t.PersistentState=f.default;t.Search=gt.default;t.TouchScroll=ti.default;t.UndoRedo=ri.default;t.Base=fi.default},function(n,t,i){"use strict";function f(n){return n&&n.__esModule?n:{"default":n}}function p(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function w(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function b(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var e;t.__esModule=!0;var o=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),r=function s(n,t,i){var r,u,f;return n===null&&(n=Function.prototype),r=Object.getOwnPropertyDescriptor(n,t),r===undefined?(u=Object.getPrototypeOf(n),u===null?undefined:s(u,t,i)):"value"in r?r.value:(f=r.get,f===undefined)?undefined:f.call(i)},h=i(7),c=f(h),l=i(6),a=i(312),v=f(a),y=i(14),u=f(y);u.default.getSingleton().register("persistentStateSave");u.default.getSingleton().register("persistentStateLoad");u.default.getSingleton().register("persistentStateReset");e=function(n){function t(n){p(this,t);var i=w(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return i.storage=void 0,i}return b(t,n),o(t,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().persistentState}},{key:"enablePlugin",value:function(){var n=this;this.enabled||(this.storage||(this.storage=new v.default(this.hot.rootElement.id)),this.addHook("persistentStateSave",function(t,i){return n.saveValue(t,i)}),this.addHook("persistentStateLoad",function(t,i){return n.loadValue(t,i)}),this.addHook("persistentStateReset",function(){return n.resetValue()}),r(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.storage=void 0;r(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin();this.enablePlugin();r(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updatePlugin",this).call(this)}},{key:"loadValue",value:function(n,t){t.value=this.storage.loadValue(n)}},{key:"saveValue",value:function(n,t){this.storage.saveValue(n,t)}},{key:"resetValue",value:function(n){typeof n=="undefined"?this.storage.resetAll():this.storage.reset(n)}},{key:"destroy",value:function(){r(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}}]),t}(c.default);l.registerPlugin("persistentState",e);t.default=e},function(n,t,i){"use strict";function e(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var r,u,f;t.__esModule=!0;r=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}();u=i(0);f=function(){function n(t){e(this,n);this.prefix=t;this.savedKeys=[];this.loadSavedKeys()}return r(n,[{key:"saveValue",value:function(n,t){window.localStorage.setItem(this.prefix+"_"+n,JSON.stringify(t));this.savedKeys.indexOf(n)===-1&&(this.savedKeys.push(n),this.saveSavedKeys())}},{key:"loadValue",value:function(n,t){n=typeof n=="undefined"?t:n;var i=window.localStorage.getItem(this.prefix+"_"+n);if(i!==null)return JSON.parse(i)}},{key:"reset",value:function(n){window.localStorage.removeItem(this.prefix+"_"+n)}},{key:"resetAll",value:function(){var n=this;u.arrayEach(this.savedKeys,function(t,i){window.localStorage.removeItem(n.prefix+"_"+n.savedKeys[i])});this.clearSavedKeys()}},{key:"loadSavedKeys",value:function(){var n=window.localStorage.getItem(this.prefix+"__persistentStateKeys"),t=typeof n=="string"?JSON.parse(n):void 0;this.savedKeys=t?t:[]}},{key:"saveSavedKeys",value:function(){window.localStorage.setItem(this.prefix+"__persistentStateKeys",JSON.stringify(this.savedKeys))}},{key:"clearSavedKeys",value:function(){this.savedKeys.length=0;this.saveSavedKeys()}}]),n}();t.default=f},function(n,t,i){"use strict";function s(n){return n&&n.__esModule?n:{"default":n}}function rt(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function ut(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function ft(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var f,h;t.__esModule=!0;var a=function(){function n(n,t){var r=[],u=!0,f=!1,e=undefined,i,o;try{for(i=n[Symbol.iterator]();!(u=(o=i.next()).done);u=!0)if(r.push(o.value),t&&r.length===t)break}catch(s){f=!0;e=s}finally{try{!u&&i["return"]&&i["return"]()}finally{if(f)throw e;}}return r}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return n(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance");}}(),r=function v(n,t,i){var r,u,f;return n===null&&(n=Function.prototype),r=Object.getOwnPropertyDescriptor(n,t),r===undefined?(u=Object.getPrototypeOf(n),u===null?undefined:v(u,t,i)):"value"in r?r.value:(f=r.get,f===undefined)?undefined:f.call(i)},c=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),y=i(7),p=s(y),u=i(0),e=i(43),w=i(2),b=i(155),k=s(b),o=i(1),l=i(4),d=i(6),g=i(212),nt=s(g),tt=i(30),it=i(8);f=new WeakMap;h=function(n){function t(n){rt(this,t);var i=ut(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return f.set(i,{cachedColumnHeaders:[]}),i.widths=[],i.ghostTable=new k.default(i.hot),i.samplesGenerator=new nt.default(function(n,t){return i.hot.getCellMeta(n,t).spanned?"":i.hot.getDataAtCell(n,t)}),i.firstCalculation=!0,i.inProgress=!1,i.addHook("beforeColumnResize",function(n,t,r){return i.onBeforeColumnResize(n,t,r)}),i}return ft(t,n),c(t,null,[{key:"CALCULATION_STEP",get:function(){return 50}},{key:"SYNC_CALCULATION_LIMIT",get:function(){return 50}}]),c(t,[{key:"isEnabled",value:function(){return this.hot.getSettings().autoColumnSize!==!1&&!this.hot.getSettings().colWidths}},{key:"enablePlugin",value:function(){var n=this,i;this.enabled||(i=this.hot.getSettings().autoColumnSize,i&&i.useHeaders!=null&&this.ghostTable.setSetting("useHeaders",i.useHeaders),this.addHook("afterLoadData",function(){return n.onAfterLoadData()}),this.addHook("beforeChange",function(t){return n.onBeforeChange(t)}),this.addHook("beforeRender",function(t){return n.onBeforeRender(t)}),this.addHook("modifyColWidth",function(t,i){return n.getColumnWidth(i,t)}),this.addHook("afterInit",function(){return n.onAfterInit()}),r(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){var n=this.findColumnsWhereHeaderWasChanged();n.length&&this.clearCache(n);r(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){r(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disablePlugin",this).call(this)}},{key:"calculateColumnsWidth",value:function(){var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{from:0,to:this.hot.countCols()-1},t=this,i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{from:0,to:this.hot.countRows()-1},r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:!1;typeof n=="number"&&(n={from:n,to:n});typeof i=="number"&&(i={from:i,to:i});l.rangeEach(n.from,n.to,function(n){if(r||t.widths[n]===void 0&&!t.hot._getColWidthFromSettings(n)){var u=t.samplesGenerator.generateColumnSamples(n,i);u.forEach(function(n,i){return t.ghostTable.addColumn(i,n)})}});this.ghostTable.columns.length&&(this.ghostTable.getWidths(function(n,i){t.widths[n]=i}),this.ghostTable.clean())}},{key:"calculateAllColumnsWidth",value:function(){var n=this,o=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{from:0,to:this.hot.countRows()-1},i=0,r=this.hot.countCols()-1,u=null,f;this.inProgress=!0;f=function f(){if(!n.hot){e.cancelAnimationFrame(u);n.inProgress=!1;return}n.calculateColumnsWidth({from:i,to:Math.min(i+t.CALCULATION_STEP,r)},o);i=i+t.CALCULATION_STEP+1;i<r?u=e.requestAnimationFrame(f):(e.cancelAnimationFrame(u),n.inProgress=!1,n.hot.view.wt.wtOverlays.adjustElementsSize(!0),n.hot.view.wt.wtOverlays.leftOverlay.needFullRender&&n.hot.view.wt.wtOverlays.leftOverlay.clone.draw())};this.firstCalculation&&this.getSyncCalculationLimit()&&(this.calculateColumnsWidth({from:0,to:this.getSyncCalculationLimit()},o),this.firstCalculation=!1,i=this.getSyncCalculationLimit()+1);i<r?f():this.inProgress=!1}},{key:"setSamplingOptions",value:function(){var n=this.hot.getSettings().autoColumnSize,t=n&&o.hasOwnProperty(n,"samplingRatio")?this.hot.getSettings().autoColumnSize.samplingRatio:void 0,i=n&&o.hasOwnProperty(n,"allowSampleDuplicates")?this.hot.getSettings().autoColumnSize.allowSampleDuplicates:void 0;t&&!isNaN(t)&&this.samplesGenerator.setSampleCount(parseInt(t,10));i&&this.samplesGenerator.setAllowDuplicates(i)}},{key:"recalculateAllColumnsWidth",value:function(){this.hot.view&&w.isVisible(this.hot.view.wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllColumnsWidth())}},{key:"getSyncCalculationLimit",value:function(){var n=t.SYNC_CALCULATION_LIMIT,i=this.hot.countCols()-1;return o.isObject(this.hot.getSettings().autoColumnSize)&&(n=this.hot.getSettings().autoColumnSize.syncLimit,tt.isPercentValue(n)?n=l.valueAccordingPercent(i,n):n>>=0),Math.min(n,i)}},{key:"getColumnWidth",value:function(n){var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:void 0,r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:!0,t=i;return t===void 0&&(t=this.widths[n],r&&typeof t=="number"&&(t=Math.max(t,it.ViewportColumnsCalculator.DEFAULT_WIDTH))),t}},{key:"getFirstVisibleColumn",value:function(){var n=this.hot.view.wt;return n.wtViewport.columnsVisibleCalculator?n.wtTable.getFirstVisibleColumn():n.wtViewport.columnsRenderCalculator?n.wtTable.getFirstRenderedColumn():-1}},{key:"getLastVisibleColumn",value:function(){var n=this.hot.view.wt;return n.wtViewport.columnsVisibleCalculator?n.wtTable.getLastVisibleColumn():n.wtViewport.columnsRenderCalculator?n.wtTable.getLastRenderedColumn():-1}},{key:"findColumnsWhereHeaderWasChanged",value:function(){var t=this.hot.getColHeader(),i=f.get(this),n=i.cachedColumnHeaders;return u.arrayReduce(t,function(t,i,r){var u=n.length;return(u-1<r||n[r]!==i)&&t.push(r),u-1<r?n.push(i):n[r]=i,t},[])}},{key:"clearCache",value:function(){var t=this,n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];n.length?u.arrayEach(n,function(n){t.widths[n]=void 0}):this.widths.length=0}},{key:"isNeedRecalculate",value:function(){return!!u.arrayFilter(this.widths,function(n){return n===void 0}).length}},{key:"onBeforeRender",value:function(){var n=this.hot.renderCall,t=this.hot.countRows();t&&(this.calculateColumnsWidth({from:this.getFirstVisibleColumn(),to:this.getLastVisibleColumn()},void 0,n),this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllColumnsWidth())}},{key:"onAfterLoadData",value:function(){var n=this;this.hot.view?this.recalculateAllColumnsWidth():setTimeout(function(){n.hot&&n.recalculateAllColumnsWidth()},0)}},{key:"onBeforeChange",value:function(n){var t=this,i=u.arrayMap(n,function(n){var i=a(n,2),u=i[0],r=i[1];return t.hot.propToCol(r)});this.clearCache(i)}},{key:"onBeforeColumnResize",value:function(n,t,i){return i&&(this.calculateColumnsWidth(n,void 0,!0),t=this.getColumnWidth(n,void 0,!1)),t}},{key:"onAfterInit",value:function(){f.get(this).cachedColumnHeaders=this.hot.getColHeader()}},{key:"destroy",value:function(){this.ghostTable.clean();r(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}}]),t}(p.default);d.registerPlugin("autoColumnSize",h);t.default=h},function(n,t,i){"use strict";function o(n){return n&&n.__esModule?n:{"default":n}}function k(n){if(Array.isArray(n)){for(var t=0,i=Array(n.length);t<n.length;t++)i[t]=n[t];return i}return Array.from(n)}function d(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function g(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function nt(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}t.__esModule=!0;var c=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),u=function l(n,t,i){var r,u,f;return n===null&&(n=Function.prototype),r=Object.getOwnPropertyDescriptor(n,t),r===undefined?(u=Object.getPrototypeOf(n),u===null?undefined:l(u,t,i)):"value"in r?r.value:(f=r.get,f===undefined)?undefined:f.call(i)},a=i(7),v=o(a),y=i(14),s=o(y),f=i(2),p=i(9),w=o(p),b=i(6),e=i(8),r=i(315);s.default.getSingleton().register("modifyAutofillRange");s.default.getSingleton().register("beforeAutofill");var tt="insert_row",it=200,h=function(n){function t(n){d(this,t);var i=g(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return i.eventManager=new w.default(i),i.addingStarted=!1,i.mouseDownOnCellCorner=!1,i.mouseDragOutside=!1,i.handleDraggedCells=0,i.directions=[],i.autoInsertRow=!1,i}return nt(t,n),c(t,[{key:"isEnabled",value:function(){return this.hot.getSettings().fillHandle}},{key:"enablePlugin",value:function(){var n=this;this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",function(t){return n.onAfterCellCornerMouseDown(t)}),this.addHook("afterOnCellCornerDblClick",function(t){return n.onCellCornerDblClick(t)}),this.addHook("beforeOnCellMouseOver",function(t,i){return n.onBeforeCellMouseOver(i)}),u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin();this.enablePlugin();u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.clearMappedSettings();u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disablePlugin",this).call(this)}},{key:"getSelectionData",value:function(){var n={from:this.hot.getSelectedRangeLast().from,to:this.hot.getSelectedRangeLast().to};return this.hot.getData(n.from.row,n.from.col,n.to.row,n.to.col)}},{key:"fillIn",value:function(){var o,a,n,y,e,i,s,c,u,l;if(this.hot.selection.highlight.getFill().isEmpty())return!1;o=this.hot.selection.highlight.getFill().getCorners();this.resetSelectionOfDraggedArea();a=this.getCornersOfSelectedCells();o=this.hot.runHooks("modifyAutofillRange",o,a);var v=r.getDragDirectionAndRange(a,o),h=v.directionOfDrag,t=v.startOfDragCoords,f=v.endOfDragCoords;if(t&&t.row>-1&&t.col>-1){if(n=this.getSelectionData(),this.hot.runHooks("beforeAutofill",t,f,n),y=r.getDeltas(t,f,n,h),e=n,["up","left"].indexOf(h)>-1)if(e=[],i=null,s=null,h==="up")for(i=f.row-t.row+1,s=i%n.length,c=0;c<i;c++)e.push(n[(c+(n.length-s))%n.length]);else for(i=f.col-t.col+1,s=i%n[0].length,u=0;u<n.length;u++)for(e.push([]),l=0;l<i;l++)e[u].push(n[u][(l+(n[u].length-s))%n[u].length]);this.hot.populateFromArray(t.row,t.col,e,f.row,f.col,this.pluginName+".fill",null,h,y);this.setSelection(o)}else this.hot._refreshBorders();return!0}},{key:"reduceSelectionAreaIfNeeded",value:function(n){return n.row<0&&(n.row=0),n.col<0&&(n.col=0),n}},{key:"getCoordsOfDragAndDropBorders",value:function(n){var u=this.hot.getSelectedRangeLast().getTopLeftCorner(),t=this.hot.getSelectedRangeLast().getBottomRightCorner(),i=void 0;if(this.directions.includes(r.DIRECTIONS.vertical)&&(t.row<n.row||u.row>n.row))i=new e.CellCoords(n.row,t.col);else if(this.directions.includes(r.DIRECTIONS.horizontal))i=new e.CellCoords(t.row,n.col);else return;return this.reduceSelectionAreaIfNeeded(i)}},{key:"showBorder",value:function(n){var t=this.getCoordsOfDragAndDropBorders(n);t&&this.redrawBorders(t)}},{key:"addRow",value:function(){var n=this;this.hot._registerTimeout(setTimeout(function(){n.hot.alter(tt,void 0,1,n.pluginName+".fill");n.addingStarted=!1},it))}},{key:"addNewRowIfNeeded",value:function(){if(this.hot.selection.highlight.getFill().cellRange&&this.addingStarted===!1&&this.autoInsertRow){var t=this.hot.getSelectedLast(),i=this.hot.selection.highlight.getFill().getCorners(),n=this.hot.countRows();t[2]<n-1&&i[2]===n-1&&(this.addingStarted=!0,this.addRow())}}},{key:"getCornersOfSelectedCells",value:function(){return this.hot.selection.isMultiple()?this.hot.selection.highlight.createOrGetArea().getCorners():this.hot.selection.highlight.getCell().getCorners()}},{key:"getIndexOfLastAdjacentFilledInRow",value:function(n){for(var i,f,e,o,r=this.hot.getData(),s=this.hot.countRows(),u=void 0,t=n[2]+1;t<s;t++){for(i=n[1];i<=n[3];i++)if(f=r[t][i],f)return-1;e=r[t][n[1]-1];o=r[t][n[3]+1];!e&&!o||(u=t)}return u}},{key:"addSelectionFromStartAreaToSpecificRowIndex",value:function(n,t){this.hot.selection.highlight.getFill().clear().add(new e.CellCoords(n[0],n[1])).add(new e.CellCoords(t,n[3]))}},{key:"setSelection",value:function(n){var t;(t=this.hot).selectCell.apply(t,k(n).concat([!1,!1]))}},{key:"selectAdjacent",value:function(){var n=this.getCornersOfSelectedCells(),t=this.getIndexOfLastAdjacentFilledInRow(n);return t===-1?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(n,t),!0)}},{key:"resetSelectionOfDraggedArea",value:function(){this.handleDraggedCells=0;this.hot.selection.highlight.getFill().clear()}},{key:"redrawBorders",value:function(n){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(n);this.hot.view.render()}},{key:"getIfMouseWasDraggedOutside",value:function(n){var t=f.offset(this.hot.table).top-(window.pageYOffset||document.documentElement.scrollTop)+f.outerHeight(this.hot.table),i=f.offset(this.hot.table).left-(window.pageXOffset||document.documentElement.scrollLeft)+f.outerWidth(this.hot.table);return n.clientY>t&&n.clientX<=i}},{key:"registerEvents",value:function(){var n=this;this.eventManager.addEventListener(document.documentElement,"mouseup",function(){return n.onMouseUp()});this.eventManager.addEventListener(document.documentElement,"mousemove",function(t){return n.onMouseMove(t)})}},{key:"onCellCornerDblClick",value:function(){var n=this.selectAdjacent();n&&this.fillIn()}},{key:"onAfterCellCornerMouseDown",value:function(){this.handleDraggedCells=1;this.mouseDownOnCellCorner=!0}},{key:"onBeforeCellMouseOver",value:function(n){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells++,this.showBorder(n),this.addNewRowIfNeeded())}},{key:"onMouseUp",value:function(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}},{key:"onMouseMove",value:function(n){var t=this.getIfMouseWasDraggedOutside(n);this.addingStarted===!1&&this.handleDraggedCells>0&&t?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1;this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}},{key:"clearMappedSettings",value:function(){this.directions.length=0;this.autoInsertRow=!1}},{key:"mapSettings",value:function(){var n=r.getMappedFillHandleSetting(this.hot.getSettings().fillHandle);this.directions=n.directions;this.autoInsertRow=n.autoInsertRow}},{key:"destroy",value:function(){u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}}]),t}(v.default);b.registerPlugin("autofill",h);t.default=h},function(n,t,i){"use strict";function o(n,t,i,r){var s=i.length,h=i?i[0].length:0,e=[],y=t.row-n.row,p=t.col-n.col,o,u,f;if(["down","up"].indexOf(r)!==-1){for(o=[],u=0;u<=p;u++){var c=parseInt(i[0][u],10),l=parseInt(i[s-1][u],10),w=(r==="down"?l-c:c-l)/(s-1)||0;o.push(w)}e.push(o)}if(["right","left"].indexOf(r)!==-1)for(f=0;f<=y;f++){var a=parseInt(i[f][0],10),v=parseInt(i[f][h-1],10),b=(r==="right"?v-a:a-v)/(h-1)||0;e.push([b])}return e}function s(n,t){var i=void 0,u=void 0,f=void 0;return t[0]===n[0]&&t[1]<n[1]?(f="left",i=new r.CellCoords(t[0],t[1]),u=new r.CellCoords(t[2],n[1]-1)):t[2]===n[2]&&t[0]===n[0]&&t[3]>n[3]?(f="right",i=new r.CellCoords(t[0],n[3]+1),u=new r.CellCoords(t[2],t[3])):t[0]<n[0]&&t[1]===n[1]?(f="up",i=new r.CellCoords(t[0],t[1]),u=new r.CellCoords(n[0]-1,t[3])):t[2]>n[2]&&t[1]===n[1]&&(f="down",i=new r.CellCoords(n[2]+1,t[1]),u=new r.CellCoords(t[2],t[3])),{directionOfDrag:f,startOfDragCoords:i,endOfDragCoords:u}}function h(n){var t={};return n===!0?(t.directions=Object.keys(u),t.autoInsertRow=!0):e.isObject(n)?(t.autoInsertRow=f.isDefined(n.autoInsertRow)?n.direction===u.horizontal?!1:n.autoInsertRow:!1,t.directions=f.isDefined(n.direction)?[n.direction]:Object.keys(u)):typeof n=="string"?(t.directions=[n],t.autoInsertRow=!0):(t.directions=[],t.autoInsertRow=!1),t}t.__esModule=!0;t.DIRECTIONS=undefined;t.getDeltas=o;t.getDragDirectionAndRange=s;t.getMappedFillHandleSetting=h;var e=i(1),f=i(13),r=i(8),u=t.DIRECTIONS={horizontal:"horizontal",vertical:"vertical"}},function(n,t,i){"use strict";function o(n){return n&&n.__esModule?n:{"default":n}}function nt(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function tt(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function it(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var s;t.__esModule=!0;var u=function c(n,t,i){var r,u,f;return n===null&&(n=Function.prototype),r=Object.getOwnPropertyDescriptor(n,t),r===undefined?(u=Object.getPrototypeOf(n),u===null?undefined:c(u,t,i)):"value"in r?r.value:(f=r.get,f===undefined)?undefined:f.call(i)},h=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),l=i(7),a=o(l),v=i(0),f=i(43),y=i(2),p=i(155),w=o(p),r=i(1),e=i(4),b=i(6),k=i(212),d=o(k),g=i(30);s=function(n){function t(n){nt(this,t);var i=tt(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return i.heights=[],i.ghostTable=new w.default(i.hot),i.samplesGenerator=new d.default(function(n,t){return n>=0?i.hot.getDataAtCell(n,t):n===-1?i.hot.getColHeader(t):null}),i.firstCalculation=!0,i.inProgress=!1,i.addHook("beforeRowResize",function(n,t,r){return i.onBeforeRowResize(n,t,r)}),i}return it(t,n),h(t,null,[{key:"CALCULATION_STEP",get:function(){return 50}},{key:"SYNC_CALCULATION_LIMIT",get:function(){return 500}}]),h(t,[{key:"isEnabled",value:function(){return this.hot.getSettings().autoRowSize===!0||r.isObject(this.hot.getSettings().autoRowSize)}},{key:"enablePlugin",value:function(){var n=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",function(){return n.onAfterLoadData()}),this.addHook("beforeChange",function(t){return n.onBeforeChange(t)}),this.addHook("beforeColumnMove",function(){return n.recalculateAllRowsHeight()}),this.addHook("beforeColumnResize",function(){return n.recalculateAllRowsHeight()}),this.addHook("beforeColumnSort",function(){return n.clearCache()}),this.addHook("beforeRender",function(t){return n.onBeforeRender(t)}),this.addHook("beforeRowMove",function(t,i){return n.onBeforeRowMove(t,i)}),this.addHook("modifyRowHeight",function(t,i){return n.getRowHeight(i,t)}),this.addHook("modifyColumnHeaderHeight",function(){return n.getColumnHeaderHeight()}),u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disablePlugin",this).call(this)}},{key:"calculateRowsHeight",value:function(){var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{from:0,to:this.hot.countRows()-1},i=this,t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{from:0,to:this.hot.countCols()-1},u=arguments.length>2&&arguments[2]!==undefined?arguments[2]:!1,r;typeof n=="number"&&(n={from:n,to:n});typeof t=="number"&&(t={from:t,to:t});this.hot.getColHeader(0)!==null&&(r=this.samplesGenerator.generateRowSamples(-1,t),this.ghostTable.addColumnHeadersRow(r.get(-1)));e.rangeEach(n.from,n.to,function(n){if(u||i.heights[n]===void 0){var r=i.samplesGenerator.generateRowSamples(n,t);r.forEach(function(n,t){i.ghostTable.addRow(t,n)})}});this.ghostTable.rows.length&&(this.ghostTable.getHeights(function(n,t){i.heights[n]=t}),this.ghostTable.clean())}},{key:"calculateAllRowsHeight",value:function(){var n=this,o=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{from:0,to:this.hot.countCols()-1},i=0,r=this.hot.countRows()-1,u=null,e;this.inProgress=!0;e=function e(){if(!n.hot){f.cancelAnimationFrame(u);n.inProgress=!1;return}n.calculateRowsHeight({from:i,to:Math.min(i+t.CALCULATION_STEP,r)},o);i=i+t.CALCULATION_STEP+1;i<r?u=f.requestAnimationFrame(e):(f.cancelAnimationFrame(u),n.inProgress=!1,n.hot.view.wt.wtOverlays.adjustElementsSize(!0),n.hot.view.wt.wtOverlays.leftOverlay.needFullRender&&n.hot.view.wt.wtOverlays.leftOverlay.clone.draw())};this.firstCalculation&&this.getSyncCalculationLimit()&&(this.calculateRowsHeight({from:0,to:this.getSyncCalculationLimit()},o),this.firstCalculation=!1,i=this.getSyncCalculationLimit()+1);i<r?e():(this.inProgress=!1,this.hot.view.wt.wtOverlays.adjustElementsSize(!1))}},{key:"setSamplingOptions",value:function(){var n=this.hot.getSettings().autoRowSize,t=n&&r.hasOwnProperty(n,"samplingRatio")?this.hot.getSettings().autoRowSize.samplingRatio:void 0,i=n&&r.hasOwnProperty(n,"allowSampleDuplicates")?this.hot.getSettings().autoRowSize.allowSampleDuplicates:void 0;t&&!isNaN(t)&&this.samplesGenerator.setSampleCount(parseInt(t,10));i&&this.samplesGenerator.setAllowDuplicates(i)}},{key:"recalculateAllRowsHeight",value:function(){y.isVisible(this.hot.view.wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllRowsHeight())}},{key:"getSyncCalculationLimit",value:function(){var n=t.SYNC_CALCULATION_LIMIT,i=this.hot.countRows()-1;return r.isObject(this.hot.getSettings().autoRowSize)&&(n=this.hot.getSettings().autoRowSize.syncLimit,g.isPercentValue(n)?n=e.valueAccordingPercent(i,n):n>>=0),Math.min(n,i)}},{key:"getRowHeight",value:function(n){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:void 0,i=t;return this.heights[n]!==void 0&&this.heights[n]>(t||0)&&(i=this.heights[n]),i}},{key:"getColumnHeaderHeight",value:function(){return this.heights[-1]}},{key:"getFirstVisibleRow",value:function(){var n=this.hot.view.wt;return n.wtViewport.rowsVisibleCalculator?n.wtTable.getFirstVisibleRow():n.wtViewport.rowsRenderCalculator?n.wtTable.getFirstRenderedRow():-1}},{key:"getLastVisibleRow",value:function(){var n=this.hot.view.wt;return n.wtViewport.rowsVisibleCalculator?n.wtTable.getLastVisibleRow():n.wtViewport.rowsRenderCalculator?n.wtTable.getLastRenderedRow():-1}},{key:"clearCache",value:function(){this.heights.length=0;this.heights[-1]=void 0}},{key:"clearCacheByRange",value:function(n){var t=this;typeof n=="number"&&(n={from:n,to:n});e.rangeEach(Math.min(n.from,n.to),Math.max(n.from,n.to),function(n){t.heights[n]=void 0})}},{key:"isNeedRecalculate",value:function(){return!!v.arrayFilter(this.heights,function(n){return n===void 0}).length}},{key:"onBeforeRender",value:function(){var i=this.hot.renderCall,n,t;this.calculateRowsHeight({from:this.getFirstVisibleRow(),to:this.getLastVisibleRow()},void 0,i);n=this.hot.getSettings().fixedRowsBottom;n&&(t=this.hot.countRows()-1,this.calculateRowsHeight({from:t-n,to:t}));this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllRowsHeight()}},{key:"onBeforeRowMove",value:function(n,t){this.clearCacheByRange({from:n,to:t});this.calculateAllRowsHeight()}},{key:"onBeforeRowResize",value:function(n,t,i){return i&&(this.calculateRowsHeight(n,void 0,!0),t=this.getRowHeight(n)),t}},{key:"onAfterLoadData",value:function(){var n=this;this.hot.view?this.recalculateAllRowsHeight():setTimeout(function(){n.hot&&n.recalculateAllRowsHeight()},0)}},{key:"onBeforeChange",value:function(n){var t=null;n.length===1?t=n[0][0]:n.length>1&&(t={from:n[0][0],to:n[n.length-1][0]});t!==null&&this.clearCacheByRange(t)}},{key:"destroy",value:function(){this.ghostTable.clean();u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}}]),t}(a.default);b.registerPlugin("autoRowSize",s);t.default=s},function(n,t,i){"use strict";function f(n){return n&&n.__esModule?n:{"default":n}}function tt(n){if(Array.isArray(n)){for(var t=0,i=Array(n.length);t<n.length;t++)i[t]=n[t];return i}return Array.from(n)}function it(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function rt(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function ut(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var o;t.__esModule=!0;var a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},v=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),s=function y(n,t,i){var r,u,f;return n===null&&(n=Function.prototype),r=Object.getOwnPropertyDescriptor(n,t),r===undefined?(u=Object.getPrototypeOf(n),u===null?undefined:y(u,t,i)):"value"in r?r.value:(f=r.get,f===undefined)?undefined:f.call(i)},p=i(31),h=f(p),u=i(2),e=i(0),r=i(13),c=i(1),w=i(7),b=f(w),k=i(6),d=i(318),g=f(d),nt=i(14),l=f(nt);l.default.getSingleton().register("beforeColumnSort");l.default.getSingleton().register("afterColumnSort");o=function(n){function t(n){it(this,t);var i=rt(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return i.sortIndicators=[],i.lastSortedColumn=null,i.sortEmptyCells=!1,i}return ut(t,n),v(t,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().columnSorting}},{key:"enablePlugin",value:function(){var n=this,i;this.enabled||(this.setPluginOptions(),i=this,this.hot.sortIndex=[],this.hot.sort=function(){var n=Array.prototype.slice.call(arguments);return i.sortByColumn.apply(i,tt(n))},typeof this.hot.getSettings().observeChanges=="undefined"&&this.enableObserveChangesPlugin(),this.addHook("afterTrimRow",function(){return n.sort()}),this.addHook("afterUntrimRow",function(){return n.sort()}),this.addHook("modifyRow",function(t){return n.translateRow(t)}),this.addHook("unmodifyRow",function(t){return n.untranslateRow(t)}),this.addHook("afterUpdateSettings",function(){return n.onAfterUpdateSettings()}),this.addHook("afterGetColHeader",function(t,i){return n.getColHeader(t,i)}),this.addHook("afterOnCellMouseDown",function(t,i){return n.onAfterOnCellMouseDown(t,i)}),this.addHook("afterCreateRow",function(){i.afterCreateRow.apply(i,arguments)}),this.addHook("afterRemoveRow",function(){i.afterRemoveRow.apply(i,arguments)}),this.addHook("afterInit",function(){return n.sortBySettings()}),this.addHook("afterLoadData",function(){n.hot.sortIndex=[];n.hot.view&&n.sortBySettings()}),this.hot.view&&this.sortBySettings(),s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.hot.sort=void 0;s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disablePlugin",this).call(this)}},{key:"onAfterUpdateSettings",value:function(){this.sortBySettings()}},{key:"sortBySettings",value:function(){var r=this.hot.getSettings().columnSorting,t=this.loadSortingState(),n=void 0,i=void 0;typeof t=="undefined"?(n=r.column,i=r.sortOrder):(n=t.sortColumn,i=t.sortOrder);typeof n=="number"&&(this.lastSortedColumn=n,this.sortByColumn(n,i))}},{key:"setSortingColumn",value:function(n,t){if(typeof n=="undefined"){this.hot.sortColumn=void 0;this.hot.sortOrder=void 0;return}this.hot.sortOrder=this.hot.sortColumn===n&&typeof t=="undefined"?this.hot.sortOrder===!1?void 0:!this.hot.sortOrder:typeof t=="undefined"?!0:t;this.hot.sortColumn=n}},{key:"sortByColumn",value:function(n,t){if(this.setSortingColumn(n,t),typeof this.hot.sortColumn!="undefined"){var i=this.hot.runHooks("beforeColumnSort",this.hot.sortColumn,this.hot.sortOrder);i!==!1&&this.sort();this.updateOrderClass();this.updateSortIndicator();this.hot.runHooks("afterColumnSort",this.hot.sortColumn,this.hot.sortOrder);this.hot.render();this.saveSortingState()}}},{key:"saveSortingState",value:function(){var n={};typeof this.hot.sortColumn!="undefined"&&(n.sortColumn=this.hot.sortColumn);typeof this.hot.sortOrder!="undefined"&&(n.sortOrder=this.hot.sortOrder);(c.hasOwnProperty(n,"sortColumn")||c.hasOwnProperty(n,"sortOrder"))&&this.hot.runHooks("persistentStateSave","columnSorting",n)}},{key:"loadSortingState",value:function(){var n={};return this.hot.runHooks("persistentStateLoad","columnSorting",n),n.value}},{key:"updateOrderClass",value:function(){var n=void 0;this.hot.sortOrder===!0?n="ascending":this.hot.sortOrder===!1&&(n="descending");this.sortOrderClass=n}},{key:"enableObserveChangesPlugin",value:function(){var n=this;this.hot._registerTimeout(setTimeout(function(){n.hot.updateSettings({observeChanges:!0})},0))}},{key:"defaultSort",value:function(n,t){return function(i,u){return(typeof i[1]=="string"&&(i[1]=i[1].toLowerCase()),typeof u[1]=="string"&&(u[1]=u[1].toLowerCase()),i[1]===u[1])?0:r.isEmpty(i[1])?r.isEmpty(u[1])?0:t.columnSorting.sortEmptyCells?n?-1:1:1:r.isEmpty(u[1])?r.isEmpty(i[1])?0:t.columnSorting.sortEmptyCells?n?1:-1:-1:isNaN(i[1])&&!isNaN(u[1])?n?1:-1:!isNaN(i[1])&&isNaN(u[1])?n?-1:1:(isNaN(i[1])||isNaN(u[1])||(i[1]=parseFloat(i[1]),u[1]=parseFloat(u[1])),i[1]<u[1])?n?-1:1:i[1]>u[1]?n?1:-1:0}}},{key:"dateSort",value:function(n,t){return function(i,u){if(i[1]===u[1])return 0;if(r.isEmpty(i[1]))return r.isEmpty(u[1])?0:t.columnSorting.sortEmptyCells?n?-1:1:1;if(r.isEmpty(u[1]))return r.isEmpty(i[1])?0:t.columnSorting.sortEmptyCells?n?1:-1:-1;var f=h.default(i[1],t.dateFormat),e=h.default(u[1],t.dateFormat);return f.isValid()?e.isValid()?e.isAfter(f)?n?-1:1:e.isBefore(f)?n?1:-1:0:-1:1}}},{key:"numericSort",value:function(n,t){return function(i,u){var f=parseFloat(i[1]),e=parseFloat(u[1]);if(f===e||isNaN(f)&&isNaN(e))return 0;if(t.columnSorting.sortEmptyCells){if(r.isEmpty(i[1]))return n?-1:1;if(r.isEmpty(u[1]))return n?1:-1}return isNaN(f)?1:isNaN(e)?-1:f<e?n?-1:1:f>e?n?1:-1:0}}},{key:"sort",value:function(){var i,f,r;if(typeof this.hot.sortOrder=="undefined"){this.hot.sortIndex.length=0;return}var n=this.hot.getCellMeta(0,this.hot.sortColumn),e=this.hot.countEmptyRows(),t=void 0,u=void 0;for(this.hot.sortingEnabled=!1,this.hot.sortIndex.length=0,typeof n.columnSorting.sortEmptyCells=="undefined"&&(n.columnSorting={sortEmptyCells:this.sortEmptyCells}),u=this.hot.getSettings().maxRows===Number.POSITIVE_INFINITY?this.hot.countRows()-this.hot.getSettings().minSpareRows:this.hot.countRows()-e,i=0,f=u;i<f;i++)this.hot.sortIndex.push([i,this.hot.getDataAtCell(i,this.hot.sortColumn)]);if(n.sortFunction)t=n.sortFunction;else switch(n.type){case"date":t=this.dateSort;break;case"numeric":t=this.numericSort;break;default:t=this.defaultSort}for(g.default(this.hot.sortIndex,t(this.hot.sortOrder,n)),r=this.hot.sortIndex.length;r<this.hot.countRows();r++)this.hot.sortIndex.push([r,this.hot.getDataAtCell(r,this.hot.sortColumn)]);this.hot.sortingEnabled=!0}},{key:"updateSortIndicator",value:function(){if(typeof this.hot.sortOrder!="undefined"){var n=this.hot.getCellMeta(0,this.hot.sortColumn);this.sortIndicators[this.hot.sortColumn]=n.sortIndicator}}},{key:"translateRow",value:function(n){return this.hot.sortingEnabled&&typeof this.hot.sortOrder!="undefined"&&this.hot.sortIndex&&this.hot.sortIndex.length&&this.hot.sortIndex[n]?this.hot.sortIndex[n][0]:n}},{key:"untranslateRow",value:function(n){if(this.hot.sortingEnabled&&this.hot.sortIndex&&this.hot.sortIndex.length)for(var t=0;t<this.hot.sortIndex.length;t++)if(this.hot.sortIndex[t][0]==n)return t}},{key:"getColHeader",value:function(n,t){if(n<0||!t.parentNode)return!1;var i=t.querySelector(".colHeader"),e=t.getAttribute("colspan"),r=t.parentNode.parentNode.childNodes,f=Array.prototype.indexOf.call(r,t.parentNode);(f-=r.length,i)&&(this.hot.getSettings().columnSorting&&n>=0&&f===-1&&u.addClass(i,"columnSorting"),u.removeClass(i,"descending"),u.removeClass(i,"ascending"),this.sortIndicators[n]&&n===this.hot.sortColumn&&(this.sortOrderClass==="ascending"?u.addClass(i,"ascending"):this.sortOrderClass==="descending"&&u.addClass(i,"descending")))}},{key:"isSorted",value:function(){return typeof this.hot.sortColumn!="undefined"}},{key:"afterCreateRow",value:function(n,t){var r,i;if(this.isSorted()){for(r=0;r<this.hot.sortIndex.length;r++)this.hot.sortIndex[r][0]>=n&&(this.hot.sortIndex[r][0]+=t);for(i=0;i<t;i++)this.hot.sortIndex.splice(n+i,0,[n+i,this.hot.getSourceData()[n+i][this.hot.sortColumn+this.hot.colOffset()]]);this.saveSortingState()}}},{key:"afterRemoveRow",value:function(n,t){function r(n){return e.arrayReduce(i,function(t,i){return n>i&&t++,t},0)}if(this.isSorted()){var i=this.hot.sortIndex.splice(n,t);i=e.arrayMap(i,function(n){return n[0]});this.hot.sortIndex=e.arrayMap(this.hot.sortIndex,function(n){var t=r(n[0]);return t&&(n[0]-=t),n});this.saveSortingState()}}},{key:"setPluginOptions",value:function(){var n=this.hot.getSettings().columnSorting;this.sortEmptyCells=(typeof n=="undefined"?"undefined":a(n))==="object"?n.sortEmptyCells||!1:!1}},{key:"onAfterOnCellMouseDown",value:function(n,t){t.row>-1||u.hasClass(n.realTarget,"columnSorting")&&(t.col!==this.lastSortedColumn&&(this.hot.sortOrder=!0),this.lastSortedColumn=t.col,this.sortByColumn(t.col))}}]),t}(b.default);k.registerPlugin("columnSorting",o);t.default=o},function(n,t,i){"use strict";function s(n){return n&&n.__esModule?n:{"default":n}}function u(n){var f=arguments.length>1&&arguments[1]!==undefined?arguments[1]:e,t=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0,i=arguments.length>3&&arguments[3]!==undefined?arguments[3]:n.length,r;return Math.abs(i-t)<=1?[]:(r=Math.ceil((t+i)/2),u(n,f,t,r),u(n,f,r,i),o(n,f,t,r,i))}function o(n,t,i,u,f){for(var h,e=new r.default,s=new r.default,c=u-i,l=f-u,a=Math.max(c,l),v=f-i,o=0;o<a;o+=1)o<c&&e.push(n[i+o]),o<l&&s.push(n[u+o]);for(h=0;h<v;)n[i+h]=e.first&&s.first?t(e.first.data,s.first.data)>0?s.shift().data:e.shift().data:e.first?e.shift().data:s.shift().data,h+=1;return n}var f,r,e;t.__esModule=!0;t.default=u;t.merge=o;f=i(319);r=s(f);e=function(n,t){var i=n.toString(),r=t.toString();return i===r?0:i<r?-1:1}},function(n,t){"use strict";function u(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var r,i,f;t.__esModule=!0;r=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}();i=function i(n){u(this,i);this.data=n;this.next=null;this.prev=null};f=function(){function n(){u(this,n);this.first=null;this.last=null}return r(n,[{key:"push",value:function(n){var t=new i(n),r;this.first===null?(this.first=t,this.last=t):(r=this.last,this.last=t,t.prev=r,r.next=t)}},{key:"unshift",value:function(n){var t=new i(n),r;this.first===null?(this.first=t,this.last=t):(r=this.first,this.first=t,t.next=r,r.prev=t)}},{key:"inorder",value:function(n){for(var t=this.first;t;)n(t),t=t.next}},{key:"remove",value:function(n){if(this.first===null)return!1;for(var t=this.first,i=void 0,r=void 0;t;){if(t.data===n)return i=t.next,r=t.prev,i&&(i.prev=r),r&&(r.next=i),t===this.first&&(this.first=i),t===this.last&&(this.last=r),!0;t=t.next}return!1}},{key:"hasCycle",value:function(){for(var n=this.first,t=this.first;;){if(n===null||(n=n.next,n===null))return!1;if(n=n.next,t=t.next,n===t)return!0}}},{key:"pop",value:function(){if(this.last===null)return null;var n=this.last;return this.last=this.last.prev,n}},{key:"shift",value:function(){if(this.first===null)return null;var n=this.first;return this.first=this.first.next,n}},{key:"recursiveReverse",value:function(){function n(t,i){i&&(n(i,i.next),i.next=t)}if(this.first){n(this.first,this.first.next);this.first.next=null;var t=this.first;this.first=this.last;this.last=t}}},{key:"reverse",value:function(){if(this.first&&this.first.next){for(var n=this.first.next,t=this.first,i=void 0;n;)i=n.next,n.next=t,t.prev=n,t=n,n=i;this.first.next=null;this.last.prev=null;i=this.first;this.first=t;this.last=i}}}]),n}();t.NodeStructure=i;t.default=f},function(n,t,i){"use strict";function st(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function h(n){return n&&n.__esModule?n:{"default":n}}function v(n,t,i){return t in n?Object.defineProperty(n,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[t]=i,n}function ht(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function ct(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function lt(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}t.__esModule=!0;var b=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),e=function k(n,t,i){var r,u,f;return n===null&&(n=Function.prototype),r=Object.getOwnPropertyDescriptor(n,t),r===undefined?(u=Object.getPrototypeOf(n),u===null?undefined:k(u,t,i)):"value"in r?r.value:(f=r.get,f===undefined)?undefined:f.call(i)},r=i(2),a=i(1),d=i(9),g=h(d),o=i(8),nt=i(6),tt=i(7),it=h(tt),rt=i(321),ut=h(rt),y=i(23),ft=i(322),et=h(ft),ot=i(3),s=st(ot);i(323);var c=new WeakMap,u="comment",f="value",p="style",l="readOnly",w=function(n){function t(n){ht(this,t);var i=ct(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return i.editor=null,i.displaySwitch=null,i.eventManager=null,i.range={},i.mouseDown=!1,i.contextMenuEvent=!1,i.timer=null,c.set(i,{tempEditorDimensions:{},cellBelowCursor:null}),i}return lt(t,n),b(t,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().comments}},{key:"enablePlugin",value:function(){var n=this;this.enabled||(this.editor||(this.editor=new ut.default),this.eventManager||(this.eventManager=new g.default(this)),this.displaySwitch||(this.displaySwitch=new et.default(this.getDisplayDelaySetting())),this.addHook("afterContextMenuDefaultOptions",function(t){return n.addToContextMenu(t)}),this.addHook("afterRenderer",function(t,i,r,u,f,e){return n.onAfterRenderer(t,e)}),this.addHook("afterScrollHorizontally",function(){return n.hide()}),this.addHook("afterScrollVertically",function(){return n.hide()}),this.addHook("afterBeginEditing",function(t){return n.onAfterBeginEditing(t)}),this.displaySwitch.addLocalHook("hide",function(){return n.hide()}),this.displaySwitch.addLocalHook("show",function(t,i){return n.showAtCell(t,i)}),this.registerListeners(),e(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin();this.enablePlugin();e(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updatePlugin",this).call(this);this.displaySwitch.updateDelay(this.getDisplayDelaySetting())}},{key:"disablePlugin",value:function(){e(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disablePlugin",this).call(this)}},{key:"registerListeners",value:function(){var n=this;this.eventManager.addEventListener(document,"mouseover",function(t){return n.onMouseOver(t)});this.eventManager.addEventListener(document,"mousedown",function(t){return n.onMouseDown(t)});this.eventManager.addEventListener(document,"mouseup",function(t){return n.onMouseUp(t)});this.eventManager.addEventListener(this.editor.getInputElement(),"blur",function(t){return n.onEditorBlur(t)});this.eventManager.addEventListener(this.editor.getInputElement(),"mousedown",function(t){return n.onEditorMouseDown(t)});this.eventManager.addEventListener(this.editor.getInputElement(),"mouseup",function(t){return n.onEditorMouseUp(t)})}},{key:"setRange",value:function(n){this.range=n}},{key:"clearRange",value:function(){this.range={}}},{key:"targetIsCellWithComment",value:function(n){var t=r.closest(n.target,"TD","TBODY");return!!(t&&r.hasClass(t,"htCommentCell")&&r.closest(t,[this.hot.rootElement]))}},{key:"targetIsCommentTextArea",value:function(n){return this.editor.getInputElement()===n.target}},{key:"setComment",value:function(n){var i,t,r,u;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');i=this.editor.getValue();t="";n!=null?t=n:i!=null&&(t=i);r=this.range.from.row;u=this.range.from.col;this.updateCommentMeta(r,u,v({},f,t));this.hot.render()}},{key:"setCommentAtCell",value:function(n,t,i){this.setRange({from:new o.CellCoords(n,t)});this.setComment(i)}},{key:"removeComment",value:function(){var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,u,void 0);n&&this.hot.render();this.hide()}},{key:"removeCommentAtCell",value:function(n,t){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:!0;this.setRange({from:new o.CellCoords(n,t)});this.removeComment(i)}},{key:"getComment",value:function(){var n=this.range.from.row,t=this.range.from.col;return this.getCommentMeta(n,t,f)}},{key:"getCommentAtCell",value:function(n,t){return this.getCommentMeta(n,t,f)}},{key:"show",value:function(){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var n=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return this.refreshEditor(!0),this.editor.setValue(n[u]?n[u][f]:""),this.editor.hidden&&this.editor.show(),!0}},{key:"showAtCell",value:function(n,t){return this.setRange({from:new o.CellCoords(n,t)}),this.show()}},{key:"hide",value:function(){this.editor.hidden||this.editor.hide()}},{key:"refreshEditor",value:function(){var s=arguments.length>0&&arguments[0]!==undefined?arguments[0]:!1;if(s||this.range.from&&this.editor.isVisible()){var u=r.getScrollableElement(this.hot.view.wt.wtTable.TABLE),h=this.hot.view.wt.wtTable.getCell(this.range.from),f=this.range.from.row,n=this.range.from.col,t=r.offset(h),c=this.hot.view.wt.wtTable.getStretchedColumnWidth(n),e=t.top<0?0:t.top,o=t.left;this.hot.view.wt.wtViewport.hasVerticalScroll()&&u!==window&&(e-=this.hot.view.wt.wtOverlays.topOverlay.getScrollPosition());this.hot.view.wt.wtViewport.hasHorizontalScroll()&&u!==window&&(o-=this.hot.view.wt.wtOverlays.leftOverlay.getScrollPosition());var a=o+c,v=e,i=this.getCommentMeta(f,n,p),y=this.getCommentMeta(f,n,l);i?this.editor.setSize(i.width,i.height):this.editor.resetSize();this.editor.setReadOnlyState(y);this.editor.setPosition(a,v)}}},{key:"checkSelectionCommentsConsistency",value:function(){var i=this.hot.getSelectedRangeLast(),n,t;return i?(n=!1,t=i.from,this.getCommentMeta(t.row,t.col,f)&&(n=!0),n):!1}},{key:"updateCommentMeta",value:function(n,t,i){var f=this.hot.getCellMeta(n,t)[u],r=void 0;f?(r=a.deepClone(f),a.deepExtend(r,i)):r=i;this.hot.setCellMeta(n,t,u,r)}},{key:"getCommentMeta",value:function(n,t,i){var r=this.hot.getCellMeta(n,t);if(r[u])return r[u][i]}},{key:"onMouseDown",value:function(n){if(this.mouseDown=!0,this.hot.view&&this.hot.view.wt){if(!this.contextMenuEvent&&!this.targetIsCommentTextArea(n)){var i=r.closest(n.target,"TD","TBODY"),t=null;i&&(t=this.hot.view.wt.wtTable.getCoords(i));(!i||this.range.from&&t&&(this.range.from.row!==t.row||this.range.from.col!==t.col))&&this.hide()}this.contextMenuEvent=!1}}},{key:"onMouseOver",value:function(n){var i=c.get(this),t,u;(i.cellBelowCursor=document.elementFromPoint(n.clientX,n.clientY),this.mouseDown||this.editor.isFocused()||r.hasClass(n.target,"wtBorder")||i.cellBelowCursor!==n.target||!this.editor)||(this.targetIsCellWithComment(n)?(t=this.hot.view.wt.wtTable.getCoords(n.target),u={from:new o.CellCoords(t.row,t.col)},this.displaySwitch.show(u)):r.isChildOf(n.target,document)&&!this.targetIsCommentTextArea(n)&&this.displaySwitch.hide())}},{key:"onMouseUp",value:function(){this.mouseDown=!1}},{key:"onAfterRenderer",value:function(n,t){t[u]&&t[u][f]&&r.addClass(n,t.commentedCellClassName)}},{key:"onEditorBlur",value:function(){this.setComment()}},{key:"onEditorMouseDown",value:function(n){var t=c.get(this);t.tempEditorDimensions={width:r.outerWidth(n.target),height:r.outerHeight(n.target)}}},{key:"onEditorMouseUp",value:function(n){var t=c.get(this),i=r.outerWidth(n.target),u=r.outerHeight(n.target);(i!==t.tempEditorDimensions.width+1||u!==t.tempEditorDimensions.height+2)&&this.updateCommentMeta(this.range.from.row,this.range.from.col,v({},p,{width:i,height:u}))}},{key:"onContextMenuAddComment",value:function(){var n=this,t;this.displaySwitch.cancelHiding();t=this.hot.getSelectedRangeLast();this.contextMenuEvent=!0;this.setRange({from:t.from});this.show();setTimeout(function(){n.hot&&(n.hot.deselectCell(),n.editor.focus())},10)}},{key:"onContextMenuRemoveComment",value:function(){var n,t;this.contextMenuEvent=!0;var i=this.hot.getSelectedRangeLast(),r=i.from,u=i.to;for(n=r.row;n<=u.row;n++)for(t=r.col;t<=u.col;t++)this.removeCommentAtCell(n,t,!1);this.hot.render()}},{key:"onContextMenuMakeReadOnly",value:function(){var n,t,f;this.contextMenuEvent=!0;var i=this.hot.getSelectedRangeLast(),r=i.from,u=i.to;for(n=r.row;n<=u.row;n++)for(t=r.col;t<=u.col;t++)f=!!this.getCommentMeta(n,t,l),this.updateCommentMeta(n,t,v({},l,!f))}},{key:"addToContextMenu",value:function(n){var t=this;n.items.push({name:"---------"},{key:"commentsAddEdit",name:function(){return t.checkSelectionCommentsConsistency()?t.hot.getTranslatedPhrase(s.CONTEXTMENU_ITEMS_EDIT_COMMENT):t.hot.getTranslatedPhrase(s.CONTEXTMENU_ITEMS_ADD_COMMENT)},callback:function(){return t.onContextMenuAddComment()},disabled:function(){return!(this.getSelectedLast()&&!this.selection.selectedHeader.corner)}},{key:"commentsRemove",name:function(){return this.getTranslatedPhrase(s.CONTEXTMENU_ITEMS_REMOVE_COMMENT)},callback:function(){return t.onContextMenuRemoveComment()},disabled:function(){return t.hot.selection.selectedHeader.corner}},{key:"commentsReadOnly",name:function(){var t=this,n=this.getTranslatedPhrase(s.CONTEXTMENU_ITEMS_READ_ONLY_COMMENT),i=y.checkSelectionConsistency(this.getSelectedRangeLast(),function(n,i){var r=t.getCellMeta(n,i)[u];return r&&(r=r[l]),r?!0:void 0});return i&&(n=y.markLabelAsSelected(n)),n},callback:function(){return t.onContextMenuMakeReadOnly()},disabled:function(){return t.hot.selection.selectedHeader.corner||!t.checkSelectionCommentsConsistency()}})}},{key:"getDisplayDelaySetting",value:function(){var n=this.hot.getSettings().comments;if(a.isObject(n))return n.displayDelay}},{key:"onAfterBeginEditing",value:function(){this.hide()}},{key:"destroy",value:function(){this.editor&&this.editor.destroy();this.displaySwitch&&this.displaySwitch.destroy();e(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}}]),t}(it.default);nt.registerPlugin("comments",w);t.default=w},function(n,t,i){"use strict";function e(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var u,r,f;t.__esModule=!0;u=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}();r=i(2);f=function(){function n(){e(this,n);this.editor=this.createEditor();this.editorStyle=this.editor.style;this.hidden=!0;this.hide()}return u(n,null,[{key:"CLASS_EDITOR_CONTAINER",get:function(){return"htCommentsContainer"}},{key:"CLASS_EDITOR",get:function(){return"htComments"}},{key:"CLASS_INPUT",get:function(){return"htCommentTextArea"}},{key:"CLASS_CELL",get:function(){return"htCommentCell"}}]),u(n,[{key:"setPosition",value:function(n,t){this.editorStyle.left=n+"px";this.editorStyle.top=t+"px"}},{key:"setSize",value:function(n,t){if(n&&t){var i=this.getInputElement();i.style.width=n+"px";i.style.height=t+"px"}}},{key:"resetSize",value:function(){var n=this.getInputElement();n.style.width="";n.style.height=""}},{key:"setReadOnlyState",value:function(n){var t=this.getInputElement();t.readOnly=n}},{key:"show",value:function(){this.editorStyle.display="block";this.hidden=!1}},{key:"hide",value:function(){this.editorStyle.display="none";this.hidden=!0}},{key:"isVisible",value:function(){return this.editorStyle.display==="block"}},{key:"setValue",value:function(){var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"";n=n||"";this.getInputElement().value=n}},{key:"getValue",value:function(){return this.getInputElement().value}},{key:"isFocused",value:function(){return document.activeElement===this.getInputElement()}},{key:"focus",value:function(){this.getInputElement().focus()}},{key:"createEditor",value:function(){var t=document.querySelector("."+n.CLASS_EDITOR_CONTAINER),i=void 0,u=void 0;return t||(t=document.createElement("div"),r.addClass(t,n.CLASS_EDITOR_CONTAINER),document.body.appendChild(t)),i=document.createElement("div"),r.addClass(i,n.CLASS_EDITOR),u=document.createElement("textarea"),r.addClass(u,n.CLASS_INPUT),i.appendChild(u),t.appendChild(i),i}},{key:"getInputElement",value:function(){return this.editor.querySelector("."+n.CLASS_INPUT)}},{key:"destroy",value:function(){this.editor.parentNode.removeChild(this.editor);this.editor=null;this.editorStyle=null}}]),n}();t.default=f},function(n,t,i){"use strict";function h(n){return n&&n.__esModule?n:{"default":n}}function c(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}t.__esModule=!0;var u=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),f=i(35),e=i(1),o=i(21),s=h(o);var l=250,a=250,r=function(){function n(t){c(this,n);this.wasLastActionShow=!0;this.showDebounced=null;this.hidingTimer=null;this.updateDelay(t)}return u(n,[{key:"hide",value:function(){var n=this;this.wasLastActionShow=!1;this.hidingTimer=setTimeout(function(){n.wasLastActionShow===!1&&n.runLocalHooks("hide")},a)}},{key:"show",value:function(n){this.wasLastActionShow=!0;this.showDebounced(n)}},{key:"cancelHiding",value:function(){this.wasLastActionShow=!0;clearTimeout(this.hidingTimer);this.hidingTimer=null}},{key:"updateDelay",value:function(){var n=this,t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:l;this.showDebounced=f.debounce(function(t){n.wasLastActionShow&&n.runLocalHooks("show",t.from.row,t.from.col)},t)}},{key:"destroy",value:function(){this.clearLocalHooks()}}]),n}();e.mixin(r,s.default);t.default=r},function(){},function(n,t,i){"use strict";function u(n){return n&&n.__esModule?n:{"default":n}}function ut(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function ft(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function et(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var s;t.__esModule=!0;var e=function l(n,t,i){var r,u,f;return n===null&&(n=Function.prototype),r=Object.getOwnPropertyDescriptor(n,t),r===undefined?(u=Object.getPrototypeOf(n),u===null?undefined:l(u,t,i)):"value"in r?r.value:(f=r.get,f===undefined)?undefined:f.call(i)},c=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),a=i(7),v=u(a),y=i(14),o=u(y),p=i(0),w=i(213),b=u(w),k=i(9),d=u(k),g=i(214),nt=u(g),tt=i(157),it=u(tt),rt=i(6),h=i(11),f=i(2),r=i(44);i(337);o.default.getSingleton().register("afterContextMenuDefaultOptions");o.default.getSingleton().register("afterContextMenuShow");o.default.getSingleton().register("afterContextMenuHide");o.default.getSingleton().register("afterContextMenuExecute");s=function(n){function t(n){ut(this,t);var i=ft(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return i.eventManager=new d.default(i),i.commandExecutor=new b.default(i.hot),i.itemsFactory=null,i.menu=null,i}return et(t,n),c(t,null,[{key:"DEFAULT_ITEMS",get:function(){return[r.ROW_ABOVE,r.ROW_BELOW,r.SEPARATOR,r.COLUMN_LEFT,r.COLUMN_RIGHT,r.SEPARATOR,r.REMOVE_ROW,r.REMOVE_COLUMN,r.SEPARATOR,r.UNDO,r.REDO,r.SEPARATOR,r.READ_ONLY,r.SEPARATOR,r.ALIGNMENT]}}]),c(t,[{key:"isEnabled",value:function(){return this.hot.getSettings().contextMenu}},{key:"enablePlugin",value:function(){var n=this,i,r,u;this.enabled||(this.itemsFactory=new nt.default(this.hot,t.DEFAULT_ITEMS),i=this.hot.getSettings().contextMenu,r={items:this.itemsFactory.getItems(i)},this.registerEvents(),typeof i.callback=="function"&&this.commandExecutor.setCommonCallback(i.callback),e(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enablePlugin",this).call(this),u=function(){if(n.hot){n.hot.runHooks("afterContextMenuDefaultOptions",r);n.itemsFactory.setPredefinedItems(r.items);var t=n.itemsFactory.getItems(i);n.menu=new it.default(n.hot,{className:"htContextMenu",keepInViewport:!0});n.hot.runHooks("beforeContextMenuSetItems",t);n.menu.setMenuItems(t);n.menu.addLocalHook("afterOpen",function(){return n.onMenuAfterOpen()});n.menu.addLocalHook("afterClose",function(){return n.onMenuAfterClose()});n.menu.addLocalHook("executeCommand",function(){for(var i=arguments.length,r=Array(i),t=0;t<i;t++)r[t]=arguments[t];return n.executeCommand.apply(n,r)});p.arrayEach(t,function(t){return n.commandExecutor.registerCommand(t.key,t)})}},this.callOnPluginsReady(function(){n.isPluginsReady?setTimeout(u,0):u()}))}},{key:"updatePlugin",value:function(){this.disablePlugin();this.enablePlugin();e(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.close();this.menu&&(this.menu.destroy(),this.menu=null);e(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disablePlugin",this).call(this)}},{key:"registerEvents",value:function(){var n=this;this.eventManager.addEventListener(this.hot.rootElement,"contextmenu",function(t){return n.onContextMenu(t)})}},{key:"open",value:function(n){this.menu&&(this.menu.open(),this.menu.setPosition({top:parseInt(h.pageY(n),10)-f.getWindowScrollTop(),left:parseInt(h.pageX(n),10)-f.getWindowScrollLeft()}),this.menu.hotMenu.isHotTableEnv=this.hot.isHotTableEnv)}},{key:"close",value:function(){this.menu&&this.menu.close()}},{key:"executeCommand",value:function(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];this.commandExecutor.execute.apply(this.commandExecutor,i)}},{key:"onContextMenu",value:function(n){function e(n){return n.nodeName==="TD"||n.parentNode.nodeName==="TD"}var i=this.hot.getSettings(),r=i.rowHeaders,u=i.colHeaders,t=n.realTarget;(this.close(),f.hasClass(t,"handsontableInput"))||(n.preventDefault(),h.stopPropagation(n),r||u||e(t)||f.hasClass(t,"current")&&f.hasClass(t,"wtBorder"))&&this.open(n)}},{key:"onMenuAfterOpen",value:function(){this.hot.runHooks("afterContextMenuShow",this)}},{key:"onMenuAfterClose",value:function(){this.hot.listen();this.hot.runHooks("afterContextMenuHide",this)}},{key:"destroy",value:function(){this.close();this.menu&&this.menu.destroy();e(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}}]),t}(v.default);s.SEPARATOR={name:r.SEPARATOR};rt.registerPlugin("contextMenu",s);t.default=s},function(n,t,i){"use strict";function s(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function h(){return{key:u,name:function(){return this.getTranslatedPhrase(f.CONTEXTMENU_ITEMS_ALIGNMENT)},disabled:function(){return!(this.getSelectedRange()&&!this.selection.selectedHeader.corner)},submenu:{items:[{key:u+":left",name:function(){var t=this,n=this.getTranslatedPhrase(f.CONTEXTMENU_ITEMS_ALIGNMENT_LEFT),i=r.checkSelectionConsistency(this.getSelectedRange(),function(n,i){var r=t.getCellMeta(n,i).className;if(r&&r.indexOf("htLeft")!==-1)return!0});return i&&(n=r.markLabelAsSelected(n)),n},callback:function(){var n=this,t=this.getSelectedRange(),f=r.getAlignmentClasses(t,function(t,i){return n.getCellMeta(t,i).className}),i="horizontal",u="htLeft";this.runHooks("beforeCellAlignment",f,t,i,u);r.align(t,i,u,function(t,i){return n.getCellMeta(t,i)},function(t,i,r,u){return n.setCellMeta(t,i,r,u)});this.render()},disabled:!1},{key:u+":center",name:function(){var t=this,n=this.getTranslatedPhrase(f.CONTEXTMENU_ITEMS_ALIGNMENT_CENTER),i=r.checkSelectionConsistency(this.getSelectedRange(),function(n,i){var r=t.getCellMeta(n,i).className;if(r&&r.indexOf("htCenter")!==-1)return!0});return i&&(n=r.markLabelAsSelected(n)),n},callback:function(){var n=this,t=this.getSelectedRange(),f=r.getAlignmentClasses(t,function(t,i){return n.getCellMeta(t,i).className}),i="horizontal",u="htCenter";this.runHooks("beforeCellAlignment",f,t,i,u);r.align(t,i,u,function(t,i){return n.getCellMeta(t,i)},function(t,i,r,u){return n.setCellMeta(t,i,r,u)});this.render()},disabled:!1},{key:u+":right",name:function(){var t=this,n=this.getTranslatedPhrase(f.CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT),i=r.checkSelectionConsistency(this.getSelectedRange(),function(n,i){var r=t.getCellMeta(n,i).className;if(r&&r.indexOf("htRight")!==-1)return!0});return i&&(n=r.markLabelAsSelected(n)),n},callback:function(){var n=this,t=this.getSelectedRange(),f=r.getAlignmentClasses(t,function(t,i){return n.getCellMeta(t,i).className}),i="horizontal",u="htRight";this.runHooks("beforeCellAlignment",f,t,i,u);r.align(t,i,u,function(t,i){return n.getCellMeta(t,i)},function(t,i,r,u){return n.setCellMeta(t,i,r,u)});this.render()},disabled:!1},{key:u+":justify",name:function(){var t=this,n=this.getTranslatedPhrase(f.CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY),i=r.checkSelectionConsistency(this.getSelectedRange(),function(n,i){var r=t.getCellMeta(n,i).className;if(r&&r.indexOf("htJustify")!==-1)return!0});return i&&(n=r.markLabelAsSelected(n)),n},callback:function(){var n=this,t=this.getSelectedRange(),f=r.getAlignmentClasses(t,function(t,i){return n.getCellMeta(t,i).className}),i="horizontal",u="htJustify";this.runHooks("beforeCellAlignment",f,t,i,u);r.align(t,i,u,function(t,i){return n.getCellMeta(t,i)},function(t,i,r,u){return n.setCellMeta(t,i,r,u)});this.render()},disabled:!1},{name:e.KEY},{key:u+":top",name:function(){var t=this,n=this.getTranslatedPhrase(f.CONTEXTMENU_ITEMS_ALIGNMENT_TOP),i=r.checkSelectionConsistency(this.getSelectedRange(),function(n,i){var r=t.getCellMeta(n,i).className;if(r&&r.indexOf("htTop")!==-1)return!0});return i&&(n=r.markLabelAsSelected(n)),n},callback:function(){var n=this,t=this.getSelectedRange(),f=r.getAlignmentClasses(t,function(t,i){return n.getCellMeta(t,i).className}),i="vertical",u="htTop";this.runHooks("beforeCellAlignment",f,t,i,u);r.align(t,i,u,function(t,i){return n.getCellMeta(t,i)},function(t,i,r,u){return n.setCellMeta(t,i,r,u)});this.render()},disabled:!1},{key:u+":middle",name:function(){var t=this,n=this.getTranslatedPhrase(f.CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE),i=r.checkSelectionConsistency(this.getSelectedRange(),function(n,i){var r=t.getCellMeta(n,i).className;if(r&&r.indexOf("htMiddle")!==-1)return!0});return i&&(n=r.markLabelAsSelected(n)),n},callback:function(){var n=this,t=this.getSelectedRange(),f=r.getAlignmentClasses(t,function(t,i){return n.getCellMeta(t,i).className}),i="vertical",u="htMiddle";this.runHooks("beforeCellAlignment",f,t,i,u);r.align(t,i,u,function(t,i){return n.getCellMeta(t,i)},function(t,i,r,u){return n.setCellMeta(t,i,r,u)});this.render()},disabled:!1},{key:u+":bottom",name:function(){var t=this,n=this.getTranslatedPhrase(f.CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM),i=r.checkSelectionConsistency(this.getSelectedRange(),function(n,i){var r=t.getCellMeta(n,i).className;if(r&&r.indexOf("htBottom")!==-1)return!0});return i&&(n=r.markLabelAsSelected(n)),n},callback:function(){var n=this,t=this.getSelectedRange(),f=r.getAlignmentClasses(t,function(t,i){return n.getCellMeta(t,i).className}),i="vertical",u="htBottom";this.runHooks("beforeCellAlignment",f,t,i,u);r.align(t,i,u,function(t,i){return n.getCellMeta(t,i)},function(t,i,r,u){return n.setCellMeta(t,i,r,u)});this.render()},disabled:!1}]}}}var u;t.__esModule=!0;t.KEY=undefined;t.default=h;var r=i(23),e=i(156),o=i(3),f=s(o);u=t.KEY="alignment"},function(n,t,i){"use strict";function s(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function h(){return{key:u,name:function(){return this.getTranslatedPhrase(o.CONTEXTMENU_ITEMS_CLEAR_COLUMN)},callback:function(n,t){var i=t[0].start.col;this.countRows()&&this.populateFromArray(0,i,[[null]],Math.max(t[0].start.row,t[0].end.row),i,"ContextMenu.clearColumn")},disabled:function(){var t=f.getValidSelection(this);if(!t)return!0;var n=r(t[0],4),i=n[0],u=n[1],e=n[2],h=n[3],o=[i,0,e,this.countCols()-1],s=o.join(",")===t.join(",");return u<0||this.countCols()>=this.getSettings().maxCols||s}}}var r,u;t.__esModule=!0;t.KEY=undefined;r=function(){function n(n,t){var r=[],u=!0,f=!1,e=undefined,i,o;try{for(i=n[Symbol.iterator]();!(u=(o=i.next()).done);u=!0)if(r.push(o.value),t&&r.length===t)break}catch(s){f=!0;e=s}finally{try{!u&&i["return"]&&i["return"]()}finally{if(f)throw e;}}return r}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return n(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance");}}();t.default=h;var f=i(23),e=i(3),o=s(e);u=t.KEY="clear_column"},function(n,t,i){"use strict";function s(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function h(){return{key:u,name:function(){return this.getTranslatedPhrase(o.CONTEXTMENU_ITEMS_INSERT_LEFT)},callback:function(n,t){var i=t[Math.max(t.length-1,0)];this.alter("insert_col",i.start.col,1,"ContextMenu.columnLeft")},disabled:function(){var t=f.getValidSelection(this);if(!t||!this.isColumnModificationAllowed())return!0;var n=r(t[0],4),i=n[0],u=n[1],e=n[2],c=n[3],o=[i,0,e,this.countCols()-1],s=o.join(",")===t.join(","),h=this.countCols()===1;return u<0||this.countCols()>=this.getSettings().maxCols||!h&&s},hidden:function(){return!this.getSettings().allowInsertColumn}}}var r,u;t.__esModule=!0;t.KEY=undefined;r=function(){function n(n,t){var r=[],u=!0,f=!1,e=undefined,i,o;try{for(i=n[Symbol.iterator]();!(u=(o=i.next()).done);u=!0)if(r.push(o.value),t&&r.length===t)break}catch(s){f=!0;e=s}finally{try{!u&&i["return"]&&i["return"]()}finally{if(f)throw e;}}return r}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return n(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance");}}();t.default=h;var f=i(23),e=i(3),o=s(e);u=t.KEY="col_left"},function(n,t,i){"use strict";function s(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function h(){return{key:u,name:function(){return this.getTranslatedPhrase(o.CONTEXTMENU_ITEMS_INSERT_RIGHT)},callback:function(n,t){var i=t[Math.max(t.length-1,0)];this.alter("insert_col",i.end.col+1,1,"ContextMenu.columnRight")},disabled:function(){var t=f.getValidSelection(this);if(!t||!this.isColumnModificationAllowed())return!0;var n=r(t[0],4),i=n[0],u=n[1],e=n[2],c=n[3],o=[i,0,e,this.countCols()-1],s=o.join(",")===t.join(","),h=this.countCols()===1;return u<0||this.countCols()>=this.getSettings().maxCols||!h&&s},hidden:function(){return!this.getSettings().allowInsertColumn}}}var r,u;t.__esModule=!0;t.KEY=undefined;r=function(){function n(n,t){var r=[],u=!0,f=!1,e=undefined,i,o;try{for(i=n[Symbol.iterator]();!(u=(o=i.next()).done);u=!0)if(r.push(o.value),t&&r.length===t)break}catch(s){f=!0;e=s}finally{try{!u&&i["return"]&&i["return"]()}finally{if(f)throw e;}}return r}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return n(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance");}}();t.default=h;var f=i(23),e=i(3),o=s(e);u=t.KEY="col_right"},function(n,t,i){"use strict";function s(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function h(){return{key:u,name:function(){var t=this,n=this.getTranslatedPhrase(o.CONTEXTMENU_ITEMS_READ_ONLY),i=r.checkSelectionConsistency(this.getSelectedRange(),function(n,i){return t.getCellMeta(n,i).readOnly});return i&&(n=r.markLabelAsSelected(n)),n},callback:function(){var n=this,t=this.getSelectedRange(),i=r.checkSelectionConsistency(t,function(t,i){return n.getCellMeta(t,i).readOnly});f.arrayEach(t,function(t){t.forAll(function(t,r){n.setCellMeta(t,r,"readOnly",!i)})});this.render()},disabled:function(){return!(this.getSelectedRange()&&!this.selection.selectedHeader.corner)}}}var u;t.__esModule=!0;t.KEY=undefined;t.default=h;var r=i(23),f=i(0),e=i(3),o=s(e);u=t.KEY="make_read_only"},function(n,t,i){"use strict";function e(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function o(){return{key:f,name:function(){return this.getTranslatedPhrase(u.CONTEXTMENU_ITEMS_REDO)},callback:function(){this.redo()},disabled:function(){return this.undoRedo&&!this.undoRedo.isRedoAvailable()}}}var r,u,f;t.__esModule=!0;t.KEY=undefined;t.default=o;r=i(3);u=e(r);f=t.KEY="redo"},function(n,t,i){"use strict";function h(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function c(){return{key:u,name:function(){var n=this.getSelected(),t=0;if(n)if(n.length>1)t=1;else{var i=r(n[0],4),u=i[1],f=i[3];u-f!=0&&(t=1)}return this.getTranslatedPhrase(s.CONTEXTMENU_ITEMS_REMOVE_COLUMN,t)},callback:function(){this.alter("remove_col",e.transformSelectionToColumnDistance(this.getSelected()),null,"ContextMenu.removeColumn")},disabled:function(){var n=f.getValidSelection(this),t=this.countCols();return n?this.selection.selectedHeader.rows||this.selection.selectedHeader.corner||!this.isColumnModificationAllowed()||!t:!0},hidden:function(){return!this.getSettings().allowRemoveColumn}}}var r,u;t.__esModule=!0;t.KEY=undefined;r=function(){function n(n,t){var r=[],u=!0,f=!1,e=undefined,i,o;try{for(i=n[Symbol.iterator]();!(u=(o=i.next()).done);u=!0)if(r.push(o.value),t&&r.length===t)break}catch(s){f=!0;e=s}finally{try{!u&&i["return"]&&i["return"]()}finally{if(f)throw e;}}return r}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return n(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance");}}();t.default=c;var f=i(23),l=i(0),e=i(154),o=i(3),s=h(o);u=t.KEY="remove_col"},function(n,t,i){"use strict";function h(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function c(){return{key:u,name:function(){var n=this.getSelected(),t=0;if(n)if(n.length>1)t=1;else{var i=r(n[0],3),u=i[0],f=i[2];u-f!=0&&(t=1)}return this.getTranslatedPhrase(s.CONTEXTMENU_ITEMS_REMOVE_ROW,t)},callback:function(){this.alter("remove_row",e.transformSelectionToRowDistance(this.getSelected()),null,"ContextMenu.removeRow")},disabled:function(){var n=f.getValidSelection(this),t=this.countRows();return n?this.selection.selectedHeader.cols||this.selection.selectedHeader.corner||!t:!0},hidden:function(){return!this.getSettings().allowRemoveRow}}}var r,u;t.__esModule=!0;t.KEY=undefined;r=function(){function n(n,t){var r=[],u=!0,f=!1,e=undefined,i,o;try{for(i=n[Symbol.iterator]();!(u=(o=i.next()).done);u=!0)if(r.push(o.value),t&&r.length===t)break}catch(s){f=!0;e=s}finally{try{!u&&i["return"]&&i["return"]()}finally{if(f)throw e;}}return r}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return n(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance");}}();t.default=c;var f=i(23),l=i(0),e=i(154),o=i(3),s=h(o);u=t.KEY="remove_row"},function(n,t,i){"use strict";function o(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function s(){return{key:r,name:function(){return this.getTranslatedPhrase(e.CONTEXTMENU_ITEMS_ROW_ABOVE)},callback:function(n,t){var i=t[Math.max(t.length-1,0)];this.alter("insert_row",i.start.row,1,"ContextMenu.rowAbove")},disabled:function(){var n=u.getValidSelection(this);return n?this.selection.selectedHeader.cols||this.countRows()>=this.getSettings().maxRows:!0},hidden:function(){return!this.getSettings().allowInsertRow}}}var r;t.__esModule=!0;t.KEY=undefined;t.default=s;var u=i(23),f=i(3),e=o(f);r=t.KEY="row_above"},function(n,t,i){"use strict";function o(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function s(){return{key:r,name:function(){return this.getTranslatedPhrase(e.CONTEXTMENU_ITEMS_ROW_BELOW)},callback:function(n,t){var i=t[Math.max(t.length-1,0)];this.alter("insert_row",i.end.row+1,1,"ContextMenu.rowBelow")},disabled:function(){var n=u.getValidSelection(this);return n?this.selection.selectedHeader.cols||this.countRows()>=this.getSettings().maxRows:!0},hidden:function(){return!this.getSettings().allowInsertRow}}}var r;t.__esModule=!0;t.KEY=undefined;t.default=s;var u=i(23),f=i(3),e=o(f);r=t.KEY="row_below"},function(n,t,i){"use strict";function e(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function o(){return{key:f,name:function(){return this.getTranslatedPhrase(u.CONTEXTMENU_ITEMS_UNDO)},callback:function(){this.undo()},disabled:function(){return this.undoRedo&&!this.undoRedo.isUndoAvailable()}}}var r,u,f;t.__esModule=!0;t.KEY=undefined;t.default=o;r=i(3);u=e(r);f=t.KEY="undo"},function(n,t,i){"use strict";function o(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var f;t.__esModule=!0;var e=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),r=i(2),u=i(11);f=function(){function n(t){o(this,n);var e=r.getWindowScrollTop(),s=r.getWindowScrollLeft(),i=void 0,h=void 0,f=void 0,c=void 0,l=void 0,a=void 0;this.type=this.getSourceType(t);this.type==="literal"?(i=parseInt(t.top,10),f=parseInt(t.left,10),l=t.height||0,a=t.width||0,h=i,c=f,i+=e,f+=s):this.type==="event"&&(i=parseInt(u.pageY(t),10),f=parseInt(u.pageX(t),10),l=t.target.clientHeight,a=t.target.clientWidth,h=i-e,c=f-s);this.top=i;this.topRelative=h;this.left=f;this.leftRelative=c;this.scrollTop=e;this.scrollLeft=s;this.cellHeight=l;this.cellWidth=a}return e(n,[{key:"getSourceType",value:function(n){var t="literal";return n instanceof Event&&(t="event"),t}},{key:"fitsAbove",value:function(n){return this.topRelative>=n.offsetHeight}},{key:"fitsBelow",value:function(n){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:window.innerHeight;return this.topRelative+n.offsetHeight<=t}},{key:"fitsOnRight",value:function(n){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:window.innerWidth;return this.leftRelative+this.cellWidth+n.offsetWidth<=t}},{key:"fitsOnLeft",value:function(n){return this.leftRelative>=n.offsetWidth}}]),n}();t.default=f},function(){},function(n,t,i){"use strict";function u(n){return n&&n.__esModule?n:{"default":n}}function ct(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function lt(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function at(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}t.__esModule=!0;var a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},v=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),o=function y(n,t,i){var r,u,f;return n===null&&(n=Function.prototype),r=Object.getOwnPropertyDescriptor(n,t),r===undefined?(u=Object.getPrototypeOf(n),u===null?undefined:y(u,t,i)):"value"in r?r.value:(f=r.get,f===undefined)?undefined:f.call(i)},p=i(7),w=u(p),b=i(14),r=u(b),k=i(205),s=u(k),h=i(8),d=i(2),f=i(0),c=i(4),g=i(6),nt=i(339),tt=u(nt),it=i(340),rt=u(it),ut=i(341),ft=u(ut),et=i(9),ot=u(et),st=i(342),ht=u(st);i(344);r.default.getSingleton().register("afterCopyLimit");r.default.getSingleton().register("modifyCopyableRange");r.default.getSingleton().register("beforeCut");r.default.getSingleton().register("afterCut");r.default.getSingleton().register("beforePaste");r.default.getSingleton().register("afterPaste");r.default.getSingleton().register("beforeCopy");r.default.getSingleton().register("afterCopy");var vt=1e3,yt=1e3,e=new WeakMap,l=function(n){function t(n){ct(this,t);var i=lt(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return i.eventManager=new ot.default(i),i.columnsLimit=yt,i.copyableRanges=[],i.pasteMode="overwrite",i.rowsLimit=vt,i.textarea=void 0,e.set(i,{isTriggeredByCopy:!1,isTriggeredByCut:!1,isBeginEditing:!1,isFragmentSelectionEnabled:!1}),i}return at(t,n),v(t,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().copyPaste}},{key:"enablePlugin",value:function(){var i=this,n,r;this.enabled||(n=this.hot.getSettings(),r=e.get(this),this.textarea=tt.default.getSingleton(),r.isFragmentSelectionEnabled=n.fragmentSelection,a(n.copyPaste)==="object"&&(this.pasteMode=n.copyPaste.pasteMode||this.pasteMode,this.rowsLimit=n.copyPaste.rowsLimit||this.rowsLimit,this.columnsLimit=n.copyPaste.columnsLimit||this.columnsLimit),this.addHook("afterContextMenuDefaultOptions",function(n){return i.onAfterContextMenuDefaultOptions(n)}),this.addHook("afterSelectionEnd",function(){return i.onAfterSelectionEnd()}),this.registerEvents(),o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin();this.enablePlugin();o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.textarea&&this.textarea.destroy();o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disablePlugin",this).call(this)}},{key:"setCopyableText",value:function(){var n=this.hot.getSelectedRangeLast();if(n){var f=n.getTopLeftCorner(),e=n.getBottomRightCorner(),t=f.row,i=f.col,r=e.row,u=e.col,o=Math.min(r,t+this.rowsLimit-1),s=Math.min(u,i+this.columnsLimit-1);this.copyableRanges.length=0;this.copyableRanges.push({startRow:t,startCol:i,endRow:o,endCol:s});this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);(r!==o||u!==s)&&this.hot.runHooks("afterCopyLimit",r-t+1,u-i+1,this.rowsLimit,this.columnsLimit)}}},{key:"getRangedCopyableData",value:function(n){var u=this,r=[],t=[],i=[];return f.arrayEach(n,function(n){c.rangeEach(n.startRow,n.endRow,function(n){t.indexOf(n)===-1&&t.push(n)});c.rangeEach(n.startCol,n.endCol,function(n){i.indexOf(n)===-1&&i.push(n)})}),f.arrayEach(t,function(n){var t=[];f.arrayEach(i,function(i){t.push(u.hot.getCopyableData(n,i))});r.push(t)}),s.default.stringify(r)}},{key:"getRangedData",value:function(n){var u=this,r=[],t=[],i=[];return f.arrayEach(n,function(n){c.rangeEach(n.startRow,n.endRow,function(n){t.indexOf(n)===-1&&t.push(n)});c.rangeEach(n.startCol,n.endCol,function(n){i.indexOf(n)===-1&&i.push(n)})}),f.arrayEach(t,function(n){var t=[];f.arrayEach(i,function(i){t.push(u.hot.getCopyableData(n,i))});r.push(t)}),r}},{key:"copy",value:function(){var n=e.get(this);n.isTriggeredByCopy=!0;this.textarea.select();document.execCommand("copy")}},{key:"cut",value:function(){var n=e.get(this);n.isTriggeredByCut=!0;this.textarea.select();document.execCommand("cut")}},{key:"paste",value:function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"",n=new ht.default;n.clipboardData.setData("text/plain",t);this.onPaste(n)}},{key:"registerEvents",value:function(){var n=this;this.eventManager.addEventListener(this.textarea.element,"paste",function(t){return n.onPaste(t)});this.eventManager.addEventListener(this.textarea.element,"cut",function(t){return n.onCut(t)});this.eventManager.addEventListener(this.textarea.element,"copy",function(t){return n.onCopy(t)})}},{key:"onCopy",value:function(n){var r=e.get(this);if(this.hot.isListening()||r.isTriggeredByCopy){this.setCopyableText();r.isTriggeredByCopy=!1;var t=this.getRangedData(this.copyableRanges),u=!!this.hot.runHooks("beforeCopy",t,this.copyableRanges),i="";u&&(i=s.default.stringify(t),n&&n.clipboardData?n.clipboardData.setData("text/plain",i):typeof ClipboardEvent=="undefined"&&window.clipboardData.setData("Text",i),this.hot.runHooks("afterCopy",t,this.copyableRanges));n.preventDefault()}}},{key:"onCut",value:function(n){var r=e.get(this);if(this.hot.isListening()||r.isTriggeredByCut){this.setCopyableText();r.isTriggeredByCut=!1;var t=this.getRangedData(this.copyableRanges),u=!!this.hot.runHooks("beforeCut",t,this.copyableRanges),i=void 0;u&&(i=s.default.stringify(t),n&&n.clipboardData?n.clipboardData.setData("text/plain",i):typeof ClipboardEvent=="undefined"&&window.clipboardData.setData("Text",i),this.hot.emptySelectedCells(),this.hot.runHooks("afterCut",t,this.copyableRanges));n.preventDefault()}}},{key:"onPaste",value:function(n){var y=this,t,l;if(this.hot.isListening()&&(n&&n.preventDefault&&n.preventDefault(),t=void 0,n&&typeof n.clipboardData!="undefined"?this.textarea.setValue(n.clipboardData.getData("text/plain")):typeof ClipboardEvent=="undefined"&&typeof clipboardData!="undefined"&&this.textarea.setValue(window.clipboardData.getData("Text")),t=s.default.parse(this.textarea.getValue()),this.textarea.setValue(" "),t.length!==0)&&(l=!!this.hot.runHooks("beforePaste",t,this.copyableRanges),l)){var i=this.hot.getSelectedLast(),r=new h.CellCoords(i[0],i[1]),o=new h.CellCoords(i[2],i[3]),a=new h.CellRange(r,r,o),c=a.getTopLeftCorner(),v=a.getBottomRightCorner(),u=c,e=new h.CellCoords(Math.max(v.row,t.length-1+c.row),Math.max(v.col,t[0].length-1+c.col)),p=o.row-r.row>=t.length-1,w=o.col-r.col>=t[0].length-1;this.hot.addHookOnce("afterChange",function(n){var r=n?n.length:0,t,i;r&&(t={row:0,col:0},i=-1,f.arrayEach(n,function(u,f){var e=r>f+1?n[f+1]:null;e&&(p||(t.row+=Math.max(e[0]-u[0]-1,0)),!w&&u[1]>i&&(i=u[1],t.col+=Math.max(e[1]-u[1]-1,0)))}),y.hot.selectCell(u.row,u.col,e.row+t.row,e.col+t.col))});this.hot.populateFromArray(u.row,u.col,t,e.row,e.col,"CopyPaste.paste",this.pasteMode);this.hot.runHooks("afterPaste",t,this.copyableRanges)}}},{key:"onAfterContextMenuDefaultOptions",value:function(n){n.items.push({name:"---------"},rt.default(this),ft.default(this))}},{key:"onAfterSelectionEnd",value:function(){var t=e.get(this),n=this.hot.getActiveEditor();n&&typeof n.isOpened!="undefined"&&n.isOpened()||t.isFragmentSelectionEnabled&&!this.textarea.isActive()&&d.getSelectionText()||(this.setCopyableText(),this.textarea.select())}},{key:"destroy",value:function(){this.textarea&&this.textarea.destroy();o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}}]),t}(w.default);g.registerPlugin("CopyPaste",l);t.default=l},function(n,t){"use strict";function f(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var i,r,u;t.__esModule=!0;i=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}();r=function(){function n(){f(this,n);this.element=void 0;this.isAppended=!1;this.refCounter=0}return i(n,null,[{key:"getSingleton",value:function(){return u.append(),u}}]),i(n,[{key:"append",value:function(){this.hasBeenDestroyed()&&this.create();this.refCounter++;!this.isAppended&&document.body&&document.body&&(this.isAppended=!0,document.body.appendChild(this.element))}},{key:"create",value:function(){this.element=document.createElement("textarea");this.element.id="HandsontableCopyPaste";this.element.className="copyPaste";this.element.tabIndex=-1;this.element.autocomplete="off";this.element.wrap="hard";this.element.value=" "}},{key:"deselect",value:function(){this.element===document.activeElement&&document.activeElement.blur()}},{key:"destroy",value:function(){this.refCounter--;this.refCounter=this.refCounter<0?0:this.refCounter;this.hasBeenDestroyed()&&this.element&&this.element.parentNode&&(this.element.parentNode.removeChild(this.element),this.element=null,this.isAppended=!1)}},{key:"getValue",value:function(){return this.element.value}},{key:"hasBeenDestroyed",value:function(){return this.refCounter<1}},{key:"isActive",value:function(){return this.element===document.activeElement}},{key:"select",value:function(){this.element.focus();this.element.select()}},{key:"setValue",value:function(n){this.element.value=n}}]),n}();u=new r;t.default=r},function(n,t,i){"use strict";function f(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function e(n){return{key:"copy",name:function(){return this.getTranslatedPhrase(u.CONTEXTMENU_ITEMS_COPY)},callback:function(){n.copy()},disabled:function(){var n=this.getSelected();return!n||n.length>1?!0:!1},hidden:!1}}t.__esModule=!0;t.default=e;var r=i(3),u=f(r)},function(n,t,i){"use strict";function f(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function e(n){return{key:"cut",name:function(){return this.getTranslatedPhrase(u.CONTEXTMENU_ITEMS_CUT)},callback:function(){n.cut()},disabled:function(){var n=this.getSelected();return!n||n.length>1?!0:!1},hidden:!1}}t.__esModule=!0;t.default=e;var r=i(3),u=f(r)},function(n,t,i){"use strict";function e(n){return n&&n.__esModule?n:{"default":n}}function o(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var u,f,r;t.__esModule=!0;u=i(343);f=e(u);r=function r(){o(this,r);this.clipboardData=new f.default};t.default=r},function(n,t){"use strict";function u(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var i,r;t.__esModule=!0;i=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}();r=function(){function n(){u(this,n);this.data={}}return i(n,[{key:"setData",value:function(n,t){this.data[n]=t}},{key:"getData",value:function(n){return this.data[n]||void 0}}]),n}();t.default=r},function(){},function(n,t,i){"use strict";function it(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function rt(n){return n&&n.__esModule?n:{"default":n}}function b(){}t.__esModule=!0;var g=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},nt=i(14),l=rt(nt),r=i(1),a=i(0),w=i(8),tt=i(3),f=it(tt);var h,ut=function(n){return typeof n=="boolean"&&n===!0?!0:(typeof n=="undefined"?"undefined":g(n))==="object"&&n.length>0?!0:!1},ft=function(){ut(this.getSettings().customBorders)&&(this.customBorders||(h=this,this.customBorders=new b))},et=function(n){var t=-1;return a.arrayEach(h.selection.highlight.borders,function(i,r){if(i.settings.className==n)return t=r,!1}),t},v=function(n){var t={row:n.row,col:n.col},i=new w.Selection(n,new w.CellRange(t,t,t)),r=et(n.className);r>=0?h.selection.highlight.borders[r]=i:h.selection.highlight.borders.push(i)},ot=function(n,t,i){var r=p(n,t);r=lt(r,i);this.setCellMeta(n,t,"borders",r);v(r)},st=function(n){for(var i,u,e,t=n.range,f=t.from.row;f<=t.to.row;f++)for(i=t.from.col;i<=t.to.col;i++)u=p(f,i),e=0,f==t.from.row&&(e++,r.hasOwnProperty(n,"top")&&(u.top=n.top)),f==t.to.row&&(e++,r.hasOwnProperty(n,"bottom")&&(u.bottom=n.bottom)),i==t.from.col&&(e++,r.hasOwnProperty(n,"left")&&(u.left=n.left)),i==t.to.col&&(e++,r.hasOwnProperty(n,"right")&&(u.right=n.right)),e>0&&(this.setCellMeta(f,i,"borders",u),v(u))},y=function(n,t){return"border_row"+n+"col"+t},ht=function(){return{width:1,color:"#000"}},e=function(){return{hide:!0}},ct=function(){return{width:1,color:"#000",cornerVisible:!1}},p=function(n,t){return{className:y(n,t),border:ct(),row:n,col:t,top:e(),right:e(),bottom:e(),left:e()}},lt=function(n,t){return r.hasOwnProperty(t,"border")&&(n.border=t.border),r.hasOwnProperty(t,"top")&&(n.top=t.top),r.hasOwnProperty(t,"right")&&(n.right=t.right),r.hasOwnProperty(t,"bottom")&&(n.bottom=t.bottom),r.hasOwnProperty(t,"left")&&(n.left=t.left),n},k=function(n){for(var r,i=document.querySelectorAll("."+n),t=0;t<i.length;t++)i[t]&&i[t].nodeName!="TD"&&(r=i[t].parentNode,r.parentNode&&r.parentNode.removeChild(r))},d=function(n,t){var i=y(n,t);k(i);this.removeCellMeta(n,t,"borders")},o=function(n,t,i,r){var u=this.getCellMeta(n,t).borders,f;u&&u.border!=undefined||(u=p(n,t));u[i]=r?e():ht();this.setCellMeta(n,t,"borders",u);f=y(n,t);k(f);v(u)},s=function(n,t,i){var r=this;a.arrayEach(n,function(n){var u=n.start,f=n.end,e,s,h,c,l,a;if(u.row==f.row&&u.col==f.col)t=="noBorders"?d.call(r,u.row,u.col):o.call(r,u.row,u.col,t,i);else switch(t){case"noBorders":for(e=u.col;e<=f.col;e++)for(s=u.row;s<=f.row;s++)d.call(r,s,e);break;case"top":for(h=u.col;h<=f.col;h++)o.call(r,u.row,h,t,i);break;case"right":for(c=u.row;c<=f.row;c++)o.call(r,c,f.col,t);break;case"bottom":for(l=u.col;l<=f.col;l++)o.call(r,f.row,l,t);break;case"left":for(a=u.row;a<=f.row;a++)o.call(r,a,u.col,t)}});this.render()},u=function(n,t){var i=!1;return a.arrayEach(n.getSelectedRange(),function(u){u.forAll(function(u,f){var e=n.getCellMeta(u,f).borders;if(e)if(t){if(!r.hasOwnProperty(e[t],"hide"))return i=!0,!1}else return i=!0,!1})}),i},c=function(n){return'<span class="selected">'+String.fromCharCode(10003)+"<\/span>"+n},at=function(n){this.getSettings().customBorders&&(n.items.push({name:"---------"}),n.items.push({key:"borders",name:function(){return this.getTranslatedPhrase(f.CONTEXTMENU_ITEMS_BORDERS)},disabled:function(){return this.selection.selectedHeader.corner},submenu:{items:[{key:"borders:top",name:function(){var n=this.getTranslatedPhrase(f.CONTEXTMENU_ITEMS_BORDERS_TOP),t=u(this,"top");return t&&(n=c(n)),n},callback:function(n,t){var i=u(this,"top");s.call(this,t,"top",i)}},{key:"borders:right",name:function(){var n=this.getTranslatedPhrase(f.CONTEXTMENU_ITEMS_BORDERS_RIGHT),t=u(this,"right");return t&&(n=c(n)),n},callback:function(n,t){var i=u(this,"right");s.call(this,t,"right",i)}},{key:"borders:bottom",name:function(){var n=this.getTranslatedPhrase(f.CONTEXTMENU_ITEMS_BORDERS_BOTTOM),t=u(this,"bottom");return t&&(n=c(n)),n},callback:function(n,t){var i=u(this,"bottom");s.call(this,t,"bottom",i)}},{key:"borders:left",name:function(){var n=this.getTranslatedPhrase(f.CONTEXTMENU_ITEMS_BORDERS_LEFT),t=u(this,"left");return t&&(n=c(n)),n},callback:function(n,t){var i=u(this,"left");s.call(this,t,"left",i)}},{key:"borders:no_borders",name:function(){return this.getTranslatedPhrase(f.CONTEXTMENU_ITEMS_REMOVE_BORDERS)},callback:function(n,t){s.call(this,t,"noBorders")},disabled:function(){return!u(this)}}]}}))};l.default.getSingleton().add("beforeInit",ft);l.default.getSingleton().add("afterContextMenuDefaultOptions",at);l.default.getSingleton().add("afterInit",function(){var t=this.getSettings().customBorders,n;if(t){for(n=0;n<t.length;n++)t[n].range?st.call(this,t[n]):ot.call(this,t[n].row,t[n].col,t[n]);this.render();this.view.wt.draw(!0)}});t.default=b},function(n,t,i){"use strict";function f(n){return n&&n.__esModule?n:{"default":n}}function v(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function y(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function p(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var u;t.__esModule=!0;var e=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),r=function o(n,t,i){var r,u,f;return n===null&&(n=Function.prototype),r=Object.getOwnPropertyDescriptor(n,t),r===undefined?(u=Object.getPrototypeOf(n),u===null?undefined:o(u,t,i)):"value"in r?r.value:(f=r.get,f===undefined)?undefined:f.call(i)},s=i(7),h=f(s),c=i(9),l=f(c),a=i(6);u=function(n){function t(n){v(this,t);var i=y(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return i.eventManager=new l.default(i),i.boundaries=null,i.callback=null,i.listening=!1,i}return p(t,n),e(t,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().dragToScroll}},{key:"enablePlugin",value:function(){var n=this;this.enabled||(this.addHook("afterOnCellMouseDown",function(){return n.setupListening()}),this.addHook("afterOnCellCornerMouseDown",function(){return n.setupListening()}),this.registerEvents(),r(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin();this.enablePlugin();r(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.unregisterEvents();r(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disablePlugin",this).call(this)}},{key:"setBoundaries",value:function(n){this.boundaries=n}},{key:"setCallback",value:function(n){this.callback=n}},{key:"check",value:function(n,t){var i=0,r=0;t<this.boundaries.top?r=t-this.boundaries.top:t>this.boundaries.bottom&&(r=t-this.boundaries.bottom);n<this.boundaries.left?i=n-this.boundaries.left:n>this.boundaries.right&&(i=n-this.boundaries.right);this.callback(i,r)}},{key:"registerEvents",value:function(){var n=this;this.eventManager.addEventListener(document,"mouseup",function(){return n.onMouseUp()});this.eventManager.addEventListener(document,"mousemove",function(t){return n.onMouseMove(t)})}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"setupListening",value:function(){var n=this.hot.view.wt.wtTable.holder;n!==window&&(this.setBoundaries(n.getBoundingClientRect()),this.setCallback(function(t,i){t<0?n.scrollLeft-=50:t>0&&(n.scrollLeft+=50);i<0?n.scrollTop-=20:i>0&&(n.scrollTop+=20)}),this.listening=!0)}},{key:"onMouseMove",value:function(n){this.listening&&this.check(n.clientX,n.clientY)}},{key:"onMouseUp",value:function(){this.listening=!1}},{key:"destroy",value:function(){r(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}}]),t}(h.default);a.registerPlugin("dragToScroll",u);t.default=u},function(n,t,i){"use strict";function f(n){return n&&n.__esModule?n:{"default":n}}function b(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function k(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function d(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var r,e;t.__esModule=!0;var o=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),u=function s(n,t,i){var r,u,f;return n===null&&(n=Function.prototype),r=Object.getOwnPropertyDescriptor(n,t),r===undefined?(u=Object.getPrototypeOf(n),u===null?undefined:s(u,t,i)):"value"in r?r.value:(f=r.get,f===undefined)?undefined:f.call(i)},h=i(7),c=f(h),l=i(6),a=i(0),v=i(348),y=f(v),p=i(349),w=f(p);i(350);r=new WeakMap;e=function(n){function t(n){b(this,t);var i=k(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return r.set(i,{moveByFreeze:!1,afterFirstUse:!1}),i.frozenColumnsBasePositions=[],i.manualColumnMovePlugin=void 0,i}return d(t,n),o(t,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().manualColumnFreeze}},{key:"enablePlugin",value:function(){var n=this;this.enabled||(this.addHook("afterContextMenuDefaultOptions",function(t){return n.addContextMenuEntry(t)}),this.addHook("afterInit",function(){return n.onAfterInit()}),this.addHook("beforeColumnMove",function(t,i){return n.onBeforeColumnMove(t,i)}),u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var n=r.get(this);n.afterFirstUse=!1;n.moveByFreeze=!1;u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin();this.enablePlugin();u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updatePlugin",this).call(this)}},{key:"freezeColumn",value:function(n){var i=r.get(this),t=this.hot.getSettings();(i.afterFirstUse||(i.afterFirstUse=!0),t.fixedColumnsLeft===this.hot.countCols()||n<=t.fixedColumnsLeft-1)||(i.moveByFreeze=!0,n!==this.getMovePlugin().columnsMapper.getValueByIndex(n)&&(this.frozenColumnsBasePositions[t.fixedColumnsLeft]=n),this.getMovePlugin().moveColumn(n,t.fixedColumnsLeft++))}},{key:"unfreezeColumn",value:function(n){var t=r.get(this),i=this.hot.getSettings(),u;(t.afterFirstUse||(t.afterFirstUse=!0),i.fixedColumnsLeft<=0||n>i.fixedColumnsLeft-1)||(u=this.getBestColumnReturnPosition(n),t.moveByFreeze=!0,i.fixedColumnsLeft--,this.getMovePlugin().moveColumn(n,u+1))}},{key:"getMovePlugin",value:function(){return this.manualColumnMovePlugin||(this.manualColumnMovePlugin=this.hot.getPlugin("manualColumnMove")),this.manualColumnMovePlugin}},{key:"getBestColumnReturnPosition",value:function(n){var r=this.getMovePlugin(),f=this.hot.getSettings(),t=f.fixedColumnsLeft,i=r.columnsMapper.getValueByIndex(t),u=void 0;if(this.frozenColumnsBasePositions[n]===null||this.frozenColumnsBasePositions[n]===void 0)for(u=r.columnsMapper.getValueByIndex(n);i!==null&&i<=u;)t++,i=r.columnsMapper.getValueByIndex(t);else{for(u=this.frozenColumnsBasePositions[n],this.frozenColumnsBasePositions[n]=void 0;i!==null&&i<=u;)t++,i=r.columnsMapper.getValueByIndex(t);t=i}return t-1}},{key:"addContextMenuEntry",value:function(n){n.items.push({name:"---------"},y.default(this),w.default(this))}},{key:"onAfterInit",value:function(){this.getMovePlugin().isEnabled()||this.getMovePlugin().enablePlugin()}},{key:"onBeforeColumnMove",value:function(n,t){var i=r.get(this),f,u;if(i.afterFirstUse&&!i.moveByFreeze&&(f=this.hot.getSettings().fixedColumnsLeft,u=t<f,u||a.arrayEach(n,function(n){if(n<f)return u=!0,!1}),u))return!1;i.moveByFreeze&&(i.moveByFreeze=!1)}},{key:"destroy",value:function(){u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}}]),t}(c.default);l.registerPlugin("manualColumnFreeze",e);t.default=e},function(n,t,i){"use strict";function e(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function o(n){return{key:"freeze_column",name:function(){return this.getTranslatedPhrase(f.CONTEXTMENU_ITEMS_FREEZE_COLUMN)},callback:function(t,i){var u=r(i,1),f=u[0].start.col;n.freezeColumn(f);this.render();this.view.wt.wtOverlays.adjustElementsSize(!0)},hidden:function(){var n=this.getSelectedRange(),t=!1;return n===void 0?t=!0:n.length>1?t=!0:(n[0].from.col!==n[0].to.col||n[0].from.col<=this.getSettings().fixedColumnsLeft-1)&&(t=!0),t}}}var r,u,f;t.__esModule=!0;r=function(){function n(n,t){var r=[],u=!0,f=!1,e=undefined,i,o;try{for(i=n[Symbol.iterator]();!(u=(o=i.next()).done);u=!0)if(r.push(o.value),t&&r.length===t)break}catch(s){f=!0;e=s}finally{try{!u&&i["return"]&&i["return"]()}finally{if(f)throw e;}}return r}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return n(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance");}}();t.default=o;u=i(3);f=e(u)},function(n,t,i){"use strict";function e(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function o(n){return{key:"unfreeze_column",name:function(){return this.getTranslatedPhrase(f.CONTEXTMENU_ITEMS_UNFREEZE_COLUMN)},callback:function(t,i){var u=r(i,1),f=u[0].start.col;n.unfreezeColumn(f);this.render();this.view.wt.wtOverlays.adjustElementsSize(!0)},hidden:function(){var n=this.getSelectedRange(),t=!1;return n===void 0?t=!0:n.length>1?t=!0:(n[0].from.col!==n[0].to.col||n[0].from.col>=this.getSettings().fixedColumnsLeft)&&(t=!0),t}}}var r,u,f;t.__esModule=!0;r=function(){function n(n,t){var r=[],u=!0,f=!1,e=undefined,i,o;try{for(i=n[Symbol.iterator]();!(u=(o=i.next()).done);u=!0)if(r.push(o.value),t&&r.length===t)break}catch(s){f=!0;e=s}finally{try{!u&&i["return"]&&i["return"]()}finally{if(f)throw e;}}return r}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return n(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance");}}();t.default=o;u=i(3);f=e(u)},function(){},function(n,t,i){"use strict";function f(n){return n&&n.__esModule?n:{"default":n}}function st(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function ht(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function ct(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}t.__esModule=!0;var p=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),e=function w(n,t,i){var r,u,f;return n===null&&(n=Function.prototype),r=Object.getOwnPropertyDescriptor(n,t),r===undefined?(u=Object.getPrototypeOf(n),u===null?undefined:w(u,t,i)):"value"in r?r.value:(f=r.get,f===undefined)?undefined:f.call(i)},b=i(7),k=f(b),d=i(14),s=f(d),h=i(0),r=i(2),a=i(4),g=i(9),nt=f(g),tt=i(6),it=i(352),rt=f(it),ut=i(353),ft=f(ut),et=i(354),ot=f(et),lt=i(8);i(355);s.default.getSingleton().register("beforeColumnMove");s.default.getSingleton().register("afterColumnMove");s.default.getSingleton().register("unmodifyCol");var u=new WeakMap,v="ht__manualColumnMove",o="show-ui",c="on-moving--columns",l="after-selection--columns",y=function(n){function t(n){st(this,t);var i=ht(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return u.set(i,{columnsToMove:[],countCols:0,fixedColumns:0,pressed:void 0,disallowMoving:void 0,target:{eventPageX:void 0,coords:void 0,TD:void 0,col:void 0}}),i.removedColumns=[],i.columnsMapper=new rt.default(i),i.eventManager=new nt.default(i),i.backlight=new ft.default(n),i.guideline=new ot.default(n),i}return ct(t,n),p(t,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().manualColumnMove}},{key:"enablePlugin",value:function(){var n=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(t,i,r,u){return n.onBeforeOnCellMouseDown(t,i,r,u)}),this.addHook("beforeOnCellMouseOver",function(t,i,r,u){return n.onBeforeOnCellMouseOver(t,i,r,u)}),this.addHook("afterScrollVertically",function(){return n.onAfterScrollVertically()}),this.addHook("modifyCol",function(t,i){return n.onModifyCol(t,i)}),this.addHook("beforeRemoveCol",function(t,i){return n.onBeforeRemoveCol(t,i)}),this.addHook("afterRemoveCol",function(){return n.onAfterRemoveCol()}),this.addHook("afterCreateCol",function(t,i){return n.onAfterCreateCol(t,i)}),this.addHook("afterLoadData",function(){return n.onAfterLoadData()}),this.addHook("unmodifyCol",function(t){return n.onUnmodifyCol(t)}),this.registerEvents(),r.addClass(this.hot.rootElement,v),e(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin();this.enablePlugin();this.onAfterPluginsInitialized();e(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var n=this.hot.getSettings().manualColumnMove;Array.isArray(n)&&this.columnsMapper.clearMap();r.removeClass(this.hot.rootElement,v);this.unregisterEvents();this.backlight.destroy();this.guideline.destroy();e(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disablePlugin",this).call(this)}},{key:"moveColumn",value:function(n,t){this.moveColumns([n],t)}},{key:"moveColumns",value:function(n,t){var i=this,f=u.get(this),r=this.hot.runHooks("beforeColumnMove",n,t);f.disallowMoving=!r;r!==!1&&(h.arrayEach(n,function(n,t,r){r[t]=i.columnsMapper.getValueByIndex(n)}),h.arrayEach(n,function(n,r){var u=i.columnsMapper.getIndexByValue(n);u!==t&&i.columnsMapper.moveColumn(u,t+r)}),this.columnsMapper.clearNull());this.hot.runHooks("afterColumnMove",n,t)}},{key:"changeSelection",value:function(n,t){this.hot.selectColumns(n,t)}},{key:"getColumnsWidth",value:function(n,t){for(var r,u=0,i=n;i<t;i++)r=0,r=i<0?this.hot.view.wt.wtViewport.getRowHeaderWidth()||0:this.hot.view.wt.wtTable.getStretchedColumnWidth(i)||0,u+=r;return u}},{key:"initialSettings",value:function(){var n=this.hot.getSettings().manualColumnMove;Array.isArray(n)?this.moveColumns(n,0):n!==void 0&&this.persistentStateLoad()}},{key:"isFixedColumnsLeft",value:function(n){return n<this.hot.getSettings().fixedColumnsLeft}},{key:"persistentStateSave",value:function(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.columnsMapper._arrayMap)}},{key:"persistentStateLoad",value:function(){var n={};this.hot.runHooks("persistentStateLoad","manualColumnMove",n);n.value&&(this.columnsMapper._arrayMap=n.value)}},{key:"prepareColumnsToMoving",value:function(n,t){var i=[];return a.rangeEach(n,t,function(n){i.push(n)}),i}},{key:"refreshPositions",value:function(){var n=u.get(this),t=this.hot.view.wt.wtTable.getFirstVisibleColumn(),v=this.hot.view.wt.wtTable.getLastVisibleColumn(),l=this.hot.view.wt.wtTable,i=this.hot.view.wt.wtOverlays.scrollableElement,a=typeof i.scrollX=="number"?i.scrollX:i.scrollLeft,r=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,n.coordsColumn),e=n.target.eventPageX-(n.rootElementOffset-(i.scrollX===void 0?a:0)),o=l.hider.offsetWidth,y=l.TBODY.offsetLeft,s=this.backlight.getOffset().left,p=this.backlight.getSize().width,h=0,w,c,f;n.rootElementOffset+l.holder.offsetWidth+a<n.target.eventPageX&&n.coordsColumn<n.countCols&&n.coordsColumn++;n.hasRowHeaders&&(h=this.hot.view.wt.wtOverlays.leftOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth);this.isFixedColumnsLeft(n.coordsColumn)&&(r+=a);r+=h;n.coordsColumn<0?n.target.col=n.fixedColumns>0?0:t>0?t-1:t:n.target.TD.offsetWidth/2+r<=e?(w=n.coordsColumn>=n.countCols?n.countCols-1:n.coordsColumn,n.target.col=w+1,r+=n.target.TD.offsetWidth,n.target.col>v&&this.hot.scrollViewportTo(void 0,v+1,void 0,!0)):(n.target.col=n.coordsColumn,n.target.col<=t&&n.target.col>=n.fixedColumns&&this.hot.scrollViewportTo(void 0,t-1));n.target.col<=t&&n.target.col>=n.fixedColumns&&this.hot.scrollViewportTo(void 0,t-1);c=e;f=r;e+p+s>=o?c=o-p-s:e+s<y+h&&(c=y+h+Math.abs(s));r>=o-1?f=o-1:f===0?f=1:i.scrollX!==void 0&&n.coordsColumn<n.fixedColumns&&(f-=n.rootElementOffset<=i.scrollX?n.rootElementOffset:0);this.backlight.setPosition(null,c);this.guideline.setPosition(null,f)}},{key:"updateColumnsMapper",value:function(){var n=this.hot.countSourceCols(),t=this.columnsMapper._arrayMap.length,r,u,i;t===0?this.columnsMapper.createMap(n||this.hot.getSettings().startCols):t<n?(r=n-t,this.columnsMapper.insertItems(t,r)):t>n&&(u=n-1,i=[],h.arrayEach(this.columnsMapper._arrayMap,function(n,t){n>u&&i.push(t)}),this.columnsMapper.removeItems(i))}},{key:"registerEvents",value:function(){var n=this;this.eventManager.addEventListener(document.documentElement,"mousemove",function(t){return n.onMouseMove(t)});this.eventManager.addEventListener(document.documentElement,"mouseup",function(){return n.onMouseUp()})}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"onBeforeOnCellMouseDown",value:function(n,t,i,f){var s=this.hot.view.wt.wtTable,nt=this.hot.selection.selectedHeader.cols,a=this.hot.getSelectedRangeLast(),e=u.get(this),tt=n.realTarget.className.indexOf("columnSorting")>-1,y,p;if(!a||!nt||e.pressed||n.button!==0||tt){e.pressed=!1;e.columnsToMove.length=0;r.removeClass(this.hot.rootElement,[c,o]);return}y=this.guideline.isBuilt()&&!this.guideline.isAppended();p=this.backlight.isBuilt()&&!this.backlight.isAppended();y&&p&&(this.guideline.appendTo(s.hider),this.backlight.appendTo(s.hider));var w=a.from,b=a.to,h=Math.min(w.col,b.col),v=Math.max(w.col,b.col);if(t.row<0&&t.col>=h&&t.col<=v){f.column=!0;e.pressed=!0;e.target.eventPageX=n.pageX;e.coordsColumn=t.col;e.target.TD=i;e.target.col=t.col;e.columnsToMove=this.prepareColumnsToMoving(h,v);e.hasRowHeaders=!!this.hot.getSettings().rowHeaders;e.countCols=this.hot.countCols();e.fixedColumns=this.hot.getSettings().fixedColumnsLeft;e.rootElementOffset=r.offset(this.hot.rootElement).left;var it=e.hasRowHeaders?-1:0,k=s.holder.scrollTop+s.getColumnHeaderHeight(0)+1,rt=t.col<e.fixedColumns,d=this.hot.view.wt.wtOverlays.scrollableElement,ut=d.scrollX?d.scrollX-e.rootElementOffset:0,ft=n.layerX-(rt?ut:0),g=Math.abs(this.getColumnsWidth(h,t.col)+ft);this.backlight.setPosition(k,this.getColumnsWidth(it,h)+g);this.backlight.setSize(this.getColumnsWidth(h,v+1),s.hider.offsetHeight-k);this.backlight.setOffset(null,g*-1);r.addClass(this.hot.rootElement,c)}else r.removeClass(this.hot.rootElement,l),e.pressed=!1,e.columnsToMove.length=0}},{key:"onMouseMove",value:function(n){var t=u.get(this),i;t.pressed&&(n.realTarget===this.backlight.element&&(i=this.backlight.getSize().width,this.backlight.setSize(0),setTimeout(function(){this.backlight.setPosition(i)})),t.target.eventPageX=n.pageX,this.refreshPositions())}},{key:"onBeforeOnCellMouseOver",value:function(n,t,i,f){var s=this.hot.getSelectedRangeLast(),e=u.get(this);s&&e.pressed&&(e.columnsToMove.indexOf(t.col)>-1?r.removeClass(this.hot.rootElement,o):r.addClass(this.hot.rootElement,o),f.row=!0,f.column=!0,f.cell=!0,e.coordsColumn=t.col,e.target.TD=i)}},{key:"onMouseUp",value:function(){var n=u.get(this),t,i;(n.coordsColumn=void 0,n.pressed=!1,n.backlightWidth=0,r.removeClass(this.hot.rootElement,[c,o,l]),this.hot.selection.selectedHeader.cols&&r.addClass(this.hot.rootElement,l),n.columnsToMove.length<1||n.target.col===void 0||n.columnsToMove.indexOf(n.target.col)>-1)||(this.moveColumns(n.columnsToMove,n.target.col),this.persistentStateSave(),this.hot.render(),this.hot.view.wt.wtOverlays.adjustElementsSize(!0),n.disallowMoving||(t=this.columnsMapper.getIndexByValue(n.columnsToMove[0]),i=this.columnsMapper.getIndexByValue(n.columnsToMove[n.columnsToMove.length-1]),this.changeSelection(t,i)),n.columnsToMove.length=0)}},{key:"onAfterScrollVertically",value:function(){var n=this.hot.view.wt.wtTable,i=n.getColumnHeaderHeight(0)+1,r=n.holder.scrollTop,t=i+r;this.backlight.setPosition(t);this.backlight.setSize(null,n.hider.offsetHeight-t)}},{key:"onAfterCreateCol",value:function(n,t){this.columnsMapper.shiftItems(n,t)}},{key:"onBeforeRemoveCol",value:function(n,t){var i=this;this.removedColumns.length=0;n!==!1&&a.rangeEach(n,n+t-1,function(n){i.removedColumns.push(i.hot.runHooks("modifyCol",n,i.pluginName))})}},{key:"onAfterRemoveCol",value:function(){this.columnsMapper.unshiftItems(this.removedColumns)}},{key:"onAfterLoadData",value:function(){this.updateColumnsMapper()}},{key:"onModifyCol",value:function(n,t){if(t!==this.pluginName){var i=this.columnsMapper.getValueByIndex(n);n=i===null?n:i}return n}},{key:"onUnmodifyCol",value:function(n){var t=this.columnsMapper.getIndexByValue(n);return t===null?n:t}},{key:"onAfterPluginsInitialized",value:function(){this.updateColumnsMapper();this.initialSettings();this.backlight.build();this.guideline.build()}},{key:"destroy",value:function(){this.backlight.destroy();this.guideline.destroy();e(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}}]),t}(k.default);tt.registerPlugin("ManualColumnMove",y);t.default=y},function(n,t,i){"use strict";function c(n){return n&&n.__esModule?n:{"default":n}}function l(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var r;t.__esModule=!0;var u=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),f=i(54),e=c(f),o=i(0),s=i(1),h=i(4);r=function(){function n(t){l(this,n);this.manualColumnMove=t}return u(n,[{key:"createMap",value:function(n){var t=this,i=n===void 0?this._arrayMap.length:n;this._arrayMap.length=0;h.rangeEach(i-1,function(n){t._arrayMap[n]=n})}},{key:"destroy",value:function(){this._arrayMap=null}},{key:"moveColumn",value:function(n,t){var i=this._arrayMap[n];this._arrayMap[n]=null;this._arrayMap.splice(t,0,i)}},{key:"clearNull",value:function(){this._arrayMap=o.arrayFilter(this._arrayMap,function(n){return n!==null})}}]),n}();s.mixin(r,e.default);t.default=r},function(n,t,i){"use strict";function l(n){return n&&n.__esModule?n:{"default":n}}function a(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function v(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function y(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var r,u;t.__esModule=!0;var f=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),e=function o(n,t,i){var r,u,f;return n===null&&(n=Function.prototype),r=Object.getOwnPropertyDescriptor(n,t),r===undefined?(u=Object.getPrototypeOf(n),u===null?undefined:o(u,t,i)):"value"in r?r.value:(f=r.get,f===undefined)?undefined:f.call(i)},s=i(215),h=l(s),c=i(2);r="ht__manualColumnMove--backlight";u=function(n){function t(){return a(this,t),v(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return y(t,n),f(t,[{key:"build",value:function(){e(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"build",this).call(this);c.addClass(this._element,r)}}]),t}(h.default);t.default=u},function(n,t,i){"use strict";function l(n){return n&&n.__esModule?n:{"default":n}}function a(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function v(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function y(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var r,u;t.__esModule=!0;var f=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),e=function o(n,t,i){var r,u,f;return n===null&&(n=Function.prototype),r=Object.getOwnPropertyDescriptor(n,t),r===undefined?(u=Object.getPrototypeOf(n),u===null?undefined:o(u,t,i)):"value"in r?r.value:(f=r.get,f===undefined)?undefined:f.call(i)},s=i(215),h=l(s),c=i(2);r="ht__manualColumnMove--guideline";u=function(n){function t(){return a(this,t),v(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return y(t,n),f(t,[{key:"build",value:function(){e(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"build",this).call(this);c.addClass(this._element,r)}}]),t}(h.default);t.default=u},function(){},function(n,t,i){"use strict";function s(n){return n&&n.__esModule?n:{"default":n}}function b(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function k(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function d(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var f;t.__esModule=!0;var h=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),e=function c(n,t,i){var r,u,f;return n===null&&(n=Function.prototype),r=Object.getOwnPropertyDescriptor(n,t),r===undefined?(u=Object.getPrototypeOf(n),u===null?undefined:c(u,t,i)):"value"in r?r.value:(f=r.get,f===undefined)?undefined:f.call(i)},l=i(7),a=s(l),r=i(2),v=i(9),y=s(v),o=i(11),u=i(0),p=i(4),w=i(6);f=function(n){function t(n){b(this,t);var i=k(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return i.currentTH=null,i.currentCol=null,i.selectedCols=[],i.currentWidth=null,i.newSize=null,i.startY=null,i.startWidth=null,i.startOffset=null,i.handle=document.createElement("DIV"),i.guide=document.createElement("DIV"),i.eventManager=new y.default(i),i.pressed=null,i.dblclick=0,i.autoresizeTimeout=null,i.manualColumnWidths=[],r.addClass(i.handle,"manualColumnResizer"),r.addClass(i.guide,"manualColumnResizerGuide"),i}return d(t,n),h(t,[{key:"isEnabled",value:function(){return this.hot.getSettings().manualColumnResize}},{key:"enablePlugin",value:function(){var n=this,i,r;this.enabled||(this.manualColumnWidths=[],i=this.hot.getSettings().manualColumnResize,r=this.loadManualColumnWidths(),this.addHook("modifyColWidth",function(t,i){return n.onModifyColWidth(t,i)}),this.addHook("beforeStretchingColumnWidth",function(t,i){return n.onBeforeStretchingColumnWidth(t,i)}),this.addHook("beforeColumnResize",function(t,i,r){return n.onBeforeColumnResize(t,i,r)}),this.manualColumnWidths=typeof r!="undefined"?r:Array.isArray(i)?i:[],this.bindEvents(),e(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){var n=this.hot.getSettings().manualColumnResize;Array.isArray(n)?this.manualColumnWidths=n:n||(this.manualColumnWidths=[])}},{key:"disablePlugin",value:function(){e(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disablePlugin",this).call(this)}},{key:"saveManualColumnWidths",value:function(){this.hot.runHooks("persistentStateSave","manualColumnWidths",this.manualColumnWidths)}},{key:"loadManualColumnWidths",value:function(){var n={};return this.hot.runHooks("persistentStateLoad","manualColumnWidths",n),n.value}},{key:"setupHandlePosition",value:function(n){var c=this,f,e,t;if(!n.parentNode)return!1;if(this.currentTH=n,f=this.hot.view.wt.wtTable.getCoords(n).col,e=r.outerHeight(this.currentTH),f>=0){if(t=this.currentTH.getBoundingClientRect(),this.currentCol=f,this.selectedCols=[],this.hot.selection.isSelected()&&this.hot.selection.selectedHeader.cols){var o=this.hot.getSelectedRangeLast(),s=o.from,h=o.to,i=s.col,u=h.col;i>=u&&(i=h.col,u=s.col);this.currentCol>=i&&this.currentCol<=u?p.rangeEach(i,u,function(n){return c.selectedCols.push(n)}):this.selectedCols.push(this.currentCol)}else this.selectedCols.push(this.currentCol);this.startOffset=t.left-6;this.startWidth=parseInt(t.width,10);this.handle.style.top=t.top+"px";this.handle.style.left=this.startOffset+this.startWidth+"px";this.handle.style.height=e+"px";this.hot.rootElement.appendChild(this.handle)}}},{key:"refreshHandlePosition",value:function(){this.handle.style.left=this.startOffset+this.currentWidth+"px"}},{key:"setupGuidePosition",value:function(){var n=parseInt(r.outerHeight(this.handle),10),t=parseInt(this.handle.style.top,10)+n,i=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);r.addClass(this.handle,"active");r.addClass(this.guide,"active");this.guide.style.top=t+"px";this.guide.style.left=this.handle.style.left;this.guide.style.height=i-n+"px";this.hot.rootElement.appendChild(this.guide)}},{key:"refreshGuidePosition",value:function(){this.guide.style.left=this.handle.style.left}},{key:"hideHandleAndGuide",value:function(){r.removeClass(this.handle,"active");r.removeClass(this.guide,"active")}},{key:"checkIfColumnHeader",value:function(n){if(n!=this.hot.rootElement){var t=n.parentNode;return t.tagName==="THEAD"?!0:this.checkIfColumnHeader(t)}return!1}},{key:"getTHFromTargetElement",value:function(n){return n.tagName!="TABLE"?n.tagName=="TH"?n:this.getTHFromTargetElement(n.parentNode):null}},{key:"onMouseOver",value:function(n){var t,i;if(this.checkIfColumnHeader(n.target)){if(t=this.getTHFromTargetElement(n.target),!t)return;i=t.getAttribute("colspan");t&&(i===null||i===1)&&(this.pressed||this.setupHandlePosition(t))}}},{key:"afterMouseDownTimeout",value:function(){var n=this,t=function(){n.hot.forceFullRender=!0;n.hot.view.render();n.hot.view.wt.wtOverlays.adjustElementsSize(!0)},i=function(i,r){var u=n.hot.runHooks("beforeColumnResize",i,n.newSize,!0);u!==void 0&&(n.newSize=u);n.hot.getSettings().stretchH==="all"?n.clearManualSize(i):n.setManualSize(i,n.newSize);r&&t();n.saveManualColumnWidths();n.hot.runHooks("afterColumnResize",i,n.newSize,!0)},r;this.dblclick>=2&&(r=this.selectedCols.length,r>1?(u.arrayEach(this.selectedCols,function(n){i(n)}),t()):u.arrayEach(this.selectedCols,function(n){i(n,!0)}));this.dblclick=0;this.autoresizeTimeout=null}},{key:"onMouseDown",value:function(n){var t=this;r.hasClass(n.target,"manualColumnResizer")&&(this.setupGuidePosition(),this.pressed=this.hot,this.autoresizeTimeout===null&&(this.autoresizeTimeout=setTimeout(function(){return t.afterMouseDownTimeout()},500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick++,this.startX=o.pageX(n),this.newSize=this.startWidth)}},{key:"onMouseMove",value:function(n){var t=this;this.pressed&&(this.currentWidth=this.startWidth+(o.pageX(n)-this.startX),u.arrayEach(this.selectedCols,function(n){t.newSize=t.setManualSize(n,t.currentWidth)}),this.refreshHandlePosition(),this.refreshGuidePosition())}},{key:"onMouseUp",value:function(){var n=this,t=function(){n.hot.forceFullRender=!0;n.hot.view.render();n.hot.view.wt.wtOverlays.adjustElementsSize(!0)},i=function(i,r){n.hot.runHooks("beforeColumnResize",i,n.newSize);r&&t();n.saveManualColumnWidths();n.hot.runHooks("afterColumnResize",i,n.newSize)},r;this.pressed&&(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!=this.startWidth&&(r=this.selectedCols.length,r>1?(u.arrayEach(this.selectedCols,function(n){i(n)}),t()):u.arrayEach(this.selectedCols,function(n){i(n,!0)})),this.setupHandlePosition(this.currentTH))}},{key:"bindEvents",value:function(){var n=this;this.eventManager.addEventListener(this.hot.rootElement,"mouseover",function(t){return n.onMouseOver(t)});this.eventManager.addEventListener(this.hot.rootElement,"mousedown",function(t){return n.onMouseDown(t)});this.eventManager.addEventListener(window,"mousemove",function(t){return n.onMouseMove(t)});this.eventManager.addEventListener(window,"mouseup",function(t){return n.onMouseUp(t)})}},{key:"setManualSize",value:function(n,t){return t=Math.max(t,20),n=this.hot.runHooks("modifyCol",n),this.manualColumnWidths[n]=t,t}},{key:"clearManualSize",value:function(n){n=this.hot.runHooks("modifyCol",n);this.manualColumnWidths[n]=void 0}},{key:"onModifyColWidth",value:function(n,t){return this.enabled&&(t=this.hot.runHooks("modifyCol",t),this.hot.getSettings().manualColumnResize&&this.manualColumnWidths[t])?this.manualColumnWidths[t]:n}},{key:"onBeforeStretchingColumnWidth",value:function(n,t){var i=this.manualColumnWidths[t];return i===void 0&&(i=n),i}},{key:"onBeforeColumnResize",value:function(){this.hot.view.wt.wtViewport.hasOversizedColumnHeadersMarked={}}}]),t}(a.default);w.registerPlugin("manualColumnResize",f);t.default=f},function(n,t,i){"use strict";function f(n){return n&&n.__esModule?n:{"default":n}}function st(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function ht(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function ct(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}t.__esModule=!0;var p=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),e=function w(n,t,i){var r,u,f;return n===null&&(n=Function.prototype),r=Object.getOwnPropertyDescriptor(n,t),r===undefined?(u=Object.getPrototypeOf(n),u===null?undefined:w(u,t,i)):"value"in r?r.value:(f=r.get,f===undefined)?undefined:f.call(i)},b=i(7),k=f(b),d=i(14),s=f(d),h=i(0),r=i(2),a=i(4),g=i(9),nt=f(g),tt=i(6),it=i(358),rt=f(it),ut=i(359),ft=f(ut),et=i(360),ot=f(et),lt=i(8);i(361);s.default.getSingleton().register("beforeRowMove");s.default.getSingleton().register("afterRowMove");s.default.getSingleton().register("unmodifyRow");var u=new WeakMap,v="ht__manualRowMove",o="show-ui",c="on-moving--rows",l="after-selection--rows",y=function(n){function t(n){st(this,t);var i=ht(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return u.set(i,{rowsToMove:[],pressed:void 0,disallowMoving:void 0,target:{eventPageY:void 0,coords:void 0,TD:void 0,row:void 0}}),i.removedRows=[],i.rowsMapper=new rt.default(i),i.eventManager=new nt.default(i),i.backlight=new ft.default(n),i.guideline=new ot.default(n),i}return ct(t,n),p(t,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().manualRowMove}},{key:"enablePlugin",value:function(){var n=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(t,i,r,u){return n.onBeforeOnCellMouseDown(t,i,r,u)}),this.addHook("beforeOnCellMouseOver",function(t,i,r,u){return n.onBeforeOnCellMouseOver(t,i,r,u)}),this.addHook("afterScrollHorizontally",function(){return n.onAfterScrollHorizontally()}),this.addHook("modifyRow",function(t,i){return n.onModifyRow(t,i)}),this.addHook("beforeRemoveRow",function(t,i){return n.onBeforeRemoveRow(t,i)}),this.addHook("afterRemoveRow",function(){return n.onAfterRemoveRow()}),this.addHook("afterCreateRow",function(t,i){return n.onAfterCreateRow(t,i)}),this.addHook("afterLoadData",function(){return n.onAfterLoadData()}),this.addHook("beforeColumnSort",function(t,i){return n.onBeforeColumnSort(t,i)}),this.addHook("unmodifyRow",function(t){return n.onUnmodifyRow(t)}),this.registerEvents(),r.addClass(this.hot.rootElement,v),e(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin();this.enablePlugin();this.onAfterPluginsInitialized();e(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var n=this.hot.getSettings().manualRowMove;Array.isArray(n)&&this.rowsMapper.clearMap();r.removeClass(this.hot.rootElement,v);this.unregisterEvents();this.backlight.destroy();this.guideline.destroy();e(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disablePlugin",this).call(this)}},{key:"moveRow",value:function(n,t){this.moveRows([n],t)}},{key:"moveRows",value:function(n,t){var i=this,r=u.get(this),f=this.hot.runHooks("beforeRowMove",n,t);r.disallowMoving=f===!1;r.disallowMoving||(h.arrayEach(n,function(n,t,r){r[t]=i.rowsMapper.getValueByIndex(n)}),h.arrayEach(n,function(n,r){var u=i.rowsMapper.getIndexByValue(n);u!==t&&i.rowsMapper.moveRow(u,t+r)}),this.rowsMapper.clearNull());this.hot.runHooks("afterRowMove",n,t)}},{key:"changeSelection",value:function(n,t){this.hot.selectRows(n,t)}},{key:"getRowsHeight",value:function(n,t){for(var u,r=0,i=n;i<t;i++)u=this.hot.view.wt.wtTable.getRowHeight(i)||23,r+=u;return r}},{key:"initialSettings",value:function(){var n=this.hot.getSettings().manualRowMove,t;Array.isArray(n)?this.moveRows(n,0):n!==void 0&&(t=this.persistentStateLoad(),t.length&&this.moveRows(t,0))}},{key:"isFixedRowTop",value:function(n){return n<this.hot.getSettings().fixedRowsTop}},{key:"isFixedRowBottom",value:function(n){return n>this.hot.getSettings().fixedRowsBottom}},{key:"persistentStateSave",value:function(){this.hot.runHooks("persistentStateSave","manualRowMove",this.rowsMapper._arrayMap)}},{key:"persistentStateLoad",value:function(){var n={};return this.hot.runHooks("persistentStateLoad","manualRowMove",n),n.value?n.value:[]}},{key:"prepareRowsToMoving",value:function(){var n=this.hot.getSelectedRangeLast(),t=[];if(!n)return t;var i=n.from,r=n.to,u=Math.min(i.row,r.row),f=Math.max(i.row,r.row);return a.rangeEach(u,f,function(n){t.push(n)}),t}},{key:"refreshPositions",value:function(){var t=u.get(this),n=t.target.coords,i=this.hot.view.wt.wtTable.getFirstVisibleRow(),a=this.hot.view.wt.wtTable.getLastVisibleRow(),p=this.hot.getSettings().fixedRowsTop,k=this.hot.countRows(),c,l,y;n.row<p&&i>0&&this.hot.scrollViewportTo(i-1);n.row>=a&&a<k&&this.hot.scrollViewportTo(a+1,undefined,!0);var f=this.hot.view.wt.wtTable,v=t.target.TD,d=r.offset(this.hot.rootElement),e=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,n.row),o=t.target.eventPageY-d.top+f.holder.scrollTop,s=f.hider.offsetHeight,w=f.TBODY.offsetTop,h=this.backlight.getOffset().top,b=this.backlight.getSize().height;this.isFixedRowTop(n.row)&&(e+=f.holder.scrollTop);n.row<0?t.target.row=i>0?i-1:i:v.offsetHeight/2+e<=o?(t.target.row=n.row+1,e+=n.row===0?v.offsetHeight-1:v.offsetHeight):t.target.row=n.row;c=o;l=e;o+b+h>=s?c=s-b-h:o+h<w&&(c=w+Math.abs(h));e>=s-1&&(l=s-1);y=0;this.hot.view.wt.wtOverlays.topOverlay&&(y=this.hot.view.wt.wtOverlays.topOverlay.clone.wtTable.TABLE.offsetHeight);n.row>=p&&l-f.holder.scrollTop<y&&this.hot.scrollViewportTo(n.row);this.backlight.setPosition(c);this.guideline.setPosition(l)}},{key:"updateRowsMapper",value:function(){var n=this.hot.countSourceRows(),t=this.rowsMapper._arrayMap.length,r,u,i;t===0?this.rowsMapper.createMap(n||this.hot.getSettings().startRows):t<n?(r=n-t,this.rowsMapper.insertItems(t,r)):t>n&&(u=n-1,i=[],h.arrayEach(this.rowsMapper._arrayMap,function(n,t){n>u&&i.push(t)}),this.rowsMapper.removeItems(i))}},{key:"registerEvents",value:function(){var n=this;this.eventManager.addEventListener(document.documentElement,"mousemove",function(t){return n.onMouseMove(t)});this.eventManager.addEventListener(document.documentElement,"mouseup",function(){return n.onMouseUp()})}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"onBeforeColumnSort",value:function(n,t){var i=u.get(this);i.disallowMoving=t!==void 0}},{key:"onBeforeOnCellMouseDown",value:function(n,t,i,f){var s=this.hot.view.wt.wtTable,d=this.hot.selection.selectedHeader.rows,h=this.hot.getSelectedRangeLast(),e=u.get(this),y,p,v;if(!h||!d||e.pressed||n.button!==0){e.pressed=!1;e.rowsToMove.length=0;r.removeClass(this.hot.rootElement,[c,o]);return}y=this.guideline.isBuilt()&&!this.guideline.isAppended();p=this.backlight.isBuilt()&&!this.backlight.isAppended();y&&p&&(this.guideline.appendTo(s.hider),this.backlight.appendTo(s.hider));var w=h.from,b=h.to,a=Math.min(w.row,b.row),k=Math.max(w.row,b.row);t.col<0&&t.row>=a&&t.row<=k?(f.row=!0,e.pressed=!0,e.target.eventPageY=n.pageY,e.target.coords=t,e.target.TD=i,e.rowsToMove=this.prepareRowsToMoving(),v=s.holder.scrollLeft+this.hot.view.wt.wtViewport.getRowHeaderWidth(),this.backlight.setPosition(null,v),this.backlight.setSize(s.hider.offsetWidth-v,this.getRowsHeight(a,k+1)),this.backlight.setOffset((this.getRowsHeight(a,t.row)+n.layerY)*-1,null),r.addClass(this.hot.rootElement,c),this.refreshPositions()):(r.removeClass(this.hot.rootElement,l),e.pressed=!1,e.rowsToMove.length=0)}},{key:"onMouseMove",value:function(n){var t=u.get(this),i;t.pressed&&(n.realTarget===this.backlight.element&&(i=this.backlight.getSize().height,this.backlight.setSize(null,0),setTimeout(function(){this.backlight.setPosition(null,i)})),t.target.eventPageY=n.pageY,this.refreshPositions())}},{key:"onBeforeOnCellMouseOver",value:function(n,t,i,f){var s=this.hot.getSelectedRangeLast(),e=u.get(this);s&&e.pressed&&(e.rowsToMove.indexOf(t.row)>-1?r.removeClass(this.hot.rootElement,o):r.addClass(this.hot.rootElement,o),f.row=!0,f.column=!0,f.cell=!0,e.target.coords=t,e.target.TD=i)}},{key:"onMouseUp",value:function(){var n=u.get(this),t=n.target.row,i=n.rowsToMove.length,f,e;(n.pressed=!1,n.backlightHeight=0,r.removeClass(this.hot.rootElement,[c,o,l]),this.hot.selection.selectedHeader.rows&&r.addClass(this.hot.rootElement,l),i<1||t===void 0||n.rowsToMove.indexOf(t)>-1||n.rowsToMove[i-1]===t-1)||(this.moveRows(n.rowsToMove,t),this.persistentStateSave(),this.hot.render(),n.disallowMoving||(f=this.rowsMapper.getIndexByValue(n.rowsToMove[0]),e=this.rowsMapper.getIndexByValue(n.rowsToMove[i-1]),this.changeSelection(f,e)),n.rowsToMove.length=0)}},{key:"onAfterScrollHorizontally",value:function(){var n=this.hot.view.wt.wtTable,i=this.hot.view.wt.wtViewport.getRowHeaderWidth(),r=n.holder.scrollLeft,t=i+r;this.backlight.setPosition(null,t);this.backlight.setSize(n.hider.offsetWidth-t)}},{key:"onAfterCreateRow",value:function(n,t){this.rowsMapper.shiftItems(n,t)}},{key:"onBeforeRemoveRow",value:function(n,t){var i=this;this.removedRows.length=0;n!==!1&&a.rangeEach(n,n+t-1,function(n){i.removedRows.push(i.hot.runHooks("modifyRow",n,i.pluginName))})}},{key:"onAfterRemoveRow",value:function(){this.rowsMapper.unshiftItems(this.removedRows)}},{key:"onAfterLoadData",value:function(){this.updateRowsMapper()}},{key:"onModifyRow",value:function(n,t){if(t!==this.pluginName){var i=this.rowsMapper.getValueByIndex(n);n=i===null?n:i}return n}},{key:"onUnmodifyRow",value:function(n){var t=this.rowsMapper.getIndexByValue(n);return t===null?n:t}},{key:"onAfterPluginsInitialized",value:function(){this.updateRowsMapper();this.initialSettings();this.backlight.build();this.guideline.build()}},{key:"destroy",value:function(){this.backlight.destroy();this.guideline.destroy();e(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}}]),t}(k.default);tt.registerPlugin("ManualRowMove",y);t.default=y},function(n,t,i){"use strict";function c(n){return n&&n.__esModule?n:{"default":n}}function l(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var r;t.__esModule=!0;var u=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),f=i(54),e=c(f),o=i(0),s=i(1),h=i(4);r=function(){function n(t){l(this,n);this.manualRowMove=t}return u(n,[{key:"createMap",value:function(n){var t=this,i=n===void 0?this._arrayMap.length:n;this._arrayMap.length=0;h.rangeEach(i-1,function(n){t._arrayMap[n]=n})}},{key:"destroy",value:function(){this._arrayMap=null}},{key:"moveRow",value:function(n,t){var i=this._arrayMap[n];this._arrayMap[n]=null;this._arrayMap.splice(t,0,i)}},{key:"clearNull",value:function(){this._arrayMap=o.arrayFilter(this._arrayMap,function(n){return n!==null})}}]),n}();s.mixin(r,e.default);t.default=r},function(n,t,i){"use strict";function l(n){return n&&n.__esModule?n:{"default":n}}function a(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function v(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function y(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var r,u;t.__esModule=!0;var f=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),e=function o(n,t,i){var r,u,f;return n===null&&(n=Function.prototype),r=Object.getOwnPropertyDescriptor(n,t),r===undefined?(u=Object.getPrototypeOf(n),u===null?undefined:o(u,t,i)):"value"in r?r.value:(f=r.get,f===undefined)?undefined:f.call(i)},s=i(216),h=l(s),c=i(2);r="ht__manualRowMove--backlight";u=function(n){function t(){return a(this,t),v(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return y(t,n),f(t,[{key:"build",value:function(){e(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"build",this).call(this);c.addClass(this._element,r)}}]),t}(h.default);t.default=u},function(n,t,i){"use strict";function l(n){return n&&n.__esModule?n:{"default":n}}function a(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function v(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function y(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var r,u;t.__esModule=!0;var f=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),e=function o(n,t,i){var r,u,f;return n===null&&(n=Function.prototype),r=Object.getOwnPropertyDescriptor(n,t),r===undefined?(u=Object.getPrototypeOf(n),u===null?undefined:o(u,t,i)):"value"in r?r.value:(f=r.get,f===undefined)?undefined:f.call(i)},s=i(216),h=l(s),c=i(2);r="ht__manualRowMove--guideline";u=function(n){function t(){return a(this,t),v(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return y(t,n),f(t,[{key:"build",value:function(){e(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"build",this).call(this);c.addClass(this._element,r)}}]),t}(h.default);t.default=u},function(){},function(n,t,i){"use strict";function s(n){return n&&n.__esModule?n:{"default":n}}function b(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function k(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function d(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var f;t.__esModule=!0;var h=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),e=function c(n,t,i){var r,u,f;return n===null&&(n=Function.prototype),r=Object.getOwnPropertyDescriptor(n,t),r===undefined?(u=Object.getPrototypeOf(n),u===null?undefined:c(u,t,i)):"value"in r?r.value:(f=r.get,f===undefined)?undefined:f.call(i)},l=i(7),a=s(l),r=i(2),v=i(9),y=s(v),o=i(11),u=i(0),p=i(4),w=i(6);f=function(n){function t(n){b(this,t);var i=k(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return i.currentTH=null,i.currentRow=null,i.selectedRows=[],i.currentHeight=null,i.newSize=null,i.startY=null,i.startHeight=null,i.startOffset=null,i.handle=document.createElement("DIV"),i.guide=document.createElement("DIV"),i.eventManager=new y.default(i),i.pressed=null,i.dblclick=0,i.autoresizeTimeout=null,i.manualRowHeights=[],r.addClass(i.handle,"manualRowResizer"),r.addClass(i.guide,"manualRowResizerGuide"),i}return d(t,n),h(t,[{key:"isEnabled",value:function(){return this.hot.getSettings().manualRowResize}},{key:"enablePlugin",value:function(){var r=this,n,i;this.enabled||(this.manualRowHeights=[],n=this.hot.getSettings().manualRowResize,i=this.loadManualRowHeights(),this.manualRowHeights=typeof i!="undefined"?i:Array.isArray(n)?n:[],this.addHook("modifyRowHeight",function(n,t){return r.onModifyRowHeight(n,t)}),this.bindEvents(),e(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){var n=this.hot.getSettings().manualRowResize;Array.isArray(n)?this.manualRowHeights=n:n||(this.manualRowHeights=[])}},{key:"disablePlugin",value:function(){e(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disablePlugin",this).call(this)}},{key:"saveManualRowHeights",value:function(){this.hot.runHooks("persistentStateSave","manualRowHeights",this.manualRowHeights)}},{key:"loadManualRowHeights",value:function(){var n={};return this.hot.runHooks("persistentStateLoad","manualRowHeights",n),n.value}},{key:"setupHandlePosition",value:function(n){var c=this,f,e,t;if(this.currentTH=n,f=this.hot.view.wt.wtTable.getCoords(n).row,e=r.outerWidth(this.currentTH),f>=0){if(t=this.currentTH.getBoundingClientRect(),this.currentRow=f,this.selectedRows=[],this.hot.selection.isSelected()&&this.hot.selection.selectedHeader.rows){var o=this.hot.getSelectedRangeLast(),s=o.from,h=o.to,i=s.row,u=h.row;i>=u&&(i=h.row,u=s.row);this.currentRow>=i&&this.currentRow<=u?p.rangeEach(i,u,function(n){return c.selectedRows.push(n)}):this.selectedRows.push(this.currentRow)}else this.selectedRows.push(this.currentRow);this.startOffset=t.top-6;this.startHeight=parseInt(t.height,10);this.handle.style.left=t.left+"px";this.handle.style.top=this.startOffset+this.startHeight+"px";this.handle.style.width=e+"px";this.hot.rootElement.appendChild(this.handle)}}},{key:"refreshHandlePosition",value:function(){this.handle.style.top=this.startOffset+this.currentHeight+"px"}},{key:"setupGuidePosition",value:function(){var n=parseInt(r.outerWidth(this.handle),10),t=parseInt(this.handle.style.left,10)+n,i=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);r.addClass(this.handle,"active");r.addClass(this.guide,"active");this.guide.style.top=this.handle.style.top;this.guide.style.left=t+"px";this.guide.style.width=i-n+"px";this.hot.rootElement.appendChild(this.guide)}},{key:"refreshGuidePosition",value:function(){this.guide.style.top=this.handle.style.top}},{key:"hideHandleAndGuide",value:function(){r.removeClass(this.handle,"active");r.removeClass(this.guide,"active")}},{key:"checkIfRowHeader",value:function(n){if(n!=this.hot.rootElement){var t=n.parentNode;return t.tagName==="TBODY"?!0:this.checkIfRowHeader(t)}return!1}},{key:"getTHFromTargetElement",value:function(n){return n.tagName!="TABLE"?n.tagName=="TH"?n:this.getTHFromTargetElement(n.parentNode):null}},{key:"onMouseOver",value:function(n){if(this.checkIfRowHeader(n.target)){var t=this.getTHFromTargetElement(n.target);t&&(this.pressed||this.setupHandlePosition(t))}}},{key:"afterMouseDownTimeout",value:function(){var n=this,t=function(){n.hot.forceFullRender=!0;n.hot.view.render();n.hot.view.wt.wtOverlays.adjustElementsSize(!0)},i=function(i,r){var u=n.hot.runHooks("beforeRowResize",i,n.newSize,!0);u!==void 0&&(n.newSize=u);n.setManualSize(i,n.newSize);r&&t();n.hot.runHooks("afterRowResize",i,n.newSize,!0)},r;this.dblclick>=2&&(r=this.selectedRows.length,r>1?(u.arrayEach(this.selectedRows,function(n){i(n)}),t()):u.arrayEach(this.selectedRows,function(n){i(n,!0)}));this.dblclick=0;this.autoresizeTimeout=null}},{key:"onMouseDown",value:function(n){var t=this;r.hasClass(n.target,"manualRowResizer")&&(this.setupGuidePosition(),this.pressed=this.hot,this.autoresizeTimeout==null&&(this.autoresizeTimeout=setTimeout(function(){return t.afterMouseDownTimeout()},500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick++,this.startY=o.pageY(n),this.newSize=this.startHeight)}},{key:"onMouseMove",value:function(n){var t=this;this.pressed&&(this.currentHeight=this.startHeight+(o.pageY(n)-this.startY),u.arrayEach(this.selectedRows,function(n){t.newSize=t.setManualSize(n,t.currentHeight)}),this.refreshHandlePosition(),this.refreshGuidePosition())}},{key:"onMouseUp",value:function(){var n=this,t=function(){n.hot.forceFullRender=!0;n.hot.view.render();n.hot.view.wt.wtOverlays.adjustElementsSize(!0)},i=function(i,r){n.hot.runHooks("beforeRowResize",i,n.newSize);r&&t();n.saveManualRowHeights();n.hot.runHooks("afterRowResize",i,n.newSize)},r;this.pressed&&(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!=this.startHeight&&(r=this.selectedRows.length,r>1?(u.arrayEach(this.selectedRows,function(n){i(n)}),t()):u.arrayEach(this.selectedRows,function(n){i(n,!0)})),this.setupHandlePosition(this.currentTH))}},{key:"bindEvents",value:function(){var n=this;this.eventManager.addEventListener(this.hot.rootElement,"mouseover",function(t){return n.onMouseOver(t)});this.eventManager.addEventListener(this.hot.rootElement,"mousedown",function(t){return n.onMouseDown(t)});this.eventManager.addEventListener(window,"mousemove",function(t){return n.onMouseMove(t)});this.eventManager.addEventListener(window,"mouseup",function(t){return n.onMouseUp(t)})}},{key:"setManualSize",value:function(n,t){return n=this.hot.runHooks("modifyRow",n),this.manualRowHeights[n]=t,t}},{key:"onModifyRowHeight",value:function(n,t){var r,u,i;return this.enabled&&(r=this.hot.getPlugin("autoRowSize"),u=r?r.heights[t]:null,t=this.hot.runHooks("modifyRow",t),i=this.manualRowHeights[t],i!==void 0&&(i===u||i>(n||0)))?i:n}}]),t}(a.default);w.registerPlugin("manualRowResize",f);t.default=f},function(n,t,i){"use strict";function e(n){return n&&n.__esModule?n:{"default":n}}function v(n){if(Array.isArray(n)){for(var t=0,i=Array(n.length);t<n.length;t++)i[t]=n[t];return i}return Array.from(n)}function lt(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function at(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function vt(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var l,a;t.__esModule=!0;var y=function(){function n(n,t){var r=[],u=!0,f=!1,e=undefined,i,o;try{for(i=n[Symbol.iterator]();!(u=(o=i.next()).done);u=!0)if(r.push(o.value),t&&r.length===t)break}catch(s){f=!0;e=s}finally{try{!u&&i["return"]&&i["return"]()}finally{if(f)throw e;}}return r}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return n(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance");}}(),p=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),h=function w(n,t,i){var r,u,f;return n===null&&(n=Function.prototype),r=Object.getOwnPropertyDescriptor(n,t),r===undefined?(u=Object.getPrototypeOf(n),u===null?undefined:w(u,t,i)):"value"in r?r.value:(f=r.get,f===undefined)?undefined:f.call(i)},b=i(7),k=e(b),d=i(14),s=e(d),g=i(6),nt=i(11),r=i(8),tt=i(364),it=e(tt),rt=i(158),u=e(rt),ut=i(365),ft=e(ut),et=i(366),ot=e(et),st=i(367),ht=e(st),f=i(0),c=i(1),o=i(4),ct=i(217);i(368);s.default.getSingleton().register("beforeMergeCells");s.default.getSingleton().register("afterMergeCells");s.default.getSingleton().register("beforeUnmergeCells");s.default.getSingleton().register("afterUnmergeCells");l=new WeakMap;a=function(n){function t(n){lt(this,t);var i=at(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return l.set(i,{lastDesiredCoords:null}),i.mergedCellsCollection=null,i.autofillCalculations=null,i.selectionCalculations=null,i}return vt(t,n),p(t,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().mergeCells}},{key:"enablePlugin",value:function(){var n=this;this.enabled||(this.mergedCellsCollection=new it.default(this),this.autofillCalculations=new ft.default(this),this.selectionCalculations=new ot.default,this.addHook("afterInit",function(){return n.onAfterInit.apply(n,arguments)}),this.addHook("beforeKeyDown",function(){return n.onBeforeKeyDown.apply(n,arguments)}),this.addHook("modifyTransformStart",function(){return n.onModifyTransformStart.apply(n,arguments)}),this.addHook("modifyTransformEnd",function(){return n.onModifyTransformEnd.apply(n,arguments)}),this.addHook("modifyGetCellCoords",function(){return n.onModifyGetCellCoords.apply(n,arguments)}),this.addHook("beforeSetRangeEnd",function(){return n.onBeforeSetRangeEnd.apply(n,arguments)}),this.addHook("afterIsMultipleSelection",function(){return n.onAfterIsMultipleSelection.apply(n,arguments)}),this.addHook("afterRenderer",function(){return n.onAfterRenderer.apply(n,arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){return n.addMergeActionsToContextMenu.apply(n,arguments)}),this.addHook("afterGetCellMeta",function(){return n.onAfterGetCellMeta.apply(n,arguments)}),this.addHook("afterViewportRowCalculatorOverride",function(){return n.onAfterViewportRowCalculatorOverride.apply(n,arguments)}),this.addHook("afterViewportColumnCalculatorOverride",function(){return n.onAfterViewportColumnCalculatorOverride.apply(n,arguments)}),this.addHook("modifyAutofillRange",function(){return n.onModifyAutofillRange.apply(n,arguments)}),this.addHook("afterCreateCol",function(){return n.onAfterCreateCol.apply(n,arguments)}),this.addHook("afterRemoveCol",function(){return n.onAfterRemoveCol.apply(n,arguments)}),this.addHook("afterCreateRow",function(){return n.onAfterCreateRow.apply(n,arguments)}),this.addHook("afterRemoveRow",function(){return n.onAfterRemoveRow.apply(n,arguments)}),this.addHook("afterChange",function(){return n.onAfterChange.apply(n,arguments)}),this.addHook("beforeDrawBorders",function(){return n.onBeforeDrawAreaBorders.apply(n,arguments)}),h(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.clearCollections();this.hot.render();h(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){var n=this.hot.getSettings().mergeCells;this.clearCollections();this.disablePlugin();this.enablePlugin();this.generateFromSettings(n);h(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updatePlugin",this).call(this)}},{key:"validateSetting",value:function(n){var t=!0;return n?(u.default.containsNegativeValues(n)?(console.warn(u.default.NEGATIVE_VALUES_WARNING(n)),t=!1):u.default.isOutOfBounds(n,this.hot.countRows(),this.hot.countCols())?(console.warn(u.default.IS_OUT_OF_BOUNDS_WARNING(n)),t=!1):u.default.isSingleCell(n)?(console.warn(u.default.IS_SINGLE_CELL(n)),t=!1):u.default.containsZeroSpan(n)&&(console.warn(u.default.ZERO_SPAN_WARNING(n)),t=!1),t):!1}},{key:"generateFromSettings",value:function(n){var i=this,u,t,e;Array.isArray(n)&&(t=[],f.arrayEach(n,function(n){if(i.validateSetting(n)){var u=new r.CellCoords(n.row,n.col),f=new r.CellCoords(n.row+n.rowspan-1,n.col+n.colspan-1),e=new r.CellRange(u,u,f);t.push(i.mergeRange(e,!0,!0))}}),t=t.filter(function(n){return n!==!0}),e=this.getBulkCollectionData(t),(u=this.hot).populateFromArray.apply(u,v(e)))}},{key:"getBulkCollectionData",value:function(n){var i,t=this.getBulkCollectionDataRange(n),u=(i=this.hot).getData.apply(i,v(t)),r=u.splice(0);return f.arrayEach(n,function(n){var i=y(n,3),u=i[0],e=i[1],o=i[2];f.arrayEach(o,function(n,i){f.arrayEach(n,function(n,f){r[u-t[0]+i][e-t[1]+f]=n})})}),[t[0],t[1],r]}},{key:"getBulkCollectionDataRange",value:function(n){var t=[0,0],i=[0,0],r=null,u=null,e=null;return f.arrayEach(n,function(n){r=n[0];u=n[1];e=n[2];t[0]=Math.min(r,t[0]);t[1]=Math.min(u,t[1]);i[0]=Math.max(r+e.length-1,i[0]);i[1]=Math.max(u+e[0].length-1,i[1])}),[].concat(t,i)}},{key:"clearCollections",value:function(){this.mergedCellsCollection.clear()}},{key:"canMergeRange",value:function(n){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!1;return t?!0:this.validateSetting(n)}},{key:"toggleMergeOnSelection",value:function(){var n=this.hot.getSelectedRangeLast(),t,i;n&&(n.setDirection("NW-SE"),t=n.from,i=n.to,this.toggleMerge(n),this.hot.selectCell(t.row,t.col,i.row,i.col,!1))}},{key:"mergeSelection",value:function(){var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.hot.getSelectedRangeLast(),t,i;n&&(n.setDirection("NW-SE"),t=n.from,i=n.to,this.unmergeRange(n,!0),this.mergeRange(n),this.hot.selectCell(t.row,t.col,i.row,i.col,!1))}},{key:"unmergeSelection",value:function(){var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.hot.getSelectedRangeLast(),t,i;n&&(t=n.from,i=n.to,this.unmergeRange(n,!0),this.hot.selectCell(t.row,t.col,i.row,i.col,!1))}},{key:"mergeRange",value:function(n){var f=this,u=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!1,c=arguments.length>2&&arguments[2]!==undefined?arguments[2]:!1,r=n.getTopLeftCorner(),e=n.getBottomRightCorner(),t={row:r.row,col:r.col,rowspan:e.row-r.row+1,colspan:e.col-r.col+1},i=[],s=null,h;return this.canMergeRange(t,u)?(this.hot.runHooks("beforeMergeCells",n,u),o.rangeEach(0,t.rowspan-1,function(n){o.rangeEach(0,t.colspan-1,function(r){var u=null;i[n]||(i[n]=[]);n===0&&r===0?u=f.hot.getDataAtCell(t.row,t.col):f.hot.setCellMeta(t.row+n,t.col+r,"hidden",!0);i[n][r]=u})}),this.hot.setCellMeta(t.row,t.col,"spanned",!0),h=this.mergedCellsCollection.add(t),h)?(c?s=[t.row,t.col,i]:this.hot.populateFromArray(t.row,t.col,i,void 0,void 0,this.pluginName),this.hot.runHooks("afterMergeCells",n,t,u),s):!0:!1}},{key:"unmergeRange",value:function(n){var t=this,i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!1,r=this.mergedCellsCollection.getWithinRange(n);r&&(this.hot.runHooks("beforeUnmergeCells",n,i),f.arrayEach(r,function(n){t.mergedCellsCollection.remove(n.row,n.col);o.rangeEach(0,n.rowspan-1,function(i){o.rangeEach(0,n.colspan-1,function(r){t.hot.removeCellMeta(n.row+i,n.col+r,"hidden")})});t.hot.removeCellMeta(n.row,n.col,"spanned")}),this.hot.render(),this.hot.runHooks("afterUnmergeCells",n,i))}},{key:"toggleMerge",value:function(n){var t=this.mergedCellsCollection.get(n.from.row,n.from.col),i=t.row===n.from.row&&t.col===n.from.col&&t.row+t.rowspan-1===n.to.row&&t.col+t.colspan-1===n.to.col;i?this.unmergeRange(n):this.mergeSelection(n)}},{key:"merge",value:function(n,t,i,u){var f=new r.CellCoords(n,t),e=new r.CellCoords(i,u);this.mergeRange(new r.CellRange(f,f,e))}},{key:"unmerge",value:function(n,t,i,u){var f=new r.CellCoords(n,t),e=new r.CellCoords(i,u);this.unmergeRange(new r.CellRange(f,f,e))}},{key:"onAfterInit",value:function(){this.generateFromSettings(this.hot.getSettings().mergeCells);this.hot.render()}},{key:"onBeforeKeyDown",value:function(n){var t=(n.ctrlKey||n.metaKey)&&!n.altKey;t&&n.keyCode===77&&(this.toggleMerge(this.hot.getSelectedRangeLast()),this.hot.render(),nt.stopImmediatePropagation(n))}},{key:"onAfterIsMultipleSelection",value:function(n){var i,r,t;if(n)for(i=this.mergedCellsCollection.mergedCells,r=this.hot.getSelectedRangeLast(),t=0;t<i.length;t+=1)if(r.highlight.row===i[t].row&&r.highlight.col===i[t].col&&r.to.row===i[t].row+i[t].rowspan-1&&r.to.col===i[t].col+i[t].colspan-1)return!1;return n}},{key:"onModifyTransformStart",value:function(n){var f=l.get(this),e=this.hot.getSelectedRangeLast(),t={row:n.row,col:n.col},o=null,u=new r.CellCoords(e.highlight.row,e.highlight.col),i=this.mergedCellsCollection.get(u.row,u.col),s;if(f.lastDesiredCoords||(f.lastDesiredCoords=new r.CellCoords(null,null)),i){var h=new r.CellCoords(i.row,i.col),c=new r.CellCoords(i.row+i.rowspan-1,i.col+i.colspan-1),a=new r.CellRange(h,h,c);a.includes(f.lastDesiredCoords)||(f.lastDesiredCoords=new r.CellCoords(null,null));t.row=f.lastDesiredCoords.row?f.lastDesiredCoords.row-u.row:t.row;t.col=f.lastDesiredCoords.col?f.lastDesiredCoords.col-u.col:t.col;n.row>0?t.row=i.row+i.rowspan-1-u.row+n.row:n.row<0&&(t.row=u.row-i.row+n.row);n.col>0?t.col=i.col+i.colspan-1-u.col+n.col:n.col<0&&(t.col=u.col-i.col+n.col)}o=new r.CellCoords(e.highlight.row+t.row,e.highlight.col+t.col);s=this.mergedCellsCollection.get(o.row,o.col);s&&(f.lastDesiredCoords=o,t={row:s.row-u.row,col:s.col-u.col});t.row!==0&&(n.row=t.row);t.col!==0&&(n.col=t.col)}},{key:"onModifyTransformEnd",value:function(n){var u=this,i=this.hot.getSelectedRangeLast(),t=c.clone(n),e=this.selectionCalculations.getUpdatedSelectionRange(i,n),r=c.clone(t),o=this.mergedCellsCollection.getWithinRange(e,!0);do r=c.clone(t),this.selectionCalculations.getUpdatedSelectionRange(i,t),f.arrayEach(o,function(n){u.selectionCalculations.snapDelta(t,i,n)});while(t.row!==r.row||t.col!==r.col);n.row=t.row;n.col=t.col}},{key:"onModifyGetCellCoords",value:function(n,t){var i=this.mergedCellsCollection.get(n,t);if(i)return[i.row,i.col,i.row+i.rowspan-1,i.col+i.colspan-1]}},{key:"addMergeActionsToContextMenu",value:function(n){n.items.push({name:"---------"},ht.default(this))}},{key:"onAfterRenderer",value:function(n,t,i){var r=this.mergedCellsCollection.get(t,i);ct.applySpanProperties(n,r,t,i)}},{key:"onBeforeSetRangeEnd",value:function(n){var t=this.hot.getSelectedRangeLast(),i,u,f,e;if(t.highlight=new r.CellCoords(t.highlight.row,t.highlight.col),t.to=n,i=!1,(t.from.row!==0||t.to.row!==this.hot.countRows()-1)&&(t.from.col!==0||t.to.col!==this.hot.countCols()-1))do for(i=!1,u=0;u<this.mergedCellsCollection.mergedCells.length;u++)f=this.mergedCellsCollection.mergedCells[u],e=f.getRange(),t.expandByRange(e)&&(n.row=t.to.row,n.col=t.to.col,i=!0);while(i)}},{key:"onAfterGetCellMeta",value:function(n,t,i){var r=this.mergedCellsCollection.get(n,t);r&&(r.row!==n||r.col!==t)&&(i.copyable=!1)}},{key:"onAfterViewportRowCalculatorOverride",value:function(n){var i=this,r=this.hot.countCols(),t=void 0;o.rangeEach(0,r-1,function(r){if(t=i.mergedCellsCollection.get(n.startRow,r),t&&t.row<n.startRow)return n.startRow=t.row,i.onAfterViewportRowCalculatorOverride.call(i,n);if(t=i.mergedCellsCollection.get(n.endRow,r),t){var u=t.row+t.rowspan-1;if(u>n.endRow)return n.endRow=u,i.onAfterViewportRowCalculatorOverride.call(i,n)}return!0})}},{key:"onAfterViewportColumnCalculatorOverride",value:function(n){var i=this,r=this.hot.countRows(),t=void 0;o.rangeEach(0,r-1,function(r){if(t=i.mergedCellsCollection.get(r,n.startColumn),t&&t.col<n.startColumn)return n.startColumn=t.col,i.onAfterViewportColumnCalculatorOverride.call(i,n);if(t=i.mergedCellsCollection.get(r,n.endColumn),t){var u=t.col+t.colspan-1;if(u>n.endColumn)return n.endColumn=u,i.onAfterViewportColumnCalculatorOverride.call(i,n)}return!0})}},{key:"onModifyAutofillRange",value:function(n,t){var i,r;return(this.autofillCalculations.correctSelectionAreaSize(t),i=this.autofillCalculations.getDirection(t,n),this.autofillCalculations.dragAreaOverlapsCollections(t,n,i))?t:(r=this.mergedCellsCollection.getWithinRange({from:{row:t[0],col:t[1]},to:{row:t[2],col:t[3]}}),!r)?n:this.autofillCalculations.snapDragArea(t,n,i,r)}},{key:"onAfterCreateCol",value:function(n,t){this.mergedCellsCollection.shiftCollections("right",n,t)}},{key:"onAfterRemoveCol",value:function(n,t){this.mergedCellsCollection.shiftCollections("left",n,t)}},{key:"onAfterCreateRow",value:function(n,t,i){i!=="auto"&&this.mergedCellsCollection.shiftCollections("down",n,t)}},{key:"onAfterRemoveRow",value:function(n,t){this.mergedCellsCollection.shiftCollections("up",n,t)}},{key:"onAfterChange",value:function(n,t){t==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(n)}},{key:"onBeforeDrawAreaBorders",value:function(n,t){if(t&&t==="area"){var i=this.hot.getSelectedRangeLast(),r=this.mergedCellsCollection.getWithinRange(i);f.arrayEach(r,function(t){i.getBottomRightCorner().row===t.getLastRow()&&i.getBottomRightCorner().col===t.getLastColumn()&&(n[2]=t.row,n[3]=t.col)})}}}]),t}(k.default);g.registerPlugin("mergeCells",a);t.default=a},function(n,t,i){"use strict";function y(n){return n&&n.__esModule?n:{"default":n}}function p(n,t){return Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(t)}}))}function o(n){if(Array.isArray(n)){for(var t=0,i=Array(n.length);t<n.length;t++)i[t]=n[t];return i}return Array.from(n)}function w(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var s;t.__esModule=!0;var h=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),c=p(["The merged cell declared at [",", ","] overlaps with the other declared merged \n      cell. The overlapping merged cell was not added to the table, please fix your setup."],["The merged cell declared at [",", ","] overlaps with the other declared merged \n      cell. The overlapping merged cell was not added to the table, please fix your setup."]),l=i(158),a=y(l),r=i(8),f=i(4),u=i(0),e=i(217),v=i(34);s=function(){function n(t){w(this,n);this.plugin=t;this.mergedCells=[];this.hot=t.hot}return h(n,[{key:"get",value:function(n,t){var r=this.mergedCells,i=!1;return u.arrayEach(r,function(r){return r.row<=n&&r.row+r.rowspan-1>=n&&r.col<=t&&r.col+r.colspan-1>=t?(i=r,!1):!0}),i}},{key:"getByRange",value:function(n){var i=this.mergedCells,t=!1;return u.arrayEach(i,function(i){return i.row<=n.from.row&&i.row+i.rowspan-1>=n.to.row&&i.col<=n.from.col&&i.col+i.colspan-1>=n.to.col?t=i:!0}),t}},{key:"getWithinRange",value:function(n){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!1,o=this.mergedCells,t=[],i,f;return n.includesRange||(i=new r.CellCoords(n.from.row,n.from.col),f=new r.CellCoords(n.to.row,n.to.col),n=new r.CellRange(i,i,f)),u.arrayEach(o,function(i){var u=new r.CellCoords(i.row,i.col),o=new r.CellCoords(i.row+i.rowspan-1,i.col+i.colspan-1),f=new r.CellRange(u,u,o);e?n.overlaps(f)&&t.push(i):n.includesRange(f)&&t.push(i)}),t.length?t:!1}},{key:"add",value:function(t){var f=this.mergedCells,r=t.row,u=t.col,e=t.rowspan,o=t.colspan,i=new a.default(r,u,e,o),s=this.get(r,u),h=this.isOverlapping(i);return!s&&!h?(this.hot&&i.normalize(this.hot),f.push(i),i):(console.warn(n.IS_OVERLAPPING_WARNING(i)),!1)}},{key:"remove",value:function(n,t){var u=this.mergedCells,i=this.get(n,t),r=i?this.mergedCells.indexOf(i):null;return i&&r!==!1?(u.splice(r,1),i):!1}},{key:"clear",value:function(){var t=this,r=this.mergedCells,n=[],i=[];u.arrayEach(r,function(i){n.push([t.hot.getCell(i.row,i.col),t.get(i.row,i.col),i.row,i.col])});this.mergedCells.length=0;u.arrayEach(n,function(r,u){f.rangeEach(0,r.rowspan-1,function(n){f.rangeEach(0,r.colspan-1,function(u){(u!==0||n!==0)&&i.push([t.hot.getCell(r.row+n,r.col+u),null,null,null])})});n[u][1]=null});u.arrayEach(n,function(n){e.applySpanProperties.apply(undefined,o(n))});u.arrayEach(i,function(n){e.applySpanProperties.apply(undefined,o(n))})}},{key:"isOverlapping",value:function(n){var i=new r.CellRange(null,new r.CellCoords(n.row,n.col),new r.CellCoords(n.row+n.rowspan-1,n.col+n.colspan-1)),t=!1;return u.arrayEach(this.mergedCells,function(n){var u=new r.CellRange(null,new r.CellCoords(n.row,n.col),new r.CellCoords(n.row+n.rowspan-1,n.col+n.colspan-1));return u.overlaps(i)?(t=!0,!1):!0}),t}},{key:"isMergedParent",value:function(n,t){var r=this.mergedCells,i=!1;return u.arrayEach(r,function(r){return r.row===n&&r.col===t?(i=!0,!1):!0}),i}},{key:"shiftCollections",value:function(n,t,i){var f=this,r=[0,0];switch(n){case"right":r[0]+=i;break;case"left":r[0]-=i;break;case"down":r[1]+=i;break;case"up":r[1]-=i}u.arrayEach(this.mergedCells,function(n){n.shift(r,t)});u.arrayEach(this.mergedCells,function(n){n.removed&&f.mergedCells.splice(f.mergedCells.indexOf(n),1)})}}],[{key:"IS_OVERLAPPING_WARNING",value:function(n){return v.toSingleLine(c,n.row,n.col)}}]),n}();t.default=s},function(n,t,i){"use strict";function h(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var e;t.__esModule=!0;var r=function(){function n(n,t){var r=[],u=!0,f=!1,e=undefined,i,o;try{for(i=n[Symbol.iterator]();!(u=(o=i.next()).done);u=!0)if(r.push(o.value),t&&r.length===t)break}catch(s){f=!0;e=s}finally{try{!u&&i["return"]&&i["return"]()}finally{if(f)throw e;}}return r}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return n(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance");}}(),o=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),s=i(1),u=i(8),f=i(0);e=function(){function n(t){h(this,n);this.plugin=t;this.mergedCellsCollection=this.plugin.mergedCellsCollection;this.currentFillData=null}return o(n,[{key:"correctSelectionAreaSize",value:function(n){if(n[0]===n[2]&&n[1]===n[3]){var t=this.mergedCellsCollection.get(n[0],n[1]);t&&(n[2]=n[0]+t.rowspan-1,n[3]=n[1]+t.colspan-1)}}},{key:"getDirection",value:function(n,t){return t[0]===n[0]&&t[1]===n[1]&&t[3]===n[3]?"down":t[2]===n[2]&&t[1]===n[1]&&t[3]===n[3]?"up":t[1]===n[1]&&t[2]===n[2]?"right":"left"}},{key:"snapDragArea",value:function(n,t,i,u){var f=t.slice(0),h=this.getAutofillSize(n,t,i),s=r(n,4),p=s[0],w=s[1],b=s[2],k=s[3],it=["up","down"].indexOf(i)>-1,c=it?b-p+1:k-w+1,rt=Math.floor(h/c)*c,e=h-rt,o=this.getFarthestCollection(n,t,i,u),l,d,a,g,v,nt,y,tt;return o&&(i==="down"?(l=o.row+o.rowspan-p-e,d=f[2]+l,d>=this.plugin.hot.countRows()?f[2]-=e:f[2]+=e?l:0):i==="right"?(a=o.col+o.colspan-w-e,g=f[3]+a,g>=this.plugin.hot.countCols()?f[3]-=e:f[3]+=e?a:0):i==="up"?(v=b-e-o.row+1,nt=f[0]+v,nt<0?f[0]+=e:f[0]-=e?v:0):i==="left"&&(y=k-e-o.col+1,tt=f[1]+y,tt<0?f[1]+=e:f[1]-=e?y:0)),this.updateCurrentFillCache({baseArea:n,dragDirection:i,foundMergedCells:u,fillSize:h,dragArea:f,cycleLength:c}),f}},{key:"updateCurrentFillCache",value:function(n){this.currentFillData||(this.currentFillData={});s.extend(this.currentFillData,n)}},{key:"getAutofillSize",value:function(n,t,i){var u=r(n,4),e=u[0],o=u[1],s=u[2],h=u[3],f=r(t,4),c=f[0],l=f[1],a=f[2],v=f[3];switch(i){case"up":return e-c;case"down":return a-s;case"left":return o-l;case"right":return v-h;default:return null}}},{key:"getDragArea",value:function(n,t,i){var u=r(n,4),o=u[0],s=u[1],h=u[2],e=u[3],f=r(t,4),c=f[0],l=f[1],a=f[2],v=f[3];switch(i){case"up":return[c,l,o-1,e];case"down":return[h+1,s,a,e];case"left":return[c,l,h,s-1];case"right":return[o,e+1,a,v];default:return null}}},{key:"getFarthestCollection",value:function(n,t,i,u){var s=r(n,4),a=s[0],v=s[1],y=s[2],p=s[3],c=["up","down"].indexOf(i)>-1,w=c?y:p,b=c?a:v,k=this.getAutofillSize(n,t,i),d=c?y-a+1:p-v+1,g=Math.floor(k/d)*d,h=k-g,e=null,l=null,o=null;switch(i){case"up":e="includesVertically";o=w-h+1;break;case"left":e="includesHorizontally";o=w-h+1;break;case"down":e="includesVertically";o=b+h-1;break;case"right":e="includesHorizontally";o=b+h-1}return f.arrayEach(u,function(n){n[e](o)&&n.isFarther(l,i)&&(l=n)}),l}},{key:"recreateAfterDataPopulation",value:function(n){var r;if(this.currentFillData){var u=this.getRangeFromChanges(n),f=this.currentFillData.foundMergedCells,e=this.currentFillData.dragDirection,o=function(n,t){switch(e){case"up":return n.row-t>=u.from.row;case"down":return n.row+n.rowspan-1+t<=u.to.row;case"left":return n.col-t>=u.from.column;case"right":return n.col+n.colspan-1+t<=u.to.column;default:return null}},i=0,t=null,s=1;do for(r=0;r<f.length;r++){if(t=f[r],i=s*this.currentFillData.cycleLength,o(t,i))switch(e){case"up":this.plugin.mergedCellsCollection.add({row:t.row-i,rowspan:t.rowspan,col:t.col,colspan:t.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:t.row+i,rowspan:t.rowspan,col:t.col,colspan:t.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:t.row,rowspan:t.rowspan,col:t.col-i,colspan:t.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:t.row,rowspan:t.rowspan,col:t.col+i,colspan:t.colspan})}r===f.length-1&&(s+=1)}while(o(t,i));this.currentFillData=null;this.plugin.hot.render()}}},{key:"getRangeFromChanges",value:function(n){var t={min:null,max:null},i={min:null,max:null};return f.arrayEach(n,function(n){(t.min===null||n[0]<t.min)&&(t.min=n[0]);(t.max===null||n[0]>t.max)&&(t.max=n[0]);(i.min===null||n[1]<i.min)&&(i.min=n[1]);(i.max===null||n[1]>i.max)&&(i.max=n[1])}),{from:{row:t.min,column:i.min},to:{row:t.max,column:i.max}}}},{key:"dragAreaOverlapsCollections",value:function(n,t,i){var o=this.getDragArea(n,t,i),f=r(o,4),s=f[0],h=f[1],c=f[2],l=f[3],e=new u.CellCoords(s,h),a=new u.CellCoords(c,l),v=new u.CellRange(e,e,a);return!!this.mergedCellsCollection.getWithinRange(v,!0)}}]),n}();t.default=e},function(n,t,i){"use strict";function e(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var u,r,f;t.__esModule=!0;u=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}();r=i(8);f=function(){function n(){e(this,n)}return u(n,[{key:"snapDelta",value:function(n,t,i){var r=t.to,u=r.row+n.row,f=r.col+n.col;n.row?this.jumpOverMergedCell(n,i,u):n.col&&this.jumpOverMergedCell(n,i,f)}},{key:"jumpOverMergedCell",value:function(n,t,i){var r=n.row||n.col,u=null,f=null,e=null;(n.row?(u=t.includesVertically(i),f=t.row,e=t.getLastRow()):n.col&&(u=t.includesHorizontally(i),f=t.col,e=t.getLastColumn()),r!==0)&&(r>0?u&&i!==f&&(r+=e-i+1):u&&i!==e&&(r-=i-f+1),n.row?n.row=r:n.col&&(n.col=r))}},{key:"getUpdatedSelectionRange",value:function(n,t){return new r.CellRange(n.highlight,n.from,new r.CellCoords(n.to.row+t.row,n.to.col+t.col))}}]),n}();t.default=f},function(n,t,i){"use strict";function o(n){return n&&n.__esModule?n:{"default":n}}function s(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function h(n){return{key:"mergeCells",name:function(){var t=this.getSelectedLast(),i;return t&&(i=n.mergedCellsCollection.get(t[0],t[1]),i.row===t[0]&&i.col===t[1]&&i.row+i.rowspan-1===t[2]&&i.col+i.colspan-1===t[3])?this.getTranslatedPhrase(r.CONTEXTMENU_ITEMS_UNMERGE_CELLS):this.getTranslatedPhrase(r.CONTEXTMENU_ITEMS_MERGE_CELLS)},callback:function(){n.toggleMergeOnSelection()},disabled:function(){var n=this.getSelectedLast(),t;return n?(t=e.default.isSingleCell({row:n[0],col:n[1],rowspan:n[2]-n[0]+1,colspan:n[3]-n[1]+1}),t||this.selection.selectedHeader.corner):!0},hidden:!1}}t.__esModule=!0;t.default=h;var u=i(3),r=s(u),f=i(158),e=o(f)},function(){},function(n,t,i){"use strict";function f(n){return n&&n.__esModule?n:{"default":n}}function b(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function k(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function d(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var e;t.__esModule=!0;var o=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),s=function h(n,t,i){var r,u,f;return n===null&&(n=Function.prototype),r=Object.getOwnPropertyDescriptor(n,t),r===undefined?(u=Object.getPrototypeOf(n),u===null?undefined:h(u,t,i)):"value"in r?r.value:(f=r.get,f===undefined)?undefined:f.call(i)},c=i(14),g=f(c),u=i(2),l=i(33),a=i(7),v=f(a),y=i(9),p=f(y),w=i(6),r=i(8);e=function(n){function t(n){b(this,t);var i=k(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return i.dragged=[],i.eventManager=null,i.lastSetCell=null,i}return d(t,n),o(t,[{key:"isEnabled",value:function(){return l.isMobileBrowser()}},{key:"enablePlugin",value:function(){this.enabled||(this.eventManager||(this.eventManager=new p.default(this)),this.registerListeners(),s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enablePlugin",this).call(this))}},{key:"registerListeners",value:function(){function t(t){if(n.dragged.length===1)return n.dragged.splice(0,n.dragged.length),!0;var i=n.dragged.indexOf(t);if(i==-1)return!1;i===0?n.dragged=n.dragged.slice(0,1):i==1&&(n.dragged=n.dragged.slice(-1))}var n=this;this.eventManager.addEventListener(this.hot.rootElement,"touchstart",function(t){var i=void 0;return u.hasClass(t.target,"topLeftSelectionHandle-HitArea")?(i=n.hot.getSelectedRangeLast(),n.dragged.push("topLeft"),n.touchStartRange={width:i.getWidth(),height:i.getHeight(),direction:i.getDirection()},t.preventDefault(),!1):u.hasClass(t.target,"bottomRightSelectionHandle-HitArea")?(i=n.hot.getSelectedRangeLast(),n.dragged.push("bottomRight"),n.touchStartRange={width:i.getWidth(),height:i.getHeight(),direction:i.getDirection()},t.preventDefault(),!1):void 0});this.eventManager.addEventListener(this.hot.rootElement,"touchend",function(i){return u.hasClass(i.target,"topLeftSelectionHandle-HitArea")?(t.call(n,"topLeft"),n.touchStartRange=void 0,i.preventDefault(),!1):u.hasClass(i.target,"bottomRightSelectionHandle-HitArea")?(t.call(n,"bottomRight"),n.touchStartRange=void 0,i.preventDefault(),!1):void 0});this.eventManager.addEventListener(this.hot.rootElement,"touchmove",function(t){var c=u.getWindowScrollTop(),l=u.getWindowScrollLeft(),i=void 0,r=void 0,f=void 0,o=void 0,s=void 0,h=void 0,e=void 0;n.dragged.length!==0&&(i=document.elementFromPoint(t.touches[0].screenX-l,t.touches[0].screenY-c),i&&i!==n.lastSetCell)&&((i.nodeName=="TD"||i.nodeName=="TH")&&(r=n.hot.getCoords(i),r.col==-1&&(r.col=0),f=n.hot.getSelectedRangeLast(),o=f.getWidth(),s=f.getHeight(),h=f.getDirection(),o==1&&s==1&&n.hot.selection.setRangeEnd(r),e=n.getCurrentRangeCoords(f,r,n.touchStartRange.direction,h,n.dragged[0]),e.start!==null&&n.hot.selection.setRangeStart(e.start),n.hot.selection.setRangeEnd(e.end),n.lastSetCell=i),t.preventDefault())})}},{key:"getCurrentRangeCoords",value:function(n,t,i,u,f){var o=n.getTopLeftCorner(),s=n.getBottomRightCorner(),h=n.getBottomLeftCorner(),c=n.getTopRightCorner(),e={start:null,end:null};switch(i){case"NE-SW":switch(u){case"NE-SW":case"NW-SE":e=f=="topLeft"?{start:new r.CellCoords(t.row,n.highlight.col),end:new r.CellCoords(h.row,t.col)}:{start:new r.CellCoords(n.highlight.row,t.col),end:new r.CellCoords(t.row,o.col)};break;case"SE-NW":f=="bottomRight"&&(e={start:new r.CellCoords(s.row,t.col),end:new r.CellCoords(t.row,o.col)})}break;case"NW-SE":switch(u){case"NE-SW":f=="topLeft"?e={start:t,end:h}:e.end=t;break;case"NW-SE":f=="topLeft"?e={start:t,end:s}:e.end=t;break;case"SE-NW":f=="topLeft"?e={start:t,end:o}:e.end=t;break;case"SW-NE":f=="topLeft"?e={start:t,end:c}:e.end=t}break;case"SW-NE":switch(u){case"NW-SE":e=f=="bottomRight"?{start:new r.CellCoords(t.row,o.col),end:new r.CellCoords(h.row,t.col)}:{start:new r.CellCoords(o.row,t.col),end:new r.CellCoords(t.row,s.col)};break;case"SW-NE":e=f=="topLeft"?{start:new r.CellCoords(n.highlight.row,t.col),end:new r.CellCoords(t.row,s.col)}:{start:new r.CellCoords(t.row,o.col),end:new r.CellCoords(o.row,t.col)};break;case"SE-NW":f=="bottomRight"?e={start:new r.CellCoords(t.row,c.col),end:new r.CellCoords(o.row,t.col)}:f=="topLeft"&&(e={start:h,end:t})}break;case"SE-NW":switch(u){case"NW-SE":case"NE-SW":case"SW-NE":f=="topLeft"&&(e.end=t);break;case"SE-NW":f=="topLeft"?e.end=t:e={start:t,end:o}}}return e}},{key:"isDragged",value:function(){return this.dragged.length>0}}]),t}(v.default);w.registerPlugin("multipleSelectionHandles",e);t.default=e},function(n,t,i){"use strict";function u(n){return n&&n.__esModule?n:{"default":n}}function p(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function w(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function b(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var f;t.__esModule=!0;var e=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),r=function o(n,t,i){var r,u,f;return n===null&&(n=Function.prototype),r=Object.getOwnPropertyDescriptor(n,t),r===undefined?(u=Object.getPrototypeOf(n),u===null?undefined:o(u,t,i)):"value"in r?r.value:(f=r.get,f===undefined)?undefined:f.call(i)},s=i(7),h=u(s),c=i(218),k=u(c),l=i(371),a=u(l),v=i(0),y=i(6);f=function(n){function t(n){p(this,t);var i=w(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return i.observer=null,i}return b(t,n),e(t,[{key:"isEnabled",value:function(){return this.hot.getSettings().observeChanges}},{key:"enablePlugin",value:function(){var n=this;this.enabled||(this.observer||(this.observer=new a.default(this.hot.getSourceData()),this._exposePublicApi()),this.observer.addLocalHook("change",function(t){return n.onDataChange(t)}),this.addHook("afterCreateRow",function(){return n.onAfterTableAlter()}),this.addHook("afterRemoveRow",function(){return n.onAfterTableAlter()}),this.addHook("afterCreateCol",function(){return n.onAfterTableAlter()}),this.addHook("afterRemoveCol",function(){return n.onAfterTableAlter()}),this.addHook("afterChange",function(t,i){return n.onAfterTableAlter(i)}),this.addHook("afterLoadData",function(t){return n.onAfterLoadData(t)}),r(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.observer&&(this.observer.destroy(),this.observer=null,this._deletePublicApi());r(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disablePlugin",this).call(this)}},{key:"onDataChange",value:function(n){var i=this,t,r;this.observer.isPaused()||(t=this.pluginName+".change",r={add:function(n){isNaN(n.col)?i.hot.runHooks("afterCreateRow",n.row,1,t):i.hot.runHooks("afterCreateCol",n.col,1,t)},remove:function(n){isNaN(n.col)?i.hot.runHooks("afterRemoveRow",n.row,1,t):i.hot.runHooks("afterRemoveCol",n.col,1,t)},replace:function(n){i.hot.runHooks("afterChange",[[n.row,n.col,null,n.value]],t)}},v.arrayEach(n,function(n){r[n.op]&&r[n.op](n)}),this.hot.render());this.hot.runHooks("afterChangesObserved")}},{key:"onAfterTableAlter",value:function(n){var t=this;n!=="loadData"&&(this.observer.pause(),this.hot.addHookOnce("afterChangesObserved",function(){return t.observer.resume()}))}},{key:"onAfterLoadData",value:function(n){n||this.observer.setObservedData(this.hot.getSourceData())}},{key:"destroy",value:function(){this.observer&&(this.observer.destroy(),this._deletePublicApi());r(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}},{key:"_exposePublicApi",value:function(){var n=this,t=this.hot;t.pauseObservingChanges=function(){return n.observer.pause()};t.resumeObservingChanges=function(){return n.observer.resume()};t.isPausedObservingChanges=function(){return n.observer.isPaused()}}},{key:"_deletePublicApi",value:function(){var n=this.hot;delete n.pauseObservingChanges;delete n.resumeObservingChanges;delete n.isPausedObservingChanges}}]),t}(h.default);t.default=f;y.registerPlugin("observeChanges",f)},function(n,t,i){"use strict";function f(n){return n&&n.__esModule?n:{"default":n}}function a(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var u;t.__esModule=!0;var e=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),o=i(218),r=f(o),s=i(21),h=f(s),c=i(1),l=i(372);u=function(){function n(t){a(this,n);this.observedData=null;this.observer=null;this.paused=!1;this.setObservedData(t)}return e(n,[{key:"setObservedData",value:function(n){var t=this;this.observer&&r.default.unobserve(this.observedData,this.observer);this.observedData=n;this.observer=r.default.observe(this.observedData,function(n){return t.onChange(n)})}},{key:"isPaused",value:function(){return this.paused}},{key:"pause",value:function(){this.paused=!0}},{key:"resume",value:function(){this.paused=!1}},{key:"onChange",value:function(n){this.runLocalHooks("change",l.cleanPatches(n))}},{key:"destroy",value:function(){r.default.unobserve(this.observedData,this.observer);this.observedData=null;this.observer=null}}]),n}();c.mixin(u,h.default);t.default=u},function(n,t,i){"use strict";function e(n){var t=[];return n=r.arrayFilter(n,function(n){return/[/]length/ig.test(n.path)?!1:u(n.path)?!0:!1}),n=r.arrayMap(n,function(n){var t=u(n.path);return n.row=t.row,n.col=t.col,n}),n=r.arrayFilter(n,function(n){if(["add","remove"].indexOf(n.op)!==-1&&!isNaN(n.col)){if(t.indexOf(n.col)!==-1)return!1;t.push(n.col)}return!0}),t.length=0,n}function u(n){var i=n.match(/^\/(\d+)\/?(.*)?$/);if(!i)return null;var r=f(i,3),u=r[1],t=r[2];return{row:parseInt(u,10),col:/^\d*$/.test(t)?parseInt(t,10):t}}var f,r;t.__esModule=!0;f=function(){function n(n,t){var r=[],u=!0,f=!1,e=undefined,i,o;try{for(i=n[Symbol.iterator]();!(u=(o=i.next()).done);u=!0)if(r.push(o.value),t&&r.length===t)break}catch(s){f=!0;e=s}finally{try{!u&&i["return"]&&i["return"]()}finally{if(f)throw e;}}return r}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return n(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance");}}();t.cleanPatches=e;t.parsePath=u;r=i(0)},function(n,t,i){"use strict";function l(n){return n&&n.__esModule?n:{"default":n}}function r(n){this.query=function(t,i,u){var v=n.countRows(),y=n.countCols(),s=[],f,e,a;for(i||(i=r.global.getDefaultCallback()),u||(u=r.global.getDefaultQueryMethod()),f=0;f<v;f++)for(e=0;e<y;e++){var o=n.getDataAtCell(f,e),h=n.getCellMeta(f,e),c=h.search.callback||i,p=h.search.queryMethod||u,l=p(t,o);l&&(a={row:f,col:e,data:o},s.push(a));c&&c(n,f,e,o,l)}return s}}function a(n,t,i,u,e,o,s){var c=s.search!==null&&h(s.search)=="object"&&s.search.searchResultClass||r.global.getDefaultSearchResultClass();s.isSearchResult?f.addClass(t,c):f.removeClass(t,c)}function s(){var n=this,t=!!n.getSettings().search;t?n.search=new r(n):delete n.search}var o;t.__esModule=!0;var h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},c=i(14),u=l(c),f=i(2),e=i(15);r.DEFAULT_CALLBACK=function(n,t,i,r,u){n.getCellMeta(t,i).isSearchResult=u};r.DEFAULT_QUERY_METHOD=function(n,t){return typeof n=="undefined"||n==null||!n.toLowerCase||n.length===0?!1:typeof t=="undefined"||t==null?!1:t.toString().toLowerCase().indexOf(n.toLowerCase())!=-1};r.DEFAULT_SEARCH_RESULT_CLASS="htSearchResult";r.global=function(){var n=r.DEFAULT_CALLBACK,t=r.DEFAULT_QUERY_METHOD,i=r.DEFAULT_SEARCH_RESULT_CLASS;return{getDefaultCallback:function(){return n},setDefaultCallback:function(t){n=t},getDefaultQueryMethod:function(){return t},setDefaultQueryMethod:function(n){t=n},getDefaultSearchResultClass:function(){return i},setDefaultSearchResultClass:function(n){i=n}}}();o=e.getRenderer("base");e.registerRenderer("base",function(){o.apply(this,arguments);a.apply(this,arguments)});u.default.getSingleton().add("afterInit",s);u.default.getSingleton().add("afterUpdateSettings",s);t.default=r},function(n,t,i){"use strict";function v(n){return n&&n.__esModule?n:{"default":n}}function y(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function p(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function w(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var e;t.__esModule=!0;var o=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),f=function s(n,t,i){var r,u,f;return n===null&&(n=Function.prototype),r=Object.getOwnPropertyDescriptor(n,t),r===undefined?(u=Object.getPrototypeOf(n),u===null?undefined:s(u,t,i)):"value"in r?r.value:(f=r.get,f===undefined)?undefined:f.call(i)},r=i(2),u=i(0),h=i(7),c=v(h),l=i(6),a=i(43);e=function(n){function t(n){y(this,t);var i=p(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return i.scrollbars=[],i.clones=[],i.lockedCollection=!1,i.freezeOverlays=!1,i}return w(t,n),o(t,[{key:"isEnabled",value:function(){return a.isTouchSupported()}},{key:"enablePlugin",value:function(){var n=this;this.enabled||(this.addHook("afterRender",function(){return n.onAfterRender()}),this.registerEvents(),f(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.lockedCollection=!1;f(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){f(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disablePlugin",this).call(this)}},{key:"registerEvents",value:function(){var n=this;this.addHook("beforeTouchScroll",function(){return n.onBeforeTouchScroll()});this.addHook("afterMomentumScroll",function(){return n.onAfterMomentumScroll()})}},{key:"onAfterRender",value:function(){if(!this.lockedCollection){var t=this.hot.view.wt.wtOverlays,u=t.topOverlay,i=t.bottomOverlay,f=t.leftOverlay,r=t.topLeftCornerOverlay,n=t.bottomLeftCornerOverlay;this.lockedCollection=!0;this.scrollbars.length=0;this.scrollbars.push(u);i.clone&&this.scrollbars.push(i);this.scrollbars.push(f);r&&this.scrollbars.push(r);n&&n.clone&&this.scrollbars.push(n);this.clones.length=0;u.needFullRender&&this.clones.push(u.clone.wtTable.holder.parentNode);i.needFullRender&&this.clones.push(i.clone.wtTable.holder.parentNode);f.needFullRender&&this.clones.push(f.clone.wtTable.holder.parentNode);r&&this.clones.push(r.clone.wtTable.holder.parentNode);n&&n.clone&&this.clones.push(n.clone.wtTable.holder.parentNode)}}},{key:"onBeforeTouchScroll",value:function(){this.freezeOverlays=!0;u.arrayEach(this.clones,function(n){r.addClass(n,"hide-tween")})}},{key:"onAfterMomentumScroll",value:function(){var n=this;this.freezeOverlays=!1;u.arrayEach(this.clones,function(n){r.removeClass(n,"hide-tween");r.addClass(n,"show-tween")});setTimeout(function(){u.arrayEach(n.clones,function(n){r.removeClass(n,"show-tween")})},400);u.arrayEach(this.scrollbars,function(n){n.refresh();n.resetFixedPosition()});this.hot.view.wt.wtOverlays.syncScrollWithMaster()}}]),t}(c.default);l.registerPlugin("touchScroll",e);t.default=e},function(n,t,i){"use strict";function g(n){return n&&n.__esModule?n:{"default":n}}function c(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function l(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function a(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}function r(n){var t=this;this.instance=n;this.doneActions=[];this.undoneActions=[];this.ignoreNewActions=!1;n.addHook("afterChange",function(n,i){n&&i!=="UndoRedo.undo"&&i!=="UndoRedo.redo"&&i!=="MergeCells"&&t.done(new r.ChangeAction(n))});n.addHook("afterCreateRow",function(n,i,u){if(u!=="UndoRedo.undo"&&u!=="UndoRedo.undo"&&u!=="auto"){var f=new r.CreateRowAction(n,i);t.done(f)}});n.addHook("beforeRemoveRow",function(n,i,f,e){var o,s;e!=="UndoRedo.undo"&&e!=="UndoRedo.redo"&&e!=="auto"&&(o=t.instance.getSourceDataArray(),n=(o.length+n)%o.length,s=u.deepClone(o.slice(n,n+i)),t.done(new r.RemoveRowAction(n,s)))});n.addHook("afterCreateCol",function(n,i,u){u!=="UndoRedo.undo"&&u!=="UndoRedo.redo"&&u!=="auto"&&t.done(new r.CreateColumnAction(n,i))});n.addHook("beforeRemoveCol",function(i,u,e,o){var s;if(o!=="UndoRedo.undo"&&o!=="UndoRedo.redo"&&o!=="auto"){s=t.instance.getSourceDataArray();i=(t.instance.countCols()+i)%t.instance.countCols();var h=[],c=[],l=[];f.rangeEach(s.length-1,function(t){var r=[],e=s[t];f.rangeEach(i,i+(u-1),function(t){r.push(e[n.runHooks("modifyCol",t)])});h.push(r)});f.rangeEach(u-1,function(t){l.push(n.runHooks("modifyCol",i+t))});Array.isArray(n.getSettings().colHeaders)&&f.rangeEach(u-1,function(t){c.push(n.getSettings().colHeaders[n.runHooks("modifyCol",i+t)]||null)});var a=t.instance.getPlugin("manualColumnMove"),v=a.isEnabled()?a.columnsMapper.__arrayMap:[],y=new r.RemoveColumnAction(i,l,h,c,v);t.done(y)}});n.addHook("beforeCellAlignment",function(n,i,u,f){var e=new r.CellAlignmentAction(n,i,u,f);t.done(e)});n.addHook("beforeFilter",function(n){t.done(new r.FiltersAction(n))});n.addHook("beforeRowMove",function(n,i){n!==!1&&t.done(new r.RowMoveAction(n,i))});n.addHook("beforeMergeCells",function(i,u){u||t.done(new r.MergeCellsAction(n,i))});n.addHook("afterUnmergeCells",function(i,u){u||t.done(new r.UnmergeCellsAction(n,i))})}function p(){var n=this,t=typeof n.getSettings().undo=="undefined"||n.getSettings().undo;t?n.undoRedo||(n.undoRedo=new r(n),nt(n),n.addHook("beforeKeyDown",w),n.addHook("afterChange",b)):n.undoRedo&&(delete n.undoRedo,tt(n),n.removeHook("beforeKeyDown",w),n.removeHook("afterChange",b))}function w(n){var t=this,i=(n.ctrlKey||n.metaKey)&&!n.altKey;i&&(n.keyCode===89||n.shiftKey&&n.keyCode===90?(t.undoRedo.redo(),h.stopImmediatePropagation(n)):n.keyCode===90&&(t.undoRedo.undo(),h.stopImmediatePropagation(n)))}function b(n,t){var i=this;if(t==="loadData")return i.undoRedo.clear()}function nt(n){n.undo=function(){return n.undoRedo.undo()};n.redo=function(){return n.undoRedo.redo()};n.isUndoAvailable=function(){return n.undoRedo.isUndoAvailable()};n.isRedoAvailable=function(){return n.undoRedo.isRedoAvailable()};n.clearUndo=function(){return n.undoRedo.clear()}}function tt(n){delete n.undo;delete n.redo;delete n.isUndoAvailable;delete n.isRedoAvailable;delete n.clearUndo}var v,y,e;t.__esModule=!0;var s=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),k=i(14),d=g(k),o=i(0),f=i(4),u=i(1),h=i(11),it=i(8);r.prototype.done=function(n){this.ignoreNewActions||(this.doneActions.push(n),this.undoneActions.length=0)};r.prototype.undo=function(){var t;if(this.isUndoAvailable()){var n=this.doneActions.pop(),i=u.deepClone(n),r=this.instance,f=r.runHooks("beforeUndo",i);if(f===!1)return;this.ignoreNewActions=!0;t=this;n.undo(this.instance,function(){t.ignoreNewActions=!1;t.undoneActions.push(n)});r.runHooks("afterUndo",i)}};r.prototype.redo=function(){var t;if(this.isRedoAvailable()){var n=this.undoneActions.pop(),i=u.deepClone(n),r=this.instance,f=r.runHooks("beforeRedo",i);if(f===!1)return;this.ignoreNewActions=!0;t=this;n.redo(this.instance,function(){t.ignoreNewActions=!1;t.doneActions.push(n)});r.runHooks("afterRedo",i)}};r.prototype.isUndoAvailable=function(){return this.doneActions.length>0};r.prototype.isRedoAvailable=function(){return this.undoneActions.length>0};r.prototype.clear=function(){this.doneActions.length=0;this.undoneActions.length=0};r.Action=function(){};r.Action.prototype.undo=function(){};r.Action.prototype.redo=function(){};r.ChangeAction=function(n){this.changes=n;this.actionType="change"};u.inherit(r.ChangeAction,r.Action);r.ChangeAction.prototype.undo=function(n,t){for(var r,e,i=u.deepClone(this.changes),o=n.countEmptyRows(!0),s=n.countEmptyCols(!0),f=0,h=i.length;f<h;f++)i[f].splice(3,1);for(n.addHookOnce("afterChange",t),n.setDataAtRowProp(i,null,null,"UndoRedo.undo"),r=0,e=i.length;r<e;r++)n.getSettings().minSpareRows&&i[r][0]+1+n.getSettings().minSpareRows===n.countRows()&&o===n.getSettings().minSpareRows&&(n.alter("remove_row",parseInt(i[r][0]+1,10),n.getSettings().minSpareRows),n.undoRedo.doneActions.pop()),n.getSettings().minSpareCols&&i[r][1]+1+n.getSettings().minSpareCols===n.countCols()&&s===n.getSettings().minSpareCols&&(n.alter("remove_col",parseInt(i[r][1]+1,10),n.getSettings().minSpareCols),n.undoRedo.doneActions.pop())};r.ChangeAction.prototype.redo=function(n,t){for(var i=u.deepClone(this.changes),r=0,f=i.length;r<f;r++)i[r].splice(2,1);n.addHookOnce("afterChange",t);n.setDataAtRowProp(i,null,null,"UndoRedo.redo")};r.CreateRowAction=function(n,t){this.index=n;this.amount=t;this.actionType="insert_row"};u.inherit(r.CreateRowAction,r.Action);r.CreateRowAction.prototype.undo=function(n,t){var i=n.countRows(),r=n.getSettings().minSpareRows;this.index>=i&&this.index-r<i&&(this.index-=r);n.addHookOnce("afterRemoveRow",t);n.alter("remove_row",this.index,this.amount,"UndoRedo.undo")};r.CreateRowAction.prototype.redo=function(n,t){n.addHookOnce("afterCreateRow",t);n.alter("insert_row",this.index,this.amount,"UndoRedo.redo")};r.RemoveRowAction=function(n,t){this.index=n;this.data=t;this.actionType="remove_row"};u.inherit(r.RemoveRowAction,r.Action);r.RemoveRowAction.prototype.undo=function(n,t){n.alter("insert_row",this.index,this.data.length,"UndoRedo.undo");n.addHookOnce("afterRender",t);n.populateFromArray(this.index,0,this.data,void 0,void 0,"UndoRedo.undo")};r.RemoveRowAction.prototype.redo=function(n,t){n.addHookOnce("afterRemoveRow",t);n.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")};r.CreateColumnAction=function(n,t){this.index=n;this.amount=t;this.actionType="insert_col"};u.inherit(r.CreateColumnAction,r.Action);r.CreateColumnAction.prototype.undo=function(n,t){n.addHookOnce("afterRemoveCol",t);n.alter("remove_col",this.index,this.amount,"UndoRedo.undo")};r.CreateColumnAction.prototype.redo=function(n,t){n.addHookOnce("afterCreateCol",t);n.alter("insert_col",this.index,this.amount,"UndoRedo.redo")};r.RemoveColumnAction=function(n,t,i,r,u){this.index=n;this.indexes=t;this.data=i;this.amount=this.data[0].length;this.headers=r;this.columnPositions=u.slice(0);this.actionType="remove_col"};u.inherit(r.RemoveColumnAction,r.Action);r.RemoveColumnAction.prototype.undo=function(n,t){var s=this,h=void 0,i=this.indexes.slice(0).sort(),c=function(n,t,r){return r[s.indexes.indexOf(i[t])]},u=[],r,e;if(f.rangeEach(this.data.length-1,function(n){u[n]=o.arrayMap(s.data[n],c)}),r=[],r=o.arrayMap(this.headers,c),e=[],n.runHooks("beforeCreateCol",this.indexes[0],this.indexes.length,"UndoRedo.undo"),f.rangeEach(this.data.length-1,function(t){h=n.getSourceDataAtRow(t);f.rangeEach(i.length-1,function(n){h.splice(i[n],0,u[t][n]);e.push([t,i[n],null,u[t][n]])})}),n.getPlugin("formulas"))n.getPlugin("formulas").onAfterSetDataAtCell(e);typeof this.headers!="undefined"&&f.rangeEach(r.length-1,function(t){n.getSettings().colHeaders.splice(i[t],0,r[t])});n.getPlugin("manualColumnMove")&&(n.getPlugin("manualColumnMove").columnsMapper.__arrayMap=this.columnPositions);n.addHookOnce("afterRender",t);n.runHooks("afterCreateCol",this.indexes[0],this.indexes.length,"UndoRedo.undo");n.getPlugin("formulas")&&n.getPlugin("formulas").recalculateFull();n.render()};r.RemoveColumnAction.prototype.redo=function(n,t){n.addHookOnce("afterRemoveCol",t);n.alter("remove_col",this.index,this.amount,"UndoRedo.redo")};r.CellAlignmentAction=function(n,t,i,r){this.stateBefore=n;this.range=t;this.type=i;this.alignment=r};r.CellAlignmentAction.prototype.undo=function(n,t){var i=this;n.getPlugin("contextMenu").isEnabled()&&(o.arrayEach(this.range,function(t){for(var r,f=t.from,e=t.to,u=f.row;u<=e.row;u++)for(r=f.col;r<=e.col;r++)n.setCellMeta(u,r,"className",i.stateBefore[u][r]||" htLeft")}),n.addHookOnce("afterRender",t),n.render())};r.CellAlignmentAction.prototype.redo=function(n,t){var i=this;n.getPlugin("contextMenu").isEnabled()&&(o.arrayEach(this.range,function(t){var r=t.from,u=t.to;n.selectCell(r.row,r.col,u.row,u.col);n.getPlugin("contextMenu").executeCommand("alignment:"+i.alignment.replace("ht","").toLowerCase())}),n.addHookOnce("afterRender",t),n.render())};r.FiltersAction=function(n){this.conditionsStack=n;this.actionType="filter"};u.inherit(r.FiltersAction,r.Action);r.FiltersAction.prototype.undo=function(n,t){var i=n.getPlugin("filters");n.addHookOnce("afterRender",t);i.conditionCollection.importAllConditions(this.conditionsStack.slice(0,this.conditionsStack.length-1));i.filter()};r.FiltersAction.prototype.redo=function(n,t){var i=n.getPlugin("filters");n.addHookOnce("afterRender",t);i.conditionCollection.importAllConditions(this.conditionsStack);i.filter()};v=function(n){function t(n,i){c(this,t);var r=l(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return r.cellRange=i,r.rangeData=n.getData(i.from.row,i.from.col,i.to.row,i.to.col),r}return a(t,n),s(t,[{key:"undo",value:function(n,t){var i=n.getPlugin("mergeCells");n.addHookOnce("afterRender",t);i.unmergeRange(this.cellRange,!0);n.populateFromArray(this.cellRange.from.row,this.cellRange.from.col,this.rangeData,void 0,void 0,"MergeCells")}},{key:"redo",value:function(n,t){var i=n.getPlugin("mergeCells");n.addHookOnce("afterRender",t);i.mergeRange(this.cellRange)}}]),t}(r.Action);r.MergeCellsAction=v;y=function(n){function t(n,i){c(this,t);var r=l(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return r.cellRange=i,r}return a(t,n),s(t,[{key:"undo",value:function(n,t){var i=n.getPlugin("mergeCells");n.addHookOnce("afterRender",t);i.mergeRange(this.cellRange,!0)}},{key:"redo",value:function(n,t){var i=n.getPlugin("mergeCells");n.addHookOnce("afterRender",t);i.unmergeRange(this.cellRange,!0);n.render()}}]),t}(r.Action);r.UnmergeCellsAction=y;r.RowMoveAction=function(n,t){this.rows=n.slice();this.target=t};u.inherit(r.RowMoveAction,r.Action);r.RowMoveAction.prototype.undo=function(n,t){var f=n.getPlugin("manualRowMove"),i;n.addHookOnce("afterRender",t);var r=this.rows[0]<this.target?-1*this.rows.length:0,e=this.rows[0]>this.target?this.rows[0]+this.rows.length:this.rows[0],u=[],o=this.rows.length+r;for(i=r;i<o;i+=1)u.push(this.target+i);f.moveRows(u.slice(),e);n.render();n.selectCell(this.rows[0],0,this.rows[this.rows.length-1],n.countCols()-1,!1,!1)};r.RowMoveAction.prototype.redo=function(n,t){var r=n.getPlugin("manualRowMove"),i;n.addHookOnce("afterRender",t);r.moveRows(this.rows.slice(),this.target);n.render();i=this.rows[0]<this.target?this.target-this.rows.length:this.target;n.selectCell(i,0,i+this.rows.length-1,n.countCols()-1,!1,!1)};e=d.default.getSingleton();e.add("afterInit",p);e.add("afterUpdateSettings",p);e.register("beforeUndo");e.register("afterUndo");e.register("beforeRedo");e.register("afterRedo");t.default=r},function(n,t,i){"use strict";function r(n){return n&&n.__esModule?n:{"default":n}}t.__esModule=!0;t.TrimRows=t.NestedRows=t.NestedHeaders=t.HiddenRows=t.HiddenColumns=t.HeaderTooltips=t.GanttChart=t.Formulas=t.Filters=t.ExportFile=t.DropdownMenu=t.ColumnSummary=t.CollapsibleColumns=t.BindRowsWithHeaders=undefined;var u=i(377),f=r(u),e=i(382),o=r(e),s=i(383),h=r(s),c=i(385),l=r(c),a=i(387),v=r(a),y=i(392),p=r(y),w=i(421),b=r(w),k=i(434),d=r(k),g=i(437),nt=r(g),tt=i(438),it=r(tt),rt=i(441),ut=r(rt),ft=i(446),et=r(ft),ot=i(450),st=r(ot),ht=i(454),ct=r(ht);t.BindRowsWithHeaders=f.default;t.CollapsibleColumns=o.default;t.ColumnSummary=h.default;t.DropdownMenu=l.default;t.ExportFile=v.default;t.Filters=p.default;t.Formulas=b.default;t.GanttChart=d.default;t.HeaderTooltips=nt.default;t.HiddenColumns=et.default;t.HiddenRows=st.default;t.NestedHeaders=it.default;t.NestedRows=ut.default;t.TrimRows=ct.default},function(n,t,i){"use strict";function e(n){return n&&n.__esModule?n:{"default":n}}function y(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function p(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function w(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var u;t.__esModule=!0;var o=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),r=function s(n,t,i){var r,u,f;return n===null&&(n=Function.prototype),r=Object.getOwnPropertyDescriptor(n,t),r===undefined?(u=Object.getPrototypeOf(n),u===null?undefined:s(u,t,i)):"value"in r?r.value:(f=r.get,f===undefined)?undefined:f.call(i)},h=i(7),c=e(h),b=i(0),l=i(4),a=i(6),v=i(378),f=e(v);u=function(n){function t(n){y(this,t);var i=p(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return i.bindStrategy=new f.default,i.removedRows=[],i}return w(t,n),o(t,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().bindRowsWithHeaders}},{key:"enablePlugin",value:function(){var n=this,i;this.enabled||(i=this.hot.getSettings().bindRowsWithHeaders,typeof i!="string"&&(i=f.default.DEFAULT_STRATEGY),this.bindStrategy.setStrategy(i),this.bindStrategy.createMap(this.hot.countSourceRows()),this.addHook("modifyRowHeader",function(t){return n.onModifyRowHeader(t)}),this.addHook("afterCreateRow",function(t,i){return n.onAfterCreateRow(t,i)}),this.addHook("beforeRemoveRow",function(t,i){return n.onBeforeRemoveRow(t,i)}),this.addHook("afterRemoveRow",function(t,i){return n.onAfterRemoveRow(t,i)}),this.addHook("afterLoadData",function(t){return n.onAfterLoadData(t)}),r(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){r(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.removedRows.length=0;this.bindStrategy.clearMap();r(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disablePlugin",this).call(this)}},{key:"onModifyRowHeader",value:function(n){return this.bindStrategy.translate(this.hot.runHooks("modifyRow",n))}},{key:"onAfterCreateRow",value:function(n,t){this.bindStrategy.createRow(n,t)}},{key:"onBeforeRemoveRow",value:function(n,t){var i=this;this.removedRows.length=0;n!==!1&&l.rangeEach(n,n+t-1,function(n){i.removedRows.push(i.hot.runHooks("modifyRow",n))})}},{key:"onAfterRemoveRow",value:function(){this.bindStrategy.removeRow(this.removedRows)}},{key:"onAfterLoadData",value:function(n){n||this.bindStrategy.createMap(this.hot.countSourceRows())}},{key:"destroy",value:function(){this.bindStrategy.destroy();r(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}}]),t}(c.default);a.registerPlugin("bindRowsWithHeaders",u);t.default=u},function(n,t,i){"use strict";function h(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function c(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var u;t.__esModule=!0;var r=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),l=i(54),a=i(1),f=i(4),e=i(30),o=i(379),s=h(o);u=function(){function n(){c(this,n);this.strategy=null}return r(n,null,[{key:"DEFAULT_STRATEGY",get:function(){return"loose"}}]),r(n,[{key:"setStrategy",value:function(n){var t=s[e.toUpperCaseFirst(n)];if(!t)throw new Error('Bind strategy "'+n+'" does not exist.');this.strategy=new t}},{key:"createMap",value:function(n){var t=this.strategy,i=n===void 0?t._arrayMap.length:n;t._arrayMap.length=0;f.rangeEach(i-1,function(n){t._arrayMap.push(n)})}},{key:"createRow",value:function(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];this.strategy.createRow.apply(this.strategy,i)}},{key:"removeRow",value:function(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];this.strategy.removeRow.apply(this.strategy,i)}},{key:"translate",value:function(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];return this.strategy.getValueByIndex.apply(this.strategy,i)}},{key:"clearMap",value:function(){this.strategy.clearMap()}},{key:"destroy",value:function(){this.strategy&&this.strategy.destroy();this.strategy=null}}]),n}();t.default=u},function(n,t,i){"use strict";function r(n){return n&&n.__esModule?n:{"default":n}}t.__esModule=!0;t.Strict=t.Loose=undefined;var u=i(380),f=r(u),e=i(381),o=r(e);t.Loose=f.default;t.Strict=o.default},function(n,t,i){"use strict";function s(n){return n&&n.__esModule?n:{"default":n}}function h(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var r;t.__esModule=!0;var u=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),f=i(54),e=s(f),o=i(1);r=function(){function n(){h(this,n)}return u(n,[{key:"createRow",value:function(n,t){this.shiftItems(n,t)}},{key:"removeRow",value:function(n,t){this.unshiftItems(n,t)}},{key:"destroy",value:function(){this._arrayMap=null}}],[{key:"STRATEGY_NAME",get:function(){return"loose"}}]),n}();o.mixin(r,e.default);t.default=r},function(n,t,i){"use strict";function s(n){return n&&n.__esModule?n:{"default":n}}function h(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var r;t.__esModule=!0;var u=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),f=i(54),e=s(f),o=i(1);r=function(){function n(){h(this,n)}return u(n,[{key:"createRow",value:function(n,t){this.insertItems(n,t)}},{key:"removeRow",value:function(n,t){this.removeItems(n,t)}},{key:"destroy",value:function(){this._arrayMap=null}}],[{key:"STRATEGY_NAME",get:function(){return"strict"}}]),n}();o.mixin(r,e.default);t.default=r},function(n,t,i){"use strict";function h(n){return n&&n.__esModule?n:{"default":n}}function k(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function d(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function g(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var o;t.__esModule=!0;var c=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),u=function l(n,t,i){var r,u,f;return n===null&&(n=Function.prototype),r=Object.getOwnPropertyDescriptor(n,t),r===undefined?(u=Object.getPrototypeOf(n),u===null?undefined:l(u,t,i)):"value"in r?r.value:(f=r.get,f===undefined)?undefined:f.call(i)},f=i(1),s=i(0),e=i(4),r=i(2),a=i(9),v=h(a),y=i(6),p=i(11),w=i(7),b=h(w);o=function(n){function t(n){k(this,t);var i=d(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return i.settings=null,i.buttonEnabledList={},i.hiddenColumnsPlugin=null,i.nestedHeadersPlugin=null,i.collapsedSections={},i.columnHeaderLevelCount=null,i.eventManager=null,i}return g(t,n),c(t,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().collapsibleColumns}},{key:"enablePlugin",value:function(){var n=this;this.enabled||(this.settings=this.hot.getSettings().collapsibleColumns,typeof this.settings!="boolean"&&this.parseSettings(),this.hiddenColumnsPlugin=this.hot.getPlugin("hiddenColumns"),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.checkDependencies(),this.addHook("afterRender",function(){return n.onAfterRender()}),this.addHook("afterInit",function(){return n.onAfterInit()}),this.addHook("afterGetColHeader",function(t,i){return n.onAfterGetColHeader(t,i)}),this.addHook("beforeOnCellMouseDown",function(t,i,r){return n.onBeforeOnCellMouseDown(t,i,r)}),this.eventManager=new v.default(this.hot),u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.settings=null;this.buttonEnabledList={};this.hiddenColumnsPlugin=null;this.collapsedSections={};this.clearButtons();u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disablePlugin",this).call(this)}},{key:"clearButtons",value:function(){if(this.hot.view){var i=this.hot.view.wt.getSetting("columnHeaders").length,r=this.hot.view.wt.wtTable.THEAD,u=this.hot.view.wt.wtOverlays.topOverlay.clone.wtTable.THEAD,n=this.hot.view.wt.wtOverlays.topLeftCornerOverlay?this.hot.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.THEAD:null,t=function(n){n&&n.parentNode.removeChild(n)};e.rangeEach(0,i-1,function(i){var s=r.childNodes[i],f=u.childNodes[i],o=n?n.childNodes[i]:null;e.rangeEach(0,s.childNodes.length-1,function(i){var r=s.childNodes[i].querySelector(".collapsibleIndicator");t(r);f&&f.childNodes[i]&&(r=f.childNodes[i].querySelector(".collapsibleIndicator"),t(r));n&&o&&o.childNodes[i]&&(r=o.childNodes[i].querySelector(".collapsibleIndicator"),t(r))})},!0)}}},{key:"parseSettings",value:function(){var n=this;f.objectEach(this.settings,function(t){n.buttonEnabledList[t.row]||(n.buttonEnabledList[t.row]={});n.buttonEnabledList[t.row][t.col]=t.collapsible})}},{key:"meetsDependencies",value:function(){var n=this.hot.getSettings();return n.nestedHeaders&&n.hiddenColumns}},{key:"checkDependencies",value:function(){var n=this.hot.getSettings();this.meetsDependencies()||(n.nestedHeaders||console.warn("You need to configure the Nested Headers plugin in order to use collapsible headers."),n.hiddenColumns||console.warn("You need to configure the Hidden Columns plugin in order to use collapsible headers."))}},{key:"generateIndicator",value:function(n,t){var f=t.parentNode,e=f.parentNode,u=-1*e.childNodes.length+Array.prototype.indexOf.call(e.childNodes,f),i;return Object.keys(this.buttonEnabledList).length>0&&(!this.buttonEnabledList[u]||!this.buttonEnabledList[u][n])?null:(i=document.createElement("DIV"),r.addClass(i,"collapsibleIndicator"),this.collapsedSections[u]&&this.collapsedSections[u][n]===!0?(r.addClass(i,"collapsed"),r.fastInnerText(i,"+")):(r.addClass(i,"expanded"),r.fastInnerText(i,"-")),i)}},{key:"markSectionAs",value:function(n,t,i,r){var u;this.collapsedSections[t]||(this.collapsedSections[t]={});switch(n){case"collapsed":this.collapsedSections[t][i]=!0;break;case"expanded":this.collapsedSections[t][i]=void 0}if(r){var o=this.nestedHeadersPlugin.colspanArray,s=this.nestedHeadersPlugin.rowCoordsToLevel(t),f=this.nestedHeadersPlugin.getChildHeaders(t,i),e=o[s+1];for(u=1;u<f.length;u++)e&&e[f[u]].colspan>1&&this.markSectionAs(n,t+1,f[u],!0)}}},{key:"expandSection",value:function(n){this.markSectionAs("expanded",n.row,n.col,!0);this.toggleCollapsibleSection(n,"expand")}},{key:"collapseSection",value:function(n){this.markSectionAs("collapsed",n.row,n.col,!0);this.toggleCollapsibleSection(n,"collapse")}},{key:"toggleAllCollapsibleSections",value:function(n){var t=this,i=this.nestedHeadersPlugin.colspanArray;this.settings===!0?s.arrayEach(i,function(i,r){s.arrayEach(i,function(i,u){if(i.colspan>1){r=parseInt(r,10);u=parseInt(u,10);var f=t.nestedHeadersPlugin.levelToRowCoords(r),e=u;t.markSectionAs(n==="collapse"?"collapsed":"expanded",f,e,!0);t.toggleCollapsibleSection({row:f,col:e},n)}})}):f.objectEach(this.buttonEnabledList,function(i,r){f.objectEach(i,function(i,u){r=parseInt(r,10);u=parseInt(u,10);t.markSectionAs(n==="collapse"?"collapsed":"expanded",r,u,!0);t.toggleCollapsibleSection({row:r,col:u},n)})})}},{key:"collapseAll",value:function(){this.toggleAllCollapsibleSections("collapse")}},{key:"expandAll",value:function(){this.toggleAllCollapsibleSections("expand")}},{key:"toggleCollapsibleSection",value:function(n,t){var s=this;n.row&&(n.row=parseInt(n.row,10));n.col&&(n.col=parseInt(n.col,10));for(var u=this.hiddenColumnsPlugin.hiddenColumns,f=this.nestedHeadersPlugin.colspanArray,h=this.nestedHeadersPlugin.rowCoordsToLevel(n.row),c=f[h][n.col].colspan,l=this.nestedHeadersPlugin.getChildHeaders(n.row,n.col),r=h+1,i=f[r],o=i?i[l[0]].colspan||1:1;o===c&&r<this.columnHeaderLevelCount;)r+=1,i=f[r],o=i?i[l[0]].colspan||1:1;e.rangeEach(o,c-1,function(i){var r=n.col+i;switch(t){case"collapse":s.hiddenColumnsPlugin.isHidden(r)||u.push(r);break;case"expand":s.hiddenColumnsPlugin.isHidden(r)&&u.splice(u.indexOf(r),1)}});this.hot.render()}},{key:"onAfterGetColHeader",value:function(n,t){if(t.hasAttribute("colspan")&&t.getAttribute("colspan")>1&&n>=this.hot.getSettings().fixedColumnsLeft){var i=this.generateIndicator(n,t);i!==null&&t.querySelector("div:first-child").appendChild(i)}}},{key:"onBeforeOnCellMouseDown",value:function(n,t){if(r.hasClass(n.target,"collapsibleIndicator"))return r.hasClass(n.target,"expanded")?(this.collapsedSections[t.row]||(this.collapsedSections[t.row]=[]),this.markSectionAs("collapsed",t.row,t.col,!0),this.eventManager.fireEvent(n.target,"mouseup"),this.toggleCollapsibleSection(t,"collapse")):r.hasClass(n.target,"collapsed")&&(this.markSectionAs("expanded",t.row,t.col,!0),this.eventManager.fireEvent(n.target,"mouseup"),this.toggleCollapsibleSection(t,"expand")),p.stopImmediatePropagation(n),!1}},{key:"onAfterInit",value:function(){this.columnHeaderLevelCount=this.hot.view.wt.getSetting("columnHeaders").length}},{key:"onAfterRender",value:function(){this.nestedHeadersPlugin.enabled&&this.hiddenColumnsPlugin.enabled||this.disablePlugin()}},{key:"destroy",value:function(){this.settings=null;this.buttonEnabledList=null;this.hiddenColumnsPlugin=null;this.nestedHeadersPlugin=null;this.collapsedSections=null;this.columnHeaderLevelCount=null;u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}}]),t}(b.default);y.registerPlugin("collapsibleColumns",o);t.default=o},function(n,t,i){"use strict";function f(n){return n&&n.__esModule?n:{"default":n}}function y(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function p(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function w(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var u;t.__esModule=!0;var e=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),o=function s(n,t,i){var r,u,f;return n===null&&(n=Function.prototype),r=Object.getOwnPropertyDescriptor(n,t),r===undefined?(u=Object.getPrototypeOf(n),u===null?undefined:s(u,t,i)):"value"in r?r.value:(f=r.get,f===undefined)?undefined:f.call(i)},h=i(7),c=f(h),r=i(1),b=i(0),l=i(6),a=i(384),v=f(a);u=function(n){function t(n){y(this,t);var i=p(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return i.endpoints=null,i}return w(t,n),e(t,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().columnSummary}},{key:"enablePlugin",value:function(){var n=this;this.enabled||(this.settings=this.hot.getSettings().columnSummary,this.endpoints=new v.default(this,this.settings),this.addHook("afterInit",function(){return n.onAfterInit.apply(n,arguments)}),this.addHook("afterChange",function(){return n.onAfterChange.apply(n,arguments)}),this.addHook("beforeCreateRow",function(t,i,r){return n.endpoints.resetSetupBeforeStructureAlteration("insert_row",t,i,null,r)}),this.addHook("beforeCreateCol",function(t,i,r){return n.endpoints.resetSetupBeforeStructureAlteration("insert_col",t,i,null,r)}),this.addHook("beforeRemoveRow",function(){for(var i,r=arguments.length,u=Array(r),t=0;t<r;t++)u[t]=arguments[t];return(i=n.endpoints).resetSetupBeforeStructureAlteration.apply(i,["remove_row"].concat(u))}),this.addHook("beforeRemoveCol",function(){for(var i,r=arguments.length,u=Array(r),t=0;t<r;t++)u[t]=arguments[t];return(i=n.endpoints).resetSetupBeforeStructureAlteration.apply(i,["remove_col"].concat(u))}),this.addHook("beforeRowMove",function(){return n.onBeforeRowMove.apply(n,arguments)}),this.addHook("afterCreateRow",function(t,i,r){return n.endpoints.resetSetupAfterStructureAlteration("insert_row",t,i,null,r)}),this.addHook("afterCreateCol",function(t,i,r){return n.endpoints.resetSetupAfterStructureAlteration("insert_col",t,i,null,r)}),this.addHook("afterRemoveRow",function(){for(var i,r=arguments.length,u=Array(r),t=0;t<r;t++)u[t]=arguments[t];return(i=n.endpoints).resetSetupAfterStructureAlteration.apply(i,["remove_row"].concat(u))}),this.addHook("afterRemoveCol",function(){for(var i,r=arguments.length,u=Array(r),t=0;t<r;t++)u[t]=arguments[t];return(i=n.endpoints).resetSetupAfterStructureAlteration.apply(i,["remove_col"].concat(u))}),this.addHook("afterRowMove",function(){return n.onAfterRowMove.apply(n,arguments)}),o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.endpoints=null;this.settings=null;this.currentEndpoint=null}},{key:"calculate",value:function(n){switch(n.type.toLowerCase()){case"sum":n.result=this.calculateSum(n);break;case"min":n.result=this.calculateMinMax(n,n.type);break;case"max":n.result=this.calculateMinMax(n,n.type);break;case"count":n.result=this.countEntries(n);break;case"average":n.result=this.calculateAverage(n);break;case"custom":n.result=n.customFunction.call(this,n)}}},{key:"calculateSum",value:function(n){var t=0;for(var i in n.ranges)r.hasOwnProperty(n.ranges,i)&&(t+=this.getPartialSum(n.ranges[i],n.sourceColumn));return t}},{key:"getPartialSum",value:function(n,t){var e=0,r=n[1]||n[0],u=null,i=0,f;do u=this.getCellValue(r,t)||0,f=((u+"").split(".")[1]||[]).length||1,f>i&&(i=f),e+=u||0,r--;while(r>=n[0]);return Math.round(e*Math.pow(10,i))/Math.pow(10,i)}},{key:"calculateMinMax",value:function(n,t){var i=null,f,u;for(f in n.ranges)if(r.hasOwnProperty(n.ranges,f)&&(u=this.getPartialMinMax(n.ranges[f],n.sourceColumn,t),i===null&&u!==null&&(i=u),u!==null))switch(t){case"min":i=Math.min(i,u);break;case"max":i=Math.max(i,u)}return i===null?"Not enough data":i}},{key:"getPartialMinMax",value:function(n,t,i){var r=null,f=n[1]||n[0],u=void 0;do{if(u=this.getCellValue(f,t)||null,r===null)r=u;else if(u!==null)switch(i){case"min":r=Math.min(r,u);break;case"max":r=Math.max(r,u)}f--}while(f>=n[0]);return r}},{key:"countEmpty",value:function(n,t){var r=void 0,u=0,i=n[1]||n[0];do r=this.getCellValue(i,t),r||u++,i--;while(i>=n[0]);return u}},{key:"countEntries",value:function(n){var u=0,t=n.ranges,i,f,e;for(i in t)r.hasOwnProperty(t,i)&&(f=t[i][1]===void 0?1:t[i][1]-t[i][0]+1,e=this.countEmpty(t[i],n.sourceColumn),u+=f,u-=e);return u}},{key:"calculateAverage",value:function(n){var t=this.calculateSum(n),i=this.countEntries(n);return t/i}},{key:"getCellValue",value:function(n,t){var r=this.endpoints.getVisualRowIndex(n),u=this.endpoints.getVisualColumnIndex(t),i=this.hot.getSourceDataAtCell(n,t),f=this.hot.getCellMeta(r,u).className||"";if(f.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof i=="string"&&(i=i.replace(/,/,".")),i=parseFloat(i)),isNaN(i)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error("ColumnSummary plugin: cell at ("+n+", "+t+") is not in a numeric format. Cannot do the calculation.");return i}},{key:"onAfterInit",value:function(){this.endpoints.endpoints=this.endpoints.parseSettings();this.endpoints.refreshAllEndpoints(!0)}},{key:"onAfterChange",value:function(n,t){n&&t!=="ColumnSummary.reset"&&t!=="ColumnSummary.set"&&t!=="loadData"&&this.endpoints.refreshChangedEndpoints(n)}},{key:"onBeforeRowMove",value:function(n){this.endpoints.resetSetupBeforeStructureAlteration("move_row",n[0],n.length,n,this.pluginName)}},{key:"onAfterRowMove",value:function(n,t){this.endpoints.resetSetupAfterStructureAlteration("move_row",t,n.length,n,this.pluginName)}}]),t}(c.default);l.registerPlugin("columnSummary",u);t.default=u},function(n,t,i){"use strict";function s(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var u;t.__esModule=!0;var f=function(){function n(n,t){var r=[],u=!0,f=!1,e=undefined,i,o;try{for(i=n[Symbol.iterator]();!(u=(o=i.next()).done);u=!0)if(r.push(o.value),t&&r.length===t)break}catch(s){f=!0;e=s}finally{try{!u&&i["return"]&&i["return"]()}finally{if(f)throw e;}}return r}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return n(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance");}}(),e=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),r=i(0),h=i(1),o=i(53);u=function(){function n(t,i){s(this,n);this.plugin=t;this.hot=this.plugin.hot;this.endpoints=[];this.settings=i;this.settingsType="array";this.currentEndpoint=null;this.cellsToSetCache=[];this.recordTranslator=o.getTranslator(this.hot)}return e(n,[{key:"getEndpoint",value:function(n){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[n]:this.endpoints[n]}},{key:"getAllEndpoints",value:function(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}},{key:"fillMissingEndpointData",value:function(n){return this.parseSettings(n.call(this))}},{key:"parseSettings",value:function(n){var t=this,i=[];if(!n&&typeof this.settings=="function"){this.settingsType="function";return}return n||(n=this.settings),r.arrayEach(n,function(n){var r={};t.assignSetting(n,r,"ranges",[[0,t.hot.countRows()-1]]);t.assignSetting(n,r,"reversedRowCoords",!1);t.assignSetting(n,r,"destinationRow",new Error("\n        You must provide a destination row for the Column Summary plugin in order to work properly!\n      "));t.assignSetting(n,r,"destinationColumn",new Error("\n        You must provide a destination column for the Column Summary plugin in order to work properly!\n      "));t.assignSetting(n,r,"sourceColumn",n.destinationColumn);t.assignSetting(n,r,"type","sum");t.assignSetting(n,r,"forceNumeric",!1);t.assignSetting(n,r,"suppressDataTypeErrors",!0);t.assignSetting(n,r,"suppressDataTypeErrors",!0);t.assignSetting(n,r,"customFunction",null);t.assignSetting(n,r,"readOnly",!0);t.assignSetting(n,r,"roundFloat",!1);i.push(r)}),i}},{key:"assignSetting",value:function(n,t,i,r){if(i==="ranges"&&n[i]===void 0){t[i]=r;return}if(i!=="ranges"||n[i].length!==0)if(n[i]===void 0){if(r instanceof Error)throw r;t[i]=r}else t[i]=i==="destinationRow"&&t.reversedRowCoords?this.hot.countRows()-n[i]-1:n[i]}},{key:"resetSetupBeforeStructureAlteration",value:function(n,t,i){if(this.settingsType==="function"){var u=n.indexOf("row")>-1?"row":"col",f=this.getAllEndpoints();r.arrayEach(f,function(r){u==="row"&&r.destinationRow>=t&&(n==="insert_row"?r.alterRowOffset=i:n==="remove_row"&&(r.alterRowOffset=-1*i));u==="col"&&r.destinationColumn>=t&&(n==="insert_col"?r.alterColumnOffset=i:n==="remove_col"&&(r.alterColumnOffset=-1*i))});this.resetAllEndpoints(f,!1)}}},{key:"resetSetupAfterStructureAlteration",value:function(n,t,i,u){var f=this,a=arguments.length>5&&arguments[5]!==undefined?arguments[5]:!0,s;if(this.settingsType==="function"){s=function s(){return f.hot.removeHook("beforeRender",s),f.refreshAllEndpoints(!0)};this.hot.addHookOnce("beforeRender",s);return}var h=n.indexOf("row")>-1?"row":"col",c=n.indexOf("remove")>-1?-1:1,e=this.getAllEndpoints(),l=n.indexOf("move_row")===0,o=t;r.arrayEach(e,function(n){h==="row"&&n.destinationRow>=o&&(n.alterRowOffset=c*i);h==="col"&&n.destinationColumn>=o&&(n.alterColumnOffset=c*i)});this.resetAllEndpoints(e,!l);l?r.arrayEach(e,function(n){f.extendEndpointRanges(n,o,u[0],u.length);f.recreatePhysicalRanges(n);f.clearOffsetInformation(n)}):r.arrayEach(e,function(n){f.shiftEndpointCoordinates(n,o)});a&&this.refreshAllEndpoints(!0)}},{key:"clearOffsetInformation",value:function(n){n.alterRowOffset=void 0;n.alterColumnOffset=void 0}},{key:"extendEndpointRanges",value:function(n,t,i,u){r.arrayEach(n.ranges,function(n){n[1]&&(t>=n[0]&&t<=n[1]?i>n[1]?n[1]+=u:i<n[0]&&(n[0]-=u):i>=n[0]&&i<=n[1]&&(n[1]-=u,t<=n[0]&&(n[0]++,n[1]++)))})}},{key:"recreatePhysicalRanges",value:function(n){var i=this,f=n.ranges,t=[],u=[];r.arrayEach(f,function(n){var r=[],t;if(n[1])for(t=n[0];t<=n[1];t++)r.push(i.recordTranslator.toPhysicalRow(t));else r.push(i.recordTranslator.toPhysicalRow(n[0]));u.push(r)});r.arrayEach(u,function(n){var i=[];r.arrayEach(n,function(r,u){u===0?i.push(r):n[u]!==n[u-1]+1&&(i.push(n[u-1]),t.push(i),i=[],i.push(r));u===n.length-1&&(i.push(r),t.push(i))})});n.ranges=t}},{key:"shiftEndpointCoordinates",value:function(n,t){n.alterRowOffset&&n.alterRowOffset!==0?(n.destinationRow+=n.alterRowOffset||0,r.arrayEach(n.ranges,function(i){r.arrayEach(i,function(r,u){r>=t&&(i[u]+=n.alterRowOffset||0)})})):n.alterColumnOffset&&n.alterColumnOffset!==0&&(n.destinationColumn+=n.alterColumnOffset||0,n.sourceColumn+=n.alterColumnOffset||0)}},{key:"resetAllEndpoints",value:function(n){var t=this,i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!0;this.cellsToSetCache=[];n||(n=this.getAllEndpoints());r.arrayEach(n,function(n){t.resetEndpointValue(n,i)});this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset");this.cellsToSetCache=[]}},{key:"refreshAllEndpoints",value:function(){var n=this;this.cellsToSetCache=[];r.arrayEach(this.getAllEndpoints(),function(t){n.currentEndpoint=t;n.plugin.calculate(t);n.setEndpointValue(t,"init")});this.currentEndpoint=null;this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset");this.cellsToSetCache=[]}},{key:"refreshChangedEndpoints",value:function(n){var t=this,i=[];this.cellsToSetCache=[];r.arrayEach(n,function(n,u,f){(n[2]||"")+""!=n[3]+""&&r.arrayEach(t.getAllEndpoints(),function(n,r){t.hot.propToCol(f[u][1])===n.sourceColumn&&i.indexOf(r)===-1&&i.push(r)})});r.arrayEach(i,function(n){t.refreshEndpoint(t.getEndpoint(n))});this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset");this.cellsToSetCache=[]}},{key:"refreshEndpoint",value:function(n){this.currentEndpoint=n;this.plugin.calculate(n);this.setEndpointValue(n);this.currentEndpoint=null}},{key:"resetEndpointValue",value:function(n){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!0,u=n.alterRowOffset||0,e=n.alterColumnOffset||0,o=this.recordTranslator.toVisual(n.destinationRow,n.destinationColumn),i=f(o,2),s=i[0],h=i[1],r=this.hot.getCellMeta(s,h);r.readOnly=!1;r.className="";this.cellsToSetCache.push([this.recordTranslator.toVisualRow(n.destinationRow+(t?u:0)),this.recordTranslator.toVisualColumn(n.destinationColumn+(t?e:0)),""])}},{key:"setEndpointValue",value:function(n,t){var u=arguments.length>2&&arguments[2]!==undefined?arguments[2]:!1,f=-1*n.alterRowOffset||0,e=-1*n.alterColumnOffset||0,i=this.getVisualRowIndex(n.destinationRow),r=this.hot.getCellMeta(this.getVisualRowIndex(n.destinationRow+f),n.destinationColumn+e);if(i>this.hot.countRows()||n.destinationColumn>this.hot.countCols()){this.throwOutOfBoundsWarning();return}(t==="init"||r.readOnly!==n.readOnly)&&(r.readOnly=n.readOnly,r.className="columnSummaryResult");n.roundFloat&&!isNaN(n.result)&&(n.result=n.result.toFixed(n.roundFloat));u?this.hot.setDataAtCell(i,n.destinationColumn,n.result,"ColumnSummary.set"):this.cellsToSetCache.push([i,n.destinationColumn,n.result]);n.alterRowOffset=void 0;n.alterColumnOffset=void 0}},{key:"getVisualRowIndex",value:function(n){return this.hot.runHooks("unmodifyRow",n,"columnSummary")}},{key:"getVisualColumnIndex",value:function(n){return this.hot.runHooks("unmodifyCol",n,"columnSummary")}},{key:"throwOutOfBoundsWarning",value:function(){console.warn("One of the  Column Summary plugins' destination points you provided is beyond the table boundaries!")}}]),n}();t.default=u},function(n,t,i){"use strict";function u(n){return n&&n.__esModule?n:{"default":n}}function ft(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function et(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function ot(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var o,s;t.__esModule=!0;var f=function c(n,t,i){var r,u,f;return n===null&&(n=Function.prototype),r=Object.getOwnPropertyDescriptor(n,t),r===undefined?(u=Object.getPrototypeOf(n),u===null?undefined:c(u,t,i)):"value"in r?r.value:(f=r.get,f===undefined)?undefined:f.call(i)},h=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),l=i(7),a=u(l),v=i(0),st=i(1),y=i(213),p=u(y),w=i(9),b=u(w),k=i(2),d=i(214),g=u(d),nt=i(157),tt=u(nt),it=i(6),rt=i(14),e=u(rt),ut=i(11),r=i(44);i(386);e.default.getSingleton().register("afterDropdownMenuDefaultOptions");e.default.getSingleton().register("afterDropdownMenuShow");e.default.getSingleton().register("afterDropdownMenuHide");e.default.getSingleton().register("afterDropdownMenuExecute");o="changeType";s=function(n){function t(n){ft(this,t);var i=et(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return i.eventManager=new b.default(i),i.commandExecutor=new p.default(i.hot),i.itemsFactory=null,i.menu=null,i.hot.addHook("afterGetColHeader",function(n,t){return i.onAfterGetColHeader(n,t)}),i}return ot(t,n),h(t,null,[{key:"DEFAULT_ITEMS",get:function(){return[r.COLUMN_LEFT,r.COLUMN_RIGHT,r.SEPARATOR,r.REMOVE_COLUMN,r.SEPARATOR,r.CLEAR_COLUMN,r.SEPARATOR,r.READ_ONLY,r.SEPARATOR,r.ALIGNMENT]}}]),h(t,[{key:"isEnabled",value:function(){return this.hot.getSettings().dropdownMenu}},{key:"enablePlugin",value:function(){var n=this,i,r;this.enabled||(this.itemsFactory=new g.default(this.hot,t.DEFAULT_ITEMS),i=this.hot.getSettings().dropdownMenu,r={items:this.itemsFactory.getItems(i)},this.registerEvents(),typeof i.callback=="function"&&this.commandExecutor.setCommonCallback(i.callback),f(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enablePlugin",this).call(this),this.callOnPluginsReady(function(){n.hot.runHooks("afterDropdownMenuDefaultOptions",r);n.itemsFactory.setPredefinedItems(r.items);var t=n.itemsFactory.getItems(i);n.menu&&n.menu.destroy();n.menu=new tt.default(n.hot,{className:"htDropdownMenu",keepInViewport:!0});n.hot.runHooks("beforeDropdownMenuSetItems",t);n.menu.setMenuItems(t);n.menu.addLocalHook("afterOpen",function(){return n.onMenuAfterOpen()});n.menu.addLocalHook("afterClose",function(){return n.onMenuAfterClose()});n.menu.addLocalHook("executeCommand",function(){for(var i=arguments.length,r=Array(i),t=0;t<i;t++)r[t]=arguments[t];return n.executeCommand.apply(n,r)});v.arrayEach(t,function(t){return n.commandExecutor.registerCommand(t.key,t)})}))}},{key:"updatePlugin",value:function(){this.disablePlugin();this.enablePlugin();f(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.close();this.menu&&this.menu.destroy();f(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disablePlugin",this).call(this)}},{key:"registerEvents",value:function(){var n=this;this.eventManager.addEventListener(this.hot.rootElement,"click",function(t){return n.onTableClick(t)})}},{key:"open",value:function(n){this.menu&&(this.menu.open(),n.width&&this.menu.setOffset("left",n.width),this.menu.setPosition(n),this.menu.hotMenu.isHotTableEnv=this.hot.isHotTableEnv)}},{key:"close",value:function(){this.menu&&this.menu.close()}},{key:"executeCommand",value:function(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];this.commandExecutor.execute.apply(this.commandExecutor,i)}},{key:"setListening",value:function(){var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:!0;this.menu.isOpened()&&(n?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}},{key:"onTableClick",value:function(n){if(ut.stopPropagation(n),k.hasClass(n.target,o)&&!this.menu.isOpened()){var t=n.target.getBoundingClientRect();this.open({left:t.left,top:t.top+n.target.offsetHeight+3,width:t.width,height:t.height})}}},{key:"onAfterGetColHeader",value:function(n,t){var u=t.parentNode,f,e,i,r;if(u&&(f=u.parentNode.childNodes,e=Array.prototype.indexOf.call(f,u),!(n<0)&&e===f.length-1)&&(i=t.querySelector("."+o),!this.enabled||!i)){if(!this.enabled){i&&i.parentNode.removeChild(i);return}r=document.createElement("button");r.className=o;r.onclick=function(){return!1};t.firstChild.insertBefore(r,t.firstChild.firstChild)}}},{key:"onMenuAfterOpen",value:function(){this.hot.runHooks("afterDropdownMenuShow",this)}},{key:"onMenuAfterClose",value:function(){this.hot.listen();this.hot.runHooks("afterDropdownMenuHide",this)}},{key:"destroy",value:function(){this.close();this.menu&&this.menu.destroy();f(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}}]),t}(a.default);s.SEPARATOR={name:r.SEPARATOR};it.registerPlugin("dropdownMenu",s);t.default=s},function(){},function(n,t,i){"use strict";function r(n){return n&&n.__esModule?n:{"default":n}}function v(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function y(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function p(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var u;t.__esModule=!0;var e=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),o=i(7),s=r(o),w=i(1),h=i(6),c=i(388),l=r(c),f=i(389),a=r(f);u=function(n){function t(){return v(this,t),y(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p(t,n),e(t,[{key:"isEnabled",value:function(){return!0}},{key:"exportAsString",value:function(n){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};return this._createTypeFormatter(n,t).export()}},{key:"exportAsBlob",value:function(n){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};return this._createBlob(this._createTypeFormatter(n,t))}},{key:"downloadFile",value:function(n){var o=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{},i=this._createTypeFormatter(n,o),u=this._createBlob(i),f=window.URL||window.webkitURL,t=document.createElement("a"),e=i.options.filename+"."+i.options.fileExtension,r;t.download!==void 0?(r=f.createObjectURL(u),t.style.display="none",t.setAttribute("href",r),t.setAttribute("download",e),document.body.appendChild(t),t.dispatchEvent(new MouseEvent("click")),document.body.removeChild(t),setTimeout(function(){f.revokeObjectURL(r)},100)):navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(u,e)}},{key:"_createTypeFormatter",value:function(n){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};if(!f.EXPORT_TYPES[n])throw new Error('Export format type "'+n+'" is not supported.');return a.default(n,new l.default(this.hot),t)}},{key:"_createBlob",value:function(n){var t=null;return typeof Blob!="undefined"&&(t=new Blob([n.export()],{type:n.options.mimeType+";charset="+n.options.encoding})),t}}]),t}(s.default);h.registerPlugin("exportFile",u);t.default=u},function(n,t,i){"use strict";function o(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var u;t.__esModule=!0;var f=function(){function n(n,t){var r=[],u=!0,f=!1,e=undefined,i,o;try{for(i=n[Symbol.iterator]();!(u=(o=i.next()).done);u=!0)if(r.push(o.value),t&&r.length===t)break}catch(s){f=!0;e=s}finally{try{!u&&i["return"]&&i["return"]()}finally{if(f)throw e;}}return r}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return n(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance");}}(),e=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),s=i(0),h=i(1),r=i(4);u=function(){function n(t){o(this,n);this.hot=t;this.options={}}return e(n,[{key:"setOptions",value:function(n){this.options=n}},{key:"getData",value:function(){var t=this,n=this._getDataRange(),f=n.startRow,e=n.startCol,o=n.endRow,s=n.endCol,i=this.options,u=[];return r.rangeEach(f,o,function(n){var f=[];(i.exportHiddenRows||!t._isHiddenRow(n))&&(r.rangeEach(e,s,function(r){(i.exportHiddenColumns||!t._isHiddenColumn(r))&&f.push(t.hot.getDataAtCell(n,r))}),u.push(f))}),u}},{key:"getRowHeaders",value:function(){var n=this,t=[];if(this.options.rowHeaders){var i=this._getDataRange(),u=i.startRow,f=i.endRow,e=this.hot.getRowHeader();r.rangeEach(u,f,function(i){(n.options.exportHiddenRows||!n._isHiddenRow(i))&&t.push(e[i])})}return t}},{key:"getColumnHeaders",value:function(){var n=this,t=[];if(this.options.columnHeaders){var i=this._getDataRange(),u=i.startCol,f=i.endCol,e=this.hot.getColHeader();r.rangeEach(u,f,function(i){(n.options.exportHiddenColumns||!n._isHiddenColumn(i))&&t.push(e[i])})}return t}},{key:"_getDataRange",value:function(){var e=this.hot.countCols()-1,o=this.hot.countRows()-1,n=f(this.options.range,4),s=n[0],t=s===undefined?0:s,h=n[1],i=h===undefined?0:h,c=n[2],r=c===undefined?o:c,l=n[3],u=l===undefined?e:l;return t=Math.max(t,0),i=Math.max(i,0),r=Math.min(r,o),u=Math.min(u,e),{startRow:t,startCol:i,endRow:r,endCol:u}}},{key:"_isHiddenRow",value:function(n){return this.hot.hasHook("hiddenRow")&&this.hot.runHooks("hiddenRow",n)}},{key:"_isHiddenColumn",value:function(n){return this.hot.hasHook("hiddenColumn")&&this.hot.runHooks("hiddenColumn",n)}}]),n}();t.default=u},function(n,t,i){"use strict";function e(n){return n&&n.__esModule?n:{"default":n}}function o(n,t,i){return t in n?Object.defineProperty(n,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[t]=i,n}function h(n,t,i){return typeof f[n]=="function"?new f[n](t,i):null}var r,u;t.__esModule=!0;t.EXPORT_TYPES=t.TYPE_PDF=t.TYPE_EXCEL=t.TYPE_CSV=undefined;t.default=h;r=i(390);u=e(r);var s=t.TYPE_CSV="csv",c=t.TYPE_EXCEL="excel",l=t.TYPE_PDF="pdf",f=t.EXPORT_TYPES=o({},s,u.default)},function(n,t,i){"use strict";function s(n){return n&&n.__esModule?n:{"default":n}}function h(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function c(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function l(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}t.__esModule=!0;var u=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),r=i(0),f=i(13),e=i(391),o=s(e);var a=String.fromCharCode(13),v=String.fromCharCode(34),y=String.fromCharCode(10),p=function(n){function t(){return h(this,t),c(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return l(t,n),u(t,[{key:"export",value:function(){var u=this,t=this.options,o=this.dataProvider.getData(),i=this.dataProvider.getColumnHeaders(),s=i.length>0,f=this.dataProvider.getRowHeaders(),e=f.length>0,n="﻿";return s&&(i=r.arrayMap(i,function(n){return u._escapeCell(n,!0)}),e&&(n+=t.columnDelimiter),n+=i.join(t.columnDelimiter),n+=t.rowDelimiter),r.arrayEach(o,function(i,r){r>0&&(n+=t.rowDelimiter);e&&(n+=u._escapeCell(f[r])+t.columnDelimiter);n+=i.map(function(n){return u._escapeCell(n)}).join(t.columnDelimiter)}),n}},{key:"_escapeCell",value:function(n){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!1;return n=f.stringify(n),n!==""&&(t||n.indexOf(a)>=0||n.indexOf(v)>=0||n.indexOf(y)>=0||n.indexOf(this.options.columnDelimiter)>=0)&&(n=n.replace(new RegExp('"',"g"),'""'),n='"'+n+'"'),n}}],[{key:"DEFAULT_OPTIONS",get:function(){return{mimeType:"text/csv",fileExtension:"csv",columnDelimiter:",",rowDelimiter:"\r\n"}}}]),t}(o.default);t.default=p},function(n,t,i){"use strict";function o(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var f;t.__esModule=!0;var u=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),s=i(0),r=i(1),h=i(4),e=i(30);f=function(){function n(t,i){o(this,n);this.dataProvider=t;this.options=this._mergeOptions(i);this.dataProvider.setOptions(this.options)}return u(n,null,[{key:"DEFAULT_OPTIONS",get:function(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}}]),u(n,[{key:"_mergeOptions",value:function(t){var i=r.clone(this.constructor.DEFAULT_OPTIONS),u=new Date;return i=r.extend(r.clone(n.DEFAULT_OPTIONS),i),i=r.extend(i,t),i.filename=e.substitute(i.filename,{YYYY:u.getFullYear(),MM:(u.getMonth()+1+"").padStart(2,"0"),DD:(u.getDate()+"").padStart(2,"0")}),i}}]),n}();t.default=f},function(n,t,i){"use strict";function bt(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function u(n){return n&&n.__esModule?n:{"default":n}}function kt(n,t){return Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(t)}}))}function dt(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function gt(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function ni(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var c;t.__esModule=!0;var l=function(){function n(n,t){var r=[],u=!0,f=!1,e=undefined,i,o;try{for(i=n[Symbol.iterator]();!(u=(o=i.next()).done);u=!0)if(r.push(o.value),t&&r.length===t)break}catch(s){f=!0;e=s}finally{try{!u&&i["return"]&&i["return"]()}finally{if(f)throw e;}}return r}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return n(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance");}}(),v=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),e=function y(n,t,i){var r,u,f;return n===null&&(n=Function.prototype),r=Object.getOwnPropertyDescriptor(n,t),r===undefined?(u=Object.getPrototypeOf(n),u===null?undefined:y(u,t,i)):"value"in r?r.value:(f=r.get,f===undefined)?undefined:f.call(i)},p=kt(["The filter conditions have been applied properly, but couldn’t be displayed visually. \n        The overall amount of conditions exceed the capability of the dropdown menu. \n        For more details see the documentation."],["The filter conditions have been applied properly, but couldn’t be displayed visually. \n        The overall amount of conditions exceed the capability of the dropdown menu. \n        For more details see the documentation."]),w=i(7),b=u(w),f=i(0),k=i(34),d=i(4),g=i(9),nt=u(g),o=i(2),tt=i(6),it=i(44),rt=i(3),a=bt(rt),ut=i(393),s=u(ut),ft=i(413),et=u(ft),ot=i(415),st=u(ot),ht=i(418),ct=u(ht),lt=i(227),at=u(lt),vt=i(228),yt=u(vt),pt=i(419),wt=u(pt),h=i(63),r=i(159);i(420);c=function(n){function t(n){dt(this,t);var i=gt(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return i.eventManager=new nt.default(i),i.trimRowsPlugin=null,i.dropdownMenuPlugin=null,i.conditionCollection=null,i.conditionUpdateObserver=null,i.components=new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]]),i.lastSelectedColumn=null,i.hiddenRowsCache=new Map,i.hot.addHook("afterGetColHeader",function(n,t){return i.onAfterGetColHeader(n,t)}),i}return ni(t,n),v(t,[{key:"isEnabled",value:function(){return this.hot.getSettings().filters?!0:!1}},{key:"enablePlugin",value:function(){var n=this,r,u;if(!this.enabled){this.trimRowsPlugin=this.hot.getPlugin("trimRows");this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");var i=function(t){return t.addLocalHook("accept",function(){return n.onActionBarSubmit("accept")}),t.addLocalHook("cancel",function(){return n.onActionBarSubmit("cancel")}),t.addLocalHook("change",function(i){return n.onComponentChange(t,i)}),t},f=function(){return n.hot.getTranslatedPhrase(a.FILTERS_DIVS_FILTER_BY_CONDITION)+":"},o=function(){return n.hot.getTranslatedPhrase(a.FILTERS_DIVS_FILTER_BY_VALUE)+":"};this.components.get("filter_by_condition")||(r=new s.default(this.hot,{id:"filter_by_condition",name:f,addSeparator:!1}),r.addLocalHook("afterClose",function(){return n.onSelectUIClosed()}),this.components.set("filter_by_condition",i(r)));this.components.get("filter_operators")||this.components.set("filter_operators",new et.default(this.hot,{id:"filter_operators",name:"Operators"}));this.components.get("filter_by_condition2")||(u=new s.default(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0}),u.addLocalHook("afterClose",function(){return n.onSelectUIClosed()}),this.components.set("filter_by_condition2",i(u)));this.components.get("filter_by_value")||this.components.set("filter_by_value",i(new st.default(this.hot,{id:"filter_by_value",name:o})));this.components.get("filter_action_bar")||this.components.set("filter_action_bar",i(new ct.default(this.hot,{id:"filter_action_bar",name:"Action bar"})));this.conditionCollection||(this.conditionCollection=new at.default);this.conditionUpdateObserver||(this.conditionUpdateObserver=new wt.default(this.conditionCollection,function(t){return n.getDataMapAtColumn(t)}),this.conditionUpdateObserver.addLocalHook("update",function(t){return n.updateComponents(t)}));this.components.forEach(function(n){n.show()});this.registerEvents();this.addHook("beforeDropdownMenuSetItems",function(t){return n.onBeforeDropdownMenuSetItems(t)});this.addHook("afterDropdownMenuDefaultOptions",function(t){return n.onAfterDropdownMenuDefaultOptions(t)});this.addHook("afterDropdownMenuShow",function(){return n.onAfterDropdownMenuShow()});this.addHook("afterDropdownMenuHide",function(){return n.onAfterDropdownMenuHide()});this.addHook("afterChange",function(t){return n.onAfterChange(t)});this.hot.getSettings().trimRows=!0;this.trimRowsPlugin.enablePlugin();this.hot.getSettings().dropdownMenu&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin());e(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enablePlugin",this).call(this)}}},{key:"registerEvents",value:function(){var n=this;this.eventManager.addEventListener(this.hot.rootElement,"click",function(t){return n.onTableClick(t)})}},{key:"disablePlugin",value:function(){this.enabled&&(this.dropdownMenuPlugin.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach(function(n){n.hide()}),this.conditionCollection.clean(),this.trimRowsPlugin.untrimAll());e(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disablePlugin",this).call(this)}},{key:"addCondition",value:function(n,t,i){var u=arguments.length>3&&arguments[3]!==undefined?arguments[3]:r.OPERATION_AND,f=this.t.toPhysicalColumn(n);this.conditionCollection.addCondition(f,{command:{key:t},args:i},u)}},{key:"removeConditions",value:function(n){var t=this.t.toPhysicalColumn(n);this.conditionCollection.removeConditions(t)}},{key:"clearConditions",value:function(n){if(n===void 0)this.conditionCollection.clean();else{var t=this.t.toPhysicalColumn(n);this.conditionCollection.clearConditions(t)}}},{key:"filter",value:function(){var u=this._createDataFilter(),e=!this.conditionCollection.isEmpty(),n=[],i=this.conditionCollection.exportAllConditions(),o=this.hot.runHooks("beforeFilter",i),t,r;o!==!1&&(e?(t=[],this.trimRowsPlugin.trimmedRows.length=0,n=f.arrayMap(u.filter(),function(n){return n.meta.visualRow}),r=h.createArrayAssertion(n),d.rangeEach(this.hot.countSourceRows()-1,function(n){r(n)||t.push(n)}),this.trimRowsPlugin.trimRows(t),n.length||this.hot.deselectCell()):this.trimRowsPlugin.untrimAll());this.hot.view.wt.wtOverlays.adjustElementsSize(!0);this.hot.render();this.clearColumnSelection();this.hot.runHooks("afterFilter",i)}},{key:"getSelectedColumn",value:function(){return this.lastSelectedColumn}},{key:"clearColumnSelection",value:function(){var r=this.hot.getSelectedLast()||[],n=l(r,2),t=n[0],i=n[1];t!==void 0&&i!==void 0&&this.hot.selectCell(t,i)}},{key:"getDataMapAtColumn",value:function(n){var r=this,t=this.t.toVisualColumn(n),i=[];return f.arrayEach(this.hot.getSourceDataAtCol(t),function(n,u){var f=r.hot.getCellMeta(u,t),e=f.row,o=f.col,s=f.visualCol,c=f.visualRow,l=f.type,a=f.instance,v=f.dateFormat;i.push({meta:{row:e,col:o,visualCol:s,visualRow:c,type:l,instance:a,dateFormat:v},value:h.toEmptyString(n)})}),i}},{key:"onAfterChange",value:function(n){var t=this;n&&f.arrayEach(n,function(n){var i=l(n,2),r=i[1],u=t.hot.propToCol(r);t.updateValueComponentCondition(u)})}},{key:"updateValueComponentCondition",value:function(n){var t=this.hot.getDataAtCol(n),i=h.unifyColumnValues(t);this.conditionUpdateObserver.updateStatesAtColumn(n,i)}},{key:"onAfterDropdownMenuShow",value:function(){var n=this.getSelectedColumn(),t=n&&n.physicalIndex;this.components.forEach(function(n){!n.isHidden()&&n.setState&&n.restoreState(t)})}},{key:"onAfterDropdownMenuHide",value:function(){this.components.get("filter_by_condition").getSelectElement().closeOptions();this.components.get("filter_by_condition2").getSelectElement().closeOptions()}},{key:"onBeforeDropdownMenuSetItems",value:function(n){var t=f.arrayMap(n,function(n){return n.key});this.components.forEach(function(n){n[t.indexOf(n.getMenuItemDescriptor().key)===-1?"hide":"show"]()});this.initHiddenRowsCache()}},{key:"onAfterDropdownMenuDefaultOptions",value:function(n){n.items.push({name:it.SEPARATOR});this.components.forEach(function(t){n.items.push(t.getMenuItemDescriptor())})}},{key:"getOperationBasedOnArguments",value:function(n,t,i,u){var f=n;return f===r.OPERATION_OR&&t.command.key!==r.CONDITION_NONE&&i.command.key!==r.CONDITION_NONE&&u.command.key!==r.CONDITION_NONE?f=r.OPERATION_OR_THEN_VARIABLE:u.command.key!==r.CONDITION_NONE&&(t.command.key===r.CONDITION_NONE||i.command.key===r.CONDITION_NONE)&&(f=r.OPERATION_AND),f}},{key:"onActionBarSubmit",value:function(n){if(n==="accept"){var o=this.getSelectedColumn(),t=o&&o.physicalIndex,i=this.components.get("filter_by_condition").getState(),u=this.components.get("filter_by_condition2").getState(),f=this.components.get("filter_by_value").getState(),e=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),i,u,f);this.conditionUpdateObserver.groupChanges();this.conditionCollection.clearConditions(t);i.command.key===r.CONDITION_NONE&&u.command.key===r.CONDITION_NONE&&f.command.key===r.CONDITION_NONE?this.conditionCollection.removeConditions(t):(i.command.key!==r.CONDITION_NONE&&(this.conditionCollection.addCondition(t,i,e),u.command.key!==r.CONDITION_NONE&&this.conditionCollection.addCondition(t,u,e)),f.command.key!==r.CONDITION_NONE&&this.conditionCollection.addCondition(t,f,e));this.conditionUpdateObserver.flush();this.components.get("filter_operators").saveState(t);this.components.get("filter_by_value").saveState(t);this.saveHiddenRowsCache(t);this.trimRowsPlugin.trimmedRows.length=0;this.filter()}this.dropdownMenuPlugin.close()}},{key:"onComponentChange",value:function(n,t){n===this.components.get("filter_by_condition")&&(t.showOperators?this.showComponents(this.components.get("filter_by_condition2"),this.components.get("filter_operators")):this.hideComponents(this.components.get("filter_by_condition2"),this.components.get("filter_operators")));n.constructor!==s.default||t.inputsCount||this.setListeningDropdownMenu()}},{key:"onSelectUIClosed",value:function(){this.setListeningDropdownMenu()}},{key:"setListeningDropdownMenu",value:function(){this.dropdownMenuPlugin.setListening()}},{key:"onAfterGetColHeader",value:function(n,t){var i=this.t.toPhysicalColumn(n);this.enabled&&this.conditionCollection.hasConditions(i)?o.addClass(t,"htFiltersActive"):o.removeClass(t,"htFiltersActive")}},{key:"onTableClick",value:function(n){var i=o.closest(n.target,"TH"),t,r;i&&(t=this.hot.getCoords(i).col,r=this.t.toPhysicalColumn(t),this.lastSelectedColumn={visualIndex:t,physicalIndex:r})}},{key:"destroy",value:function(){this.enabled&&(this.components.forEach(function(n){n.destroy()}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hiddenRowsCache.clear(),this.trimRowsPlugin.disablePlugin());e(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}},{key:"_createDataFilter",value:function(){var n=this,t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.conditionCollection;return new yt.default(t,function(t){return n.getDataMapAtColumn(t)})}},{key:"updateComponents",value:function(n){if(this.dropdownMenuPlugin.enabled){var u=n.editedConditionStack.conditions,t=n.editedConditionStack.column,f=u.filter(function(n){return n.name===r.CONDITION_BY_VALUE}),i=u.filter(function(n){return n.name!==r.CONDITION_BY_VALUE}),e=this.conditionCollection.columnTypes[t];f.length===2||i.length===3?console.warn(k.toSingleLine(p)):(i.length>0&&this.showComponentForParticularColumn(this.components.get("filter_operators"),t),this.components.get("filter_by_condition").updateState(i[0],t),this.components.get("filter_by_condition2").updateState(i[1],t),this.components.get("filter_by_value").updateState(n),this.components.get("filter_operators").updateState(e,t))}}},{key:"showComponentForParticularColumn",value:function(n,t){if(this.hiddenRowsCache.has(t)){var i=this.getIndexesOfComponents(n);this.removeIndexesFromHiddenRowsCache(t,i)}else this.hiddenRowsCache.set(t,[])}},{key:"removeIndexesFromHiddenRowsCache",value:function(n,t){var i=this.hiddenRowsCache.get(n);f.arrayEach(t,function(n){i.includes(n)&&i.splice(i.indexOf(n),1)})}},{key:"hideComponentForParticularColumn",value:function(n,t){if(this.hiddenRowsCache.has(t)){var i=this.getIndexesOfComponents(n);this.addIndexesToHiddenRowsCache(t,i)}else this.hiddenRowsCache.set(t,this.getIndexesOfComponents(n))}},{key:"addIndexesToHiddenRowsCache",value:function(n,t){var i=this.hiddenRowsCache.get(n);f.arrayEach(t,function(n){i.indexOf(n)===-1&&i.push(n)})}},{key:"getIndexesOfComponents",value:function(){for(var u=this.dropdownMenuPlugin.menu,t=[],i=arguments.length,r=Array(i),n=0;n<i;n++)r[n]=arguments[n];return f.arrayEach(r,function(n){f.arrayEach(u.menuItems,function(i,r){i.key===n.getMenuItemDescriptor().key&&t.push(r)})}),t}},{key:"changeComponentsVisibility",value:function(){for(var i,e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:!0,o=this.dropdownMenuPlugin.menu,r=o.hotMenu,u=r.getPlugin("hiddenRows"),t=arguments.length,f=Array(t>1?t-1:0),n=1;n<t;n++)f[n-1]=arguments[n];i=this.getIndexesOfComponents.apply(this,f);e?u.showRows(i):u.hideRows(i);r.render()}},{key:"initHiddenRowsCache",value:function(){var n=this;this.dropdownMenuPlugin.menu.addLocalHook("afterOpen",function(){var t=n.lastSelectedColumn.physicalIndex;n.hiddenRowsCache.has(t)||n.hiddenRowsCache.set(t,n.getIndexesOfComponents(n.components.get("filter_operators"),n.components.get("filter_by_condition2")));n.dropdownMenuPlugin.menu.hotMenu.updateSettings({hiddenRows:{rows:n.hiddenRowsCache.get(t)}})})}},{key:"saveHiddenRowsCache",value:function(n){this.hiddenRowsCache.set(n,this.dropdownMenuPlugin.menu.hotMenu.getPlugin("hiddenRows").hiddenRows)}},{key:"hideComponents",value:function(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];this.changeComponentsVisibility.apply(this,[!1].concat(i))}},{key:"showComponents",value:function(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];this.changeComponentsVisibility.apply(this,[!0].concat(i))}}]),t}(b.default);tt.registerPlugin("filters",c);t.default=c},function(n,t,i){"use strict";function u(n){return n&&n.__esModule?n:{"default":n}}function rt(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function ut(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function ft(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function et(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var v;t.__esModule=!0;var y=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),p=function w(n,t,i){var r,u,f;return n===null&&(n=Function.prototype),r=Object.getOwnPropertyDescriptor(n,t),r===undefined?(u=Object.getPrototypeOf(n),u===null?undefined:w(u,t,i)):"value"in r?r.value:(f=r.get,f===undefined)?undefined:f.call(i)},f=i(2),c=i(11),r=i(0),l=i(18),b=i(1),k=i(3),e=rt(k),d=i(83),g=u(d),o=i(159),nt=u(o),tt=i(161),s=u(tt),it=i(412),a=u(it),h=i(10);v=function(n){function t(n,i){ut(this,t);var r=ft(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return r.id=i.id,r.name=i.name,r.addSeparator=i.addSeparator,r.elements.push(new a.default(r.hot)),r.elements.push(new s.default(r.hot,{placeholder:e.FILTERS_BUTTONS_PLACEHOLDER_VALUE})),r.elements.push(new s.default(r.hot,{placeholder:e.FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE})),r.registerHooks(),r}return et(t,n),y(t,[{key:"registerHooks",value:function(){var n=this;this.getSelectElement().addLocalHook("select",function(t){return n.onConditionSelect(t)});this.getSelectElement().addLocalHook("afterClose",function(){return n.onSelectUIClosed()});r.arrayEach(this.getInputElements(),function(t){t.addLocalHook("keydown",function(t){return n.onInputKeyDown(t)})})}},{key:"setState",value:function(n){var i=this,t;this.reset();n&&(t=b.clone(n.command),t.name.startsWith(e.FILTERS_CONDITIONS_NAMESPACE)&&(t.name=this.hot.getTranslatedPhrase(t.name)),this.getSelectElement().setValue(t),r.arrayEach(n.args,function(n,r){if(r>t.inputsCount-1)return!1;var u=i.getInputElement(r);u.setValue(n);u[t.inputsCount>r?"show":"hide"]();r||setTimeout(function(){return u.focus()},10)}))}},{key:"getState",value:function(){var n=this.getSelectElement().getValue()||h.getConditionDescriptor(o.CONDITION_NONE),t=[];return r.arrayEach(this.getInputElements(),function(i,r){n.inputsCount>r&&t.push(i.getValue())}),{command:n,args:t}}},{key:"updateState",value:function(n,t){var i=n?h.getConditionDescriptor(n.name):h.getConditionDescriptor(o.CONDITION_NONE);this.setCachedState(t,{command:i,args:n?n.args:[]});n||r.arrayEach(this.getInputElements(),function(n){return n.setValue(null)})}},{key:"getSelectElement",value:function(){return this.elements.filter(function(n){return n instanceof a.default})[0]}},{key:"getInputElement",value:function(){var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;return this.getInputElements()[n]}},{key:"getInputElements",value:function(){return this.elements.filter(function(n){return n instanceof s.default})}},{key:"getMenuItemDescriptor",value:function(){var n=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return n.isHidden()},renderer:function(t,i,u,e,o,s){f.addClass(i.parentNode,"htFiltersMenuCondition");n.addSeparator&&f.addClass(i.parentNode,"border");var h=document.createElement("div");return f.addClass(h,"htFiltersMenuLabel"),h.textContent=s,i.appendChild(h),r.arrayEach(n.elements,function(n){return i.appendChild(n.element)}),i}}}},{key:"reset",value:function(){var n=this.hot.getPlugin("filters").getSelectedColumn(),u=n&&n.visualIndex,f=this.hot.getDataType.apply(this.hot,this.hot.getSelectedLast()||[0,u]),i=nt.default(f);r.arrayEach(this.getInputElements(),function(n){return n.hide()});this.getSelectElement().setItems(i);p(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"reset",this).call(this);this.getSelectElement().setValue(i[0])}},{key:"onConditionSelect",value:function(n){r.arrayEach(this.getInputElements(),function(t,i){t[n.inputsCount>i?"show":"hide"]();i||setTimeout(function(){return t.focus()},10)});this.runLocalHooks("change",n)}},{key:"onSelectUIClosed",value:function(){this.runLocalHooks("afterClose")}},{key:"onInputKeyDown",value:function(n){l.isKey(n.keyCode,"ENTER")?(this.runLocalHooks("accept"),c.stopImmediatePropagation(n)):l.isKey(n.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),c.stopImmediatePropagation(n))}}]),t}(g.default);t.default=v},function(n,t,i){"use strict";function u(n,t,i){return t in n?Object.defineProperty(n,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[t]=i,n}var r,l,s;t.__esModule=!0;l=i(0);s=i(1);var h="state_",f="_states",e=function(n,t){return n[f][h+t]},o=function(n,t,i){n[f][h+t]=i},c=(r={},u(r,f,{}),u(r,"getCachedState",function(n){return e(this,n)}),u(r,"setCachedState",function(n,t){o(this,n,t)}),u(r,"saveState",function(n){o(this,n,this.getState())}),u(r,"restoreState",function(n){this.setState(e(this,n))}),u(r,"hasSavedState",function(n){return e(this,n)!==void 0}),u(r,"clearState",function(n){o(this,n)}),u(r,"clearStates",function(){this[f]={}}),r);s.defineGetter(c,"MIXIN_NAME","stateSaver",{writable:!1,enumerable:!1});t.default=c},function(n,t,i){"use strict";function s(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function u(){return!0}var r;t.__esModule=!0;t.CONDITION_NAME=undefined;t.condition=u;var f=i(3),e=s(f),o=i(10);r=t.CONDITION_NAME="none";o.registerCondition(r,u,{name:e.FILTERS_CONDITIONS_NONE,inputsCount:0,showOperators:!1})},function(n,t,i){"use strict";function h(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function f(n,t){return!r.getCondition(s.CONDITION_NAME,t)(n)}var u;t.__esModule=!0;t.CONDITION_NAME=undefined;t.condition=f;var e=i(3),o=h(e),r=i(10),s=i(219);u=t.CONDITION_NAME="not_empty";r.registerCondition(u,f,{name:o.FILTERS_CONDITIONS_NOT_EMPTY,inputsCount:0,showOperators:!0})},function(n,t,i){"use strict";function h(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function f(n,t){return!r.getCondition(s.CONDITION_NAME,t)(n)}var u;t.__esModule=!0;t.CONDITION_NAME=undefined;t.condition=f;var e=i(3),o=h(e),r=i(10),s=i(220);u=t.CONDITION_NAME="neq";r.registerCondition(u,f,{name:o.FILTERS_CONDITIONS_NOT_EQUAL,inputsCount:1,showOperators:!0})},function(n,t,i){"use strict";function h(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function f(n){var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:inputValues,u=r(i,1),t=u[0];return n.meta.type==="numeric"&&(t=parseFloat(t,10)),n.value>t}var r,u;t.__esModule=!0;t.CONDITION_NAME=undefined;r=function(){function n(n,t){var r=[],u=!0,f=!1,e=undefined,i,o;try{for(i=n[Symbol.iterator]();!(u=(o=i.next()).done);u=!0)if(r.push(o.value),t&&r.length===t)break}catch(s){f=!0;e=s}finally{try{!u&&i["return"]&&i["return"]()}finally{if(f)throw e;}}return r}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return n(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance");}}();t.condition=f;var e=i(3),o=h(e),s=i(10);u=t.CONDITION_NAME="gt";s.registerCondition(u,f,{name:o.FILTERS_CONDITIONS_GREATER_THAN,inputsCount:1,showOperators:!0})},function(n,t,i){"use strict";function h(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function f(n){var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:inputValues,u=r(i,1),t=u[0];return n.meta.type==="numeric"&&(t=parseFloat(t,10)),n.value>=t}var r,u;t.__esModule=!0;t.CONDITION_NAME=undefined;r=function(){function n(n,t){var r=[],u=!0,f=!1,e=undefined,i,o;try{for(i=n[Symbol.iterator]();!(u=(o=i.next()).done);u=!0)if(r.push(o.value),t&&r.length===t)break}catch(s){f=!0;e=s}finally{try{!u&&i["return"]&&i["return"]()}finally{if(f)throw e;}}return r}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return n(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance");}}();t.condition=f;var e=i(3),o=h(e),s=i(10);u=t.CONDITION_NAME="gte";s.registerCondition(u,f,{name:o.FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL,inputsCount:1,showOperators:!0})},function(n,t,i){"use strict";function h(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function f(n){var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:inputValues,u=r(i,1),t=u[0];return n.meta.type==="numeric"&&(t=parseFloat(t,10)),n.value<t}var r,u;t.__esModule=!0;t.CONDITION_NAME=undefined;r=function(){function n(n,t){var r=[],u=!0,f=!1,e=undefined,i,o;try{for(i=n[Symbol.iterator]();!(u=(o=i.next()).done);u=!0)if(r.push(o.value),t&&r.length===t)break}catch(s){f=!0;e=s}finally{try{!u&&i["return"]&&i["return"]()}finally{if(f)throw e;}}return r}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return n(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance");}}();t.condition=f;var e=i(3),o=h(e),s=i(10);u=t.CONDITION_NAME="lt";s.registerCondition(u,f,{name:o.FILTERS_CONDITIONS_LESS_THAN,inputsCount:1,showOperators:!0})},function(n,t,i){"use strict";function h(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function f(n){var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:inputValues,u=r(i,1),t=u[0];return n.meta.type==="numeric"&&(t=parseFloat(t,10)),n.value<=t}var r,u;t.__esModule=!0;t.CONDITION_NAME=undefined;r=function(){function n(n,t){var r=[],u=!0,f=!1,e=undefined,i,o;try{for(i=n[Symbol.iterator]();!(u=(o=i.next()).done);u=!0)if(r.push(o.value),t&&r.length===t)break}catch(s){f=!0;e=s}finally{try{!u&&i["return"]&&i["return"]()}finally{if(f)throw e;}}return r}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return n(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance");}}();t.condition=f;var e=i(3),o=h(e),s=i(10);u=t.CONDITION_NAME="lte";s.registerCondition(u,f,{name:o.FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL,inputsCount:1,showOperators:!0})},function(n,t,i){"use strict";function h(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function f(n,t){return!r.getCondition(s.CONDITION_NAME,t)(n)}var u;t.__esModule=!0;t.CONDITION_NAME=undefined;t.condition=f;var e=i(3),o=h(e),r=i(10),s=i(221);u=t.CONDITION_NAME="not_between";r.registerCondition(u,f,{name:o.FILTERS_CONDITIONS_NOT_BETWEEN,inputsCount:2,showOperators:!0})},function(n,t,i){"use strict";function c(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function e(n){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:inputValues,i=r(t,1),f=i[0];return u.stringify(n.value).toLowerCase().startsWith(u.stringify(f))}var r,f;t.__esModule=!0;t.CONDITION_NAME=undefined;r=function(){function n(n,t){var r=[],u=!0,f=!1,e=undefined,i,o;try{for(i=n[Symbol.iterator]();!(u=(o=i.next()).done);u=!0)if(r.push(o.value),t&&r.length===t)break}catch(s){f=!0;e=s}finally{try{!u&&i["return"]&&i["return"]()}finally{if(f)throw e;}}return r}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return n(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance");}}();t.condition=e;var o=i(3),s=c(o),u=i(13),h=i(10);f=t.CONDITION_NAME="begins_with";h.registerCondition(f,e,{name:s.FILTERS_CONDITIONS_BEGINS_WITH,inputsCount:1,showOperators:!0})},function(n,t,i){"use strict";function c(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function e(n){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:inputValues,i=r(t,1),f=i[0];return u.stringify(n.value).toLowerCase().endsWith(u.stringify(f))}var r,f;t.__esModule=!0;t.CONDITION_NAME=undefined;r=function(){function n(n,t){var r=[],u=!0,f=!1,e=undefined,i,o;try{for(i=n[Symbol.iterator]();!(u=(o=i.next()).done);u=!0)if(r.push(o.value),t&&r.length===t)break}catch(s){f=!0;e=s}finally{try{!u&&i["return"]&&i["return"]()}finally{if(f)throw e;}}return r}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return n(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance");}}();t.condition=e;var o=i(3),s=c(o),u=i(13),h=i(10);f=t.CONDITION_NAME="ends_with";h.registerCondition(f,e,{name:s.FILTERS_CONDITIONS_ENDS_WITH,inputsCount:1,showOperators:!0})},function(n,t,i){"use strict";function h(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function f(n,t){return!r.getCondition(s.CONDITION_NAME,t)(n)}var u;t.__esModule=!0;t.CONDITION_NAME=undefined;t.condition=f;var e=i(3),o=h(e),r=i(10),s=i(224);u=t.CONDITION_NAME="not_contains";r.registerCondition(u,f,{name:o.FILTERS_CONDITIONS_NOT_CONTAIN,inputsCount:1,showOperators:!0})},function(n,t,i){"use strict";function c(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function l(n){return n&&n.__esModule?n:{"default":n}}function f(n){var t=r.default(n.value,n.meta.dateFormat);return t.isValid()?t.isSame(r.default().subtract(-1,"days").startOf("day"),"d"):!1}var u;t.__esModule=!0;t.CONDITION_NAME=undefined;t.condition=f;var e=i(31),r=l(e),o=i(3),s=c(o),h=i(10);u=t.CONDITION_NAME="date_tomorrow";h.registerCondition(u,f,{name:s.FILTERS_CONDITIONS_TOMORROW,inputsCount:0})},function(n,t,i){"use strict";function c(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function l(n){return n&&n.__esModule?n:{"default":n}}function f(n){var t=r.default(n.value,n.meta.dateFormat);return t.isValid()?t.isSame(r.default().startOf("day"),"d"):!1}var u;t.__esModule=!0;t.CONDITION_NAME=undefined;t.condition=f;var e=i(31),r=l(e),o=i(3),s=c(o),h=i(10);u=t.CONDITION_NAME="date_today";h.registerCondition(u,f,{name:s.FILTERS_CONDITIONS_TODAY,inputsCount:0})},function(n,t,i){"use strict";function c(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function l(n){return n&&n.__esModule?n:{"default":n}}function f(n){var t=r.default(n.value,n.meta.dateFormat);return t.isValid()?t.isSame(r.default().subtract(1,"days").startOf("day"),"d"):!1}var u;t.__esModule=!0;t.CONDITION_NAME=undefined;t.condition=f;var e=i(31),r=l(e),o=i(3),s=c(o),h=i(10);u=t.CONDITION_NAME="date_yesterday";h.registerCondition(u,f,{name:s.FILTERS_CONDITIONS_YESTERDAY,inputsCount:0})},function(n,t,i){"use strict";function h(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function f(n){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:inputValues,i=r(t,1),u=i[0];return u(n.value)}var r,u;t.__esModule=!0;t.CONDITION_NAME=undefined;r=function(){function n(n,t){var r=[],u=!0,f=!1,e=undefined,i,o;try{for(i=n[Symbol.iterator]();!(u=(o=i.next()).done);u=!0)if(r.push(o.value),t&&r.length===t)break}catch(s){f=!0;e=s}finally{try{!u&&i["return"]&&i["return"]()}finally{if(f)throw e;}}return r}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return n(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance");}}();t.condition=f;var e=i(3),c=h(e),o=i(10),s=i(63);u=t.CONDITION_NAME="by_value";o.registerCondition(u,f,{name:"By value",inputsCount:0,inputValuesDecorator:function(){var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:inputValues,t=r(n,1),i=t[0];return[s.createArrayAssertion(i)]},showOperators:!1})},function(n,t,i){"use strict";function o(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function u(){return!0}var r;t.__esModule=!0;t.CONDITION_NAME=undefined;t.condition=u;var f=i(3),s=o(f),e=i(10);r=t.CONDITION_NAME="true";e.registerCondition(r,u,{name:"True"})},function(n,t,i){"use strict";function o(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function u(){return!1}var r;t.__esModule=!0;t.CONDITION_NAME=undefined;t.condition=u;var f=i(3),s=o(f),e=i(10);r=t.CONDITION_NAME="false";e.registerCondition(r,u,{name:"False"})},function(n,t,i){"use strict";function k(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function c(n){return n&&n.__esModule?n:{"default":n}}function d(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function g(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function nt(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var r,l;t.__esModule=!0;var u=function a(n,t,i){var r,u,f;return n===null&&(n=Function.prototype),r=Object.getOwnPropertyDescriptor(n,t),r===undefined?(u=Object.getPrototypeOf(n),u===null?undefined:a(u,t,i)):"value"in r?r.value:(f=r.get,f===undefined)?undefined:f.call(i)},e=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),v=i(157),y=c(v),o=i(1),s=i(0),p=i(3),h=k(p),w=i(44),b=i(65),f=c(b);r=new WeakMap;l=function(n){function t(n,i){d(this,t);var u=g(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n,o.extend(t.DEFAULTS,i)));return r.set(u,{}),u.menu=null,u.items=[],u.registerHooks(),u}return nt(t,n),e(t,null,[{key:"DEFAULTS",get:function(){return o.clone({className:"htUISelect",wrapIt:!1})}}]),e(t,[{key:"registerHooks",value:function(){var n=this;this.addLocalHook("click",function(t){return n.onClick(t)})}},{key:"setItems",value:function(n){this.items=this.translateNames(n);this.menu&&this.menu.setMenuItems(this.items)}},{key:"translateNames",value:function(n){var t=this;return s.arrayEach(n,function(n){typeof n.name=="string"&&n.name.startsWith(h.FILTERS_CONDITIONS_NAMESPACE)&&(n.name=t.menu.hot.getTranslatedPhrase(n.name))}),n}},{key:"build",value:function(){var n=this;u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"build",this).call(this);this.menu=new y.default(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0});this.menu.setMenuItems(this.items);var i=new f.default(this.hot,{className:"htUISelectCaption"}),o=new f.default(this.hot,{className:"htUISelectDropdown"}),e=r.get(this);e.caption=i;e.captionElement=i.element;e.dropdown=o;s.arrayEach([i,o],function(t){return n._element.appendChild(t.element)});this.menu.addLocalHook("select",function(t){return n.onMenuSelect(t)});this.menu.addLocalHook("afterClose",function(){return n.onMenuClosed()});this.update()}},{key:"update",value:function(){if(this.isBuilt()){var n=void 0;n=this.options.value?this.options.value.name:this.menu.hot.getTranslatedPhrase(h.FILTERS_CONDITIONS_NONE);r.get(this).captionElement.textContent=n;u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"update",this).call(this)}}},{key:"openOptions",value:function(){var n=this.element.getBoundingClientRect();this.menu&&(this.menu.open(),this.menu.setPosition({left:n.left-5,top:n.top,width:n.width,height:n.height}))}},{key:"closeOptions",value:function(){this.menu&&this.menu.close()}},{key:"onMenuSelect",value:function(n){n.name!==w.SEPARATOR&&(this.options.value=n,this.closeOptions(),this.update(),this.runLocalHooks("select",this.options.value))}},{key:"onMenuClosed",value:function(){this.runLocalHooks("afterClose")}},{key:"onClick",value:function(){this.openOptions()}},{key:"destroy",value:function(){this.menu&&(this.menu.destroy(),this.menu=null);var n=r.get(this),i=n.caption,f=n.dropdown;i&&i.destroy();f&&f.destroy();u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}}]),t}(f.default);t.default=l},function(n,t,i){"use strict";function s(n){return n&&n.__esModule?n:{"default":n}}function d(n,t){return Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(t)}}))}function g(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function nt(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function tt(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var f,h;t.__esModule=!0;var c=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),l=d(["Radio button with index "," doesn't exist."],["Radio button with index "," doesn't exist."]),a=i(2),r=i(0),v=i(34),y=i(83),p=s(y),w=i(64),u=i(160),e=i(225),b=i(226),k=i(414),o=s(k);f=0;h=function(n){function t(n,i){g(this,t);var r=nt(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return r.id=i.id,r.name=i.name,r.buildOperatorsElement(),r}return tt(t,n),c(t,[{key:"getMenuItemDescriptor",value:function(){var n=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return n.isHidden()},renderer:function(t,i){return a.addClass(i.parentNode,"htFiltersMenuOperators"),r.arrayEach(n.elements,function(n){return i.appendChild(n.element)}),i}}}},{key:"buildOperatorsElement",value:function(){var n=this,t=[u.OPERATION_ID,e.OPERATION_ID];r.arrayEach(t,function(i){var r=new o.default(n.hot,{name:"operator",label:{htmlFor:i,textContent:w.getOperationName(i)},value:i,checked:i===t[f],id:i});r.addLocalHook("change",function(t){return n.onRadioInputChange(t)});n.elements.push(r)})}},{key:"setChecked",value:function(n){if(this.elements.length<n)throw Error(v.toSingleLine(l,n));r.arrayEach(this.elements,function(t,i){t.setChecked(i===n)})}},{key:"getActiveOperationId",value:function(){var n=this.elements.find(function(n){return n instanceof o.default&&n.isChecked()});return n?n.getValue():u.OPERATION_ID}},{key:"getState",value:function(){return this.getActiveOperationId()}},{key:"setState",value:function(n){this.reset();n&&this.getActiveOperationId()!==n&&r.arrayEach(this.elements,function(t){t.setChecked(t.getValue()===n)})}},{key:"updateState",value:function(){var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:u.OPERATION_ID,t=arguments[1];n===b.OPERATION_ID&&(n=e.OPERATION_ID);this.setCachedState(t,n)}},{key:"reset",value:function(){this.setChecked(f)}},{key:"onRadioInputChange",value:function(n){this.setState(n.realTarget.value)}}]),t}(p.default);t.default=h},function(n,t,i){"use strict";function l(n){return n&&n.__esModule?n:{"default":n}}function a(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function v(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function y(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var r,e;t.__esModule=!0;var o=function s(n,t,i){var r,u,f;return n===null&&(n=Function.prototype),r=Object.getOwnPropertyDescriptor(n,t),r===undefined?(u=Object.getPrototypeOf(n),u===null?undefined:s(u,t,i)):"value"in r?r.value:(f=r.get,f===undefined)?undefined:f.call(i)},u=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),f=i(1),h=i(65),c=l(h);r=new WeakMap;e=function(n){function t(n,i){a(this,t);var u=v(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n,f.extend(t.DEFAULTS,i)));return r.set(u,{}),u}return y(t,n),u(t,null,[{key:"DEFAULTS",get:function(){return f.clone({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}}]),u(t,[{key:"build",value:function(){var i,n;o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"build",this).call(this);i=r.get(this);i.input=this._element.firstChild;n=document.createElement("label");n.textContent=this.options.label.textContent;n.htmlFor=this.options.label.htmlFor;i.label=n;this._element.appendChild(n);this.update()}},{key:"update",value:function(){if(this.isBuilt()){var n=r.get(this);n.input.checked=this.options.checked;n.label.textContent=this.hot.getTranslatedPhrase(this.options.label.textContent)}}},{key:"isChecked",value:function(){return this.options.checked}},{key:"setChecked",value:function(){var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:!0;this.options.checked=n;this.update()}},{key:"focus",value:function(){this.isBuilt()&&r.get(this).input.focus()}}]),t}(c.default);t.default=e},function(n,t,i){"use strict";function c(n){return n&&n.__esModule?n:{"default":n}}function tt(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function it(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function rt(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function ut(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var l;t.__esModule=!0;var a=function(){function n(n,t){var r=[],u=!0,f=!1,e=undefined,i,o;try{for(i=n[Symbol.iterator]();!(u=(o=i.next()).done);u=!0)if(r.push(o.value),t&&r.length===t)break}catch(s){f=!0;e=s}finally{try{!u&&i["return"]&&i["return"]()}finally{if(f)throw e;}}return r}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return n(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance");}}(),v=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),y=function p(n,t,i){var r,u,f;return n===null&&(n=Function.prototype),r=Object.getOwnPropertyDescriptor(n,t),r===undefined?(u=Object.getPrototypeOf(n),u===null?undefined:p(u,t,i)):"value"in r?r.value:(f=r.get,f===undefined)?undefined:f.call(i)},e=i(2),w=i(11),f=i(0),b=i(18),k=i(3),o=tt(k),u=i(63),d=i(83),g=c(d),nt=i(416),s=c(nt),r=i(159),h=i(10);l=function(n){function t(n,i){it(this,t);var r=rt(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return r.id=i.id,r.name=i.name,r.elements.push(new s.default(r.hot)),r.registerHooks(),r}return ut(t,n),v(t,[{key:"registerHooks",value:function(){var n=this;this.getMultipleSelectElement().addLocalHook("keydown",function(t){return n.onInputKeyDown(t)})}},{key:"setState",value:function(n){if(this.reset(),n&&n.command.key===r.CONDITION_BY_VALUE){var t=this.getMultipleSelectElement();t.setItems(n.itemsSnapshot);t.setValue(n.args[0])}}},{key:"getState",value:function(){var n=this.getMultipleSelectElement(),t=n.getItems();return{command:{key:n.isSelectedAllValues()||!t.length?r.CONDITION_NONE:r.CONDITION_BY_VALUE},args:[n.getValue()],itemsSnapshot:t}}},{key:"updateState",value:function(n){var t=this,i=function(n,i,e,s,c){var b=f.arrayFilter(i,function(n){return n.name===r.CONDITION_BY_VALUE}),k=a(b,1),y=k[0],l={},d=t.hot.getTranslatedPhrase(o.FILTERS_VALUES_BLANK_CELLS),v,p,w;y?(v=f.arrayMap(s(n,c),function(n){return n.value}),v=u.unifyColumnValues(v),e&&(y.args[0]=e),p=[],w=u.intersectValues(v,y.args[0],d,function(n){n.checked&&p.push(n.value)}),l.args=[p],l.command=h.getConditionDescriptor(r.CONDITION_BY_VALUE),l.itemsSnapshot=w):(l.args=[],l.command=h.getConditionDescriptor(r.CONDITION_NONE));t.setCachedState(n,l)};i(n.editedConditionStack.column,n.editedConditionStack.conditions,n.conditionArgsChange,n.filteredRowsFactory);n.dependentConditionStacks.length&&i(n.dependentConditionStacks[0].column,n.dependentConditionStacks[0].conditions,n.conditionArgsChange,n.filteredRowsFactory,n.editedConditionStack)}},{key:"getMultipleSelectElement",value:function(){return this.elements.filter(function(n){return n instanceof s.default})[0]}},{key:"getMenuItemDescriptor",value:function(){var n=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return n.isHidden()},renderer:function(t,i,r,u,o,s){e.addClass(i.parentNode,"htFiltersMenuValue");var h=document.createElement("div");return e.addClass(h,"htFiltersMenuLabel"),h.textContent=s,i.appendChild(h),f.arrayEach(n.elements,function(n){return i.appendChild(n.element)}),i}}}},{key:"reset",value:function(){var i=this.hot.getTranslatedPhrase(o.FILTERS_VALUES_BLANK_CELLS),n=u.unifyColumnValues(this._getColumnVisibleValues()),r=u.intersectValues(n,n,i);this.getMultipleSelectElement().setItems(r);y(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"reset",this).call(this);this.getMultipleSelectElement().setValue(n)}},{key:"onInputKeyDown",value:function(n){b.isKey(n.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),w.stopImmediatePropagation(n))}},{key:"_getColumnVisibleValues",value:function(){var n=this.hot.getPlugin("filters").getSelectedColumn(),t=n&&n.visualIndex;return f.arrayMap(this.hot.getDataAtCol(t),function(n){return u.toEmptyString(n)})}}]),t}(g.default);t.default=l},function(n,t,i){"use strict";function e(n){return n&&n.__esModule?n:{"default":n}}function ut(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function y(n){if(Array.isArray(n)){for(var t=0,i=Array(n.length);t<n.length;t++)i[t]=n[t];return i}return Array.from(n)}function ft(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function et(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function ot(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}function st(n,t){var i=rt.createArrayAssertion(t);return r.arrayMap(n,function(n){return n.checked=i(n.value),n})}function ht(n){var t=[];return r.arrayEach(n,function(n){n.checked&&t.push(n.value)}),t}var p,w;t.__esModule=!0;var u=function b(n,t,i){var r,u,f;return n===null&&(n=Function.prototype),r=Object.getOwnPropertyDescriptor(n,t),r===undefined?(u=Object.getPrototypeOf(n),u===null?undefined:b(u,t,i)):"value"in r?r.value:(f=r.get,f===undefined)?undefined:f.call(i)},o=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),k=i(2),s=i(1),r=i(0),h=i(18),c=i(35),d=i(3),f=ut(d),l=i(11),g=i(65),a=e(g),nt=i(161),tt=e(nt),it=i(417),v=e(it),rt=i(63);p=new WeakMap;w=function(n){function t(n,i){ft(this,t);var r=et(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n,s.extend(t.DEFAULTS,i)));return p.set(r,{}),r.searchInput=new tt.default(r.hot,{placeholder:f.FILTERS_BUTTONS_PLACEHOLDER_SEARCH,className:"htUIMultipleSelectSearch"}),r.selectAllUI=new v.default(r.hot,{textContent:f.FILTERS_BUTTONS_SELECT_ALL,className:"htUISelectAll"}),r.clearAllUI=new v.default(r.hot,{textContent:f.FILTERS_BUTTONS_CLEAR,className:"htUIClearAll"}),r.items=[],r.itemsBox=null,r.registerHooks(),r}return ot(t,n),o(t,null,[{key:"DEFAULTS",get:function(){return s.clone({className:"htUIMultipleSelect",value:[]})}}]),o(t,[{key:"registerHooks",value:function(){var n=this;this.searchInput.addLocalHook("keydown",function(t){return n.onInputKeyDown(t)});this.searchInput.addLocalHook("input",function(t){return n.onInput(t)});this.selectAllUI.addLocalHook("click",function(t){return n.onSelectAllClick(t)});this.clearAllUI.addLocalHook("click",function(t){return n.onClearAllClick(t)})}},{key:"setItems",value:function(n){this.items=n;this.itemsBox&&this.itemsBox.loadData(this.items)}},{key:"getItems",value:function(){return[].concat(y(this.items))}},{key:"getValue",value:function(){return ht(this.items)}},{key:"isSelectedAllValues",value:function(){return this.items.length===this.getValue().length}},{key:"build",value:function(){var n=this,i,f,r;u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"build",this).call(this);i=document.createElement("div");f=new a.default(this.hot,{className:"htUISelectionControls",children:[this.selectAllUI,this.clearAllUI]});this._element.appendChild(this.searchInput.element);this._element.appendChild(f.element);this._element.appendChild(i);r=function(t){n._element&&(n.itemsBox&&n.itemsBox.destroy(),k.addClass(t,"htUIMultipleSelectHot"),n.itemsBox=new n.hot.constructor(t,{data:n.items,columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:function(n,t,i,r,u,f){n.title=f.instance.getDataAtRowProp(t,f.label.property)},autoWrapCol:!0,colWidths:187,height:110,width:187,copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},beforeKeyDown:function(t){return n.onItemsBoxBeforeKeyDown(t)}}),n.itemsBox.init())};r(i);setTimeout(function(){return r(i)},100)}},{key:"reset",value:function(){this.searchInput.reset();this.selectAllUI.reset();this.clearAllUI.reset()}},{key:"update",value:function(){this.isBuilt()&&(this.itemsBox.loadData(st(this.items,this.options.value)),u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"update",this).call(this))}},{key:"destroy",value:function(){this.itemsBox&&this.itemsBox.destroy();this.searchInput.destroy();this.clearAllUI.destroy();this.selectAllUI.destroy();this.searchInput=null;this.clearAllUI=null;this.selectAllUI=null;this.itemsBox=null;this.items=null;u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}},{key:"onInput",value:function(n){var t=n.target.value.toLowerCase(),i=void 0;i=t===""?[].concat(y(this.items)):r.arrayFilter(this.items,function(n){return(n.value+"").toLowerCase().indexOf(t)>=0});this.itemsBox.loadData(i)}},{key:"onInputKeyDown",value:function(n){this.runLocalHooks("keydown",n,this);var t=c.partial(h.isKey,n.keyCode);t("ARROW_DOWN|TAB")&&!this.itemsBox.isListening()&&(l.stopImmediatePropagation(n),this.itemsBox.listen(),this.itemsBox.selectCell(0,0))}},{key:"onItemsBoxBeforeKeyDown",value:function(n){var t=c.partial(h.isKey,n.keyCode);t("ESCAPE")&&this.runLocalHooks("keydown",n,this);t("ARROW_UP|ARROW_DOWN|ARROW_LEFT|ARROW_RIGHT|TAB|SPACE|ENTER")||(l.stopImmediatePropagation(n),this.itemsBox.unlisten(),this.itemsBox.deselectCell(),this.searchInput.focus())}},{key:"onSelectAllClick",value:function(n){n.preventDefault();r.arrayEach(this.itemsBox.getSourceData(),function(n){n.checked=!0});this.itemsBox.render()}},{key:"onClearAllClick",value:function(n){n.preventDefault();r.arrayEach(this.itemsBox.getSourceData(),function(n){n.checked=!1});this.itemsBox.render()}}]),t}(a.default);t.default=w},function(n,t,i){"use strict";function l(n){return n&&n.__esModule?n:{"default":n}}function a(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function v(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function y(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var r,e;t.__esModule=!0;var o=function s(n,t,i){var r,u,f;return n===null&&(n=Function.prototype),r=Object.getOwnPropertyDescriptor(n,t),r===undefined?(u=Object.getPrototypeOf(n),u===null?undefined:s(u,t,i)):"value"in r?r.value:(f=r.get,f===undefined)?undefined:f.call(i)},u=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),f=i(1),h=i(65),c=l(h);r=new WeakMap;e=function(n){function t(n,i){a(this,t);var u=v(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n,f.extend(t.DEFAULTS,i)));return r.set(u,{}),u}return y(t,n),u(t,null,[{key:"DEFAULTS",get:function(){return f.clone({href:"#",tagName:"a"})}}]),u(t,[{key:"build",value:function(){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"build",this).call(this);var n=r.get(this);n.link=this._element.firstChild}},{key:"update",value:function(){this.isBuilt()&&(r.get(this).link.textContent=this.hot.getTranslatedPhrase(this.options.textContent))}}]),t}(c.default);t.default=e},function(n,t,i){"use strict";function o(n){return n&&n.__esModule?n:{"default":n}}function y(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function p(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function w(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function b(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var s;t.__esModule=!0;var r=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),h=i(2),u=i(0),c=i(3),f=y(c),l=i(83),a=o(l),v=i(161),e=o(v);s=function(n){function t(n,i){p(this,t);var r=w(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return r.id=i.id,r.name=i.name,r.elements.push(new e.default(r.hot,{type:"button",value:f.FILTERS_BUTTONS_OK,className:"htUIButton htUIButtonOK",identifier:t.BUTTON_OK})),r.elements.push(new e.default(r.hot,{type:"button",value:f.FILTERS_BUTTONS_CANCEL,className:"htUIButton htUIButtonCancel",identifier:t.BUTTON_CANCEL})),r.registerHooks(),r}return b(t,n),r(t,null,[{key:"BUTTON_OK",get:function(){return"ok"}},{key:"BUTTON_CANCEL",get:function(){return"cancel"}}]),r(t,[{key:"registerHooks",value:function(){var n=this;u.arrayEach(this.elements,function(t){t.addLocalHook("click",function(t,i){return n.onButtonClick(t,i)})})}},{key:"getMenuItemDescriptor",value:function(){var n=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return n.isHidden()},renderer:function(t,i){return h.addClass(i.parentNode,"htFiltersMenuActionBar"),u.arrayEach(n.elements,function(n){return i.appendChild(n.element)}),i}}}},{key:"accept",value:function(){this.runLocalHooks("accept")}},{key:"cancel",value:function(){this.runLocalHooks("cancel")}},{key:"onButtonClick",value:function(n,i){i.options.identifier===t.BUTTON_OK?this.accept():this.cancel()}}]),t}(a.default);t.default=s},function(n,t,i){"use strict";function u(n){return n&&n.__esModule?n:{"default":n}}function w(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var f;t.__esModule=!0;var o=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),r=i(0),e=i(1),s=i(35),h=i(21),c=u(h),l=i(227),a=u(l),v=i(228),y=u(v),p=i(63);f=function(){function n(t){var i=this,r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:function(){return[]};w(this,n);this.conditionCollection=t;this.columnDataFactory=r;this.changes=[];this.grouping=!1;this.latestEditedColumnPosition=-1;this.latestOrderStack=[];this.conditionCollection.addLocalHook("beforeRemove",function(n){return i._onConditionBeforeModify(n)});this.conditionCollection.addLocalHook("afterAdd",function(n){return i.updateStatesAtColumn(n)});this.conditionCollection.addLocalHook("afterClear",function(n){return i.updateStatesAtColumn(n)});this.conditionCollection.addLocalHook("beforeClean",function(){return i._onConditionBeforeClean()});this.conditionCollection.addLocalHook("afterClean",function(){return i._onConditionAfterClean()})}return o(n,[{key:"groupChanges",value:function(){this.grouping=!0}},{key:"flush",value:function(){var n=this;this.grouping=!1;r.arrayEach(this.changes,function(t){n.updateStatesAtColumn(t)});this.changes.length=0}},{key:"_onConditionBeforeModify",value:function(n){this.latestEditedColumnPosition=this.conditionCollection.orderStack.indexOf(n)}},{key:"updateStatesAtColumn",value:function(n,t){var e=this,f,i,o,u,h,c;if(this.grouping){this.changes.indexOf(n)===-1&&this.changes.push(n);return}f=this.conditionCollection.exportAllConditions();i=this.conditionCollection.orderStack.indexOf(n);i===-1&&(i=this.latestEditedColumnPosition);o=f.slice(0,i);u=f.slice(i);u.length&&u[0].column===n&&u.shift();h=s.curry(function(n,t){var s=arguments.length>2&&arguments[2]!==undefined?arguments[2]:[],u=new a.default,f,i,o;return n=[].concat(n,s),u.importAllConditions(n),f=e.columnDataFactory(t),i=void 0,i=u.isEmpty()?f:new y.default(u,function(n){return e.columnDataFactory(n)}).filter(),i=r.arrayMap(i,function(n){return n.meta.visualRow}),o=p.createArrayAssertion(i),r.arrayFilter(f,function(n){return o(n.meta.visualRow)})})(o);c=[].concat(this.conditionCollection.getConditions(n));this.runLocalHooks("update",{editedConditionStack:{column:n,conditions:c},dependentConditionStacks:u,filteredRowsFactory:h,conditionArgsChange:t})}},{key:"_onConditionBeforeClean",value:function(){this.latestOrderStack=[].concat(this.conditionCollection.orderStack)}},{key:"_onConditionAfterClean",value:function(){var n=this;r.arrayEach(this.latestOrderStack,function(t){n.updateStatesAtColumn(t)})}},{key:"destroy",value:function(){var n=this;this.clearLocalHooks();e.objectEach(this,function(t,i){n[i]=null})}}]),n}();e.mixin(f,c.default);t.default=f},function(){},function(n,t,i){"use strict";function u(n){return n&&n.__esModule?n:{"default":n}}function it(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function rt(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function ut(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var o;t.__esModule=!0;var h=function(){function n(n,t){var r=[],u=!0,f=!1,e=undefined,i,o;try{for(i=n[Symbol.iterator]();!(u=(o=i.next()).done);u=!0)if(r.push(o.value),t&&r.length===t)break}catch(s){f=!0;e=s}finally{try{!u&&i["return"]&&i["return"]()}finally{if(f)throw e;}}return r}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return n(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance");}}(),c=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),f=function l(n,t,i){var r,u,f;return n===null&&(n=Function.prototype),r=Object.getOwnPropertyDescriptor(n,t),r===undefined?(u=Object.getPrototypeOf(n),u===null?undefined:l(u,t,i)):"value"in r?r.value:(f=r.get,f===undefined)?undefined:f.call(i)},a=i(7),v=u(a),s=i(0),e=i(1),y=i(9),p=u(y),w=i(6),r=i(37),b=i(422),k=u(b),d=i(431),g=u(d),nt=i(432),tt=u(nt);o=function(n){function t(n){it(this,t);var i=rt(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return i.eventManager=new p.default(i),i.dataProvider=new g.default(i.hot),i.sheet=new k.default(i.hot,i.dataProvider),i.undoRedoSnapshot=new tt.default(i.sheet),i._skipRendering=!1,i}return ut(t,n),c(t,[{key:"isEnabled",value:function(){return this.hot.getSettings().formulas?!0:!1}},{key:"enablePlugin",value:function(){var n=this,i;this.enabled||(i=this.hot.getSettings().formulas,e.isObject(i)&&e.isObject(i.variables)&&e.objectEach(i.variables,function(t,i){return n.setVariable(i,t)}),this.addHook("afterColumnSort",function(){return n.onAfterColumnSort.apply(n,arguments)}),this.addHook("afterCreateCol",function(){return n.onAfterCreateCol.apply(n,arguments)}),this.addHook("afterCreateRow",function(){return n.onAfterCreateRow.apply(n,arguments)}),this.addHook("afterLoadData",function(){return n.onAfterLoadData()}),this.addHook("afterRemoveCol",function(){return n.onAfterRemoveCol.apply(n,arguments)}),this.addHook("afterRemoveRow",function(){return n.onAfterRemoveRow.apply(n,arguments)}),this.addHook("afterSetDataAtCell",function(){return n.onAfterSetDataAtCell.apply(n,arguments)}),this.addHook("afterSetDataAtRowProp",function(){return n.onAfterSetDataAtCell.apply(n,arguments)}),this.addHook("beforeColumnSort",function(){return n.onBeforeColumnSort.apply(n,arguments)}),this.addHook("beforeCreateCol",function(){return n.onBeforeCreateCol.apply(n,arguments)}),this.addHook("beforeCreateRow",function(){return n.onBeforeCreateRow.apply(n,arguments)}),this.addHook("beforeRemoveCol",function(){return n.onBeforeRemoveCol.apply(n,arguments)}),this.addHook("beforeRemoveRow",function(){return n.onBeforeRemoveRow.apply(n,arguments)}),this.addHook("beforeValidate",function(){return n.onBeforeValidate.apply(n,arguments)}),this.addHook("beforeValueRender",function(){return n.onBeforeValueRender.apply(n,arguments)}),this.addHook("modifyData",function(){return n.onModifyData.apply(n,arguments)}),this.sheet.addLocalHook("afterRecalculate",function(){return n.onSheetAfterRecalculate.apply(n,arguments)}),f(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){f(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disablePlugin",this).call(this)}},{key:"getCellValue",value:function(n,t){var i=this.sheet.getCellAt(n,t);if(i)return i.getError()||i.getValue()}},{key:"hasComputedCellValue",value:function(n,t){return this.sheet.getCellAt(n,t)!==null}},{key:"recalculate",value:function(){this.sheet.recalculate()}},{key:"recalculateFull",value:function(){this.sheet.recalculateFull()}},{key:"recalculateOptimized",value:function(){this.sheet.recalculateOptimized()}},{key:"setVariable",value:function(n,t){this.sheet.setVariable(n,t)}},{key:"getVariable",value:function(n){return this.sheet.getVariable(n)}},{key:"onSheetAfterRecalculate",value:function(n){if(this._skipRendering){this._skipRendering=!1;return}var t=this.hot;s.arrayEach(n,function(n){var i=n.row,r=n.column;t.validateCell(t.getDataAtCell(i,r),t.getCellMeta(i,r),function(){})});t.render()}},{key:"onModifyData",value:function(n,t,i,u){u==="get"&&this.hasComputedCellValue(n,t)?i.value=this.getCellValue(n,t):u==="set"&&r.isFormulaExpression(i.value)&&(i.value=r.toUpperCaseFormula(i.value))}},{key:"onBeforeValueRender",value:function(n){return r.isFormulaExpressionEscaped(n)&&(n=r.unescapeFormulaExpression(n)),n}},{key:"onBeforeValidate",value:function(n,t,i){var r=this.hot.propToCol(i);return this.hasComputedCellValue(t,r)&&(n=this.getCellValue(t,r)),n}},{key:"onAfterSetDataAtCell",value:function(n,t){var i=this;t!=="loadData"&&(this.dataProvider.clearChanges(),s.arrayEach(n,function(n){var u=h(n,4),f=u[0],e=u[1],o=u[2],t=u[3];e=i.hot.propToCol(e);f=i.t.toPhysicalRow(f);r.isFormulaExpression(t)&&(t=r.toUpperCaseFormula(t));i.dataProvider.collectChanges(f,e,t);o!==t&&i.sheet.applyChanges(f,e,t)}),this.recalculate())}},{key:"onBeforeCreateRow",value:function(n,t,i){i==="UndoRedo.undo"&&this.undoRedoSnapshot.restore()}},{key:"onAfterCreateRow",value:function(n,t,i){this.sheet.alterManager.triggerAlter("insert_row",n,t,i!=="UndoRedo.undo")}},{key:"onBeforeRemoveRow",value:function(n,t){this.undoRedoSnapshot.save("row",n,t)}},{key:"onAfterRemoveRow",value:function(n,t){this.sheet.alterManager.triggerAlter("remove_row",n,t)}},{key:"onBeforeCreateCol",value:function(n,t,i){i==="UndoRedo.undo"&&this.undoRedoSnapshot.restore()}},{key:"onAfterCreateCol",value:function(n,t,i){this.sheet.alterManager.triggerAlter("insert_column",n,t,i!=="UndoRedo.undo")}},{key:"onBeforeRemoveCol",value:function(n,t){this.undoRedoSnapshot.save("column",n,t)}},{key:"onAfterRemoveCol",value:function(n,t){this.sheet.alterManager.triggerAlter("remove_column",n,t)}},{key:"onBeforeColumnSort",value:function(n,t){this.sheet.alterManager.prepareAlter("column_sorting",n,t)}},{key:"onAfterColumnSort",value:function(n,t){this.sheet.alterManager.triggerAlter("column_sorting",n,t)}},{key:"onAfterLoadData",value:function(){this._skipRendering=!0;this.recalculateFull()}},{key:"destroy",value:function(){this.dataProvider.destroy();this.dataProvider=null;this.sheet.destroy();this.sheet=null;f(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}}]),t}(v.default);w.registerPlugin("formulas",o);t.default=o},function(n,t,i){"use strict";function o(n){return n&&n.__esModule?n:{"default":n}}function rt(n){if(Array.isArray(n)){for(var t=0,i=Array(n.length);t<n.length;t++)i[t]=n[t];return i}return Array.from(n)}function ut(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}t.__esModule=!0;var v=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),f=i(66),u=i(0),ft=i(4),y=i(21),p=o(y),w=i(53),b=i(1),k=i(45),e=o(k),d=i(423),s=o(d),r=i(37),g=i(424),nt=o(g),tt=i(425),it=o(tt);var h=1,c=2,l=3,a=function(){function n(t,i){var r=this;ut(this,n);this.hot=t;this.t=w.getTranslator(this.hot);this.dataProvider=i;this.parser=new f.Parser;this.matrix=new nt.default(this.t);this.alterManager=new it.default(this);this._processingCell=null;this._state=l;this.parser.on("callCellValue",function(){return r._onCallCellValue.apply(r,arguments)});this.parser.on("callRangeValue",function(){return r._onCallRangeValue.apply(r,arguments)});this.alterManager.addLocalHook("afterAlter",function(){return r._onAfterAlter.apply(r,arguments)})}return v(n,[{key:"recalculate",value:function(){switch(this._state){case l:this.recalculateFull();break;case c:this.recalculateOptimized()}}},{key:"recalculateOptimized",value:function(){var n=this,t=this.matrix.getOutOfDateCells();u.arrayEach(t,function(t){var i=n.dataProvider.getSourceDataAtCell(t.row,t.column);r.isFormulaExpression(i)&&n.parseExpression(t,i.substr(1))});this._state=h;this.runLocalHooks("afterRecalculate",t,"optimized")}},{key:"recalculateFull",value:function(){var t=this,n=this.dataProvider.getSourceDataByRange();this.matrix.reset();u.arrayEach(n,function(n,i){u.arrayEach(n,function(n,u){r.isFormulaExpression(n)&&t.parseExpression(new e.default(i,u),n.substr(1))})});this._state=h;this.runLocalHooks("afterRecalculate",n,"full")}},{key:"setVariable",value:function(n,t){this.parser.setVariable(n,t)}},{key:"getVariable",value:function(n){return this.parser.getVariable(n)}},{key:"applyChanges",value:function(n,t,i){this.matrix.remove({row:n,column:t});r.isFormulaExpression(i)&&this.parseExpression(new e.default(n,t),i.substr(1));var f=this.getCellDependencies.apply(this,rt(this.t.toVisual(n,t)));u.arrayEach(f,function(n){n.setState(e.default.STATE_OUT_OFF_DATE)});this._state=c}},{key:"parseExpression",value:function(n,t){n.setState(e.default.STATE_COMPUTING);this._processingCell=n;var u=this.parser.parse(r.toUpperCaseFormula(t)),f=u.error,i=u.result;r.isFormulaExpression(i)?this.parseExpression(n,i.substr(1)):(n.setValue(i),n.setError(f),n.setState(e.default.STATE_UP_TO_DATE));this.matrix.add(n);this._processingCell=null}},{key:"getCellAt",value:function(n,t){return this.matrix.getCellAt(n,t)}},{key:"getCellDependencies",value:function(n,t){return this.matrix.getDependencies({row:n,column:t})}},{key:"_onCallCellValue",value:function(n,t){var e=n.row,o=n.column,u=new s.default(e,o),i,h;if(!this.dataProvider.isInDataRange(u.row,u.column))throw Error(f.ERROR_REF);if(this.matrix.registerCellRef(u),this._processingCell.addPrecedent(u),i=this.dataProvider.getRawDataAtCell(e.index,o.index),f.error(i)&&(h=this.matrix.getCellAt(e.index,o.index),h&&h.hasError()))throw Error(i);if(r.isFormulaExpression(i)){var c=this.parser.parse(i.substr(1)),l=c.error,a=c.result;if(l)throw Error(l);t(a)}else t(i)}},{key:"_onCallRangeValue",value:function(n,t,i){var o=n.row,h=n.column,e=this,c=t.row,l=t.column,a=this.dataProvider.getRawDataByRange(o.index,h.index,c.index,l.index),v=function(n,t){return u.arrayMap(n,function(n,i){var v=o.index+t,y=h.index+i,u=new s.default(v,y),c;if(!e.dataProvider.isInDataRange(u.row,u.column))throw Error(f.ERROR_REF);if(e.matrix.registerCellRef(u),e._processingCell.addPrecedent(u),f.error(n)&&(c=e.matrix.getCellAt(u.row,u.column),c&&c.hasError()))throw Error(n);if(r.isFormulaExpression(n)){var l=e.parser.parse(n.substr(1)),a=l.error,p=l.result;if(a)throw Error(a);n=p}return n})},y=u.arrayMap(a,function(n,t){return v(n,t)});i(y)}},{key:"_onAfterAlter",value:function(){this.recalculateOptimized()}},{key:"destroy",value:function(){this.hot=null;this.t=null;this.dataProvider.destroy();this.dataProvider=null;this.alterManager.destroy();this.alterManager=null;this.parser=null;this.matrix.reset();this.matrix=null}}]),n}();b.mixin(a,p.default);t.default=a},function(n,t,i){"use strict";function s(n){return n&&n.__esModule?n:{"default":n}}function h(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function c(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function l(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var r;t.__esModule=!0;var u=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),f=i(66),e=i(229),o=s(e);r=function(n){function t(){return h(this,t),c(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return l(t,n),u(t,[{key:"toString",value:function(){return f.toLabel({index:this.row,isAbsolute:!1},{index:this.column,isAbsolute:!1})}}]),t}(o.default);t.default=r},function(n,t,i){"use strict";function s(n){return n&&n.__esModule?n:{"default":n}}function h(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var u;t.__esModule=!0;var f=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),r=i(0),e=i(45),o=s(e);u=function(){function n(t){h(this,n);this.t=t;this.data=[];this.cellReferences=[]}return f(n,[{key:"getCellAt",value:function(n,t){var i=null;return r.arrayEach(this.data,function(r){if(r.row===n&&r.column===t)return i=r,!1}),i}},{key:"getOutOfDateCells",value:function(){return r.arrayFilter(this.data,function(n){return n.isState(o.default.STATE_OUT_OFF_DATE)})}},{key:"add",value:function(n){r.arrayFilter(this.data,function(t){return t.isEqual(n)}).length||this.data.push(n)}},{key:"remove",value:function(n){var t=Array.isArray(n),i=function(n,i){var u=!1;return t?r.arrayEach(i,function(t){if(n.isEqual(t))return u=!0,!1}):u=n.isEqual(i),u};this.data=r.arrayFilter(this.data,function(t){return!i(t,n)})}},{key:"getDependencies",value:function(n){var t=this,u=function(n){return r.arrayReduce(t.data,function(t,i){return i.hasPrecedent(n)&&t.indexOf(i)===-1&&t.push(i),t},[])},i=function i(n){var f=u(n);return f.length&&r.arrayEach(f,function(n){n.hasPrecedents()&&(f=f.concat(i(t.t.toVisual(n))))}),f};return i(n)}},{key:"registerCellRef",value:function(n){r.arrayFilter(this.cellReferences,function(t){return t.isEqual(n)}).length||this.cellReferences.push(n)}},{key:"removeCellRefsAtRange",value:function(n,t){var i=n.row,u=n.column,e=t.row,o=t.column,f=[],s=function(n){return i===void 0?!0:n.row>=i&&n.row<=e},h=function(n){return u===void 0?!0:n.column>=u&&n.column<=o};return this.cellReferences=r.arrayFilter(this.cellReferences,function(n){return s(n)&&h(n)?(f.push(n),!1):!0}),f}},{key:"reset",value:function(){this.data.length=0;this.cellReferences.length=0}}]),n}();t.default=u},function(n,t,i){"use strict";function f(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function tt(n){return n&&n.__esModule?n:{"default":n}}function it(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function u(n,t){r.has(n)||r.set(n,{prepare:t.prepare||o,operate:t.operate||o})}var s,r,e,o;t.__esModule=!0;s=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}();t.registerOperation=u;var rt=i(0),y=i(1),p=i(21),w=tt(p),b=i(426),h=f(b),k=i(427),c=f(k),d=i(428),l=f(d),g=i(429),a=f(g),nt=i(430),v=f(nt);r=new Map;u(h.OPERATION_NAME,h);u(c.OPERATION_NAME,c);u(l.OPERATION_NAME,l);u(a.OPERATION_NAME,a);u(v.OPERATION_NAME,v);e=function(){function n(t){it(this,n);this.sheet=t;this.hot=t.hot;this.dataProvider=t.dataProvider;this.matrix=t.matrix}return s(n,[{key:"prepareAlter",value:function(n){if(!r.has(n))throw Error('Alter operation "'+n+'" not exist.');for(var i=arguments.length,u=Array(i>1?i-1:0),t=1;t<i;t++)u[t-1]=arguments[t];r.get(n).prepare.apply(this,u)}},{key:"triggerAlter",value:function(n){if(!r.has(n))throw Error('Alter operation "'+n+'" not exist.');for(var i=arguments.length,u=Array(i>1?i-1:0),t=1;t<i;t++)u[t-1]=arguments[t];r.get(n).operate.apply(this,u);this.runLocalHooks.apply(this,["afterAlter"].concat(u))}},{key:"destroy",value:function(){this.sheet=null;this.hot=null;this.dataProvider=null;this.matrix=null}}]),n}();y.mixin(e,w.default);t.default=e;o=function(){}},function(n,t,i){"use strict";function f(n){return n&&n.__esModule?n:{"default":n}}function a(){var n=this.matrix,t=this.dataProvider;r=new WeakMap;u.arrayEach(n.data,function(n){r.set(n,t.t.toVisualRow(n.row))})}function v(){var t=this.matrix,n=this.dataProvider;t.cellReferences.length=0;u.arrayEach(t.data,function(t){var h,u;t.setState(s.default.STATE_OUT_OFF_DATE);t.clearPrecedents();var i=t.row,f=t.column,o=n.getSourceDataAtCell(i,f);e.isFormulaExpression(o)&&(h=r.get(t),u=new c.default(o),u.translate({row:n.t.toVisualRow(i)-h}),n.updateSourceData(i,f,u.toString()))});r=null}var l,r;t.__esModule=!0;t.OPERATION_NAME=undefined;t.prepare=a;t.operate=v;var u=i(0),e=i(37),o=i(45),s=f(o),h=i(67),c=f(h);l=t.OPERATION_NAME="column_sorting";r=void 0},function(n,t,i){"use strict";function f(n){return n&&n.__esModule?n:{"default":n}}function l(n,t){var s=arguments.length>2&&arguments[2]!==undefined?arguments[2]:!0,i=this.matrix,f=this.dataProvider,e=[0,t];r.arrayEach(i.cellReferences,function(t){t.column>=n&&t.translateTo.apply(t,e)});r.arrayEach(i.data,function(i){var p=i.row,w=i.column,y,r;if(i.column>=n&&(i.translateTo.apply(i,e),i.setState(o.default.STATE_OUT_OFF_DATE)),s){var c=i.row,l=i.column,v=f.getSourceDataAtCell(c,l);u.isFormulaExpression(v)&&(y=u.cellCoordFactory("column",n),r=new h.default(v),r.useCustomModifier(a),r.translate({column:t},y({row:p,column:w})),f.updateSourceData(c,l,r.toString()))}})}function a(n,t,i,r){var e=n.start,o=n.end,s=e[t].index,h=o[t].index,u=i,f=i;return r>s&&(u=0),r>h&&(f=0),[u,f,!1]}var c;t.__esModule=!0;t.OPERATION_NAME=undefined;t.operate=l;var r=i(0),u=i(37),e=i(45),o=f(e),s=i(67),h=f(s);c=t.OPERATION_NAME="insert_column"},function(n,t,i){"use strict";function f(n){return n&&n.__esModule?n:{"default":n}}function l(n,t){var s=arguments.length>2&&arguments[2]!==undefined?arguments[2]:!0,i=this.matrix,f=this.dataProvider,e=[t,0];r.arrayEach(i.cellReferences,function(t){t.row>=n&&t.translateTo.apply(t,e)});r.arrayEach(i.data,function(i){var p=i.row,w=i.column,y,r;if(i.row>=n&&(i.translateTo.apply(i,e),i.setState(o.default.STATE_OUT_OFF_DATE)),s){var c=i.row,l=i.column,v=f.getSourceDataAtCell(c,l);u.isFormulaExpression(v)&&(y=u.cellCoordFactory("row",n),r=new h.default(v),r.useCustomModifier(a),r.translate({row:t},y({row:p,column:w})),f.updateSourceData(c,l,r.toString()))}})}function a(n,t,i,r){var e=n.start,o=n.end,s=e[t].index,h=o[t].index,u=i,f=i;return r>s&&(u=0),r>h&&(f=0),[u,f,!1]}var c;t.__esModule=!0;t.OPERATION_NAME=undefined;t.operate=l;var r=i(0),u=i(37),e=i(45),o=f(e),s=i(67),h=f(s);c=t.OPERATION_NAME="insert_row"},function(n,t,i){"use strict";function e(n){return n&&n.__esModule?n:{"default":n}}function l(n,t){var l=arguments.length>2&&arguments[2]!==undefined?arguments[2]:!0;t=-t;var i=this.matrix,e=this.dataProvider,v=this.sheet,o=[0,t],s=Math.abs(t)-1,y=i.removeCellRefsAtRange({column:n},{column:n+s}),c=[];r.arrayEach(i.data,function(t){r.arrayEach(y,function(n){t.hasPrecedent(n)&&(t.removePrecedent(n),t.setState(u.default.STATE_OUT_OFF_DATE),r.arrayEach(v.getCellDependencies(t.row,t.column),function(n){n.setState(u.default.STATE_OUT_OFF_DATE)}))});t.column>=n&&t.column<=n+s&&c.push(t)});i.remove(c);r.arrayEach(i.cellReferences,function(t){t.column>=n&&t.translateTo.apply(t,o)});r.arrayEach(i.data,function(i){var p=i.row,w=i.column,y,r;if(i.column>=n&&(i.translateTo.apply(i,o),i.setState(u.default.STATE_OUT_OFF_DATE)),l){var s=i.row,c=i.column,v=e.getSourceDataAtCell(s,c);f.isFormulaExpression(v)&&(y=f.cellCoordFactory("column",n),r=new h.default(v),r.useCustomModifier(a),r.translate({column:t},y({row:p,column:w})),e.updateSourceData(s,c,r.toString()))}})}function a(n,t,i,r){var l=n.start,a=n.end,c=n.type,f=l[t].index,e=a[t].index,h=Math.abs(i)-1,u=i,o=i,s=!1;return f>=r&&e<=r+h&&(s=!0),s||c!=="cell"||r>=f&&(u=0,o=0),s||c!=="range"||(r>=f&&(u=0),r>e?o=0:e<=r+h&&(o-=Math.min(e-(r+h),0))),f+u<0&&(u-=f+u),[u,o,s]}var c;t.__esModule=!0;t.OPERATION_NAME=undefined;t.operate=l;var r=i(0),f=i(37),o=i(45),u=e(o),s=i(67),h=e(s);c=t.OPERATION_NAME="remove_column"},function(n,t,i){"use strict";function e(n){return n&&n.__esModule?n:{"default":n}}function l(n,t){var l=arguments.length>2&&arguments[2]!==undefined?arguments[2]:!0;t=-t;var i=this.matrix,e=this.dataProvider,v=this.sheet,o=[t,0],s=Math.abs(t)-1,y=i.removeCellRefsAtRange({row:n},{row:n+s}),c=[];r.arrayEach(i.data,function(t){r.arrayEach(y,function(n){t.hasPrecedent(n)&&(t.removePrecedent(n),t.setState(u.default.STATE_OUT_OFF_DATE),r.arrayEach(v.getCellDependencies(t.row,t.column),function(n){n.setState(u.default.STATE_OUT_OFF_DATE)}))});t.row>=n&&t.row<=n+s&&c.push(t)});i.remove(c);r.arrayEach(i.cellReferences,function(t){t.row>=n&&t.translateTo.apply(t,o)});r.arrayEach(i.data,function(i){var p=i.row,w=i.column,y,r;if(i.row>=n&&(i.translateTo.apply(i,o),i.setState(u.default.STATE_OUT_OFF_DATE)),l){var s=i.row,c=i.column,v=e.getSourceDataAtCell(s,c);f.isFormulaExpression(v)&&(y=f.cellCoordFactory("row",n),r=new h.default(v),r.useCustomModifier(a),r.translate({row:t},y({row:p,column:w})),e.updateSourceData(s,c,r.toString()))}})}function a(n,t,i,r){var l=n.start,a=n.end,c=n.type,f=l[t].index,e=a[t].index,h=Math.abs(i)-1,u=i,o=i,s=!1;return f>=r&&e<=r+h&&(s=!0),s||c!=="cell"||r>=f&&(u=0,o=0),s||c!=="range"||(r>=f&&(u=0),r>e?o=0:e<=r+h&&(o-=Math.min(e-(r+h),0))),f+u<0&&(u-=f+u),[u,o,s]}var c;t.__esModule=!0;t.OPERATION_NAME=undefined;t.operate=l;var r=i(0),f=i(37),o=i(45),u=e(o),s=i(67),h=e(s);c=t.OPERATION_NAME="remove_row"},function(n,t,i){"use strict";function u(n){if(Array.isArray(n)){for(var t=0,i=Array(n.length);t<n.length;t++)i[t]=n[t];return i}return Array.from(n)}function l(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var o;t.__esModule=!0;var s=function(){function n(n,t){var r=[],u=!0,f=!1,e=undefined,i,o;try{for(i=n[Symbol.iterator]();!(u=(o=i.next()).done);u=!0)if(r.push(o.value),t&&r.length===t)break}catch(s){f=!0;e=s}finally{try{!u&&i["return"]&&i["return"]()}finally{if(f)throw e;}}return r}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return n(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance");}}(),h=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),f=i(0),e=i(4),r=i(1),c=i(53),a=i(37);o=function(){function n(t){l(this,n);this.hot=t;this.changes={};this.t=c.getTranslator(this.hot)}return h(n,[{key:"collectChanges",value:function(n,t,i){this.changes[this._coordId(n,t)]=i}},{key:"clearChanges",value:function(){this.changes={}}},{key:"isInDataRange",value:function(n,t){return n>=0&&n<this.hot.countRows()&&t>=0&&t<this.hot.countCols()}},{key:"getDataAtCell",value:function(n,t){var i=this._coordId.apply(this,u(this.t.toPhysical(n,t)));return r.hasOwnProperty(this.changes,i)?this.changes[i]:this.hot.getDataAtCell(n,t)}},{key:"getDataByRange",value:function(n,t,i,e){var o=this,s=this.hot.getData(n,t,i,e);return f.arrayEach(s,function(i,e){f.arrayEach(i,function(i,f){var h=o._coordId.apply(o,u(o.t.toPhysical(e+n,f+t)));r.hasOwnProperty(o.changes,h)&&(s[e][f]=o.changes[h])})}),s}},{key:"getSourceDataAtCell",value:function(n,t){var i=this._coordId(n,t);return r.hasOwnProperty(this.changes,i)?this.changes[i]:this.hot.getSourceDataAtCell(n,t)}},{key:"getSourceDataByRange",value:function(n,t,i,r){return this.hot.getSourceDataArray(n,t,i,r)}},{key:"getRawDataAtCell",value:function(n,t){return this.getSourceDataAtCell.apply(this,u(this.t.toPhysical(n,t)))}},{key:"getRawDataByRange",value:function(n,t,i,u){var f=this,o=[];return e.rangeEach(n,i,function(n){var i=[];e.rangeEach(t,u,function(t){var c=f.t.toPhysical(n,t),u=s(c,2),e=u[0],o=u[1],h=f._coordId(e,o);r.hasOwnProperty(f.changes,h)?i.push(f.changes[h]):i.push(f.getSourceDataAtCell(e,o))});o.push(i)}),o}},{key:"updateSourceData",value:function(n,t,i){this.hot.getSourceData()[n][this.hot.colToProp(t)]=i}},{key:"_coordId",value:function(n,t){return n+":"+t}},{key:"destroy",value:function(){this.hot=null;this.changes=null;this.t=null}}]),n}();t.default=o},function(n,t,i){"use strict";function u(n){return n&&n.__esModule?n:{"default":n}}function l(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var f;t.__esModule=!0;var e=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),r=i(0),a=i(4),o=i(433),s=u(o),h=i(45),c=u(h);f=function(){function n(t){l(this,n);this.sheet=t;this.stack=new s.default}return e(n,[{key:"save",value:function(n,t,i){var u=this.sheet,e=u.matrix,o=u.dataProvider,f=[];r.arrayEach(e.data,function(r){var u=r.row,e=r.column,s;(r[n]<t||r[n]>t+(i-1))&&(s=o.getSourceDataAtCell(u,e),f.push({row:u,column:e,value:s}))});this.stack.push({axis:n,index:t,amount:i,changes:f})}},{key:"restore",value:function(){var t=this.sheet,o=t.matrix,i=t.dataProvider,n=this.stack.pop(),u=n.axis,s=n.index,f=n.amount,e=n.changes;e&&r.arrayEach(e,function(n){n[u]>s+(f-1)&&(n[u]-=f);var t=n.row,r=n.column,e=n.value,h=i.getSourceDataAtCell(t,r);h!==e&&(i.updateSourceData(t,r,e),o.getCellAt(t,r).setState(c.default.STATE_OUT_OFF_DATE))})}},{key:"destroy",value:function(){this.sheet=null;this.stack=null}}]),n}();t.default=f},function(n,t){"use strict";function u(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var i,r;t.__esModule=!0;i=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}();r=function(){function n(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];u(this,n);this.items=t}return i(n,[{key:"push",value:function(){var n;(n=this.items).push.apply(n,arguments)}},{key:"pop",value:function(){return this.items.pop()}},{key:"peek",value:function(){if(!this.isEmpty())return this.items[this.items.length-1]}},{key:"isEmpty",value:function(){return!this.size()}},{key:"size",value:function(){return this.items.length}}]),n}();t.default=r},function(n,t,i){"use strict";function e(n){return n&&n.__esModule?n:{"default":n}}function g(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function nt(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function tt(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var o;t.__esModule=!0;var s=function(){function n(n,t){var r=[],u=!0,f=!1,e=undefined,i,o;try{for(i=n[Symbol.iterator]();!(u=(o=i.next()).done);u=!0)if(r.push(o.value),t&&r.length===t)break}catch(s){f=!0;e=s}finally{try{!u&&i["return"]&&i["return"]()}finally{if(f)throw e;}}return r}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return n(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance");}}(),c=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),f=function l(n,t,i){var r,u,f;return n===null&&(n=Function.prototype),r=Object.getOwnPropertyDescriptor(n,t),r===undefined?(u=Object.getPrototypeOf(n),u===null?undefined:l(u,t,i)):"value"in r?r.value:(f=r.get,f===undefined)?undefined:f.call(i)},h=i(2),r=i(1),a=i(81),v=i(6),y=i(7),p=e(y),w=i(230),b=e(w),k=i(435),d=e(k),u=i(231);i(436);o=function(n){function t(n){g(this,t);var i=nt(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return i.settings={},i.dateCalculator=null,i.currentYear=null,i.monthList=[],i.monthHeadersArray=[],i.weekHeadersArray=[],i.rangeBars={},i.rangeList={},i.nestedHeadersPlugin=null,i.hotSource=null,i.overallWeekSectionCount=null,i.initialSettings=null,i.dataFeed=null,i.colorData={},i.rangeBarMeta=Object.create(null),i}return tt(t,n),c(t,[{key:"checkDependencies",value:function(){this.hot.getSettings().colHeaders||console.warn("You need to enable the colHeaders property in your Gantt Chart Handsontable in order for it to work properly.")}},{key:"isEnabled",value:function(){return!!this.hot.getSettings().ganttChart}},{key:"enablePlugin",value:function(){var n=this;this.enabled||(this.checkDependencies(),this.parseSettings(),this.currentYear=this.settings.startYear||(new Date).getFullYear(),this.dateCalculator=new b.default(this.currentYear,this.settings.allowSplitWeeks),this.dateCalculator.setFirstWeekDay(this.settings.firstWeekDay),this.monthList=this.dateCalculator.getMonthList(),this.monthHeadersArray=this.generateMonthHeaders(),this.weekHeadersArray=this.generateWeekHeaders(),this.overallWeekSectionCount=this.dateCalculator.countWeekSections(),this.assignGanttSettings(),this.nestedHeadersPlugin&&(this.applyDataSource(),this.colorData&&this.setRangeBarColors(this.colorData)),this.addHook("afterInit",function(){return n.onAfterInit()}),h.addClass(this.hot.rootElement,"ganttChart"),f(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.internalUpdateSettings||(this.dataFeed&&this.dataFeed.hotSource&&this.dataFeed.removeSourceHotHooks(this.dataFeed.hotSource),this.settings={},this.dataFeed={},this.currentYear=null,this.monthList=[],this.rangeBars={},this.rangeList={},this.rangeBarMeta={},this.hotSource=null,this.deassignGanttSettings(),this.hot.getPlugin("collapsibleColumns").disablePlugin(),this.hot.getPlugin("nestedHeaders").disablePlugin(),h.removeClass(this.hot.rootElement,"ganttChart"),f(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin();this.enablePlugin();f(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updatePlugin",this).call(this)}},{key:"parseSettings",value:function(){this.settings=this.hot.getSettings().ganttChart;typeof this.settings=="boolean"&&(this.settings={});this.settings.firstWeekDay||(this.settings.firstWeekDay="monday");this.settings.allowSplitWeeks===void 0&&(this.settings.allowSplitWeeks=!0);typeof this.settings.weekHeaderGenerator!="function"&&(this.settings.weekHeaderGenerator=null)}},{key:"applyDataSource",value:function(){if(this.settings.dataSource){var n=this.settings.dataSource;n.instance?this.loadData(n.instance,n.startDateColumn,n.endDateColumn,n.additionalData,n.asyncUpdates):this.loadData(n)}}},{key:"loadData",value:function(n,t,i,r,u){n.length>1&&this.hot.alter("insert_row",0,n.length-1,this.pluginName+".loadData");this.dataFeed=new d.default(this.hot,n,t,i,r,u);this.hot.render()}},{key:"clearRangeBars",value:function(){this.rangeBars={}}},{key:"clearRangeList",value:function(){this.rangeList={}}},{key:"getRangeBarCoordinates",value:function(n){return this.rangeList[n]}},{key:"generateHeaderSet",value:function(n){var t=this,u=this.settings.weekHeaderGenerator,i=[];return r.objectEach(this.monthList,function(r,f){var b=r.daysBeforeFullWeeks>0?1:0,k=r.daysAfterFullWeeks>0?1:0,v=r.fullWeeks+(t.settings.allowSplitWeeks?b+k:0),c=parseInt(f,10),d=t.settings.allowSplitWeeks,y="",h,e,o,p,l,w,a;if(n==="months")i.push({label:r.name,colspan:v});else if(n==="weeks")for(h=0;h<v;h++)e=null,o=null,d||r.fullWeeks!==1?(w=t.getWeekColumnRange(r,c,h),a=s(w,2),e=a[0],o=a[1]):(p=t.getWeekColumnRange(r,c,h,!0),l=s(p,2),e=l[0],o=l[1]),y=e===o?e:e+" -  "+o,i.push(u?u.call(t,e,o):y),t.dateCalculator.addDaysToCache(c,i.length-1,e,o)}),i}},{key:"getWeekColumnRange",value:function(n,t,i,r){var o=this.settings.allowSplitWeeks,s=n.daysBeforeFullWeeks>0?1:0,h=n.daysAfterFullWeeks>0?1:0,c=n.fullWeeks+(this.settings.allowSplitWeeks?s+h:0),f=null,e=null;return r?t===0?(e=this.monthList[t+1].daysBeforeFullWeeks,f=u.DEC_LENGTH-(u.WEEK_LENGTH-e)+1):t===this.monthList.length-1?(e=u.WEEK_LENGTH-this.monthList[t-1].daysAfterFullWeeks,f=this.monthList[t-1].days-this.monthList[t-1].daysAfterFullWeeks+1):(e=this.monthList[t+1].daysBeforeFullWeeks,f=this.monthList[t-1].days-(u.WEEK_LENGTH-e)+1):o&&s&&i===0?(f=i+1,e=n.daysBeforeFullWeeks):o&&h&&i===c-1?(f=n.days-n.daysAfterFullWeeks+1,e=n.days):(f=null,f=o?n.daysBeforeFullWeeks+(i-s)*u.WEEK_LENGTH+1:n.daysBeforeFullWeeks+i*u.WEEK_LENGTH+1,e=f+u.WEEK_LENGTH-1),[f,e]}},{key:"generateMonthHeaders",value:function(){return this.generateHeaderSet("months")}},{key:"generateWeekHeaders",value:function(){return this.generateHeaderSet("weeks")}},{key:"generateDayHeaders",value:function(){return this.generateHeaderSet("days")}},{key:"assignGanttSettings",value:function(){var t=this,n;this.initialSettings=r.deepClone(this.hot.getSettings());n={data:a.createEmptySpreadsheetData(1,this.overallWeekSectionCount),readOnly:!0,renderer:function(n,i,r,u,f,e,o){return t.uniformBackgroundRenderer(n,i,r,u,f,e,o)},colWidths:60,hiddenColumns:!0,nestedHeaders:[this.monthHeadersArray.slice(),this.weekHeadersArray.slice()],collapsibleColumns:!0,columnSorting:!1};this.internalUpdateSettings=!0;this.hot.updateSettings(n);this.internalUpdateSettings=void 0}},{key:"deassignGanttSettings",value:function(){this.internalUpdateSettings=!0;this.initialSettings&&this.hot.updateSettings(this.initialSettings);this.internalUpdateSettings=void 0}},{key:"cacheRangeBarMeta",value:function(n,t,i,r){this.rangeBarMeta[n]||(this.rangeBarMeta[n]={});this.rangeBarMeta[n][t]||(this.rangeBarMeta[n][t]={});this.rangeBarMeta[n][t][i]=r}},{key:"applyRangeBarMetaCache",value:function(){var n=this;r.objectEach(this.rangeBarMeta,function(t,i){r.objectEach(t,function(t,u){r.objectEach(t,function(t,r){n.hot.setCellMeta(i,u,r,t)})})})}},{key:"addRangeBar",value:function(n,t,i,u){var o=this,f=this.dateCalculator.dateToColumn(t),e=this.dateCalculator.dateToColumn(i);return!this.dateCalculator.isValidRangeBarData(t,i)||f==null||e==null?!1:(this.rangeBars[n]||(this.rangeBars[n]={}),this.rangeBars[n][f]={barLength:e-f+1,partialStart:!this.dateCalculator.isOnTheEdgeOfWeek(t)[0],partialEnd:!this.dateCalculator.isOnTheEdgeOfWeek(i)[1],additionalData:{}},r.objectEach(u,function(t,i){o.rangeBars[n][f].additionalData[i]=t}),this.colorData[n]&&(this.rangeBars[n][f].colors=this.colorData[n]),this.rangeList[n]=[n,f],this.renderRangeBar(n,f,e,u),[n,f])}},{key:"getRangeBarData",value:function(n,t){var i=this.getRangeBarCoordinates(n),r;return i?(r=this.rangeBars[i[0]][i[1]],r&&n===i[0]&&(t===i[1]||t>i[1]&&t<i[1]+r.barLength))?r:!1:!1}},{key:"updateRangeBarData",value:function(n,t,i){var u=this.getRangeBarData(n,t);r.objectEach(i,function(n,t){u[t]!==n&&(u[t]=n)})}},{key:"renderRangeBar",value:function(n,t,i){for(var e,u,f=this.rangeBars[n][t],r=t;r<=i;r++)e=this.hot.getCellMeta(n,r),u=(e.className||"")+" rangeBar",(r===t&&f.partialStart||r===i&&f.partialEnd)&&(u+=" partial"),r===i&&(u+=" last"),this.hot.setCellMeta(n,r,"originalClassName",e.className),this.hot.setCellMeta(n,r,"className",u),this.hot.setCellMeta(n,r,"additionalData",f.additionalData),this.cacheRangeBarMeta(n,r,"originalClassName",e.className),this.cacheRangeBarMeta(n,r,"className",u),this.cacheRangeBarMeta(n,r,"additionalData",f.additionalData)}},{key:"removeRangeBarByDate",value:function(n,t){var i=this.dateCalculator.dateToColumn(t);this.removeRangeBarByColumn(n,i)}},{key:"removeRangeBarByColumn",value:function(n,t){var u=this,i=this.rangeBars[n][t];i&&(this.unrenderRangeBar(n,t,t+i.barLength-1),this.rangeBars[n][t]=null,r.objectEach(this.rangeList,function(i,r){r=parseInt(r,10);JSON.stringify(i)===JSON.stringify([n,t])&&(u.rangeList[r]=null)}))}},{key:"removeAllRangeBars",value:function(){var n=this;r.objectEach(this.rangeBars,function(t,i){r.objectEach(t,function(t,r){n.removeRangeBarByColumn(i,r)})})}},{key:"unrenderRangeBar",value:function(n,t,i){for(var u,r=t;r<=i;r++)u=this.hot.getCellMeta(n,r),this.hot.setCellMeta(n,r,"className",u.originalClassName),this.hot.setCellMeta(n,r,"originalClassName",void 0),this.cacheRangeBarMeta(n,r,"className",u.originalClassName),this.cacheRangeBarMeta(n,r,"originalClassName",void 0);this.hot.render()}},{key:"uniformBackgroundRenderer",value:function(n,t,i,u,f,e,o){var s=this.getRangeBarData(i,u),c=this.getRangeBarCoordinates(i),h;o.className&&(t.className=o.className);h="";r.objectEach(o.additionalData,function(n,t){h+=t+": "+n+"\n"});h=h.replace(/\n$/,"");t.title=h;t.style.background=s&&s.colors?u===c[1]&&s.partialStart||u===c[1]+s.barLength-1&&s.partialEnd?s.colors[1]:s.colors[0]:""}},{key:"setRangeBarColors",value:function(n){var t=this;this.colorData=n;r.objectEach(n,function(n,i){var r=t.getRangeBarCoordinates(i);r&&t.updateRangeBarData(r[0],r[1],{colors:n})});this.hot.render()}},{key:"setYear",value:function(n){var t=r.extend(this.hot.getSettings().ganttChart,{startYear:n});this.hot.updateSettings({ganttChart:t})}},{key:"onAfterInit",value:function(){this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders");this.applyDataSource()}},{key:"onUpdateSettings",value:function(){if(this.internalUpdateSettings){this.applyRangeBarMetaCache();return}f(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"onUpdateSettings",this).call(this)}},{key:"destroy",value:function(){this.hotSource&&this.dataFeed.removeSourceHotHooks(this.hotSource);f(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}}]),t}(p.default);v.registerPlugin("ganttChart",o);t.default=o},function(n,t,i){"use strict";function s(n){return n&&n.__esModule?n:{"default":n}}function h(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var f;t.__esModule=!0;var e=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),r=i(1),u=i(0),o=i(230),c=s(o);f=function(){function n(t,i,r,u,f,e){h(this,n);this.data=i;this.chartInstance=t;this.chartPlugin=this.chartInstance.getPlugin("ganttChart");this.hotSource=null;this.sourceHooks={};this.ongoingAsync=!1;this.applyData(i,r,u,f,e||!1)}return e(n,[{key:"applyData",value:function(n,t,i,r,u){Object.prototype.toString.call(n)==="[object Array]"?this.loadData(n):n.guid&&this.bindWithHotInstance(n,t,i,r,u)}},{key:"bindWithHotInstance",value:function(n,t,i,r,u){this.hotSource={instance:n,startColumn:t,endColumn:i,additionalData:r,asyncUpdates:u};this.addSourceHotHooks();this.asyncCall(this.updateFromSource)}},{key:"asyncCall",value:function(n){var t=this;if(!this.hotSource.asyncUpdates){n.call(this);return}this.asyncStart();setTimeout(function(){n.call(t);t.asyncEnd()},0)}},{key:"asyncStart",value:function(){this.ongoingAsync=!0}},{key:"asyncEnd",value:function(){this.ongoingAsync=!1}},{key:"addSourceHotHooks",value:function(){var n=this;this.sourceHooks={afterLoadData:function(t){return n.onAfterSourceLoadData(t)},afterChange:function(t,i){return n.onAfterSourceChange(t,i)},afterColumnSort:function(t,i){return n.onAfterColumnSort(t,i)}};this.hotSource.instance.addHook("afterLoadData",this.sourceHooks.afterLoadData);this.hotSource.instance.addHook("afterChange",this.sourceHooks.afterChange);this.hotSource.instance.addHook("afterColumnSort",this.sourceHooks.afterColumnSort)}},{key:"removeSourceHotHooks",value:function(n){this.sourceHooks.afterLoadData&&n.instance.removeHook("afterLoadData",this.sourceHooks.afterLoadData);this.sourceHooks.afterChange&&n.instance.removeHook("afterChange",this.sourceHooks.afterChange);this.sourceHooks.afterColumnSort&&n.instance.removeHook("afterColumnSort",this.sourceHooks.afterColumnSort)}},{key:"getDataFromSource",value:function(n){var f={},t=this.hotSource,i=void 0,o=[],s,u,e,h;for(n===void 0?i=t.instance.getData(0,0,t.instance.countRows()-1,t.instance.countCols()-1):(i=[],i[n]=t.instance.getDataAtRow(n)),s=function(n){f={};var u=i[n];if(u[t.startColumn]===null||u[t.startColumn]==="")return"continue";r.objectEach(t.additionalData,function(n,t){f[t]=u[n]});o.push([n,u[t.startColumn],u[t.endColumn],f,n])},u=n||0,e=i.length;u<(n?n+1:e);u++)h=s(u,e),h==="continue";return o}},{key:"updateFromSource",value:function(n){var t=this,i=this.getDataFromSource(n);!n&&isNaN(n)&&(this.chartPlugin.clearRangeBars(),this.chartPlugin.clearRangeList());u.arrayEach(i,function(n){n=t.trimRangeIfNeeded(n);t.chartPlugin.addRangeBar.apply(t.chartPlugin,n)})}},{key:"loadData",value:function(n){var t=this;u.arrayEach(n,function(n,i){n=t.trimRangeIfNeeded(n);t.chartPlugin.addRangeBar(i,n.startDate,n.endDate,n.additionalData)})}},{key:"trimRangeIfNeeded",value:function(n){var t=null,i,r,u,f;return(t=n[1]?{startDate:1,endDate:2}:{startDate:"startDate",endDate:"endDate"},i=new Date(n[t.startDate]),r=new Date(n[t.endDate]),typeof i=="string"||typeof r=="string")?!1:(u=i.getFullYear(),f=r.getFullYear(),u<this.chartPlugin.currentYear&&f>=this.chartPlugin.currentYear&&(n[t.startDate]="01/01/"+this.chartPlugin.currentYear),f>this.chartPlugin.currentYear&&u<=this.chartPlugin.currentYear&&(n[t.endDate]="12/31/"+this.chartPlugin.currentYear),n)}},{key:"onAfterSourceChange",value:function(n){var t=this;this.asyncCall(function(){var i,u,o;if(n){for(i={},u=0,o=n.length;u<o;u++){var f=n[u],e=parseInt(f[0],10),s=parseInt(f[1],10);i[e]||(i[e]={});i[e][s]=[f[2],f[3]]}r.objectEach(i,function(n,i){i=parseInt(i,10);t.chartPlugin.getRangeBarCoordinates(i)&&t.chartPlugin.removeRangeBarByColumn(i,t.chartPlugin.rangeList[i][1]);t.updateFromSource(i)})}})}},{key:"onAfterSourceLoadData",value:function(){var n=this;this.asyncCall(function(){n.chartPlugin.removeAllRangeBars();n.updateFromSource()})}},{key:"onAfterColumnSort",value:function(){var n=this;this.asyncCall(function(){n.chartPlugin.removeAllRangeBars();n.updateFromSource()})}}]),n}();t.default=f},function(){},function(n,t,i){"use strict";function a(n){return n&&n.__esModule?n:{"default":n}}function v(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function y(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function p(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var f;t.__esModule=!0;var o=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),r=function s(n,t,i){var r,u,f;return n===null&&(n=Function.prototype),r=Object.getOwnPropertyDescriptor(n,t),r===undefined?(u=Object.getPrototypeOf(n),u===null?undefined:s(u,t,i)):"value"in r?r.value:(f=r.get,f===undefined)?undefined:f.call(i)},u=i(2),h=i(6),e=i(4),c=i(7),l=a(c);f=function(n){function t(n){v(this,t);var i=y(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return i.settings=null,i}return p(t,n),o(t,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().headerTooltips}},{key:"enablePlugin",value:function(){var n=this;this.enabled||(this.settings=this.hot.getSettings().headerTooltips,this.parseSettings(),this.addHook("afterGetColHeader",function(t,i){return n.onAfterGetHeader(t,i)}),this.addHook("afterGetRowHeader",function(t,i){return n.onAfterGetHeader(t,i)}),r(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.settings=null;this.clearTitleAttributes();r(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disablePlugin",this).call(this)}},{key:"parseSettings",value:function(){typeof this.settings=="boolean"&&(this.settings={rows:!0,columns:!0,onlyTrimmed:!1})}},{key:"clearTitleAttributes",value:function(){var t=this.hot.view.wt.getSetting("columnHeaders").length,i=this.hot.view.wt.wtTable.THEAD,r=this.hot.view.wt.wtOverlays.topOverlay.clone.wtTable.THEAD,n=this.hot.view.wt.wtOverlays.topLeftCornerOverlay?hot.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.THEAD:null;e.rangeEach(0,t-1,function(t){var o=i.childNodes[t],u=r.childNodes[t],f=n?n.childNodes[t]:null;e.rangeEach(0,o.childNodes.length-1,function(t){o.childNodes[t].removeAttribute("title");u&&u.childNodes[t]&&u.childNodes[t].removeAttribute("title");n&&f&&f.childNodes[t]&&f.childNodes[t].removeAttribute("title")})},!0)}},{key:"onAfterGetHeader",value:function(n,t){var i=t.querySelector("span"),r=t.parentNode.parentNode.nodeName==="THEAD";(r&&this.settings.columns||!r&&this.settings.rows)&&(this.settings.onlyTrimmed?u.outerWidth(i)>=u.outerWidth(t)&&u.outerWidth(i)!==0&&t.setAttribute("title",i.textContent):t.setAttribute("title",i.textContent))}},{key:"destroy",value:function(){this.settings=null;r(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}}]),t}(l.default);h.registerPlugin("headerTooltips",f);t.default=f},function(n,t,i){"use strict";function c(n){return n&&n.__esModule?n:{"default":n}}function k(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function d(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function g(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var h;t.__esModule=!0;var l=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),o=function a(n,t,i){var r,u,f;return n===null&&(n=Function.prototype),r=Object.getOwnPropertyDescriptor(n,t),r===undefined?(u=Object.getPrototypeOf(n),u===null?undefined:a(u,t,i)):"value"in r?r.value:(f=r.get,f===undefined)?undefined:f.call(i)},r=i(2),f=i(4),e=i(0),s=i(1),v=i(6),y=i(7),p=c(y),u=i(8),w=i(439),b=c(w);i(440);h=function(n){function t(n){k(this,t);var i=d(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return i.settings=[],i.columnHeaderLevelCount=0,i.colspanArray=[],i.ghostTable=new b.default(i),i}return g(t,n),l(t,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().nestedHeaders}},{key:"enablePlugin",value:function(){var n=this;this.enabled||(this.settings=this.hot.getSettings().nestedHeaders,this.addHook("afterGetColumnHeaderRenderers",function(t){return n.onAfterGetColumnHeaderRenderers(t)}),this.addHook("afterInit",function(){return n.onAfterInit()}),this.addHook("afterOnCellMouseDown",function(t,i,r){return n.onAfterOnCellMouseDown(t,i,r)}),this.addHook("beforeOnCellMouseOver",function(t,i,r,u){return n.onBeforeOnCellMouseOver(t,i,r,u)}),this.addHook("afterViewportColumnCalculatorOverride",function(t){return n.onAfterViewportColumnCalculatorOverride(t)}),this.addHook("modifyColWidth",function(t,i){return n.onModifyColWidth(t,i)}),this.setupColspanArray(),this.checkForFixedColumnsCollision(),this.columnHeaderLevelCount=this.hot.view?this.hot.view.wt.getSetting("columnHeaders").length:0,o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.clearColspans();this.settings=[];this.columnHeaderLevelCount=0;this.colspanArray=[];this.ghostTable.clear();o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin();this.enablePlugin();o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updatePlugin",this).call(this);this.ghostTable.buildWidthsMapper()}},{key:"clearColspans",value:function(){var t,i,r,u,n,e;if(this.hot.view){var o=this.hot.view.wt.getSetting("columnHeaders").length,s=this.hot.view.wt.wtTable.THEAD,h=this.hot.view.wt.wtOverlays.topOverlay.clone.wtTable.THEAD,f=this.hot.view.wt.wtOverlays.topLeftCornerOverlay?this.hot.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.THEAD:null;for(t=0;t<o;t++){if(i=s.childNodes[t],!i)break;for(r=h.childNodes[t],u=f?f.childNodes[t]:null,n=0,e=i.childNodes.length;n<e;n++)i.childNodes[n].removeAttribute("colspan"),r&&r.childNodes[n]&&r.childNodes[n].removeAttribute("colspan"),f&&u&&u.childNodes[n]&&u.childNodes[n].removeAttribute("colspan")}}}},{key:"checkForFixedColumnsCollision",value:function(){var t=this,n=this.hot.getSettings().fixedColumnsLeft;e.arrayEach(this.colspanArray,function(i,r){t.getNestedParent(r,n)!==n&&console.warn("You have declared a Nested Header overlapping the Fixed Columns section - it may lead to visual glitches. To prevent that kind of problems, split the nested headers between the fixed and non-fixed columns.")})}},{key:"checkForOverlappingHeaders",value:function(){var n=this;e.arrayEach(this.colspanArray,function(t,i){e.arrayEach(n.colspanArray[i],function(t,r){var u,f,o;if(t.colspan>1&&(u=n.levelToRowCoords(i),f=n.getChildHeaders(u,r),f.length>0))return o=0,e.arrayEach(f,function(t){o+=n.getColspan(u+1,t)}),o>t.colspan&&console.warn("Your Nested Headers plugin setup contains overlapping headers. This kind of configuration is currently not supported and might result in glitches."),!1})})}},{key:"setupColspanArray",value:function(){function t(n,t){n[t]||(n[t]=[])}var n=this;s.objectEach(this.settings,function(i,r){s.objectEach(i,function(i,u,f){if(t(n.colspanArray,r),f[u].colspan===void 0)n.colspanArray[r].push({label:f[u]||"",colspan:1,hidden:!1});else{var e=f[u].colspan||1;n.colspanArray[r].push({label:f[u].label||"",colspan:e,hidden:!1});n.fillColspanArrayWithDummies(e,r)}})})}},{key:"fillColspanArrayWithDummies",value:function(n,t){var i=this;f.rangeEach(0,n-2,function(){i.colspanArray[t].push({label:"",colspan:1,hidden:!0})})}},{key:"headerRendererFactory",value:function(n){var t=this;return function(i,u){var f,e;if(u.removeAttribute("colspan"),r.removeClass(u,"hiddenHeader"),t.colspanArray[n][i]&&t.colspanArray[n][i].colspan){var o=t.colspanArray[n][i].colspan,s=t.hot.getSettings().fixedColumnsLeft||0,h=t.hot.view.wt.wtOverlays.topLeftCornerOverlay,c=t.hot.view.wt.wtOverlays.leftOverlay,l=h?h.clone.wtTable.THEAD.contains(u):!1,a=c?c.clone.wtTable.THEAD.contains(u):!1;o>1&&u.setAttribute("colspan",l||a?Math.min(o,s-i):o);(l||a&&i===s-1)&&r.addClass(u,"overlayEdge")}t.colspanArray[n][i]&&t.colspanArray[n][i].hidden&&r.addClass(u,"hiddenHeader");r.empty(u);f=document.createElement("DIV");r.addClass(f,"relative");e=document.createElement("SPAN");r.addClass(e,"colHeader");r.fastInnerHTML(e,t.colspanArray[n][i]?t.colspanArray[n][i].label||"":"");f.appendChild(e);u.appendChild(f);t.hot.runHooks("afterGetColHeader",i,u)}}},{key:"getColspan",value:function(n,t){var i=this.colspanArray[this.rowCoordsToLevel(n)][t];return i?i.colspan:1}},{key:"levelToRowCoords",value:function(n){return n-this.columnHeaderLevelCount}},{key:"rowCoordsToLevel",value:function(n){return n+this.columnHeaderLevelCount}},{key:"getNestedParent",value:function(n,t){var r,u,i;if(n<0)return!1;if(r=this.colspanArray[n][t]?this.colspanArray[n][t].colspan:1,u=this.colspanArray[n][t]?this.colspanArray[n][t].hidden:!1,r>1||r===1&&u===!1)return t;i=t-1;do{if(this.colspanArray[n][i].colspan>1)break;i--}while(t>=0);return i}},{key:"getChildHeaders",value:function(n,t){var u=this.rowCoordsToLevel(n),i=this.colspanArray[u+1],e=this.getNestedParent(u,t),o=this.colspanArray[u][t].colspan,r=[];return i?(f.rangeEach(e,e+o-1,function(n){i[n]&&i[n].colspan>1&&(o-=i[n].colspan-1);i[n]&&!i[n].hidden&&r.indexOf(n)===-1&&r.push(n)}),r):r}},{key:"fillTheRemainingColspans",value:function(){var n=this;s.objectEach(this.settings,function(t,i){f.rangeEach(n.colspanArray[i].length-1,n.hot.countCols()-1,function(r){n.colspanArray[i].push({label:t[r]||"",colspan:1,hidden:!1})},!0)})}},{key:"updateHeadersHighlight",value:function(){var t=this,n=this.hot.getSelectedLast();if(n!==void 0){var i="ht__highlight",u=this.hot.view.wt.wtOverlays,o=this.hot.selection.selectedHeader.cols,s=Math.min(n[1],n[3]),h=Math.max(n[1],n[3]),c=o?-1:this.columnHeaderLevelCount-1;f.rangeEach(s,h,function(n){for(var l=function(f){var l=t.getNestedParent(f,n),a=u.topOverlay?u.topOverlay.clone.wtTable.getColumnHeader(l,f):void 0,v=u.topLeftCornerOverlay?u.topLeftCornerOverlay.clone.wtTable.getColumnHeader(l,f):void 0,y=[a,v],p=t.getColspan(f-t.columnHeaderLevelCount,l),w=l>=s&&l+p-1<=h;e.arrayEach(y,function(n){if(n===void 0)return!1;!o&&f<c||o&&!w?r.hasClass(n,i)&&r.removeClass(n,i):r.hasClass(n,i)||r.addClass(n,i)})},f=t.columnHeaderLevelCount-1;f>-1;f--)l(f)})}}},{key:"onAfterViewportColumnCalculatorOverride",value:function(n){var i=this,t=n.startColumn;f.rangeEach(0,Math.max(this.columnHeaderLevelCount-1,0),function(r){var u=i.getNestedParent(r,n.startColumn),f;u<n.startColumn&&(f=Math.min(t,u),t=f)});n.startColumn=t}},{key:"onAfterOnCellMouseDown",value:function(n,t){var i,r,f;t.row<0&&(i=this.getColspan(t.row,t.col),r=t.col+i-1,i>1&&(f=this.hot.countRows()-1,this.hot.selection.setRangeEnd(new u.CellCoords(f,r))))}},{key:"onBeforeOnCellMouseOver",value:function(n,t,i,r){var h;if(t.row<0&&t.col>=0&&this.hot.view.isMouseDown()){var c=this.hot.getSelectedRangeLast(),f=c.from,e=c.to,l=this.getColspan(t.row,t.col),o=t.col+l-1,s=!1;f.col<=e.col?(t.col<f.col&&o===e.col||t.col<f.col&&o<f.col||t.col<f.col&&o>=f.col&&o<e.col)&&(s=!0):(t.col<e.col&&o>f.col||t.col>f.col||t.col<=e.col&&o>f.col||t.col>e.col&&o>f.col)&&(s=!0);s&&(h=[e.col,f.col],f.col=h[0],e.col=h[1]);l>1&&(r.column=!0,r.cell=!0,this.hot.selection.setSelectedHeaders(!1,!0),f.col===e.col&&(o<=f.col&&t.col<f.col?(this.hot.selection.setRangeStartOnly(new u.CellCoords(f.row,e.col)),this.hot.selection.setRangeEnd(new u.CellCoords(e.row,t.col))):(this.hot.selection.setRangeStartOnly(new u.CellCoords(f.row,t.col<f.col?t.col:f.col)),this.hot.selection.setRangeEnd(new u.CellCoords(e.row,o>e.col?o:e.col)))),f.col<e.col&&(this.hot.selection.setRangeStartOnly(new u.CellCoords(f.row,t.col<f.col?t.col:f.col)),this.hot.selection.setRangeEnd(new u.CellCoords(e.row,o))),f.col>e.col&&(this.hot.selection.setRangeStartOnly(new u.CellCoords(f.row,f.col)),this.hot.selection.setRangeEnd(new u.CellCoords(e.row,t.col))))}}},{key:"onAfterInit",value:function(){this.columnHeaderLevelCount=this.hot.view.wt.getSetting("columnHeaders").length;this.fillTheRemainingColspans();this.checkForOverlappingHeaders();this.ghostTable.buildWidthsMapper()}},{key:"onAfterGetColumnHeaderRenderers",value:function(n){if(n){n.length=0;for(var i=this.colspanArray.length,t=i-1;t>=0;t--)n.push(this.headerRendererFactory(t));n.reverse()}this.updateHeadersHighlight()}},{key:"onModifyColWidth",value:function(n,t){var i=this.ghostTable.widthsCache[t];return n>i?n:i}},{key:"destroy",value:function(){this.settings=null;this.columnHeaderLevelCount=null;this.colspanArray=null;o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}}]),t}(p.default);v.registerPlugin("nestedHeaders",h);t.default=h},function(n,t,i){"use strict";function o(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var r;t.__esModule=!0;var u=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),f=i(2),e=i(1);r=function(){function n(t){o(this,n);this.nestedHeaders=t;this.container=void 0;this.widthsCache=[]}return u(n,[{key:"buildWidthsMapper",value:function(){var t,i,n;for(this.container=document.createElement("div"),this.buildGhostTable(this.container),this.nestedHeaders.hot.rootElement.appendChild(this.container),t=this.container.querySelectorAll("tr:last-of-type th"),i=t.length,n=0;n<i;n++)this.widthsCache.push(t[n].offsetWidth);this.container.parentNode.removeChild(this.container);this.container=null;this.nestedHeaders.hot.render()}},{key:"buildGhostTable",value:function(n){for(var c,u,o,t,l,a,w,i=document,v=i.createDocumentFragment(),s=i.createElement("table"),h=!1,b=!!this.nestedHeaders.hot.getSettings().dropdownMenu,y=this.nestedHeaders.colspanArray.length,p=this.nestedHeaders.hot.countCols(),k=y-1,r=0;r<y;r++){for(c=i.createElement("tr"),h=!1,u=0;u<p;u++)o=i.createElement("th"),t=e.clone(this.nestedHeaders.colspanArray[r][u]),t&&!t.hidden&&(r===k&&(t.colspan>1&&(h=!0),b&&(t.label+='<button class="changeType"><\/button>')),f.fastInnerHTML(o,t.label),o.colSpan=t.colspan,c.appendChild(o));s.appendChild(c)}if(h){for(l=i.createElement("tr"),a=0;a<p;a++)w=i.createElement("th"),l.appendChild(w);s.appendChild(l)}v.appendChild(s);n.appendChild(v)}},{key:"clear",value:function(){this.container=null;this.widthsCache.length=0}}]),n}();t.default=r},function(){},function(n,t,i){"use strict";function u(n){return n&&n.__esModule?n:{"default":n}}function c(n){if(Array.isArray(n)){for(var t=0,i=Array(n.length);t<n.length;t++)i[t]=n[t];return i}return Array.from(n)}function rt(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function ut(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function ft(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var r,e;t.__esModule=!0;var l=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),f=function a(n,t,i){var r,u,f;return n===null&&(n=Function.prototype),r=Object.getOwnPropertyDescriptor(n,t),r===undefined?(u=Object.getPrototypeOf(n),u===null?undefined:a(u,t,i)):"value"in r?r.value:(f=r.get,f===undefined)?undefined:f.call(i)},v=i(7),y=u(v),p=i(6),o=i(4),s=i(0),h=i(8),w=i(442),b=u(w),k=i(443),d=u(k),g=i(232),nt=u(g),tt=i(444),it=u(tt);i(445);r=new WeakMap;e=function(n){function t(n){rt(this,t);var i=ut(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return i.sourceData=null,i.trimRowsPlugin=null,i.bindRowsWithHeadersPlugin=null,i.dataManager=null,i.headersUI=null,r.set(i,{changeSelection:!1,movedToFirstChild:!1,movedToCollapsed:!1,skipRender:null}),i}return ft(t,n),l(t,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().nestedRows}},{key:"enablePlugin",value:function(){var n=this;this.sourceData=this.hot.getSourceData();this.trimRowsPlugin=this.hot.getPlugin("trimRows");this.manualRowMovePlugin=this.hot.getPlugin("manualRowMove");this.bindRowsWithHeadersPlugin=this.hot.getPlugin("bindRowsWithHeaders");this.dataManager=new b.default(this,this.hot,this.sourceData);this.collapsingUI=new d.default(this,this.hot,this.trimRowsPlugin);this.headersUI=new nt.default(this,this.hot);this.contextMenuUI=new it.default(this,this.hot);this.dataManager.rewriteCache();this.addHook("afterInit",function(){return n.onAfterInit.apply(n,arguments)});this.addHook("beforeRender",function(){return n.onBeforeRender.apply(n,arguments)});this.addHook("modifyRowData",function(){return n.onModifyRowData.apply(n,arguments)});this.addHook("modifySourceLength",function(){return n.onModifySourceLength.apply(n,arguments)});this.addHook("beforeDataSplice",function(){return n.onBeforeDataSplice.apply(n,arguments)});this.addHook("beforeDataFilter",function(){return n.onBeforeDataFilter.apply(n,arguments)});this.addHook("afterContextMenuDefaultOptions",function(){return n.onAfterContextMenuDefaultOptions.apply(n,arguments)});this.addHook("afterGetRowHeader",function(){return n.onAfterGetRowHeader.apply(n,arguments)});this.addHook("beforeOnCellMouseDown",function(){return n.onBeforeOnCellMouseDown.apply(n,arguments)});this.addHook("afterRemoveRow",function(){return n.onAfterRemoveRow.apply(n,arguments)});this.addHook("modifyRemovedAmount",function(){return n.onModifyRemovedAmount.apply(n,arguments)});this.addHook("beforeAddChild",function(){return n.onBeforeAddChild.apply(n,arguments)});this.addHook("afterAddChild",function(){return n.onAfterAddChild.apply(n,arguments)});this.addHook("beforeDetachChild",function(){return n.onBeforeDetachChild.apply(n,arguments)});this.addHook("afterDetachChild",function(){return n.onAfterDetachChild.apply(n,arguments)});this.addHook("modifyRowHeaderWidth",function(){return n.onModifyRowHeaderWidth.apply(n,arguments)});this.addHook("afterCreateRow",function(){return n.onAfterCreateRow.apply(n,arguments)});this.addHook("beforeRowMove",function(){return n.onBeforeRowMove.apply(n,arguments)});this.addHook("afterRowMove",function(){return n.onAfterRowMove.apply(n,arguments)});this.trimRowsPlugin.isEnabled()||(this.trimRowsPlugin.enablePlugin(),this.hot.getSettings().trimRows=!0);f(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enablePlugin",this).call(this)}},{key:"disablePlugin",value:function(){f(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin();this.enablePlugin();f(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updatePlugin",this).call(this)}},{key:"onBeforeRowMove",value:function(n,t){for(var s=r.get(this),o=n.length,u=[],f=this.dataManager.translateTrimmedRow(t),c=!0,i=void 0,l=null,e=null,h=null,a,i=0;i<o;i++)u.push(this.dataManager.translateTrimmedRow(n[i])),this.dataManager.isParent(u[i])&&(c=!1);if(u.indexOf(f)>-1||!c||(l=this.dataManager.getRowParent(u[0]),e=this.dataManager.getRowParent(f),e==null&&(e=this.dataManager.getRowParent(f-1)),e==null&&(e=this.dataManager.getDataObject(f-1),s.movedToFirstChild=!0),!e))return!1;for(h=l===e,s.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(e),this.collapsingUI.collapsedRowsStash.stash(),h||(Math.max.apply(Math,u)<=f?this.collapsingUI.collapsedRowsStash.shiftStash(u[0],-1*n.length):this.collapsingUI.collapsedRowsStash.shiftStash(f,n.length)),s.changeSelection=!0,(u[o-1]<=f&&h||s.movedToFirstChild===!0)&&(n.reverse(),u.reverse(),s.movedToFirstChild!==!0&&f--),i=0;i<o;i++)this.dataManager.moveRow(u[i],f);if(a=u[u.length-1]<f,a)for(i=o-1;i>=0;i--)this.dataManager.moveCellMeta(u[i],f);else for(i=0;i<o;i++)this.dataManager.moveCellMeta(u[i],f);return(u[o-1]<=f&&h||this.dataManager.isParent(f))&&n.reverse(),this.dataManager.rewriteCache(),!1}},{key:"onAfterRowMove",value:function(n,t){var e=r.get(this),o,v;if(e.changeSelection){var f=n.length,i=0,u=0,s=null,l=null,a=null;this.collapsingUI.collapsedRowsStash.applyStash();s=this.dataManager.translateTrimmedRow(t);e.movedToFirstChild?(e.movedToFirstChild=!1,i=t,u=t+f-1,t>=Math.max.apply(Math,c(n))&&(i-=f,u-=f)):e.movedToCollapsed?(o=this.dataManager.getRowParent(s-1),o==null&&(o=this.dataManager.getDataObject(s-1)),v=this.dataManager.getRowIndex(o),i=v,u=i):n[f-1]<t?(u=t-1,i=u-f+1):(i=t,u=i+f-1);l=this.hot.selection;a=this.hot.countCols()-1;l.setRangeStart(new h.CellCoords(i,0));l.setRangeEnd(new h.CellCoords(u,a),!0);e.changeSelection=!1}}},{key:"onBeforeOnCellMouseDown",value:function(n,t,i){this.collapsingUI.toggleState(n,t,i)}},{key:"onModifyRowData",value:function(n){return this.dataManager.getDataObject(n)}},{key:"onModifySourceLength",value:function(){return this.dataManager.countAllRows()}},{key:"onBeforeDataSplice",value:function(n,t,i){return this.dataManager.spliceData(n,t,i),!1}},{key:"onBeforeDataFilter",value:function(n,t){var u=[],i=this.dataManager.translateTrimmedRow(n),f=r.get(this);return o.rangeEach(i,i+t-1,function(n){u.push(n)}),this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(i,t),this.collapsingUI.collapsedRowsStash.shiftStash(i,-1*t),this.dataManager.filterData(n,t,u),f.skipRender=!0,!1}},{key:"onAfterContextMenuDefaultOptions",value:function(n){return this.contextMenuUI.appendOptions(n)}},{key:"onAfterGetRowHeader",value:function(n,t){this.headersUI.appendLevelIndicators(n,t)}},{key:"onModifyRowHeaderWidth",value:function(n){return this.headersUI.rowHeaderWidthCache||n}},{key:"onAfterRemoveRow",value:function(n,t,i,u){var f=this,e;u!==this.pluginName&&(e=r.get(this),setTimeout(function(){e.skipRender=null;f.headersUI.updateRowHeaderWidth();f.collapsingUI.collapsedRowsStash.applyStash()},0))}},{key:"onModifyRemovedAmount",value:function(n,t){var i=this,r=[],u=0;return o.rangeEach(t,t+n-1,function(n){var t=!1,e=i.collapsingUI.translateTrimmedRow(n),f=i.dataManager.getDataObject(e);i.dataManager.hasChildren(f)&&(r.push(f),s.arrayEach(r,function(n){if(n.__children.indexOf(f)>-1)return t=!0,!1}),t||(u+=i.dataManager.countChildren(f)));t=!1;s.arrayEach(r,function(n){if(n.__children.indexOf(f)>-1)return t=!0,!1});t&&u--}),n+u}},{key:"onBeforeAddChild",value:function(){this.collapsingUI.collapsedRowsStash.stash()}},{key:"onAfterAddChild",value:function(n,t){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(t));this.collapsingUI.collapsedRowsStash.applyStash();this.headersUI.updateRowHeaderWidth()}},{key:"onBeforeDetachChild",value:function(){this.collapsingUI.collapsedRowsStash.stash()}},{key:"onAfterDetachChild",value:function(n,t){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(t));this.collapsingUI.collapsedRowsStash.applyStash();this.headersUI.updateRowHeaderWidth()}},{key:"onAfterCreateRow",value:function(n,t,i){i!==this.pluginName&&this.dataManager.rewriteCache()}},{key:"onAfterInit",value:function(){this.bindRowsWithHeadersPlugin.bindStrategy.strategy&&this.bindRowsWithHeadersPlugin.bindStrategy.createMap(this.hot.countSourceRows());var n=Math.max.apply(Math,c(this.dataManager.cache.levels));n>0&&this.headersUI.updateRowHeaderWidth(n)}},{key:"onBeforeRender",value:function(n,t){var i=r.get(this);i.skipRender&&(t.skipRender=!0)}}]),t}(y.default);p.registerPlugin("nestedRows",e);t.default=e},function(n,t,i){"use strict";function c(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var e;t.__esModule=!0;var o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},s=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),u=i(4),f=i(1),r=i(0),h=i(53);e=function(){function n(t,i,r){c(this,n);this.hot=i;this.data=r;this.plugin=t;this.parentReference=new WeakMap;this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap};this.recordTranslator=h.getTranslator(this.hot)}return s(n,[{key:"rewriteCache",value:function(){var n=this;this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap};u.rangeEach(0,this.data.length-1,function(t){n.cacheNode(n.data[t],0,null)})}},{key:"cacheNode",value:function(n,t,i){var u=this;this.cache.levels[t]||(this.cache.levels[t]=[],this.cache.levelCount++);this.cache.levels[t].push(n);this.cache.rows.push(n);this.cache.nodeInfo.set(n,{parent:i,row:this.cache.rows.length-1,level:t});this.hasChildren(n)&&r.arrayEach(n.__children,function(i){u.cacheNode(i,t+1,n)})}},{key:"getDataObject",value:function(n){return n==null?null:this.cache.rows[n]}},{key:"readTreeNodes",value:function(n,t,i,u){var f=this,e=!1;return isNaN(t)&&t.end?t:(n||(n={__children:this.data},e=!0,t--),i!=null&&t===i)?{result:n,end:!0}:u!=null&&n===u?{result:t,end:!0}:(t++,n.__children&&r.arrayEach(n.__children,function(r){return f.parentReference.set(r,e?null:n),t=f.readTreeNodes(r,t,i,u),isNaN(t)&&t.end?!1:void 0}),t)}},{key:"updateParentReference",value:function(){this.readTreeNodes({__children:this.data},0,this.hot.countRows())}},{key:"mockParent",value:function(){var n=this.mockNode();return n.__children=this.data,n}},{key:"mockNode",value:function(){var n={};return f.objectEach(this.data[0],function(t,i){n[i]=null}),n}},{key:"getRowIndex",value:function(n){return n==null?null:this.cache.nodeInfo.get(n).row}},{key:"getRowIndexWithinParent",value:function(n){var t=null,i;return(t=isNaN(n)?n:this.getDataObject(n),i=this.getRowParent(n),i==null)?this.data.indexOf(t):i.__children.indexOf(t)}},{key:"countAllRows",value:function(){var n={__children:this.data};return this.countChildren(n)}},{key:"countChildren",value:function(n){var i=this,t=0;return(isNaN(n)||(n=this.getDataObject(n)),!n||!n.__children)?0:(r.arrayEach(n.__children,function(n){t++;n.__children&&(t+=i.countChildren(n))}),t)}},{key:"getRowParent",value:function(n){var t=void 0;return t=isNaN(n)?n:this.getDataObject(n),this.getRowObjectParent(t)}},{key:"getRowObjectParent",value:function(n){return(typeof n=="undefined"?"undefined":o(n))!=="object"?null:this.cache.nodeInfo.get(n).parent}},{key:"getRowLevel",value:function(n){var t=null;return t=isNaN(n)?n:this.getDataObject(n),t?this.getRowObjectLevel(t):null}},{key:"getRowObjectLevel",value:function(n){return n==null?null:this.cache.nodeInfo.get(n).level}},{key:"hasChildren",value:function(n){return isNaN(n)||(n=this.getDataObject(n)),!!(n.__children&&n.__children.length)}},{key:"isParent",value:function(n){return isNaN(n)||(n=this.getDataObject(n)),!!f.hasOwnProperty(n,"__children")}},{key:"addChild",value:function(n,t){var r,i,u;this.hot.runHooks("beforeAddChild",n,t);r=null;n&&(r=this.getRowIndex(n));this.hot.runHooks("beforeCreateRow",r+this.countChildren(n)+1,1);i=n;n||(i=this.mockParent());i.__children||(i.__children=[]);t||(t=this.mockNode());i.__children.push(t);this.rewriteCache();u=this.getRowIndex(t);this.hot.runHooks("afterCreateRow",u,1);this.hot.runHooks("afterAddChild",n,t)}},{key:"addChildAtIndex",value:function(n,t,i,r){this.hot.runHooks("beforeAddChild",n,i,t);this.hot.runHooks("beforeCreateRow",r+1,1);var u=n;n||(u=this.mockParent());u.__children||(u.__children=[]);i||(i=this.mockNode());u.__children.splice(t,null,i);this.rewriteCache();this.hot.runHooks("afterCreateRow",r+1,1);this.hot.runHooks("afterAddChild",n,i,t)}},{key:"addSibling",value:function(n){var u=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"below",t=this.translateTrimmedRow(n),i=this.getRowParent(t),r=this.getRowIndexWithinParent(t);switch(u){case"below":this.addChildAtIndex(i,r+1,null,n);break;case"above":this.addChildAtIndex(i,r,null,n)}}},{key:"detachFromParent",value:function(n){var s=this,c=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!0,t=null,i=[];Array.isArray(n)?(u.rangeEach(n[0],n[2],function(n){var t=s.translateTrimmedRow(n);i.push(s.getDataObject(t))}),u.rangeEach(0,i.length-2,function(n){s.detachFromParent(i[n],!1)}),t=i[i.length-1]):t=n;var f=this.getRowIndex(t),h=this.getRowIndexWithinParent(t),e=this.getRowParent(t),o=this.getRowParent(e),l=this.getRowIndex(o),r=null;this.hot.runHooks("beforeDetachChild",e,t);h!=null&&(this.hot.runHooks("beforeRemoveRow",f,1,[f],this.plugin.pluginName),e.__children.splice(h,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",f,1,[f],this.plugin.pluginName),o?(r=l+this.countChildren(o),this.hot.runHooks("beforeCreateRow",r,1,this.plugin.pluginName),o.__children.push(t)):(r=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",r,1,this.plugin.pluginName),this.data.push(t)));this.rewriteCache();this.hot.runHooks("afterCreateRow",r,1,this.plugin.pluginName);c&&this.hot.render();this.hot.runHooks("afterDetachChild",e,t)}},{key:"filterData",value:function(n,t,i){var u=this,f=[];r.arrayEach(i,function(n){f.push(u.getDataObject(n))});r.arrayEach(f,function(n){var t=u.getRowIndexWithinParent(n),i=u.getRowParent(n);i===null?u.data.splice(t,1):i.__children.splice(t,1)});this.rewriteCache()}},{key:"spliceData",value:function(n,t,i){if(n=this.translateTrimmedRow(n),n!=null){var f=this.getDataObject(n-1),u=null,r=null;f&&f.__children&&f.__children.length===0?(u=f,r=0):(u=this.getRowParent(n),r=this.getRowIndexWithinParent(n));u?i?u.__children.splice(r,t,i):u.__children.splice(r,t):i?this.data.splice(r,t,i):this.data.splice(r,t);this.rewriteCache()}}},{key:"moveRow",value:function(n,t){var f=this.isParent(t),u=this.getRowParent(n),r=this.getRowIndexWithinParent(n),i=this.getRowParent(t);i==null&&(i=this.getRowParent(t-1));i==null&&(i=this.getDataObject(t-1));i?i.__children||(i.__children=[]):(i=this.getDataObject(t),i.__children=[]);var e=this.getRowParent(t-1),o=f?this.countChildren(e):this.getRowIndexWithinParent(t),s=u.__children.slice(r,r+1);u.__children.splice(r,1);i.__children.splice(o,0,s[0])}},{key:"moveCellMeta",value:function(n,t){var i=this.hot.getCellMetaAtRow(n);this.hot.spliceCellsMeta(t,0,i);this.hot.spliceCellsMeta(n+(n<t?0:1),1)}},{key:"translateTrimmedRow",value:function(n){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(n):n}}]),n}();t.default=e},function(n,t,i){"use strict";function u(n){return n&&n.__esModule?n:{"default":n}}function y(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function p(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function w(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var f;t.__esModule=!0;var e=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),o=i(11),r=i(0),s=i(4),h=i(2),c=i(162),l=u(c),a=i(232),v=u(a);f=function(n){function t(n,i){y(this,t);var u=p(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n,i));return u.trimRowsPlugin=n.trimRowsPlugin,u.dataManager=u.plugin.dataManager,u.collapsedRows=[],u.collapsedRowsStash={stash:function(){u.lastCollapsedRows=u.collapsedRows.slice(0);u.expandMultipleChildren(u.lastCollapsedRows,!1)},shiftStash:function(n){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;n=u.translateTrimmedRow(n);r.arrayEach(u.lastCollapsedRows,function(i,r){i>n-1&&(u.lastCollapsedRows[r]=i+t)})},applyStash:function(){u.hot.runHooks("skipLengthCache",100);u.collapseMultipleChildren(u.lastCollapsedRows,!0);u.lastCollapsedRows=void 0},trimStash:function(n,t){s.rangeEach(n,n+t-1,function(n){var t=u.lastCollapsedRows.indexOf(n);t>-1&&u.lastCollapsedRows.splice(t,1)})}},u}return w(t,n),e(t,[{key:"collapseChildren",value:function(n){var e=this,o=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!0,s=arguments.length>2&&arguments[2]!==undefined?arguments[2]:!0,f=[],t=null,i=null,u=null;return isNaN(n)?(t=n,i=this.dataManager.getRowIndex(t)):(t=this.dataManager.getDataObject(n),i=n),this.dataManager.hasChildren(t)&&r.arrayEach(t.__children,function(n){f.push(e.dataManager.getRowIndex(n))}),u=this.collapseRows(f,!0,!1),s&&this.trimRowsPlugin.trimRows(u),o&&this.renderAndAdjust(),this.collapsedRows.indexOf(i)===-1&&this.collapsedRows.push(i),u}},{key:"collapseMultipleChildren",value:function(n){var i=this,u=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!0,f=arguments.length>2&&arguments[2]!==undefined?arguments[2]:!0,t=[];r.arrayEach(n,function(n){t=t.concat(i.collapseChildren(n,!1,!1))});f&&this.trimRowsPlugin.trimRows(t);u&&this.renderAndAdjust()}},{key:"collapseRow",value:function(n){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!0;this.collapseRows([n],t)}},{key:"collapseRows",value:function(n){var i=this,u=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!0,f=arguments.length>2&&arguments[2]!==undefined?arguments[2]:!1,t=[];return r.arrayEach(n,function(n){t.push(n);u&&i.collapseChildRows(n,t)}),f&&this.trimRowsPlugin.trimRows(t),t}},{key:"collapseChildRows",value:function(n){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[],i=this,e=arguments.length>2&&arguments[2]!==undefined?arguments[2]:!0,f=arguments.length>3&&arguments[3]!==undefined?arguments[3]:!1,u;this.dataManager.hasChildren(n)&&(u=this.dataManager.getDataObject(n),r.arrayEach(u.__children,function(n){var r=i.dataManager.getRowIndex(n);t.push(r);i.collapseChildRows(r,t)}));f&&this.trimRowsPlugin.trimRows(t)}},{key:"expandRow",value:function(n){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!0;this.expandRows([n],t)}},{key:"expandRows",value:function(n){var i=this,u=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!0,f=arguments.length>2&&arguments[2]!==undefined?arguments[2]:!1,t=[];return r.arrayEach(n,function(n){t.push(n);u&&i.expandChildRows(n,t)}),f&&this.trimRowsPlugin.untrimRows(t),t}},{key:"expandChildRows",value:function(n){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[],i=this,e=arguments.length>2&&arguments[2]!==undefined?arguments[2]:!0,f=arguments.length>3&&arguments[3]!==undefined?arguments[3]:!1,u;this.dataManager.hasChildren(n)&&(u=this.dataManager.getDataObject(n),r.arrayEach(u.__children,function(n){if(!i.isAnyParentCollapsed(n)){var r=i.dataManager.getRowIndex(n);t.push(r);i.expandChildRows(r,t)}}));f&&this.trimRowsPlugin.untrimRows(t)}},{key:"expandChildren",value:function(n){var e=this,o=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!0,s=arguments.length>2&&arguments[2]!==undefined?arguments[2]:!0,f=[],t=null,i=null,u=null;return isNaN(n)?(t=n,i=this.dataManager.getRowIndex(n)):(t=this.dataManager.getDataObject(n),i=n),this.collapsedRows.splice(this.collapsedRows.indexOf(i),1),this.dataManager.hasChildren(t)&&r.arrayEach(t.__children,function(n){var t=e.dataManager.getRowIndex(n);f.push(t)}),u=this.expandRows(f,!0,!1),s&&this.trimRowsPlugin.untrimRows(u),o&&this.renderAndAdjust(),u}},{key:"expandMultipleChildren",value:function(n){var i=this,u=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!0,f=arguments.length>2&&arguments[2]!==undefined?arguments[2]:!0,t=[];r.arrayEach(n,function(n){t=t.concat(i.expandChildren(n,!1,!1))});f&&this.trimRowsPlugin.untrimRows(t);u&&this.renderAndAdjust()}},{key:"collapseAll",value:function(){var t=this,i=this.hot.getSourceData(),n=[];r.arrayEach(i,function(i){t.dataManager.hasChildren(i)&&n.push(i)});this.collapseMultipleChildren(n);this.renderAndAdjust()}},{key:"expandAll",value:function(){var t=this,i=this.hot.getSourceData(),n=[];r.arrayEach(i,function(i){t.dataManager.hasChildren(i)&&n.push(i)});this.expandMultipleChildren(n);this.renderAndAdjust()}},{key:"areChildrenCollapsed",value:function(n){var i=this,t=null,u=!0;return t=isNaN(n)?n:this.dataManager.getDataObject(n),this.dataManager.hasChildren(t)&&r.arrayEach(t.__children,function(n){var t=i.dataManager.getRowIndex(n);if(!i.trimRowsPlugin.isTrimmed(t))return u=!1,!1}),u}},{key:"isAnyParentCollapsed",value:function(n){for(var t=n,i;t!==null;)if(t=this.dataManager.getRowParent(t),i=this.dataManager.getRowIndex(t),this.collapsedRows.indexOf(i)>-1)return!0;return!1}},{key:"toggleState",value:function(n,t){if(!(t.col>=0)){var i=this.translateTrimmedRow(t.row);h.hasClass(n.target,v.default.CSS_CLASSES.button)&&(this.areChildrenCollapsed(i)?this.expandChildren(i):this.collapseChildren(i),o.stopImmediatePropagation(n))}}},{key:"translateTrimmedRow",value:function(n){return this.trimRowsPlugin.rowsMapper.getValueByIndex(n)}},{key:"renderAndAdjust",value:function(){this.hot.render();this.hot.view.wt.wtOverlays.adjustElementsSize()}}]),t}(l.default);t.default=f},function(n,t,i){"use strict";function a(n){return n&&n.__esModule?n:{"default":n}}function v(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function y(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function p(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function w(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var r,e;t.__esModule=!0;var o=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),u=i(4),s=i(0),h=i(3),f=v(h),c=i(162),l=a(c);r=new WeakMap;e=function(n){function t(n,i){y(this,t);var u=p(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n,i));return r.set(u,{row_above:function(n,t){u.dataManager.addSibling(t.start.row,"above")},row_below:function(n,t){u.dataManager.addSibling(t.start.row,"below")}}),u.dataManager=u.plugin.dataManager,u}return w(t,n),o(t,[{key:"appendOptions",value:function(n){var t=this,i=[{key:"add_child",name:function(){return this.getTranslatedPhrase(f.CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD)},callback:function(){var n=t.dataManager.translateTrimmedRow(t.hot.getSelectedLast()[0]),i=t.dataManager.getDataObject(n);t.dataManager.addChild(i)},disabled:function(){var n=t.hot.getSelectedLast();return!n||n[0]<0||t.hot.selection.selectedHeader.cols||t.hot.countRows()>=t.hot.getSettings().maxRows}},{key:"detach_from_parent",name:function(){return this.getTranslatedPhrase(f.CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD)},callback:function(){var n=t.dataManager.translateTrimmedRow(t.hot.getSelectedLast()[0]),i=t.dataManager.getDataObject(n);t.dataManager.detachFromParent(t.hot.getSelectedLast())},disabled:function(){var n=t.hot.getSelectedLast(),i=t.dataManager.translateTrimmedRow(n[0]),r=t.dataManager.getRowParent(i);return!r||!n||n[0]<0||t.hot.selection.selectedHeader.cols||t.hot.countRows()>=t.hot.getSettings().maxRows}},{name:"---------"}];return u.rangeEach(0,n.items.length-1,function(t){if(t===0)return s.arrayEach(i,function(i,r){n.items.splice(t+r,0,i)}),!1}),n=this.modifyRowInsertingOptions(n)}},{key:"modifyRowInsertingOptions",value:function(n){var t=r.get(this);return u.rangeEach(0,n.items.length-1,function(i){t[n.items[i].key]!=null&&(n.items[i].callback=t[n.items[i].key])}),n}}]),t}(l.default);t.default=e},function(){},function(n,t,i){"use strict";function e(n){return n&&n.__esModule?n:{"default":n}}function nt(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function tt(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function it(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}function h(n,t){t.textContent=""}var o;t.__esModule=!0;var c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},l=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),u=function a(n,t,i){var r,u,f;return n===null&&(n=Function.prototype),r=Object.getOwnPropertyDescriptor(n,t),r===undefined?(u=Object.getPrototypeOf(n),u===null?undefined:a(u,t,i)):"value"in r?r.value:(f=r.get,f===undefined)?undefined:f.call(i)},v=i(7),y=e(v),f=i(2),s=i(4),r=i(0),p=i(6),w=i(44),b=i(447),k=e(b),d=i(448),g=e(d);i(449);o=function(n){function t(n){nt(this,t);var i=tt(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return i.settings={},i.hiddenColumns=[],i.lastSelectedColumn=-1,i}return it(t,n),l(t,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().hiddenColumns}},{key:"enablePlugin",value:function(){var n=this;this.enabled||(this.hot.hasColHeaders()?this.addHook("afterGetColHeader",function(t,i){return n.onAfterGetColHeader(t,i)}):this.addHook("afterRenderer",function(t,i,r){return n.onAfterGetColHeader(r,t)}),this.addHook("afterContextMenuDefaultOptions",function(t){return n.onAfterContextMenuDefaultOptions(t)}),this.addHook("afterGetCellMeta",function(t,i,r){return n.onAfterGetCellMeta(t,i,r)}),this.addHook("modifyColWidth",function(t,i){return n.onModifyColWidth(t,i)}),this.addHook("beforeSetRangeStartOnly",function(t){return n.onBeforeSetRangeStart(t)}),this.addHook("beforeSetRangeEnd",function(t){return n.onBeforeSetRangeEnd(t)}),this.addHook("hiddenColumn",function(t){return n.isHidden(t)}),this.addHook("beforeStretchingColumnWidth",function(t,i){return n.onBeforeStretchingColumnWidth(t,i)}),this.addHook("afterCreateCol",function(t,i){return n.onAfterCreateCol(t,i)}),this.addHook("afterRemoveCol",function(t,i){return n.onAfterRemoveCol(t,i)}),this.hot.view&&this.onAfterPluginsInitialized(),u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin();this.enablePlugin();u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.settings={};this.hiddenColumns=[];this.lastSelectedColumn=-1;this.hot.render();u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disablePlugin",this).call(this);this.resetCellsMeta()}},{key:"showColumns",value:function(n){var t=this;r.arrayEach(n,function(n){n=parseInt(n,10);n=t.getLogicalColumnIndex(n);t.isHidden(n,!0)&&t.hiddenColumns.splice(t.hiddenColumns.indexOf(n),1)})}},{key:"showColumn",value:function(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];this.showColumns(i)}},{key:"hideColumns",value:function(n){var t=this;r.arrayEach(n,function(n){n=parseInt(n,10);n=t.getLogicalColumnIndex(n);t.isHidden(n,!0)||t.hiddenColumns.push(n)})}},{key:"hideColumn",value:function(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];this.hideColumns(i)}},{key:"isHidden",value:function(n){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!1;return t||(n=this.getLogicalColumnIndex(n)),this.hiddenColumns.indexOf(n)>-1}},{key:"resetCellsMeta",value:function(){r.arrayEach(this.hot.getCellsMeta(),function(n){n&&(n.skipColumnOnPaste=!1,n.baseRenderer!==null&&(n.renderer=n.baseRenderer,n.baseRenderer=null))})}},{key:"getLogicalColumnIndex",value:function(n){return this.hot.runHooks("modifyCol",n)}},{key:"onBeforeStretchingColumnWidth",value:function(n,t){return this.isHidden(t)&&(n=0),n}},{key:"onModifyColWidth",value:function(n,t){return this.isHidden(t)?.1:this.settings.indicators&&(this.isHidden(t+1)||this.isHidden(t-1))?n+(this.hot.hasColHeaders()?15:0):void 0}},{key:"onAfterGetCellMeta",value:function(n,t,i){var f,u,r,e,o;if(t=this.hot.runHooks("unmodifyCol",t),this.settings.copyPasteEnabled===!1&&this.isHidden(t)&&(i.skipColumnOnPaste=!0),this.isHidden(t)?(i.renderer!==h&&(i.baseRenderer=i.renderer),i.renderer=h):i.baseRenderer!==null&&(i.renderer=i.baseRenderer,i.baseRenderer=null),this.isHidden(i.visualCol-1)){f=!0;u=i.visualCol-1;i.className=i.className||"";i.className.indexOf("afterHiddenColumn")===-1&&(i.className+=" afterHiddenColumn");do{if(!this.isHidden(u)){f=!1;break}u--}while(u>=0);f&&i.className.indexOf("firstVisibleColumn")===-1&&(i.className+=" firstVisibleColumn")}else i.className&&(r=i.className.split(" "),r.length&&(e=r.indexOf("afterHiddenColumn"),o=r.indexOf("firstVisibleColumn"),e>-1&&r.splice(e,1),o>-1&&r.splice(o,1),i.className=r.join(" ")))}},{key:"onModifyCopyableRange",value:function(n){var u=this,t=[],i=function(n,i,r,u){t.push({startRow:n,endRow:i,startCol:r,endCol:u})};return r.arrayEach(n,function(n){var t=!0,r=0;s.rangeEach(n.startCol,n.endCol,function(f){u.isHidden(f)?(t||i(n.startRow,n.endRow,r,f-1),t=!0):(t&&(r=f),f===n.endCol&&i(n.startRow,n.endRow,r,f),t=!1)})}),t}},{key:"onAfterGetColHeader",value:function(n,t){if(!this.isHidden(n)){var r=!0,i=n-1;do{if(!this.isHidden(i)){r=!1;break}i--}while(i>=0);(r&&f.addClass(t,"firstVisibleColumn"),this.settings.indicators)&&(this.isHidden(n-1)&&f.addClass(t,"afterHiddenColumn"),this.isHidden(n+1)&&n>-1&&f.addClass(t,"beforeHiddenColumn"))}}},{key:"onBeforeSetRangeStart",value:function(n){var i=this,t;n.col>0||(n.col=0,t=function t(n){var r=i.getLogicalColumnIndex(n);return i.isHidden(r,!0)&&(n=t(++n)),n},n.col=t(n.col))}},{key:"onBeforeSetRangeEnd",value:function(n){var t=this,r=this.hot.countCols(),i=function i(u){var f=t.getLogicalColumnIndex(u);return t.isHidden(f,!0)&&(t.lastSelectedColumn>u||n.col===r-1?u>0?u=i(--u):s.rangeEach(0,t.lastSelectedColumn,function(n){if(!t.isHidden(n))return u=n,!1}):u=i(++u)),u};n.col=i(n.col);this.lastSelectedColumn=n.col}},{key:"onAfterContextMenuDefaultOptions",value:function(n){n.items.push({name:w.SEPARATOR},k.default(this),g.default(this))}},{key:"onAfterCreateCol",value:function(n,t){var i=[];r.arrayEach(this.hiddenColumns,function(r){r>=n&&(r+=t);i.push(r)});this.hiddenColumns=i}},{key:"onAfterRemoveCol",value:function(n,t){var i=[];r.arrayEach(this.hiddenColumns,function(r){r>=n&&(r-=t);i.push(r)});this.hiddenColumns=i}},{key:"onAfterPluginsInitialized",value:function(){var t=this,n=this.hot.getSettings().hiddenColumns;(typeof n=="undefined"?"undefined":c(n))==="object"&&(this.settings=n,n.copyPasteEnabled===void 0&&(n.copyPasteEnabled=!0),Array.isArray(n.columns)&&this.hideColumns(n.columns),n.copyPasteEnabled||this.addHook("modifyCopyableRange",function(n){return t.onModifyCopyableRange(n)}))}},{key:"destroy",value:function(){u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}}]),t}(y.default);p.registerPlugin("hiddenColumns",o);t.default=o},function(n,t,i){"use strict";function o(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function s(n){return{key:"hidden_columns_hide",name:function(){var n=this.getSelectedLast(),t=0;if(Array.isArray(n)){var i=r(n,4),u=i[1],f=i[3];u-f!=0&&(t=1)}return this.getTranslatedPhrase(e.CONTEXTMENU_ITEMS_HIDE_COLUMN,t)},callback:function(){var t=this.getSelectedRangeLast(),i=t.from,r=t.to,f=Math.min(i.col,r.col),e=Math.max(i.col,r.col);u.rangeEach(f,e,function(t){return n.hideColumn(t)});this.render();this.view.wt.wtOverlays.adjustElementsSize(!0)},disabled:!1,hidden:function(){return!this.selection.selectedHeader.cols}}}var r;t.__esModule=!0;r=function(){function n(n,t){var r=[],u=!0,f=!1,e=undefined,i,o;try{for(i=n[Symbol.iterator]();!(u=(o=i.next()).done);u=!0)if(r.push(o.value),t&&r.length===t)break}catch(s){f=!0;e=s}finally{try{!u&&i["return"]&&i["return"]()}finally{if(f)throw e;}}return r}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return n(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance");}}();t.default=s;var u=i(4),f=i(3),e=o(f)},function(n,t,i){"use strict";function o(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function s(n){var t=[],i=[];return{key:"hidden_columns_show",name:function(){var c=this.getSelectedLast(),l=0,h,s;if(Array.isArray(c)){var a=u(c,4),f=a[1],o=a[3];f>o&&(h=[o,f],f=h[0],o=h[1]);s=0;f===o?s=t.length+i.length:r.rangeEach(f,o,function(t){n.isHidden(t)&&(s+=1)});l=s<=1?0:1}return this.getTranslatedPhrase(e.CONTEXTMENU_ITEMS_SHOW_COLUMN,l)},callback:function(){var f=this.getSelectedRangeLast(),e=f.from,o=f.to,u=Math.min(e.col,o.col),s=Math.max(e.col,o.col);u===s?(t.length===u&&(n.showColumns(t),t.length=0),i.length===this.countSourceCols()-(u+1)&&(n.showColumns(i),i.length=0)):r.rangeEach(u,s,function(t){return n.showColumn(t)});this.render();this.view.wt.wtOverlays.adjustElementsSize(!0)},disabled:!1,hidden:function(){var f;if(!n.hiddenColumns.length||!this.selection.selectedHeader.cols)return!0;t.length=0;i.length=0;var o=this.getSelectedRangeLast(),s=o.from,h=o.to,u=Math.min(s.col,h.col),c=Math.max(s.col,h.col),e=!1;return u===c?(f=this.countSourceCols(),r.rangeEach(0,f,function(r){var f=t.length+i.length;if(f===n.hiddenColumns.length)return!1;r<u&&n.isHidden(r)?t.push(r):n.isHidden(r)&&i.push(r)}),f-=1,(t.length===u&&u>0||i.length===f-u&&u<f)&&(e=!0)):r.rangeEach(u,c,function(t){if(n.isHidden(t))return e=!0,!1}),!e}}}var u;t.__esModule=!0;u=function(){function n(n,t){var r=[],u=!0,f=!1,e=undefined,i,o;try{for(i=n[Symbol.iterator]();!(u=(o=i.next()).done);u=!0)if(r.push(o.value),t&&r.length===t)break}catch(s){f=!0;e=s}finally{try{!u&&i["return"]&&i["return"]()}finally{if(f)throw e;}}return r}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return n(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance");}}();t.default=s;var r=i(4),f=i(3),e=o(f)},function(){},function(n,t,i){"use strict";function e(n){return n&&n.__esModule?n:{"default":n}}function d(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function g(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function nt(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var o;t.__esModule=!0;var h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},c=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),f=function l(n,t,i){var r,u,f;return n===null&&(n=Function.prototype),r=Object.getOwnPropertyDescriptor(n,t),r===undefined?(u=Object.getPrototypeOf(n),u===null?undefined:l(u,t,i)):"value"in r?r.value:(f=r.get,f===undefined)?undefined:f.call(i)},a=i(7),v=e(a),u=i(2),s=i(4),r=i(0),y=i(6),p=i(451),w=e(p),b=i(452),k=e(b);i(453);o=function(n){function t(n){d(this,t);var i=g(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return i.settings={},i.hiddenRows=[],i.lastSelectedRow=-1,i}return nt(t,n),c(t,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().hiddenRows}},{key:"enablePlugin",value:function(){var n=this;this.enabled||(this.hot.hasRowHeaders()?this.addHook("afterGetRowHeader",function(t,i){return n.onAfterGetRowHeader(t,i)}):this.addHook("afterRenderer",function(t,i){return n.onAfterGetRowHeader(i,t)}),this.addHook("afterContextMenuDefaultOptions",function(t){return n.onAfterContextMenuDefaultOptions(t)}),this.addHook("afterGetCellMeta",function(t,i,r){return n.onAfterGetCellMeta(t,i,r)}),this.addHook("modifyRowHeight",function(t,i){return n.onModifyRowHeight(t,i)}),this.addHook("beforeSetRangeStartOnly",function(t){return n.onBeforeSetRangeStartOnly(t)}),this.addHook("beforeSetRangeStart",function(t){return n.onBeforeSetRangeStart(t)}),this.addHook("beforeSetRangeEnd",function(t){return n.onBeforeSetRangeEnd(t)}),this.addHook("hiddenRow",function(t){return n.isHidden(t)}),this.addHook("afterCreateRow",function(t,i){return n.onAfterCreateRow(t,i)}),this.addHook("afterRemoveRow",function(t,i){return n.onAfterRemoveRow(t,i)}),this.hot.view&&this.onAfterPluginsInitialized(),f(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin();this.enablePlugin();this.onAfterPluginsInitialized();f(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.settings={};this.hiddenRows=[];this.lastSelectedRow=-1;f(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disablePlugin",this).call(this);this.resetCellsMeta()}},{key:"showRows",value:function(n){var t=this;r.arrayEach(n,function(n){n=parseInt(n,10);n=t.getLogicalRowIndex(n);t.isHidden(n,!0)&&t.hiddenRows.splice(t.hiddenRows.indexOf(n),1)})}},{key:"showRow",value:function(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];this.showRows(i)}},{key:"hideRows",value:function(n){var t=this;r.arrayEach(n,function(n){n=parseInt(n,10);n=t.getLogicalRowIndex(n);t.isHidden(n,!0)||t.hiddenRows.push(n)})}},{key:"hideRow",value:function(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];this.hideRows(i)}},{key:"isHidden",value:function(n){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!1;return t||(n=this.getLogicalRowIndex(n)),this.hiddenRows.indexOf(n)>-1}},{key:"resetCellsMeta",value:function(){r.arrayEach(this.hot.getCellsMeta(),function(n){n&&(n.skipRowOnPaste=!1)})}},{key:"getLogicalRowIndex",value:function(n){return this.hot.runHooks("modifyRow",n)}},{key:"onAfterGetCellMeta",value:function(n,t,i){var f,u,r,e,o;if(n=this.hot.runHooks("unmodifyRow",n),i.skipRowOnPaste=this.settings.copyPasteEnabled===!1&&this.isHidden(n)?!0:!1,this.isHidden(n-1)){f=!0;u=n-1;i.className=i.className||"";i.className.indexOf("afterHiddenRow")===-1&&(i.className+=" afterHiddenRow");do{if(!this.isHidden(u)){f=!1;break}u--}while(u>=0);f&&i.className.indexOf("firstVisibleRow")===-1&&(i.className+=" firstVisibleRow")}else i.className&&(r=i.className.split(" "),r.length&&(e=r.indexOf("afterHiddenRow"),o=r.indexOf("firstVisibleRow"),e>-1&&r.splice(e,1),o>-1&&r.splice(o,1),i.className=r.join(" ")))}},{key:"onAfterGetRowHeader",value:function(n,t){var r=t.parentNode,f,i;r&&(this.isHidden(n)?u.addClass(r,"hide"):u.removeClass(r,"hide"));f=!0;i=n-1;do{if(!this.isHidden(i)){f=!1;break}i--}while(i>=0);f&&u.addClass(t,"firstVisibleRow");this.settings.indicators&&this.hot.hasRowHeaders()&&(this.isHidden(n-1)&&u.addClass(t,"afterHiddenRow"),this.isHidden(n+1)&&u.addClass(t,"beforeHiddenRow"))}},{key:"onModifyRowHeight",value:function(n,t){return this.isHidden(t)?.1:n}},{key:"onModifyCopyableRange",value:function(n){var u=this,t=[],i=function(n,i,r,u){t.push({startRow:n,endRow:i,startCol:r,endCol:u})};return r.arrayEach(n,function(n){var t=!0,r=0;s.rangeEach(n.startRow,n.endRow,function(f){u.isHidden(f)?(t||i(r,f-1,n.startCol,n.endCol),t=!0):(t&&(r=f),f===n.endRow&&i(r,f,n.startCol,n.endCol),t=!1)})}),t}},{key:"onBeforeSetRangeStart",value:function(n){var t=this,i=this.hot.getSelectedLast()||!1,u=this.hot.countRows()-1,r=function r(n){var f=0;return(i&&(f=n>i[0]?1:-1,t.lastSelectedRow=i[0]),u<n||n<0)?t.lastSelectedRow:(t.isHidden(n)&&(n=r(n+f)),n)};n.row=r(n.row)}},{key:"onBeforeSetRangeStartOnly",value:function(n){var i=this,t;n.row>0||(n.row=0,t=function t(n){return i.isHidden(n)&&(n=t(++n)),n},n.row=t(n.row))}},{key:"onBeforeSetRangeEnd",value:function(n){var t=this,r=this.hot.countRows(),i=function i(u){return t.isHidden(u)&&(t.lastSelectedRow>u||n.row===r-1?u>0?u=i(--u):s.rangeEach(0,t.lastSelectedRow,function(n){if(!t.isHidden(n))return u=n,!1}):u=i(++u)),u};n.row=i(n.row);this.lastSelectedRow=n.row}},{key:"onAfterContextMenuDefaultOptions",value:function(n){n.items.push({name:"---------"},w.default(this),k.default(this))}},{key:"onAfterCreateRow",value:function(n,t){var i=[];r.arrayEach(this.hiddenRows,function(r){r>=n&&(r+=t);i.push(r)});this.hiddenRows=i}},{key:"onAfterRemoveRow",value:function(n,t){var i=[];r.arrayEach(this.hiddenRows,function(r){r>=n&&(r-=t);i.push(r)});this.hiddenRows=i}},{key:"onAfterPluginsInitialized",value:function(){var t=this,n=this.hot.getSettings().hiddenRows;(typeof n=="undefined"?"undefined":h(n))==="object"&&(this.settings=n,n.copyPasteEnabled===void 0&&(n.copyPasteEnabled=!0),Array.isArray(n.rows)&&this.hideRows(n.rows),n.copyPasteEnabled||this.addHook("modifyCopyableRange",function(n){return t.onModifyCopyableRange(n)}))}},{key:"destroy",value:function(){f(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}}]),t}(v.default);y.registerPlugin("hiddenRows",o);t.default=o},function(n,t,i){"use strict";function o(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function s(n){return{key:"hidden_rows_hide",name:function(){var n=this.getSelectedLast(),t=0;if(Array.isArray(n)){var i=r(n,3),u=i[0],f=i[2];u-f!=0&&(t=1)}return this.getTranslatedPhrase(e.CONTEXTMENU_ITEMS_HIDE_ROW,t)},callback:function(){var t=this.getSelectedRangeLast(),i=t.from,r=t.to,f=Math.min(i.row,r.row),e=Math.max(i.row,r.row);u.rangeEach(f,e,function(t){return n.hideRow(t)});this.render();this.view.wt.wtOverlays.adjustElementsSize(!0)},disabled:!1,hidden:function(){return!this.selection.selectedHeader.rows}}}var r;t.__esModule=!0;r=function(){function n(n,t){var r=[],u=!0,f=!1,e=undefined,i,o;try{for(i=n[Symbol.iterator]();!(u=(o=i.next()).done);u=!0)if(r.push(o.value),t&&r.length===t)break}catch(s){f=!0;e=s}finally{try{!u&&i["return"]&&i["return"]()}finally{if(f)throw e;}}return r}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return n(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance");}}();t.default=s;var u=i(4),f=i(3),e=o(f)},function(n,t,i){"use strict";function o(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function s(n){var t=[],i=[];return{key:"hidden_rows_show",name:function(){var c=this.getSelectedLast(),l=0,h,s;if(Array.isArray(c)){var a=u(c,3),f=a[0],o=a[2];f>o&&(h=[o,f],f=h[0],o=h[1]);s=0;f===o?s=t.length+i.length:r.rangeEach(f,o,function(t){n.isHidden(t)&&(s+=1)});l=s<=1?0:1}return this.getTranslatedPhrase(e.CONTEXTMENU_ITEMS_SHOW_ROW,l)},callback:function(){var f=this.getSelectedRangeLast(),e=f.from,o=f.to,u=Math.min(e.row,o.row),s=Math.max(e.row,o.row);u===s?(t.length===u&&(n.showRows(t),t.length=0),i.length===this.countSourceRows()-(u+1)&&(n.showRows(i),i.length=0)):r.rangeEach(u,s,function(t){return n.showRow(t)});this.render();this.view.wt.wtOverlays.adjustElementsSize(!0)},disabled:!1,hidden:function(){var f;if(!n.hiddenRows.length||!this.selection.selectedHeader.rows)return!0;t.length=0;i.length=0;var o=this.getSelectedRangeLast(),s=o.from,h=o.to,u=Math.min(s.row,h.row),c=Math.max(s.row,h.row),e=!1;return u===c?(f=this.countSourceRows(),r.rangeEach(0,f,function(r){var f=t.length+i.length;if(f===n.hiddenRows.length)return!1;r<u?n.isHidden(r)&&t.push(r):n.isHidden(r)&&i.push(r)}),f-=1,(t.length===u&&u>0||i.length===f-u&&u<f)&&(e=!0)):r.rangeEach(u,c,function(t){if(n.isHidden(t))return e=!0,!1}),!e}}}var u;t.__esModule=!0;u=function(){function n(n,t){var r=[],u=!0,f=!1,e=undefined,i,o;try{for(i=n[Symbol.iterator]();!(u=(o=i.next()).done);u=!0)if(r.push(o.value),t&&r.length===t)break}catch(s){f=!0;e=s}finally{try{!u&&i["return"]&&i["return"]()}finally{if(f)throw e;}}return r}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return n(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance");}}();t.default=s;var r=i(4),f=i(3),e=o(f)},function(){},function(n,t,i){"use strict";function e(n){return n&&n.__esModule?n:{"default":n}}function p(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function w(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function b(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var u;t.__esModule=!0;var o=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),r=function s(n,t,i){var r,u,f;return n===null&&(n=Function.prototype),r=Object.getOwnPropertyDescriptor(n,t),r===undefined?(u=Object.getPrototypeOf(n),u===null?undefined:s(u,t,i)):"value"in r?r.value:(f=r.get,f===undefined)?undefined:f.call(i)},h=i(7),c=e(h),f=i(0),l=i(4),a=i(6),v=i(455),y=e(v);u=function(n){function t(n){p(this,t);var i=w(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return i.trimmedRows=[],i.removedRows=[],i.rowsMapper=new y.default(i),i}return b(t,n),o(t,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().trimRows}},{key:"enablePlugin",value:function(){var n=this,i;this.enabled||(i=this.hot.getSettings().trimRows,Array.isArray(i)&&(this.trimmedRows=i),this.rowsMapper.createMap(this.hot.countSourceRows()),this.addHook("modifyRow",function(t,i){return n.onModifyRow(t,i)}),this.addHook("unmodifyRow",function(t,i){return n.onUnmodifyRow(t,i)}),this.addHook("beforeCreateRow",function(t,i,r){return n.onBeforeCreateRow(t,i,r)}),this.addHook("afterCreateRow",function(t,i){return n.onAfterCreateRow(t,i)}),this.addHook("beforeRemoveRow",function(t,i){return n.onBeforeRemoveRow(t,i)}),this.addHook("afterRemoveRow",function(t,i){return n.onAfterRemoveRow(t,i)}),this.addHook("afterLoadData",function(t){return n.onAfterLoadData(t)}),r(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){var n=this.hot.getSettings().trimRows;Array.isArray(n)&&(this.disablePlugin(),this.enablePlugin());r(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.trimmedRows=[];this.removedRows.length=0;this.rowsMapper.clearMap();r(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disablePlugin",this).call(this)}},{key:"trimRows",value:function(n){var t=this;f.arrayEach(n,function(n){n=parseInt(n,10);t.isTrimmed(n)||t.trimmedRows.push(n)});this.hot.runHooks("skipLengthCache",100);this.rowsMapper.createMap(this.hot.countSourceRows());this.hot.runHooks("afterTrimRow",n)}},{key:"trimRow",value:function(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];this.trimRows(i)}},{key:"untrimRows",value:function(n){var t=this;f.arrayEach(n,function(n){n=parseInt(n,10);t.isTrimmed(n)&&t.trimmedRows.splice(t.trimmedRows.indexOf(n),1)});this.hot.runHooks("skipLengthCache",100);this.rowsMapper.createMap(this.hot.countSourceRows());this.hot.runHooks("afterUntrimRow",n)}},{key:"untrimRow",value:function(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];this.untrimRows(i)}},{key:"isTrimmed",value:function(n){return this.trimmedRows.indexOf(n)>-1}},{key:"untrimAll",value:function(){this.untrimRows([].concat(this.trimmedRows))}},{key:"onModifyRow",value:function(n,t){return t!==this.pluginName&&(n=this.rowsMapper.getValueByIndex(n)),n}},{key:"onUnmodifyRow",value:function(n,t){return t!==this.pluginName&&(n=this.rowsMapper.getIndexByValue(n)),n}},{key:"onBeforeCreateRow",value:function(n,t,i){return!(this.isEnabled()&&this.trimmedRows.length>0&&i==="auto")}},{key:"onAfterCreateRow",value:function(n,t){this.rowsMapper.shiftItems(n,t)}},{key:"onBeforeRemoveRow",value:function(n,t){var i=this;this.removedRows.length=0;n!==!1&&l.rangeEach(n,n+t-1,function(n){i.removedRows.push(i.hot.runHooks("modifyRow",n,i.pluginName))})}},{key:"onAfterRemoveRow",value:function(){this.rowsMapper.unshiftItems(this.removedRows)}},{key:"onAfterLoadData",value:function(n){n||this.rowsMapper.createMap(this.hot.countSourceRows())}},{key:"destroy",value:function(){this.rowsMapper.destroy();r(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}}]),t}(c.default);a.registerPlugin("trimRows",u);t.default=u},function(n,t,i){"use strict";function h(n){return n&&n.__esModule?n:{"default":n}}function c(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var r;t.__esModule=!0;var u=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),f=i(54),e=h(f),o=i(1),s=i(4);r=function(){function n(t){c(this,n);this.trimRows=t}return u(n,[{key:"createMap",value:function(n){var t=this,i=0,r=n===void 0?this._arrayMap.length:n;this._arrayMap.length=0;s.rangeEach(r-1,function(n){t.trimRows.isTrimmed(n)?i++:t._arrayMap[n-i]=n})}},{key:"destroy",value:function(){this._arrayMap=null}}]),n}();o.mixin(r,e.default);t.default=r},function(n,t,i){"use strict";function s(n){return n&&n.__esModule?n:{"default":n}}function h(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function c(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function l(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var f;t.__esModule=!0;var e=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),r=i(2),o=i(29),u=s(o);f=function(n){function t(n){h(this,t);var i=c(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return i.clone=i.makeClone(u.default.CLONE_BOTTOM),i}return l(t,n),e(t,[{key:"repositionOverlay",value:function(){var n=r.getScrollbarWidth(),t=this.clone.wtTable.holder.parentNode;this.wot.wtTable.holder.clientHeight===this.wot.wtTable.holder.offsetHeight&&(n=0);t.style.top="";t.style.bottom=n+"px"}},{key:"shouldBeRendered",value:function(){return this.wot.getSetting("fixedRowsBottom")?!0:!1}},{key:"resetFixedPosition",value:function(){var n,i;if(this.needFullRender&&this.wot.wtTable.holder.parentNode){if(n=this.clone.wtTable.holder.parentNode,i=0,n.style.top="",this.wot.wtOverlays.leftOverlay.trimmingContainer===window){var o=this.wot.wtTable.hider.getBoundingClientRect(),f=Math.ceil(o.bottom),t=void 0,u=void 0,e=document.body.offsetHeight;t=this.wot.wtTable.hider.style.left;t=t===""?0:t;u=f>e?f-e:0;i=u;u+="px";n.style.top="";n.style.left=t;n.style.bottom=u}else i=this.getScrollPosition(),r.resetCssTransform(n),this.repositionOverlay();this.adjustHeaderBordersPosition(i)}}},{key:"setScrollPosition",value:function(n){this.mainTableScrollableElement===window?window.scrollTo(r.getWindowScrollLeft(),n):this.mainTableScrollableElement.scrollTop=n}},{key:"onScroll",value:function(){this.wot.getSetting("onScrollVertically")}},{key:"sumCellSizes",value:function(n,t){for(var r=0,u=this.wot.wtSettings.settings.defaultRowHeight,i;n<t;)i=this.wot.wtTable.getRowHeight(n),r+=i===void 0?u:i,n++;return r}},{key:"adjustElementsSize",value:function(){var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:!1;this.updateTrimmingContainer();(this.needFullRender||n)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize(),n||(this.areElementSizesAdjusted=!0))}},{key:"adjustRootElementSize",value:function(){var i=this.wot.wtTable.holder,u=i.clientWidth===i.offsetWidth?0:r.getScrollbarWidth(),f=this.clone.wtTable.holder.parentNode,t=f.style,n=void 0;t.width=this.trimmingContainer===window?"":this.wot.wtViewport.getWorkspaceWidth()-u+"px";this.clone.wtTable.holder.style.width=t.width;n=r.outerHeight(this.clone.wtTable.TABLE);t.height=(n===0?n:n)+"px"}},{key:"adjustRootChildrenSize",value:function(){var n=r.getScrollbarWidth();this.clone.wtTable.hider.style.width=this.hider.style.width;this.clone.wtTable.holder.style.width=this.clone.wtTable.holder.parentNode.style.width;n===0&&(n=30);this.clone.wtTable.holder.style.height=parseInt(this.clone.wtTable.holder.parentNode.style.height,10)+n+"px"}},{key:"applyToDOM",value:function(){var n=this.wot.getSetting("totalRows");if(this.areElementSizesAdjusted||this.adjustElementsSize(),typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=this.wot.wtViewport.rowsRenderCalculator.startPosition+"px";else if(n===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="";this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){this.clone.wtTable.spreader.style.left=typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?this.wot.wtViewport.columnsRenderCalculator.startPosition+"px":""}},{key:"scrollTo",value:function(n,t){var i=this.getTableParentOffset(),e=this.wot.cloneSource?this.wot.cloneSource:this.wot,u=e.wtTable.holder,f=0;t&&u.offsetHeight!==u.clientHeight&&(f=r.getScrollbarWidth());t?(i+=this.sumCellSizes(0,n+1),i-=this.wot.wtViewport.getViewportHeight(),i+=1):i+=this.sumCellSizes(this.wot.getSetting("fixedRowsBottom"),n);i+=f;this.setScrollPosition(i)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===window?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return r.getScrollTop(this.mainTableScrollableElement)}},{key:"adjustHeaderBordersPosition",value:function(n){var t,i,u;this.wot.getSetting("fixedRowsBottom")===0&&this.wot.getSetting("columnHeaders").length>0&&(t=this.wot.wtTable.holder.parentNode,i=r.hasClass(t,"innerBorderTop"),n?r.addClass(t,"innerBorderTop"):r.removeClass(t,"innerBorderTop"),(!i&&n||i&&!n)&&this.wot.wtOverlays.adjustElementsSize());this.wot.getSetting("rowHeaders").length===0&&(u=this.clone.wtTable.THEAD.querySelector("th:nth-of-type(2)"),u&&(u.style["border-left-width"]=0))}}]),t}(u.default);u.default.registerOverlay(u.default.CLONE_BOTTOM,f);t.default=f},function(n,t,i){"use strict";function s(n){return n&&n.__esModule?n:{"default":n}}function h(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function c(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function l(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var f;t.__esModule=!0;var e=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),r=i(2),o=i(29),u=s(o);f=function(n){function t(n){h(this,t);var i=c(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return i.clone=i.makeClone(u.default.CLONE_BOTTOM_LEFT_CORNER),i}return l(t,n),e(t,[{key:"shouldBeRendered",value:function(){return this.wot.getSetting("fixedRowsBottom")&&(this.wot.getSetting("fixedColumnsLeft")||this.wot.getSetting("rowHeaders").length)?!0:!1}},{key:"repositionOverlay",value:function(){var n=r.getScrollbarWidth(),t=this.clone.wtTable.holder.parentNode;this.wot.wtTable.holder.clientHeight===this.wot.wtTable.holder.offsetHeight&&(n=0);t.style.top="";t.style.bottom=n+"px"}},{key:"resetFixedPosition",value:function(){if(this.updateTrimmingContainer(),this.wot.wtTable.holder.parentNode){var n=this.clone.wtTable.holder.parentNode,t=r.outerHeight(this.clone.wtTable.TABLE),i=r.outerWidth(this.clone.wtTable.TABLE);if(n.style.top="",this.trimmingContainer===window){var e=this.wot.wtTable.hider.getBoundingClientRect(),o=Math.ceil(e.bottom),s=Math.ceil(e.left),u=void 0,f=void 0,h=document.body.offsetHeight;u=s<0?-s:0;f=o>h?o-h:0;f+="px";u+="px";n.style.top="";n.style.left=u;n.style.bottom=f}else r.resetCssTransform(n),this.repositionOverlay();n.style.height=(t===0?t:t)+"px";n.style.width=(i===0?i:i)+"px"}}}]),t}(u.default);u.default.registerOverlay(u.default.CLONE_BOTTOM_LEFT_CORNER,f);t.default=f}])["default"]});
//# sourceMappingURL=handsontable.min.js.map
